/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[13],{1215:function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return kt})),a.d(t,"createStore",(function(){return f.c})),a.d(t,"createInitialState",(function(){return f.b}));var n=a(53),o=a.n(n),r=a(4),i=a.n(r),s=a(146),l=a(62),c=a(56),u=a(309),d=a(47),p=a(17),m=a(185),b=a(277),g=a(1),h=a(76),f=a(78),y=a(38),E=a(51);const S=({toastLifeTimeMs:e=5e3})=>{const t=Object(d.useDispatch)(),a=Object(r.useMemo)((()=>f.a.errorsSelector()),[]),n=Object(h.a)(a),[{toasts:o},i]=Object(E.g)();return Object(r.useEffect)((()=>{n.forEach((({id:a,title:n,message:r})=>{o.some((e=>e.id===a))||i({type:"addToaster",toast:{color:"danger",id:a,iconType:"alert",title:n,errors:r,toastLifeTimeMs:e}}),t(y.a.removeError({id:a}))}))}),[t,i,n,e,o]),null};S.displayName="ErrorToastDispatcherComponent";const j=i.a.memo(S);var v=a(996),O=a(19),w=a(918);const T=({children:e})=>i.a.createElement(w.a.Provider,{value:Object(r.useReducer)(((e,t)=>{switch(t.type){case"updateRoute":return t.route;case"updateRouteWithOutSearch":return{...e,...t.route};case"updateSearch":return{...e,search:t.search};default:return e}}),w.b)},e),x=Object(r.memo)(T);var P=a(34),k=a(91);const C=Object(r.memo)((({children:e})=>{const t=Object(l.useLocation)(),a=Object(d.useDispatch)();return Object(r.useEffect)((()=>{a(k.a.showTimeline({id:P.TimelineId.active,show:!1}))}),[a,t.pathname]),Object(r.useEffect)((()=>{a({type:"userChangedUrl",payload:t})})),i.a.createElement(i.a.Fragment,null,e)}));C.displayName="RouteCapture";var M=a(3),I=a(187),N=a(92),A=a.n(N),_=a(93),F=a(22),L=a(635),D=a(6);D.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.indexPatternFetchFailureTitle",{defaultMessage:"Index pattern fetch failure"}),D.i18n.translate("xpack.securitySolution.components.hooks.eql.partialResponse",{defaultMessage:"EQL Preview Error"}),D.i18n.translate("xpack.securitySolution.components.hooks.errors.timeIntervalsNotDefined",{defaultMessage:"Time intervals are not defined."});var J=a(15),B=a(220),R=a(94),H=a(80),$=a(36);const z=[{columnHeaderType:H.a,id:"@timestamp",initialWidth:$.b},{columnHeaderType:H.a,id:"event.module",linkField:"rule.reference"},{columnHeaderType:H.a,id:"event.dataset"},{columnHeaderType:H.a,id:"event.category"},{columnHeaderType:H.a,id:"event.severity"},{columnHeaderType:H.a,id:"observer.name"},{columnHeaderType:H.a,id:"host.name"},{columnHeaderType:H.a,id:"message"},{columnHeaderType:H.a,id:"agent.id"},{columnHeaderType:H.a,id:"agent.type"}];window["__react-beautiful-dnd-disable-dev-warnings"]=!0;const G=({browserFields:e,children:t})=>{const a=Object(d.useDispatch)(),n=Object(r.useMemo)((()=>k.b.getTimelineByIdSelector()),[]),o=Object(r.useMemo)((()=>f.d.getDataProvidersSelector()),[]),{timelines:s}=Object(O.k)().services,l=[s.getUseAddToTimelineSensor()],{dataProviders:c,timelineType:u}=Object(h.a)((e=>{var t;return Object(M.pick)(["dataProviders","timelineType"],null!==(t=n(e,J.i.active))&&void 0!==t?t:R.a)})),p=Object(h.a)(o),[,m]=Object(E.g)(),b=Object(r.useCallback)((e=>{const t=u===J.m.template?(e=>D.i18n.translate("xpack.securitySolution.hooks.useAddToTimeline.template.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline template"}))(e):(e=>D.i18n.translate("xpack.securitySolution.hooks.useAddToTimeline.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline"}))(e);Object(E.e)(t,m)}),[m,u]),g=Object(r.useCallback)((t=>{try{W(),null!=p&&(({activeTimelineDataProviders:e,browserFields:t,dataProviders:a,dispatch:n,onAddedToTimeline:o,result:r})=>{if(Object(B.p)(r))Object(L.d)({dataProviders:e,destination:r.destination,dispatch:n,source:r.source,timelineId:J.i.active});else if(Object(B.o)(r))Object(B.c)({activeTimelineDataProviders:e,dataProviders:a,dispatch:n,onAddedToTimeline:o,result:r,timelineId:J.i.active});else if(Object(B.i)(r)){var i,s;Object(F.addFieldToTimelineColumns)({browserFields:t,defaultsHeader:z,dispatch:n,result:r,timelineId:Object(F.getTimelineIdFromColumnDroppableId)(null!==(i=null===(s=r.destination)||void 0===s?void 0:s.droppableId)&&void 0!==i?i:"")})}})({activeTimelineDataProviders:c,browserFields:e,dataProviders:p,dispatch:a,onAddedToTimeline:b,result:t})}finally{document.body.classList.remove(_.d),Object(B.e)(t)&&document.body.classList.remove(B.b)}}),[c,e,p,a,b]);return i.a.createElement(I.DragDropContext,{onDragEnd:g,onBeforeCapture:U,sensors:l},t)};G.displayName="DragDropContextWrapperComponent";const K=i.a.memo(G,((e,t)=>A()(e.children,t.children)));K.displayName="DragDropContextWrapper";const U=e=>{Object(B.e)(e)||document.body.classList.add(_.d),Object(B.e)(e)&&document.body.classList.add(B.b)},W=()=>window.onscroll=()=>M.noop;var q=a(98),V=a(83);const Q=i.a.memo((()=>{const{chrome:e,docLinks:t}=Object(O.k)().services;return Object(r.useEffect)((()=>{e.setHelpExtension({appName:V.b,links:[{content:D.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation",{defaultMessage:"Security documentation"}),href:t.links.siem.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{content:D.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation.ecs",{defaultMessage:"ECS documentation"}),href:t.links.ecs.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{linkType:"discuss",href:"https://discuss.elastic.co/c/security",target:"_blank",rel:"noopener"}]})}),[]),null}));Q.displayName="HelpMenu";var Y=a(207),X=a(191),Z=a(235);var ee=a(323),te=a(320),ae=a(175),ne=a(26),oe=a.n(ne),re=a(24),ie=a.n(re),se=a(186),le=a(70),ce=a(531);const ue=D.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.searchFilterPlaceholder",{defaultMessage:"e.g. rare_process_linux"}),de=D.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.groupsLabel",{defaultMessage:"Groups"}),pe=D.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.noGroupsAvailableDescription",{defaultMessage:"No Groups available"}),me=D.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showAllJobsLabel",{defaultMessage:"Elastic jobs"}),be=D.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showSiemJobsLabel",{defaultMessage:"Custom jobs"});var ge=a(865);const he=({securityJobs:e,onSelectedGroupsChanged:t})=>{const[a,n]=Object(r.useState)(!1),[o,s]=Object(r.useState)([]),l=e.map((e=>e.groups)).flat().filter((e=>"siem"!==e&&"security"!==e)),c=Array.from(new Set(l));return Object(r.useEffect)((()=>{t(o)}),[o.sort().join()]),i.a.createElement(p.EuiPopover,{ownFocus:!0,button:i.a.createElement(p.EuiFilterButton,{"data-test-subj":"groups-filter-popover-button",iconType:"arrowDown",onClick:()=>n(!a),isSelected:a,numFilters:c.length,hasActiveFilters:o.length>0,numActiveFilters:o.length},de),isOpen:a,closePopover:()=>n(!a),panelPaddingSize:"none",repositionOnScroll:!0},c.map(((e,t)=>i.a.createElement(p.EuiFilterSelectItem,{checked:o.includes(e)?"on":void 0,key:`${t}-${e}`,onClick:()=>Object(ge.a)(e,o,s)},`${e} (${l.filter((t=>t===e)).length})`))),0===c.length&&i.a.createElement(p.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},i.a.createElement(p.EuiFlexItem,{grow:!0},i.a.createElement(p.EuiIcon,{type:"minusInCircle"}),i.a.createElement(p.EuiSpacer,{size:"xs"}),i.a.createElement("p",null,pe))))};he.displayName="GroupsFilterPopoverComponent";const fe=i.a.memo(he);fe.displayName="GroupsFilterPopover";const ye=({securityJobs:e,onFilterChanged:t})=>{const[a,n]=Object(r.useState)(""),[o,s]=Object(r.useState)([]),[l,c]=Object(r.useState)(!1),[u,d]=Object(r.useState)(!1);Object(r.useEffect)((()=>{t({filterQuery:a,showCustomJobs:l,showElasticJobs:u,selectedGroups:o})}),[a,o,l,u,t]);const m=Object(r.useCallback)((e=>n(e.queryText.trim())),[n]),b=Object(r.useCallback)((()=>{d(!u),c(!1)}),[d,u,c]),g=Object(r.useCallback)((()=>{c(!l),d(!1)}),[d,l,c]);return i.a.createElement(p.EuiFlexGroup,{gutterSize:"m",justifyContent:"flexEnd"},i.a.createElement(p.EuiFlexItem,{grow:!0},i.a.createElement(p.EuiSearchBar,{"data-test-subj":"jobs-filter-bar",box:{placeholder:ue,incremental:!0},onChange:m})),i.a.createElement(p.EuiFlexItem,{grow:!1},i.a.createElement(p.EuiFilterGroup,null,i.a.createElement(fe,{securityJobs:e,onSelectedGroupsChanged:s}))),i.a.createElement(p.EuiFlexItem,{grow:!1},i.a.createElement(p.EuiFilterGroup,null,i.a.createElement(p.EuiFilterButton,{hasActiveFilters:u,onClick:b,"data-test-subj":"show-elastic-jobs-filter-button",withNext:!0},me),i.a.createElement(p.EuiFilterButton,{hasActiveFilters:l,onClick:g,"data-test-subj":"show-custom-jobs-filter-button"},be))))};ye.displayName="JobsTableFiltersComponent";const Ee=i.a.memo(ye);Ee.displayName="JobsTableFilters";var Se=a(674);const je=D.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.jobNameColumn",{defaultMessage:"Job name"}),ve=D.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.tagsColumn",{defaultMessage:"Groups"}),Oe=D.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.runJobColumn",{defaultMessage:"Run job"}),we=D.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.noItemsDescription",{defaultMessage:"No Security Machine Learning jobs found"}),Te=D.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.createCustomJobButtonLabel",{defaultMessage:"Create custom job"});var xe=a(263);const Pe=ie()(p.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-1xsgv9-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);Pe.displayName="StaticSwitch";const ke=({job:e,isSecurityJobsLoading:t,onJobStateChange:a})=>{const[n,o]=Object(r.useState)(!1),s=Object(r.useCallback)((async t=>{o(!0),await a(e,e.latestTimestampMs||0,t.target.checked),o(!1)}),[e,o,a]);return i.a.createElement(p.EuiFlexGroup,{justifyContent:"spaceAround"},i.a.createElement(p.EuiFlexItem,{grow:!1},t||n||Object(xe.b)(e.jobState,e.datafeedState)?i.a.createElement(p.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):i.a.createElement(Pe,{"data-test-subj":"job-switch",disabled:Object(xe.a)(e.jobState,e.datafeedState),checked:Object(xe.c)(e.jobState,e.datafeedState),onChange:s,showLabel:!1,label:""})))};ke.displayName="JobSwitchComponent";const Ce=i.a.memo(ke);Ce.displayName="JobSwitch";const Me=ie.a.div.withConfig({displayName:"JobNameWrapper",componentId:"sc-1foobv2-0"})(["margin:5px 0;"]);Me.displayName="JobNameWrapper";const Ie=({id:e,description:t,basePath:a})=>{const{services:{ml:n}}=Object(O.k)(),o=Object(se.useMlHref)(n,a,{page:se.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:e}});return i.a.createElement(Me,null,i.a.createElement(p.EuiText,{size:"s"},i.a.createElement(p.EuiLink,{"data-test-subj":"jobs-table-link",href:o,target:"_blank"},e)),i.a.createElement(p.EuiText,{color:"subdued",size:"xs"},t.length>200?`${t.substring(0,200)}...`:t))},Ne=(e,t,a)=>[{name:je,render:({id:e,description:t})=>i.a.createElement(Ie,{id:e,description:t,basePath:a})},{name:ve,render:({groups:e})=>i.a.createElement(Se.a,{items:e,numberOfItemsToDisplay:0,popoverButtonTitle:`${e.length} Groups`,renderItem:(e,t)=>i.a.createElement(p.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"group"},e),dataTestPrefix:"groups"}),width:"80px"},{name:Oe,render:a=>a.isCompatible?i.a.createElement(Ce,{job:a,isSecurityJobsLoading:e,onJobStateChange:t}):i.a.createElement(p.EuiIcon,{"aria-label":"Warning",size:"s",type:"alert",color:"warning"}),align:p.CENTER_ALIGNMENT,width:"80px"}],Ae=(e,t,a)=>e.slice(t*a,t*a+a),_e=({isLoading:e,jobs:t,onJobStateChange:a})=>{const[n,o]=Object(r.useState)(0),s=Object(O.e)(),l={showPerPageOptions:!1,pageIndex:n,pageSize:5,totalItemCount:t.length};return Object(r.useEffect)((()=>{o(0)}),[t.length]),i.a.createElement(p.EuiBasicTable,{"data-test-subj":"jobs-table",columns:Ne(e,a,s),items:Ae(t,n,5),loading:e,noItemsMessage:i.a.createElement(Le,{basePath:s}),pagination:l,responsive:!1,onChange:({page:e})=>{o(e.index)}})};_e.displayName="JobsTableComponent";const Fe=i.a.memo(_e);Fe.displayName="JobsTable";const Le=i.a.memo((({basePath:e})=>{const{services:{ml:t}}=Object(O.k)(),a=Object(se.useMlHref)(t,e,{page:se.ML_PAGES.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX});return i.a.createElement(p.EuiEmptyPrompt,{title:i.a.createElement("h3",null,we),titleSize:"xs",actions:i.a.createElement(p.EuiButton,{href:a,iconType:"popout",iconSide:"right",size:"s",target:"_blank"},Te)})}));Le.displayName="NoItemsMessage";const De=ie.a.div.withConfig({displayName:"ShowingContainer",componentId:"sc-8k6h3p-0"})(["user-select:none;margin-top:5px;"]);De.displayName="ShowingContainer";const Je=({filterResultsLength:e})=>i.a.createElement(De,{"data-test-subj":"showing"},i.a.createElement(p.EuiText,{color:"subdued",size:"xs"},i.a.createElement(ae.FormattedMessage,{"data-test-subj":"query-message",id:"xpack.securitySolution.components.mlPopup.showingLabel",defaultMessage:"Showing: {filterResultsLength} {filterResultsLength, plural, one {job} other {jobs}}",values:{filterResultsLength:e}})));Je.displayName="ShowingCountComponent";const Be=i.a.memo(Je);Be.displayName="ShowingCount";const Re=()=>i.a.createElement(p.EuiText,{size:"s"},i.a.createElement(ae.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.anomalyDetectionDescription",defaultMessage:"Run any of the Machine Learning jobs below to prepare for creating detection rules that produce alerts for detected anomalies, and to view anomalous events throughout the Security application. We’ve provided a collection of common detection jobs to get you started. If you wish to add your own custom ML jobs, create and add them to the “Security” group from the {machineLearning} application.",values:{machineLearning:i.a.createElement(p.EuiLink,{href:`${Object(O.e)()}/app/ml`,target:"_blank"},i.a.createElement(ae.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.machineLearningLink",defaultMessage:"Machine Learning"}))}}));Re.displayName="PopoverDescriptionComponent";const He=i.a.memo(Re);He.displayName="PopoverDescription";const $e=D.i18n.translate("xpack.securitySolution.components.mlPopup.mlJobSettingsButtonLabel",{defaultMessage:"ML job settings"}),ze=D.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeTitle",{defaultMessage:"Upgrade to Elastic Platinum"}),Ge=D.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeButtonLabel",{defaultMessage:"Subscription plans"}),Ke=D.i18n.translate("xpack.securitySolution.components.mlPopup.licenseButtonLabel",{defaultMessage:"Manage license"}),Ue=e=>D.i18n.translate("xpack.securitySolution.components.mlPopup.moduleNotCompatibleTitle",{values:{incompatibleJobCount:e},defaultMessage:"{incompatibleJobCount} {incompatibleJobCount, plural, =1 {job} other {jobs}} are currently unavailable"}),We=D.i18n.translate("xpack.securitySolution.components.mlPopup.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),qe=D.i18n.translate("xpack.securitySolution.containers.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),Ve=D.i18n.translate("xpack.securitySolution.components.mlPopup.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),Qe=ie.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-fqnfg5-0"})(["width:384px;"]);Qe.displayName="PopoverContentsDiv";const Ye=()=>i.a.createElement(Qe,{"data-test-subj":"ml-popover-upgrade-contents"},i.a.createElement(p.EuiPopoverTitle,null,ze),i.a.createElement(p.EuiText,{size:"s"},i.a.createElement(ae.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.upgradeDescription",defaultMessage:"To access SIEM’s anomaly detection features, you must update your license to Platinum, start a free 30-day trial, or spin up a {cloudLink} on AWS, GCP, or Azure. You can then run Machine Learning jobs and view anomalies.",values:{cloudLink:i.a.createElement(p.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank"},i.a.createElement(ae.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.cloudLink",defaultMessage:"cloud deployment"}))}})),i.a.createElement(p.EuiSpacer,null),i.a.createElement(p.EuiFlexGroup,{gutterSize:"s",wrap:!0},i.a.createElement(p.EuiFlexItem,{grow:!1},i.a.createElement(p.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},Ge)),i.a.createElement(p.EuiFlexItem,{grow:!1},i.a.createElement(p.EuiButton,{href:`${Object(O.e)()}/app/management/stack/license_management`,iconType:"gear",target:"_blank"},Ke)))),Xe=i.a.memo(Ye);Xe.displayName="UpgradeContents";var Ze=a(502);const et=ie.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-z6keba-0"})(["max-width:684px;max-height:90vh;overflow-y:auto;overflow-x:hidden;padding-bottom:15px;"]);function tt(e,t){switch(t.type){case"refresh":return{...e,refreshToggle:!e.refreshToggle};case"loading":return{...e,isLoading:!0};case"success":case"failure":return{...e,isLoading:!1};default:return e}}et.displayName="PopoverContentsDiv";const at={isLoading:!1,refreshToggle:!0},nt={filterQuery:"",showCustomJobs:!1,showElasticJobs:!1,selectedGroups:[]},ot=i.a.memo((()=>{const[{isLoading:e,refreshToggle:t},a]=Object(r.useReducer)(tt,at),[n,o]=Object(r.useState)(!1),[s,l]=Object(r.useState)(nt),{isMlAdmin:c,isLicensed:u,loading:d,jobs:m}=Object(Ze.a)(t),[,b]=Object(E.g)(),g=Object(O.k)().services.docLinks,h=Object(r.useCallback)(((e,t,n)=>rt(e,t,n,a,b)),[a,b]),f=(({jobs:e,selectedGroups:t,showCustomJobs:a,showElasticJobs:n,filterQuery:o})=>((e,t)=>e.filter((e=>null==t||e.id.includes(t)||e.description.includes(t))))(e.filter((e=>!a||a&&!e.isElasticJob)).filter((e=>!n||n&&e.isElasticJob)).filter((e=>0===t.length||t.some((t=>e.groups.includes(t))))),o))({jobs:m,...s}),y=m.filter((e=>!e.isCompatible)).length,S=Object(r.useMemo)((()=>m.filter((e=>e.isInstalled)).map((e=>e.id))),[m]);return u?c?i.a.createElement(p.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:i.a.createElement(p.EuiHeaderSectionItemButton,{"aria-expanded":n,"aria-haspopup":"true","aria-label":$e,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>{o(!n),a({type:"refresh"})},textProps:{style:{fontSize:"1rem"}}},$e),isOpen:n,closePopover:()=>o(!n),repositionOnScroll:!0},i.a.createElement(et,{"data-test-subj":"ml-popover-contents"},i.a.createElement(p.EuiPopoverTitle,null,$e),i.a.createElement(He,null),i.a.createElement(p.EuiSpacer,null),i.a.createElement(Ee,{securityJobs:m,onFilterChanged:l}),i.a.createElement(Be,{filterResultsLength:f.length}),i.a.createElement(p.EuiSpacer,{size:"m"}),y>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(p.EuiCallOut,{title:Ue(y),color:"warning",iconType:"alert",size:"s"},i.a.createElement("p",null,i.a.createElement(ae.FormattedMessage,{defaultMessage:"We could not find any data, see {mlDocs} for more information on Machine Learning job requirements.",id:"xpack.securitySolution.components.mlPopup.moduleNotCompatibleDescription",values:{mlDocs:i.a.createElement("a",{href:`${g.links.siem.ml}`,rel:"noopener noreferrer",target:"_blank"},"Anomaly Detection with Machine Learning")}}))),i.a.createElement(p.EuiSpacer,{size:"m"})),i.a.createElement(se.MLJobsAwaitingNodeWarning,{jobIds:S}),i.a.createElement(Fe,{isLoading:d||e,jobs:f,onJobStateChange:h}))):null:i.a.createElement(p.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:i.a.createElement(p.EuiHeaderSectionItemButton,{"aria-expanded":n,"aria-haspopup":"true","aria-label":$e,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>o(!n),textProps:{style:{fontSize:"1rem"}}},$e),isOpen:n,closePopover:()=>o(!n),repositionOnScroll:!0},i.a.createElement(Xe,null))})),rt=async(e,t,a,n,o)=>{if(it(e,a),!e.isInstalled){n({type:"loading"});try{await Object(ce.c)({configTemplate:e.moduleId,indexPatternName:e.defaultIndexPattern,jobIdErrorFilter:[e.id],groups:e.groups}),n({type:"success"})}catch(e){return Object(E.f)({title:Ve,error:e,dispatchToaster:o}),n({type:"failure"}),void n({type:"refresh"})}}const r=oe.a.utc().subtract(14,"days").valueOf();if(a){const a=Math.max(t,r);try{await Object(ce.d)({datafeedIds:[`datafeed-${e.id}`],start:a})}catch(e){Object(le.e)(le.a.COUNT,le.b.JOB_ENABLE_FAILURE),Object(E.f)({title:We,error:e,dispatchToaster:o})}}else try{await Object(ce.e)({datafeedIds:[`datafeed-${e.id}`]})}catch(e){Object(le.e)(le.a.COUNT,le.b.JOB_DISABLE_FAILURE),Object(E.f)({title:qe,error:e,dispatchToaster:o})}n({type:"refresh"})},it=(e,t)=>{Object(le.e)(le.a.COUNT,e.isElasticJob?t?le.b.SIEM_JOB_ENABLED:le.b.SIEM_JOB_DISABLED:t?le.b.CUSTOM_JOB_ENABLED:le.b.CUSTOM_JOB_DISABLED)};ot.displayName="MlPopover";var st=a(81),lt=a(876),ct=a(686);const ut=D.i18n.translate("xpack.securitySolution.globalHeader.buttonAddData",{defaultMessage:"Add integrations"}),dt=i.a.memo((({setHeaderActionMenu:e})=>{const t=Object(r.useMemo)((()=>Object(ee.c)()),[]),{theme:a,http:{basePath:{prepend:n}},cloudExperiments:o}=Object(O.k)().services,{pathname:s}=Object(l.useLocation)(),u=Object(r.useMemo)((()=>k.b.getTimelineByIdSelector()),[]),d=Object(h.b)((e=>{var t;return(null!==(t=u(e,J.i.active))&&void 0!==t?t:R.a).show})),m=Object(Y.a)(s),b=Object(Y.b)(s),[f,y]=Object(r.useState)(g.a);Object(te.c)(o,"security-solutions.add-integrations-url",g.a,y);const E=Object(r.useMemo)((()=>n(f)),[n,f]);Object(r.useEffect)((()=>(e((e=>Object(c.toMountPoint)(i.a.createElement(ee.b,{node:t}),{theme$:a.theme$})(e))),()=>{t.unmount(),e(void 0)})),[t,e,a.theme$]);const{isTourShown:S,endTour:j}=Object(ct.b)(),v=Object(r.useCallback)((()=>{S&&j()}),[S,j]);return i.a.createElement(ee.a,{node:t},i.a.createElement(p.EuiHeaderSection,{side:"right"},Object(st.e)(s)&&i.a.createElement(p.EuiHeaderSectionItem,null,i.a.createElement(ot,null)),i.a.createElement(p.EuiHeaderSectionItem,null,i.a.createElement(p.EuiHeaderLinks,null,i.a.createElement(p.EuiHeaderLink,{color:"primary","data-test-subj":"add-data",href:E,iconType:"indexOpen",onClick:v},ut),b&&!d&&i.a.createElement(lt.a,{scope:m,"data-test-subj":"sourcerer"})))))}));dt.displayName="GlobalHeader";var pt=a(652),mt=a(421),bt=a(629),gt=a(380),ht=a(58),ft=a(293);const yt=({children:e,setHeaderActionMenu:t})=>{const{pathname:a}=Object(l.useLocation)();Object(Y.c)(Object(Y.a)(a)),Object(mt.b)(),(()=>{const e=Object(gt.b)(),[{pageName:t}]=Object(ft.a)(),a=Object(ht.b)(t);Object(r.useEffect)((()=>{var n;document.title=e?`${null!==(n=null==a?void 0:a.title)&&void 0!==n?n:""} - Kibana`:`${((e,t)=>null!=t[e]?t[e].name:"")(t,bt.a)} - Kibana`}),[t,e,a])})();const{browserFields:n}=Object(Y.d)(Object(Y.a)(a));return(()=>{const e=Object(O.k)(),t=Object(Z.a)().endpointPrivileges.canAccessFleet;Object(r.useEffect)((()=>{const a=new AbortController,n=()=>{a.abort()};if(t){const t=a.signal;return(async()=>{try{var n;await(null===(n=e.services.fleet)||void 0===n?void 0:n.isInitialized()),await(async(e,t={})=>e.post(X.epmRouteService.getBulkInstallPath(),{...t,body:JSON.stringify({packages:["endpoint","security_detection_engine"]})}))(e.services.http,{signal:t})}catch(e){a.signal.aborted||console.error(e)}})(),n}}),[t,e.services.fleet,e.services.http])})(),i.a.createElement(q.h,{className:"kbnAppWrapper"},i.a.createElement(pt.a,null,i.a.createElement(ct.a,null,i.a.createElement(i.a.Fragment,null,i.a.createElement(dt,{setHeaderActionMenu:t}),i.a.createElement(K,{browserFields:n},e),i.a.createElement(Q,null)))))};yt.displayName="HomePage";const Et=i.a.memo(yt),St=({children:e,history:t,onAppLeave:a,setHeaderActionMenu:n})=>{const o=Object(d.useDispatch)();return Object(r.useEffect)((()=>()=>{o({type:"userChangedUrl",payload:{pathname:"",search:"",hash:""}})}),[o]),i.a.createElement(x,null,i.a.createElement(l.Router,{history:t},i.a.createElement(C,null,i.a.createElement(l.Switch,null,i.a.createElement(c.Route,{path:"/"},i.a.createElement(Et,{setHeaderActionMenu:n},e)),i.a.createElement(c.Route,null,i.a.createElement(u.a,null))))))},jt=Object(r.memo)(St);var vt=a(999),Ot=a(866);const wt=({children:e,history:t,setHeaderActionMenu:a,onAppLeave:n,store:o,theme$:r})=>{const{i18n:s,application:{capabilities:l},cases:u}=Object(O.k)().services,[h]=Object(O.q)(g.M),f=Object(O.i)(),y=u.ui.getCasesContext();return i.a.createElement(p.EuiErrorBoundary,null,i.a.createElement(s.Context,null,i.a.createElement(E.b,null,i.a.createElement(d.Provider,{store:o},i.a.createElement(c.KibanaThemeProvider,{theme$:r},i.a.createElement(m.EuiThemeProvider,{darkMode:h},i.a.createElement(v.b,null,i.a.createElement(vt.b,{kibanaCapabilities:l},i.a.createElement(b.a,null,i.a.createElement(Ot.a,null,i.a.createElement(y,{owner:[g.o],permissions:f},i.a.createElement(jt,{history:t,onAppLeave:n,setHeaderActionMenu:a},e)))))))),i.a.createElement(j,null),i.a.createElement(E.a,null)))))},Tt=Object(r.memo)(wt),xt=({children:e,history:t,onAppLeave:a,services:n,setHeaderActionMenu:o,store:r,theme$:s})=>i.a.createElement(O.a,{services:{appName:g.r,...n}},i.a.createElement(Tt,{history:t,onAppLeave:a,setHeaderActionMenu:o,store:r,theme$:s},e)),Pt=Object(r.memo)(xt),kt=({element:e,history:t,onAppLeave:a,setHeaderActionMenu:n,services:r,store:d,usageCollection:p,subPluginRoutes:m,theme$:b})=>{var g;const h=null!==(g=null==p?void 0:p.components.ApplicationUsageTrackingProvider)&&void 0!==g?g:i.a.Fragment;return Object(s.render)(i.a.createElement(Pt,{history:t,onAppLeave:a,services:r,setHeaderActionMenu:n,store:d,theme$:b},i.a.createElement(h,null,i.a.createElement(l.Switch,null,m.map(((e,t)=>i.a.createElement(c.Route,o()({key:`route-${t}`},e)))),i.a.createElement(c.Route,null,i.a.createElement(u.a,null))))),e),()=>Object(s.unmountComponentAtNode)(e)}},263:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return c}));const n=["started","opened"],o=["starting","stopping","opening","closing"],r=["deleted","failed"],i=(e,t)=>n.includes(e)&&n.includes(t),s=(e,t)=>o.includes(e)||o.includes(t),l=(e,t)=>r.includes(e)||r.includes(t),c=e=>"machine_learning"===e},309:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),o=a.n(n),r=a(175),i=a(17),s=a(95);const l=o.a.memo((()=>o.a.createElement(s.a,null,o.a.createElement(i.EuiPageTemplate_Deprecated,{template:"centeredContent"},o.a.createElement(i.EuiEmptyPrompt,{"data-test-subj":"notFoundPage",iconColor:"default",iconType:"logoElastic",title:o.a.createElement("p",null,o.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.pages.fourohfour.pageNotFoundDescription",defaultMessage:"Page not found"}))})))));l.displayName="NotFoundPage"},323:function(e,t,a){"use strict";a.d(t,"c",(function(){return p})),a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n,o=a(4),r=a(146),i=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},n(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),s="html",l="svg",c=function(e,t){var a,n,o,r={};if(e===s)o=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');o=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var i=0,c=Object.entries(t.attributes);i<c.length;i++){var u=c[i],d=u[0],p=u[1];o.setAttribute(d,p)}var m={element:o,elementType:e,setPortalProps:function(e){r=e},getInitialPortalProps:function(){return r},mount:function(t,o){if(o!==n){if(m.unmount(),t!==a&&!function(e,t){if(t===s)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(m.element,o),a=t,n=o}},unmount:function(e){e&&e!==n||a&&n&&(a.replaceChild(n,m.element),a=void 0,n=void 0)}};return m},u=function(e){function t(t){var a=e.call(this,t)||this;return a.addPropsChannel=function(){Object.assign(a.props.node,{setPortalProps:function(e){a.setState({nodeProps:e})}})},a.state={nodeProps:a.props.node.getInitialPortalProps()},a}return i(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,a=t.children,n=t.node;return r.createPortal(o.Children.map(a,(function(t){return o.isValidElement(t)?o.cloneElement(t,e.state.nodeProps):t})),n.element)},t}(o.PureComponent),d=function(e){function t(t){var a=e.call(this,t)||this;return a.placeholderNode=o.createRef(),a.passPropsThroughPortal(),a}return i(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return o.createElement("div",{ref:this.placeholderNode})},t}(o.PureComponent),p=c.bind(null,s);c.bind(null,l)},376:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>o(e)&&r(e)&&i(e)&&s(e),o=({capabilities:e})=>e.canGetDatafeeds&&e.canStartStopDatafeed&&e.canUpdateDatafeed&&e.canPreviewDatafeed,r=({capabilities:e})=>e.canCreateJob&&e.canGetJobs&&e.canUpdateJob&&e.canDeleteJob&&e.canOpenJob&&e.canCloseJob&&e.canForecastJob,i=({capabilities:e})=>e.canGetFilters&&e.canCreateFilter&&e.canDeleteFilter,s=({capabilities:e})=>e.canCreateCalendar&&e.canGetCalendars&&e.canDeleteCalendar},468:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=async({http:e,jobIds:t,signal:a})=>e.fetch("/api/ml/jobs/jobs_summary",{method:"POST",body:JSON.stringify({jobIds:null!=t?t:[]}),asSystemRequest:!0,signal:a})},502:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(4),o=a(1),r=a(376),i=a(351),s=a(202),l=a(19),c=a(531);const u=["siem_cloudtrail","siem_packetbeat","security_auth","security_linux_v3","security_network","security_windows_v3"],d=(e,t,a)=>{const n=t.find((t=>t.id===e));return void 0!==n?{moduleId:n.moduleId,defaultIndexPattern:n.defaultIndexPattern,isCompatible:a.includes(n.moduleId),isElasticJob:!0}:{moduleId:"",defaultIndexPattern:"",isCompatible:!0,isElasticJob:!1}};var p=a(224),m=a(514),b=a(468);const g=e=>{const[t,a]=Object(n.useState)([]),[g,h]=Object(n.useState)(!0),f=Object(p.a)(),[y]=Object(l.q)(o.Q),E=Object(l.j)(),{addError:S}=Object(s.a)(),j=Object(r.a)(f),v=Object(i.a)(f);return Object(n.useEffect)((()=>{let e=!0;const t=new AbortController;return h(!0),async function(){if(j&&v)try{const[n,o,r]=await Promise.all([Object(b.a)({http:E,signal:t.signal}),Object(c.b)({signal:t.signal}),Object(c.a)({indexPatternName:y,signal:t.signal})]),i=((e,t,a)=>{const n=a.map((e=>e.id)),o=((e,t)=>e.filter((e=>u.includes(e.id))).map((e=>[...e.jobs.map((a=>((e,t,a)=>({datafeedId:"",datafeedIndices:[],datafeedState:"",hasDatafeed:!1,isSingleMetricViewerJob:!1,jobState:"closed",memory_status:"",processed_record_count:0,id:t.id,description:t.config.description,groups:[...t.config.groups].sort(),defaultIndexPattern:e.defaultIndexPattern,moduleId:e.id,isCompatible:a,isInstalled:!1,isElasticJob:!0,awaitingNodeAssignment:!1,jobTags:{},bucketSpanSeconds:900}))(e,a,t.includes(e.id))))])).flat())(t,n),r=((e,t,a)=>e.filter((({groups:e})=>e.includes("siem")||e.includes("security"))).map((e=>({...e,...d(e.id,t,a),isInstalled:!0}))))(e,o,n);return((e,t)=>{const a=e.map((e=>e.id));return[...e,...t.filter((e=>!a.includes(e.id)))].sort(((e,t)=>e.id.localeCompare(t.id)))})(r,o)})(n,o,r);e&&a(i)}catch(t){e&&S(t,{title:m.a})}e&&h(!1)}(),()=>{e=!1,t.abort()}}),[e,j,v,y,S,E]),{isLicensed:v,isMlAdmin:j,jobs:t,loading:g}}},525:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(4),o=a(6),r=a(47),i=a(78),s=a(76),l=a(207),c=a(13),u=a(508),d=a(33),p=a(461),m=a(202);const b=()=>{const{indicesExist:e}=Object(l.d)(c.SourcererScopeName.detections),{indexFieldsSearch:t}=Object(p.b)(),a=Object(r.useDispatch)(),{addError:b}=Object(m.a)(),g=Object(n.useRef)(new AbortController),h=Object(n.useMemo)((()=>i.g.defaultDataViewSelector()),[]),f=Object(n.useMemo)((()=>i.g.signalIndexNameSelector()),[]),y=Object(s.a)(f),E=Object(s.a)(h),S=Object(n.useMemo)((()=>!E.title.includes(`${y}`)),[E.title,y]),j=Object(n.useMemo)((()=>!e&&!S),[e,S]),v=Object(n.useCallback)((()=>{null!==y&&(g.current.abort(),(async()=>{g.current=new AbortController;try{const e=await Object(u.b)({body:{patternList:E.title.split(",")},signal:g.current.signal});null!==y&&e.defaultDataView.patternList.includes(y)&&(t({dataViewId:e.defaultDataView.id}),a(d.a.setSourcererDataViews(e)))}catch(e){b(e,{title:o.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:o.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[b,E.title,a,t,y]);return{...j?{pollForSignalIndex:v}:{},signalIndexNeedsInit:S}}},531:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return p}));const n=a(6).i18n.translate("xpack.securitySolution.components.ml.api.errors.statusCodeFailureTitle",{defaultMessage:"Status Code:"});var o=a(51),r=a(3);const i=e=>{try{return JSON.stringify(JSON.parse(e),null,2)}catch(t){return e}};var s=a(19);const l=async({indexPatternName:e,signal:t})=>s.b.get().http.fetch(`/api/ml/modules/recognize/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),c=async({moduleId:e="",signal:t})=>s.b.get().http.fetch(`/api/ml/modules/get_module/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),u=async({configTemplate:e,indexPatternName:t="auditbeat-*",jobIdErrorFilter:a=[],groups:r=["security"],prefix:l=""})=>{const c=await s.b.get().http.fetch(`/api/ml/modules/setup/${e}`,{method:"POST",body:JSON.stringify({prefix:l,groups:r,indexPatternName:t,startDatafeed:!1,useDedicatedIndex:!0,applyToAllSpaces:!0}),asSystemRequest:!0});return((e,t=[])=>{const a=[...e.jobs.reduce(((e,a)=>null!=a.error&&t.includes(a.id)?[...e,a.error.msg,i(a.error.response),`${n} ${a.error.statusCode}`]:e),[]),...e.datafeeds.reduce(((e,a)=>null!=a.error&&t.includes(a.id.substr("datafeed-".length))?[...e,a.error.msg,i(a.error.response),`${n} ${a.error.statusCode}`]:e),[])];if(a.length>0)throw new o.c(a)})(c,a),c},d=async({datafeedIds:e,start:t=0})=>{const a=await s.b.get().http.fetch("/api/ml/jobs/force_start_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e,...0!==t&&{start:t}}),asSystemRequest:!0});return((e,t)=>{const a=t.reduce(((t,a)=>{const o=e[a];return s=o,Object(r.has)("error.msg",s)&&Object(r.has)("error.response",s)&&Object(r.has)("error.statusCode",s)?[...t,o.error.msg,i(o.error.response),`${n} ${o.error.statusCode}`]:t;var s}),[]);if(a.length>0)throw new o.c(a)})(a,e),a},p=async({datafeedIds:e})=>{const t=await s.b.get().http.fetch("/api/ml/jobs/stop_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e}),asSystemRequest:!0}),a="datafeed-";return[t,await s.b.get().http.fetch("/api/ml/jobs/close_jobs",{method:"POST",body:JSON.stringify({jobIds:e.map((e=>e.startsWith(a)?e.substring(a.length):e))}),asSystemRequest:!0})]}},629:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(63),o=a(110),r=a(18),i=a(630),s=a(1);const l={[s.uc.landing]:{id:s.uc.landing,name:r.n,href:s.q,disabled:!1,urlKey:"get_started"},[s.uc.overview]:{id:s.uc.overview,name:r.x,href:s.t,disabled:!1,urlKey:"overview"},[s.uc.detectionAndResponse]:{id:s.uc.detectionAndResponse,name:r.g,href:s.g,disabled:!1,urlKey:"detection_response"},[s.uc.alerts]:{id:s.uc.alerts,name:r.a,href:s.d,disabled:!1,urlKey:"alerts"},[s.uc.rules]:{id:s.uc.rules,name:r.A,href:s.x,disabled:!1,urlKey:"rules"},[s.uc.exceptions]:{id:s.uc.exceptions,name:r.k,href:s.k,disabled:!1,urlKey:"exceptions"},[s.uc.hosts]:{id:s.uc.hosts,name:r.p,href:s.l,disabled:!1,urlKey:"host"},[s.uc.users]:{id:s.uc.users,name:r.E,href:s.B,disabled:!1,urlKey:"users"},[s.uc.network]:{id:s.uc.network,name:r.u,href:s.s,disabled:!1,urlKey:"network"},[s.uc.kubernetes]:{id:s.uc.kubernetes,name:r.s,href:s.p,disabled:!1,urlKey:"kubernetes"},[s.uc.timelines]:{id:s.uc.timelines,name:r.C,href:s.y,disabled:!1,urlKey:"timeline"},[s.uc.case]:{id:s.uc.case,name:r.c,href:s.f,disabled:!1,urlKey:"cases"},[s.uc.endpoints]:{id:s.uc.endpoints,name:r.h,href:s.h,disabled:!1,urlKey:"administration"},[s.uc.policies]:{id:s.uc.policies,name:r.y,href:s.v,disabled:!1,urlKey:"administration"},[s.uc.trustedApps]:{id:s.uc.trustedApps,name:r.D,href:s.z,disabled:!1,urlKey:"administration"},[s.uc.eventFilters]:{id:s.uc.eventFilters,name:r.j,href:s.j,disabled:!1,urlKey:"administration"},[s.uc.hostIsolationExceptions]:{id:s.uc.hostIsolationExceptions,name:r.q,href:s.m,disabled:!1,urlKey:"administration"},[s.uc.blocklist]:{id:s.uc.blocklist,name:r.b,href:s.e,disabled:!1,urlKey:"administration"},[s.uc.responseActionsHistory]:{id:s.uc.responseActionsHistory,name:r.z,href:s.w,disabled:!1,urlKey:"administration"},[s.uc.threatIntelligenceIndicators]:{...Object(o.getSecuritySolutionNavTab)("indicators",s.u),urlKey:"indicators"},[s.uc.cloudSecurityPostureFindings]:{...Object(n.getSecuritySolutionNavTab)("findings",s.u),urlKey:"findings"},[s.uc.cloudSecurityPostureDashboard]:{...Object(n.getSecuritySolutionNavTab)("dashboard",s.u),urlKey:"cloud_posture"},[s.uc.cloudSecurityPostureBenchmarks]:{...Object(n.getSecuritySolutionNavTab)("benchmarks",s.u),urlKey:"administration"},[s.uc.cloudSecurityPostureRules]:{...Object(n.getSecuritySolutionNavTab)("rules",s.u),urlKey:"administration"},[s.uc.entityAnalytics]:{id:s.uc.entityAnalytics,name:r.i,href:s.i,disabled:!1,urlKey:"entity_analytics"}},c={[i.a.dashboards]:{id:i.a.dashboards,name:r.e},[i.a.detect]:{id:i.a.detect,name:r.f},[i.a.findings]:{id:i.a.findings,name:r.m},[i.a.explore]:{id:i.a.explore,name:r.l},[i.a.intelligence]:{id:i.a.intelligence,name:r.B},[i.a.investigate]:{id:i.a.investigate,name:r.r},[i.a.manage]:{id:i.a.manage,name:r.t}}},630:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(9);let o;!function(e){e.dashboards="dashboards",e.detect="detect",e.findings="findings",e.explore="explore",e.intelligence="intelligence",e.investigate="investigate",e.manage="manage"}(o||(o={})),n.a.alerts,n.a.blocklist,n.a.detectionAndResponse,n.a.case,n.a.endpoints,n.a.landing,n.a.policies,n.a.eventFilters,n.a.exceptions,n.a.hostIsolationExceptions,n.a.hosts,n.a.network,n.a.overview,n.a.responseActionsHistory,n.a.rules,n.a.timelines,n.a.trustedApps,n.a.users,n.a.kubernetes,n.a.threatIntelligenceIndicators,n.a.cloudSecurityPostureDashboard,n.a.cloudSecurityPostureFindings,n.a.cloudSecurityPostureBenchmarks,n.a.cloudSecurityPostureRules,n.a.entityAnalytics},674:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(4),o=a.n(n),r=a(17),i=a(24),s=a.n(i);const l=s()(r.EuiFlexGroup).withConfig({displayName:"PopoverItemsWrapper",componentId:"sc-3vrhxe-0"})(["width:100%;"]),c=s()(r.EuiBadgeGroup).withConfig({displayName:"PopoverWrapper",componentId:"sc-3vrhxe-1"})(["max-height:200px;max-width:600px;overflow:auto;line-height:",";"],(({theme:e})=>e.eui.euiLineHeight)),u=({items:e,renderItem:t,popoverTitle:a,popoverButtonTitle:i,popoverButtonIcon:s,numberOfItemsToDisplay:u=0,dataTestPrefix:d="items"})=>{const[p,m]=Object(n.useState)(!1),b=({items:e})=>o.a.createElement(o.a.Fragment,null,e.map(t));return e.length<=u?o.a.createElement(l,{"data-test-subj":d,alignItems:"center",gutterSize:"s"},o.a.createElement(b,{items:e})):o.a.createElement(l,{alignItems:"center",gutterSize:"s","data-test-subj":d},0!==u&&o.a.createElement(r.EuiFlexItem,{grow:1,className:"eui-textTruncate"},o.a.createElement(b,{items:e.slice(0,u)})),o.a.createElement(r.EuiPopover,{ownFocus:!0,"data-test-subj":`${d}DisplayPopover`,button:o.a.createElement(r.EuiBadge,{iconType:s,color:"hollow","data-test-subj":`${d}DisplayPopoverButton`,onClick:()=>m(!p),onClickAriaLabel:i},i),isOpen:p,closePopover:()=>m(!p),repositionOnScroll:!0},a?o.a.createElement(r.EuiPopoverTitle,{"data-test-subj":`${d}DisplayPopoverTitle`},a):null,o.a.createElement(c,{"data-test-subj":`${d}DisplayPopoverWrapper`},o.a.createElement(b,{items:e.slice(u)}))))},d=o.a.memo(u);d.displayName="PopoverItems";const p=d},686:function(e,t,a){"use strict";a.d(t,"b",(function(){return S})),a.d(t,"a",(function(){return E}));var n=a(53),o=a.n(n),r=a(4),i=a.n(r),s=a(17),l=a(175),c=a(6),u=a(722),d=a.n(u),p=a(723),m=a.n(p);const b=[{step:1,title:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.overviewStep.tourTitle",{defaultMessage:"Welcome to Elastic Security"}),content:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.overviewStep.tourContent",{defaultMessage:"Take a quick tour to explore a unified workflow for investigating suspicious activity."}),anchor:'[id^="SolutionNav"]',anchorPosition:"rightUp",dataTestSubj:"welcomeStep"},{step:2,title:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.manageStep.tourTitle",{defaultMessage:"Protect your ecosystem"}),content:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.manageStep.tourContent",{defaultMessage:"Decide what matters to you and your environment and create rules to detect and prevent malicious activity. "}),anchor:'[data-test-subj="groupedNavItemLink-administration"]',anchorPosition:"rightUp",dataTestSubj:"manageStep"},{step:3,title:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.alertsStep.tourTitle",{defaultMessage:"Get notified when something changes"}),content:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.alertsStep.tourContent",{defaultMessage:"Know when a rule's conditions are met, so you can start your investigation right away. Set up notifications with third-party platforms like Slack, PagerDuty, and ServiceNow."}),anchor:'[data-test-subj="groupedNavItemLink-alerts"]',anchorPosition:"rightUp",imageConfig:{src:d.a,altText:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.alertsStep.imageAltText",{defaultMessage:"Alerts demonstration"})},dataTestSubj:"alertsStep"},{step:4,title:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.casesStep.tourTitle",{defaultMessage:"Create a case to track your investigation"}),content:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.casesStep.tourContent",{defaultMessage:"Collect evidence, add more collaborators, and even push case details to third-party case management systems."}),anchor:'[data-test-subj="groupedNavItemLink-cases"]',anchorPosition:"rightUp",imageConfig:{src:m.a,altText:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.casesStep.imageAltText",{defaultMessage:"Cases demonstration"})},dataTestSubj:"casesStep"},{step:5,title:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.dataStep.tourTitle",{defaultMessage:"Start gathering your data!"}),content:c.i18n.translate("xpack.securitySolution.guided_onboarding.tour.dataStep.tourContent",{defaultMessage:"Collect data from your endpoints using the Elastic Agent and a variety of third-party integrations."}),anchor:'[data-test-subj="add-data"]',anchorPosition:"rightUp",dataTestSubj:"dataStep"}],g="guidedOnboarding.security.tourActive",h="guidedOnboarding.security.tourStep",f=e=>{localStorage.setItem(h,JSON.stringify(e))},y=Object(r.createContext)({isTourShown:!1,endTour:()=>{}}),E=({children:e})=>{const[t,a]=Object(r.useState)((()=>{const e=localStorage.getItem(g);return!!e&&JSON.parse(e)})()),n=Object(r.useCallback)((e=>{a(e),(e=>{localStorage.setItem(g,JSON.stringify(e))})(e)}),[]),[c,u]=Object(r.useState)(Number(null!==(d=localStorage.getItem(h))&&void 0!==d?d:1));var d;const p=Object(r.useCallback)((()=>{u((e=>{const t=(e>=b.length?0:e)+1;return f(t),t}))}),[]),m=Object(r.useCallback)((()=>{u(1),f(1)}),[]),E=Object(r.useCallback)((()=>{n(!1),m()}),[n,m]),S=Object(s.useIsWithinBreakpoints)(["xs","s"]),j=t&&!S,v={isTourShown:j,endTour:E};return i.a.createElement(y.Provider,{value:v},i.a.createElement(i.a.Fragment,null,e,j&&i.a.createElement(i.a.Fragment,null,(e=>{const{activeStep:t,incrementStep:a,resetTour:n}=e,r=i.a.createElement(s.EuiFlexGroup,{alignItems:"center"},i.a.createElement(s.EuiFlexItem,null,i.a.createElement(s.EuiButtonEmpty,{size:"xs",color:"text",onClick:()=>n(),"data-test-subj":"onboarding--securityTourSkipButton"},i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.skipTour.buttonLabel",defaultMessage:"Skip tour"}))),i.a.createElement(s.EuiFlexItem,null,i.a.createElement(s.EuiButton,{size:"s",onClick:()=>a(),color:"success","data-test-subj":"onboarding--securityTourNextStepButton"},i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.nextStep.buttonLabel",defaultMessage:"Next"})))),c=i.a.createElement(s.EuiButtonEmpty,{size:"xs",color:"text",onClick:()=>n(),"data-test-subj":"onboarding--securityTourEndButton"},i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.endTour.buttonLabel",defaultMessage:"End tour"}));return b.map((e=>{const{content:a,imageConfig:l,dataTestSubj:u,...d}=e;return i.a.createElement(s.EuiTourStep,o()({},d,{minWidth:360,maxWidth:360,offset:20,repositionOnScroll:!0,stepsTotal:b.length,isStepOpen:e.step===t,onFinish:()=>n(),panelProps:{"data-test-subj":u},content:i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiText,{size:"xs"},i.a.createElement("p",null,a)),l&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiImage,{alt:l.altText,src:l.src,size:"fullWidth"}))),footerAction:t===b.length?c:r}))}))})({activeStep:c,incrementStep:p,resetTour:E}))))},S=()=>{const e=Object(r.useContext)(y);if(!e)throw new Error("useTourContext can only be called inside of TourContext!");return e}},722:function(e,t,a){e.exports=a.p+"f2e23061ff138ab262d11207da44b4e0.gif"},723:function(e,t,a){e.exports=a.p+"2fbbf401aa656aab190e0146b757e39f.gif"},865:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t,a)=>{const n=t.indexOf(e),o=[...t];n>=0?o.splice(n,1):o.push(e),a(o)}},866:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(4),o=a.n(n),r=a(218);class SecuritySolutionQueryClient extends r.QueryClient{constructor(e={}){var t,a,n;super({...e,defaultOptions:{...null!==(t=e.defaultOptions)&&void 0!==t?t:{},queries:{refetchIntervalInBackground:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,keepPreviousData:!0,...null!==(a=null==e||null===(n=e.defaultOptions)||void 0===n?void 0:n.queries)&&void 0!==a?a:{}}}})}}const i=Object(n.memo)((({queryClient:e,children:t})=>{const a=Object(n.useMemo)((()=>e||new SecuritySolutionQueryClient),[e]);return o.a.createElement(r.QueryClientProvider,{client:a},t)}));i.displayName="ReactQueryClientProvider"}}]);