(window.data_bundle_jsonpfunction=window.data_bundle_jsonpfunction||[]).push([[3],{125:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return O}));var s=t(11),r=t.n(s),i=t(52),o=t(15),l=t(34),n=t(25),d=t(0),c=t(106),u=t(107),h=t(9);function j(e){return["shard","index","node"].filter((a=>"number"==typeof e[a]||"string"==typeof e[a])).map((a=>({key:a,value:String(e[a])})))}function p(e,a){const t=e.reason.type,s="string"==typeof a?a:function(e){return j(e).map((({key:e,value:a})=>`${e}: ${a}`)).join(", ")}(e);return d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.failureHeader",{defaultMessage:"{failureName} at {failureDetails}",values:{failureName:t,failureDetails:s},description:'Summary of shard failures, e.g. "IllegalArgumentException at shard 0 node xyz"'})}function b(e){const a=j(e).map((e=>Object(h.jsx)("span",{className:"shardFailureModal__keyValueTitle",key:e.key},Object(h.jsx)(o.EuiCode,null,e.key)," ",e.value)));return Object(h.jsx)(o.EuiTitle,{size:"xs"},Object(h.jsx)("h2",null,p(e,""),a))}function f(e){return(e.charAt(0).toUpperCase()+e.slice(1)).replace(/[\._]/g," ")}function x(e,a){if("script"===a||"script_stack"===a){const a=Array.isArray(e)?e.join("\n"):String(e);return Object(h.jsx)(o.EuiCodeBlock,{language:"java",paddingSize:"s",isCopyable:!0},a)}return String(e)}function M(e){const a=Object(u.getFlattenedObject)(e.reason),t=Object.entries(a).map((([e,a])=>({title:f(e),description:x(a,e)})));return Object(h.jsx)("div",null,Object(h.jsx)(b,e),Object(h.jsx)(o.EuiSpacer,{size:"m"}),Object(h.jsx)(o.EuiDescriptionList,{listItems:t,type:"column",compressed:!0,className:"shardFailureModal__desc",titleProps:{className:"shardFailureModal__descTitle"},descriptionProps:{className:"shardFailureModal__descValue"}}))}function g({failures:e}){const a=e.map(((e,a)=>({id:String(a),...e}))),[t,r]=Object(s.useState)({}),i=[{align:c.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:e=>{const a=p(e),s=d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableRowCollapse",{defaultMessage:"Collapse {rowDescription}",description:"Collapse a row of a table with failures",values:{rowDescription:a}}),i=d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableRowExpand",{defaultMessage:"Expand {rowDescription}",description:"Expand a row of a table with failures",values:{rowDescription:a}});return Object(h.jsx)(o.EuiButtonIcon,{onClick:()=>{const a=Object.assign({},t);a[e.id]?delete a[e.id]:a[e.id]=Object(h.jsx)(M,e),r(a)},"aria-label":t[e.id]?s:i,iconType:t[e.id]?"arrowUp":"arrowDown"})}},{field:"shard",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableColShard",{defaultMessage:"Shard"}),sortable:!0,truncateText:!0,width:"80px"},{field:"index",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableColIndex",{defaultMessage:"Index"}),sortable:!0,truncateText:!0},{field:"node",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableColNode",{defaultMessage:"Node"}),sortable:!0,truncateText:!0},{field:"reason.type",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableColReason",{defaultMessage:"Reason"}),truncateText:!0}];return Object(h.jsx)(o.EuiInMemoryTable,{itemId:"id",items:a,columns:i,pagination:!0,sorting:{sort:{field:"index",direction:"desc"}},itemIdToExpandedRowMap:t})}function m({request:e,response:a,title:t,onClose:s}){if(!(a&&a._shards&&Array.isArray(a._shards.failures)&&e))return Object(h.jsx)(o.EuiCallOut,{title:"Sorry, there was an error",color:"danger",iconType:"alert"},"The ShardFailureModal component received invalid properties");const l=a._shards.failures,n=JSON.stringify(e,null,2),c=JSON.stringify(a,null,2),u=[{id:"table",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tabHeaderShardFailures",{defaultMessage:"Shard failures",description:"Name of the tab displaying shard failures"}),content:Object(h.jsx)(g,{failures:l}),"data-test-subj":"shardFailuresModalShardButton"},{id:"json-request",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tabHeaderRequest",{defaultMessage:"Request",description:"Name of the tab displaying the JSON request"}),content:Object(h.jsx)(o.EuiCodeBlock,{language:"json",isCopyable:!0,"data-test-subj":"shardsFailedModalRequestBlock"},n),"data-test-subj":"shardFailuresModalRequestButton"},{id:"json-response",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tabHeaderResponse",{defaultMessage:"Response",description:"Name of the tab displaying the JSON response"}),content:Object(h.jsx)(o.EuiCodeBlock,{language:"json",isCopyable:!0,"data-test-subj":"shardsFailedModalResponseBlock"},c),"data-test-subj":"shardFailuresModalResponseButton"}];return Object(h.jsx)(r.a.Fragment,null,Object(h.jsx)(o.EuiModalHeader,null,Object(h.jsx)(o.EuiModalHeaderTitle,{"data-test-subj":"shardFailureModalTitle"},t)),Object(h.jsx)(o.EuiModalBody,null,Object(h.jsx)(o.EuiTabbedContent,{tabs:u,initialSelectedTab:u[0],autoFocus:"selected"})),Object(h.jsx)(o.EuiModalFooter,null,Object(h.jsx)(o.EuiCopy,{textToCopy:c},(e=>Object(h.jsx)(o.EuiButtonEmpty,{onClick:e},Object(h.jsx)(i.FormattedMessage,{id:"data.search.searchSource.fetch.shardsFailedModal.copyToClipboard",defaultMessage:"Copy response to clipboard"})))),Object(h.jsx)(o.EuiButton,{onClick:()=>s(),fill:!0,"data-test-subj":"closeShardFailureModal"},Object(h.jsx)(i.FormattedMessage,{id:"data.search.searchSource.fetch.shardsFailedModal.close",defaultMessage:"Close",description:"Closing the Modal"}))))}function O({request:e,response:a,theme:t,title:s}){return Object(h.jsx)(o.EuiTextAlign,{textAlign:"right"},Object(h.jsx)(o.EuiButton,{color:"warning",size:"s",onClick:function(){const r=Object(n.c)().openModal(Object(l.toMountPoint)(Object(h.jsx)(m,{request:e,response:a,title:s,onClose:()=>r.close()}),{theme$:t.theme$}),{className:"shardFailureModal"})},"data-test-subj":"openShardFailureModalBtn"},Object(h.jsx)(i.FormattedMessage,{id:"data.search.searchSource.fetch.shardsFailedModal.showDetails",defaultMessage:"Show details",description:"Open the modal to show details"})))}}}]);