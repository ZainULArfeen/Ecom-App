(window.visualizations_bundle_jsonpfunction=window.visualizations_bundle_jsonpfunction||[]).push([[1],{114:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(45),n=a(9),s=i.__importDefault(a(115));t.default=function(e,t){var a=n.useState(t),i=a[0],r=a[1];return s.default((function(){var t=e.subscribe(r);return function(){return t.unsubscribe()}}),[e]),i}},115:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(9),n="undefined"!=typeof window?i.useLayoutEffect:i.useEffect;t.default=n},134:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(135);case"v8light":return a(137)}},135:function(e,t,a){var i=a(63),n=a(136);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);i(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},136:function(e,t,a){(t=a(64)(!1)).push([e.i,'@media only screen and (min-width:768px) and (max-width:991px){.visNavItem__goToLens{margin-right:12px;position:relative}}@media only screen and (min-width:992px) and (max-width:1199px){.visNavItem__goToLens{margin-right:12px;position:relative}}@media only screen and (min-width:1200px){.visNavItem__goToLens{margin-right:12px;position:relative}}@media only screen and (min-width:768px) and (max-width:991px){.visNavItem__goToLens:after{border-right:1px solid #343741;bottom:0;content:"";display:block;pointer-events:none;position:absolute;right:-8px;top:0}}@media only screen and (min-width:992px) and (max-width:1199px){.visNavItem__goToLens:after{border-right:1px solid #343741;bottom:0;content:"";display:block;pointer-events:none;position:absolute;right:-8px;top:0}}@media only screen and (min-width:1200px){.visNavItem__goToLens:after{border-right:1px solid #343741;bottom:0;content:"";display:block;pointer-events:none;position:absolute;right:-8px;top:0}}',""]),e.exports=t},137:function(e,t,a){var i=a(63),n=a(138);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);i(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},138:function(e,t,a){(t=a(64)(!1)).push([e.i,'@media only screen and (min-width:768px) and (max-width:991px){.visNavItem__goToLens{margin-right:12px;position:relative}}@media only screen and (min-width:992px) and (max-width:1199px){.visNavItem__goToLens{margin-right:12px;position:relative}}@media only screen and (min-width:1200px){.visNavItem__goToLens{margin-right:12px;position:relative}}@media only screen and (min-width:768px) and (max-width:991px){.visNavItem__goToLens:after{border-right:1px solid #d3dae6;bottom:0;content:"";display:block;pointer-events:none;position:absolute;right:-8px;top:0}}@media only screen and (min-width:992px) and (max-width:1199px){.visNavItem__goToLens:after{border-right:1px solid #d3dae6;bottom:0;content:"";display:block;pointer-events:none;position:absolute;right:-8px;top:0}}@media only screen and (min-width:1200px){.visNavItem__goToLens:after{border-right:1px solid #d3dae6;bottom:0;content:"";display:block;pointer-events:none;position:absolute;right:-8px;top:0}}',""]),e.exports=t},63:function(e,t,a){"use strict";var i,n=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),s=[];function r(e){for(var t=-1,a=0;a<s.length;a++)if(s[a].identifier===e){t=a;break}return t}function o(e,t){for(var a={},i=[],n=0;n<e.length;n++){var o=e[n],l=t.base?o[0]+t.base:o[0],d=a[l]||0,c="".concat(l," ").concat(d);a[l]=d+1;var u=r(c),v={css:o[1],media:o[2],sourceMap:o[3]};-1!==u?(s[u].references++,s[u].updater(v)):s.push({identifier:c,updater:f(v,t),references:1}),i.push(c)}return i}function l(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var s=a.nc;s&&(i.nonce=s)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var r=n(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var d,c=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function u(e,t,a,i){var n=a?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=c(t,n);else{var s=document.createTextNode(n),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(s,r[t]):e.appendChild(s)}}function v(e,t,a){var i=a.css,n=a.media,s=a.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var p=null,g=0;function f(e,t){var a,i,n;if(t.singleton){var s=g++;a=p||(p=l(t)),i=u.bind(null,a,s,!1),n=u.bind(null,a,s,!0)}else a=l(t),i=v.bind(null,a,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var a=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<a.length;i++){var n=r(a[i]);s[n].references--}for(var l=o(e,t),d=0;d<a.length;d++){var c=r(a[d]);0===s[c].references&&(s[c].updater(),s.splice(c,1))}a=l}}}},64:function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a,i,n,s=e[1]||"",r=e[3];if(!r)return s;if(t&&"function"==typeof btoa){var o=(a=r,i=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(n," */")),l=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[s].concat(l).concat([o]).join("\n")}return[s].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,i){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(i)for(var s=0;s<this.length;s++){var r=this[s][0];null!=r&&(n[r]=!0)}for(var o=0;o<e.length;o++){var l=[].concat(e[o]);i&&n[l[0]]||(a&&(l[2]?l[2]="".concat(a," and ").concat(l[2]):l[2]=a),t.push(l))}},t}},65:function(e,t,a){e.exports=a(41)(6)},67:function(e,t,a){e.exports=a(41)(3)},69:function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return L})),a.d(t,"b",(function(){return w})),a.d(t,"a",(function(){return N})),a.d(t,"f",(function(){return V})),a.d(t,"g",(function(){return B})),a.d(t,"i",(function(){return k})),a.d(t,"k",(function(){return H})),a.d(t,"m",(function(){return Z})),a.d(t,"j",(function(){return X})),a.d(t,"l",(function(){return ee})),a.d(t,"h",(function(){return te}));var i=a(9),n=a.n(i),s=a(10),r=a(2),o=a(15),l=a(4);const d=()=>({field:"typeTitle",name:r.i18n.translate("visualizations.listing.table.typeColumnName",{defaultMessage:"Type"}),sortable:!0,width:"150px",render:(e,t)=>{return t.error?Object(l.jsx)(s.EuiBadge,{iconType:"alert",color:"warning"},t.error):Object(l.jsx)("span",null,(e=>{let t;return t=e.image?Object(l.jsx)("img",{className:"visListingTable__typeImage","aria-hidden":"true",alt:"",src:e.image}):Object(l.jsx)(s.EuiIcon,{className:"visListingTable__typeIcon","aria-hidden":"true",type:e.icon||"empty",size:"m"}),t})(t),t.typeTitle,"beta"===(a=t).stage?Object(l.jsx)(s.EuiBetaBadge,{className:"visListingTable__betaIcon",label:"B",title:r.i18n.translate("visualizations.listing.betaTitle",{defaultMessage:"Beta"}),tooltipContent:r.i18n.translate("visualizations.listing.betaTooltip",{defaultMessage:"This visualization is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features"})}):"experimental"===a.stage?Object(l.jsx)(s.EuiBetaBadge,{className:"visListingTable__experimentalIcon",label:"E",title:r.i18n.translate("visualizations.listing.experimentalTitle",{defaultMessage:"Technical preview"}),tooltipContent:r.i18n.translate("visualizations.listing.experimentalTooltip",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."})}):void 0);var a}}),c=e=>Object(l.jsx)(s.EuiEmptyPrompt,{iconType:"visualizeApp",title:Object(l.jsx)("h1",{id:"visualizeListingHeading","data-test-subj":"emptyListPrompt"},Object(l.jsx)(o.FormattedMessage,{id:"visualizations.listing.createNew.title",defaultMessage:"Create your first visualization"})),body:Object(l.jsx)("p",null,Object(l.jsx)(o.FormattedMessage,{id:"visualizations.listing.createNew.description",defaultMessage:"You can create different visualizations based on your data."})),actions:Object(l.jsx)(s.EuiButton,{onClick:e,fill:!0,iconType:"plusInCircle","data-test-subj":"newItemButton"},Object(l.jsx)(o.FormattedMessage,{id:"visualizations.listing.createNew.createButtonLabel",defaultMessage:"Create new visualization"}))});var u=a(47),v=a.n(u),p=a(73),g=a(16),f=a(48),b=a(53),h=a(3),m=a(8),S=a(42),y=a(5);const j=r.i18n.translate("visualizations.editor.defaultEditBreadcrumbText",{defaultMessage:"Edit visualization"});function O(){return[{text:r.i18n.translate("visualizations.listing.breadcrumb",{defaultMessage:"Visualize Library"}),href:`#${y.VisualizeConstants.LANDING_PAGE_PATH}`}]}function T({byValue:e,originatingAppName:t,redirectToOrigin:a},i=j){return[...t?[{text:t,onClick:a}]:[],...e?[]:O(),{text:i}]}var I=a(36),x=a(1),z=a(19);const w=(e,t)=>{e.setHelpExtension({appName:r.i18n.translate("visualizations.helpMenu.appName",{defaultMessage:"Visualize Library"}),links:[{linkType:"documentation",href:`${t.links.visualize.guide}`}]})},N=e=>{e.setBadge({text:r.i18n.translate("visualizations.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:r.i18n.translate("visualizations.badge.readOnly.tooltip",{defaultMessage:"Unable to save visualizations to the library"}),iconType:"glasses"})},M=({data:e})=>e.query.queryString.getDefaultQuery(),E=(e,t)=>{var a,i;const n=e.vis,s=Object(m.a)(n.serialize()),r="savedVis"in e?e.savedVis:void 0;return{uiState:r&&r.uiStateJSON?JSON.parse(r.uiStateJSON):n.uiState.toJSON(),query:(null===(a=n.data.searchSource)||void 0===a?void 0:a.getOwnField("query"))||M(t),filters:(null===(i=n.data.searchSource)||void 0===i?void 0:i.getOwnField("filter"))||[],vis:{...s.visState,title:n.title},linked:r&&r.id?!!r.savedSearchId:!!s.savedSearchId}};function A(e){return`#/${e.location.pathname}${e.location.search}`}function V(e){return Boolean(e&&!e.isPersisted())}a(134);const C=Object(b.withSuspense)(b.LazySavedObjectSaveModalDashboard),_=e=>!!e.visualize&&!!e.visualize.show,L=({hasUnsavedChanges:e,setHasUnsavedChanges:t,openInspector:a,originatingApp:i,originatingPath:s,setOriginatingApp:o,hasUnappliedChanges:d,visInstance:c,stateContainer:u,visualizationIdFromUrl:b,stateTransfer:j,embeddableId:O,editInLensConfig:w,displayEditInLensItem:N,hideLensBadge:M,setNavigateToLens:E,showBadge:V},{data:L,application:B,chrome:P,overlays:k,history:F,share:q,setActiveUrl:D,toastNotifications:U,visualizeCapabilities:R,dashboardCapabilities:H,i18n:{Context:$},savedObjectsTagging:G,presentationUtil:J,getKibanaVersion:K,savedObjects:Q,theme:W})=>{const{vis:Y,embeddableHandler:Z}=c,X=c.savedVis;async function ee(e){var a;const n=!Boolean(X.id)||e.copyOnSave;u.transitions.setVis({title:X.title}),X.savedSearchId=Y.data.savedSearchId,X.searchSourceFields=null===(a=Y.data.searchSource)||void 0===a?void 0:a.getSerializedFields(),X.visState=u.getState().vis,X.uiStateJSON=Y.uiState.toString(),t(!1);try{const t=await Object(m.f)(X,e,{savedObjectsClient:Q.client,overlays:k,savedObjectsTagging:G});if(t)if(U.addSuccess({title:r.i18n.translate("visualizations.topNavMenu.saveVisualization.successNotificationText",{defaultMessage:"Saved '{visTitle}'",values:{visTitle:X.title}}),"data-test-subj":"saveVisualizationSuccess"}),P.recentlyAccessed.add(Object(S.getFullPath)(t),X.title,String(t)),i&&e.returnToOrigin||e.dashboardId){if(!O){const e=`${y.VisualizeConstants.EDIT_PATH}/${encodeURIComponent(t)}`;F.replace(e),D(e)}const a=i||"dashboards";let n;e.dashboardId?n="new"===e.dashboardId?"#/create":`#/view/${e.dashboardId}`:s&&(n=s),j?j.navigateToWithEmbeddablePackage(a,{state:{type:S.VISUALIZE_EMBEDDABLE_TYPE,input:{savedObjectId:t},embeddableId:e.copyOnSave?void 0:O,searchSessionId:L.search.session.getSessionId()},path:n}):B.navigateToApp(a,{path:n})}else o&&i&&n&&(o(void 0),j.clearEditorState(y.VisualizeConstants.APP_ID)),P.docTitle.change(X.lastSavedTitle),P.setBreadcrumbs(T({},X.lastSavedTitle)),t!==b&&F.replace({...F.location,pathname:`${y.VisualizeConstants.EDIT_PATH}/${t}`});return{id:t}}catch(e){return console.error(e),U.addDanger({title:r.i18n.translate("visualizations.topNavMenu.saveVisualization.failureNotificationText",{defaultMessage:"Error on saving '{visTitle}'",values:{visTitle:X.title}}),text:e.message,"data-test-subj":"saveVisualizationError"}),{error:e}}}const te=!X.id&&i?r.i18n.translate("visualizations.topNavMenu.saveVisualizationToLibraryButtonLabel",{defaultMessage:"Save to library"}):i&&X.id?r.i18n.translate("visualizations.topNavMenu.saveVisualizationAsButtonLabel",{defaultMessage:"Save as"}):r.i18n.translate("visualizations.topNavMenu.saveVisualizationButtonLabel",{defaultMessage:"Save"}),ae=R.save||!i&&H.showWriteControls;return[...N?[{id:"goToLens",label:r.i18n.translate("visualizations.topNavMenu.goToLensButtonLabel",{defaultMessage:"Edit visualization in Lens"}),emphasize:!1,description:r.i18n.translate("visualizations.topNavMenu.goToLensButtonAriaLabel",{defaultMessage:"Go to Lens with your current configuration"}),className:"visNavItem__goToLens",disableButton:!w,testId:"visualizeEditInLensButton",...V&&{badge:{label:r.i18n.translate("visualizations.tonNavMenu.tryItBadgeText",{defaultMessage:"Try it"}),color:"accent"}},run:async()=>{const e={...w,savedObjectId:c.vis.id,embeddableId:O,vizEditorOriginatingAppUrl:A(F),originatingApp:i};w&&(M(),E(!0),Object(x.r)().getTrigger(z.b).exec(e))}}]:[],{id:"inspector",label:r.i18n.translate("visualizations.topNavMenu.openInspectorButtonLabel",{defaultMessage:"inspect"}),description:r.i18n.translate("visualizations.topNavMenu.openInspectorButtonAriaLabel",{defaultMessage:"Open Inspector for visualization"}),testId:"openInspectorButton",disableButton:()=>!Z.hasInspector||!Z.hasInspector(),run:a,tooltip(){if(!Z.hasInspector||!Z.hasInspector())return r.i18n.translate("visualizations.topNavMenu.openInspectorDisabledButtonTooltip",{defaultMessage:"This visualization doesn't support any inspectors."})}},{id:"share",label:r.i18n.translate("visualizations.topNavMenu.shareVisualizationButtonLabel",{defaultMessage:"share"}),description:r.i18n.translate("visualizations.topNavMenu.shareVisualizationButtonAriaLabel",{defaultMessage:"Share Visualization"}),testId:"shareTopNavButton",run:t=>{if(q){var a,i,n,s,o,l;const g=u.getState(),f=Object(p.parse)(F.location.search),b={visId:null==X?void 0:X.id,filters:g.filters,refreshInterval:void 0,timeRange:L.query.timefilter.timefilter.getTime(),uiState:g.uiState,query:g.query,vis:g.vis,linked:g.linked,indexPattern:null!==(a=null===(i=c.savedSearch)||void 0===i||null===(n=i.searchSource)||void 0===n||null===(s=n.getField("index"))||void 0===s?void 0:s.id)&&void 0!==a?a:f.indexPattern,savedSearchId:null!==(o=null===(l=c.savedSearch)||void 0===l?void 0:l.id)&&void 0!==o?o:f.savedSearchId};q.toggleShareContextMenu({anchorElement:t,allowEmbed:!0,allowShortUrl:Boolean(R.createShortUrl),shareableUrl:Object(h.unhashUrl)(window.location.href),objectId:null==X?void 0:X.id,objectType:"visualization",sharingData:{title:(null==X?void 0:X.title)||r.i18n.translate("visualizations.reporting.defaultReportTitle",{defaultMessage:"Visualization [{date}]",values:{date:v()().toISOString(!0)}}),locatorParams:{id:I.a,version:K(),params:b}},isDirty:d||e,showPublicUrlSwitch:_})}},disableButton:!q||Boolean(!X.id&&i)},...i?[{id:"cancel",label:r.i18n.translate("visualizations.topNavMenu.cancelButtonLabel",{defaultMessage:"Cancel"}),emphasize:!1,description:r.i18n.translate("visualizations.topNavMenu.cancelButtonAriaLabel",{defaultMessage:"Return to the last app without saving changes"}),testId:"visualizeCancelAndReturnButton",tooltip(){if(d||e)return r.i18n.translate("visualizations.topNavMenu.cancelAndReturnButtonTooltip",{defaultMessage:"Discard your changes before finishing"})},run:async()=>{i&&B.navigateToApp(i)}}]:[],...ae?[{id:"save",iconType:i?void 0:"save",label:te,emphasize:!i,description:r.i18n.translate("visualizations.topNavMenu.saveVisualizationButtonAriaLabel",{defaultMessage:"Save Visualization"}),testId:"visualizeSaveButton",disableButton:d,tooltip(){if(d)return r.i18n.translate("visualizations.topNavMenu.saveVisualizationDisabledButtonTooltip",{defaultMessage:"Apply or Discard your changes before saving"})},run:()=>{const e=async({newTitle:e,newCopyOnSave:t,isTitleDuplicateConfirmed:a,onTitleDuplicate:i,newDescription:n,returnToOrigin:r,dashboardId:o,addToLibrary:l})=>{const d=X.title;X.title=e,Z.updateInput({title:e}),X.description=n,G&&(X.tags=s);const c={confirmOverwrite:!1,isTitleDuplicateConfirmed:a,onTitleDuplicate:i,returnToOrigin:r,dashboardId:o||void 0,copyOnSave:t};if(o&&!l){const t=`${y.VisualizeConstants.LANDING_PAGE_PATH}`;F.replace(t),D(t);const a={input:{savedVis:{...Y.serialize(),title:e,description:n}},embeddableId:O,type:S.VISUALIZE_EMBEDDABLE_TYPE,searchSessionId:L.search.session.getSessionId()},i="new"===o?"#/create":`#/view/${o}`;return j.navigateToWithEmbeddablePackage("dashboards",{state:a,path:i}),{id:!0}}const u=await ee(c);return u.id&&!u.error||(X.title=d),u};let t,a,s=[];G&&(s=X.tags||[],t=Object(l.jsx)(G.ui.components.SavedObjectSaveModalTagSelector,{initialSelection:s,onTagsSelected:e=>{s=e}})),a=i?Object(l.jsx)(f.SavedObjectSaveModalOrigin,{documentInfo:X||{title:""},onSave:e,options:t,getAppNameFromId:j.getAppNameFromId,objectType:r.i18n.translate("visualizations.topNavMenu.saveVisualizationObjectType",{defaultMessage:"visualization"}),onClose:()=>{},originatingApp:i,returnToOriginSwitchLabel:i&&O?r.i18n.translate("visualizations.topNavMenu.updatePanel",{defaultMessage:"Update panel on {originatingAppName}",values:{originatingAppName:j.getAppNameFromId(i)}}):void 0}):Object(l.jsx)(C,{documentInfo:{id:R.save?null==X?void 0:X.id:void 0,title:(null==X?void 0:X.title)||"",description:(null==X?void 0:X.description)||""},canSaveByReference:Boolean(R.save),onSave:e,tagOptions:t,objectType:r.i18n.translate("visualizations.topNavMenu.saveVisualizationObjectType",{defaultMessage:"visualization"}),onClose:()=>{}}),Object(f.showSaveModal)(a,$,(({children:e})=>{const t=i?n.a.Fragment:J.ContextProvider;return Object(l.jsx)(g.KibanaThemeProvider,{theme$:W.theme$},Object(l.jsx)(t,null,e))}))}}]:[],...i?[{id:"saveAndReturn",label:r.i18n.translate("visualizations.topNavMenu.saveAndReturnVisualizationButtonLabel",{defaultMessage:"Save and return"}),emphasize:!0,iconType:"checkInCircleFilled",description:r.i18n.translate("visualizations.topNavMenu.saveAndReturnVisualizationButtonAriaLabel",{defaultMessage:"Finish editing visualization and return to the last app"}),testId:"visualizesaveAndReturnButton",disableButton:d,tooltip(){if(d)return r.i18n.translate("visualizations.topNavMenu.saveAndReturnVisualizationDisabledButtonTooltip",{defaultMessage:"Apply or Discard your changes before finishing"})},run:async()=>null!=X&&X.id?ee({confirmOverwrite:!1,returnToOrigin:!0}):(()=>{if(!i)return;const e={input:{savedVis:Y.serialize()},embeddableId:O,type:S.VISUALIZE_EMBEDDABLE_TYPE,searchSessionId:L.search.session.getSessionId()};j.navigateToWithEmbeddablePackage(i,{state:e,path:s})})()}]:[]]},B=e=>{const[t,a]=Object(i.useState)();return Object(i.useEffect)((()=>{const t=e.getIsVisible$().subscribe((e=>{a(e)}));return()=>t.unsubscribe()}),[e]),t};var P=a(6);const k=(e,t,a,n,s,r)=>{const[o,l]=Object(i.useState)(!1),[d,c]=Object(i.useState)();return Object(i.useEffect)((()=>{if(n&&s){const{timefilter:{timefilter:i},filterManager:o,queryString:d,state$:u}=e.data.query,{embeddableHandler:v,savedSearch:p,vis:g}=s,f="savedVis"in s?s.savedVis:void 0,b=n.getState();c(b);const h=()=>{r?r.render({core:e,data:e.data,uiState:g.uiState,timeRange:i.getTime(),filters:o.getFilters(),query:d.getQuery(),linked:!!g.data.savedSearchId,savedSearch:p,unifiedSearch:e.unifiedSearch}):v.updateInput({timeRange:i.getTime(),filters:o.getFilters(),query:d.getQuery(),searchSessionId:e.data.search.session.getSessionId()})},S=u.subscribe({next:()=>{e.data.search.session.start(),h()},error:e.fatalErrors.add}),y=e=>{e&&f&&!f.savedSearchId&&p?(f.savedSearchId=p.id,g.data.savedSearchId=p.id,g.data.searchSource&&g.data.searchSource.setParent(p.searchSource)):!e&&f&&f.savedSearchId?(delete f.savedSearchId,delete g.data.savedSearchId):e||f||delete g.data.savedSearchId};b.uiState&&g.uiState.setSilent(b.uiState);const j=()=>{n.transitions.set("uiState",g.uiState.getChanges())};g.uiState.on("change",j);const O=e.data.search.session.getSession$().subscribe((e=>{v.getInput().searchSessionId!==e&&v.updateInput({searchSessionId:e})})),T=n.subscribe((i=>{if(c(i),!f||!f.id||e.history.location.pathname.includes(f.id)){if(Object(P.isEqual)(i.uiState,g.uiState.getChanges())||g.uiState.set(i.uiState),f&&!Object(P.isEqual)({...Object(m.a)(g.serialize()).visState,title:g.title},i.vis)){const{aggs:e,...a}=i.vis;g.setState({...a,data:{aggs:e}}),v.reload(),t.emit("updateEditor")}y(i.linked),g.data.searchSource&&(g.data.searchSource.setField("query",i.query),g.data.searchSource.setField("filter",i.filters)),h(),a(!0)}})),I=()=>l(!0);return t.on("embeddableRendered",I),h(),()=>{l(!1),t.off("embeddableRendered",I),S.unsubscribe(),g.uiState.off("change",j),T(),O.unsubscribe()}}}),[n,t,s,e,a,r]),{isEmbeddableRendered:o,currentAppState:d}};var F=a(49),q=a(50),D=a(32);const U=async(e,t)=>{const{data:a,createVisEmbeddableFromObject:i,savedObjects:n,spaces:s,savedObjectsTagging:r}=t;let o;if(e.data.savedSearchId){try{o=await Object(q.getSavedSearch)(e.data.savedSearchId,{search:a.search,savedObjectsClient:n.client,spaces:s,savedObjectsTagging:r})}catch(e){}o&&await Object(q.throwErrorOnSavedSearchUrlConflict)(o)}const l=await i(e,{id:"",timeRange:a.query.timefilter.timefilter.getTime(),filters:a.query.filterManager.getFilters(),searchSessionId:a.search.session.getSessionId(),renderMode:"edit"});return l.getOutput$().subscribe((e=>{e.error&&!function(e){const t=e.original||e;return t instanceof F.SavedFieldNotFound||t instanceof F.SavedFieldTypeInvalidForAgg}(e.error)&&a.search.showError(e.error.original||e.error)})),{savedSearch:o,embeddableHandler:l}},R=async(e,t)=>{const{data:a,savedObjects:i,spaces:n,savedObjectsTagging:s}=e,r=await Object(m.e)({search:a.search,savedObjectsClient:i.client,dataViews:a.dataViews,spaces:n,savedObjectsTagging:s},t);"string"!=typeof t&&(r.searchSourceFields={index:null==t?void 0:t.indexPattern});const o=Object(m.b)(r);let l=await Object(D.a)(o.type,o);if(l.type.setup)try{l=await l.type.setup(l)}catch{}const{embeddableHandler:d,savedSearch:c}=await U(l,e);return{vis:l,embeddableHandler:d,savedSearch:c,savedVis:r}},H=(e,t,a,n,s)=>{const[o,l]=Object(i.useState)({}),d=Object(i.useRef)(null),c=Object(i.useRef)("");return Object(i.useEffect)((()=>{var i;const{chrome:u,history:v,toastNotifications:g,stateTransferService:f,visEditorsRegistry:b,application:{navigateToApp:m}}=e,S=async()=>{try{let o;if("/create"===v.location.pathname){const t=Object(p.parse)(v.location.search),a=Object(x.p)().all().find((({name:e})=>e===t.type));if(!a)throw new Error(r.i18n.translate("visualizations.createVisualization.noVisTypeErrorMessage",{defaultMessage:"You must provide a valid visualization type"}));const i=a.requiresSearch&&a.options.showIndexSelection,n=t.indexPattern||t.savedSearchId;if(i&&!n)throw new Error(r.i18n.translate("visualizations.createVisualization.noIndexPatternOrSavedSearchIdErrorMessage",{defaultMessage:"You must provide either an indexPattern or a savedSearchId"}));o=await R(e,t)}else o=await R(e,s);const{embeddableHandler:c,savedVis:g,vis:h}=o,S=n?f.getAppNameFromId(n):void 0,y=n?()=>m(n):void 0;let j;if(g.id?(u.setBreadcrumbs(T({originatingAppName:S,redirectToOrigin:y},g.title)),u.docTitle.change(g.title)):u.setBreadcrumbs(function({byValue:e,originatingAppName:t,redirectToOrigin:a}){return[...t?[{text:t,onClick:a}]:[],...e?[]:O(),{text:r.i18n.translate("visualizations.editor.createBreadcrumb",{defaultMessage:"Create"})}]}({byValue:Boolean(n),originatingAppName:S,redirectToOrigin:y})),d.current)if(a){var i;const e=b.get(null===(i=h.type.editorConfig)||void 0===i?void 0:i.editor);e&&(j=new e(d.current,h,t,c))}else c.render(d.current);l({savedVisInstance:o,visEditorController:j})}catch(t){try{((e,t,a)=>{const{history:i,setActiveUrl:n,toastNotifications:s,http:{basePath:r},application:{navigateToApp:o}}=e,l={app:"management",path:`kibana/objects/savedVisualizations/${a}`};Object(h.redirectWhenMissing)({history:i,navigateToApp:o,toastNotifications:s,basePath:r,mapping:{visualization:y.VisualizeConstants.LANDING_PAGE_PATH,search:l,"index-pattern":l,"index-pattern-field":l},onBeforeRedirect(){n(y.VisualizeConstants.LANDING_PAGE_PATH)},theme:e.theme})(t)})(e,t,s)}catch(e){g.addWarning({title:r.i18n.translate("visualizations.createVisualization.failedToLoadErrorMessage",{defaultMessage:"Failed to load the visualization"}),text:e.message}),v.replace(y.VisualizeConstants.LANDING_PAGE_PATH)}}};void 0!==a&&(c.current?s&&c.current!==s&&(null===(i=o.savedVisInstance)||void 0===i?void 0:i.savedVis.id)!==s&&(c.current=s,l({}),S()):(c.current=s||"new",S()))}),[e,t,n,a,s,o.savedVisInstance,o.visEditorController]),Object(i.useEffect)((()=>()=>{var e;o.visEditorController?o.visEditorController.destroy():null!==(e=o.savedVisInstance)&&void 0!==e&&e.embeddableHandler&&o.savedVisInstance.embeddableHandler.destroy()}),[o]),{...o,visEditorRef:d}};var $=a(20),G=a(76),J=a(7);function K(e){if("table"!==e.vis.type)return e;const t=Object(P.get)(e,"vis.aggs");if(t){let a=0;const i=t.map((e=>("split"!==e.schema||(a++,1===a||(e.schema="bucket",e.params=Object(P.omit)(e.params,["row"]))),e)));if(a<=1)return e;e.vis.aggs=i}return e}const Q="_a";function W(e){return Object(P.omitBy)(e,((e,t)=>"$"===t.charAt(0)||"_"===t.charAt(0)||Object(P.isFunction)(e)))}const Y={set:e=>(t,a)=>({...e,[t]:a}),setVis:e=>t=>({...e,vis:{...e.vis,...t}}),unlinkSavedSearch:e=>({query:t,parentFilters:a=[]})=>({...e,query:t||e.query,filters:Object(P.union)(e.filters,a),linked:!1}),updateDataView:e=>t=>({...e,dataView:t}),updateVisState:e=>t=>({...e,vis:W(t)}),updateSavedQuery:e=>t=>{const a={...e,savedQuery:t};return t||delete a.savedQuery,a}};const Z=(e,t,a)=>{const[n,s]=Object(i.useState)(!1),[o,d]=Object(i.useState)(null);return Object(i.useEffect)((()=>{if(a){const o=E(a,e),c=!("savedVis"in a),{stateContainer:u,stopStateSync:v}=function({stateDefaults:e,kbnUrlStateStorage:t,byValue:a}){return a?function(e){const t=K({...e});return{stateContainer:Object(h.createStateContainer)(t,Y),stopStateSync:()=>{}}}(e):function({stateDefaults:e,kbnUrlStateStorage:t}){const a=K({...e,...t.get(Q)});t.set(Q,a,{replace:!0});const i=Object(h.createStateContainer)(a,Y),{start:n,stop:s}=Object(h.syncState)({storageKey:Q,stateContainer:{...i,set:e=>{e&&i.set(e)}},stateStorage:t});return n(),{stateContainer:i,stopStateSync:s}}({stateDefaults:e,kbnUrlStateStorage:t})}({stateDefaults:o,kbnUrlStateStorage:e.kbnUrlStateStorage,byValue:c}),p=u.getState(),f=({isDirty:t})=>{t||u.transitions.updateVisState(E(a,e).vis),s(t)};t.on("dirtyStateChange",f);const{filterManager:b,queryString:m}=e.data.query;b.setAppFilters(Object(P.cloneDeep)(p.filters)),m.setQuery((n=p.query,Object(P.has)(n,"language")?n:{query:n,language:"lucene"}));const S=Object(J.connectToQueryState)(e.data.query,{set:({filters:e,query:t})=>{u.transitions.set("filters",e),u.transitions.set("query",t)},get:()=>({filters:u.getState().filters,query:u.getState().query}),state$:u.state$.pipe(Object($.map)((e=>({filters:e.filters,query:e.query}))))},{filters:G.a.APP_STATE,query:!0});if(Object(P.isEqual)(p.vis,o.vis)&&Object(P.isEqual)(p.query,o.query)&&Object(P.isEqual)(p.filters,o.filters))d(u);else{var i;const{aggs:t,...n}=p.vis,s=p.query,o=p.filters,c=(null===(i=a.vis.data.searchSource)||void 0===i?void 0:i.getSerializedFields())||{};a.vis.setState({...n,data:{aggs:t,searchSource:{...c,query:s,filter:o},savedSearchId:a.vis.data.savedSearchId}}).then((()=>{d(u)})).catch((t=>{e.toastNotifications.addWarning({title:r.i18n.translate("visualizations.visualizationLoadingFailedErrorMessage",{defaultMessage:"Failed to load the visualization"}),text:Object(g.toMountPoint)(Object(l.jsx)(g.KibanaThemeProvider,{theme$:e.theme.theme$},Object(l.jsx)(g.MarkdownSimple,null,t.message)))}),e.history.replace(`${y.VisualizeConstants.LANDING_PAGE_PATH}?notFound=visualization`)}))}return()=>{t.off("dirtyStateChange",f),v(),S()}}var n}),[t,a,e]),{appState:o,hasUnappliedChanges:n}},X=(e,t,a,n)=>{Object(i.useEffect)((()=>{if(a&&n&&n.savedSearch&&n.vis.data.searchSource){const{savedSearch:i}=n,{searchSource:s}=n.vis.data,o=()=>{const t=i.searchSource,o=null==t?void 0:t.getParent(),l=null==t?void 0:t.getField("index");n.savedSearch=void 0,n.vis.data.savedSearchId=void 0,s.setField("index",l),s.setParent(o),a.transitions.unlinkSavedSearch({query:null==t?void 0:t.getField("query"),parentFilters:(null==t?void 0:t.getOwnField("filter"))||[]}),e.toastNotifications.addSuccess(r.i18n.translate("visualizations.linkedToSearch.unlinkSuccessNotificationText",{defaultMessage:"Unlinked from saved search '{searchTitle}'",values:{searchTitle:i.title}}))};return t.on("unlinkFromSavedSearch",o),()=>{t.off("unlinkFromSavedSearch",o)}}}),[a,t,n,e.toastNotifications])},ee=(e,t,a,n,s,r)=>{const[o,l]=Object(i.useState)({}),d=Object(i.useRef)(null),c=Object(i.useRef)(!1);return Object(i.useEffect)((()=>{const{chrome:a,application:{navigateToApp:i},stateTransferService:o,visEditorsRegistry:u}=e;(async()=>{var v;if(!n||c.current||!d.current)return;const p=await(async(e,t)=>{const{data:a,savedObjects:i,spaces:n,savedObjectsTagging:s}=e,r=t.savedVis,o=await Object(m.e)({search:a.search,savedObjectsClient:i.client,dataViews:a.dataViews,spaces:n,savedObjectsTagging:s});r.uiState&&0!==Object.keys(r.uiState).length&&(o.uiStateJSON=JSON.stringify(r.uiState));let l=await Object(D.a)(r.type,Object(P.cloneDeep)(r));if(l.type.setup)try{l=await l.type.setup(l)}catch{}const{embeddableHandler:d,savedSearch:c}=await U(l,e);return{vis:l,savedVis:o,embeddableHandler:d,savedSearch:c}})(e,n),{embeddableHandler:g,vis:f}=p;let b;const h=u.get(null===(v=f.type.editorConfig)||void 0===v?void 0:v.editor);h&&(b=new h(d.current,f,t,g));const S=s?o.getAppNameFromId(s):void 0,y=s?()=>i(s,{path:r}):void 0;null==a||a.setBreadcrumbs(T({byValue:!0,originatingAppName:S,redirectToOrigin:y})),c.current=!0,l({byValueVisInstance:p,visEditorController:b})})()}),[t,a,e,o.byValueVisInstance,o.visEditorController,n,s,r]),Object(i.useEffect)((()=>()=>{var e;o.visEditorController?o.visEditorController.destroy():null!==(e=o.byValueVisInstance)&&void 0!==e&&e.embeddableHandler&&o.byValueVisInstance.embeddableHandler.destroy()}),[o]),{...o,visEditorRef:d}},te=(e,t,a,n)=>{Object(i.useEffect)((()=>{let i;if(a&&n){const s=async({dataView:a})=>{if(a&&n.vis.data.indexPattern&&a!==n.vis.data.indexPattern.id){const i=await e.dataViews.get(a);i&&(((e,t,a)=>{var i;const n=t.vis.serialize();t.vis.data.indexPattern=a,null===(i=t.vis.data.searchSource)||void 0===i||i.setField("index",a),t.vis.data.aggs=e.data.search.aggs.createAggConfigs(a,n.data.aggs),t.vis.data.savedSearchId=void 0})(e,n,i),n.embeddableHandler.reload(),t.emit("updateEditor"))}};s(a.getState()),i=a.state$.subscribe(s)}return()=>{var e;null===(e=i)||void 0===e||e.unsubscribe()}}),[a,t,e,n])}},70:function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return y})),a.d(t,"c",(function(){return f})),a.d(t,"d",(function(){return g}));var i=a(67),n=a.n(i),s=a(9),r=a.n(s),o=a(65),l=a.n(o),d=a(114),c=a.n(d),u=a(4),v=["children"],p=r.a.createContext(null),g=function(e){var t=e.children,a=l()(e,v),i=a.navigateToUrl,n=a.currentAppId;return Object(u.jsx)(p.Provider,{value:{navigateToUrl:i,currentAppId:n}},t)},f=function(e){var t=e.children,a=e.coreStart.application,i=a.navigateToUrl,n=a.currentAppId$,s=c()(n,void 0);return Object(u.jsx)(p.Provider,{value:{navigateToUrl:i,currentAppId:s}},t)},b=a(90),h=function(e){var t=e.children,a=e.navigateToUrl,i=e.currentAppId,n=e.className,r=Object(s.useRef)(null),o=Object(s.useCallback)((function(e){return function(e){var t=e.event,a=e.container,i=e.navigateToUrl;if(a&&e.currentAppId){var n=t.target,s=Object(b.a)(n,a);if(s){var r=s.href,o=""===s.target||"_self"===s.target,l=0===t.button;r&&o&&l&&!t.defaultPrevented&&!Object(b.b)(t)&&(t.preventDefault(),i(s.href))}}}({event:e,currentAppId:i,navigateToUrl:a,container:r.current})}),[i,a]);return Object(u.jsx)("div",{ref:r,onClick:o,className:n},t)},m=function(e){var t=e.className,a=e.children;return Object(u.jsx)(h,n()({},function(){var e=Object(s.useContext)(p);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),{className:t}),a)},S=["children","className"],y=function(e){var t=e.children,a=e.className,i=l()(e,S),n=Object(u.jsx)(m,{className:a},t);if(void 0!==i.coreStart){var s=i.coreStart;return Object(u.jsx)(f,{coreStart:s},n)}var r=i.navigateToUrl,o=i.currentAppId;return Object(u.jsx)(g,{currentAppId:o,navigateToUrl:r},n)}},90:function(e,t,a){"use strict";a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return v}));var i=a(9),n=a.n(i),s=a(10),r=a(4),o={name:"1azakc",styles:"text-align:center"},l=function(){var e=o;return Object(r.jsx)("div",{css:e},Object(r.jsx)(s.EuiLoadingSpinner,null))},d=a(67),c=a.n(d),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(r.jsx)(l,null);return n.a.forwardRef((function(a,n){return Object(r.jsx)(s.EuiErrorBoundary,null,Object(r.jsx)(i.Suspense,{fallback:t},Object(r.jsx)(e,c()({},a,{ref:n}))))}))},v=function(e){return e.metaKey||e.altKey||e.ctrlKey||e.shiftKey},p=function(e,t){var a=e;do{var i,n;if("a"===(null===(i=a)||void 0===i?void 0:i.tagName.toLowerCase()))return a;var s=null===(n=a)||void 0===n?void 0:n.parentElement;if(!s||s===document.body||s===t)break;a=s}while(parent||parent!==document.body||parent!==t)}}}]);