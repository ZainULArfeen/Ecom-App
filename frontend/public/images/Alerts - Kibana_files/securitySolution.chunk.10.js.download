/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[10],{600:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),s=a(320);const o=Object(n.createContext)(0),r=()=>Object(n.useContext)(o),l=i.a.memo((({children:e})=>{const{ref:t,width:a}=Object(s.b)();return i.a.createElement(i.a.Fragment,null,i.a.createElement(o.Provider,{value:a},e),i.a.createElement("div",{ref:t}))}));l.displayName="EventDetailsWidthProvider"},873:function(e,t,a){"use strict";a.d(t,"a",(function(){return Kt}));var n=a(4),i=a.n(n),s=a(17),o=a(47),r=a(24),l=a.n(r),d=a(22),c=a(15),u=a(575),m=a(1),p=a(96),v=a(76),b=a(7),f=a(91),g=a(94),y=a(3);const h={process:{hash:{md5:["177afc1eb0be88eb9983fb74111260c4"],sha256:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb"],sha1:["f573b85e9beb32121f1949217947b2adc6749e3d"]},entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTY5MjAtMTMyNDg5OTk2OTAuNDgzMzA3NzAw"],executable:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],name:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],pid:[6920],args:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"]},host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1518)"],name:["Windows"],version:["1809 (10.0.17763.1518)"],platform:["windows"],family:["windows"],kernel:["1809 (10.0.17763.1518)"]},mac:["aa:bb:cc:dd:ee:ff"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"],name:["win2019-endpoint-1"]},file:{mtime:["2020-11-04T21:40:51.494Z"],path:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],owner:["sean"],hash:{md5:["177afc1eb0be88eb9983fb74111260c4"],sha256:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb"],sha1:["f573b85e9beb32121f1949217947b2adc6749e3d"]},name:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],extension:["exe"],size:[1604112]},event:{category:["malware","intrusion_detection","process"],outcome:["success"],severity:[73],code:["malicious_file"],action:["execution"],id:["LsuMZVr+sdhvehVM++++Gp2Y"],kind:["alert"],created:["2020-11-04T21:41:30.533Z"],module:["endpoint"],type:["info","start","denied"],dataset:["endpoint.alerts"]},agent:{type:["endpoint"]},timestamp:"2020-11-04T21:41:30.533Z",message:["Malware Prevention Alert"],_id:"0dA2lXUBn9bLIbfPkY7d"};var w=a(361),E=a(355),x=a(278);const _=()=>{const e=Object(w.c)({eventAction:"execution",eventCategory:"process",eventType:"denied",skipRedundantFileDetails:!0,text:E.S});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:h,isDraggable:!1,timelineId:x.a}))},C=i.a.memo(_),j=[{_id:"1",data:[{field:"@timestamp",value:["2018-11-05T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"event.action",value:["Action"]},{field:"host.name",value:["apache"]},{field:"source.ip",value:["192.168.0.1"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["john.dee"]}],ecs:{_id:"1",timestamp:"2018-11-05T19:03:25.937Z",host:{name:["apache"],ip:["192.168.0.1"]},event:{id:["1"],action:["Action"],category:["Access"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.1"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["john.dee"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"3",data:[{field:"@timestamp",value:["2018-11-07T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["nginx"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["evan.davis"]}],ecs:{_id:"3",timestamp:"2018-11-07T19:03:25.937Z",host:{name:["nginx"],ip:["192.168.0.1"]},event:{id:["3"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[1]},source:{ip:["192.168.0.3"],port:[443]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["3"],name:["evan.davis"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"4",data:[{field:"@timestamp",value:["2018-11-08T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Attempted Administrator Privilege Gain"]},{field:"host.name",value:["suricata"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jenny.jones"]}],ecs:{_id:"4",timestamp:"2018-11-08T19:03:25.937Z",host:{name:["suricata"],ip:["192.168.0.1"]},event:{id:["4"],category:["Attempted Administrator Privilege Gain"],type:["Alert"],module:["suricata"],severity:[1]},source:{ip:["192.168.0.3"],port:[53]},destination:{ip:["192.168.0.3"],port:[6343]},suricata:{eve:{flow_id:[4],proto:[""],alert:{signature:["ET EXPLOIT NETGEAR WNR2000v5 hidden_lang_avi Stack Overflow (CVE-2016-10174)"],signature_id:[4]}}},user:{id:["4"],name:["jenny.jones"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"5",data:[{field:"@timestamp",value:["2018-11-09T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["becky.davis"]}],ecs:{_id:"5",timestamp:"2018-11-09T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["5"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.3"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["5"],name:["becky.davis"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"6",data:[{field:"@timestamp",value:["2018-11-10T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["braden.davis"]},{field:"source.ip",value:["192.168.0.6"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]}],ecs:{_id:"6",timestamp:"2018-11-10T19:03:25.937Z",host:{name:["braden.davis"],ip:["192.168.0.1"]},event:{id:["6"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.6"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"8",data:[{field:"@timestamp",value:["2018-11-12T19:03:25.937Z"]},{field:"event.severity",value:["2"]},{field:"event.category",value:["Web Application Attack"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.8"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"8",timestamp:"2018-11-12T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["8"],category:["Web Application Attack"],type:["Alert"],module:["suricata"],severity:[2]},suricata:{eve:{flow_id:[8],proto:[""],alert:{signature:["ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP Cookie"],signature_id:[8]}}},source:{ip:["192.168.0.8"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["8"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"7",data:[{field:"@timestamp",value:["2018-11-11T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.7"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"7",timestamp:"2018-11-11T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["7"],category:["Access"],type:["HTTP Request"],module:["apache"],severity:[3]},source:{ip:["192.168.0.7"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["7"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"9",data:[{field:"@timestamp",value:["2018-11-13T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.9"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"9",timestamp:"2018-11-13T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["9"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.9"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["9"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"10",data:[{field:"@timestamp",value:["2018-11-14T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.10"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"10",timestamp:"2018-11-14T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["10"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.10"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["10"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"11",data:[{field:"@timestamp",value:["2018-11-15T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.11"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"11",timestamp:"2018-11-15T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["11"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.11"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["11"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"12",data:[{field:"@timestamp",value:["2018-11-16T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.12"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"12",timestamp:"2018-11-16T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["12"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.12"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["12"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"2",data:[{field:"@timestamp",value:["2018-11-06T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Authentication"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.2"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["joe.bob"]}],ecs:{_id:"2",timestamp:"2018-11-06T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["2"],category:["Authentication"],type:["Authentication Success"],module:["authlog"],severity:[3]},source:{ip:["192.168.0.2"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["joe.bob"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"13",data:[{field:"@timestamp",value:["2018-13-12T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Web Application Attack"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.8"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]}],ecs:{_id:"13",timestamp:"2018-13-12T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["13"],category:["Web Application Attack"],type:["Alert"],module:["suricata"],severity:[1]},suricata:{eve:{flow_id:[13],proto:[""],alert:{signature:["ET WEB_SERVER Possible Attempt in HTTP Cookie"],signature_id:[13]}}},source:{ip:["192.168.0.8"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"14",data:[{field:"@timestamp",value:["2019-03-07T05:06:51.000Z"]},{field:"host.name",value:["zeek-franfurt"]},{field:"source.ip",value:["192.168.26.101"]},{field:"destination.ip",value:["192.168.238.205"]}],ecs:{_id:"14",timestamp:"2019-03-07T05:06:51.000Z",event:{module:["zeek"],dataset:["zeek.connection"]},host:{id:["37c81253e0fc4c46839c19b981be5177"],name:["zeek-franfurt"],ip:["207.154.238.205","10.19.0.5","fe80::d82b:9aff:fe0d:1e12"]},source:{ip:["185.176.26.101"],port:[44059]},destination:{ip:["207.154.238.205"],port:[11568]},geo:{region_name:["New York"],country_iso_code:["US"]},network:{transport:["tcp"]},zeek:{session_id:["C8DRTq362Fios6hw16"],connection:{local_resp:[!1],local_orig:[!1],missed_bytes:[0],state:["REJ"],history:["Sr"]}}}},{_id:"15",data:[{field:"@timestamp",value:["2019-03-07T00:51:28.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]},{field:"source.ip",value:["192.168.35.240"]},{field:"destination.ip",value:["192.168.67.3"]}],ecs:{_id:"15",timestamp:"2019-03-07T00:51:28.000Z",event:{module:["zeek"],dataset:["zeek.dns"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},source:{ip:["206.189.35.240"],port:[57475]},destination:{ip:["67.207.67.3"],port:[53]},geo:{region_name:["New York"],country_iso_code:["US"]},network:{transport:["udp"]},zeek:{session_id:["CyIrMA1L1JtLqdIuol"],dns:{AA:[!1],RD:[!1],trans_id:[65252],RA:[!1],TC:[!1]}}}},{_id:"16",data:[{field:"@timestamp",value:["2019-03-05T07:00:20.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]},{field:"source.ip",value:["192.168.35.240"]},{field:"destination.ip",value:["192.168.164.26"]}],ecs:{_id:"16",timestamp:"2019-03-05T07:00:20.000Z",event:{module:["zeek"],dataset:["zeek.http"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},source:{ip:["206.189.35.240"],port:[36220]},destination:{ip:["192.241.164.26"],port:[80]},geo:{region_name:["New York"],country_iso_code:["US"]},http:{version:["1.1"],request:{body:{bytes:[0]}},response:{status_code:[302],body:{bytes:[154]}}},zeek:{session_id:["CZLkpC22NquQJOpkwe"],http:{resp_mime_types:["text/html"],trans_depth:["3"],status_msg:["Moved Temporarily"],resp_fuids:["FzeujEPP7GTHmYPsc"],tags:[]}}}},{_id:"17",data:[{field:"@timestamp",value:["2019-02-28T22:36:28.000Z"]},{field:"host.name",value:["zeek-franfurt"]},{field:"source.ip",value:["192.168.77.171"]}],ecs:{_id:"17",timestamp:"2019-02-28T22:36:28.000Z",event:{module:["zeek"],dataset:["zeek.notice"]},host:{id:["37c81253e0fc4c46839c19b981be5177"],name:["zeek-franfurt"],ip:["207.154.238.205","10.19.0.5","fe80::d82b:9aff:fe0d:1e12"]},source:{ip:["8.42.77.171"]},zeek:{notice:{suppress_for:[3600],msg:["8.42.77.171 scanned at least 15 unique ports of host 207.154.238.205 in 0m0s"],note:["Scan::Port_Scan"],sub:["remote"],dst:["207.154.238.205"],dropped:[!1],peer_descr:["bro"]}}}},{_id:"18",data:[{field:"@timestamp",value:["2019-02-22T21:12:13.000Z"]},{field:"host.name",value:["zeek-sensor-amsterdam"]},{field:"source.ip",value:["192.168.66.184"]},{field:"destination.ip",value:["192.168.95.15"]}],ecs:{_id:"18",timestamp:"2019-02-22T21:12:13.000Z",event:{module:["zeek"],dataset:["zeek.ssl"]},host:{id:["2ce8b1e7d69e4a1d9c6bcddc473da9d9"],name:["zeek-sensor-amsterdam"]},source:{ip:["188.166.66.184"],port:[34514]},destination:{ip:["91.189.95.15"],port:[443]},geo:{region_name:["England"],country_iso_code:["GB"]},zeek:{session_id:["CmTxzt2OVXZLkGDaRe"],ssl:{cipher:["TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"],established:[!1],resumed:[!1],version:["TLSv12"]}}}},{_id:"19",data:[{field:"@timestamp",value:["2019-03-03T04:26:38.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]}],ecs:{_id:"19",timestamp:"2019-03-03T04:26:38.000Z",event:{module:["zeek"],dataset:["zeek.files"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},zeek:{session_id:["Cu0n232QMyvNtzb75j"],files:{session_ids:["Cu0n232QMyvNtzb75j"],timedout:[!1],local_orig:[!1],tx_host:["5.101.111.50"],source:["HTTP"],is_orig:[!1],overflow_bytes:[0],sha1:["fa5195a5dfacc9d1c68d43600f0e0262cad14dde"],duration:[0],depth:[0],analyzers:["MD5","SHA1"],mime_type:["text/plain"],rx_host:["206.189.35.240"],total_bytes:[88722],fuid:["FePz1uVEVCZ3I0FQi"],seen_bytes:[1198],missing_bytes:[0],md5:["f7653f1951693021daa9e6be61226e32"]}}}},{_id:"20",data:[{field:"@timestamp",value:["2019-03-13T05:42:11.815Z"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-sanfran"]},{field:"process.args",value:["gpgconf","--list-dirs","agent-socket"]}],ecs:{_id:"20",timestamp:"2019-03-13T05:42:11.815Z",event:{action:["executed"],module:["auditd"],category:["audit-rule"]},host:{id:["f896741c3b3b44bdb8e351a4ab6d2d7c"],name:["zeek-sanfran"],ip:["134.209.63.134","10.46.0.5","fe80::a0d9:16ff:fecf:e70b"]},user:{name:["alice"]},process:{pid:[5402],name:["gpgconf"],ppid:[5401],args:["gpgconf","--list-dirs","agent-socket"],executable:["/usr/bin/gpgconf"],title:["gpgconf --list-dirs agent-socket"],working_directory:["/"]}}},{_id:"21",data:[{field:"@timestamp",value:["2019-03-14T22:30:25.527Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["zeek-london"]},{field:"source.ip",value:["192.168.77.171"]},{field:"user.name",value:["root"]}],ecs:{_id:"21",timestamp:"2019-03-14T22:30:25.527Z",event:{action:["logged-in"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["14"],data:{terminal:["/dev/pts/0"],op:["login"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["/dev/pts/0"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["8.42.77.171"]},user:{name:["root"]},process:{pid:[17471],executable:["/usr/sbin/sshd"]}}},{_id:"22",data:[{field:"@timestamp",value:["2019-03-13T03:35:21.614Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["root"]}],ecs:{_id:"22",timestamp:"2019-03-13T03:35:21.614Z",event:{action:["disposed-credentials"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["340"],data:{acct:["alice"],terminal:["ssh"],op:["PAM:setcred"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["ssh"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["root"]},process:{pid:[21202],executable:["/usr/sbin/sshd"]}}},{_id:"23",data:[{field:"@timestamp",value:["2019-03-13T03:35:21.614Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["root"]}],ecs:{_id:"23",timestamp:"2019-03-13T03:35:21.614Z",event:{action:["ended-session"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["340"],data:{acct:["alice"],terminal:["ssh"],op:["PAM:session_close"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["ssh"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["root"]},process:{pid:[21202],executable:["/usr/sbin/sshd"]}}},{_id:"24",data:[{field:"@timestamp",value:["2019-03-18T23:17:01.645Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["root"]}],ecs:{_id:"24",timestamp:"2019-03-18T23:17:01.645Z",event:{action:["acquired-credentials"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["unset"],data:{acct:["root"],terminal:["cron"],op:["PAM:setcred"]},summary:{actor:{primary:["unset"],secondary:["root"]},object:{primary:["cron"],type:["user-session"]},how:["/usr/sbin/cron"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},user:{name:["root"]},process:{pid:[9592],executable:["/usr/sbin/cron"]}}},{_id:"25",data:[{field:"@timestamp",value:["2019-03-19T01:17:01.336Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["siem-kibana"]},{field:"user.name",value:["root"]}],ecs:{_id:"25",timestamp:"2019-03-19T01:17:01.336Z",event:{action:["started-session"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["2908"],data:{acct:["root"],terminal:["cron"],op:["PAM:session_open"]},summary:{actor:{primary:["root"],secondary:["root"]},object:{primary:["cron"],type:["user-session"]},how:["/usr/sbin/cron"]}},host:{id:["aa7ca589f1b8220002f2fc61c64cfbf1"],name:["siem-kibana"]},user:{name:["root"]},process:{pid:[725],executable:["/usr/sbin/cron"]}}},{_id:"26",data:[{field:"@timestamp",value:["2019-03-13T03:34:08.890Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["alice"]}],ecs:{_id:"26",timestamp:"2019-03-13T03:34:08.890Z",event:{action:["was-authorized"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["338"],data:{terminal:["/dev/pts/0"]},summary:{actor:{primary:["root"],secondary:["alice"]},object:{primary:["/dev/pts/0"],type:["user-session"]},how:["/sbin/pam_tally2"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["alice"]},process:{pid:[21170],executable:["/sbin/pam_tally2"]}}},{_id:"27",data:[{field:"@timestamp",value:["2019-03-22T19:13:11.026Z"]},{field:"event.action",value:["connected-to"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-london"]},{field:"destination.ip",value:["192.168.216.34"]},{field:"user.name",value:["alice"]}],ecs:{_id:"27",timestamp:"2019-03-22T19:13:11.026Z",event:{action:["connected-to"],module:["auditd"],category:["audit-rule"]},auditd:{result:["success"],session:["246"],summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["192.168.216.34"],secondary:["80"],type:["socket"]},how:["/usr/bin/wget"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},destination:{ip:["192.168.216.34"],port:[80]},user:{name:["alice"]},process:{pid:[1490],name:["wget"],ppid:[1476],executable:["/usr/bin/wget"],title:["wget www.example.com"]}}},{_id:"28",data:[{field:"@timestamp",value:["2019-03-26T22:12:18.609Z"]},{field:"event.action",value:["opened-file"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["root"]}],ecs:{_id:"28",timestamp:"2019-03-26T22:12:18.609Z",event:{action:["opened-file"],module:["auditd"],category:["audit-rule"]},auditd:{result:["success"],session:["242"],summary:{actor:{primary:["unset"],secondary:["root"]},object:{primary:["/proc/15990/attr/current"],type:["file"]},how:["/lib/systemd/systemd-journald"]}},file:{path:["/proc/15990/attr/current"],device:["00:00"],inode:["27672309"],uid:["0"],owner:["root"],gid:["0"],group:["root"],mode:["0666"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},user:{name:["root"]},process:{pid:[27244],name:["systemd-journal"],ppid:[1],executable:["/lib/systemd/systemd-journald"],title:["/lib/systemd/systemd-journald"],working_directory:["/"]}}},{_id:"29",data:[{field:"@timestamp",value:["2019-04-08T21:18:57.000Z"]},{field:"event.action",value:["user_login"]},{field:"event.category",value:null},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["Braden"]}],ecs:{_id:"29",event:{action:["user_login"],dataset:["login"],kind:["event"],module:["system"],outcome:["failure"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["128.199.212.120"]},user:{name:["Braden"]},process:{pid:[6278]}}},{_id:"30",data:[{field:"@timestamp",value:["2019-04-08T22:27:14.814Z"]},{field:"event.action",value:["process_started"]},{field:"event.category",value:null},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["Evan"]}],ecs:{_id:"30",event:{action:["process_started"],dataset:["login"],kind:["event"],module:["system"],outcome:["failure"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["128.199.212.120"]},user:{name:["Evan"]},process:{pid:[6278]}}},{_id:"31",data:[{field:"@timestamp",value:["2018-11-05T19:03:25.937Z"]},{field:"message",value:["I am a log file message"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"event.action",value:["Action"]},{field:"host.name",value:["apache"]},{field:"source.ip",value:["192.168.0.1"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["john.dee"]}],ecs:{_id:"1",timestamp:"2018-11-05T19:03:25.937Z",host:{name:["apache"],ip:["192.168.0.1"]},event:{id:["1"],action:["Action"],category:["Access"],module:["nginx"],severity:[3]},message:["I am a log file message"],source:{ip:["192.168.0.1"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["john.dee"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"32",data:[],ecs:{_id:"BuBP4W0BOpWiDweSoYSg",timestamp:"2019-10-18T23:59:15.091Z",threat:{enrichments:[{indicator:{provider:["indicator_provider"],reference:["https://example.com"]},matched:{atomic:["192.168.1.1"],field:["source.ip"],type:["ip"]},feed:{name:["feed_name"]}}]}}}];var k=a(881),S=a(471);const T=()=>{const e=Object(k.b)({actionName:"connected-to",text:S.T});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:j[26].ecs,isDraggable:!1,timelineId:x.a}))},N=i.a.memo(T),O=()=>{const e=Object(k.c)({actionName:"opened-file",text:`${S.Db} ${S.kc}`});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:j[27].ecs,isDraggable:!1,timelineId:x.a}))},I=i.a.memo(O),R={file:{path:["C:\\Windows\\System32\\bcrypt.dll"],hash:{md5:["00439016776de367bad087d739a03797"],sha1:["2c4ba5c1482987d50a182bad915f52cd6611ee63"],sha256:["e70f5d8f87aab14e3160227d38387889befbe37fa4f8f5adc59eff52804b35fd"]},name:["bcrypt.dll"]},host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1697)"],name:["Windows"],version:["1809 (10.0.17763.1697)"],family:["windows"],kernel:["1809 (10.0.17763.1697)"],platform:["windows"]},mac:["aa:bb:cc:dd:ee:ff"],name:["win2019-endpoint-1"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"]},event:{category:["library"],kind:["event"],created:["2021-02-05T21:27:23.921Z"],module:["endpoint"],action:["load"],type:["start"],id:["LzzWB9jjGmCwGMvk++++Da5H"],dataset:["endpoint.events.library"]},process:{name:["sshd.exe"],pid:[9644],entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTk2NDQtMTMyNTcwMzQwNDEuNzgyMTczODAw"],executable:["C:\\Program Files\\OpenSSH-Win64\\sshd.exe"]},agent:{type:["endpoint"]},user:{name:["SYSTEM"],domain:["NT AUTHORITY"]},message:["Endpoint DLL load event"],timestamp:"2021-02-05T21:27:23.921Z",_id:"IAUYdHcBGrBB52F2zo8Q"},A=()=>{const e=Object(w.d)({actionName:"load",text:E.q});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:R,isDraggable:!1,timelineId:x.a}))},D=i.a.memo(A);var M=a(897),P=a(972);const F=()=>i.a.createElement(i.a.Fragment,null,P.a.renderRow({data:{destination:{bytes:[40],geo:{city_name:["New York"],continent_name:["North America"],country_iso_code:["US"],country_name:["United States"],region_name:["New York"]},ip:["10.1.2.3"],packets:[1],port:[80]},event:{action:["network_flow"],category:["network_traffic"],duration:[M.a],end:["2018-11-12T19:03:25.936Z"],start:["2018-11-12T19:03:25.836Z"]},_id:"abcd",network:{bytes:[100],community_id:["we.live.in.a"],direction:["outgoing"],packets:[3],protocol:["http"],transport:["tcp"]},process:{name:["rat"]},source:{bytes:[60],geo:{city_name:["Atlanta"],continent_name:["North America"],country_iso_code:["US"],country_name:["United States"],region_name:["Georgia"]},ip:["192.168.1.2"],packets:[2],port:[9987]},timestamp:"2018-11-12T19:03:25.936Z",tls:{client_certificate:{fingerprint:{sha1:["tls.client_certificate.fingerprint.sha1-value"]}},fingerprints:{ja3:{hash:["tls.fingerprints.ja3.hash-value"]}},server_certificate:{fingerprint:{sha1:["tls.server_certificate.fingerprint.sha1-value"]}}},user:{name:["first.last"]}},isDraggable:!1,timelineId:x.a})),z=i.a.memo(F),W={host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1697)"],name:["Windows"],version:["1809 (10.0.17763.1697)"],family:["windows"],kernel:["1809 (10.0.17763.1697)"],platform:["windows"]},mac:["aa:bb:cc:dd:ee:ff"],name:["win2019-endpoint-1"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"]},event:{category:["registry"],kind:["event"],created:["2021-02-04T13:44:31.559Z"],module:["endpoint"],action:["modification"],type:["change"],id:["LzzWB9jjGmCwGMvk++++CbOn"],dataset:["endpoint.events.registry"]},process:{name:["GoogleUpdate.exe"],pid:[7408],entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTc0MDgtMTMyNTY5MTk4NDguODY4NTI0ODAw"],executable:["C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe"]},registry:{hive:["HKLM"],key:["SOFTWARE\\WOW6432Node\\Google\\Update\\ClientState\\{430FD4D0-B729-4F61-AA34-91526481799D}\\CurrentState"],path:["HKLM\\SOFTWARE\\WOW6432Node\\Google\\Update\\ClientState\\{430FD4D0-B729-4F61-AA34-91526481799D}\\CurrentState\\StateValue"],value:["StateValue"]},agent:{type:["endpoint"]},user:{name:["SYSTEM"],domain:["NT AUTHORITY"]},message:["Endpoint registry event"],timestamp:"2021-02-04T13:44:31.559Z",_id:"4cxLbXcBGrBB52F2uOfF"},B=()=>{const e=Object(w.e)({actionName:"modification",text:E.u});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:W,isDraggable:!1,timelineId:x.a}))},L=i.a.memo(B);var Z=a(997);const q=()=>i.a.createElement(i.a.Fragment,null,Z.a.renderRow({data:j[2].ecs,isDraggable:!1,timelineId:x.a})),U=i.a.memo(q),H={_id:"2MjPcG0BOpWiDweSoutC",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["termination_event"],category:["process"],kind:["event"]},timestamp:"1569555712000",process:{hash:{md5:["bd4401441a21bf1abce6404f4231db4d"],sha1:["797255e72d5ed5c058d4785950eba7abaa057653"],sha256:["87976f3430cc99bc939e0694247c0759961a49832b87218f4313d6fc0bc3a776"]},pid:[442384],ppid:[8],name:["RuntimeBroker.exe"],executable:["C:\\Windows\\System32\\RuntimeBroker.exe"]},endgame:{pid:[442384],process_name:["RuntimeBroker.exe"],exit_code:[0]}},G=()=>{const e=Object(w.h)({actionName:"termination_event",text:E.H});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:H,isDraggable:!1,timelineId:x.a}))},$=i.a.memo(G),Y={_id:"S8jPcG0BOpWiDweSou3g",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["request_event"],category:["network"],kind:["event"]},message:["DNS query is completed for the name %1, type %2, query options %3 with status %4 Results %5 "],timestamp:"1569555712000",dns:{question:{name:["update.googleapis.com"],type:["A"]},resolved_ip:["10.100.197.67"]},network:{protocol:["dns"]},process:{pid:[443192],name:["GoogleUpdate.exe"],executable:["C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe"]},winlog:{event_id:[3008]},endgame:{process_name:["GoogleUpdate.exe"],pid:[443192]}},V=()=>{const e=Object(w.a)();return i.a.createElement(i.a.Fragment,null,e.renderRow({data:Y,isDraggable:!1,timelineId:x.a}))},Q=i.a.memo(V),K={_id:"BcjPcG0BOpWiDweSou3g",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["creation_event"],category:["process"],type:["process_start"],kind:["event"]},timestamp:"1569555712000",process:{hash:{md5:["62d06d7235b37895b68de56687895743"],sha1:["12563599116157778a22600d2a163d8112aed845"],sha256:["d4c97ed46046893141652e2ec0056a698f6445109949d7fcabbce331146889ee"]},pid:[441684],ppid:[8],name:["Microsoft.Photos.exe"],executable:["C:\\Program Files\\WindowsApps\\Microsoft.Windows.Photos_2018.18091.17210.0_x64__8wekyb3d8bbwe\\Microsoft.Photos.exe"],args:["C:\\Program Files\\WindowsApps\\Microsoft.Windows.Photos_2018.18091.17210.0_x64__8wekyb3d8bbwe\\Microsoft.Photos.exe","-ServerName:App.AppXzst44mncqdg84v7sv6p7yznqwssy6f7f.mca"]},endgame:{process_name:["Microsoft.Photos.exe"],pid:[441684],parent_process_name:["svchost.exe"]}},X=()=>{const e=Object(w.b)({actionName:"creation_event",text:E.A});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:K,isDraggable:!1,timelineId:x.a}))},J=i.a.memo(X),ee={_id:"98jPcG0BOpWiDweSouzg",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["file_create_event"],category:["file"],kind:["event"]},timestamp:"1569555712000",endgame:{process_name:["chrome.exe"],pid:[11620],file_path:["C:\\Users\\Arun\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\63d78c21-e593-4484-b7a9-db33cd522ddc.tmp"]}},te={_id:"OMjPcG0BOpWiDweSeuW9",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.134.159.150"],name:["HD-v1s-d2118419"]},event:{module:["endgame"],dataset:["esensor"],action:["file_delete_event"],category:["file"],kind:["event"]},timestamp:"1569555704000",endgame:{pid:[1084],file_name:["tmp000002f6"],file_path:["C:\\Windows\\TEMP\\tmp00000404\\tmp000002f6"],process_name:["AmSvc.exe"]}},ae=()=>{const e=Object(w.g)({actionName:"file_delete_event",text:E.f});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:te,isDraggable:!1,timelineId:x.a}))},ne=i.a.memo(ae),ie=()=>{const e=Object(w.f)({actionName:"file_create_event",text:E.e});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:ee,isDraggable:!1,timelineId:x.a}))},se=i.a.memo(ie),oe={_id:"QsjPcG0BOpWiDweSeuRE",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.134.159.150"],name:["HD-v1s-d2118419"]},event:{module:["endgame"],dataset:["esensor"],action:["user_logon"],category:["authentication"],type:["authentication_success"],kind:["event"]},message:["An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tWIN-Q3DOP1UKA81$\r\n\tAccount Domain:\t\tWORKGROUP\r\n\tLogon ID:\t\t0x3e7\r\n\r\nLogon Type:\t\t\t5\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tSYSTEM\r\n\tAccount Domain:\t\tNT AUTHORITY\r\n\tLogon ID:\t\t0x3e7\r\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x1b0\r\n\tProcess Name:\t\tC:\\Windows\\System32\\services.exe\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t\r\n\tSource Network Address:\t-\r\n\tSource Port:\t\t-\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tAdvapi  \r\n\tAuthentication Package:\tNegotiate\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\t-\r\n\tKey Length:\t\t0\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."],timestamp:"1569555704000",process:{pid:[432],name:["C:\\Windows\\System32\\services.exe"],executable:["C:\\Windows\\System32\\services.exe"]},winlog:{event_id:[4624]},endgame:{target_logon_id:["0x3e7"],pid:[432],process_name:["C:\\Windows\\System32\\services.exe"],logon_type:[5],subject_user_name:["WIN-Q3DOP1UKA81$"],subject_logon_id:["0x3e7"],target_user_name:["SYSTEM"],target_domain_name:["NT AUTHORITY"]}},re=()=>{const e=Object(w.i)({actionName:"user_logon"});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:oe,isDraggable:!1,timelineId:x.a}))},le=i.a.memo(re),de={_id:"LsjPcG0BOpWiDweSCNfu",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.43.255.177"],name:["HD-gqf-0af7b4fe"]},event:{module:["endgame"],dataset:["esensor"],action:["ipv4_connection_accept_event"],category:["network"],kind:["event"]},timestamp:"1569555676000",network:{community_id:["1:network-community_id"],transport:["tcp"]},process:{pid:[1084],name:["AmSvc.exe"],executable:["C:\\Program Files\\Cybereason ActiveProbe\\AmSvc.exe"]},source:{ip:["127.0.0.1"],port:[49306]},destination:{port:[49305],ip:["127.0.0.1"]},endgame:{pid:[1084]}},ce=()=>{const e=Object(w.j)({actionName:"ipv4_connection_accept_event",text:E.b});return i.a.createElement(i.a.Fragment,null,e.renderRow({data:de,isDraggable:!1,timelineId:x.a}))},ue=i.a.memo(ce);var me=a(995);const pe=()=>i.a.createElement(i.a.Fragment,null,me.a.renderRow({data:j[31].ecs,isDraggable:!1,timelineId:x.a})),ve=i.a.memo(pe);var be=a(1001);const fe=()=>i.a.createElement(i.a.Fragment,null,be.a.renderRow({data:j[13].ecs,isDraggable:!1,timelineId:x.a})),ge=i.a.memo(fe);var ye=a(6);const he=ye.i18n.translate("xpack.securitySolution.eventRenderers.alertName",{defaultMessage:"Alert"}),we=ye.i18n.translate("xpack.securitySolution.eventRenderers.alertsName",{defaultMessage:"Alerts"}),Ee=ye.i18n.translate("xpack.securitySolution.eventRenderers.alertsDescription",{defaultMessage:"Alerts are displayed when malware or ransomware is prevented and detected"}),xe=ye.i18n.translate("xpack.securitySolution.eventRenderers.auditdName",{defaultMessage:"Auditd"}),_e=ye.i18n.translate("xpack.securitySolution.eventRenderers.auditdDescriptionPart1",{defaultMessage:"audit events convey security-relevant logs from the Linux Audit Framework."}),Ce=ye.i18n.translate("xpack.securitySolution.eventRenderers.auditdFileName",{defaultMessage:"Auditd File"}),je=ye.i18n.translate("xpack.securitySolution.eventRenderers.auditdFileDescriptionPart1",{defaultMessage:"File events show users (and system accounts) performing CRUD operations on files via specific processes."}),ke=ye.i18n.translate("xpack.securitySolution.eventRenderers.authenticationName",{defaultMessage:"Authentication"}),Se=ye.i18n.translate("xpack.securitySolution.eventRenderers.authenticationDescriptionPart1",{defaultMessage:"Authentication events show users (and system accounts) successfully or unsuccessfully logging into hosts."}),Te=ye.i18n.translate("xpack.securitySolution.eventRenderers.authenticationDescriptionPart2",{defaultMessage:"Some authentication events may include additional details when users authenticate on behalf of other users."}),Ne=ye.i18n.translate("xpack.securitySolution.eventRenderers.dnsName",{defaultMessage:"Domain Name System (DNS)"}),Oe=ye.i18n.translate("xpack.securitySolution.eventRenderers.dnsDescriptionPart1",{defaultMessage:"Domain Name System (DNS) events show users (and system accounts) making requests via specific processes to translate from host names to IP addresses."}),Ie=ye.i18n.translate("xpack.securitySolution.eventRenderers.fileName",{defaultMessage:"File"}),Re=ye.i18n.translate("xpack.securitySolution.eventRenderers.fileDescriptionPart1",{defaultMessage:"File events show users (and system accounts) performing CRUD operations on files via specific processes."}),Ae=ye.i18n.translate("xpack.securitySolution.eventRenderers.fimName",{defaultMessage:"File Integrity Module (FIM)"}),De=ye.i18n.translate("xpack.securitySolution.eventRenderers.fimDescriptionPart1",{defaultMessage:"File Integrity Module (FIM) events show users (and system accounts) performing CRUD operations on files via specific processes."}),Me=ye.i18n.translate("xpack.securitySolution.eventRenderers.flowName",{defaultMessage:"Flow"}),Pe=ye.i18n.translate("xpack.securitySolution.eventRenderers.flowDescriptionPart1",{defaultMessage:"The Flow renderer visualizes the flow of data between a source and destination. It's applicable to many types of events."}),Fe=ye.i18n.translate("xpack.securitySolution.eventRenderers.flowDescriptionPart2",{defaultMessage:"The hosts, ports, protocol, direction, duration, amount transferred, process, geographic location, and other details are visualized when available."}),ze=ye.i18n.translate("xpack.securitySolution.eventRenderers.libraryName",{defaultMessage:"Library"}),We=ye.i18n.translate("xpack.securitySolution.eventRenderers.libraryDescription",{defaultMessage:"Library events display a Dynamically Linked Library (DLL) being loaded by a process"}),Be=ye.i18n.translate("xpack.securitySolution.eventRenderers.processName",{defaultMessage:"Process"}),Le=ye.i18n.translate("xpack.securitySolution.eventRenderers.processDescriptionPart1",{defaultMessage:"Process events show users (and system accounts) starting and stopping processes."}),Ze=ye.i18n.translate("xpack.securitySolution.eventRenderers.processDescriptionPart2",{defaultMessage:"Details including the command line arguments, parent process, and if applicable, file hashes are displayed when available."}),qe=ye.i18n.translate("xpack.securitySolution.eventRenderers.registryName",{defaultMessage:"Registry"}),Ue=ye.i18n.translate("xpack.securitySolution.eventRenderers.registryDescription",{defaultMessage:"Registry events show updates to the Windows Registry"}),He=ye.i18n.translate("xpack.securitySolution.eventRenderers.socketName",{defaultMessage:"Socket (Network)"}),Ge=ye.i18n.translate("xpack.securitySolution.eventRenderers.socketDescriptionPart1",{defaultMessage:"Socket (Network) events show processes listening, accepting, and closing connections."}),$e=ye.i18n.translate("xpack.securitySolution.eventRenderers.socketDescriptionPart2",{defaultMessage:"Details including the protocol, ports, and a community ID for correlating all network events related to a single flow are displayed when available."}),Ye=ye.i18n.translate("xpack.securitySolution.eventRenderers.suricataName",{defaultMessage:"Suricata"}),Ve=ye.i18n.translate("xpack.securitySolution.eventRenderers.suricataDescriptionPart1",{defaultMessage:"Summarizes"}),Qe=ye.i18n.translate("xpack.securitySolution.eventRenderers.suricataDescriptionPart2",{defaultMessage:"intrusion detection (IDS), inline intrusion prevention (IPS), and network security monitoring (NSM) events"}),Ke=ye.i18n.translate("xpack.securitySolution.eventRenderers.systemName",{defaultMessage:"System"}),Xe=ye.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart1",{defaultMessage:"The Auditbeat"}),Je=ye.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart2",{defaultMessage:"module collects various security related information about a system."}),et=ye.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart3",{defaultMessage:"All datasets send both periodic state information (e.g. all currently running processes) and real-time changes (e.g. when a new process starts or stops)."}),tt=ye.i18n.translate("xpack.securitySolution.eventRenderers.threatMatchName",{defaultMessage:"Threat Indicator Match"}),at=ye.i18n.translate("xpack.securitySolution.eventRenderers.threatMatchDescription",{defaultMessage:"Summarizes events that matched threat indicators"}),nt=ye.i18n.translate("xpack.securitySolution.eventRenderers.zeekName",{defaultMessage:"Zeek (formerly Bro)"}),it=ye.i18n.translate("xpack.securitySolution.eventRenderers.zeekDescriptionPart1",{defaultMessage:"Summarizes events from the"}),st=ye.i18n.translate("xpack.securitySolution.eventRenderers.zeekDescriptionPart2",{defaultMessage:"Network Security Monitoring (NSM) tool"}),ot={[c.d.alert]:he,[c.d.alerts]:we,[c.d.auditd]:xe,[c.d.auditd_file]:Ce,[c.d.library]:ze,[c.d.system_security_event]:ke,[c.d.system_dns]:Ne,[c.d.netflow]:Me,[c.d.system]:Ke,[c.d.system_endgame_process]:Be,[c.d.registry]:qe,[c.d.system_fim]:Ae,[c.d.system_file]:Ie,[c.d.system_socket]:He,[c.d.suricata]:"Suricata",[c.d.threat_match]:tt,[c.d.zeek]:nt,[c.d.plain]:""},rt=({children:e,url:t})=>i.a.createElement(s.EuiLink,{href:t,target:"_blank",rel:"noopener nofollow noreferrer","data-test-subj":"externalLink"},e),lt=[{id:c.d.alerts,name:ot[c.d.alerts],description:Ee,example:C,searchableDescription:Ee},{id:c.d.auditd,name:ot[c.d.auditd],description:i.a.createElement("span",null,i.a.createElement(rt,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-auditd.html"},xe)," ",_e),example:N,searchableDescription:`${xe} ${_e}`},{id:c.d.auditd_file,name:ot[c.d.auditd_file],description:i.a.createElement("span",null,i.a.createElement(rt,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-auditd.html"},xe)," ",je),example:I,searchableDescription:`${Ce} ${je}`},{id:c.d.library,name:ot[c.d.library],description:We,example:D,searchableDescription:We},{id:c.d.system_security_event,name:ot[c.d.system_security_event],description:i.a.createElement("div",null,i.a.createElement("p",null,Se),i.a.createElement("br",null),i.a.createElement("p",null,Te)),example:le,searchableDescription:`${Se} ${Te}`},{id:c.d.system_dns,name:ot[c.d.system_dns],description:Oe,example:Q,searchableDescription:Oe},{id:c.d.netflow,name:ot[c.d.netflow],description:i.a.createElement("div",null,i.a.createElement("p",null,Pe),i.a.createElement("br",null),i.a.createElement("p",null,Fe)),example:z,searchableDescription:`${Pe} ${Fe}`},{id:c.d.system,name:ot[c.d.system],description:i.a.createElement("div",null,i.a.createElement("p",null,Xe," ",i.a.createElement(rt,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-system.html"},Ke)," ",Je),i.a.createElement("br",null),i.a.createElement("p",null,et)),example:$,searchableDescription:`${Xe} ${Ke} ${Je} ${et}`},{id:c.d.system_endgame_process,name:ot[c.d.system_endgame_process],description:i.a.createElement("div",null,i.a.createElement("p",null,Le),i.a.createElement("br",null),i.a.createElement("p",null,Ze)),example:J,searchableDescription:`${Le} ${Ze}`},{id:c.d.registry,name:ot[c.d.registry],description:Ue,example:L,searchableDescription:Ue},{id:c.d.system_fim,name:ot[c.d.system_fim],description:De,example:se,searchableDescription:De},{id:c.d.system_file,name:ot[c.d.system_file],description:Re,example:ne,searchableDescription:Re},{id:c.d.system_socket,name:ot[c.d.system_socket],description:i.a.createElement("div",null,i.a.createElement("p",null,Ge),i.a.createElement("br",null),i.a.createElement("p",null,$e)),example:ue,searchableDescription:`${Ge} ${$e}`},{id:c.d.suricata,name:ot[c.d.suricata],description:i.a.createElement("p",null,Ve," ",i.a.createElement(rt,{url:"https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-suricata.html"},Ye)," ",Qe),example:U,searchableDescription:`${Ve} ${Ye} ${Qe}`},{id:c.d.threat_match,name:ot[c.d.threat_match],description:at,example:ve,searchableDescription:`${tt} ${at}`},{id:c.d.zeek,name:ot[c.d.zeek],description:i.a.createElement("p",null,it," ",i.a.createElement(rt,{url:"https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-zeek.html"},nt)," ",st),example:ge,searchableDescription:`${it} ${nt} ${st}`}],dt=l()(s.EuiInMemoryTable).withConfig({displayName:"StyledEuiInMemoryTable",componentId:"sc-1dtaeu6-0"})([".euiTable{tr > *:last-child{display:none;}.euiTableHeaderCellCheckbox > .euiTableCellContent{display:none;}}"]),ct=l()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1dtaeu6-1"})(["overflow:auto;> div{padding:0;> div{margin:0;}}"]),ut=e=>{if(e)return i.a.createElement(ct,{grow:1},i.a.createElement(e,null))},mt={box:{incremental:!0,schema:!0}},pt=()=>i.a.createElement(i.a.Fragment,null),vt={sort:{field:"name",direction:"asc"}},bt=l.a.button.withConfig({displayName:"StyledNameButton",componentId:"sc-1dtaeu6-2"})(["text-align:left;"]),ft=({excludedRowRendererIds:e=[],setExcludedRowRendererIds:t})=>{const a=Object(n.useCallback)((a=>()=>{const n=Object(y.xor)([a.id],e);t(n)}),[e,t]),o=Object(n.useCallback)(((e,t)=>i.a.createElement(bt,{className:"kbn-resetFocusState",onClick:a(t)},e)),[a]),r=Object(n.useCallback)(((t,n)=>i.a.createElement(s.EuiCheckbox,{id:n.id,onChange:a(n),checked:!e.includes(n.id)})),[e,a]),l=Object(n.useMemo)((()=>[{field:"id",name:"",sortable:!1,width:"32px",render:r},{field:"name",name:"Name",sortable:!0,width:"10%",render:o},{field:"description",name:"Description",width:"25%",render:e=>e},{field:"example",name:"Example",width:"65%",render:ut},{field:"searchableDescription",name:"Searchable Description",sortable:!1,width:"0px",render:pt}]),[r,o]);return i.a.createElement(dt,{items:lt,itemId:"id",columns:l,search:mt,sorting:vt,isSelectable:!0})};ft.displayName="RowRenderersBrowserComponent";const gt=i.a.memo(ft);gt.displayName="RowRenderersBrowser";const yt=ye.i18n.translate("xpack.securitySolution.customizeEventRenderers.eventRenderersTitle",{defaultMessage:"Event Renderers"}),ht=ye.i18n.translate("xpack.securitySolution.customizeEventRenderers.customizeEventRenderersTitle",{defaultMessage:"Customize Event Renderers"}),wt=ye.i18n.translate("xpack.securitySolution.customizeEventRenderers.customizeEventRenderersDescription",{defaultMessage:"Event Renderers automatically convey the most relevant details in an event to reveal its story"}),Et=ye.i18n.translate("xpack.securitySolution.customizeEventRenderers.enableAllRenderersButtonLabel",{defaultMessage:"Enable all"}),xt=ye.i18n.translate("xpack.securitySolution.customizeEventRenderers.disableAllRenderersButtonLabel",{defaultMessage:"Disable all"}),_t=l()(s.EuiModal).withConfig({displayName:"StyledEuiModal",componentId:"sc-1ibwehq-0"})([""," max-width:95vw;min-height:90vh;> .euiModal__flex{max-height:90vh;}"],(({theme:e})=>`margin-top: ${e.eui.euiSizeXXL};`)),Ct=l()(s.EuiModalBody).withConfig({displayName:"StyledEuiModalBody",componentId:"sc-1ibwehq-1"})([".euiModalBody__overflow{display:flex;align-items:stretch;overflow:hidden;> div{display:flex;flex-direction:column;flex:1;> div:first-child{flex:0;}.euiBasicTable{flex:1;overflow:auto;}}}"]),jt=({timelineId:e})=>{const t=Object(o.useDispatch)(),a=Object(n.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),r=Object(v.a)((t=>{var n;return(null!==(n=a(t,e))&&void 0!==n?n:g.a).excludedRowRendererIds})),[l,d]=Object(n.useState)(!1),u=Object(n.useCallback)((a=>t(Object(b.setExcludedRowRendererIds)({id:e,excludedRowRendererIds:a}))),[t,e]),m=Object(n.useCallback)((()=>d(!l)),[l]),p=Object(n.useCallback)((()=>d(!1)),[]),y=Object(n.useCallback)((()=>{u(Object.values(c.d))}),[u]),h=Object(n.useCallback)((()=>{u([])}),[u]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiToolTip,{content:ht},i.a.createElement(s.EuiButtonIcon,{"aria-label":ht,"data-test-subj":"show-row-renderers-gear",iconType:"gear",onClick:m},yt)),l&&i.a.createElement(_t,{onClose:p,"data-test-subj":"row-renderers-modal"},i.a.createElement(s.EuiModalHeader,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",direction:"row",gutterSize:"none"},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiModalHeaderTitle,null,ht),i.a.createElement(s.EuiText,{size:"s"},wt)),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiFlexGroup,null,i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButtonEmpty,{size:"s","data-test-subj":"disable-all",onClick:y},xt)),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButton,{fill:!0,size:"s","data-test-subj":"enable-all",onClick:h},Et)))))),i.a.createElement(Ct,null,i.a.createElement(gt,{excludedRowRendererIds:r,setExcludedRowRendererIds:u}))))},kt=i.a.memo(jt);var St=a(245),Tt=a(660);const Nt=ye.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.pinSelected",{defaultMessage:"Pin selected"}),Ot=ye.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectAll",{defaultMessage:"All"}),It=ye.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectNone",{defaultMessage:"None"}),Rt=ye.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectPinned",{defaultMessage:"Pinned"}),At=ye.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectUnpinned",{defaultMessage:"Unpinned"}),Dt=ye.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.unpinSelected",{defaultMessage:"Unpin selected"}),Mt=l.a.div.withConfig({displayName:"InputDisplay",componentId:"sc-10qzhe8-0"})(["width:5px;"]);Mt.displayName="InputDisplay";const Pt=l.a.div.withConfig({displayName:"PinIconContainer",componentId:"sc-10qzhe8-1"})(["margin-right:5px;"]);Pt.displayName="PinIconContainer";const Ft=l.a.div.withConfig({displayName:"PinActionItem",componentId:"sc-10qzhe8-2"})(["display:flex;flex-direction:row;"]);Ft.displayName="PinActionItem";const zt=i.a.memo((({text:e})=>i.a.createElement(s.EuiText,{size:"s",color:"subdued"},e)));zt.displayName="DropdownDisplay";const Wt=Object(r.createGlobalStyle)([".eventsSelectItem{width:100% !important;.euiContextMenu__icon{display:none !important;}}.eventsSelectDropdown{width:","px;}"],60),Bt=l.a.div.withConfig({displayName:"CheckboxContainer",componentId:"sc-3rz9a2-0"})(["position:relative;"]);Bt.displayName="CheckboxContainer";const Lt=l.a.div.withConfig({displayName:"PositionedCheckbox",componentId:"sc-3rz9a2-1"})(["left:7px;position:absolute;top:-28px;"]);Lt.displayName="PositionedCheckbox";const Zt=i.a.memo((({checkState:e,timelineId:t})=>i.a.createElement("div",{"data-test-subj":"events-select"},i.a.createElement(s.EuiSuperSelect,{className:"eventsSelectDropdown","data-test-subj":"events-select-dropdown",itemClassName:"eventsSelectItem",onChange:y.noop,options:[{inputDisplay:i.a.createElement(Mt,null),disabled:!0,dropdownDisplay:i.a.createElement(zt,{text:Ot}),value:"select-all"},{inputDisplay:i.a.createElement(Mt,null),disabled:!0,dropdownDisplay:i.a.createElement(zt,{text:It}),value:"select-none"},{inputDisplay:i.a.createElement(Mt,null),disabled:!0,dropdownDisplay:i.a.createElement(zt,{text:Rt}),value:"select-pinned"},{inputDisplay:i.a.createElement(Mt,null),disabled:!0,dropdownDisplay:i.a.createElement(zt,{text:At}),value:"select-unpinned"},{inputDisplay:i.a.createElement(Mt,null),disabled:!0,dropdownDisplay:i.a.createElement(Ft,null,i.a.createElement(Pt,null,i.a.createElement(Tt.a,{allowUnpinning:!0,isAlert:!1,pinned:!0})),i.a.createElement(zt,{text:Nt})),value:"pin-selected"},{inputDisplay:i.a.createElement(Mt,null),disabled:!0,dropdownDisplay:i.a.createElement(Ft,null,i.a.createElement(Pt,null,i.a.createElement(Tt.a,{allowUnpinning:!0,isAlert:!1,pinned:!1})),i.a.createElement(zt,{text:Dt})),value:"unpin-selected"}]}),i.a.createElement(Bt,{"data-test-subj":"timeline-events-select-checkbox-container"},i.a.createElement(Lt,{"data-test-subj":"timeline-events-select-positioned-checkbox"},i.a.createElement(s.EuiCheckbox,{checked:"checked"===e,"data-test-subj":"events-select-checkbox",disabled:!0,id:`timeline-${t}-events-select`,indeterminate:"indeterminate"===e,onChange:y.noop}))),i.a.createElement(Wt,null))));Zt.displayName="EventsSelect";var qt=a(372),Ut=a(497),Ht=a(19),Gt=a(747);const $t=l.a.div.withConfig({displayName:"SortingColumnsContainer",componentId:"sc-1mw6s2e-0"})(["button{color:",";}.euiPopover .euiButtonEmpty .euiButtonContent{padding:0;.euiButtonEmpty__text{display:none;}}"],(({theme:e})=>e.eui.euiColorPrimary)),Yt=l.a.div.withConfig({displayName:"FieldBrowserContainer",componentId:"sc-1mw6s2e-1"})([".euiToolTipAnchor{.euiButtonContent{padding:",";}button{color:",";}.euiButtonContent__icon{width:16px;height:16px;}.euiButtonEmpty__text{display:none;}}"],(({theme:e})=>`0 ${e.eui.euiSizeXS}`),(({theme:e})=>e.eui.euiColorPrimary)),Vt=l.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-1mw6s2e-2"})(["align-items:center;display:flex;"]),Qt=({width:e,browserFields:t,columnHeaders:a,isEventViewer:r=!1,isSelectAllChecked:l,onSelectAll:b,showEventsSelect:g,showSelectAllCheckbox:y,sort:h,tabType:w,timelineId:E,fieldBrowserOptions:x})=>{const{triggersActionsUi:_}=Object(Ht.k)().services,{globalFullScreen:C,setGlobalFullScreen:j}=Object(p.a)(),{timelineFullScreen:k,setTimelineFullScreen:S}=Object(p.c)(),T=Object(o.useDispatch)(),N=Object(n.useMemo)((()=>f.b.getManageTimelineById()),[]),{defaultColumns:O}=Object(v.a)((e=>N(e,E))),I=Object(n.useCallback)((()=>{E===c.i.active?S(!k):j(!C)}),[E,S,k,j,C]),R=Object(n.useMemo)((()=>Object(Ut.b)({globalFullScreen:C,timelineId:E,timelineFullScreen:k})),[C,E,k]),A=Object(n.useCallback)((e=>{b({isSelected:e.currentTarget.checked})}),[b]),D=Object(n.useCallback)((e=>T(f.a.updateSort({id:E,sort:e.map((({id:e,direction:t})=>{var n,i;const s=a.find((t=>t.id===e)),o=null!==(n=null==s?void 0:s.type)&&void 0!==n?n:"",r=null!==(i=null==s?void 0:s.esTypes)&&void 0!==i?i:[];return{columnId:e,columnType:o,esTypes:r,sortDirection:t}}))}))),[a,T,E]),M=Object(n.useMemo)((()=>{var e;return{onSort:D,columns:null!==(e=null==h?void 0:h.map((({columnId:e,sortDirection:t})=>({id:e,direction:t}))))&&void 0!==e?e:[]}}),[D,h]),P=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.reduce(((e,t)=>{var a;return{...e,[t.id]:null!==(a=t.displayAsText)&&void 0!==a?a:t.id}}),{}))&&void 0!==e?e:{}}),[a]),F=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.map((({aggregatable:e,displayAsText:t,id:a,type:n})=>({id:a,isSortable:e,displayAsText:t,schema:n}))))&&void 0!==e?e:[]}),[a]),z=Object(n.useCallback)((()=>{T(f.a.updateColumns({id:E,columns:O}))}),[O,T,E]),W=Object(n.useCallback)((e=>{a.some((({id:t})=>t===e))?T(f.a.removeColumn({columnId:e,id:E})):T(f.a.upsertColumn({column:Object(Gt.a)(e,O),id:E,index:1}))}),[a,T,E,O]),B=Object(s.useDataGridColumnSorting)(F,M,{},[],P);return i.a.createElement(Vt,null,y&&i.a.createElement(St.o,{role:"checkbox"},i.a.createElement(St.p,{textAlign:"center",width:d.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(s.EuiCheckbox,{"data-test-subj":"select-all-events",id:"select-all-events",checked:l,onChange:A}))),i.a.createElement(St.o,{role:"button"},i.a.createElement(Yt,null,_.getFieldBrowser({browserFields:t,columnIds:a.map((({id:e})=>e)),onResetColumns:z,onToggleColumn:W,options:x}))),i.a.createElement(St.o,{role:"button"},i.a.createElement(kt,{"data-test-subj":"row-renderers-browser",timelineId:E})),i.a.createElement(St.o,{role:"button"},i.a.createElement(St.p,{textAlign:"center",width:d.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(s.EuiToolTip,{content:R?u.a:qt.d},i.a.createElement(s.EuiButtonIcon,{"aria-label":Object(Ut.b)({globalFullScreen:C,timelineId:E,timelineFullScreen:k})?u.a:qt.d,className:R?m.Ib:"",color:R?"ghost":"primary","data-test-subj":E===c.i.active?"full-screen-active":"full-screen",iconType:"fullScreen",onClick:I})))),w!==c.l.eql&&i.a.createElement(St.o,{role:"button","data-test-subj":"timeline-sorting-fields"},i.a.createElement(St.p,{textAlign:"center",width:d.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(s.EuiToolTip,{content:qt.h},i.a.createElement($t,null,B)))),g&&i.a.createElement(St.o,{role:"button"},i.a.createElement(St.p,{textAlign:"center",width:d.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(Zt,{checkState:"unchecked",timelineId:E}))))};Qt.displayName="HeaderActionsComponent";const Kt=i.a.memo(Qt)},878:function(e,t,a){"use strict";a.d(t,"a",(function(){return Q}));var n=a(3),i=a(4),s=a.n(i),o=a(47),r=a(22),l=a(36),d=a(15),c=a(94),u=a(91),m=a(747),p=a(393);const v=()=>s.a.createElement(s.a.Fragment,null);v.displayName="PlainRowRenderer";const b={id:d.d.plain,isInstance:e=>!0,renderRow:v};var f=a(245),g=a(497),y=a(5),h=a(17),w=a(76),E=a(241),x=a(24),_=a.n(x),C=a(900),j=a(898),k=a(463);const S=_.a.div.withConfig({displayName:"AddNoteContainer",componentId:"sc-jd0fq6-0"})([""]);S.displayName="AddNoteContainer",_.a.div.withConfig({displayName:"NoteContainer",componentId:"sc-jd0fq6-1"})(["margin-top:5px;"]).displayName="NoteContainer";const T=_()(h.EuiPanel).withConfig({displayName:"NoteCardsCompContainer",componentId:"sc-jd0fq6-2"})(["border:none;background-color:transparent;box-shadow:none;&.euiPanel--plain{background-color:transparent;}"]);T.displayName="NoteCardsCompContainer";const N=_()(h.EuiFlexGroup).withConfig({displayName:"NotesContainer",componentId:"sc-jd0fq6-3"})(["margin-bottom:5px;"]);N.displayName="NotesContainer";const O=s.a.memo((({ariaRowindex:e,associateNote:t,notes:a,showAddNote:n,toggleShowAddNote:o})=>{const[l,d]=Object(i.useState)(""),c=Object(i.useCallback)((e=>{t(e),o()}),[t,o]);return s.a.createElement(T,{"data-test-subj":"note-cards",hasShadow:!1,paddingSize:"none"},a.length?s.a.createElement(j.b,{"data-test-subj":"note-previews-container"},s.a.createElement(N,{className:Object(r.getNotesContainerClassName)(e),"data-test-subj":"notes",direction:"column",gutterSize:"none"},s.a.createElement(h.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},s.a.createElement("p",null,k.h(e))),s.a.createElement(j.a,{notes:a}))):null,n?s.a.createElement(S,{"data-test-subj":"add-note-container"},s.a.createElement(C.a,{associateNote:c,newNote:l,onCancelAddNote:o,updateNewNote:d})):null)}));O.displayName="NoteCards";var I=a(600),R=a(311);const A=s.a.memo((({id:e,actionsColumnWidth:t,ariaRowindex:a,columnHeaders:n,data:o,ecsData:r,eventIdToNoteIds:l,isEventPinned:d=!1,isEventViewer:c=!1,loadingEventIds:u,notesCount:m,onEventDetailsPanelOpened:p,onRowSelected:v,refetch:b,hasRowRenderers:g,onRuleChange:y,renderCellValue:h,selectedEventIds:w,showCheckboxes:E,showNotes:x,tabType:_,timelineId:C,toggleShowNotes:j,leadingControlColumns:k,trailingControlColumns:S,setEventsLoading:T,setEventsDeleted:N})=>{const O=Object(i.useMemo)((()=>n.map((e=>{var t;return null!==(t=Object(R.b)({data:o,fieldName:e.id}))&&void 0!==t?t:[]})).join(" ")),[n,o]),I=Object(i.useMemo)((()=>k?k.map((e=>e.rowCellRender)):[]),[k]),A=Object(i.useMemo)((()=>I.map(((n,i)=>{const m=k[i].width?k[i].width:t;return s.a.createElement(f.m,{width:m,"data-test-subj":"event-actions-container",tabIndex:0,key:i},n&&s.a.createElement(n,{width:m,rowIndex:a,ariaRowindex:a,checked:Object.keys(w).includes(e),columnId:k[i].id||"",columnValues:O,onRowSelected:v,"data-test-subj":"actions",eventId:e,data:o,index:i,ecsData:r,loadingEventIds:u,onEventDetailsPanelOpened:p,showCheckboxes:E,eventIdToNoteIds:l,isEventPinned:d,isEventViewer:c,onRuleChange:y,refetch:b,showNotes:x,tabType:_,timelineId:C,toggleShowNotes:j,setEventsLoading:T,setEventsDeleted:N}))}))),[t,a,O,o,r,l,e,d,c,I,k,u,p,v,y,b,w,E,x,_,C,j,T,N]);return s.a.createElement(f.t,{"data-test-subj":"event-column-view"},A,s.a.createElement(R.a,{id:e,actionsColumnWidth:t,ariaRowindex:a,columnHeaders:n,data:o,ecsData:r,hasRowRenderers:g,notesCount:m,renderCellValue:h,tabType:_,timelineId:C,trailingControlColumns:S,leadingControlColumns:k,checked:Object.keys(w).includes(e),columnValues:O,onRowSelected:v,"data-test-subj":"actions",loadingEventIds:u,onEventDetailsPanelOpened:p,showCheckboxes:E,eventIdToNoteIds:l,isEventPinned:d,isEventViewer:c,refetch:b,onRuleChange:y,selectedEventIds:w,showNotes:x,toggleShowNotes:j,setEventsLoading:T,setEventsDeleted:N}))}));A.displayName="EventColumnView";var D=a(78),M=a(84),P=a(527);var F=a(6);const z=({ariaRowindex:e,containerRef:t,event:a,lastFocusedAriaColindex:o,rowRenderers:l,timelineId:d})=>{const{focusOwnership:c,onFocus:u,onKeyDown:m,onOutsideClick:p}=(({ariaRowindex:e,colindexAttribute:t,containerRef:a,lastFocusedAriaColindex:n,onColumnFocused:s,rowindexAttribute:o})=>{const[l,d]=Object(i.useState)("not-owned"),c=Object(i.useCallback)((()=>{d((e=>"owned"!==e?"owned":e))}),[]),u=Object(i.useCallback)((()=>{d("not-owned")}),[]),m=Object(i.useCallback)((i=>{if(Object(r.isArrowDownOrArrowUp)(i)||Object(r.isEscape)(i)){i.preventDefault(),i.stopPropagation(),d("not-owned");const l=Object(r.isEscape)(i)?e:(({ariaRowindex:e,event:t})=>Object(r.isArrowUp)(t)?e:e+1)({ariaRowindex:e,event:i});setTimeout((()=>{s(Object(r.focusColumn)({ariaColindex:n,ariaRowindex:l,colindexAttribute:t,containerElement:a.current,rowindexAttribute:o}))}),0)}}),[e,t,a,n,s,o]);return Object(i.useMemo)((()=>({focusOwnership:l,onFocus:c,onOutsideClick:u,onKeyDown:m})),[l,c,m,u])})({ariaRowindex:e,colindexAttribute:r.ARIA_COLINDEX_ATTRIBUTE,containerRef:t,lastFocusedAriaColindex:o,onColumnFocused:n.noop,rowindexAttribute:r.ARIA_ROWINDEX_ATTRIBUTE}),v=Object(i.useMemo)((()=>Object(P.a)({data:a.ecs,rowRenderers:l})),[a.ecs,l]);return Object(i.useMemo)((()=>{return v&&s.a.createElement("div",{className:Object(r.getRowRendererClassName)(e),role:"dialog",onFocus:u},s.a.createElement(h.EuiOutsideClickDetector,{onOutsideClick:p},s.a.createElement(h.EuiFocusTrap,{clickOutsideDisables:!0,disabled:"owned"!==c},s.a.createElement(h.EuiScreenReaderOnly,{"data-test-subj":"eventRendererScreenReaderOnly"},s.a.createElement("p",null,(t=e,F.i18n.translate("xpack.securitySolution.timeline.youAreInAnEventRendererScreenReaderOnly",{values:{row:t},defaultMessage:"You are in an event renderer for row: {row}. Press the up arrow key to exit and return to the current row, or the down arrow key to exit and advance to the next row."})))),s.a.createElement("div",{onKeyDown:m},v.renderRow({data:a.ecs,isDraggable:!0,timelineId:d})))));var t}),[e,a.ecs,c,u,m,p,v,d])};var W=a(515);const B=[],L=s.a.memo((({children:e})=>{const t=Object(I.b)();return s.a.createElement(f.x,{width:t},e)}));L.displayName="EventsTrSupplementContainerWrapper";const Z=({actionsColumnWidth:e,containerRef:t,columnHeaders:a,event:n,eventIdToNoteIds:l,isEventViewer:m=!1,isEventPinned:v=!1,lastFocusedAriaColindex:b,loadingEventIds:g,onRowSelected:y,refetch:x,renderCellValue:_,rowRenderers:C,onRuleChange:j,ariaRowindex:k,selectedEventIds:S,showCheckboxes:T,tabType:N,timelineId:I,leadingControlColumns:F,trailingControlColumns:Z})=>{var q,U,H,G;const $=Object(i.useRef)(null),Y=Object(o.useDispatch)(),[V]=Object(i.useState)({timelineID:I,enableHostDetailsFlyout:!0,enableIpDetailsFlyout:!0,tabType:N}),[Q,K]=Object(i.useState)({}),X=Object(i.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),J=Object(w.a)((e=>{var t,a;return null!==(t=(null!==(a=X(e,I))&&void 0!==a?a:c.a).expandedDetail)&&void 0!==t?t:{}})),ee=Object(R.c)({data:null==n?void 0:n.data,fieldName:"host.name"}),te=Object(i.useMemo)((()=>ee&&ee.length>0?ee[0]:null),[ee]),ae=Object(R.c)({data:null==n?void 0:n.data,fieldName:"host.ip"}),ne=Object(R.c)({data:null==n?void 0:n.data,fieldName:"source.ip"}),ie=Object(R.c)({data:null==n?void 0:n.data,fieldName:"destination.ip"}),se=Object(i.useMemo)((()=>new Set([...null!=ae?ae:[],...null!=ne?ne:[],...null!=ie?ie:[]])),[ie,ne,ae]),oe=J[null!=N?N:d.l.query],re="eventDetail"===(null==oe?void 0:oe.panelView)&&(null==oe||null===(q=oe.params)||void 0===q?void 0:q.eventId)===n._id||"hostDetail"===(null==oe?void 0:oe.panelView)&&(null==oe||null===(U=oe.params)||void 0===U?void 0:U.hostName)===te||"networkDetail"===(null==oe?void 0:oe.panelView)&&(null==oe||null===(H=oe.params)||void 0===H?void 0:H.ip)&&(null==se?void 0:se.has(null==oe||null===(G=oe.params)||void 0===G?void 0:G.ip))||!1,le=Object(i.useMemo)((()=>D.a.notesByIdsSelector()),[]),de=Object(w.a)(le),ce=l[n._id]||B,ue=Object(i.useMemo)((()=>D.a.getNotes(de,ce).map((e=>{var t;return{savedObjectId:e.saveObjectId,note:e.note,noteId:e.id,updated:(null!==(t=e.lastEdit)&&void 0!==t?t:e.created).getTime(),updatedBy:e.user}}))),[de,ce]),me=Object(i.useMemo)((()=>null!=Object(P.a)({data:n.ecs,rowRenderers:C})),[n.ecs,C]),pe=Object(i.useCallback)((()=>{const e=n._id;K((t=>(t[e]&&setTimeout((()=>{var e;const t=null===(e=$.current)||void 0===e?void 0:e.querySelector(`.${W.b}`);null==t||t.focus()}),0),{...t,[e]:!t[e]})))}),[n]),ve=Object(i.useCallback)((()=>{const e={panelView:"eventDetail",params:{eventId:n._id,indexName:n._index,refetch:x}};Y(u.a.toggleDetailPanel({...e,tabType:N,timelineId:I})),I===d.i.active&&N===d.l.query&&M.a.toggleExpandedDetail({...e})}),[Y,n._id,n._index,x,N,I]),be=Object(i.useCallback)((e=>{Y(u.a.addNoteToEvent({eventId:n._id,id:I,noteId:e})),v||Y(u.a.pinEvent({id:I,eventId:n._id}))}),[Y,n,v,I]),fe=Object(i.useCallback)((({eventIds:e,isLoading:t})=>{Y(u.a.setEventsLoading({id:I,eventIds:e,isLoading:t}))}),[Y,I]),ge=Object(i.useCallback)((({eventIds:e,isDeleted:t})=>{Y(u.a.setEventsDeleted({id:I,eventIds:e,isDeleted:t}))}),[Y,I]);return s.a.createElement(r.StatefulEventContext.Provider,{value:V},s.a.createElement(f.u,{$ariaRowindex:k,className:E.f,"data-test-subj":"event",eventType:Object(p.e)(n.ecs),isBuildingBlockType:Object(p.i)(n.ecs),isEvenEqlSequence:Object(p.h)(n.ecs),isExpanded:re,ref:$,showLeftBorder:!m},s.a.createElement(A,{id:n._id,actionsColumnWidth:e,ariaRowindex:k,columnHeaders:a,data:n.data,ecsData:n.ecs,eventIdToNoteIds:l,hasRowRenderers:me,isEventPinned:v,isEventViewer:m,loadingEventIds:g,notesCount:ue.length,onEventDetailsPanelOpened:ve,onRowSelected:y,refetch:x,renderCellValue:_,onRuleChange:j,selectedEventIds:S,showCheckboxes:T,showNotes:!!Q[n._id],tabType:N,timelineId:I,toggleShowNotes:pe,leadingControlColumns:F,trailingControlColumns:Z,setEventsLoading:fe,setEventsDeleted:ge}),s.a.createElement(L,null,s.a.createElement(f.w,{className:"siemEventsTable__trSupplement--notes","data-test-subj":"event-notes-flex-item",$display:"block"},s.a.createElement(O,{ariaRowindex:k,associateNote:be,"data-test-subj":"note-cards",notes:ue,showAddNote:!!Q[n._id],toggleShowAddNote:pe})),s.a.createElement(h.EuiFlexGroup,{gutterSize:"none",justifyContent:"center"},s.a.createElement(h.EuiFlexItem,{grow:!1},s.a.createElement(f.w,null,s.a.createElement(z,{ariaRowindex:k,containerRef:t,event:n,lastFocusedAriaColindex:b,rowRenderers:C,timelineId:I})))))))},q=s.a.memo(Z),U=({actionsColumnWidth:e,columnHeaders:t,containerRef:a,data:n,eventIdToNoteIds:i,id:o,isEventViewer:r=!1,lastFocusedAriaColindex:l,loadingEventIds:d,onRowSelected:c,pinnedEventIds:u,refetch:m,onRuleChange:v,renderCellValue:b,rowRenderers:g,selectedEventIds:h,showCheckboxes:w,tabType:E,leadingControlColumns:x,trailingControlColumns:_})=>s.a.createElement(f.j,{"data-test-subj":"events"},n.map(((n,f)=>{var C,j;return s.a.createElement(q,{actionsColumnWidth:e,ariaRowindex:f+2,columnHeaders:t,containerRef:a,event:n,eventIdToNoteIds:i,isEventPinned:Object(p.c)({eventId:n._id,pinnedEventIds:u}),isEventViewer:r,key:`${o}_${E}_${n._id}_${n._index}_${Object(y.isEmpty)(null===(C=n.ecs.eql)||void 0===C?void 0:C.sequenceNumber)?"":null===(j=n.ecs.eql)||void 0===j?void 0:j.sequenceNumber}`,lastFocusedAriaColindex:l,loadingEventIds:d,onRowSelected:c,renderCellValue:b,refetch:m,rowRenderers:g,onRuleChange:v,selectedEventIds:h,showCheckboxes:w,tabType:E,timelineId:o,leadingControlColumns:x,trailingControlColumns:_})}))),H=s.a.memo(U);var G=a(14),$=a(103);const Y=Object(G.createSelector)(Object($.getManageTimelineById)(),Object($.getTimelineByIdSelector)(),((e,t)=>({manageTimelineById:e,timeline:t})));var V=a(79);const Q=s.a.memo((({activePage:e,browserFields:t,data:a,id:v,isEventViewer:y=!1,onRuleChange:h,refetch:w,renderCellValue:E,rowRenderers:x,sort:_,tabType:C,totalPages:j,leadingControlColumns:k=[],trailingControlColumns:S=[]})=>{const T=Object(o.useDispatch)(),N=Object(i.useRef)(null),{manageTimelineById:{queryFields:O,selectAll:I},timeline:{columns:R,eventIdToNoteIds:A,excludedRowRendererIds:D,isSelectAllChecked:M,loadingEventIds:P,pinnedEventIds:F,selectedEventIds:z,showCheckboxes:W,show:B}=c.a}=Object(o.useSelector)((e=>Y(e,v))),L=Object(i.useMemo)((()=>Object(m.b)(R,t)),[t,R]),Z=Object(V.b)().isEnterprise()?6:5,q=Object(i.useCallback)((({eventIds:e,isSelected:t})=>{T(u.a.setSelected({id:v,eventIds:Object(p.d)(a,e,O),isSelected:t,isSelectAllChecked:t&&Object.keys(z).length+1===a.length}))}),[a,T,v,O,z]),U=Object(i.useCallback)((({isSelected:e})=>T(e?u.a.setSelected({id:v,eventIds:Object(p.d)(a,a.map((e=>e._id)),O),isSelected:e,isSelectAllChecked:e}):u.a.clearSelected({id:v}))),[a,T,v,O]);Object(i.useEffect)((()=>{I&&!M&&U({isSelected:!0})}),[M,U,I]);const G=Object(i.useMemo)((()=>D&&D.length===Object.keys(d.d).length?[b]:D?x.filter((e=>!D.includes(e.id))):x),[D,x]),$=Object(i.useMemo)((()=>Object(r.getActionsColumnWidth)(Z)),[Z]),Q=Object(i.useMemo)((()=>L.reduce(((e,t)=>{var a;return e+(null!==(a=t.initialWidth)&&void 0!==a?a:l.a)}),0)),[L]),K=Object(i.useMemo)((()=>k?k.reduce(((e,t)=>t.width?e+t.width:e+$),0):0),[$,k]),X=Object(i.useMemo)((()=>S?S.reduce(((e,t)=>t.width?e+t.width:e+$),0):0),[$,S]),J=Object(i.useMemo)((()=>Q+K+X),[Q,K,X]),[ee]=Object(i.useState)(r.FIRST_ARIA_INDEX),te=Object(i.useMemo)((()=>L.length+S.length+k.length),[L,S,k]),ae=Object(i.useCallback)((e=>{Object(r.onKeyDownFocusHandler)({colindexAttribute:r.ARIA_COLINDEX_ATTRIBUTE,containerElement:N.current,event:e,maxAriaColindex:L.length+1,maxAriaRowindex:a.length+1,onColumnFocused:n.noop,rowindexAttribute:r.ARIA_ROWINDEX_ATTRIBUTE})}),[L.length,N,a.length]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(f.B,{"data-test-subj":"timeline-body",ref:N},s.a.createElement(f.i,{$activePage:e,$columnCount:te,"data-test-subj":`${C}-events-table`,columnWidths:J,onKeyDown:ae,$rowCount:a.length,$totalPages:j},s.a.createElement(g.a,{actionsColumnWidth:$,browserFields:t,columnHeaders:L,isEventViewer:y,isSelectAllChecked:M,onSelectAll:U,show:B,showEventsSelect:!1,showSelectAllCheckbox:W,sort:_,tabType:C,timelineId:v,leadingControlColumns:k,trailingControlColumns:S}),s.a.createElement(H,{containerRef:N,actionsColumnWidth:$,columnHeaders:L,data:a,eventIdToNoteIds:A,id:v,isEventViewer:y,lastFocusedAriaColindex:ee,loadingEventIds:P,onRowSelected:q,pinnedEventIds:F,refetch:w,renderCellValue:E,rowRenderers:G,onRuleChange:h,selectedEventIds:z,showCheckboxes:W,leadingControlColumns:k,trailingControlColumns:S,tabType:C}))),s.a.createElement(f.C,null))}));Q.displayName="StatefulBody"},899:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(92),i=a.n(n),s=a(3),o=a(4),r=a(47),l=a(20),d=a(177),c=a(19),u=a(229),m=a(91),p=a(659),v=a(81),b=a(77);const f=a(6).i18n.translate("xpack.securitySolution.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"});var g=a(15),y=a(293),h=a(84),w=a(202),E=a(543),x=a(1);const _=[{field:"@timestamp",direction:b.b.asc,type:"date",esTypes:["date"]}],C=e=>({...Object(s.isEmpty)(null==e?void 0:e.eventCategoryField)?{}:{eventCategoryField:null==e?void 0:e.eventCategoryField},...Object(s.isEmpty)(null==e?void 0:e.size)?{}:{size:null==e?void 0:e.size},...Object(s.isEmpty)(null==e?void 0:e.tiebreakerField)?{}:{tiebreakerField:null==e?void 0:e.tiebreakerField},...Object(s.isEmpty)(null==e?void 0:e.timestampField)?{}:{timestampField:null==e?void 0:e.timestampField}}),j=({dataViewId:e,endDate:t,eqlOptions:a,id:n="timelineEventsQuery",indexNames:j,fields:k,filterQuery:S,runtimeMappings:T,startDate:N,language:O="kuery",limit:I,sort:R=_,skip:A=!1,timerangeKind:D})=>{const[{pageName:M}]=Object(y.a)(),P=Object(r.useDispatch)(),{data:F}=Object(c.k)().services,z=Object(o.useRef)(s.noop),W=Object(o.useRef)(new AbortController),B=Object(o.useRef)(new l.Subscription),[L,Z]=Object(o.useState)(!1),[q,U]=Object(o.useState)(n===g.i.active?h.a.getActivePage():0),[H,G]=Object(o.useState)(null),$=Object(o.useRef)(null),{startTracking:Y}=Object(E.a)(),V=Object(o.useCallback)((()=>{null!=n&&p.a.some((e=>e===n))&&(P(m.a.clearEventsLoading({id:n})),P(m.a.clearEventsDeleted({id:n})))}),[P,n]),Q=Object(o.useCallback)((e=>{V(),n===g.i.active&&(h.a.setExpandedDetail({}),h.a.setActivePage(e)),U(e)}),[V,n]),K=Object(o.useCallback)((()=>{null!=z.current&&z.current(),Q(0)}),[Q]),X=Object(o.useCallback)((e=>{P(m.a.setTimelineUpdatedAt({id:n,updated:e}))}),[P,n]),[J,ee]=Object(o.useState)({id:n,inspect:{dsl:[],response:[]},refetch:K,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:Q,updatedAt:0}),{addWarning:te}=Object(w.a)(),ae=Object(o.useCallback)((t=>{if(null==t||""===M||A)return;const a=async()=>{$.current=t,W.current=new AbortController,Z(!0);const{endTracking:a}=Y({name:`${x.A} timeline events search`});B.current=F.search.search(t,{strategy:"eql"===t.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:W.current.signal,indexPattern:{id:e}}).subscribe({next:e=>{Object(d.isCompleteResponse)(e)?(a("success"),Z(!1),ee((a=>{const i={...a,events:(s=e.edges,s.map((e=>e.node))),inspect:Object(v.c)(e,a.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,updatedAt:Date.now()};var s;return X(i.updatedAt),n===g.i.active&&(h.a.setExpandedDetail({}),h.a.setPageName(M),"eql"===t.language?(h.a.setEqlRequest(t),h.a.setEqlResponse(i)):(h.a.setRequest(t),h.a.setResponse(i))),i})),B.current.unsubscribe()):Object(d.isErrorResponse)(e)&&(a("invalid"),Z(!1),te(f),B.current.unsubscribe())},error:e=>{a(W.current.signal.aborted?"aborted":"error"),Z(!1),F.search.showError(e),B.current.unsubscribe()}})};if(n===g.i.active&&""!==h.a.getPageName()&&M!==h.a.getPageName()){if(h.a.setPageName(M),W.current.abort(),Z(!1),"eql"===t.language?($.current=h.a.getEqlRequest(),z.current=a.bind(null,h.a.getEqlRequest())):($.current=h.a.getRequest(),z.current=a.bind(null,h.a.getRequest())),ee((e=>{const a="eql"===t.language?h.a.getEqlResponse():h.a.getResponse();return null!=a?{...a,refetch:K,loadPage:Q}:e})),"eql"!==t.language&&null!=h.a.getResponse())return;if("eql"===t.language&&null!=h.a.getEqlResponse())return}B.current.unsubscribe(),W.current.abort(),a(),z.current=a}),[M,A,n,Y,F.search,e,X,te,K,Q]);return Object(o.useEffect)((()=>{Object(p.b)(n,j)||0===j.length||G((e=>{var s,o,r,l,d,c;const m=e,v={defaultIndex:null!==(s=null==e?void 0:e.defaultIndex)&&void 0!==s?s:[],filterQuery:null!==(o=null==e?void 0:e.filterQuery)&&void 0!==o?o:"",querySize:null!==(r=null==e?void 0:e.pagination.querySize)&&void 0!==r?r:0,sort:null!==(l=null==e?void 0:e.sort)&&void 0!==l?l:_,timerange:null!==(d=null==e?void 0:e.timerange)&&void 0!==d?d:{},runtimeMappings:null!==(c=null==e?void 0:e.runtimeMappings)&&void 0!==c?c:{},...C(m)},f={defaultIndex:j,filterQuery:Object(u.a)(S),querySize:I,sort:R,timerange:{interval:"12h",from:N,to:t},runtimeMappings:T,...C(a)},y=i()(v,f)?q:0,w={defaultIndex:j,factoryQueryType:b.z.all,fieldRequested:k,fields:k,filterQuery:Object(u.a)(S),pagination:{activePage:y,querySize:I},language:O,runtimeMappings:T,sort:R,timerange:{interval:"12h",from:N,to:t},...a||{}};return q!==y&&(U(y),n===g.i.active&&h.a.setActivePage(y)),Object(p.b)(n,j)||i()(e,w)?e:w}))}),[P,j,q,t,a,S,n,O,I,N,R,k,T]),Object(o.useEffect)((()=>(n===g.i.active&&"absolute"!==D&&i()($.current,H)||ae(H),()=>{B.current.unsubscribe(),W.current.abort()})),[n,H,ae,D]),Object(o.useEffect)((()=>{Object(s.isEmpty)(S)&&ee({id:n,inspect:{dsl:[],response:[]},refetch:K,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:Q,updatedAt:0})}),[S,n,K,Q]),[L,J]}},900:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(17),i=a(4),s=a.n(i),o=a(24),r=a.n(o),l=a(47),d=a(38),c=a(719),u=a(463),m=a(533);const p=r()(n.EuiFlexItem).withConfig({displayName:"NewNoteTabs",componentId:"sc-co6fvn-0"})(["width:100%;"]);p.displayName="NewNoteTabs";const v=s.a.memo((({note:e,noteInputHeight:t,updateNewNote:a,autoFocusDisabled:n=!1})=>s.a.createElement(p,{"data-test-subj":"new-note-tabs"},s.a.createElement(m.a,{ariaLabel:u.d,onChange:a,value:e,dataTestSubj:"add-a-note",height:t,autoFocusDisabled:n}))));v.displayName="NewNote";const b=r.a.div.withConfig({displayName:"AddNotesContainer",componentId:"sc-1csl9ju-0"})(["margin-bottom:5px;user-select:none;"]);b.displayName="AddNotesContainer";const f=r()(n.EuiFlexGroup).withConfig({displayName:"ButtonsContainer",componentId:"sc-1csl9ju-1"})(["margin-top:5px;"]);f.displayName="ButtonsContainer";const g=s.a.memo((({onCancelAddNote:e})=>s.a.createElement(n.EuiButtonEmpty,{"data-test-subj":"cancel",onClick:e},u.b)));g.displayName="CancelButton";const y=s.a.memo((({associateNote:e,newNote:t,onCancelAddNote:a,updateNewNote:o,autoFocusDisabled:r=!1})=>{const m=Object(l.useDispatch)(),p=Object(i.useCallback)((e=>m(d.a.updateNote({note:e}))),[m]),y=Object(i.useCallback)((()=>Object(c.b)({associateNote:e,newNote:t,updateNewNote:o,updateNote:p})),[e,t,o,p]),h=Object(i.useCallback)((e=>{e.stopPropagation(),"Escape"===e.key&&null!=a&&a()}),[a]);return s.a.createElement(b,{onKeyDown:h,role:"dialog"},s.a.createElement("div",{style:{width:"100%"}},s.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},s.a.createElement("p",null,u.g)),s.a.createElement(v,{note:t,noteInputHeight:200,updateNewNote:o,autoFocusDisabled:r}),s.a.createElement(f,{gutterSize:"none"},null!=a?s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(g,{onCancelAddNote:a})):null,s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiButton,{"data-test-subj":"add-note",isDisabled:0===t.trim().length,fill:!0,onClick:y},u.a)))))}));y.displayName="AddNote"},901:function(e,t,a){"use strict";a.d(t,"b",(function(){return N})),a.d(t,"a",(function(){return P}));var n=a(17),i=a(175),s=a(4),o=a.n(s),r=a(24),l=a.n(r),d=a(47),c=a(241),u=a(6);u.i18n.translate("xpack.securitySolution.footer.events",{defaultMessage:"Events"});const m=u.i18n.translate("xpack.securitySolution.footer.of",{defaultMessage:"of"}),p=u.i18n.translate("xpack.securitySolution.footer.rows",{defaultMessage:"rows"}),v=u.i18n.translate("xpack.securitySolution.footer.loadingLabel",{defaultMessage:"Loading"}),b=u.i18n.translate("xpack.securitySolution.footer.totalCountOfEvents",{defaultMessage:"events"}),f=u.i18n.translate("xpack.securitySolution.footer.autoRefreshActiveDescription",{defaultMessage:"Auto-Refresh Active"}),g=u.i18n.translate("xpack.securitySolution.footer.loadingEventsDataLabel",{defaultMessage:"Loading Events"});var y=a(600),h=a(91),w=a(76),E=a(19);const x=o.a.memo((({updatedAt:e})=>{const{timelines:t}=Object(E.k)().services,a=Object(y.b)(),n=Object(s.useMemo)((()=>(e=>e<600)(a)),[a]);return e>0?o.a.createElement(_,{"data-test-subj":"fixed-width-last-updated",compact:n},t.getLastUpdated({updatedAt:e,compact:n})):null}));x.displayName="FixedWidthLastUpdatedContainer";const _=l.a.div.withConfig({displayName:"FixedWidthLastUpdated",componentId:"sc-1nmhyt9-0"})(["width:","px;overflow:hidden;text-align:end;"],(({compact:e})=>e?25:200));_.displayName="FixedWidthLastUpdated";const C=l()(n.EuiFlexGroup).attrs((({height:e})=>({style:{height:`${e}px`}}))).withConfig({displayName:"FooterContainer",componentId:"sc-1nmhyt9-1"})(["flex:0 0 auto;"]);C.displayName="FooterContainer";const j=l()(n.EuiFlexGroup).withConfig({displayName:"FooterFlexGroup",componentId:"sc-1nmhyt9-2"})(["height:35px;width:100%;"]);j.displayName="FooterFlexGroup";const k=l.a.div.withConfig({displayName:"LoadingPanelContainer",componentId:"sc-1nmhyt9-3"})(["padding-top:3px;"]);k.displayName="LoadingPanelContainer";const S=l()(n.EuiPopover).withConfig({displayName:"PopoverRowItems",componentId:"sc-1nmhyt9-4"})([".euiButtonEmpty__content{padding:0px 0px;}"]);S.displayName="PopoverRowItems";const T=l.a.div.withConfig({displayName:"ServerSideEventCount",componentId:"sc-1nmhyt9-5"})(["margin:0 5px 0 5px;"]);T.displayName="ServerSideEventCount";const N=40,O=({closePopover:e,documentType:t,footerText:a,isOpen:i,items:r,itemsCount:l,onClick:d,serverSideEventCount:u})=>{const p=Object(s.useMemo)((()=>u>0?u:0),[u]);return o.a.createElement("h5",null,o.a.createElement(S,{className:"footer-popover",id:"customizablePagination","data-test-subj":"timelineSizeRowPopover",button:o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiBadge,{"data-test-subj":"local-events-count",color:"hollow"},l,o.a.createElement(n.EuiButtonEmpty,{className:c.d,size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:d,"data-test-subj":"local-events-count-button"})),` ${m} `),isOpen:i,closePopover:e,panelPaddingSize:"none"},o.a.createElement(n.EuiContextMenuPanel,{items:r,"data-test-subj":"timelinePickSizeRow"})),o.a.createElement(n.EuiToolTip,{content:o.a.createElement(o.a.Fragment,null,p," ",a)},o.a.createElement(T,null,o.a.createElement(n.EuiBadge,{color:"hollow","data-test-subj":"server-side-event-count"},p)," ",t)))};O.displayName="EventsCountComponent";const I=o.a.memo(O);I.displayName="EventsCount";const R=l.a.div.withConfig({displayName:"TimelinePaginationContainer",componentId:"sc-1nmhyt9-6"})(["ul.euiPagination__list{li.euiPagination__item:last-child{",";}}"],(({hideLastPage:e})=>e?"display:none":"")),A=({activePage:e,isLoading:t,onPageClick:a,totalCount:i,totalPages:s})=>t?o.a.createElement(o.a.Fragment,null,`${v}...`):s?o.a.createElement(R,{hideLastPage:i>9999},o.a.createElement(n.EuiPagination,{"data-test-subj":"timeline-pagination",pageCount:s,activePage:e,onPageClick:a})):null;A.displayName="PagingControlComponent";const D=o.a.memo(A);D.displayName="PagingControl";const M=({activePage:e,updatedAt:t,height:a,id:r,isLive:l,isLoading:c,itemsCount:u,itemsPerPage:m,itemsPerPageOptions:v,onChangePage:y,totalCount:_})=>{const S=Object(d.useDispatch)(),{timelines:T}=Object(E.k)().services,[N,O]=Object(s.useState)(!1),[R,A]=Object(s.useState)(!1),M=Object(s.useMemo)((()=>h.b.getManageTimelineById()),[]),{documentType:P=b,loadingText:F=g,footerText:z=b}=Object(w.a)((e=>M(e,r))),W=Object(s.useCallback)((e=>{A(!0),y(e)}),[y]),B=Object(s.useCallback)((()=>O(!N)),[N,O]),L=Object(s.useCallback)((()=>O(!1)),[O]),Z=Object(s.useCallback)((e=>S(h.a.updateItemsPerPage({id:r,itemsPerPage:e}))),[S,r]),q=Object(s.useMemo)((()=>v&&v.map((e=>o.a.createElement(n.EuiContextMenuItem,{key:e,icon:m===e?"check":"empty","data-test-subj":`items-per-page-option-${e}`,onClick:()=>{L(),Z(e)}},`${e} ${p}`)))),[L,m,v,Z]),U=Object(s.useMemo)((()=>Math.ceil(_/m)),[m,_]);return Object(s.useEffect)((()=>{R&&!c&&A(!1)}),[c,R]),c&&!R?o.a.createElement(k,null,T.getLoadingPanel({dataTestSubj:"LoadingPanelTimeline",height:"35px",showBorder:!1,text:F,width:"100%"})):o.a.createElement(C,{"data-test-subj":"timeline-footer",direction:"column",gutterSize:"none",height:a,justifyContent:"spaceAround"},o.a.createElement(j,{alignItems:"center","data-test-subj":"footer-flex-group",direction:"row",gutterSize:"none",justifyContent:"spaceBetween"},o.a.createElement(n.EuiFlexItem,{"data-test-subj":"event-count-container",grow:!1},o.a.createElement(n.EuiFlexGroup,{alignItems:"center","data-test-subj":"events-count",direction:"row",gutterSize:"none"},o.a.createElement(I,{closePopover:L,documentType:P,footerText:z,isOpen:N,items:q,itemsCount:u,onClick:B,serverSideEventCount:_}))),o.a.createElement(n.EuiFlexItem,{"data-test-subj":"last-updated-container",grow:!1},o.a.createElement(x,{updatedAt:t})),o.a.createElement(n.EuiFlexItem,{"data-test-subj":"paging-control-container",grow:!1},l?o.a.createElement(n.EuiText,{size:"s","data-test-subj":"is-live-on-message"},o.a.createElement("b",null,f," ",o.a.createElement(n.EuiIconTip,{color:"text",content:o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.footer.autoRefreshActiveTooltip",defaultMessage:"While auto-refresh is enabled, timeline will show you the latest {numberOfItems} events that match your query.",values:{numberOfItems:u}}),type:"iInCircle"}))):o.a.createElement(D,{"data-test-subj":"paging-control",totalCount:_,totalPages:U,activePage:e,onPageClick:W,isLoading:c}))))};M.displayName="FooterComponent";const P=o.a.memo(M);P.displayName="Footer"}}]);