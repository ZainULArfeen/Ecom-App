!function(e){function t(t){for(var n,i,s=t[0],o=t[1],a=0,u=[];a<s.length;a++)i=s[a],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);u.length;)u.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=s);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(e){return i.p+"expressionMetricVis.chunk."+e+".js"}(e);var c=new Error;o=function(t){a.onerror=a.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+s+")",c.name="ChunkLoadError",c.type=i,c.request=s,n[1](c)}r[e]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:a})}),12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var s=window.expressionMetricVis_bundle_jsonpfunction=window.expressionMetricVis_bundle_jsonpfunction||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var a=0;a<s.length;a++)t(s[a]);var c=o;i(i.s=13)}([function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/visualizations/common/utils");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var r=n(1);const[i,s]=Object(r.createGetterSetter)("charts.theme")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var r=n(1);const[i,s]=Object(r.createGetterSetter)("uiSettings")},function(e,t){e.exports=__kbnSharedDeps__.ElasticCharts},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return o.a})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return u.a}));var r=n(1);const[i,s]=Object(r.createGetterSetter)("fieldFormats");var o=n(4);const[a,c]=Object(r.createGetterSetter)("palette");var u=n(5)},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n)=>{if(!t)return{min:-1/0,max:1/0};const r=Math.min(...t.rows.map((t=>t[e.metric]))),i=Math.max(...t.rows.map((t=>t[e.metric])));if(!(e.max||e.breakdownBy||void 0===n&&1!==t.rows.length)){const e=i;return e<0?{min:2*e,max:0}:{min:0,max:2*e}}const s=e.max?n?t.rows[n][e.max]:Math.max(...t.rows.map((t=>t[e.max]))):i;return{min:e.breakdownBy&&!e.max?r:0,max:e.breakdownBy?e.max?s:i:s}}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.KbnAnalytics},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){n(14),__kbnBundles__.define("plugin/expressionMetricVis/public",n,15)},function(e,t,n){n.p=window.__kbnPublicPath__.expressionMetricVis},function(e,t,n){"use strict";n.r(t),n.d(t,"plugin",(function(){return g})),n.d(t,"getDataBoundsForPalette",(function(){return _.a}));var r=n(1),i=n(0),s=n(2),o=n(6);const a="metricVis",c=()=>({name:a,type:"render",inputTypes:["datatable"],help:i.i18n.translate("expressionMetricVis.function.help",{defaultMessage:"Metric visualization"}),args:{metric:{types:["vis_dimension","string"],help:i.i18n.translate("expressionMetricVis.function.metric.help",{defaultMessage:"The primary metric."}),required:!0},secondaryMetric:{types:["vis_dimension","string"],help:i.i18n.translate("expressionMetricVis.function.secondaryMetric.help",{defaultMessage:"The secondary metric (shown above the primary)."})},max:{types:["vis_dimension","string"],help:i.i18n.translate("expressionMetricVis.function.max.help.",{defaultMessage:"The dimension containing the maximum value."})},breakdownBy:{types:["vis_dimension","string"],help:i.i18n.translate("expressionMetricVis.function.breakdownBy.help",{defaultMessage:"The dimension containing the labels for sub-categories."})},subtitle:{types:["string"],help:i.i18n.translate("expressionMetricVis.function.subtitle.help",{defaultMessage:"The subtitle for a single metric. Overridden if breakdownBy is supplied."})},secondaryPrefix:{types:["string"],help:i.i18n.translate("expressionMetricVis.function.secondaryPrefix.help",{defaultMessage:"Optional text to be show before secondaryMetric."})},progressDirection:{types:["string"],options:[o.LayoutDirection.Vertical,o.LayoutDirection.Horizontal],default:o.LayoutDirection.Vertical,help:i.i18n.translate("expressionMetricVis.function.progressDirection.help",{defaultMessage:"The direction the progress bar should grow."}),strict:!0},color:{types:["string"],help:i.i18n.translate("expressionMetricVis.function.color.help",{defaultMessage:"Provides a static visualization color. Overridden by palette."})},palette:{types:["palette"],help:i.i18n.translate("expressionMetricVis.function.palette.help",{defaultMessage:"Provides colors for the values, based on the bounds."})},maxCols:{types:["number"],help:i.i18n.translate("expressionMetricVis.function.numCols.help",{defaultMessage:"Specifies the max number of columns in the metric grid."}),default:5},minTiles:{types:["number"],help:i.i18n.translate("expressionMetricVis.function.minTiles.help",{defaultMessage:"Specifies the minimum number of tiles in the metric grid regardless of the input data."})}},fn(e,t,n){var r,o;if(Object(s.validateAccessor)(t.metric,e.columns),Object(s.validateAccessor)(t.secondaryMetric,e.columns),Object(s.validateAccessor)(t.max,e.columns),Object(s.validateAccessor)(t.breakdownBy,e.columns),null!=n&&null!==(r=n.inspectorAdapters)&&void 0!==r&&r.tables){n.inspectorAdapters.tables.reset(),n.inspectorAdapters.tables.allowCsvExport=!0;const r=[[[t.metric],i.i18n.translate("expressionMetricVis.function.dimension.metric",{defaultMessage:"Metric"})]];t.secondaryMetric&&r.push([[t.secondaryMetric],i.i18n.translate("expressionMetricVis.function.dimension.secondaryMetric",{defaultMessage:"Secondary Metric"})]),t.breakdownBy&&r.push([[t.breakdownBy],i.i18n.translate("expressionMetricVis.function.dimension.splitGroup",{defaultMessage:"Split group"})]),t.max&&r.push([[t.max],i.i18n.translate("expressionMetricVis.function.dimension.maximum",{defaultMessage:"Maximum"})]);const o=Object(s.prepareLogTable)(e,r,!0);n.inspectorAdapters.tables.logDatatable("default",o)}return{type:"render",as:a,value:{visData:e,visType:"metric",visConfig:{metric:{subtitle:t.subtitle,secondaryPrefix:t.secondaryPrefix,color:t.color,palette:null===(o=t.palette)||void 0===o?void 0:o.params,progressDirection:t.progressDirection,maxCols:t.maxCols,minTiles:t.minTiles},dimensions:{metric:t.metric,secondaryMetric:t.secondaryMetric,max:t.max,breakdownBy:t.breakdownBy}}}}}});var u=n(7),l=(n(12),n(8)),p=n(10),d=n(3),f=n(11),m={name:"16k86jb",styles:"height:100%;width:100%;display:flex;align-items:center;justify-content:center"};var b=n(4),h=n(5);class plugin_ExpressionMetricPlugin{setup(e,{expressions:t,charts:i}){const o=Object(r.createStartServicesGetter)(e.getStartServices);var _;i.palettes.getPalettes().then((e=>{Object(u.f)(e)})),t.registerFunction(c),t.registerRenderer((_={getStartDeps:o},()=>({name:a,displayName:"metric visualization",reuseDomNode:!0,render:async(e,{visData:t,visConfig:r},i)=>{var o;const{core:a,plugins:c}=_.getStartDeps();i.onDestroy((()=>{Object(l.unmountComponentAtNode)(e)}));const u=!!t.rows.length&&await async function(e,t,n){var r;const i=Object(s.getColumnByAccessor)(null!==(r=e.breakdownBy)&&void 0!==r?r:e.metric,t.columns),o=t.columns.indexOf(i);return Boolean(await(null==n?void 0:n({name:"filter",data:{data:[{table:t,column:o,row:0}]}})))}(r.dimensions,t,null===(o=i.hasCompatibleActions)||void 0===o?void 0:o.bind(i)),{MetricVis:b}=await n.e(2).then(n.bind(null,38));Object(l.render)(Object(d.jsx)(p.KibanaThemeProvider,{theme$:a.theme.theme$},Object(d.jsx)("div",{"data-test-subj":"mtrVis",css:m},Object(d.jsx)(b,{data:t,config:r,renderComplete:()=>{const e=i.getExecutionContext(),t=(e=>{if(e){var t;const n=e=>e.type?e:e.child?n(e.child):void 0;return null===(t=n(e))||void 0===t?void 0:t.type}})(e),n=(e=>{if(e){var t;const n=e=>e.child?n(e.child):e;return null===(t=n(e))||void 0===t?void 0:t.type}})(e);var r;t&&n&&(null===(r=c.usageCollection)||void 0===r||r.reportUiCounter(t,f.METRIC_TYPE.COUNT,[`render_${n}_metric`])),i.done()},fireEvent:i.event,renderMode:i.getRenderMode(),filterable:u}))),e)}}))),Object(h.b)(e.uiSettings),Object(b.b)(i.theme)}start(e,{fieldFormats:t}){Object(u.e)(t)}}var _=n(9);function g(){return new plugin_ExpressionMetricPlugin}},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t){e.exports=__kbnSharedDeps__.ElasticNumeral},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/fieldFormats/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.KbnUiTheme},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t){e.exports=__kbnSharedDeps__.TsLib}]);