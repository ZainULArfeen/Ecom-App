/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[7],{1093:function(e,t,n){var r=n(921)("set",n(1154));r.placeholder=n(945),e.exports=r},1094:function(e,t,n){e.exports=n(25)(3506)},1095:function(e,t,n){e.exports={ary:n(1096),assign:n(1120),clone:n(1121),curry:n(1122),forEach:n(934),isArray:n(544),isError:n(1123),isFunction:n(938),isWeakMap:n(1126),iteratee:n(1128),keys:n(1146),rearg:n(1147),toInteger:n(936),toPath:n(1149)}},1096:function(e,t,n){var r=n(710);e.exports=function(e,t,n){return t=n?void 0:t,t=e&&null==t?e.length:t,r(e,128,void 0,void 0,void 0,void 0,t)}},1097:function(e,t,n){e.exports=n(25)(3051)},1098:function(e,t,n){var r=n(632),i=n(633);e.exports=function(e,t,n){var a=1&t,o=r(e);return function t(){var r=this&&this!==i&&this instanceof t?o:e;return r.apply(a?n:this,arguments)}}},1099:function(e,t,n){var r=n(925),i=n(632),a=n(926),o=n(929),c=n(935),s=n(718),u=n(633);e.exports=function(e,t,n){var l=i(e);return function i(){for(var d=arguments.length,f=Array(d),p=d,b=c(i);p--;)f[p]=arguments[p];var g=d<3&&f[0]!==b&&f[d-1]!==b?[]:s(f,b);if((d-=g.length)<n)return o(e,t,a,i.placeholder,void 0,f,g,void 0,void 0,n-d);var m=this&&this!==u&&this instanceof i?l:e;return r(m,this,f)}}},1100:function(e,t){e.exports=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}},1101:function(e,t,n){var r=n(713),i=n(930),a=n(1103),o=n(1105);e.exports=function(e){var t=a(e),n=o[t];if("function"!=typeof n||!(t in r.prototype))return!1;if(e===n)return!0;var c=i(n);return!!c&&e===c[0]}},1102:function(e,t){e.exports=function(){}},1103:function(e,t,n){var r=n(1104),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=r[t],a=i.call(r,t)?n.length:0;a--;){var o=n[a],c=o.func;if(null==c||c==e)return o.name}return t}},1104:function(e,t){e.exports={}},1105:function(e,t,n){var r=n(713),i=n(931),a=n(714),o=n(544),c=n(715),s=n(1106),u=Object.prototype.hasOwnProperty;function l(e){if(c(e)&&!o(e)&&!(e instanceof r)){if(e instanceof i)return e;if(u.call(e,"__wrapped__"))return s(e)}return new i(e)}l.prototype=a.prototype,l.prototype.constructor=l,e.exports=l},1106:function(e,t,n){var r=n(713),i=n(931),a=n(716);e.exports=function(e){if(e instanceof r)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=a(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},1107:function(e,t,n){e.exports=n(25)(3375)},1108:function(e,t){var n=/\{\n\/\* \[wrapped with (.+)\] \*/,r=/,? & /;e.exports=function(e){var t=e.match(n);return t?t[1].split(r):[]}},1109:function(e,t){var n=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var r=t.length;if(!r)return e;var i=r-1;return t[i]=(r>1?"& ":"")+t[i],t=t.join(r>2?", ":" "),e.replace(n,"{\n/* [wrapped with "+t+"] */\n")}},1110:function(e,t,n){e.exports=n(25)(3372)},1111:function(e,t,n){var r=n(934),i=n(1112),a=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return r(a,(function(n){var r="_."+n[0];t&n[1]&&!i(e,r)&&e.push(r)})),e.sort()}},1112:function(e,t,n){var r=n(1113);e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},1113:function(e,t,n){var r=n(1114),i=n(1115),a=n(1116);e.exports=function(e,t,n){return t==t?a(e,t,n):r(e,i,n)}},1114:function(e,t){e.exports=function(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}},1115:function(e,t){e.exports=function(e){return e!=e}},1116:function(e,t){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},1117:function(e,t,n){var r=n(716),i=n(717),a=Math.min;e.exports=function(e,t){for(var n=e.length,o=a(t.length,n),c=r(e);o--;){var s=t[o];e[o]=i(s,n)?c[s]:void 0}return e}},1118:function(e,t,n){var r=n(925),i=n(632),a=n(633);e.exports=function(e,t,n,o){var c=1&t,s=i(e);return function t(){for(var i=-1,u=arguments.length,l=-1,d=o.length,f=Array(d+u),p=this&&this!==a&&this instanceof t?s:e;++l<d;)f[l]=o[l];for(;u--;)f[l++]=arguments[++i];return r(p,c?n:this,f)}}},1119:function(e,t,n){var r=n(927),i=n(928),a=n(718),o="__lodash_placeholder__",c=Math.min;e.exports=function(e,t){var n=e[1],s=t[1],u=n|s,l=u<131,d=128==s&&8==n||128==s&&256==n&&e[7].length<=t[8]||384==s&&t[7].length<=t[8]&&8==n;if(!l&&!d)return e;1&s&&(e[2]=t[2],u|=1&n?0:4);var f=t[3];if(f){var p=e[3];e[3]=p?r(p,f,t[4]):f,e[4]=p?a(e[3],o):t[4]}return(f=t[5])&&(p=e[5],e[5]=p?i(p,f,t[6]):f,e[6]=p?a(e[5],o):t[6]),(f=t[7])&&(e[7]=f),128&s&&(e[8]=null==e[8]?t[8]:c(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=u,e}},1120:function(e,t,n){e.exports=n(25)(3340)},1121:function(e,t,n){var r=n(937);e.exports=function(e){return r(e,4)}},1122:function(e,t,n){var r=n(710);function i(e,t,n){var a=r(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return a.placeholder=i.placeholder,a}i.placeholder={},e.exports=i},1123:function(e,t,n){var r=n(1124),i=n(715),a=n(1125);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!a(e)}},1124:function(e,t,n){e.exports=n(25)(315)},1125:function(e,t,n){e.exports=n(25)(3365)},1126:function(e,t,n){var r=n(1127),i=n(715);e.exports=function(e){return i(e)&&"[object WeakMap]"==r(e)}},1127:function(e,t,n){e.exports=n(25)(743)},1128:function(e,t,n){var r=n(937),i=n(1129);e.exports=function(e){return i("function"==typeof e?e:r(e,1))}},1129:function(e,t,n){var r=n(1130),i=n(1135),a=n(923),o=n(544),c=n(1142);e.exports=function(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?o(e)?i(e[0],e[1]):r(e):c(e)}},1130:function(e,t,n){var r=n(1131),i=n(1133),a=n(941);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},1131:function(e,t,n){var r=n(1132),i=n(939);e.exports=function(e,t,n,a){var o=n.length,c=o,s=!a;if(null==e)return!c;for(e=Object(e);o--;){var u=n[o];if(s&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<c;){var l=(u=n[o])[0],d=e[l],f=u[1];if(s&&u[2]){if(void 0===d&&!(l in e))return!1}else{var p=new r;if(a)var b=a(d,f,l,e,t,p);if(!(void 0===b?i(f,d,3,a,p):b))return!1}}return!0}},1132:function(e,t,n){e.exports=n(25)(1452)},1133:function(e,t,n){var r=n(940),i=n(1134);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var a=t[n],o=e[a];t[n]=[a,o,r(o)]}return t}},1134:function(e,t,n){e.exports=n(25)(1104)},1135:function(e,t,n){var r=n(939),i=n(1136),a=n(1137),o=n(943),c=n(940),s=n(941),u=n(545);e.exports=function(e,t){return o(e)&&c(t)?s(u(e),t):function(n){var o=i(n,e);return void 0===o&&o===t?a(n,e):r(t,o,3)}}},1136:function(e,t,n){e.exports=n(25)(1753)},1137:function(e,t,n){var r=n(1138),i=n(1139);e.exports=function(e,t){return null!=e&&i(e,t,r)}},1138:function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},1139:function(e,t,n){var r=n(942),i=n(1140),a=n(544),o=n(717),c=n(1141),s=n(545);e.exports=function(e,t,n){for(var u=-1,l=(t=r(t,e)).length,d=!1;++u<l;){var f=s(t[u]);if(!(d=null!=e&&n(e,f)))break;e=e[f]}return d||++u!=l?d:!!(l=null==e?0:e.length)&&c(l)&&o(f,l)&&(a(e)||i(e))}},1140:function(e,t,n){e.exports=n(25)(1461)},1141:function(e,t,n){e.exports=n(25)(1464)},1142:function(e,t,n){var r=n(1143),i=n(1144),a=n(943),o=n(545);e.exports=function(e){return a(e)?r(o(e)):i(e)}},1143:function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},1144:function(e,t,n){var r=n(1145);e.exports=function(e){return function(t){return r(t,e)}}},1145:function(e,t,n){e.exports=n(25)(1501)},1146:function(e,t,n){e.exports=n(25)(3046)},1147:function(e,t,n){var r=n(710),i=n(1148)((function(e,t){return r(e,256,void 0,void 0,void 0,t)}));e.exports=i},1148:function(e,t,n){e.exports=n(25)(3366)},1149:function(e,t,n){var r=n(1150),i=n(716),a=n(544),o=n(1151),c=n(1152),s=n(545),u=n(1153);e.exports=function(e){return a(e)?r(e,s):o(e)?[e]:i(c(u(e)))}},1150:function(e,t,n){e.exports=n(25)(1502)},1151:function(e,t,n){e.exports=n(25)(750)},1152:function(e,t,n){e.exports=n(25)(3334)},1153:function(e,t,n){e.exports=n(25)(3336)},1154:function(e,t,n){e.exports=n(1155)},1155:function(e,t,n){var r=n(944);e.exports=function(e,t,n){return null==e?e:r(e,t,n)}},1156:function(e,t,n){e.exports=n(25)(1504)},1157:function(e,t,n){var r=n(921)("setWith",n(1158));r.placeholder=n(945),e.exports=r},1158:function(e,t,n){e.exports=n(1159)},1159:function(e,t,n){var r=n(944);e.exports=function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:r(e,t,n,i)}},1162:function(e,t,n){"use strict";var r,i=(r=n(637))&&"object"==typeof r&&"default"in r?r.default:r,a=n(4);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}e.exports=function(e){var t=void 0===e?{}:e,n=t.ref,r=t.onResize,c=a.useRef(null);n=n||c;var s=a.useState({width:void 0,height:void 0}),u=s[0],l=s[1],d=a.useRef({width:void 0,height:void 0});return a.useEffect((function(){if("object"==typeof n&&null!==n&&n.current instanceof Element){var e=n.current,t=new i((function(e){if(Array.isArray(e)&&e.length){var t=e[0],n=Math.round(t.contentRect.width),i=Math.round(t.contentRect.height);if(d.current.width!==n||d.current.height!==i){var a={width:n,height:i};r?r(a):(d.current.width=n,d.current.height=i,l(a))}}}));return t.observe(e),function(){return t.unobserve(e)}}}),[n,r]),a.useMemo((function(){return o({ref:n},u)}),[n,u?u.width:null,u?u.height:null])}},207:function(e,t,n){"use strict";n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return I})),n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return E}));var r=n(4),i=n(47),a=n(6),o=n(62),c=n(33),s=n(13),u=n(277),l=n(91),d=n(1),f=n(239),p=n(76),b=n(60),g=n(202),m=n(508),v=n(461),h=n(316),x=n(315),O=n(421),y=n(61);const j=(e=s.SourcererScopeName.default)=>{const t=Object(i.useDispatch)(),n=Object(r.useRef)(new AbortController),o=Object(r.useRef)(!0),d=Object(r.useRef)(!0),{loading:h,isSignalIndexExists:y,signalIndexName:j}=Object(u.c)(),I=Object(x.d)(O.a.sourcerer),S=Object(r.useMemo)((()=>c.d.getSourcererDataViewsSelector()),[]),{defaultDataView:k,signalIndexName:w}=Object(p.a)((e=>S(e))),{addError:E,addWarning:_}=Object(g.a)();Object(r.useEffect)((()=>{null!=k.error&&_({title:a.i18n.translate("xpack.securitySolution.sourcerer.permissions.title",{defaultMessage:"Write role required to generate data"}),text:a.i18n.translate("xpack.securitySolution.sourcerer.permissions.toastMessage",{defaultMessage:"Users with write permission need to access the Elastic Security app to initialize the app source data."})})}),[_,k.error]);const T=Object(r.useMemo)((()=>l.b.getTimelineByIdSelector()),[]),D=Object(p.a)((e=>T(e,f.c.active))),R=Object(r.useMemo)((()=>c.d.getSourcererScopeSelector()),[]),{sourcererScope:{selectedDataViewId:M,selectedPatterns:P,missingPatterns:N}}=Object(p.a)((t=>R(t,e))),{selectedDataView:A,sourcererScope:{selectedDataViewId:C,selectedPatterns:U,missingPatterns:F}}=Object(p.a)((e=>R(e,s.SourcererScopeName.timeline))),{indexFieldsSearch:q}=Object(v.b)(),V=Object(r.useCallback)((n=>{null!=n?Object.keys(n).forEach((r=>{var i,a,o,u;r===s.SourcererScopeName.default&&e===s.SourcererScopeName.detections||t(c.a.setSelectedDataView({id:r,selectedDataViewId:null!==(i=null===(a=n[r])||void 0===a?void 0:a.id)&&void 0!==i?i:null,selectedPatterns:null!==(o=null===(u=n[r])||void 0===u?void 0:u.selectedPatterns)&&void 0!==o?o:[]}))})):M&&I({[s.SourcererScopeName.default]:{id:M,selectedPatterns:P}})}),[t,M,e,P,I]);Object(x.b)(O.a.sourcerer,V);const L=Object(r.useRef)([]);Object(r.useEffect)((()=>{[...new Set([M,C])].forEach(((e,t)=>{if(null!=e&&e.length>0&&!L.current.includes(e)){L.current=[...L.current,e];const n=0===t?s.SourcererScopeName.default:s.SourcererScopeName.timeline,r=e===M?0===P.length&&0===N.length:C===e&&0===F.length&&0===(null==A?void 0:A.patternList.length);q({dataViewId:e,scopeId:n,needToBeInit:r,...r&&n===s.SourcererScopeName.timeline?{skipScopeUpdate:U.length>0}:{}})}}))}),[q,N.length,M,P.length,C,F.length,A,U.length]),Object(r.useEffect)((()=>{!h&&null!=j&&null==w&&(null==D||null==D.savedObjectId)&&o.current&&k.id.length>0?(o.current=!1,t(c.a.setSelectedDataView({id:s.SourcererScopeName.timeline,selectedDataViewId:k.id,selectedPatterns:Object(b.b)(k,s.SourcererScopeName.timeline,j,!0)}))):null!=w&&(null==D||null==D.savedObjectId)&&o.current&&k.id.length>0&&(o.current=!1,t(c.a.setSelectedDataView({id:s.SourcererScopeName.timeline,selectedDataViewId:k.id,selectedPatterns:Object(b.b)(k,s.SourcererScopeName.timeline,w,!0)})))}),[D,k,t,h,j,w]);const Q=Object(r.useCallback)((e=>{-1===k.title.indexOf(e)&&(n.current.abort(),(async r=>{n.current=new AbortController,t(c.a.setSourcererScopeLoading({loading:!0}));try{const i=await Object(m.b)({body:{patternList:r},signal:n.current.signal});i.defaultDataView.patternList.includes(e)&&q({dataViewId:i.defaultDataView.id}),t(c.a.setSourcererDataViews(i)),t(c.a.setSourcererScopeLoading({loading:!1}))}catch(e){E(e,{title:a.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:a.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})}),t(c.a.setSourcererScopeLoading({loading:!1}))}})([...k.title.split(","),e]))}),[k.title,t,q,E]),K=Object(r.useCallback)((()=>{!h&&null!=j&&null==w&&k.id.length>0&&(Q(j),t(c.a.setSignalIndexName({signalIndexName:j})))}),[k.id.length,t,h,j,w,Q]);Object(r.useEffect)((()=>{K()}),[j]),Object(r.useEffect)((()=>{e===s.SourcererScopeName.detections&&y&&null!=j&&d.current&&k.id.length>0?(d.current=!1,t(c.a.setSelectedDataView({id:s.SourcererScopeName.detections,selectedDataViewId:k.id,selectedPatterns:Object(b.b)(k,s.SourcererScopeName.detections,j,!0)}))):e===s.SourcererScopeName.detections&&null!=w&&o.current&&k.id.length>0&&(d.current=!1,c.a.setSelectedDataView({id:s.SourcererScopeName.detections,selectedDataViewId:k.id,selectedPatterns:Object(b.b)(k,s.SourcererScopeName.detections,w,!0)}))}),[k,t,y,e,j,w])},I=(e=s.SourcererScopeName.default)=>{const{getDataViewsSelector:t,getSourcererDataViewSelector:n,getScopeSelector:i}=Object(r.useMemo)((()=>({getDataViewsSelector:c.d.getSourcererDataViewsSelector(),getSourcererDataViewSelector:c.d.sourcererDataViewSelector(),getScopeSelector:c.d.scopeIdSelector()})),[]),{signalIndexName:a,selectedDataView:o,sourcererScope:{missingPatterns:u,selectedPatterns:l,loading:d}}=Object(p.a)((r=>{const a=i(r,e);return{...t(r),selectedDataView:n(r,a.selectedDataViewId),sourcererScope:a}})),f=Object(r.useMemo)((()=>Object(y.b)(l)),[l]),[g,m]=Object(r.useState)([]),[v,x]=Object(h.b)(g),O=Object(r.useMemo)((()=>{var e;return{...x,runtimeMappings:{},title:"",id:null!==(e=null==o?void 0:o.id)&&void 0!==e?e:null,loading:v,patternList:x.indexes,indexFields:x.indexPatterns.fields}}),[x,v,o]);Object(r.useEffect)((()=>{null==o||u.length>0?m(f):m([])}),[u,o,f]);const j=Object(r.useMemo)((()=>null==o||u.length>0?O:o),[O,u.length,o]),I=Object(r.useMemo)((()=>!(!d&&!j.loading)||Object(b.a)({scopeId:e,signalIndexName:a,patternList:j.patternList})),[d,e,a,j.loading,j.patternList]);return Object(r.useMemo)((()=>({browserFields:j.browserFields,dataViewId:j.id,indexPattern:{fields:j.indexFields,title:f.join(",")},indicesExist:I,loading:d||j.loading,runtimeMappings:j.runtimeMappings,patternList:j.title.split(","),selectedPatterns:f,...g.length>0?{activePatterns:j.patternList}:{}})),[j,f,I,d,g.length])},S=[d.c,`${d.mc}/id/:id`,`${d.F}/:detailName`],k=e=>null==Object(o.matchPath)(e,{path:S,strict:!1})?s.SourcererScopeName.default:s.SourcererScopeName.detections,w=[d.c,`${d.mc}/id/:id`,d.Jb,d.Fc,d.Sb,d.Yb],E=e=>null!=Object(o.matchPath)(e,{path:w,strict:!1})},220:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c}));var r=n(93),i=n(82),a=n(635);n.d(t,"e",(function(){return r.f})),n.d(t,"g",(function(){return r.h})),n.d(t,"f",(function(){return r.g})),n.d(t,"k",(function(){return r.l})),n.d(t,"j",(function(){return r.k})),n.d(t,"n",(function(){return r.p})),n.d(t,"m",(function(){return r.o})),n.d(t,"l",(function(){return r.m})),n.d(t,"h",(function(){return r.i})),n.d(t,"o",(function(){return r.u})),n.d(t,"p",(function(){return r.v})),n.d(t,"i",(function(){return r.j})),n.d(t,"a",(function(){return r.b})),n.d(t,"b",(function(){return r.e}));const o=({activeTimelineDataProviders:e,dataProviders:t,dispatch:n,result:o,timelineId:c,noProviderFound:s=i.a.noProviderFound,onAddedToTimeline:u})=>{const l=Object(r.n)(o),d=t[l];d?Object(a.b)({dataProviders:e,destination:o.destination,dispatch:n,onAddedToTimeline:u,providerToAdd:d,timelineId:c}):n(s({id:l}))},c=({isAggregatable:e,fieldType:t,fieldName:n,hideTopN:r})=>{const i=["boolean","geo-point","geo-shape","ip","keyword","number","numeric","string"].includes(t),a=["kibana.alert.ancestors.depth","kibana.alert.ancestors.id","kibana.alert.ancestors.rule","kibana.alert.ancestors.type","kibana.alert.original_event.action","kibana.alert.original_event.category","kibana.alert.original_event.code","kibana.alert.original_event.created","kibana.alert.original_event.dataset","kibana.alert.original_event.duration","kibana.alert.original_event.end","kibana.alert.original_event.hash","kibana.alert.original_event.id","kibana.alert.original_event.kind","kibana.alert.original_event.module","kibana.alert.original_event.original","kibana.alert.original_event.outcome","kibana.alert.original_event.provider","kibana.alert.original_event.risk_score","kibana.alert.original_event.risk_score_norm","kibana.alert.original_event.sequence","kibana.alert.original_event.severity","kibana.alert.original_event.start","kibana.alert.original_event.timezone","kibana.alert.original_event.type","kibana.alert.original_time","kibana.alert.rule.created_by","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.false_positives","kibana.alert.rule.from","kibana.alert.rule.uuid","kibana.alert.rule.immutable","kibana.alert.rule.interval","kibana.alert.rule.max_signals","kibana.alert.rule.name","kibana.alert.rule.note","kibana.alert.rule.references","kibana.alert.risk_score","kibana.alert.rule.rule_id","kibana.alert.severity","kibana.alert.rule.size","kibana.alert.rule.tags","kibana.alert.rule.threat","kibana.alert.rule.threat.tactic.id","kibana.alert.rule.threat.tactic.name","kibana.alert.rule.threat.tactic.reference","kibana.alert.rule.threat.technique.id","kibana.alert.rule.threat.technique.name","kibana.alert.rule.threat.technique.reference","kibana.alert.rule.timeline_id","kibana.alert.rule.timeline_title","kibana.alert.rule.to","kibana.alert.rule.type","kibana.alert.rule.updated_by","kibana.alert.rule.version","kibana.alert.workflow_status"].includes(n);return!r&&(a||e&&i)}},224:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),i=n(996);const a=()=>Object(r.useContext)(i.a)},239:function(e,t,n){"use strict";var r=n(15);n.d(t,"a",(function(){return r.b})),n.d(t,"b",(function(){return r.d})),n.d(t,"c",(function(){return r.i})),n.d(t,"d",(function(){return r.k})),n.d(t,"e",(function(){return r.l})),n.d(t,"f",(function(){return r.m}))},258:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),i=n(19);const a={managed:!0},o=()=>{const{services:{apm:e}}=Object(i.k)();return{startTransaction:Object(r.useCallback)((({name:t,type:n="user-interaction",options:r})=>e.startTransaction(t,n,null!=r?r:a)),[e])}}},261:function(e,t,n){"use strict";n.d(t,"g",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return p})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return g})),n.d(t,"j",(function(){return m})),n.d(t,"d",(function(){return v})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return x}));var r=n(5),i=n(14),a=n(8);const o=e=>e.policy,c=e=>e.timerange,s=e=>e.queries,u=(e,t)=>{const n=e.inputs[t];return Object(r.isEmpty)(n.linkTo)?n.queries:n.linkTo.reduce(((t,n)=>{if(n===a.a.socTrends)return t;const r=e.inputs[n];return[...t,...r.queries]}),n.queries)},l=()=>Object(i.createSelector)(o,(e=>e.kind)),d=()=>Object(i.createSelector)(o,(e=>e.duration)),f=()=>Object(i.createSelector)(c,(e=>e.kind)),p=()=>Object(i.createSelector)(c,(e=>e.from)),b=()=>Object(i.createSelector)(c,(e=>e.to)),g=()=>Object(i.createSelector)(c,(e=>e.fromStr)),m=()=>Object(i.createSelector)(c,(e=>e.toStr)),v=()=>Object(i.createSelector)(s,(e=>e.some((e=>!0===e.loading)))),h=()=>Object(i.createSelector)(u,(e=>e.filter((e=>"kql"!==e.id)))),x=()=>Object(i.createSelector)(s,(e=>e.find((e=>"kql"===e.id))))},277:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return p}));var r=n(3),i=n(4),a=n.n(i),o=n(344),c=n(345);const s={canUserCRUD:null,canUserREAD:null,hasIndexManage:null,hasIndexMaintenance:null,hasIndexWrite:null,hasIndexRead:null,hasIndexUpdateDelete:null,isSignalIndexExists:null,isAuthenticated:null,hasEncryptionKey:null,loading:!0,signalIndexName:null,signalIndexMappingOutdated:null},u=(e,t)=>{switch(t.type){case"updateLoading":return{...e,loading:t.loading};case"updateHasIndexManage":return{...e,hasIndexManage:t.hasIndexManage};case"updateHasIndexMaintenance":return{...e,hasIndexMaintenance:t.hasIndexMaintenance};case"updateHasIndexWrite":return{...e,hasIndexWrite:t.hasIndexWrite};case"updateHasIndexRead":return{...e,hasIndexRead:t.hasIndexRead};case"updateHasIndexUpdateDelete":return{...e,hasIndexUpdateDelete:t.hasIndexUpdateDelete};case"updateIsSignalIndexExists":return{...e,isSignalIndexExists:t.isSignalIndexExists};case"updateIsAuthenticated":return{...e,isAuthenticated:t.isAuthenticated};case"updateHasEncryptionKey":return{...e,hasEncryptionKey:t.hasEncryptionKey};case"updateSignalIndexName":return{...e,signalIndexName:t.signalIndexName};case"updateSignalIndexMappingOutdated":return{...e,signalIndexMappingOutdated:t.signalIndexMappingOutdated};case"updateCanUserCRUD":return{...e,canUserCRUD:t.canUserCRUD};case"updateCanUserREAD":return{...e,canUserREAD:t.canUserREAD};default:return e}},l=Object(i.createContext)([s,()=>r.noop]),d=()=>Object(i.useContext)(l),f=({children:e})=>a.a.createElement(l.Provider,{value:Object(i.useReducer)(u,s)},e),p=()=>{const[{canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:r,hasIndexWrite:a,hasIndexRead:s,hasIndexUpdateDelete:u,isSignalIndexExists:l,isAuthenticated:f,hasEncryptionKey:p,loading:b,signalIndexName:g,signalIndexMappingOutdated:m},v]=d(),{loading:h,isAuthenticated:x,hasEncryptionKey:O,hasIndexManage:y,hasIndexMaintenance:j,hasIndexUpdateDelete:I,hasIndexWrite:S,hasIndexRead:k,hasKibanaCRUD:w,hasKibanaREAD:E}=Object(o.a)(),{loading:_,signalIndexExists:T,signalIndexName:D,signalIndexMappingOutdated:R,createDeSignalIndex:M}=Object(c.a)();return Object(i.useEffect)((()=>{b||e===w||v({type:"updateCanUserCRUD",canUserCRUD:w})}),[v,b,e,w]),Object(i.useEffect)((()=>{b||t===E||v({type:"updateCanUserREAD",canUserREAD:E})}),[v,b,t,E]),Object(i.useEffect)((()=>{b!==(h||_)&&v({type:"updateLoading",loading:h||_})}),[v,b,h,_]),Object(i.useEffect)((()=>{b||n===y||null==y||v({type:"updateHasIndexManage",hasIndexManage:y})}),[v,b,n,y]),Object(i.useEffect)((()=>{b||a===S||null==S||v({type:"updateHasIndexWrite",hasIndexWrite:S})}),[v,b,a,S]),Object(i.useEffect)((()=>{b||s===k||null==k||v({type:"updateHasIndexRead",hasIndexRead:k})}),[v,b,s,k]),Object(i.useEffect)((()=>{b||u===I||null==I||v({type:"updateHasIndexUpdateDelete",hasIndexUpdateDelete:I})}),[v,b,u,I]),Object(i.useEffect)((()=>{b||r===j||null==j||v({type:"updateHasIndexMaintenance",hasIndexMaintenance:j})}),[v,b,r,j]),Object(i.useEffect)((()=>{b||l===T||null==T||v({type:"updateIsSignalIndexExists",isSignalIndexExists:T})}),[v,b,l,T]),Object(i.useEffect)((()=>{b||f===x||null==x||v({type:"updateIsAuthenticated",isAuthenticated:x})}),[v,b,f,x]),Object(i.useEffect)((()=>{b||p===O||null==O||v({type:"updateHasEncryptionKey",hasEncryptionKey:O})}),[v,b,p,O]),Object(i.useEffect)((()=>{b||g===D||null==D||v({type:"updateSignalIndexName",signalIndexName:D})}),[v,b,g,D]),Object(i.useEffect)((()=>{b||m===R||null==R||v({type:"updateSignalIndexMappingOutdated",signalIndexMappingOutdated:R})}),[v,b,m,R]),Object(i.useEffect)((()=>{f&&p&&n&&(null!=l&&!l||null!=m&&m)&&null!=M&&M()}),[M,f,p,l,n,m]),{loading:b,isSignalIndexExists:l,isAuthenticated:f,hasEncryptionKey:p,canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:r,hasIndexWrite:a,hasIndexRead:s,hasIndexUpdateDelete:u,signalIndexName:g,signalIndexMappingOutdated:m}}},302:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"e",(function(){return k})),n.d(t,"d",(function(){return w})),n.d(t,"f",(function(){return E})),n.d(t,"g",(function(){return T})),n.d(t,"c",(function(){return Q})),n.d(t,"h",(function(){return K})),n.d(t,"b",(function(){return W}));var r=n(709),i=n(3),a=n(50),o=n.n(a),c=n(385),s=n.n(c),u=n(8),l=n(15),d=n(28),f=n(23),p=n(7),b=n(94),g=n(80),m=n(36),v=n(719),h=n(35),x=n(71),O=n(33),y=n(13),j=n(42),I=n(59);const S="open-timeline",k=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,w=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,n)=>t+e[n].length),0):0)+(null!=t?t.length:0),E=({title:e})=>null==e||0===e.trim().length,_=(e,t)=>"__typename"===e?void 0:t,T=e=>JSON.parse(JSON.stringify(e),_),D=e=>{try{return JSON.parse(e)}catch{return e}},R=e=>Object.entries(e).reduce(((e,[t,n])=>"id"!==t&&null!=n?{...e,[t]:n}:e),{columnHeaderType:g.a,id:null!=e.id?e.id:"unknown",initialWidth:"@timestamp"===e.id?m.b:m.a}),M=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:D(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:D(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:D(e.meta.value)}:{}},...null!=e.exists?{exists:D(e.exists)}:{},...null!=e.match_all?{exists:D(e.match_all)}:{},...null!=e.missing?{exists:D(e.missing)}:{},...null!=e.query?{query:D(e.query)}:{},...null!=e.range?{range:D(e.range)}:{},...null!=e.script?{exists:D(e.script)}:{}}),P=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(i.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):{},N=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},A=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},C=(e,t,n)=>n===l.m.default&&e.timelineType===l.m.template?e.templateTimelineId:t&&e.timelineType===l.m.template?o.a.v4():e.templateTimelineId,U=({and:e,...t})=>t.type===l.a.template?s()(t,{type:l.a.default,enabled:t.queryMatch.operator!==h.c,queryMatch:{value:t.queryMatch.operator===h.c?"":t.queryMatch.value}}):t,F=(e,t,n)=>e&&t&&n===l.m.default?t.map((e=>{var t,n;return{...U(e),and:null!==(t=null===(n=e.and)||void 0===n?void 0:n.map(U))&&void 0!==t?t:[]}})):t,q=(e,t,n)=>n&&e.timelineType!==n?"":t?`${e.title} - Duplicate`:e.title||"",V=(e,t,n)=>n&&e.timelineType!==n?l.k.draft:t?l.k.active:e.status,L=(e,t,n)=>{const i=e.timelineType===l.m.template,a={...e,columns:null!=e.columns?e.columns.map(R):g.b,defaultColumns:g.b,dateRange:e.status===l.k.immutable&&e.timelineType===l.m.template?{start:j.a.toISOString(),end:j.b.toISOString()}:e.dateRange,dataProviders:F(t,e.dataProviders,n),eventIdToNoteIds:P(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(M):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:A(t,e.pinnedEventIds),pinnedEventsSaveObject:N(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:V(e,t,n),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=n?n:e.timelineType,title:q(e,t,n),templateTimelineId:C(e,t,n),templateTimelineVersion:t&&i?1:e.templateTimelineVersion};return Object.entries(a).reduce(((e,[t,n])=>null!=n?Object(r.set)(t,n,e):e),{...b.a,id:""})},Q=(e,t=!1,n)=>{const{notes:r,...i}=e;return{notes:r,timeline:L(i,t,n)}},K=({activeTimelineTab:e=l.l.query,duplicate:t=!1,graphEventId:n="",timelineId:r,timelineType:a,onError:o,onOpenTimeline:c,openTimeline:s=!0,updateIsLoading:u,updateTimeline:d})=>{u({id:l.i.active,isLoading:!0}),Promise.resolve(Object(I.i)(r)).then((r=>{const o=Object(i.getOr)(null,"data",r);if(!o)return;const u=T(o.timeline),{timeline:f,notes:p}=Q(u,t,a);if(null!=c)c(f);else if(d){const{from:r,to:a}=Object(x.a)({from:Object(i.getOr)(null,"dateRange.start",f),to:Object(i.getOr)(null,"dateRange.end",f)});d({duplicate:t,from:r,id:l.i.active,notes:p,resolveTimelineConfig:{outcome:o.outcome,alias_target_id:o.alias_target_id,alias_purpose:o.alias_purpose},timeline:{...f,activeTab:e,graphEventId:n,show:s,dateRange:{start:r,end:a}},to:a})()}})).catch((e=>{null!=o&&o(e,r)})).finally((()=>{u({id:l.i.active,isLoading:!1})}))},W=e=>({duplicate:t,id:n,forceNotes:r=!1,from:a,notes:o,resolveTimelineConfig:c,timeline:s,to:b,ruleNote:g})=>()=>{var m;if(Object(i.isEmpty)(s.indexNames)||e(O.a.setSelectedDataView({id:y.SourcererScopeName.timeline,selectedDataViewId:s.dataViewId,selectedPatterns:s.indexNames})),s.status===l.k.immutable&&s.timelineType===l.m.template?e(Object(f.setRelativeRangeDatePicker)({id:u.a.timeline,fromStr:"now-24h",toStr:"now",from:j.a.toISOString(),to:j.b.toISOString()})):e(Object(f.setTimelineRangeDatePicker)({from:a,to:b})),e(Object(p.addTimeline)({id:n,timeline:s,resolveTimelineConfig:c,savedTimeline:t})),null!=s.kqlQuery&&null!=s.kqlQuery.filterQuery&&null!=s.kqlQuery.filterQuery.kuery&&""!==s.kqlQuery.filterQuery.kuery.expression&&e(Object(p.applyKqlFilterQuery)({id:n,filterQuery:{kuery:{kind:null!==(m=s.kqlQuery.filterQuery.kuery.kind)&&void 0!==m?m:"kuery",expression:s.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:s.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=g&&!Object(i.isEmpty)(g)){const t=Object(v.a)({newNote:g});e(Object(d.updateNote)({note:t})),e(Object(p.addNote)({noteId:t.id,id:n}))}t&&!r||e(Object(d.addNotes)({notes:null!=o?o.map((e=>{var t,n;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(n=e.timelineId)&&void 0!==n?n:null}})):[]}))}},316:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return x}));var r=n(3),i=n(68),a=n.n(i),o=n(4),c=n(146),s=n.n(c),u=n(20),l=n(177),d=n(19),f=n(920),p=n(202),b=n(461);const g=e=>Object(r.keyBy)("name",function(e){const t=[];for(const n of Object.values(e))n.fields&&t.push(...Object.values(n.fields));return t}(e)),m=a()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(r.pick)(["name","searchable","type","aggregatable","esTypes","subType"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),v=(a()(((e,t)=>t.reduce(((e,t)=>(null==e[t.category]&&(e[t.category]={}),null==e[t.category].fields&&(e[t.category].fields={}),e[t.category].fields[t.name]=t,e)),{})),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),{}),h={fields:[],title:""},x=(e,t=!1)=>{const{data:n}=Object(d.k)().services,i=Object(o.useRef)(new AbortController),a=Object(o.useRef)(new u.Subscription),c=Object(o.useRef)([]),[g,x]=Object(o.useState)(!1),[O,y]=Object(o.useState)({browserFields:v,indexes:e,indexExists:!0,indexPatterns:h}),{addError:j,addWarning:I}=Object(p.a)(),S=Object(o.useCallback)((e=>{a.current.unsubscribe(),i.current.abort(),(async()=>{i.current=new AbortController,x(!0),a.current=n.search.search({indices:e,onlyCheckIfIndicesExist:t},{abortSignal:i.current.signal,strategy:"indexFields"}).subscribe({next:e=>{Object(l.isCompleteResponse)(e)?Promise.resolve().then((()=>{s.a.unstable_batchedUpdates((()=>{const t=e.indicesExist.sort().join();c.current=e.indicesExist;const{browserFields:n}=Object(b.a)(t,e.indexFields);x(!1),y({browserFields:n,indexes:e.indicesExist,indexExists:e.indicesExist.length>0,indexPatterns:m(t,e.indexFields)}),a.current.unsubscribe()}))})):Object(l.isErrorResponse)(e)&&(x(!1),I(f.a),a.current.unsubscribe())},error:e=>{x(!1),j(e,{title:f.b}),a.current.unsubscribe()}})})()}),[n.search,j,I,t,x,y]);return Object(o.useEffect)((()=>(Object(r.isEmpty)(e)||Object(r.isEqual)(c.current,e)||S(e),()=>{a.current.unsubscribe(),i.current.abort()})),[e,S,c]),[g,O]}},320:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return f}));var r=n(3),i=n(4),a=n(1162),o=n.n(a),c=n(181),s=n(69),u=n.n(s);const l=(e,t)=>{const n=null!=t?t:((e,t)=>{const n=t.diff(e,"days");return n<=1&&!e.isSame(t)?2:n})(u()(e[0]),u()(e[1])),r=Object(c.niceTimeFormatByDay)(n);return Object(c.timeFormatter)(r)},d=(e=100)=>{const[t,n]=Object(i.useState)({width:0,height:0}),a=Object(i.useMemo)((()=>Object(r.throttle)(e,n)),[e]),{ref:c}=o()({onResize:a});return{ref:c,...t}},f=(e,t,n,r)=>{Object(i.useEffect)((()=>{!async function(){const i=await(null==e?void 0:e.getVariation(t,n));i&&r(i)}()}),[e,t,n,r])}},344:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),i=n(235);const a=()=>{const[e,t]=Object(r.useState)({isAuthenticated:null,hasEncryptionKey:null,hasIndexManage:null,hasIndexRead:null,hasIndexWrite:null,hasIndexUpdateDelete:null,hasIndexMaintenance:null,hasKibanaCRUD:!1,hasKibanaREAD:!1}),{detectionEnginePrivileges:n,kibanaSecuritySolutionsPrivileges:{crud:a,read:o}}=Object(i.a)();return Object(r.useEffect)((()=>{null!=n.error&&t({isAuthenticated:!1,hasEncryptionKey:!1,hasIndexManage:!1,hasIndexRead:!1,hasIndexWrite:!1,hasIndexUpdateDelete:!1,hasIndexMaintenance:!1,hasKibanaCRUD:a,hasKibanaREAD:o})}),[n.error,a,o]),Object(r.useEffect)((()=>{if(null!=n.result){const e=n.result;if(null!=e.index&&Object.keys(e.index).length>0){const n=Object.keys(e.index)[0];t({isAuthenticated:e.is_authenticated,hasEncryptionKey:e.has_encryption_key,hasIndexManage:e.index[n].manage&&e.cluster.manage,hasIndexMaintenance:e.index[n].maintenance,hasIndexRead:e.index[n].read,hasIndexWrite:e.index[n].create||e.index[n].create_doc||e.index[n].index||e.index[n].write,hasIndexUpdateDelete:e.index[n].write,hasKibanaCRUD:a,hasKibanaREAD:o})}}}),[n.result,a,o]),{loading:n.loading,...e}}},345:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(4),i=n(93),a=n(202),o=n(367),c=n(542),s=n(344);const u=()=>{const[e,t]=Object(r.useState)(!0),[n,u]=Object(r.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:null}),{addError:l}=Object(a.a)(),{hasIndexRead:d}=Object(s.a)();return Object(r.useEffect)((()=>{let e=!0;const n=new AbortController,r=async()=>{try{t(!0);const r=await Object(o.h)({signal:n.signal});e&&null!=r&&u({signalIndexExists:!0,signalIndexName:r.name,signalIndexMappingOutdated:r.index_mapping_outdated,createDeSignalIndex:a})}catch(t){e&&(u({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:a}),Object(i.t)(t)&&404!==t.body.status_code&&l(t,{title:c.c}))}e&&t(!1)},a=async()=>{let s=!1;try{t(!0),await Object(o.d)({signal:n.signal}),e&&(s=!0,r())}catch(t){e&&(Object(i.t)(t)&&409===t.body.status_code?r():(u({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:a}),l(t,{title:c.d})))}e&&!s&&t(!1)};return d?r():t(!1),()=>{e=!1,n.abort()}}),[l,d]),{loading:e,...n}}},351:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>e.isPlatinumOrTrialLicense},385:function(e,t,n){"use strict";var r=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function a(e,t){return!1!==t.clone&&t.isMergeableObject(e)?u((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return a(e,n)}))}function c(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function s(e,t){try{return t in e}catch(e){return!1}}function u(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||o,n.isMergeableObject=n.isMergeableObject||r,n.cloneUnlessOtherwiseSpecified=a;var i=Array.isArray(t);return i===Array.isArray(e)?i?n.arrayMerge(e,t,n):function(e,t,n){var r={};return n.isMergeableObject(e)&&c(e).forEach((function(t){r[t]=a(e[t],n)})),c(t).forEach((function(i){(function(e,t){return s(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(s(e,i)&&n.isMergeableObject(t[i])?r[i]=function(e,t){if(!t.customMerge)return u;var n=t.customMerge(e);return"function"==typeof n?n:u}(i,n)(e[i],t[i],n):r[i]=a(t[i],n))})),r}(e,t,n):a(t,n)}u.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return u(e,n,t)}),{})};var l=u;e.exports=l},421:function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return k}));var r=n(315),i=n(47),a=n(4),o=n(8),c=n(19),s=n(78),u=n(29),l=n(3),d=n(238),f=n(71),p=n(433);var b=n(462),g=n.n(b),m=n(506),v=n(293);var h=n(302),x=n(91),O=n(239),y=n(76),j=n(62);const I=({search:e,urlKey:t})=>Object(m.c)(Object(m.d)(e),t),S=()=>{Object(r.c)(),(()=>{const e=Object(i.useDispatch)(),{filterManager:t,savedQueries:n}=Object(c.k)().services.data.query,l=Object(a.useMemo)((()=>s.f.globalFiltersQuerySelector()),[]),d=Object(i.useSelector)(l),f=Object(a.useCallback)((t=>{null!=t&&e(u.b.setFilterQuery({id:o.a.global,query:t.query,language:t.language}))}),[e]),p=Object(a.useCallback)((n=>{null!=n?(t.setFilters(n),e(u.b.setSearchBarFilter({id:o.a.global,filters:n}))):(t.setAppFilters(d),e(u.b.setSearchBarFilter({id:o.a.global,filters:t.getFilters()})))}),[t,e,d]),b=Object(a.useCallback)((r=>{null!=r&&""!==r&&n.getSavedQuery(r).then((n=>{const r=n.attributes.filters||[],i=n.attributes.query;t.setFilters(r),e(u.b.setSearchBarFilter({id:o.a.global,filters:r})),e(u.b.setFilterQuery({id:o.a.global,...i})),e(u.b.setSavedQuery({id:o.a.global,savedQuery:n}))}))}),[e,t,n]);Object(r.b)(k.appQuery,f),Object(r.b)(k.filters,p),Object(r.b)(k.savedQuery,b)})(),(()=>{const e=Object(i.useDispatch)(),t=Object(d.a)("socTrendsEnabled"),n=Object(a.useCallback)((n=>((e,t,n)=>{if(null!=e){const r={linkTo:Object(l.get)("global.linkTo",e)},i=Object(l.get)("global.timerange.kind",e),a={linkTo:Object(l.get)("timeline.linkTo",e)},c=Object(l.get)("timeline.timerange.kind",e),s={linkTo:Object(l.get)("socTrends.linkTo",e)},d=Object(l.get)("socTrends.timerange.kind",e);if(n&&(Object(l.isEmpty)(s.linkTo)?t(u.b.removeLinkTo([o.a.global,o.a.socTrends])):t(u.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(l.isEmpty)(r.linkTo)?(t(u.b.removeLinkTo([o.a.global,o.a.timeline])),n&&t(u.b.removeLinkTo([o.a.global,o.a.socTrends]))):(t(u.b.addLinkTo([o.a.global,o.a.timeline])),n&&t(u.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(l.isEmpty)(a.linkTo)?t(u.b.removeLinkTo([o.a.global,o.a.timeline])):t(u.b.addLinkTo([o.a.global,o.a.timeline])),c){if("absolute"===c){const n=Object(f.a)(Object(l.get)("timeline.timerange",e));t(u.b.setAbsoluteRangeDatePicker({...n,id:o.a.timeline}))}if("relative"===c){const n=Object(f.a)(Object(l.get)("timeline.timerange",e));n.from=Object(p.c)(n.fromStr),n.to=Object(p.c)(n.toStr,{roundUp:!0}),t(u.b.setRelativeRangeDatePicker({...n,id:o.a.timeline}))}}if(i){if("absolute"===i){const n=Object(f.a)(Object(l.get)("global.timerange",e));t(u.b.setAbsoluteRangeDatePicker({...n,id:o.a.global}))}if("relative"===i){const n=Object(f.a)(Object(l.get)("global.timerange",e));n.from=Object(p.c)(n.fromStr),n.to=Object(p.c)(n.toStr,{roundUp:!0}),t(u.b.setRelativeRangeDatePicker({...n,id:o.a.global}))}}if(n&&d){if("absolute"===d){const n=Object(f.a)(Object(l.get)("socTrends.timerange",e));t(u.b.setAbsoluteRangeDatePicker({...n,id:o.a.socTrends}))}if("relative"===d){const n=Object(f.a)(Object(l.get)("socTrends.timerange",e));n.from=Object(p.c)(n.fromStr),n.to=Object(p.c)(n.toStr,{roundUp:!0}),t(u.b.setRelativeRangeDatePicker({...n,id:o.a.socTrends}))}}}})(n,e,t)),[e,t]);Object(r.b)(k.timerange,n)})(),(()=>{const[{pageName:e}]=Object(v.a)(),t=Object(i.useDispatch)(),n=g()(e),r=Object(a.useMemo)((()=>s.f.inputsSelector()),[]),c=Object(i.useSelector)(r),{timerange:l}=c.global,{timerange:d}=c.timeline;Object(a.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(m.e)(e))(e,n)&&("relative"===d.kind&&t(u.b.setRelativeRangeDatePicker({...d,from:Object(p.c)(d.fromStr),to:Object(p.c)(d.toStr,{roundUp:!0}),id:o.a.timeline})),"relative"===l.kind&&t(u.b.setRelativeRangeDatePicker({...l,from:Object(p.c)(l.fromStr),to:Object(p.c)(l.toStr,{roundUp:!0}),id:o.a.global})))}),[e,n,t,d,l])})(),(()=>{const e=Object(i.useDispatch)(),t=Object(a.useCallback)((t=>{null!=t&&""!==t.id&&Object(h.h)({activeTimelineTab:t.activeTab,duplicate:!1,graphEventId:t.graphEventId,timelineId:t.id,openTimeline:t.isOpen,updateIsLoading:t=>e(x.a.updateIsLoading(t)),updateTimeline:Object(h.b)(e)})}),[e]);Object(r.b)(k.timeline,t)})(),(()=>{const e=Object(r.d)(k.timeline),t=Object(a.useMemo)((()=>x.b.getTimelineByIdSelector()),[]),{activeTab:n,graphEventId:i,show:o,savedObjectId:c}=Object(y.b)((e=>{var n;return null!==(n=t(e,O.c.active))&&void 0!==n?n:{}}));Object(a.useEffect)((()=>{e(null!=c?{id:c,isOpen:o,activeTab:n,graphEventId:null!=i?i:""}:null)}),[n,i,c,o,e])})(),(()=>{var e;const t=Object(a.useMemo)((()=>x.b.getTimelineByIdSelector()),[]),n=Object(y.b)((e=>t(e,O.c.active))),{search:r}=Object(j.useLocation)(),o=g()(r),c=null!==(e=null==n?void 0:n.savedObjectId)&&void 0!==e?e:"",s=Object(i.useDispatch)(),[u,l]=Object(a.useMemo)((()=>{const e=I({urlKey:k.timeline,search:null!=o?o:""}),t=I({urlKey:k.timeline,search:r});if(null!=e&&null!=t){let n=null,r=null;try{n=Object(m.a)(t)}catch(e){}try{r=Object(m.a)(e)}catch(e){}return[r,n]}return[null,null]}),[o,r]),d=null==u?void 0:u.id,{id:f,activeTab:p,graphEventId:b}=l||{};Object(a.useEffect)((()=>{f&&f!==d&&f!==c&&Object(h.h)({activeTimelineTab:null!=p?p:O.e.query,duplicate:!1,graphEventId:b,timelineId:f,openTimeline:!0,updateIsLoading:e=>s(x.a.updateIsLoading(e)),updateTimeline:Object(h.b)(s)})}),[c,s,d,f,p,b])})()};let k;!function(e){e.appQuery="query",e.filters="filters",e.savedQuery="savedQuery",e.sourcerer="sourcerer",e.timeline="timeline",e.timerange="timerange"}(k||(k={}))},433:function(e,t,n){"use strict";n.d(t,"c",(function(){return O})),n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return j}));var r=n(102),i=n.n(r),a=n(17),o=n(3),c=n(4),s=n.n(c),u=n(47),l=n(92),d=n.n(l),f=n(43),p=n(1),b=n(91),g=n(19),m=n(82),v=n(8),h=n(261);const x=s.a.memo((({duration:e,end:t,fromStr:n,id:r,isLoading:i,kqlQuery:u,policy:l,queries:d,setDuration:f,showUpdateButton:b=!0,start:m,startAutoReload:v,stopAutoReload:h,timelineId:x,toStr:y,updateReduxTime:j,disabled:I,width:S="restricted",compressed:k=!1})=>{const[w,E]=Object(c.useState)([]),_=Object(c.useCallback)((({start:e,end:n})=>{const i=e.includes("now")||n.includes("now"),{kqlHaveBeenUpdated:a}=j({end:n,id:r,isInvalid:!1,isQuickSelection:i,kql:u,start:e,timelineId:x}),o=O(e),c=i?O(n,{roundUp:!0}):O(n);!d||a||i&&(m!==o||t!==c)||D(d)}),[t,r,u,d,m,x,j]),T=Object(c.useCallback)((({isPaused:t,refreshInterval:i})=>{const a=null!=n&&n.includes("now")||null!=y&&y.includes("now");e!==i&&f({id:r,duration:i}),t&&"interval"===l?h({id:r}):t||"manual"!==l||v({id:r}),d&&!t&&(!a||a&&"now"!==y)&&D(d)}),[n,y,e,l,f,r,h,v,d]),D=e=>{e.forEach((e=>e.refetch&&e.refetch()))},R=Object(c.useCallback)((({start:e,end:t,isInvalid:n})=>{const i=e.includes("now")||t.includes("now");if(!n){j({end:t,id:r,isInvalid:n,isQuickSelection:i,kql:u,start:e,timelineId:x});const a=[{start:e,end:t},...Object(o.take)(9,w.filter((n=>!(n.start===e&&n.end===t))))];E(a)}}),[j,r,u,x,w]),M=null!=y?y:new Date(t).toISOString(),P=null!=n?n:new Date(m).toISOString(),[N]=Object(g.q)(p.fb),A=Object(o.isEmpty)(N)?[]:N.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n})));return s.a.createElement(a.EuiSuperDatePicker,{commonlyUsedRanges:A,end:M,isLoading:i,isPaused:"manual"===l,onRefresh:_,onRefreshChange:T,onTimeChange:R,recentlyUsedRanges:w,refreshInterval:e,showUpdateButton:b,start:P,isDisabled:I,width:S,compressed:k})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),O=(e,t)=>{const n=i.a.parse(e,t);return null!=n&&n.isValid()?n.toISOString():""},y=e=>({end:t,id:n,isQuickSelection:r,kql:i,start:a,timelineId:o})=>{const c=O(a);let s=O(t,{roundUp:!0});var u;return r?e(t===a?m.b.setAbsoluteRangeDatePicker({id:n,fromStr:a,toStr:t,from:c,to:s}):m.b.setRelativeRangeDatePicker({id:n,fromStr:a,toStr:t,from:c,to:s})):(s=O(t),e(m.b.setAbsoluteRangeDatePicker({id:n,from:O(a),to:O(t)}))),null!=o&&e(b.a.updateRange({id:o,start:c,end:s})),i&&i.refetch?{kqlHaveBeenUpdated:null!==(u=i.refetch(e))&&void 0!==u&&u}:{kqlHaveBeenUpdated:!1}};x.displayName="SuperDatePickerComponent";const j=Object(u.connect)((()=>{const e=Object(h.a)(),t=Object(h.b)(),n=Object(h.c)(),r=Object(h.d)(),i=Object(h.e)(),a=Object(h.f)(),c=Object(h.g)(),s=Object(h.h)(),u=Object(h.i)(),l=Object(h.j)();return(d,{id:p})=>{const b=Object(o.getOr)({},`inputs.${p}`,d);return{duration:e(b),end:t(b),fromStr:n(b),kind:i(b),policy:c(b),start:u(b),toStr:l(b),isLoading:!1,...Object(f.c)(b)&&(p===v.a.timeline||p===v.a.global)&&{isLoading:r(b),kqlQuery:a(b),queries:s(d,p)}}}}),(e=>({startAutoReload:({id:t})=>e(m.b.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(m.b.stopAutoReload({id:t})),setDuration:({id:t,duration:n})=>e(m.b.setDuration({id:t,duration:n})),updateReduxTime:y(e)})))(x)},461:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return x}));var r=n(4),i=n(47),a=n(68),o=n.n(a),c=n(3),s=n(34),u=n(177),l=n(19),d=n(202),f=n(33),p=n(920),b=n(13),g=n(508),m=n(543),v=n(1);const h=o()(((e,t)=>t.reduce(((e,t)=>(null==e.browserFields[t.category]&&(e.browserFields[t.category]={}),null==e.browserFields[t.category].fields&&(e.browserFields[t.category].fields={}),e.browserFields[t.category].fields[t.name]=t,e.indexFields.push(Object(c.pick)(["name","searchable","type","aggregatable","esTypes","subType"],t)),e)),{browserFields:{},indexFields:[]})),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),x=()=>{const{data:e}=Object(l.k)().services,t=Object(r.useRef)({}),n=Object(r.useRef)({}),a=Object(i.useDispatch)(),{addError:o,addWarning:x}=Object(d.a)(),{startTracking:O}=Object(m.a)(),y=Object(r.useCallback)((({id:e,loading:t})=>{a(f.a.setDataViewLoading({id:e,loading:t}))}),[a]),j=Object(r.useCallback)((({dataViewId:r,scopeId:i=b.SourcererScopeName.default,needToBeInit:l=!1,cleanCache:d=!1,skipScopeUpdate:m=!1})=>{const j=()=>{var e;null===(e=n.current[r])||void 0===e||e.unsubscribe(),n.current=Object(c.omit)(r,n.current),t.current=Object(c.omit)(r,t.current)};return n.current[r]&&n.current[r].unsubscribe(),t.current[r]&&t.current[r].abort(),(async()=>{t.current={...t.current,[r]:new AbortController},y({id:r,loading:!0});const{endTracking:c}=O({name:`${v.A} indexFieldsSearch`});if(l){const e=await Object(g.a)(r,t.current[r].signal);a(f.a.setDataView(e))}return new Promise((b=>{const g=e.search.search({dataViewId:r,onlyCheckIfIndicesExist:!1},{abortSignal:t.current[r].signal,strategy:"indexFields"}).subscribe({next:async e=>{if(Object(u.isCompleteResponse)(e)){c("success");const t=e.indicesExist.sort().join();l&&i&&!m&&a(f.a.setSelectedDataView({id:i,selectedDataViewId:r,selectedPatterns:e.indicesExist})),d&&h.clear();const n=h(t,e.indexFields);a(f.a.setDataView({...n,id:r,loading:!1,runtimeMappings:e.runtimeMappings}))}else Object(u.isErrorResponse)(e)&&(c("invalid"),y({id:r,loading:!1}),x(p.a));j(),b()},error:e=>{if(c("error"),e.message===s.DELETED_SECURITY_SOLUTION_DATA_VIEW)return location.reload();y({id:r,loading:!1}),o(e,{title:p.b}),j(),b()}});n.current={...n.current,[r]:g}}))})()}),[o,x,e.search,a,y,O]);return Object(r.useEffect)((()=>()=>{Object.values(n.current).forEach((e=>e.unsubscribe())),Object.values(t.current).forEach((e=>e.abort()))}),[]),{indexFieldsSearch:j}}},462:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);t.default=function(e){var t=r.useRef();return r.useEffect((function(){t.current=e})),t.current}},463:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"c",(function(){return d}));var r=n(6);const i=r.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),a=r.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),o=r.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),c=r.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),s=r.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),u=r.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),l=e=>r.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=r.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},508:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(19),i=n(1);const a=async({body:e,signal:t})=>r.b.get().http.fetch(i.tc,{method:"POST",body:JSON.stringify(e),signal:t}),o=async(e,t)=>r.b.get().http.fetch(i.tc,{method:"GET",query:{dataViewId:e},asSystemRequest:!0,signal:t})},514:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=n(6).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},543:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),i=n(258);const a=()=>{const{startTransaction:e}=Object(i.a)();return{startTracking:Object(r.useCallback)((({name:t,spanName:n="fetch"})=>{const r=e({name:t,type:"http-request",options:{managed:!1}}),i=null==r?void 0:r.startSpan(n,"http-request",{blocking:!0});return{endTracking:e=>{null==r||r.addLabels({result:e}),null==i||i.end()}}}),[e])}}},544:function(e,t,n){e.exports=n(25)(250)},545:function(e,t,n){e.exports=n(25)(1503)},632:function(e,t,n){var r=n(711),i=n(712);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=r(e.prototype),a=e.apply(n,t);return i(a)?a:n}}},633:function(e,t,n){e.exports=n(25)(276)},635:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return p}));var r=n(3),i=n(7);const a=e=>Object(r.omit)("and",e),o=e=>null!=e,c=e=>e.reduce(((e,t)=>[...e,[a(t),...t.and]]),[]),s=e=>Number(e.substring(e.lastIndexOf(".")+1)),u=({index:e,dataProviderGroups:t})=>e>=0&&e<t.length,l=e=>e.reduce(((e,t)=>[...e,{...t[0],and:t.slice(1)}]),[]),d=[[]],f=({dataProviders:e,destination:t,dispatch:n,source:r,timelineId:a})=>{if(!o(t))return;const f=[...c(e),...d];(({destination:e,source:t})=>t.droppableId===e.droppableId)({source:r,destination:t})?(({dataProviderGroups:e,destination:t,dispatch:n,source:r,timelineId:a})=>{const o=s(r.droppableId);if(u({index:o,dataProviderGroups:e})){const c=(({endIndex:e,group:t,startIndex:n})=>{const r=[...t],[i]=r.splice(n,1);return r.splice(e,0,i),r})({group:e[o],startIndex:r.index,endIndex:t.index}),s=e.reduce(((e,t,n)=>[...e,n===o?[...c]:[...t]]),[]);n(Object(i.updateProviders)({id:a,providers:l(s.filter((e=>e.length)))}))}})({dataProviderGroups:f,destination:t,dispatch:n,source:r,timelineId:a}):(({dataProviderGroups:e,destination:t,dispatch:n,source:r,timelineId:a})=>{const o=s(r.droppableId),c=s(t.droppableId);if(u({index:o,dataProviderGroups:e})&&u({index:c,dataProviderGroups:e})){const s=e[o],u=e[c],d=r.index,f=t.index,{updatedDestinationGroup:p,updatedSourcererScope:b}=(({destinationGroup:e,moveProviderFromSourceIndex:t,moveProviderToDestinationIndex:n,sourceGroup:r})=>{const i=[...r],a=[...e],[o]=i.splice(t,1);return a.splice(n,0,o),{updatedDestinationGroup:a.filter(((e,t)=>e.id!==o.id||t===n)),updatedSourcererScope:i}})({destinationGroup:u,moveProviderFromSourceIndex:d,moveProviderToDestinationIndex:f,sourceGroup:s}),g=e.reduce(((e,t,n)=>[...e,n===o?[...b]:n===c?[...p]:[...t]]),[]);n(Object(i.updateProviders)({id:a,providers:l(g.filter((e=>e.length)))}))}})({dataProviderGroups:f,destination:t,dispatch:n,source:r,timelineId:a})},p=({dataProviders:e,destination:t,dispatch:n,onAddedToTimeline:r,providerToAdd:f,timelineId:p})=>{0===e.length?(({dispatch:e,onAddedToTimeline:t,providerToAdd:n,timelineId:r})=>{e(Object(i.updateProviders)({id:r,providers:[n]})),t(n.name)})({dispatch:n,onAddedToTimeline:r,providerToAdd:f,timelineId:p}):(({dataProviders:e,destination:t,dispatch:n,onAddedToTimeline:r,providerToAdd:f,timelineId:p})=>{const b=[...c(e),...d];if(!o(t))return;const g=s(t.droppableId);if(u({index:g,dataProviderGroups:b})){const e=[...b[g]];e.splice(t.index,0,a(f));const o=e.filter(((e,n)=>e.id!==f.id||n===t.index)),c=b.reduce(((e,t,n)=>[...e,n===g?[...o]:[...t]]),[]);n(Object(i.updateProviders)({id:p,providers:l(c.filter((e=>e.length)))})),r(f.name)}})({dataProviders:e,destination:t,dispatch:n,onAddedToTimeline:r,providerToAdd:f,timelineId:p})}},709:function(e,t,n){t.set=t.assoc=t.assocPath=n(1093),t.setWith=n(1157)},710:function(e,t,n){var r=n(922),i=n(1098),a=n(1099),o=n(926),c=n(1118),s=n(930),u=n(1119),l=n(932),d=n(933),f=n(936),p=Math.max;e.exports=function(e,t,n,b,g,m,v,h){var x=2&t;if(!x&&"function"!=typeof e)throw new TypeError("Expected a function");var O=b?b.length:0;if(O||(t&=-97,b=g=void 0),v=void 0===v?v:p(f(v),0),h=void 0===h?h:f(h),O-=g?g.length:0,64&t){var y=b,j=g;b=g=void 0}var I=x?void 0:s(e),S=[e,t,n,b,g,y,j,m,v,h];if(I&&u(S,I),e=S[0],t=S[1],n=S[2],b=S[3],g=S[4],!(h=S[9]=void 0===S[9]?x?0:e.length:p(S[9]-O,0))&&24&t&&(t&=-25),t&&1!=t)k=8==t||16==t?a(e,t,h):32!=t&&33!=t||g.length?o.apply(void 0,S):c(e,t,n,b);else var k=i(e,t,n);return d((I?r:l)(k,S),e,t)}},711:function(e,t,n){e.exports=n(25)(3355)},712:function(e,t,n){e.exports=n(25)(319)},713:function(e,t,n){var r=n(711),i=n(714);function a(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}a.prototype=r(i.prototype),a.prototype.constructor=a,e.exports=a},714:function(e,t){e.exports=function(){}},715:function(e,t,n){e.exports=n(25)(249)},716:function(e,t,n){e.exports=n(25)(3345)},717:function(e,t,n){e.exports=n(25)(1462)},718:function(e,t){var n="__lodash_placeholder__";e.exports=function(e,t){for(var r=-1,i=e.length,a=0,o=[];++r<i;){var c=e[r];c!==t&&c!==n||(e[r]=n,o[a++]=r)}return o}},719:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return m}));var r=n(17),i=n(26),a=n.n(i),o=n(4),c=n.n(o),s=n(24),u=n.n(s),l=n(50),d=n.n(l),f=n(463),p=n(98);f.f;const b=u.a.h3.withConfig({displayName:"TitleText",componentId:"sc-wz9mhv-0"})(["margin:0 5px;cursor:default;user-select:none;"]);b.displayName="TitleText",c.a.memo((({noteIds:e})=>c.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},c.a.createElement(r.EuiFlexItem,{grow:!1},c.a.createElement(r.EuiIcon,{color:"text",size:"l",type:"editorComment"})),c.a.createElement(r.EuiFlexItem,{grow:!1},c.a.createElement(r.EuiTitle,{size:"s"},c.a.createElement(b,null,f.e))),c.a.createElement(r.EuiFlexItem,{grow:!1},c.a.createElement(p.c,{color:"hollow"},e.length))))).displayName="NotesCount";const g=({newNote:e})=>({created:a.a.utc().toDate(),id:d.a.v4(),lastEdit:null,note:e,saveObjectId:null,user:"elastic",version:null}),m=({associateNote:e,newNote:t,updateNewNote:n,updateNote:r})=>{const i=g({newNote:t});r(i),e(i.id),n("")}},920:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(6);const i=r.i18n.translate("xpack.securitySolution.beatFields.errorSearchDescription",{defaultMessage:"An error has occurred on getting beat fields"}),a=r.i18n.translate("xpack.securitySolution.beatFields.failSearchDescription",{defaultMessage:"Failed to run search on beat fields"})},921:function(e,t,n){var r=n(1094),i=n(1095);e.exports=function(e,t,n){return r(i,e,t,n)}},922:function(e,t,n){var r=n(923),i=n(924),a=i?function(e,t){return i.set(e,t),e}:r;e.exports=a},923:function(e,t,n){e.exports=n(25)(1499)},924:function(e,t,n){var r=n(1097),i=r&&new r;e.exports=i},925:function(e,t,n){e.exports=n(25)(3371)},926:function(e,t,n){var r=n(927),i=n(928),a=n(1100),o=n(632),c=n(929),s=n(935),u=n(1117),l=n(718),d=n(633);e.exports=function e(t,n,f,p,b,g,m,v,h,x){var O=128&n,y=1&n,j=2&n,I=24&n,S=512&n,k=j?void 0:o(t);return function w(){for(var E=arguments.length,_=Array(E),T=E;T--;)_[T]=arguments[T];if(I)var D=s(w),R=a(_,D);if(p&&(_=r(_,p,b,I)),g&&(_=i(_,g,m,I)),E-=R,I&&E<x){var M=l(_,D);return c(t,n,e,w.placeholder,f,_,M,v,h,x-E)}var P=y?f:this,N=j?P[t]:t;return E=_.length,v?_=u(_,v):S&&E>1&&_.reverse(),O&&h<E&&(_.length=h),this&&this!==d&&this instanceof w&&(N=k||o(N)),N.apply(P,_)}}},927:function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var a=-1,o=e.length,c=r.length,s=-1,u=t.length,l=n(o-c,0),d=Array(u+l),f=!i;++s<u;)d[s]=t[s];for(;++a<c;)(f||a<o)&&(d[r[a]]=e[a]);for(;l--;)d[s++]=e[a++];return d}},928:function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var a=-1,o=e.length,c=-1,s=r.length,u=-1,l=t.length,d=n(o-s,0),f=Array(d+l),p=!i;++a<d;)f[a]=e[a];for(var b=a;++u<l;)f[b+u]=t[u];for(;++c<s;)(p||a<o)&&(f[b+r[c]]=e[a++]);return f}},929:function(e,t,n){var r=n(1101),i=n(932),a=n(933);e.exports=function(e,t,n,o,c,s,u,l,d,f){var p=8&t;t|=p?32:64,4&(t&=~(p?64:32))||(t&=-4);var b=[e,t,c,p?s:void 0,p?u:void 0,p?void 0:s,p?void 0:u,l,d,f],g=n.apply(void 0,b);return r(e)&&i(g,b),g.placeholder=o,a(g,e,t)}},930:function(e,t,n){var r=n(924),i=n(1102),a=r?function(e){return r.get(e)}:i;e.exports=a},931:function(e,t,n){var r=n(711),i=n(714);function a(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}a.prototype=r(i.prototype),a.prototype.constructor=a,e.exports=a},932:function(e,t,n){var r=n(922),i=n(1107)(r);e.exports=i},933:function(e,t,n){var r=n(1108),i=n(1109),a=n(1110),o=n(1111);e.exports=function(e,t,n){var c=t+"";return a(e,i(c,o(r(c),n)))}},934:function(e,t,n){e.exports=n(25)(3339)},935:function(e,t){e.exports=function(e){return e.placeholder}},936:function(e,t,n){e.exports=n(25)(3323)},937:function(e,t,n){e.exports=n(25)(3338)},938:function(e,t,n){e.exports=n(25)(866)},939:function(e,t,n){e.exports=n(25)(3005)},940:function(e,t,n){var r=n(712);e.exports=function(e){return e==e&&!r(e)}},941:function(e,t){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},942:function(e,t,n){e.exports=n(25)(1122)},943:function(e,t,n){e.exports=n(25)(3333)},944:function(e,t,n){var r=n(1156),i=n(942),a=n(938),o=n(717),c=n(712),s=n(545);e.exports=function(e,t,n,u){if(!c(e))return e;for(var l=-1,d=(t=i(t,e)).length,f=d-1,p=e;null!=p&&++l<d;){var b=s(t[l]),g=n;if("prototype"==b&&a(p))throw new Error("Illegal access of function prototype");if(l!=f){var m=hasOwnProperty.call(p,b)?p[b]:void 0;void 0===(g=u?u(m,b,p):void 0)&&(g=c(m)?m:o(t[l+1])?[]:{})}r(p,b,g),p=p[b]}return e}},945:function(e,t,n){e.exports=n(25)(3508)},996:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return b}));var r=n(4),i=n.n(r),a=n(197);const o={capabilities:Object(a.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var c=n(202),s=n(19),u=n(271);const l=Object(u.d)((async({http:e,signal:t})=>e.fetch("/api/ml/ml_capabilities",{method:"GET",asSystemRequest:!0,signal:t}))),d=n(6).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),f={...o,capabilitiesFetched:!1},p=i.a.createContext(f);p.displayName="MlCapabilitiesContext";const b=i.a.memo((({children:e})=>{const[t,n]=Object(r.useState)(f),a=Object(s.j)(),{addError:o}=Object(c.a)(),{start:b,result:g,error:m}=Object(u.a)(l);return Object(r.useEffect)((()=>{b({http:a})}),[a,b]),Object(r.useEffect)((()=>{g&&n({...g,capabilitiesFetched:!0})}),[g]),Object(r.useEffect)((()=>{m&&o(m,{title:d})}),[o,m]),i.a.createElement(p.Provider,{value:t},e)}));b.displayName="MlCapabilitiesProvider"}}]);