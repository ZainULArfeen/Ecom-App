/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var n,a,s=t[0],r=t[1],o=0,c=[];o<s.length;o++)a=s[o],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&c.push(i[a][0]),i[a]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);for(l&&l(t);c.length;)c.shift()()}var n={},i={4:0};function a(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise((function(t,a){n=i[e]=[t,a]}));t.push(n[2]=s);var r,o=document.createElement("script");o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.src=function(e){return a.p+"lens.chunk."+e+".js"}(e);var l=new Error;r=function(t){o.onerror=o.onload=null,clearTimeout(c);var n=i[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+a+": "+s+")",l.name="ChunkLoadError",l.type=a,l.request=s,n[1](l)}i[e]=void 0}};var c=setTimeout((function(){r({type:"timeout",target:o})}),12e4);o.onerror=o.onload=r,document.head.appendChild(o)}return Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a.oe=function(e){throw console.error(e),e};var s=window.lens_bundle_jsonpfunction=window.lens_bundle_jsonpfunction||[],r=s.push.bind(s);s.push=t,s=s.slice();for(var o=0;o<s.length;o++)t(s[o]);var l=r;a(a.s=29)}([function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t,n){e.exports=n(23)(2)},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,n){"use strict";n.r(t),n.d(t,"PLUGIN_ID",(function(){return s})),n.d(t,"APP_ID",(function(){return r})),n.d(t,"LENS_EMBEDDABLE_TYPE",(function(){return o})),n.d(t,"DOC_TYPE",(function(){return l})),n.d(t,"NOT_INTERNATIONALIZED_PRODUCT_NAME",(function(){return c})),n.d(t,"BASE_API_URL",(function(){return u})),n.d(t,"LENS_EDIT_BY_VALUE",(function(){return d})),n.d(t,"PieChartTypes",(function(){return p})),n.d(t,"CategoryDisplay",(function(){return b})),n.d(t,"NumberDisplay",(function(){return f})),n.d(t,"LegendDisplay",(function(){return m})),n.d(t,"layerTypes",(function(){return g})),n.d(t,"DOCUMENT_FIELD_NAME",(function(){return h})),n.d(t,"getBasePath",(function(){return _})),n.d(t,"getEditPath",(function(){return v})),n.d(t,"getFullPath",(function(){return y}));var i=n(27),a=n.n(i);const s="lens",r="lens",o="lens",l="lens",c="Lens Visualizations",u="/api/lens",d="edit_by_value",p={PIE:"pie",DONUT:"donut",TREEMAP:"treemap",MOSAIC:"mosaic",WAFFLE:"waffle"},b={DEFAULT:"default",INSIDE:"inside",HIDE:"hide"},f={HIDDEN:"hidden",PERCENT:"percent",VALUE:"value"},m={DEFAULT:"default",SHOW:"show",HIDE:"hide"},g={DATA:"data",REFERENCELINE:"referenceLine",ANNOTATIONS:"annotations"},h="___records___";function _(){return"#/"}function v(e,t){let n="";return t&&(n=`?_g=${a.a.encode({time:t})}`),e?`#/edit/${encodeURIComponent(e)}${n}`:`#/${d}${n}`}function y(e){return`/app/${s}${e?v(e):"#/"}`}},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/visualizations/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));function i(e,t){return`${e}---${t}`}function a(e){if(e.includes("---")){const t=e.split("---");return t[t.length-1]}return e}function s(e,t,n){e.columns.filter((e=>e.isTransposed)).reverse().forEach((({columnId:a})=>{const s=t.columns.findIndex((e=>e.id===a)),r=t.columns[s],o=n[r.id],{uniqueValues:l,uniqueRawValues:c}=function(e,t,n){const i=new Map;e.rows.forEach((e=>{const a=e[n];i.set(t.convert(e[n]),a)}));return{uniqueValues:[...i.keys()],uniqueRawValues:[...i.values()]}}(t,o,a),u=e.columns.filter((e=>e.transposable)),d=e.columns.filter((e=>!e.transposable&&e.columnId!==a));t.columns.splice(s,1),function(e,t,n,a,s,r,o){!function(e,t,n){e.columns=[...t],n[0].forEach(((t,i)=>{n.forEach((t=>{e.columns.push(t[i])}))}))}(e,t,n.map((e=>{const t=a.columns.find((t=>t.id===e.columnId)),n=s.map((n=>({...t,id:i(n,e.columnId),name:`${n} â€º ${t.name}`})));return a.columns.splice(a.columns.findIndex((t=>t.id===e.columnId)),1,...n),s.map(((n,a)=>({...e,columnId:i(n,e.columnId),originalColumnId:e.originalColumnId||e.columnId,originalName:e.originalName||t.name,bucketValues:[...e.bucketValues||[],{originalBucketColumn:o,value:r[a]}]})))})))}(e,d,u,t,l,c,r),function(e,t,n,a,s,r){const o=function(e,t,n){const i={};return e.rows.forEach((e=>{const a=t.map((t=>n[t.columnId].convert(e[t.columnId]))).join(",");i[a]||(i[a]=[]),i[a].push(e)})),i}(e,t,n);e.rows=function(e,t,n,a,s){return Object.values(e).map((e=>{const r={};return t.forEach((t=>{r[t.columnId]=e[0][t.columnId]})),e.forEach((e=>{const t=n.convert(e[a]);s.forEach((n=>{r[i(t,n.columnId)]=e[n.columnId]}))})),r}))}(o,t,a,s,r)}(t,d,n,o,a,u)}))}},function(e,t,n){n.r(t);var i=__kbnBundles__.get("entry/core/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i.APP_ID})),n.d(t,"g",(function(){return i.LENS_EMBEDDABLE_TYPE})),n.d(t,"d",(function(){return i.DOC_TYPE})),n.d(t,"f",(function(){return i.LENS_EDIT_BY_VALUE})),n.d(t,"j",(function(){return i.PieChartTypes})),n.d(t,"b",(function(){return i.CategoryDisplay})),n.d(t,"i",(function(){return i.NumberDisplay})),n.d(t,"h",(function(){return i.LegendDisplay})),n.d(t,"m",(function(){return i.layerTypes})),n.d(t,"c",(function(){return i.DOCUMENT_FIELD_NAME})),n.d(t,"k",(function(){return i.getEditPath})),n.d(t,"l",(function(){return i.getFullPath})),n.d(t,"e",(function(){return a}));var i=n(3);let a;!function(e){e[e.SMALL=.3]="SMALL",e[e.MEDIUM=.54]="MEDIUM",e[e.LARGE=.7]="LARGE"}(a||(a={}))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);const a=e=>({name:"lens_datatable",type:"render",inputTypes:["datatable"],help:i.i18n.translate("xpack.lens.datatable.expressionHelpLabel",{defaultMessage:"Datatable renderer"}),args:{title:{types:["string"],help:i.i18n.translate("xpack.lens.datatable.titleLabel",{defaultMessage:"Title"})},description:{types:["string"],help:""},columns:{types:["lens_datatable_column"],help:"",multi:!0},sortingColumnId:{types:["string"],help:""},sortingDirection:{types:["string"],help:""},fitRowToContent:{types:["boolean"],help:""},rowHeightLines:{types:["number"],help:""},headerRowHeight:{types:["string"],help:""},headerRowHeightLines:{types:["number"],help:""},pageSize:{types:["number"],help:""}},async fn(...t){const{datatableFn:i}=await n.e(5).then(n.bind(null,68));return i(e)(...t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i={name:"lens_datatable_column",aliases:[],type:"lens_datatable_column",help:"",inputTypes:["null"],args:{columnId:{types:["string"],help:""},alignment:{types:["string"],help:""},sortingHint:{types:["string"],help:""},hidden:{types:["boolean"],help:""},oneClickFilter:{types:["boolean"],help:""},width:{types:["number"],help:""},isTransposed:{types:["boolean"],help:""},transposable:{types:["boolean"],help:""},colorMode:{types:["string"],help:""},palette:{types:["palette"],help:""},summaryRow:{types:["string"],help:""},summaryLabel:{types:["string"],help:""}},fn:function(e,t){return{type:"lens_datatable_column",...t}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);const a={name:"lens_map_to_columns",type:"datatable",help:i.i18n.translate("xpack.lens.functions.mapToColumns.help",{defaultMessage:"A helper to transform a datatable to match Lens column definitions"}),args:{idMap:{types:["string"],help:i.i18n.translate("xpack.lens.functions.mapToColumns.idMap.help",{defaultMessage:"A JSON encoded object in which keys are the datatable column ids and values are the Lens column definitions. Any datatable columns not mentioned within the ID map will be kept unmapped."})}},inputTypes:["datatable"],async fn(...e){const{mapToOriginalColumns:t}=await n.e(12).then(n.bind(null,64));return t(...e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i={name:"lens_format_column",type:"datatable",help:"",args:{format:{types:["string"],help:"",required:!0},columnId:{types:["string"],help:"",required:!0},decimals:{types:["number"],help:""},suffix:{types:["string"],help:""},parentFormat:{types:["string"],help:""}},inputTypes:["datatable"],async fn(...e){const{formatColumnFn:t}=await n.e(8).then(n.bind(null,65));return t(...e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0);const a={name:"lens_counter_rate",type:"datatable",inputTypes:["datatable"],help:i.i18n.translate("xpack.lens.functions.counterRate.help",{defaultMessage:"Calculates the counter rate of a column in a data table"}),args:{by:{help:i.i18n.translate("xpack.lens.functions.counterRate.args.byHelpText",{defaultMessage:"Column to split the counter rate calculation by"}),multi:!0,types:["string"],required:!1},inputColumnId:{help:i.i18n.translate("xpack.lens.functions.counterRate.args.inputColumnIdHelpText",{defaultMessage:"Column to calculate the counter rate of"}),types:["string"],required:!0},outputColumnId:{help:i.i18n.translate("xpack.lens.functions.counterRate.args.outputColumnIdHelpText",{defaultMessage:"Column to store the resulting counter rate in"}),types:["string"],required:!0},outputColumnName:{help:i.i18n.translate("xpack.lens.functions.counterRate.args.outputColumnNameHelpText",{defaultMessage:"Name of the column to store the resulting counter rate in"}),types:["string"],required:!1}},async fn(...e){const{counterRateFn:t}=await n.e(11).then(n.bind(null,66));return t(...e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i=(...e)=>({name:"lens_time_scale",type:"datatable",help:"",args:{dateColumnId:{types:["string"],help:""},inputColumnId:{types:["string"],help:"",required:!0},outputColumnId:{types:["string"],help:"",required:!0},outputColumnName:{types:["string"],help:""},targetUnit:{types:["string"],options:["s","m","h","d"],help:"",required:!0},reducedTimeRange:{types:["string"],help:""}},inputTypes:["datatable"],async fn(...t){const{timeScaleFn:i}=await n.e(13).then(n.bind(null,67));return i(...e)(...t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(9);function a(e){return"number"==typeof e||null==e}function s(e,t){var n;const s=null==e?void 0:e.columns.find((e=>e.id===t||Object(i.a)(e.id)===t));return"number"===(null==s?void 0:s.meta.type)&&"date"!==(null==s||null===(n=s.meta.params)||void 0===n?void 0:n.id)&&(null==e?void 0:e.rows.every((e=>{const n=e[t];return a(n)||Array.isArray(n)&&n.every(a)})))}},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t,n){e.exports=n(23)(3)},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s.c})),n.d(t,"b",(function(){return s.b})),n.d(t,"e",(function(){return s.d})),n.d(t,"d",(function(){return r.a})),n.d(t,"f",(function(){return o.a})),n(17);var i=n(0);const a={name:"lens_collapse",type:"datatable",inputTypes:["datatable"],help:i.i18n.translate("xpack.lens.functions.collapse.help",{defaultMessage:"Collapses multiple rows into a single row using the specified aggregate function."}),args:{by:{help:i.i18n.translate("xpack.lens.functions.collapse.args.byHelpText",{defaultMessage:"Columns to group by - these columns are kept as-is"}),multi:!0,types:["string"],required:!1},metric:{help:i.i18n.translate("xpack.lens.functions.collapse.args.metricHelpText",{defaultMessage:"Column to calculate the specified aggregate function of"}),types:["string"],multi:!0,required:!1},fn:{help:i.i18n.translate("xpack.lens.functions.collapse.args.fnHelpText",{defaultMessage:"The aggregate function to apply"}),types:["string"],multi:!0,required:!0}},async fn(...e){const{collapseFn:t}=await n.e(10).then(n.bind(null,482));return t(...e)}};n(16),n(15),n(18),n(14),n(13);var s=n(26),r=n(9),o=n(19)},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return c}));var i=n(0),a=n(9),s=n(19);function r(e,t,n){var i;const a=Object(s.a)(n,e)&&(null==t?void 0:t.summaryRow)||"none";return{summaryRow:a,summaryLabel:null!==(i=null==t?void 0:t.summaryLabel)&&void 0!==i?i:o(a)}}function o(e){return l().find((({value:t})=>e===t)).label}function l(){return[{value:"none",label:i.i18n.translate("xpack.lens.table.summaryRow.none",{defaultMessage:"None"}),"data-test-subj":"lns-datatable-summary-none"},{value:"count",label:i.i18n.translate("xpack.lens.table.summaryRow.count",{defaultMessage:"Value count"}),"data-test-subj":"lns-datatable-summary-count"},{value:"sum",label:i.i18n.translate("xpack.lens.table.summaryRow.sum",{defaultMessage:"Sum"}),"data-test-subj":"lns-datatable-summary-sum"},{value:"avg",label:i.i18n.translate("xpack.lens.table.summaryRow.average",{defaultMessage:"Average"}),"data-test-subj":"lns-datatable-summary-avg"},{value:"min",label:i.i18n.translate("xpack.lens.table.summaryRow.minimum",{defaultMessage:"Minimum"}),"data-test-subj":"lns-datatable-summary-min"},{value:"max",label:i.i18n.translate("xpack.lens.table.summaryRow.maximum",{defaultMessage:"Maximum"}),"data-test-subj":"lns-datatable-summary-max"}]}function c(e,t,n,i){const s=function(e,t,n){const i=n.filter((e=>null!=e[t])).flatMap((e=>e[t])),a=i.length,s=i.reduce(((e,t)=>e+t),0);switch(e){case"sum":return s;case"count":return a;case"avg":return s/a;case"min":return Math.min(...i);case"max":return Math.max(...i);default:throw Error("No summary function found")}}(e.summaryRow,e.columnId,t.rows);return"count"===e.summaryRow?i.convert(s):n[Object(a.a)(e.columnId)].convert(s)}},function(e,t){e.exports=__kbnSharedDeps__.RisonNode},function(e,t,n){"use strict";n.r(t),n.d(t,"layerTypes",(function(){return p.m})),n.d(t,"plugin",(function(){return q}));var i=n(1),a=n.n(i),s=n(12),r=n(5),o=n(10),l=n(4),c=n(8),u=n(3),d=n(0),p=n(11);function b(e){return e.type===p.d}async function f({hasDiscoverAccess:e,embeddable:t}){if(!e)return!1;try{return b(t)&&await t.canViewUnderlyingData()}catch(e){return console.error(e),!1}}async function m({embeddable:e,filters:t,dataViews:i,timeFieldName:a}){if(!b(e))throw new Error("Can only be executed in the context of Lens visualization");const s=e.getViewUnderlyingDataArgs();if(!s)throw new Error("Underlying data is not ready");const r=await i.get(s.indexPatternId);let o=[...t||[],...s.filters],l=s.timeRange;if(r.isTimeBased()&&r.timeFieldName===a){const{extractTimeRange:e}=await n.e(1).then(n.bind(null,94)),{restOfFilters:i,timeRange:s}=e(t||[],a);o=i,s&&(l=s)}return{...s,timeRange:l,filters:o}}async function g({embeddable:e,discover:t,filters:n,dataViews:i,timeFieldName:a}){var s;const r=await m({embeddable:e,filters:n,dataViews:i,timeFieldName:a});return null===(s=t.locator)||void 0===s?void 0:s.getRedirectUrl(r)}const h="ACTION_OPEN_IN_DISCOVER",_=(e,t)=>{const n=e;if("attributes"in n&&void 0!==n.attributes){const e=[];Array.isArray(n.attributes.references)&&n.attributes.references.forEach((n=>{const i=n,a=t.find((e=>e.name===i.name));a&&e.push(a)})),n.attributes.references=e}return n},v=e=>{let t=[];const n=e;return"attributes"in n&&void 0!==n.attributes&&(t=n.attributes.references),{state:e,references:t}};class embeddable_factory_EmbeddableFactory{constructor(e){a()(this,"type",u.DOC_TYPE),a()(this,"savedObjectMetaData",{name:d.i18n.translate("xpack.lens.lensSavedObjectLabel",{defaultMessage:"Lens Visualization"}),type:u.DOC_TYPE,getIconForSavedObject:()=>"lensApp"}),a()(this,"isEditable",(async()=>{var e;const{capabilities:t}=await this.getStartServices();return Boolean(t.visualize.save||(null===(e=t.dashboard)||void 0===e?void 0:e.showWriteControls))})),a()(this,"createFromSavedObject",(async(e,t,n)=>(t.savedObjectId||(t.savedObjectId=e),this.create(t,n)))),a()(this,"extract",v),a()(this,"inject",_),this.getStartServices=e}canCreateNew(){return!1}getDisplayName(){return d.i18n.translate("xpack.lens.embeddableDisplayName",{defaultMessage:"lens"})}async create(e,t){try{var i;const{data:a,timefilter:s,expressionRenderer:r,documentToExpression:o,injectFilterReferences:l,visualizationMap:c,datasourceMap:u,uiActions:d,coreHttp:p,attributeService:b,dataViews:f,capabilities:m,usageCollection:g,theme:h,inspector:_,spaces:v,uiSettings:y}=await this.getStartServices(),{Embeddable:w}=await Promise.all([n.e(1),n.e(0),n.e(2),n.e(3)]).then(n.bind(null,485));return new w({attributeService:b,data:a,dataViews:f,timefilter:s,inspector:_,expressionRenderer:r,basePath:p.basePath,getTrigger:null==d?void 0:d.getTrigger,getTriggerCompatibleActions:null==d?void 0:d.getTriggerCompatibleActions,documentToExpression:o,injectFilterReferences:l,visualizationMap:c,datasourceMap:u,capabilities:{canSaveDashboards:Boolean(null===(i=m.dashboard)||void 0===i?void 0:i.showWriteControls),canSaveVisualizations:Boolean(m.visualize.save),navLinks:m.navLinks,discover:m.discover},usageCollection:g,theme:h,spaces:v,uiSettings:y},e,t)}catch(n){return new r.ErrorEmbeddable(n,e,t)}}}var y=n(7),w=n.n(y),O=n(6),E=n(2);function D(e,t){const{embeddable:n,uiActions:i,inspector:a}=t,s=n.getEmbeddableFactory("lens"),r=e.theme;return e=>{var t;const n={...e},o=Boolean(n.withDefaultActions)||n.extraActions&&(null===(t=n.extraActions)||void 0===t?void 0:t.length)>0;return o?Object(E.jsx)(j,{factory:s,uiActions:i,inspector:a,actionPredicate:()=>o,input:n,theme:r,extraActions:n.extraActions,withDefaultActions:n.withDefaultActions}):Object(E.jsx)(A,{factory:s,input:n})}}function A({factory:e,input:t}){const[n,i,a]=Object(r.useEmbeddableFactory)({factory:e,input:t});return i?Object(E.jsx)(O.EuiLoadingChart,null):Object(E.jsx)(r.EmbeddableRoot,{embeddable:n,loading:i,error:a,input:t})}const j=({factory:e,uiActions:t,actionPredicate:n,inspector:i,input:a,theme:s,extraActions:o,withDefaultActions:l})=>{const[c,u]=Object(r.useEmbeddableFactory)({factory:e,input:a});return Object(y.useEffect)((()=>{c&&c.updateInput(a)}),[c,a]),u||!c?Object(E.jsx)(O.EuiLoadingChart,null):Object(E.jsx)(r.EmbeddablePanel,{hideHeader:!1,embeddable:c,getActions:async(e,n)=>{const i=l?await t.getTriggerCompatibleActions(e,n):[];return[...null!=o?o:[],...i]},inspector:i,actionPredicate:n,showShadow:!1,showBadges:!1,showNotifications:!1,theme:s})};var x=n(21),T=n.n(x);const P=w.a.lazy((()=>Promise.all([n.e(1),n.e(0),n.e(2)]).then(n.bind(null,108))));function I(){return Object(E.jsx)(O.EuiOverlayMask,null,Object(E.jsx)(O.EuiLoadingSpinner,null))}const S=e=>Object(E.jsx)(y.Suspense,{fallback:Object(E.jsx)(I,null)},Object(E.jsx)(P,e));function k(e,t){return i=>{const[a,s]=Object(y.useState)();if(Object(y.useEffect)((()=>{!async function(){const{getLensServices:i,getLensAttributeService:a}=await Promise.all([n.e(1),n.e(0),n.e(2),n.e(3)]).then(n.bind(null,485)),r=await i(e,t,a(e,t));s(r)}()}),[]),!a)return Object(E.jsx)(I,null);const{ContextProvider:r}=a.presentationUtil;return Object(E.jsx)(O.EuiOverlayMask,null,Object(E.jsx)(r,null,Object(E.jsx)(S,T()({},i,{lensServices:a}))))}}var C=n(13),L=n(14),V=n(15),N=n(16),M=n(17),R=n(18),F=n(25),z=n(20),B=n(24),U=n(22);class open_in_discover_drilldown_OpenInDiscoverDrilldown{constructor(e){a()(this,"id","OPEN_IN_DISCOVER_DRILLDOWN"),a()(this,"order",8),a()(this,"getDisplayName",(()=>d.i18n.translate("xpack.lens.app.exploreDataInDiscoverDrilldown",{defaultMessage:"Open in Discover"}))),a()(this,"euiIcon","discoverApp"),a()(this,"ReactCollectConfig",(({config:e,onConfig:t,context:n})=>Object(E.jsx)(O.EuiFormRow,{hasChildLabel:!1},Object(E.jsx)(O.EuiSwitch,{id:"openInNewTab",name:"openInNewTab",label:d.i18n.translate("xpack.lens.app.exploreDataInDiscoverDrilldown.newTabConfig",{defaultMessage:"Open in new tab"}),checked:e.openInNewTab,onChange:()=>t({...e,openInNewTab:!e.openInNewTab}),"data-test-subj":"openInDiscoverDrilldownOpenInNewTab"})))),a()(this,"CollectConfig",Object(U.reactToUiComponent)(this.ReactCollectConfig)),a()(this,"createConfig",(()=>({openInNewTab:!0}))),a()(this,"isConfigValid",(e=>!0)),a()(this,"isCompatible",(async(e,t)=>f({discover:this.deps.discover,dataViews:this.deps.dataViews(),hasDiscoverAccess:this.deps.hasDiscoverAccess(),...t,embeddable:t.embeddable,...e}))),a()(this,"isConfigurable",(e=>this.deps.hasDiscoverAccess()&&b(e.embeddable))),a()(this,"getHref",(async(e,t)=>g({discover:this.deps.discover,dataViews:this.deps.dataViews(),hasDiscoverAccess:this.deps.hasDiscoverAccess(),...t,embeddable:t.embeddable}))),a()(this,"execute",(async(e,t)=>{if(e.openInNewTab)window.open(await this.getHref(e,t),"_blank");else{const{app:e,path:n,state:i}=await async function({embeddable:e,discover:t,filters:n,dataViews:i,timeFieldName:a}){var s;const r=await m({embeddable:e,filters:n,dataViews:i,timeFieldName:a}),o=null===(s=t.locator)||void 0===s?void 0:s.getLocation(r);if(!o)throw new Error("Discover location not found");return o}({discover:this.deps.discover,dataViews:this.deps.dataViews(),hasDiscoverAccess:this.deps.hasDiscoverAccess(),...t,embeddable:t.embeddable});await this.deps.application().navigateToApp(e,{path:n,state:i})}})),this.deps=e}supportedTriggers(){return[B.APPLY_FILTER_TRIGGER]}}class plugin_LensPlugin{constructor(){a()(this,"datatableVisualization",void 0),a()(this,"editorFrameService",void 0),a()(this,"editorFrameSetup",void 0),a()(this,"queuedVisualizations",[]),a()(this,"indexpatternDatasource",void 0),a()(this,"xyVisualization",void 0),a()(this,"legacyMetricVisualization",void 0),a()(this,"metricVisualization",void 0),a()(this,"pieVisualization",void 0),a()(this,"heatmapVisualization",void 0),a()(this,"gaugeVisualization",void 0),a()(this,"topNavMenuEntries",[]),a()(this,"hasDiscoverAccess",!1),a()(this,"dataViewsService",void 0)}setup(e,{urlForwarding:t,expressions:i,data:a,fieldFormats:r,embeddable:l,visualizations:c,charts:p,eventAnnotation:b,globalSearch:f,usageCollection:m,uiActionsEnhanced:g,discover:h}){const _=Object(s.createStartServicesGetter)(e.getStartServices);l&&l.registerEmbeddableFactory("lens",new embeddable_factory_EmbeddableFactory((async()=>{const{getLensAttributeService:t,setUsageCollectionStart:o,initMemoizedErrorNotification:l}=await Promise.all([n.e(1),n.e(0),n.e(2),n.e(3)]).then(n.bind(null,485)),{core:c,plugins:u}=_();await this.initParts(e,a,p,i,r,u.fieldFormats.deserialize,b);const d=await this.editorFrameService.loadVisualizations(),f=await this.editorFrameService.loadDatasources();return u.usageCollection&&o(u.usageCollection),l(c),{attributeService:t(c,u),capabilities:c.application.capabilities,coreHttp:c.http,data:u.data,timefilter:u.data.query.timefilter.timefilter,expressionRenderer:u.expressions.ReactExpressionRenderer,documentToExpression:t=>this.editorFrameService.documentToExpression(t,{dataViews:u.dataViews,storage:new s.Storage(localStorage),uiSettings:e.uiSettings}),injectFilterReferences:a.query.filterManager.inject.bind(a.query.filterManager),visualizationMap:d,datasourceMap:f,dataViews:u.dataViews,uiActions:u.uiActions,usageCollection:m,inspector:u.inspector,spaces:u.spaces,theme:e.theme,uiSettings:e.uiSettings}}))),c.registerAlias({aliasPath:Object(u.getBasePath)(),aliasApp:"lens",name:"lens",promotion:!0,title:d.i18n.translate("xpack.lens.visTypeAlias.title",{defaultMessage:"Lens"}),description:d.i18n.translate("xpack.lens.visTypeAlias.description",{defaultMessage:"Create visualizations with our drag and drop editor. Switch between visualization types at any time."}),note:d.i18n.translate("xpack.lens.visTypeAlias.note",{defaultMessage:"Recommended for most users."}),icon:"lensApp",stage:"production",appExtensions:{visualizations:{docTypes:["lens"],searchFields:["title^3"],toListItem(e){const{id:t,type:n,updatedAt:i,attributes:a}=e,{title:s,description:r}=a;return{id:t,title:s,description:r,updatedAt:i,editUrl:Object(u.getEditPath)(t),editApp:"lens",icon:"lensApp",stage:"production",savedObjectType:n,type:"lens",typeTitle:d.i18n.translate("xpack.lens.visTypeAlias.type",{defaultMessage:"Lens"})}}}}}),h&&g.registerDrilldown(new open_in_discover_drilldown_OpenInDiscoverDrilldown({discover:h,dataViews:()=>this.dataViewsService,hasDiscoverAccess:()=>this.hasDiscoverAccess,application:()=>_().core.application})),((t,i,a,s,r)=>{[F.a,M.a,N.a,V.a,L.a,Object(C.a)((()=>_().plugins.fieldFormats.deserialize)),Object(R.a)((()=>_().plugins.data.datatableUtilities),(async()=>{const{getTimeZone:t}=await n.e(14).then(n.bind(null,75));return t(e.uiSettings)}),(()=>_().plugins.data.nowProvider.get()))].forEach((e=>t.registerFunction(e)))})(i);const v=()=>_().plugins.presentationUtil.ContextProvider;var y;return e.application.register({id:u.APP_ID,title:u.NOT_INTERNATIONALIZED_PRODUCT_NAME,navLinkStatus:o.AppNavLinkStatus.hidden,mount:async t=>{const{core:s,plugins:o}=_();await this.initParts(e,a,p,i,r,o.fieldFormats.deserialize,b);const{mountApp:l,getLensAttributeService:c,setUsageCollectionStart:u,initMemoizedErrorNotification:d}=await Promise.all([n.e(1),n.e(0),n.e(2),n.e(3)]).then(n.bind(null,485));o.usageCollection&&u(o.usageCollection),d(s);const f=this.editorFrameService.start(s,o);return l(e,t,{createEditorFrame:f.createInstance,attributeService:c(s,o),getPresentationUtilContext:v,topNavMenuEntryGenerators:this.topNavMenuEntries})}}),f&&f.registerResultProvider((y=e.getStartServices().then((([{application:{capabilities:e}}])=>e)),{id:"lens",find:({term:e="",types:t,tags:n})=>n||t&&!t.includes("application")?Object(z.of)([]):Object(z.from)(y.then((({navLinks:{visualize:t}})=>{if(!t)return[];const n=d.i18n.translate("xpack.lens.searchTitle",{defaultMessage:"Lens: create visualizations",description:"Lens is a product name and should not be translated"}),i=n.toLowerCase();let a=0;return i===(e=e.toLowerCase())?a=100:i.startsWith(e)?a=90:i.includes(e)&&(a=75),0===a?[]:[{id:"lens",title:n,type:"application",icon:"logoKibana",meta:{categoryId:o.DEFAULT_APP_CATEGORIES.kibana.id,categoryLabel:o.DEFAULT_APP_CATEGORIES.kibana.label},score:a,url:Object(u.getFullPath)()}]}))),getSearchableTypes:()=>["application"]})),t.forwardApp("lens","lens"),{registerVisualization:e=>{this.editorFrameSetup?this.editorFrameSetup.registerVisualization(e):this.queuedVisualizations.push(e)},registerTopNavMenuEntryGenerator:e=>{this.topNavMenuEntries.push(e)}}}async initParts(e,t,i,a,s,r,o){const{DatatableVisualization:l,EditorFrameService:c,IndexPatternDatasource:u,XyVisualization:d,LegacyMetricVisualization:p,MetricVisualization:b,PieVisualization:f,HeatmapVisualization:m,GaugeVisualization:g}=await Promise.all([n.e(1),n.e(0),n.e(2),n.e(3)]).then(n.bind(null,485));this.datatableVisualization=new l,this.editorFrameService=new c,this.indexpatternDatasource=new u,this.xyVisualization=new d,this.legacyMetricVisualization=new p,this.metricVisualization=new b,this.pieVisualization=new f,this.heatmapVisualization=new m,this.gaugeVisualization=new g;const h=this.editorFrameService.setup(),_={expressions:a,data:t,fieldFormats:s,charts:i,editorFrame:h,formatFactory:r,eventAnnotation:o};this.indexpatternDatasource.setup(e,_),this.xyVisualization.setup(e,_),this.datatableVisualization.setup(e,_),this.legacyMetricVisualization.setup(e,_),this.metricVisualization.setup(e,_),this.pieVisualization.setup(e,_),this.heatmapVisualization.setup(e,_),this.gaugeVisualization.setup(e,_),this.queuedVisualizations.forEach((e=>{h.registerVisualization(e)})),this.editorFrameSetup=h}start(e,t){var i,a,s,o;return this.hasDiscoverAccess=e.application.capabilities.discover.show,this.dataViewsService=t.dataViews,t.uiActions.hasAction(l.ACTION_VISUALIZE_FIELD)&&t.uiActions.unregisterAction(l.ACTION_VISUALIZE_FIELD),t.uiActions.addTriggerAction(l.VISUALIZE_FIELD_TRIGGER,(i=e.application,Object(l.createAction)({type:l.ACTION_VISUALIZE_LENS_FIELD,id:l.ACTION_VISUALIZE_LENS_FIELD,getDisplayName:()=>d.i18n.translate("xpack.lens.discover.visualizeFieldLegend",{defaultMessage:"Visualize field"}),isCompatible:async()=>!!i.capabilities.visualize.show,execute:async e=>{i.navigateToApp("lens",{state:{type:l.ACTION_VISUALIZE_LENS_FIELD,payload:e}})}}))),t.uiActions.addTriggerAction(c.VISUALIZE_EDITOR_TRIGGER,(e=>Object(l.createAction)({type:c.ACTION_CONVERT_TO_LENS,id:c.ACTION_CONVERT_TO_LENS,getDisplayName:()=>d.i18n.translate("xpack.lens.visualizeTSVBLegend",{defaultMessage:"Visualize TSVB chart"}),isCompatible:async()=>!!e.capabilities.visualize.show,execute:async t=>{const n=Object.values(t.layers),i={...t,layers:n,isVisualizeAction:!0};e.navigateToApp("lens",{state:{type:c.ACTION_CONVERT_TO_LENS,payload:i,originatingApp:d.i18n.translate("xpack.lens.TSVBLabel",{defaultMessage:"TSVB"})}})}}))(e.application)),t.uiActions.addTriggerAction(r.CONTEXT_MENU_TRIGGER,(a=t.discover,s=t.dataViews,o=this.hasDiscoverAccess,Object(l.createAction)({type:h,id:h,order:19,getIconType:()=>"popout",getDisplayName:()=>d.i18n.translate("xpack.lens.app.exploreDataInDiscover",{defaultMessage:"Explore data in Discover"}),getHref:async e=>g({discover:a,dataViews:s,hasDiscoverAccess:o,...e}),isCompatible:async e=>f({hasDiscoverAccess:o,discover:a,dataViews:s,embeddable:e.embeddable}),execute:async e=>async function({embeddable:e,discover:t,filters:n,openInSameTab:i,dataViews:a,timeFieldName:s,hasDiscoverAccess:r}){const o=await g({embeddable:e,discover:t,filters:n,dataViews:a,timeFieldName:s,hasDiscoverAccess:r});window.open(o,i?"_self":"_blank")}({...e,discover:a,dataViews:s,hasDiscoverAccess:o})}))),{EmbeddableComponent:D(e,t),SaveModalComponent:k(e,t),navigateToPrefilledEditor:(n,{openInNewTab:i=!1,originatingApp:a="",originatingPath:s,skipAppLeave:o=!1}={})=>{null!=n&&n.timeRange&&!i&&t.data.query.timefilter.timefilter.setTime(n.timeRange),new r.EmbeddableStateTransfer(e.application.navigateToApp,e.application.currentAppId$).navigateToEditor(u.APP_ID,{openInNewTab:i,path:Object(u.getEditPath)(void 0,i&&(null==n?void 0:n.timeRange)||void 0),state:{originatingApp:a,originatingPath:s,valueInput:n},skipAppLeave:o})},canUseEditor:()=>{var t;return Boolean(null===(t=e.application.capabilities.visualize)||void 0===t?void 0:t.show)},getXyVisTypes:async()=>{const{visualizationTypes:e}=await Promise.all([n.e(0),n.e(15)]).then(n.bind(null,85));return e},stateHelperApi:async()=>{const{createFormulaPublicApi:e}=await Promise.all([n.e(1),n.e(0),n.e(2),n.e(3)]).then(n.bind(null,485));return{formula:e()}}}}stop(){}}const q=()=>new plugin_LensPlugin},function(e,t,n){n(30),__kbnBundles__.define("plugin/lens/public",n,28),__kbnBundles__.define("plugin/lens/common/constants",n,3)},function(e,t,n){n.p=window.__kbnPublicPath__.lens},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t){e.exports=__kbnSharedDeps__.Classnames},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/expressions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.ElasticCharts},function(e,t){e.exports=__kbnSharedDeps__.KbnUiTheme},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/eventAnnotation/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t){e.exports=__kbnSharedDeps__.TsLib},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/unifiedSearch/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/dataViews/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/charts/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/expressionGauge/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.KbnMonaco},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/unifiedFieldList/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/expressions/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/charts/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.EmotionCache},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/visualizations/common/utils");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/expressionGauge/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t){e.exports=__kbnSharedDeps__.KbnAnalytics},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/expressionMetricVis/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/fieldFormats/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/visualizations/common/convert_to_lens");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.ReactRouterDom},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/share/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/savedObjects/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/presentationUtil/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))}]);