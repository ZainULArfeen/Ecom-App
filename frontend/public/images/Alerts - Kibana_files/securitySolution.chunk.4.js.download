/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[4],{1003:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),s=n.n(a),o=n(17);const i=Object(a.memo)((({data:e})=>s.a.createElement(o.EuiText,{size:"s"},Object.entries(e).map((([e,t])=>s.a.createElement("div",{key:e,className:"eui-textBreakAll"},s.a.createElement("strong",null,e),": ",t))))));i.displayName="ObjectContent";const r=Object(a.memo)((({error:e,"data-test-subj":t})=>Object(a.useMemo)((()=>{let n=s.a.createElement(s.a.Fragment,null,e.message);var a,r;return function(e){return e instanceof Error&&("request"in e||"req"in e)&&"name"in e}(e)&&(n=s.a.createElement(s.a.Fragment,null,s.a.createElement("div",null,`${null===(a=e.response)||void 0===a?void 0:a.status}: ${null===(r=e.response)||void 0===r?void 0:r.statusText}`),e.body&&s.a.createElement(i,{data:e.body}))),s.a.createElement(o.EuiText,{"data-test-subj":t},n)}),[t,e])));r.displayName="FormattedError"},203:function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return g})),n.d(t,"f",(function(){return f}));var a=n(3),s=n(4),o=n.n(s),i=n(24),r=n.n(i);const l=n(6).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),c=r.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1v50emf-0"})(["color:",";"],(e=>e.theme.eui.euiColorMediumShade));c.displayName="EmptyWrapper";const u=()=>"â€”",d=()=>`(${l})`,m=()=>o.a.createElement(c,null,u()),p=()=>o.a.createElement(c,null,d()),g=e=>null==e?m():Object(a.isString)(e)&&""===e?p():o.a.createElement(o.a.Fragment,null,e),f=e=>null==e?m():""===e?p():o.a.createElement(o.a.Fragment,null,e)},204:function(e,t,n){"use strict";n.d(t,"g",(function(){return v.d})),n.d(t,"f",(function(){return v.c})),n.d(t,"m",(function(){return S})),n.d(t,"d",(function(){return k})),n.d(t,"h",(function(){return w})),n.d(t,"a",(function(){return F})),n.d(t,"c",(function(){return M})),n.d(t,"i",(function(){return N})),n.d(t,"e",(function(){return T})),n.d(t,"b",(function(){return R})),n.d(t,"j",(function(){return z})),n.d(t,"n",(function(){return U})),n.d(t,"o",(function(){return _})),n.d(t,"p",(function(){return H})),n.d(t,"l",(function(){return B})),n.d(t,"k",(function(){return q}));var a=n(53),s=n.n(a),o=n(17),i=n(4),r=n.n(i),l=n(3),c=n(1),u=n(432),d=n(260),m=n(99),p=n(19),g=n(292),f=n(6),b=n(460);const h=e=>f.i18n.translate("xpack.securitySolution.cases.caseTable.caseDetailsLinkAria",{values:{detailName:e},defaultMessage:"click to visit case with title {detailName}"});var E=n(9),y=n(507),v=n(540);const j=({children:e,Component:t,userName:n,isButton:a,onClick:s,title:o,userTab:l})=>{const u=encodeURIComponent(n),{formatUrl:m,search:g}=Object(d.l)(E.a.users),{navigateToApp:f}=Object(p.k)().services.application,b=Object(i.useCallback)((e=>{e.preventDefault(),f(c.A,{deepLinkId:E.a.users,path:l?Object(y.a)(u,l,g):Object(y.c)(u,g)})}),[u,f,g,l]),h=Object(i.useMemo)((()=>m(l?Object(y.a)(u,l):Object(y.c)(u))),[m,u,l]);return a?r.a.createElement(v.b,{Component:t,dataTestSubj:"data-grid-user-details",href:h,onClick:null!=s?s:b,title:null!=o?o:n},e||n):r.a.createElement(v.c,{"data-test-subj":"users-link-anchor",onClick:null!=s?s:b,href:h},e||n)},S=r.a.memo(j),O=({children:e,Component:t,hostName:n,isButton:a,onClick:s,title:o,hostTab:l})=>{const{formatUrl:u,search:m}=Object(d.l)(E.a.hosts),{navigateToApp:g}=Object(p.k)().services.application,f=encodeURIComponent(n),b=Object(i.useCallback)((e=>{e.preventDefault(),g(c.A,{deepLinkId:E.a.hosts,path:l?Object(d.i)(f,l,m):Object(d.d)(f,m)})}),[f,g,m,l]),h=Object(i.useMemo)((()=>u(l?Object(d.i)(f,l):Object(d.d)(f))),[u,f,l]);return a?r.a.createElement(v.b,{Component:t,dataTestSubj:"data-grid-host-details",href:h,iconType:"expand",onClick:null!=s?s:b,title:null!=o?o:n},e):r.a.createElement(v.c,{onClick:null!=s?s:b,href:h,"data-test-subj":"host-details-button"},e||n)},k=r.a.memo(O),x=["http://","https://"],C=r.a.memo((({url:e,children:t,idx:n,overflowIndexStart:a=5,allItemsLimit:s=5})=>{const i=a-1,c=s-1,u=Math.max(0,Math.min(i,c)),d=x.some((t=>0===e.indexOf(t)));return e&&d&&!Object(g.c)(e)&&t?r.a.createElement(o.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiLink,{href:e,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t),!Object(l.isNil)(n)&&n<u&&r.a.createElement(v.a,{"data-test-subj":"externalLinkComma"}))):null}));C.displayName="ExternalLink";const I=({Component:e,children:t,ip:n,flowTarget:a=m.a.source,isButton:s,onClick:o,title:c})=>{const p=_(),g=Object(i.useCallback)(((n,i)=>{const{onClick:l,href:m}=p({deepLinkId:E.a.network,path:Object(d.f)(encodeURIComponent(Object(u.d)(n)),a)}),g=null!=o?o:e=>l(e);return s?r.a.createElement(v.b,{Component:e,key:`${n}-${i}`,dataTestSubj:"data-grid-network-details",onClick:g,href:m,title:null!=c?c:n},t):r.a.createElement(v.c,{key:`${n}-${i}`,onClick:g,href:m,"data-test-subj":"network-details"},t||n)}),[t,e,a,p,o,s,c]);return Object(l.isArray)(n)?r.a.createElement(r.a.Fragment,null,n.map(g)):g(n,0)},w=r.a.memo(I),A=({children:e,detailName:t,title:n})=>{const{formatUrl:a,search:s}=Object(d.l)(E.a.case),{navigateToApp:o}=Object(p.k)().services.application,l=Object(i.useCallback)((async e=>(e.preventDefault(),o(c.A,{deepLinkId:E.a.case,path:Object(d.a)({id:t,search:s})}))),[t,o,s]);return r.a.createElement(v.c,{onClick:l,href:a(Object(d.a)({id:t})),"data-test-subj":"case-details-link","aria-label":h(null!=n?n:t)},e||t)},F=r.a.memo(A);F.displayName="CaseDetailsLink",r.a.memo((({children:e})=>{const{formatUrl:t,search:n}=Object(d.l)(E.a.case),{navigateToApp:a}=Object(p.k)().services.application,s=Object(i.useCallback)((async e=>(e.preventDefault(),a(c.A,{deepLinkId:E.a.case,path:Object(d.b)(n)}))),[a,n]);return r.a.createElement(v.c,{onClick:s,href:t(Object(d.b)())},e)})).displayName="CreateCaseLink";const M=r.a.memo((({children:e,link:t})=>{const n=Object(i.useMemo)((()=>`https://www.google.com/search?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(C,{url:n},e||t)}));M.displayName="GoogleLink";const N=r.a.memo((({Component:e,title:t,children:n,portOrServiceName:a})=>{var s;const l=Object(i.useMemo)((()=>`https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=${encodeURIComponent(String(a))}`),[a]);return e?r.a.createElement(e,{href:l,"data-test-subj":"data-grid-port-or-service-name-link",title:t,iconType:"link"},null!==(s=null!=t?t:n)&&void 0!==s?s:a):r.a.createElement(v.e,null,r.a.createElement(o.EuiLink,{"data-test-subj":"port-or-service-name-link",href:l,target:"_blank"},n||a))}));N.displayName="PortOrServiceNameLink";const T=r.a.memo((({children:e,ja3Fingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ja3-fingerprints/${encodeURIComponent(t)}`),[t]);return r.a.createElement(o.EuiLink,{"data-test-subj":"ja3-fingerprint-link",href:n,target:"_blank"},e||t)}));T.displayName="Ja3FingerprintLink";const R=r.a.memo((({children:e,certificateFingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ssl-certificates/sha1/${encodeURIComponent(t)}`),[t]);return r.a.createElement(o.EuiLink,{"data-test-subj":"certificate-fingerprint-link",href:n,target:"_blank"},e||t)}));var P;function L(e){return e===P["virustotal.com"]||e===P["talosIntelligence.com"]}R.displayName="CertificateFingerprintLink",function(e){e["virustotal.com"]="virustotal.com",e["talosIntelligence.com"]="talosIntelligence.com"}(P||(P={}));const D={[P["virustotal.com"]]:b.m,[P["talosIntelligence.com"]]:b.l},$=({overflowIndexStart:e=5,allItemsLimit:t=5,showDomain:n=!1,domain:a,direction:s="row"})=>{const[u]=Object(p.q)(c.Mb),d=Object(i.useMemo)((()=>null==u?void 0:u.slice(0,t).filter((({url_template:e,name:t})=>!Object(l.isNil)(e)&&!Object(l.isNil)(t)&&!Object(g.c)(e))).map((({name:e,url_template:t})=>({name:L(e)?D[e]:e,url_template:t.replace("{{ip}}",encodeURIComponent(a))})))),[u,a,D,t]),m=Object(i.useCallback)((n=>{var s;return(e=>void 0!==e.url_template&&void 0!==e.name)(n)&&r.a.createElement(C,{url:n.url_template,overflowIndexStart:e,allItemsLimit:t},r.a.createElement(r.a.Fragment,null,null!==(s=n.name)&&void 0!==s?s:a))}),[t,a,e]);return(null==d?void 0:d.length)>0?r.a.createElement("section",null,r.a.createElement(o.EuiFlexGroup,{gutterSize:"none",justifyContent:"center",direction:s,alignItems:"center","data-test-subj":"reputationLinkGroup"},r.a.createElement(o.EuiFlexItem,{grow:!0},null==d?void 0:d.slice(0,e).map((({name:t,url_template:s},o)=>r.a.createElement(C,{allItemsLimit:d.length,idx:o,overflowIndexStart:e,url:s,"data-test-subj":"externalLinkComponent",key:`reputationLink-${o}`},r.a.createElement(r.a.Fragment,null,n?a:null!=t?t:a))))),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(v.f,{rowItems:d,render:m,moreMaxHeight:"200px",overflowIndexStart:e})))):null};$.displayName="ReputationLinkComponent";const z=r.a.memo($),U=r.a.memo((({children:e,domain:t})=>{const n=Object(i.useMemo)((()=>`https://www.iana.org/whois?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(C,{url:n},e||t)}));U.displayName="WhoIsLink";const _=()=>{const e=Object(d.m)(),{navigateTo:t}=Object(p.l)();return Object(i.useCallback)((({deepLinkId:n,path:a,onClick:s})=>{const o=e({deepLinkId:n,path:a});return{href:o,onClick:e=>{var n;(n=e).metaKey||n.altKey||n.ctrlKey||n.shiftKey||(e.preventDefault(),t({url:o}),s&&s(e))}}}),[e,t])},H=e=>({deepLinkId:t,path:n,onClick:a,...o})=>{const i=_(),{onClick:l,href:c}=i({deepLinkId:t,path:n,onClick:a});return r.a.createElement(e,s()({onClick:l,href:c},o))},B=H(v.d),q=H(v.c)},209:function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"k",(function(){return i})),n.d(t,"n",(function(){return r})),n.d(t,"q",(function(){return l})),n.d(t,"m",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"p",(function(){return m})),n.d(t,"s",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return f})),n.d(t,"g",(function(){return b})),n.d(t,"r",(function(){return h})),n.d(t,"u",(function(){return E})),n.d(t,"v",(function(){return y})),n.d(t,"t",(function(){return v})),n.d(t,"f",(function(){return j})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return O})),n.d(t,"e",(function(){return k})),n.d(t,"d",(function(){return x})),n.d(t,"a",(function(){return C}));var a=n(1),s=n(381);const o=`${a.Pb}/:tabName(${s.a.endpoints})`,i=`${a.Pb}/:tabName(${s.a.policies})`,r=`${a.Pb}/:tabName(${s.a.policies})/:policyId/settings`,l=`${a.Pb}/:tabName(${s.a.policies})/:policyId/trustedApps`,c=`${a.Pb}/:tabName(${s.a.policies})/:policyId/eventFilters`,u=`${a.Pb}/:tabName(${s.a.policies})/:policyId/hostIsolationExceptions`,d=`${a.Pb}/:tabName(${s.a.policies})/:policyId/blocklists`,m=`${a.Pb}/:tabName(${s.a.policies})/:policyId`,p=`${a.Pb}/:tabName(${s.a.trustedApps})`,g=`${a.Pb}/:tabName(${s.a.eventFilters})`,f=`${a.Pb}/:tabName(${s.a.hostIsolationExceptions})`,b=`${a.Pb}/:tabName(${s.a.blocklist})`,h=`${a.Pb}/:tabName(${s.a.responseActionsHistory})`,E="management",y="policyDetails",v="endpoints",j=[10,20,50],S=0,O=10,k="desc",x="created_at",C=1e4},211:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return h}));var a=n(69),s=n.n(a),o=n(4),i=n.n(o),r=n(175),l=n(19),c=n(203),u=n(732),d=n(89);const m=i.a.memo((({value:e,dateFormat:t=Object(l.h)()})=>i.a.createElement(i.a.Fragment,null,s.a.tz(e,Object(l.n)()).format(t))));m.displayName="PreferenceFormattedDate";const p=({value:e})=>{if(null==e)return Object(c.f)(e);const t=Object(d.a)(e);if(!t.isValid())return Object(c.f)(e);const n=t.toDate();return i.a.createElement(m,{value:n})};p.displayName="PreferenceFormattedDateFromPrimitive";const g=e=>Array.isArray(e)&&"P1DT"===e[0]&&2===e.length,f=i.a.memo((({value:e})=>{const[t]=Object(l.q)("dateFormat:scaled"),n=Array.isArray(t)?t.find(g):null,a=Array.isArray(n)&&2===n.length?n[1]:"YYYY-MM-DD";return i.a.createElement(m,{dateFormat:a,value:e})}));f.displayName="PreferenceFormattedP1DTDate";const b=i.a.memo((({value:e,fieldName:t,className:n="",dateFormat:a})=>{if(null==e)return Object(c.f)(e);const s=Object(d.a)(e);return s.isValid()?i.a.createElement(u.a,{date:s.toDate(),fieldName:t,className:n},i.a.createElement(m,{value:s.toDate(),dateFormat:a})):Object(c.f)(e)}));b.displayName="FormattedDate";const h=i.a.memo((({value:e,dateFormat:t,tooltipFieldName:n,tooltipAnchorClassName:a,relativeThresholdInHrs:o=1})=>{if(null==e)return Object(c.f)(e);const l=Object(d.a)(e);if(!l.isValid())return Object(c.f)(e);const p=l.toDate(),g=s()(p).add(o,"hours").isBefore(new Date);return i.a.createElement(u.a,{date:p,fieldName:n,className:a},g?i.a.createElement(m,{"data-test-subj":"preference-time",value:p,dateFormat:t}):i.a.createElement(r.FormattedRelative,{"data-test-subj":"relative-time",value:p}))}));h.displayName="FormattedRelativePreferenceDate"},226:function(e,t,n){"use strict";let a,s,o,i,r,l;n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return l})),function(e){e.windows="windows",e.mac="mac",e.linux="linux"}(a||(a={})),function(e){e.is="is",e.matches="matches"}(s||(s={})),function(e){e.enrolled="enrolled",e.unenrolled="unenrolled"}(o||(o={})),function(e){e.UNHEALTHY="unhealthy",e.HEALTHY="healthy",e.OFFLINE="offline",e.UPDATING="updating",e.INACTIVE="inactive",e.UNENROLLED="unenrolled"}(i||(i={})),function(e){e.detect="detect",e.prevent="prevent",e.off="off"}(r||(r={})),function(e){e.success="success",e.failure="failure",e.warning="warning",e.unsupported="unsupported"}(l||(l={}))},252:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return l}));var a=n(276);const s=e=>`${Object(a.a)(e)}`,o=e=>`${Object(a.a)(e)}`,i=(e,t)=>`/id/${e}${Object(a.a)(t)}`,r=(e,t,n)=>`/id/${e}/${t}${Object(a.a)(n)}`,l=(e,t)=>`/id/${e}/edit${Object(a.a)(t)}`},260:function(e,t,n){"use strict";n.d(t,"c",(function(){return c.a})),n.d(t,"h",(function(){return c.d})),n.d(t,"d",(function(){return u.a})),n.d(t,"i",(function(){return u.b})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return p.b})),n.d(t,"f",(function(){return p.a})),n.d(t,"j",(function(){return g})),n.d(t,"k",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return h})),n.d(t,"l",(function(){return E})),n.d(t,"m",(function(){return y}));var a=n(3),s=n(4),o=n(315),i=n(380),r=n(100),l=n(58),c=n(252),u=n(368),d=(n(1),n(276));const m=(e,t)=>`/${e}${Object(d.a)(t)}`;var p=n(539);const g=(e,t)=>`/${e}${Object(d.a)(t)}`,f=(e,t)=>`?timeline=(id:'${e}',isOpen:!t${Object(a.isEmpty)(t)?")":`,graphEventId:'${t}')`}`,b=({id:e,search:t})=>`/${encodeURIComponent(e)}${Object(d.a)(null!=t?t:void 0)}`,h=e=>`/create${Object(d.a)(null!=e?e:void 0)}`,E=e=>{const{getAppUrl:t}=Object(r.b)(),n=(e=>{const t=Object(o.a)();return Object(s.useMemo)((()=>Object(i.a)(e,t)),[t,e])})(e);return{formatUrl:Object(s.useCallback)(((a,{absolute:s=!1,skipSearch:o=!1}={})=>{const i=v(a,n,o);return t({deepLinkId:e,path:i,absolute:s})}),[t,e,n]),search:n}},y=()=>{const{getAppUrl:e}=Object(r.b)(),t=(()=>{const e=Object(o.a)();return Object(s.useCallback)((()=>e.length>0?`?${e}`:""),[e])})();return Object(s.useCallback)((({deepLinkId:n,path:a="",absolute:s=!1,skipSearch:o=!1})=>{const i=v(a,Object(l.e)(n)?t():"",o);return e({deepLinkId:n,path:i,absolute:s})}),[e,t])};function v(e,t,n){const[s,o]=e.split("?");return`${s}${n?Object(a.isEmpty)(o)?"":`?${o}`:Object(a.isEmpty)(o)?t:`?${o}${Object(a.isEmpty)(t)?"":`&${t}`}`}`}},276:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(3);const s=e=>Object(a.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`},292:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(3);const s=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},o=["http:","https:"],i=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(o.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0};function r(e){return Object(a.isNumber)(e)||!Object(a.isEmpty)(e)}},294:function(e,t,n){"use strict";let a,s,o;n.r(t),n.d(t,"NetworkType",(function(){return a})),n.d(t,"NetworkTableType",(function(){return s})),n.d(t,"NetworkDetailsTableType",(function(){return o})),function(e){e.page="page",e.details="details"}(a||(a={})),function(e){e.alerts="alerts",e.dns="dns",e.http="http",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.tls="tls",e.anomalies="anomalies"}(s||(s={})),function(e){e.http="http",e.tls="tls",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.users="users",e.anomalies="anomalies"}(o||(o={}))},303:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4),s=n(431),o=n(62);function i(){const{search:e}=Object(o.useLocation)();return Object(a.useMemo)((()=>{const t=Object(s.parse)(e);return{urlParams:t,toUrlParams:(e=t)=>Object(s.stringify)(e)}}),[e])}},362:function(e,t,n){"use strict";n.d(t,"d",(function(){return E})),n.d(t,"c",(function(){return y})),n.d(t,"e",(function(){return v})),n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return x}));var a=n(4),s=n.n(a),o=n(17),i=n(175),r=n(6);const l=r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.cancel",{defaultMessage:"Cancel"}),c=r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.confirm",{defaultMessage:"Confirm"}),u=r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment",{defaultMessage:"Comment"}),d=r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment.placeholder",{defaultMessage:"You may leave an optional note here."}),m=e=>r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolation.successfulMessage",{defaultMessage:"Isolation on host {hostName} successfully submitted",values:{hostName:e}}),p=e=>r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.unisolate.successfulMessage",{defaultMessage:"Release on host {hostName} successfully submitted",values:{hostName:e}}),g=r.i18n.translate("xpack.securitySolution.endpoint.hostisolation.unisolate",{defaultMessage:"release"}),f=r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolated",{defaultMessage:"isolated"});var b=n(963),h=n(204);const E=Object(a.memo)((({hostName:e,alertId:t,isolateAction:n="isolateHost",additionalInfo:r})=>s.a.createElement(o.EuiCallOut,{iconType:"check",color:"success",title:"isolateHost"===n?m(e):p(e),"data-test-subj":"isolateHost"===n?"hostIsolateSuccessMessage":"hostUnisolateSuccessMessage"},void 0!==t?(({alertIdForCase:e})=>{const{casesInfo:t}=Object(b.a)({alertId:e}),n=Object(a.useMemo)((()=>t.length),[t]),r=Object(a.useMemo)((()=>t.map(((e,t)=>s.a.createElement("li",{key:e.id},s.a.createElement(h.a,{detailName:e.id},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.placeholderCase",defaultMessage:"{caseName}",values:{caseName:e.title}})))))),[t]);return s.a.createElement(s.a.Fragment,null,n>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.successfulIsolation.cases",defaultMessage:"This action has been attached to the following {caseCount, plural, one {case} other {cases}}:",values:{caseCount:n}}))),s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("ul",null,r))))})({alertIdForCase:t}):r)));E.displayName="EndpointIsolateSuccess";const y=Object(a.memo)((({hostName:e,onCancel:t,onConfirm:n,onChange:r,comment:m="",messageAppend:p,isLoading:g=!1})=>{const f=Object(a.useCallback)((e=>{r({comment:e.target.value})}),[r]);return s.a.createElement(o.EuiForm,{"data-test-subj":"endpointHostIsolationForm"},s.a.createElement(o.EuiFormRow,{fullWidth:!0},s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHost",defaultMessage:"Isolate host {hostName} from network.",values:{hostName:s.a.createElement("b",null,e)}}),s.a.createElement("br",null)),s.a.createElement("p",null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHostAbout",defaultMessage:"Isolating a host will disconnect it from the network. The host will only be able to communicate with the Kibana platform."})," ",p))),s.a.createElement(o.EuiFormRow,{label:u,fullWidth:!0},s.a.createElement(o.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:m,onChange:f})),s.a.createElement(o.EuiFormRow,{fullWidth:!0},s.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiButtonEmpty,{onClick:t,disabled:g,"data-test-subj":"hostIsolateCancelButton"},l)),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiButton,{fill:!0,onClick:n,disabled:g,isLoading:g,"data-test-subj":"hostIsolateConfirmButton"},c)))))}));y.displayName="EndpointIsolateForm";const v=Object(a.memo)((({hostName:e,onCancel:t,onConfirm:n,onChange:r,comment:m="",messageAppend:p,isLoading:b=!1})=>{const h=Object(a.useCallback)((e=>{r({comment:e.target.value})}),[r]);return s.a.createElement(o.EuiForm,{"data-test-subj":"endpointHostIsolationForm"},s.a.createElement(o.EuiFormRow,{fullWidth:!0},s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.unIsolateThisHost",defaultMessage:"{hostName} is currently {isolated}. Are you sure you want to {unisolate} this host?",values:{hostName:s.a.createElement("b",null,e),isolated:s.a.createElement("b",null,f),unisolate:s.a.createElement("b",null,g)}})," ",p))),s.a.createElement(o.EuiFormRow,{label:u,fullWidth:!0},s.a.createElement(o.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:m,onChange:h})),s.a.createElement(o.EuiFormRow,{fullWidth:!0},s.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiButtonEmpty,{onClick:t,disabled:b,"data-test-subj":"hostIsolateCancelButton"},l)),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiButton,{fill:!0,onClick:n,disabled:b,isLoading:b},c)))))}));v.displayName="EndpointUnisolateForm";var j=n(206),S=n(238);const O=Object(a.memo)((({"data-test-subj":e,pendingActions:t})=>s.a.createElement(o.EuiBadge,{color:"hollow","data-test-subj":e},s.a.createElement(o.EuiToolTip,{display:"block",anchorClassName:"eui-textTruncate",content:s.a.createElement("div",{style:{width:150},"data-test-subj":`${e}-tooltipContent`},s.a.createElement("div",null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingActions",defaultMessage:"Pending actions:"})),!!t.pendingIsolate&&s.a.createElement(o.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingIsolate",defaultMessage:"Isolate"})),s.a.createElement(o.EuiFlexItem,{grow:!1},t.pendingIsolate)),!!t.pendingUnIsolate&&s.a.createElement(o.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingUnIsolate",defaultMessage:"Release"})),s.a.createElement(o.EuiFlexItem,{grow:!1},t.pendingUnIsolate)),!!t.pendingKillProcess&&s.a.createElement(o.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingKillProcess",defaultMessage:"Kill process"})),s.a.createElement(o.EuiFlexItem,{grow:!1},t.pendingKillProcess)),!!t.pendingSuspendProcess&&s.a.createElement(o.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingSuspendProcess",defaultMessage:"Suspend process"})),s.a.createElement(o.EuiFlexItem,{grow:!1},t.pendingSuspendProcess)),!!t.pendingRunningProcesses&&s.a.createElement(o.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingRunningProcesses",defaultMessage:"Processes"})),s.a.createElement(o.EuiFlexItem,{grow:!1},t.pendingRunningProcesses)))},s.a.createElement(o.EuiTextColor,{color:"subdued","data-test-subj":`${e}-pending`},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.multiplePendingActions",defaultMessage:"{count} {count, plural, one {action} other {actions}} pending",values:{count:Object.values(t).reduce(((e,t)=>e+t),0)}}))))));O.displayName="AgentPendingActionStatusBadge";const k=Object(a.memo)((({isIsolated:e,pendingActions:t,"data-test-subj":n})=>{const r=Object(j.a)(n),l=Object(S.a)("disableIsolationUIPendingStatuses"),{pendingIsolate:c=0,pendingUnIsolate:u=0,pendingKillProcess:d=0,pendingSuspendProcess:m=0,pendingRunningProcesses:p=0}=t,g=Object(a.useRef)(!1),f=Object(a.useRef)(!1),b=Object(a.useMemo)((()=>c+u+d+m+p),[c,d,p,m,u]),h=Object(a.useMemo)((()=>Object.values(t).reduce(((e,t)=>t>0?e+1:e),0)>1),[t]);return Object(a.useEffect)((()=>{g.current=0===c&&u>0,f.current=c>0&&0===u}),[c,u]),Object(a.useMemo)((()=>{if(l)return e?s.a.createElement(o.EuiBadge,{color:"hollow","data-test-subj":n},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isolated",defaultMessage:"Isolated"})):null;if(0===b){if(!f.current&&g.current||!e)return null;if(!e&&f.current&&!g.current||e)return s.a.createElement(o.EuiBadge,{color:"hollow","data-test-subj":n},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isolated",defaultMessage:"Isolated"}))}return h||!c&&!u?s.a.createElement(O,{"data-test-subj":n,pendingActions:t}):s.a.createElement(o.EuiBadge,{color:"hollow","data-test-subj":n},s.a.createElement(o.EuiTextColor,{color:"subdued","data-test-subj":r("pending")},c?s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isIsolating",defaultMessage:"Isolating"}):s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isUnIsolating",defaultMessage:"Releasing"})))}),[l,b,h,c,u,n,r,e,t])}));k.displayName="EndpointHostIsolationStatus";const x=s.a.memo((({onClick:e,buttonText:t})=>{const n=Object(a.useCallback)((()=>e()),[e]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiFlexGroup,{gutterSize:"none",justifyContent:"flexEnd"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiButtonEmpty,{flush:"right",onClick:n,"data-test-subj":"hostIsolateSuccessCompleteButton"},s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,t))))))}));x.displayName="ActionCompletionReturnButton"},368:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n(1);var a=n(276);const s=(e,t)=>`/${e}${Object(a.a)(t)}`,o=(e,t)=>`/name/${e}${Object(a.a)(t)}`,i=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`},381:function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.endpoints="endpoints",e.policies="policy",e.trustedApps="trusted_apps",e.eventFilters="event_filters",e.hostIsolationExceptions="host_isolation_exceptions",e.blocklist="blocklist",e.responseActionsHistory="response_actions_history"}(a||(a={}))},384:function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),n(294).NetworkType.details,function(e){e.anomalies="anomalies",e.flows="flows",e.tls="tls",e.http="http",e.events="events",e.users="users"}(a||(a={}))},395:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(6);const s=Object.freeze({hasExpired:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hasExpired",{defaultMessage:"{command} failed: action expired",values:{command:e}}),wasSuccessful:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.wasSuccessful",{defaultMessage:"{command} completed successfully",values:{command:e}}),isPending:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.isPending",{defaultMessage:"{command} is pending",values:{command:e}}),hasFailed:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hasFailed",{defaultMessage:"{command} failed",values:{command:e}}),expandSection:{placedAt:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.placedAt",{defaultMessage:"Command placed"}),input:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.input",{defaultMessage:"Input"}),output:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.output",{defaultMessage:"Output"}),startedAt:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.startedAt",{defaultMessage:"Execution started on"}),parameters:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.parameters",{defaultMessage:"Parameters"}),completedAt:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.completedAt",{defaultMessage:"Execution completed"})}}),o=Object.freeze({time:a.i18n.translate("xpack.securitySolution.responseActionsList.list.time",{defaultMessage:"Time"}),command:a.i18n.translate("xpack.securitySolution.responseActionsList.list.command",{defaultMessage:"Command"}),user:a.i18n.translate("xpack.securitySolution.responseActionsList.list.user",{defaultMessage:"User"}),hosts:a.i18n.translate("xpack.securitySolution.responseActionsList.list.hosts",{defaultMessage:"Hosts"}),comments:a.i18n.translate("xpack.securitySolution.responseActionsList.list.comments",{defaultMessage:"Comments"}),status:a.i18n.translate("xpack.securitySolution.responseActionsList.list.status",{defaultMessage:"Status"})}),i=Object.freeze({flyoutTitle:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.flyout.title",{defaultMessage:"Response actions history : {hostname}",values:{hostname:e}}),pageSubTitle:a.i18n.translate("xpack.securitySolution.responseActionsList.list.pageSubTitle",{defaultMessage:"View the history of response actions performed on hosts."}),fetchError:a.i18n.translate("xpack.securitySolution.responseActionsList.list.errorMessage",{defaultMessage:"Error while retrieving response actions"}),filterClearAll:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.clearAll",{defaultMessage:"Clear all"}),filterSearchPlaceholder:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.searchPlaceholder",{defaultMessage:"Search {filterName}",values:{filterName:e}}),filterEmptyMessage:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.emptyMessage",{defaultMessage:"No {filterName} available",values:{filterName:e}}),badge:{successful:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.badge.successful",{defaultMessage:"Successful"}),failed:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.badge.failed",{defaultMessage:"Failed"}),pending:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.badge.pending",{defaultMessage:"Pending"})},unenrolled:{hosts:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hosts.unenrolled.hosts",{defaultMessage:"Hosts unenrolled"}),host:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hosts.unenrolled.host",{defaultMessage:"Host unenrolled"})},screenReaderExpand:a.i18n.translate("xpack.securitySolution.responseActionsList.list.screenReader.expand",{defaultMessage:"Expand rows"}),recordsLabel:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.recordRangeLabel",{defaultMessage:"{records, plural, one {response action} other {response actions}}",values:{records:e}})}),r=Object.freeze({actions:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.actions",{defaultMessage:"Actions"}),hosts:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.Hosts",{defaultMessage:"Hosts"}),statuses:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.statuses",{defaultMessage:"Statuses"}),users:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.users",{defaultMessage:"Filter by username"})})},432:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(3);const s=e=>e.replace(/:/g,"-"),o=e=>e.replace(/-/g,":"),i=e=>Object(a.isUndefined)(e)?void 0:Object(a.castArray)(e),r="51px"},434:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return l}));var a=n(4),s=n(62),o=n(209),i=n(303);const r=e=>{var t,n,a;const s={pageSize:o.c,page:1};return s.page=Number(null!==(t=Array.isArray(e.page)?e.page[e.page.length-1]:e.page)&&void 0!==t?t:s.page),s.pageSize=null!==(n=Number(null!==(a=Array.isArray(e.pageSize)?e.pageSize[e.pageSize.length-1]:e.pageSize)&&void 0!==a?a:s.pageSize))&&void 0!==n?n:s.pageSize,(!Number.isFinite(s.page)||s.page<1)&&(s.page=1),o.f.includes(s.pageSize)||(s.pageSize=o.c),s},l=()=>{const e=Object(s.useLocation)(),t=Object(s.useHistory)(),{urlParams:n,toUrlParams:l}=Object(i.a)(),c=Object(a.useMemo)((()=>r(n)),[n]),[u,d]=Object(a.useState)(c),m=Object(a.useCallback)((({pageSize:a,page:s})=>{t.push({...e,search:l({...n,page:s,pageSize:a})})}),[t,e,l,n]);return Object(a.useEffect)((()=>{d((e=>({...e,...r(n)})))}),[d,n]),{pagination:u,setPagination:m,pageSizeOptions:[...o.f]}}},460:function(e,t,n){"use strict";n.d(t,"i",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"j",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"o",(function(){return d})),n.d(t,"n",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return g})),n.d(t,"l",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return h})),n.d(t,"g",(function(){return E}));var a=n(6);const s=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.locationTitle",{defaultMessage:"Location"}),o=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.autonomousSystemTitle",{defaultMessage:"Autonomous system"}),i=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),r=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),l=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),c=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostIdTitle",{defaultMessage:"Host ID"}),u=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostNameTitle",{defaultMessage:"Host name"}),d=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.whoIsTitle",{defaultMessage:"WhoIs"}),m=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewWhoisTitle",{defaultMessage:"iana.org"}),p=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.ipReputationTitle",{defaultMessage:"Reputation"}),g=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewVirusTotalTitle.",{defaultMessage:"virustotal.com"}),f=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewTalosIntelligenceTitle",{defaultMessage:"talosIntelligence.com"}),b=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asSourceDropDownOptionLabel",{defaultMessage:"As Source"}),h=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asDestinationDropDownOptionLabel",{defaultMessage:"As Destination"}),E=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.inspectTitle",{defaultMessage:"IP overview"})},507:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var a=n(276);const s=(e,t)=>`/name/${e}${Object(a.a)(t)}`,o=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`,i=(e,t)=>`/${e}${Object(a.a)(t)}`},518:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),s=n.n(a),o=n(17),i=n(24);const r=n.n(i)()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1wriy1f-0"})(["min-height:calc(100vh - 140px);"]),l=Object(a.memo)((({children:e,"data-test-subj":t})=>s.a.createElement(r,{direction:"column",alignItems:"center","data-test-subj":t},s.a.createElement(o.EuiPageTemplate_Deprecated,{template:"centeredContent"},e))));l.displayName="ManagementEmptyStateWrapper"},526:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return fe})),n.d(t,"a",(function(){return be}));var a=n(218),s=n(538),o=n(19),i=n(288);const r=(e,t={})=>{const n=Object(o.j)();return Object(a.useQuery)({queryKey:["get-endpoint-host-info",e],...t,queryFn:()=>n.get(Object(s.a)(i.f,{id:e.trim()||"undefined"}))})};var l=n(4),c=n.n(l),u=n(6),d=n(235),m=n(537),p=n(17),g=n(175);const f=Object.freeze({"ra_suspend-process_error_not-found":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.suspendProcess.notFoundError",{defaultMessage:"The provided process was not found"}),"ra_suspend-process_error_not-permitted":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.suspendProcess.notPermittedSuccess",{defaultMessage:"The provided process cannot be suspended"}),"ra_kill-process_error_not-found":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.killProcess.notFoundError",{defaultMessage:"The provided process was not found"}),"ra_kill-process_success_no-action":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.killProcess.noActionSuccess",{defaultMessage:"Action completed. The provided process was not found or already killed"}),"ra_kill-process_error_not-permitted":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.killProcess.notPermittedSuccess",{defaultMessage:"The provided process cannot be killed"})}),b=Object(l.memo)((({action:e})=>Object(l.useMemo)((()=>{if(!e.isCompleted||e.wasSuccessful)return null;const t=[];if(e.outputs)for(const n of e.agents){const a=e.outputs[n];a&&"json"===a.type&&a.content.code&&f[a.content.code]&&t.push(f[a.content.code])}return t.length||(e.errors?t.push(...e.errors):t.push(u.i18n.translate("xpack.securitySolution.endpointActionFailureMessage.unknownFailure",{defaultMessage:"Action failed"}))),c.a.createElement(c.a.Fragment,null,c.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.actionError.errorMessage",defaultMessage:"The following { errorCount, plural, =1 {error was} other {errors were}} encountered:",values:{errorCount:t.length}}),c.a.createElement(p.EuiSpacer,{size:"s"}),c.a.createElement("div",null,t.join(" | ")))}),[e])));b.displayName="EndpointActionFailureMessage";const h=Object(l.memo)((({title:e,dataTestSubj:t,action:n,ResultComponent:a})=>c.a.createElement(a,{showAs:"failure",title:e,"data-test-subj":t},c.a.createElement(b,{action:n}))));h.displayName="ActionError";var E=n(566);const y=(e,t={})=>{const n=Object(o.j)();return Object(a.useQuery)({queryKey:["get-action-details",e],...t,queryFn:()=>n.get(Object(s.a)(i.a,{action_id:e.trim()||"undefined"}))})},v=3e3,j=({actionRequestApi:e,actionRequest:t,command:n,endpointId:a,setStatus:s,setStore:o,isPending:i})=>{var r,c;const u=Object(E.a)(),d=Boolean(null==t?void 0:t.requestSent),{data:m}=y(null!==(r=null==t?void 0:t.actionId)&&void 0!==r?r:"-",{enabled:Boolean(null==t?void 0:t.actionId)&&i,refetchInterval:!!i&&v}),p=Object(l.useRef)(!1);p.current=u,Object(l.useEffect)((()=>{if(!d&&a&&u){var t,s;const i={requestSent:!0,actionId:void 0};e.mutateAsync({endpoint_ids:[a],comment:null===(t=n.args.args)||void 0===t||null===(s=t.comment)||void 0===s?void 0:s[0]}).then((e=>{i.actionId=e.data.id,p.current&&o((e=>({...e,actionRequest:{...i}})))})),o((e=>({...e,actionRequest:i})))}}),[e,d,null===(c=n.args.args)||void 0===c?void 0:c.comment,a,u,o]),Object(l.useEffect)((()=>(p.current=u,()=>{p.current=!1})),[u]),Object(l.useEffect)((()=>{null!=m&&m.data.isCompleted&&i&&(s("success"),o((e=>({...e,completedActionDetails:m.data}))))}),[null==m?void 0:m.data,null==m?void 0:m.data.isCompleted,s,o,i])},S=Object(l.memo)((({command:e,setStore:t,store:n,status:s,setStatus:o,ResultComponent:i})=>{var r,l;const u=null===(r=e.commandDefinition)||void 0===r||null===(l=r.meta)||void 0===l?void 0:l.endpointId,{completedActionDetails:d,actionRequest:p}=n,g="pending"===s,f=Object(a.useMutation)((e=>Object(m.a)(e)),undefined);return j({actionRequestApi:f,actionRequest:p,command:e,endpointId:u,setStatus:o,setStore:t,isPending:g}),g?c.a.createElement(i,{showAs:"pending"}):null!=d&&d.errors?c.a.createElement(h,{dataTestSubj:"isolateErrorCallout",action:d,ResultComponent:i}):c.a.createElement(i,{showAs:"success","data-test-subj":"isolateSuccessCallout"})}));S.displayName="IsolateActionResult";const O=Object(l.memo)((({command:e,setStore:t,store:n,status:s,setStatus:o,ResultComponent:i})=>{var r,l;const u=null===(r=e.commandDefinition)||void 0===r||null===(l=r.meta)||void 0===l?void 0:l.endpointId,{completedActionDetails:d,actionRequest:p}=n,g="pending"===s,f=Object(a.useMutation)((e=>Object(m.b)(e)),undefined);return j({actionRequestApi:f,actionRequest:p,command:e,endpointId:u,setStatus:o,setStore:t,isPending:g}),g?c.a.createElement(i,{showAs:"pending"}):null!=d&&d.errors?c.a.createElement(h,{dataTestSubj:"releaseErrorCallout",action:d,ResultComponent:i}):c.a.createElement(i,{"data-test-subj":"releaseSuccessCallout"})}));O.displayName="ReleaseActionResult";const k=e=>e.pid?{pid:Number(e.pid[0])}:e.entityId?{entity_id:e.entityId[0]}:void 0;var x=n(53),C=n.n(x);const I=Object(l.memo)((({action:e,ResultComponent:t,title:n,...a})=>{const s=Object(l.useMemo)((()=>{var t,a,s;if(n)return n;const o=e.agents[0],i=null===(t=e.outputs)||void 0===t||null===(a=t[o])||void 0===a||null===(s=a.content)||void 0===s?void 0:s.code;return i?f[i]:void 0}),[n,e.agents,e.outputs]);return c.a.createElement(t,C()({},a,{title:s}))}));I.displayName="ActionSuccess";const w=Object(l.memo)((({command:e,setStore:t,store:n,status:s,setStatus:r,ResultComponent:u})=>{var d,m;const p=null===(d=e.commandDefinition)||void 0===d||null===(m=d.meta)||void 0===m?void 0:m.endpointId,{actionId:f,completedActionDetails:b,apiError:E}=n,j="pending"===s,S="error"===s,O=Boolean(n.actionRequestSent),{mutate:x,data:C,isSuccess:w,error:A}=Object(a.useMutation)((e=>{return t=e,o.b.get().http.post(i.i,{body:JSON.stringify(t)});var t}),M),{data:F}=y(null!=f?f:"-",{enabled:Boolean(f)&&j,refetchInterval:!!j&&v});var M;return Object(l.useEffect)((()=>{const n=k(e.args.args);var a,s;!O&&p&&n&&(x({endpoint_ids:[p],comment:null===(a=e.args.args)||void 0===a||null===(s=a.comment)||void 0===s?void 0:s[0],parameters:n}),t((e=>({...e,actionRequestSent:!0}))))}),[O,e.args.args,p,x,t]),Object(l.useEffect)((()=>{j&&(w&&f!==C.data.id?t((e=>({...e,actionId:C.data.id}))):A&&(r("error"),t((e=>({...e,apiError:A})))))}),[f,null==C?void 0:C.data.id,w,A,t,r,j]),Object(l.useEffect)((()=>{null!=F&&F.data.isCompleted&&j&&(r("success"),t((e=>({...e,completedActionDetails:F.data}))))}),[null==F?void 0:F.data,r,t,j]),S&&E?c.a.createElement(u,{showAs:"failure","data-test-subj":"killProcessAPIErrorCallout"},c.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.killProcess.performApiErrorMessage",defaultMessage:"The following error was encountered: {error}",values:{error:E.message}})):j||!b?c.a.createElement(u,{showAs:"pending"}):null!=b&&b.errors?c.a.createElement(h,{dataTestSubj:"killProcessErrorCallout",action:b,ResultComponent:u}):c.a.createElement(I,{action:b,ResultComponent:u,"data-test-subj":"killProcessSuccessCallout"})}));w.displayName="KillProcessActionResult";const A=Object(l.memo)((({command:e,setStore:t,store:n,status:s,setStatus:r,ResultComponent:u})=>{var d,m;const p=null===(d=e.commandDefinition)||void 0===d||null===(m=d.meta)||void 0===m?void 0:m.endpointId,{actionId:f,completedActionDetails:b,apiError:E}=n,j="pending"===s,S="error"===s,O=Boolean(n.actionRequestSent),{mutate:x,data:C,isSuccess:w,error:A}=Object(a.useMutation)((e=>{return t=e,o.b.get().http.post(i.m,{body:JSON.stringify(t)});var t}),M),{data:F}=y(null!=f?f:"-",{enabled:Boolean(f)&&j,refetchInterval:!!j&&v});var M;return Object(l.useEffect)((()=>{const n=k(e.args.args);var a,s;!O&&p&&n&&(x({endpoint_ids:[p],comment:null===(a=e.args.args)||void 0===a||null===(s=a.comment)||void 0===s?void 0:s[0],parameters:n}),t((e=>({...e,actionRequestSent:!0}))))}),[O,e.args.args,p,x,t]),Object(l.useEffect)((()=>{j&&(w&&f!==C.data.id?t((e=>({...e,actionId:C.data.id}))):A&&(r("error"),t((e=>({...e,apiError:A})))))}),[f,null==C?void 0:C.data.id,w,A,t,r,j]),Object(l.useEffect)((()=>{null!=F&&F.data.isCompleted&&j&&(r("success"),t((e=>({...e,completedActionDetails:F.data}))))}),[null==F?void 0:F.data,r,t,j]),S&&E?c.a.createElement(u,{showAs:"failure","data-test-subj":"suspendProcessAPIErrorCallout"},c.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.suspendProcess.performApiErrorMessage",defaultMessage:"The following error was encountered: {error}",values:{error:E.message}})):j||!b?c.a.createElement(u,{showAs:"pending"}):null!=b&&b.errors?c.a.createElement(h,{dataTestSubj:"suspendProcessErrorCallout",action:b,ResultComponent:u}):c.a.createElement(I,{action:b,ResultComponent:u,"data-test-subj":"suspendProcessSuccessCallout"})}));A.displayName="SuspendProcessActionResult";var F=n(50),M=n(690);const N=(e,t={})=>Object(a.useQuery)({queryKey:["fetch-endpoint-pending-actions-summary",...e],...t,queryFn:()=>Object(M.a)(e)});var T=n(211),R=n(1003),P=n(473),L=n(649),D=n(965);const $=Object(l.memo)((({command:e,status:t,setStatus:n,store:a,setStore:s,ResultComponent:o})=>{var i,d;const m=null===(i=e.commandDefinition)||void 0===i||null===(d=i.meta)||void 0===d?void 0:d.endpointId,{endpointPendingActions:g,endpointDetails:f,detailsFetchError:b,apiCalled:h}=a,E="pending"===t,y=Object(l.useMemo)((()=>Object(F.v4)()),[]),{data:v,error:j,isFetching:S,isFetched:O}=r(m,{enabled:E,queryKey:[y]}),{data:k}=N([m],{enabled:E,queryKey:[y,m]}),x=Object(l.useMemo)((()=>{if(null!=g&&g.data.length){var e,t;const n=g.data[0].pending_actions;return{pendingIsolate:null!==(e=n.isolate)&&void 0!==e?e:0,pendingUnIsolate:null!==(t=n.unisolate)&&void 0!==t?t:0}}return{pendingIsolate:0,pendingUnIsolate:0}}),[null==g?void 0:g.data]);Object(l.useEffect)((()=>{h||s((e=>({...e,apiCalled:!0})))}),[h,s]),Object(l.useEffect)((()=>{O&&E&&(n(b?"error":"success"),s((e=>({...e,endpointDetails:v,detailsFetchError:null!=j?j:void 0}))))}),[b,O,n,E,s,v,j]),Object(l.useEffect)((()=>{k&&!g&&s((e=>({...e,endpointPendingActions:k})))}),[k,s,g]);const C=Object(l.useCallback)((()=>{if(!f)return;const e=[{title:c.a.createElement(P.a,null,u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.agentStatus",{defaultMessage:"Agent status"})),description:c.a.createElement(P.a,null,(()=>{var e;let t="";return x.pendingIsolate>0?t=u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.isolating",{defaultMessage:"Isolating"}):x.pendingUnIsolate>0?t=u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.releasing",{defaultMessage:"Releasing"}):null!=f&&null!==(e=f.metadata.Endpoint.state)&&void 0!==e&&e.isolation&&(t=u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.isolated",{defaultMessage:"Isolated"})),`${Object(D.a)(f.host_status)}${t.length>0?` - ${t}`:""}`})())},{title:c.a.createElement(P.a,null,u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.version",{defaultMessage:"Version"})),description:f.metadata.agent.version},{title:c.a.createElement(P.a,null,u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.policyStatus",{defaultMessage:"Policy status"})),description:c.a.createElement(P.a,null,L.d[f.metadata.Endpoint.policy.applied.status])},{title:c.a.createElement(P.a,null,u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.lastActive",{defaultMessage:"Last active"})),description:c.a.createElement(P.a,null,c.a.createElement(T.a,{fieldName:u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.lastActive",{defaultMessage:"Last active"}),value:f.metadata["@timestamp"],className:"eui-textTruncate"}))}];return c.a.createElement(p.EuiDescriptionList,{compressed:!0,type:"column",className:"descriptionList-20_80",listItems:e,"data-test-subj":"agent-status-console-output"})}),[x.pendingIsolate,x.pendingUnIsolate,f]);return b?c.a.createElement(o,{showAs:"failure"},c.a.createElement(R.a,{error:b})):S||!f?c.a.createElement(o,{showAs:"pending"}):c.a.createElement(o,{showTitle:!1},C())}));$.displayName="EndpointStatusActionResult";var z=n(24),U=n.n(z);const _=U()(p.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-13ifdxm-0"})(["table{background-color:",";}.euiTableHeaderCell{border-bottom:",";.euiTableCellContent__text{font-weight:",";}}.euiTableRow{&:hover{background-color:white !important;}.euiTableRowCell{border-top:none !important;border-bottom:none !important;}}"],(({theme:{eui:e}})=>e.euiPageBackgroundColor),(e=>e.theme.eui.euiBorderThin),(e=>e.theme.eui.euiFontWeightRegular)),H=Object(l.memo)((({command:e,setStore:t,store:n,status:s,setStatus:r,ResultComponent:d})=>{var m,p,f;const b=null===(m=e.commandDefinition)||void 0===m||null===(p=m.meta)||void 0===p?void 0:p.endpointId,{actionId:E,completedActionDetails:v,apiError:j}=n,S="pending"===s,O="error"===s,k=Boolean(n.actionRequestSent),{mutate:x,data:C,isSuccess:I,error:w}=Object(a.useMutation)((e=>o.b.get().http.post(i.e,{body:JSON.stringify(e)})),undefined);const{data:A}=y(null!=E?E:"-",{enabled:Boolean(E)&&S,refetchInterval:!!S&&3e3});Object(l.useEffect)((()=>{var n,a;!k&&b&&(x({endpoint_ids:[b],comment:null===(n=e.args.args)||void 0===n||null===(a=n.comment)||void 0===a?void 0:a[0]}),t((e=>({...e,actionRequestSent:!0}))))}),[k,null===(f=e.args.args)||void 0===f?void 0:f.comment,b,x,t]),Object(l.useEffect)((()=>{S&&(I&&E!==(null==C?void 0:C.data.id)?t((e=>({...e,actionId:null==C?void 0:C.data.id}))):w&&(r("error"),t((e=>({...e,apiError:w})))))}),[E,null==C?void 0:C.data.id,w,I,r,t,S]),Object(l.useEffect)((()=>{null!=A&&A.data.isCompleted&&S&&(r("success"),t((e=>({...e,completedActionDetails:null==A?void 0:A.data}))))}),[null==A?void 0:A.data,r,t,S]);const F=Object(l.useMemo)((()=>[{field:"user",name:u.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.user",{defaultMessage:"USER"}),width:"10%"},{field:"pid",name:u.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.pid",{defaultMessage:"PID"}),width:"5%"},{field:"entity_id",name:u.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.enityId",{defaultMessage:"ENTITY ID"}),width:"30%"},{field:"command",name:u.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.command",{defaultMessage:"COMMAND"}),width:"55%"}]),[]),M=Object(l.useMemo)((()=>{var e,t,n;return b&&null!==(e=null==v||null===(t=v.outputs)||void 0===t||null===(n=t[b])||void 0===n?void 0:n.content.entries)&&void 0!==e?e:[]}),[null==v?void 0:v.outputs,b]);return S?c.a.createElement(d,{showAs:"pending",showTitle:!1}):O&&j?c.a.createElement(d,{showAs:"failure",title:u.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.performApiErrorMessageTitle",{defaultMessage:"Perform get processes action failed"}),"data-test-subj":"performGetProcessesErrorCallout"},c.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.getProcesses.performApiErrorMessage",defaultMessage:"The following error was encountered: {error}",values:{error:j.message}})):null!=v&&v.errors?c.a.createElement(h,{title:u.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.errorMessageTitle",{defaultMessage:"Get processes action failed"}),dataTestSubj:"getProcessesErrorCallout",action:v,ResultComponent:d}):c.a.createElement(d,{"data-test-subj":"getProcessesSuccessCallout",showTitle:!1},c.a.createElement(_,{items:[...M],columns:F}))}));H.displayName="GetProcessesActionResult";var B=n(83);const q=u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.unsupportedCommandInfo",{defaultMessage:"This version of the Endpoint does not support this command. Upgrade your Agent in Fleet to use the latest response actions."}),G=c.a.memo((()=>c.a.createElement(p.EuiIconTip,{content:q,type:"alert",color:"danger"})));G.displayName="DisabledTooltip";const W=({aboutInfo:e,isSupported:t})=>t?e:c.a.createElement(c.a.Fragment,null,e," ",c.a.createElement(G,null)),K=e=>{var t;return(null==e?void 0:e.length)>0&&"string"==typeof e[0]&&(null===(t=e[0])||void 0===t?void 0:t.trim().length)>0||u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.emptyArgumentMessage",{defaultMessage:"Argument cannot be empty"})},Y=e=>{const t=K(e);return!0!==t?t:!!(Number.isSafeInteger(Number(e))&&Number(e)>0)||u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.invalidPidMessage",{defaultMessage:"Argument must be a positive number representing the PID of a process"})},V=new Map([["isolate","isolation"],["release","isolation"],["kill-process","kill_process"],["suspend-process","suspend_process"],["processes","running_processes"]]),Q=e=>{const t=e.commandDefinition.meta.capabilities,n=V.get(e.commandDefinition.name);return!(!n||!t.includes(n))||B.g},J=Object.freeze({responseActions:{position:0,label:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.groups.responseActions",{defaultMessage:"Response actions"})}}),X=u.i18n.translate("xpack.securitySolution.endpointResponseActionsConsoleCommands.enterPidOrEntityId",{defaultMessage:"Enter a pid or an entity id to execute"}),Z=u.i18n.translate("xpack.securitySolution.endpointResponseActionsConsoleCommands.enterOrAddOptionalComment",{defaultMessage:"Hit enter to execute or add an optional comment"}),ee=u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.commandArgAbout",{defaultMessage:"A comment to go along with the action"}),te=({endpointAgentId:e,endpointCapabilities:t})=>{const n=e=>{const n=V.get(e);return!!n&&t.includes(n)};return[{name:"isolate",about:W({aboutInfo:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.isolate.about",{defaultMessage:"Isolate the host"}),isSupported:n("isolate")}),RenderComponent:S,meta:{endpointId:e,capabilities:t},exampleUsage:'isolate --comment "isolate this host"',exampleInstruction:Z,validate:Q,args:{comment:{required:!1,allowMultiples:!1,about:ee}},helpGroupLabel:J.responseActions.label,helpGroupPosition:J.responseActions.position,helpCommandPosition:0,helpDisabled:!1===n("isolate")},{name:"release",about:W({aboutInfo:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.release.about",{defaultMessage:"Release the host"}),isSupported:n("release")}),RenderComponent:O,meta:{endpointId:e,capabilities:t},exampleUsage:'release --comment "release this host"',exampleInstruction:Z,validate:Q,args:{comment:{required:!1,allowMultiples:!1,about:ee}},helpGroupLabel:J.responseActions.label,helpGroupPosition:J.responseActions.position,helpCommandPosition:1,helpDisabled:!1===n("release")},{name:"kill-process",about:W({aboutInfo:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.killProcess.about",{defaultMessage:"Kill/terminate a process"}),isSupported:n("kill-process")}),RenderComponent:w,meta:{endpointId:e,capabilities:t},exampleUsage:'kill-process --pid 123 --comment "kill this process"',exampleInstruction:X,validate:Q,mustHaveArgs:!0,args:{comment:{required:!1,allowMultiples:!1,about:ee},pid:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.pid.arg.comment",{defaultMessage:"A PID representing the process to kill"}),validate:Y},entityId:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.entityId.arg.comment",{defaultMessage:"An entity id representing the process to kill"}),validate:K}},helpGroupLabel:J.responseActions.label,helpGroupPosition:J.responseActions.position,helpCommandPosition:4,helpDisabled:!1===n("kill-process")},{name:"suspend-process",about:W({aboutInfo:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.about",{defaultMessage:"Temporarily suspend a process"}),isSupported:n("suspend-process")}),RenderComponent:A,meta:{endpointId:e,capabilities:t},exampleUsage:'suspend-process --pid 123 --comment "suspend this process"',exampleInstruction:X,validate:Q,mustHaveArgs:!0,args:{comment:{required:!1,allowMultiples:!1,about:ee},pid:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.pid.arg.comment",{defaultMessage:"A PID representing the process to suspend"}),validate:Y},entityId:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.entityId.arg.comment",{defaultMessage:"An entity id representing the process to suspend"}),validate:K}},helpGroupLabel:J.responseActions.label,helpGroupPosition:J.responseActions.position,helpCommandPosition:5,helpDisabled:!1===n("suspend-process")},{name:"status",about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.status.about",{defaultMessage:"Show host status information"}),RenderComponent:$,meta:{endpointId:e},helpGroupLabel:J.responseActions.label,helpGroupPosition:J.responseActions.position,helpCommandPosition:2},{name:"processes",about:W({aboutInfo:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.processes.about",{defaultMessage:"Show all running processes"}),isSupported:n("processes")}),RenderComponent:H,meta:{endpointId:e,capabilities:t},exampleUsage:'processes --comment "get the processes"',exampleInstruction:Z,validate:Q,args:{comment:{required:!1,allowMultiples:!1,about:ee}},helpGroupLabel:J.responseActions.label,helpGroupPosition:J.responseActions.position,helpCommandPosition:3,helpDisabled:!1===n("processes")}]};var ne=n(875),ae=n(395);const se=Object(l.memo)((e=>{const[t,n]=Object(l.useState)(!1),a=Object(l.useCallback)((()=>{n((e=>!e))}),[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(p.EuiButton,{onClick:a,disabled:t,iconType:"list","data-test-subj":"responderShowActionLogButton"},c.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.responseActionsHistoryButton.label",defaultMessage:"Response actions history"})),t&&c.a.createElement(p.EuiFlyout,{onClose:a,size:"m",paddingSize:"l","data-test-subj":"responderActionLogFlyout"},c.a.createElement(p.EuiFlyoutHeader,{hasBorder:!0},c.a.createElement(p.EuiTitle,{size:"m"},c.a.createElement("h1",null,ae.d.flyoutTitle(e.meta.endpoint.host.hostname)))),c.a.createElement(p.EuiFlyoutBody,null,c.a.createElement(ne.a,{agentIds:e.meta.endpoint.agent.id}))))}));se.displayName="ActionLogButton",n(872);var oe=n(652),ie=n(206),re=n(561),le=n(362);const ce=U()(p.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-1uxyi62-0"})([".isolation-status{margin-left:",";}"],(({theme:e})=>e.eui.euiSizeS)),ue=Object(l.memo)((({status:e,isIsolated:t,pendingActions:n,"data-test-subj":a})=>{const s=Object(ie.a)(a);return c.a.createElement(ce,{gutterSize:"none",responsive:!1,className:"eui-textTruncate","data-test-subj":a},c.a.createElement(p.EuiFlexItem,{grow:!1},c.a.createElement(re.a,{hostStatus:e})),void 0!==t&&c.a.createElement(p.EuiFlexItem,{grow:!1,className:"eui-textTruncate isolation-status"},c.a.createElement(le.b,{"data-test-subj":s("isolationStatus"),isIsolated:t,pendingActions:n})))}));ue.displayName="EndpointAgentAndIsolationStatus";const de=Object(l.memo)((({endpointId:e})=>{var t;const{data:n,isFetching:a}=r(e,{refetchInterval:1e4}),{data:s}=N([e],{refetchInterval:1e4}),o=Object(l.useMemo)((()=>{var e,t,n,a,o,i;const r=null==s||null===(e=s.data)||void 0===e?void 0:e[0].pending_actions;return{pendingActions:{pendingIsolate:null!==(t=null==r?void 0:r.isolate)&&void 0!==t?t:0,pendingUnIsolate:null!==(n=null==r?void 0:r.unisolate)&&void 0!==n?n:0,pendingKillProcess:null!==(a=null==r?void 0:r["kill-process"])&&void 0!==a?a:0,pendingSuspendProcess:null!==(o=null==r?void 0:r["suspend-process"])&&void 0!==o?o:0,pendingRunningProcesses:null!==(i=null==r?void 0:r["running-processes"])&&void 0!==i?i:0}}}),[null==s?void 0:s.data]);return a&&void 0===s?c.a.createElement(p.EuiLoadingContent,{lines:2}):n?c.a.createElement(p.EuiFlexGroup,{direction:"column",gutterSize:"none"},c.a.createElement(p.EuiFlexItem,{grow:!1},c.a.createElement(p.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},c.a.createElement(p.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},c.a.createElement(p.EuiToolTip,{content:n.metadata.host.name,anchorClassName:"eui-textTruncate"},c.a.createElement(p.EuiText,{size:"s","data-test-subj":"responderHeaderEndpointName"},c.a.createElement("h6",{className:"eui-textTruncate"},n.metadata.host.name)))),c.a.createElement(p.EuiFlexItem,{grow:!1},c.a.createElement(ue,C()({status:n.host_status,isIsolated:null===(t=n.metadata.Endpoint.state)||void 0===t?void 0:t.isolation},o,{"data-test-subj":"responderHeaderEndpointAgentIsolationStatus"}))))),c.a.createElement(p.EuiFlexItem,{grow:!1},c.a.createElement(p.EuiSpacer,{size:"xs"}),c.a.createElement(p.EuiText,{color:"subdued",size:"s","data-test-subj":"responderHeaderLastSeen"},c.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.responder.header.lastSeen",defaultMessage:"Last seen {date}",values:{date:c.a.createElement(g.FormattedRelative,{value:n.metadata["@timestamp"]})}})))):null}));de.displayName="HeaderEndpointInfo";var me=n(226);const pe=Object(l.memo)((({endpointId:e})=>{const{data:t}=r(e,{refetchInterval:1e4});return t&&t.host_status===me.b.OFFLINE?c.a.createElement(c.a.Fragment,null,c.a.createElement(p.EuiCallOut,{iconType:"offline",color:"warning","data-test-subj":"offlineCallout",title:u.i18n.translate("xpack.securitySolution.responder.hostOffline.callout.title",{defaultMessage:"Host Offline"})},c.a.createElement("p",null,c.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.responder.hostOffline.callout.body",defaultMessage:"The host {name} is offline, so its responses may be delayed. Pending commands will execute when the host reconnects.",values:{name:c.a.createElement("strong",null,t.metadata.host.name)}}))),c.a.createElement(p.EuiSpacer,{size:"m"})):null}));pe.displayName="OfflineCallout";const ge=u.i18n.translate("xpack.securitySolution.responder_overlay.pageTitle",{defaultMessage:"Response console"}),fe=()=>{const e=Object(oe.b)(),{canAccessResponseConsole:t}=Object(d.a)().endpointPrivileges;return Object(l.useCallback)((n=>{if(!t)return void window.console.error(new Error("Access denied to endpoint response actions console"));const a=n.agent.id,s=e.getOne(a);var o;s?s.show():e.register({id:a,meta:{endpoint:n},consoleProps:{commands:te({endpointAgentId:a,endpointCapabilities:null!==(o=n.Endpoint.capabilities)&&void 0!==o?o:[]}),"data-test-subj":"endpointResponseActionsConsole",TitleComponent:()=>c.a.createElement(de,{endpointId:a})},PageTitleComponent:()=>c.a.createElement(c.a.Fragment,null,ge),PageBodyComponent:()=>c.a.createElement(pe,{endpointId:a}),ActionComponents:[se]}).show()}),[t,e])},be=(e,t={})=>{const n=Object(o.j)();let s=e.userIds;return"string"==typeof e.userIds?s=`*${e.userIds}*`:Array.isArray(e.userIds)&&(s=e.userIds.map((e=>`*${e}*`))),Object(a.useQuery)({queryKey:["get-action-list",e],...t,queryFn:async()=>n.get(i.d,{query:{agentIds:e.agentIds,commands:e.commands,endDate:e.endDate,page:e.page,pageSize:e.pageSize,startDate:e.startDate,statuses:e.statuses,userIds:s}})})}},539:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(99),s=n(384),o=n(276);const i=e=>`${Object(o.a)(e)}`,r=(e,t,n,i=s.a.flows)=>`/ip/${e}/${t||a.a.source}/${i}${Object(o.a)(n)}`},540:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return b}));var a=n(4),s=n.n(a),o=n(17),i=n(24),r=n.n(i),l=n(175),c=n(203);const u=({children:e,...t})=>s.a.createElement(o.EuiButton,t,e),d=({children:e,...t})=>s.a.createElement(o.EuiLink,t,e),m=r()("span").withConfig({displayName:"Comma",componentId:"sc-y9dkfp-0"})(["margin-right:5px;margin-left:5px;&::after{content:' ,';}"]);m.displayName="Comma";const p=({children:e,Component:t,dataTestSubj:n,href:a,onClick:o,title:i,iconType:r="expand"})=>t?s.a.createElement(t,{"data-test-subj":n,href:a,iconType:r,onClick:o,title:i},null!=i?i:e):s.a.createElement(u,{"data-test-subj":n,href:a,onClick:o},null!=i?i:e),g=s.a.memo(p),f=r.a.div.withConfig({displayName:"PortContainer",componentId:"sc-y9dkfp-1"})(["& svg{position:relative;top:-1px;}"]),b=s.a.memo((({moreMaxHeight:e,overflowIndexStart:t=5,render:n,rowItems:i})=>{const[r,c]=Object(a.useState)(!1),u=Object(a.useCallback)((()=>c((e=>!e))),[]),d=Object(a.useMemo)((()=>s.a.createElement(s.a.Fragment,null," ,",s.a.createElement(o.EuiButtonEmpty,{size:"xs",onClick:u},`+${i.length-t} `,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.reputationLinks.moreLabel",defaultMessage:"More"})))),[u,t,i.length]);return s.a.createElement(o.EuiFlexItem,{grow:!1},i.length>t&&s.a.createElement(o.EuiPopover,{id:"popover",button:d,isOpen:r,closePopover:u,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},s.a.createElement(h,{render:n,rowItems:i,moreMaxHeight:e,overflowIndexStart:t})))}));b.displayName="ReputationLinksOverflow";const h=s.a.memo((({moreMaxHeight:e,overflowIndexStart:t,render:n,rowItems:i})=>{const r=Object(a.useMemo)((()=>i.slice(t).map(((e,t)=>{var a;return s.a.createElement(o.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(a=n&&n(e))&&void 0!==a?a:Object(c.a)(e))}))),[t,n,i]);return s.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:e,paddingRight:"2px"}},s.a.createElement(o.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},r))}));h.displayName="MoreReputationLinksContainer"},561:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),s=n.n(a),o=n(17),i=n(649),r=n(965);const l=s.a.memo((({hostStatus:e})=>s.a.createElement(o.EuiBadge,{color:null!=e?i.a[e]:"warning","data-test-subj":"rowHostStatus",className:"eui-textTruncate"},Object(r.a)(e))));l.displayName="AgentStatus"},567:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),s=n.n(a),o=n(17),i=n(518);const r=Object(a.memo)((({"data-test-subj":e})=>s.a.createElement(i.a,null,s.a.createElement(o.EuiLoadingSpinner,{"data-test-subj":e,size:"l"}))));r.displayName="ManagementPageLoader"},649:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return l}));var a=n(6),s=n(226);const o=Object.freeze({[s.b.HEALTHY]:"success",[s.b.UNHEALTHY]:"warning",[s.b.UPDATING]:"primary",[s.b.OFFLINE]:"default",[s.b.INACTIVE]:"default",[s.b.UNENROLLED]:"default"}),i=Object.freeze({success:"success",warning:"warning",failure:"danger",unsupported:"default"}),r=Object.freeze({success:"success",warning:"warning",failure:"danger",unsupported:"default"}),l=Object.freeze({success:a.i18n.translate("xpack.securitySolution.policyStatusText.success",{defaultMessage:"Success"}),warning:a.i18n.translate("xpack.securitySolution.policyStatusText.warning",{defaultMessage:"Warning"}),failure:a.i18n.translate("xpack.securitySolution.policyStatusText.failure",{defaultMessage:"Failure"}),unsupported:a.i18n.translate("xpack.securitySolution.policyStatusText.unsupported",{defaultMessage:"Unsupported"})})},690:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(19),s=n(288);const o=e=>a.b.get().http.get(s.b,{query:{agent_ids:e}})},732:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(17),s=n(175),o=n(26),i=n.n(o),r=n(4),l=n.n(r);const c=l.a.memo((({children:e,date:t,fieldName:n,className:o=""})=>l.a.createElement(a.EuiToolTip,{"data-test-subj":"localized-date-tool-tip",anchorClassName:o,content:l.a.createElement(a.EuiFlexGroup,{"data-test-subj":"dates-container",direction:"column",gutterSize:"none"},null!=n?l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement("span",{"data-test-subj":"field-name"},n)):null,l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(s.FormattedRelative,{"data-test-subj":"humanized-relative-date",value:i.a.utc(t).toDate()})),l.a.createElement(a.EuiFlexItem,{"data-test-subj":"with-day-of-week",grow:!1},i.a.utc(t).local().format("llll")),l.a.createElement(a.EuiFlexItem,{"data-test-subj":"with-time-zone-offset-in-hours",grow:!1},i()(t).format()))},l.a.createElement(l.a.Fragment,null,e))));c.displayName="LocalizedDateTooltip"},875:function(e,t,n){"use strict";n.d(t,"a",(function(){return ne}));var a=n(17),s=n(4),o=n.n(s),i=n(175),r=n(518),l=n(526),c=n(395),u=n(206),d=n(185),m=n(56),p=n(177),g=n(62);const f=["failed","pending","successful"],b=["isolate","unisolate","kill-process","suspend-process","running-processes"];var h=n(303);const E=e=>{const t={commands:[],hosts:[],statuses:[],startDate:"now-24h/h",endDate:"now",users:[]},n=e.commands?String(e.commands).split(",").reduce(((e,t)=>((b.includes(t)||"release"===t||"processes"===t)&&e.push(t),e.sort())),[]):[],a=e.hosts?String(e.hosts).split(",").sort():[],s=e.statuses?String(e.statuses).split(",").reduce(((e,t)=>(f.includes(t)&&e.push(t),e.sort())),[]):[],o=e.users?String(e.users).split(",").sort():[];return t.commands=n.length?n:void 0,t.hosts=a.length?a:void 0,t.statuses=s.length?s:void 0,t.startDate=e.startDate?String(e.startDate):void 0,t.endDate=e.endDate?String(e.endDate):void 0,t.users=o.length?o:void 0,t},y=()=>{const e=Object(g.useLocation)(),t=Object(g.useHistory)(),{urlParams:n,toUrlParams:a}=Object(h.a)(),o=Object(s.useMemo)((()=>E(n)),[n]),[i,r]=Object(s.useState)(o),l=Object(s.useCallback)((s=>{t.push({...e,search:a({...n,commands:s.length?s:void 0})})}),[t,e,a,n]),c=Object(s.useCallback)((s=>{t.push({...e,search:a({...n,hosts:s.length?s:void 0})})}),[t,e,a,n]),u=Object(s.useCallback)((s=>{t.push({...e,search:a({...n,statuses:s.length?s:void 0})})}),[t,e,a,n]),d=Object(s.useCallback)((s=>{t.push({...e,search:a({...n,users:s.length?s:void 0})})}),[t,e,a,n]),m=Object(s.useCallback)((({startDate:s,endDate:o})=>{t.push({...e,search:a({...n,startDate:s.length?s:void 0,endDate:o.length?o:void 0})})}),[t,e,a,n]);return Object(s.useEffect)((()=>{r((e=>({...e,...E(n)})))}),[r,n]),{...i,setUrlActionsFilters:l,setUrlDateRangeFilters:m,setUrlHostsFilters:c,setUrlStatusesFilters:u,setUrlUsersFilters:d}},v=d.euiStyled.div`
  padding-bottom: ${e=>`${e.theme.eui.euiCodeBlockPaddingModifiers.paddingLarge}`};
`,j=Object(s.memo)((({dateRangePickerState:e,isDataLoading:t,isFlyout:n,onRefresh:i,onRefreshChange:r,onTimeChange:l})=>{const{startDate:c,endDate:d}=y(),g=Object(u.a)("response-actions-list"),f=Object(m.useKibana)(),{uiSettings:b}=f.services,[h]=Object(s.useState)((()=>{var e,t;return null!==(e=null==b||null===(t=b.get(p.UI_SETTINGS.TIMEPICKER_QUICK_RANGES))||void 0===t?void 0:t.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n}))))&&void 0!==e?e:[]}));return o.a.createElement(v,{"data-test-subj":g("super-date-picker")},o.a.createElement(a.EuiFlexGroup,{alignItems:"center",direction:"row",responsive:!1,gutterSize:"s"},o.a.createElement(a.EuiFlexItem,null,o.a.createElement(a.EuiSuperDatePicker,{isLoading:t,dateFormat:b.get("dateFormat"),commonlyUsedRanges:h,end:n?e.endDate:null!=d?d:e.endDate,isPaused:!e.autoRefreshOptions.enabled,onTimeChange:l,onRefreshChange:r,refreshInterval:e.autoRefreshOptions.duration,onRefresh:i,recentlyUsedRanges:e.recentlyUsedDateRanges,start:n?e.startDate:null!=c?c:e.startDate,showUpdateButton:!1,updateButtonProps:{iconOnly:!0,fill:!1},width:"auto"}))))}));j.displayName="ActionLogDateRangePicker";var S=n(3);const O=Object(s.memo)((({children:e,closePopover:t,filterName:n,hasActiveFilters:i,isPopoverOpen:r,numActiveFilters:l,numFilters:d,onButtonClick:m})=>{const p=Object(u.a)("response-actions-list"),g=Object(a.useGeneratedHtmlId)({prefix:"filterGroupPopover"}),f=Object(s.useMemo)((()=>o.a.createElement(a.EuiFilterButton,{"data-test-subj":p(`${n}-filter-popoverButton`),iconType:"arrowDown",onClick:m,isSelected:r,numFilters:d,hasActiveFilters:i,numActiveFilters:l},c.a[n])),[n,p,i,r,l,d,m]);return o.a.createElement(a.EuiPopover,{button:f,closePopover:t,id:g,isOpen:r,panelPaddingSize:"none"},e)}));O.displayName="ActionsLogFilterPopover";const k=Object(s.memo)((({color:e,status:t})=>{const n=Object(u.a)("response-actions-list");return o.a.createElement(a.EuiBadge,{"data-test-subj":n("column-status"),color:e},t)}));k.displayName="StatusBadge";var x=n(218),C=n(19),I=n(288);const w=Object.freeze({default:50,all:1e4}),A=Object.freeze({autoRefreshOptions:{enabled:!1,duration:1e4},startDate:"now-24h/h",endDate:"now",recentlyUsedDateRanges:[]}),F=e=>"failed"===e?c.d.badge.failed:"successful"===e?c.d.badge.successful:"pending"===e?c.d.badge.pending:"",M=e=>"unisolate"===e?"release":"running-processes"===e?"processes":e,N=e=>"release"===e?"unisolate":"processes"===e?"running-processes":e,T=Object(d.euiStyled)(a.EuiButtonEmpty).attrs({iconType:"crossInACircleFilled",color:"danger"})`
  border-top: ${e=>`${e.theme.eui.euiBorderThin}`};
  border-radius : 0;
`,R=Object(s.memo)((({"data-test-subj":e,isDisabled:t,onClick:n})=>o.a.createElement(T,{"data-test-subj":e,isDisabled:t,onClick:n},c.d.filterClearAll)));R.displayName="ClearAllButton";const P=Object(s.memo)((({filterName:e,isFlyout:t,onChangeFilterOptions:n})=>{const i=Object(u.a)("response-actions-list"),[r,l]=Object(s.useState)(!1),d=Object(s.useCallback)((()=>{l(!r)}),[l,r]),m=Object(s.useCallback)((()=>{l(!1)}),[l]),[p,g]=Object(s.useState)(""),{areHostsSelectedOnMount:h,isLoading:E,items:v,setItems:j,hasActiveFilters:A,numActiveFilters:T,numFilters:P,setAreHostsSelectedOnMount:L,setUrlActionsFilters:D,setUrlHostsFilters:$,setUrlStatusesFilters:z}=(({filterName:e,isFlyout:t,isPopoverOpen:n,searchString:a})=>{const{commands:i,statuses:r,hosts:l,setUrlActionsFilters:c,setUrlHostsFilters:u,setUrlStatusesFilters:d}=y(),m="statuses"===e,p="hosts"===e,{data:g,isFetching:h}=(({searchString:e,selectedAgentIds:t,options:n={}})=>{const a=Object(C.j)(),s=`united.endpoint.host.hostname:${e.length?`*${e}`:""}*`;let o=[];return t&&(o=t.map((e=>`united.endpoint.agent.id:"${e}"`))),Object(x.useQuery)({queryKey:["get-endpoints-list",s],...n,queryFn:async()=>{const e=(await a.get(I.g,{query:{page:0,pageSize:t&&t.length>0?w.all:w.default,kuery:[...o,s].join(" or ")}})).data.reduce(((e,n)=>{const a={id:n.metadata.agent.id,name:n.metadata.host.hostname};return null!=t&&t.includes(n.metadata.agent.id)?e.selected.push({...a,selected:!0}):e.rest.push({...a,selected:!1}),e}),{selected:[],rest:[]});let n=0;return t&&(n=t.length),[...e.selected,...e.rest].slice(0,n>=w.default?n+10:w.default)}})})({searchString:a,selectedAgentIds:l}),[E,v]=Object(s.useState)(!1);Object(s.useEffect)((()=>{l&&l.length>0&&v(!0)}),[]);const[j,S]=Object(s.useState)(m?f.map((n=>({key:n,label:o.a.createElement(k,{color:"successful"===n?"success":"failed"===n?"danger":"warning",status:F(n)}),checked:!t&&null!=r&&r.includes(n)?"on":void 0,"data-test-subj":`${e}-filter-option`}))):p?[]:b.map((n=>({key:n,label:M(n),checked:!t&&null!=i&&i.map((e=>N(e))).includes(n)?"on":void 0,"data-test-subj":`${e}-filter-option`}))));Object(s.useEffect)((()=>{p&&g&&S(null==g?void 0:g.map((n=>({key:n.id,label:n.name,checked:!t&&n.selected?"on":void 0,"data-test-subj":`${e}-filter-option`}))))}),[g,e,t,p,S]);const O=Object(s.useMemo)((()=>!!j.find((e=>"on"===e.checked))),[j]),A=Object(s.useMemo)((()=>j.filter((e=>"on"===e.checked)).length),[j]),T=Object(s.useMemo)((()=>j.filter((e=>"on"!==e.checked)).length),[j]);return{areHostsSelectedOnMount:E,isLoading:p&&h,items:j,setItems:S,hasActiveFilters:O,numActiveFilters:A,numFilters:T,setAreHostsSelectedOnMount:v,setUrlActionsFilters:c,setUrlHostsFilters:u,setUrlStatusesFilters:d}})({filterName:e,isFlyout:t,isPopoverOpen:r,searchString:p}),U=Object(s.useRef)(r);Object(s.useEffect)((()=>()=>{U.current=r}),[r,U]);const _=Object(s.useCallback)(((t=!0)=>t&&U.current&&r&&"hosts"===e),[e,r]),H=Object(s.useMemo)((()=>_()||h?Object(S.orderBy)("checked","asc",v):v),[h,_,v]),B=Object(s.useMemo)((()=>"statuses"!==e),[e]),q=Object(s.useCallback)((a=>{j(a.map((e=>e)));const s=a.reduce(((e,t)=>("on"===t.checked&&e.push(t.key),e)),[]);t||("actions"===e?D(s.map((e=>M(e))).join()):"hosts"===e?$(s.join()):"statuses"===e&&z(s.join()),_(!1),L(!1)),n(s)}),[_,e,t,j,n,L,D,$,z]),G=Object(s.useCallback)((()=>{j(v.map((e=>(e.checked=void 0,e)))),t||("actions"===e?D(""):"hosts"===e?$(""):"statuses"===e&&z("")),n([])}),[e,t,v,j,n,D,$,z]);return o.a.createElement(O,{closePopover:m,filterName:e,hasActiveFilters:A,isPopoverOpen:r,numActiveFilters:T,numFilters:P,onButtonClick:d},o.a.createElement(a.EuiSelectable,{"aria-label":`${e}`,emptyMessage:c.d.filterEmptyMessage(e),isLoading:E,onChange:q,options:H,searchable:!!B||void 0,searchProps:{placeholder:c.d.filterSearchPlaceholder(e),compressed:!0,onChange:e=>g(e.trim())}},((t,n)=>o.a.createElement("div",{style:{width:300},"data-test-subj":i(`${e}-filter-popoverList`)},B&&o.a.createElement(a.EuiPopoverTitle,{"data-test-subj":i(`${e}-filter-search`),paddingSize:"s"},n),t,o.a.createElement(a.EuiFlexGroup,null,o.a.createElement(a.EuiFlexItem,null,o.a.createElement(R,{"data-test-subj":i(`${e}-filter-clearAllButton`),isDisabled:!A,onClick:G})))))))}));P.displayName="ActionsLogFilter";const L=Object(s.memo)((({isFlyout:e,onChangeUsersFilter:t})=>{const n=Object(u.a)("response-actions-list"),{users:i,setUrlUsersFilters:r}=y(),[l,d]=Object(s.useState)(""),m=Object(s.useCallback)((e=>{d(e.target.value)}),[d]),p=Object(s.useCallback)((()=>{const n=l.split(",").reduce(((e,t)=>(""!==t.trim()&&e.push(t.trim()),e)),[]);t(n),e||r(n.join(","))}),[e,t,l,r]),g=Object(s.useCallback)((()=>{d(""),t([]),e||r("")}),[e,t,r,d]);return Object(s.useEffect)((()=>{i&&i.length>0&&d(i.join(","))}),[]),o.a.createElement(a.EuiFormControlLayout,{clear:{onClick:g},fullWidth:!0},o.a.createElement(a.EuiFieldSearch,{"data-test-subj":n("users-filter-search"),isClearable:!0,fullWidth:!0,placeholder:c.a.users,onChange:m,onSearch:p,value:l}))}));L.displayName="ActionsLogUsersFilter";const D=Object(s.memo)((({dateRangePickerState:e,isDataLoading:t,isFlyout:n,onClick:i,onChangeHostsFilter:r,onChangeCommandsFilter:l,onChangeStatusesFilter:c,onChangeUsersFilter:d,onRefresh:m,onRefreshChange:p,onTimeChange:g,showHostsFilter:f})=>{const b=Object(u.a)("response-actions-list"),h=Object(s.useMemo)((()=>o.a.createElement(o.a.Fragment,null,f&&o.a.createElement(P,{filterName:"hosts",isFlyout:n,onChangeFilterOptions:r}),o.a.createElement(P,{filterName:"actions",isFlyout:n,onChangeFilterOptions:l}),o.a.createElement(P,{filterName:"statuses",isFlyout:n,onChangeFilterOptions:c}))),[n,l,r,c,f]),E=Object(s.useCallback)((()=>i()),[i]);return o.a.createElement(a.EuiFlexGroup,{responsive:!0,gutterSize:"s"},o.a.createElement(a.EuiFlexItem,{grow:n?1:2},o.a.createElement(L,{isFlyout:n,onChangeUsersFilter:d})),o.a.createElement(a.EuiFlexItem,{grow:1},o.a.createElement(a.EuiFilterGroup,null,h)),o.a.createElement(a.EuiFlexItem,{grow:n?1:2},o.a.createElement(j,{dateRangePickerState:e,isDataLoading:t,isFlyout:n,onRefresh:m,onRefreshChange:p,onTimeChange:g})),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiSuperUpdateButton,{iconOnly:!0,"data-test-subj":b("super-refresh-button"),fill:!1,isLoading:t,onClick:E})))}));D.displayName="ActionsLogFilters";var $=n(434),z=n(567),U=n(24),_=n.n(U),H=n(6);const B=_()(a.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-mvmy5q-0"})(["max-width:100%;"]),q=Object(s.memo)((({"data-test-subj":e})=>{const{docLinks:t}=Object(m.useKibana)().services;return o.a.createElement(r.a,{"data-test-subj":e},o.a.createElement(B,{iconType:"editorUnorderedList",title:o.a.createElement("h2",null,H.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.title",{defaultMessage:"Response actions history is empty"})),body:o.a.createElement("div",null,H.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.content",{defaultMessage:"No response actions performed"})),actions:[o.a.createElement(a.EuiLink,{external:!0,href:null==t?void 0:t.links.securitySolution.responseActions,target:"_blank"},H.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.link",{defaultMessage:"Read more about response actions"}))]}))}));q.displayName="ActionsLogEmptyState";var G=n(211),W=n(203),K=n(209);const Y=Object(W.e)(),V=Object(d.euiStyled)(a.EuiFacetButton)`
  .euiText {
    margin-top: 0.38rem;
    overflow-y: visible !important;
  }
`,Q=d.css`
  &.euiDescriptionList {
    > .euiDescriptionList__title {
      color: ${e=>e.theme.eui.euiColorDarkShade};
      font-size: ${e=>e.theme.eui.euiFontSizeXS};
      margin-top: ${e=>e.theme.eui.euiSizeS};
    }

    > .euiDescriptionList__description {
      font-weight: ${e=>e.theme.eui.euiFontWeightSemiBold};
      margin-top: ${e=>e.theme.eui.euiSizeS};
    }
  }
`,J=Object(d.euiStyled)(a.EuiDescriptionList).attrs({compressed:!0,type:"column"})`
  ${Q}
`,X=d.css`
  ${e=>`${e.theme.eui.euiCodeBlockPaddingModifiers.paddingMedium} 0`}
`,Z=d.css`
  ${e=>`1px dashed ${e.theme.eui.euiColorDisabled}`};
`,ee=Object(d.euiStyled)(a.EuiDescriptionList).attrs({compressed:!0})`
  ${Q}
  dd {
    margin: ${X};
    padding: ${X};
    border-top: ${Z};
    border-bottom: ${Z};
  }
`,te=Object(d.euiStyled)(a.EuiCodeBlock).attrs({transparentBackground:!0,paddingSize:"none"})`
  code {
    color: ${e=>e.theme.eui.euiColorDarkShade} !important;
  }
`,ne=Object(s.memo)((({agentIds:e,showHostNames:t=!1,isFlyout:n=!0,setIsDataInResponse:d})=>{var m,p;const{pagination:g,setPagination:f}=Object($.b)(),{commands:b,hosts:h,statuses:E,startDate:v,endDate:j,users:S}=y(),O=Object(u.a)("response-actions-list"),[x,C]=Object(s.useState)(!0),[I,w]=Object(s.useState)({page:n?1:g.page,pageSize:n?10:g.pageSize,agentIds:n?e:null!=h&&h.length?h:e,commands:[],statuses:[],userIds:[]});Object(s.useEffect)((()=>{n||w((e=>({...e,commands:null!=b&&b.length?b.map((e=>N(e))):e.commands,hosts:null!=h&&h.length?h:e.agentIds,statuses:null!=E&&E.length?E:e.statuses,userIds:null!=S&&S.length?S:e.userIds})))}),[b,h,n,E,w,S]);const{dateRangePickerState:T,onRefreshChange:R,onTimeChange:P}=(e=>{const{setUrlDateRangeFilters:t}=y(),[n,a]=Object(s.useState)(A),o=Object(s.useCallback)((({start:e,end:t})=>{a((n=>({...n,startDate:e,endDate:t})))}),[a]),i=Object(s.useCallback)((e=>{a((t=>({...t,recentlyUsedDateRanges:e})))}),[a]),r=Object(s.useCallback)((e=>{a((t=>({...t,autoRefreshOptions:{enabled:!e.isPaused,duration:e.refreshInterval}})))}),[a]),l=Object(s.useCallback)((({start:a,end:s})=>{o({start:a,end:s});const r=[{start:a,end:s},...n.recentlyUsedDateRanges.filter((e=>!(e.start===a&&e.end===s))).slice(0,9)];i(r),e||t({startDate:a,endDate:s})}),[n.recentlyUsedDateRanges,e,t,o,i]);return{dateRangePickerState:n,onRefreshChange:r,onTimeChange:l}})(n),{error:L,data:U,isFetching:_,isFetched:H,refetch:B}=Object(l.a)({...I,startDate:n?T.startDate:v,endDate:n?T.endDate:j},{retry:!1}),W=Object(s.useMemo)((()=>{var e;return null!==(e=null==U?void 0:U.total)&&void 0!==e?e:0}),[U]),{itemIdToExpandedRowMap:Q,recordRangeLabel:X,responseActionListColumns:Z,tablePagination:ne}=(({pageIndex:e,pageSize:t,queryParams:n,showHostNames:r,totalItemCount:l})=>{const d=Object(u.a)("response-actions-list"),[m,p]=Object(s.useState)({}),g=Object(s.useCallback)((e=>{const t={...m};if(t[e.id])delete t[e.id];else{const{startedAt:n,completedAt:s,isCompleted:i,wasSuccessful:r,isExpired:l,command:u,parameters:m}=e,p=m?Object.entries(m).map((([e,t])=>`${e}:${t}`)):void 0,g=M(u),f=[{title:c.b.expandSection.placedAt,description:`${n}`},{title:c.b.expandSection.startedAt,description:`${n}`},{title:c.b.expandSection.completedAt,description:`${null!=s?s:Y}`},{title:c.b.expandSection.input,description:`${g}`},{title:c.b.expandSection.parameters,description:p||Y}].map((({title:e,description:t})=>({title:o.a.createElement(te,null,e),description:o.a.createElement(te,null,t)}))),b=[{title:o.a.createElement(te,null,`${c.b.expandSection.output}:`),description:o.a.createElement(te,{"data-test-subj":d("details-tray-output")},l?c.b.hasExpired(g):i?r?c.b.wasSuccessful(g):c.b.hasFailed(g):c.b.isPending(g))}];t[e.id]=o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiFlexGroup,{"data-test-subj":d("details-tray"),direction:"column",style:{maxHeight:270,overflowY:"auto"},className:"eui-yScrollWithShadows",gutterSize:"s"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(J,{listItems:f})),o.a.createElement(a.EuiFlexItem,null,o.a.createElement(ee,{listItems:b}))))}p(t)}),[d,m]),f=Object(s.useCallback)((e=>()=>g(e)),[g]),b=Object(s.useMemo)((()=>{const e=[{field:"startedAt",name:c.c.time,width:r?"15%":"21%",truncateText:!0,render:e=>o.a.createElement(G.a,{fieldName:c.c.time,value:e,className:"eui-textTruncate"})},{field:"command",name:c.c.command,width:r?"10%":"21%",truncateText:!0,render:e=>{const t=M(e);return o.a.createElement(a.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},o.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":d("column-command")},t))}},{field:"createdBy",name:c.c.user,width:r?"14%":"21%",truncateText:!0,render:e=>o.a.createElement(V,{icon:o.a.createElement(a.EuiAvatar,{name:e,"data-test-subj":d("column-user-avatar"),size:"s"})},o.a.createElement(a.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},o.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":d("column-user-name")},e)))},{field:"hosts",name:c.c.hosts,width:"20%",truncateText:!0,render:e=>{const t=e&&Object.values(e),n=t.reduce(((e,t)=>(t.name.trim()&&e.push(t.name),e)),[]).join(", ");let s=n;return n||(t.length>1?s=c.d.unenrolled.hosts:1===t.length&&(s=c.d.unenrolled.host)),o.a.createElement(a.EuiToolTip,{content:s,anchorClassName:"eui-textTruncate"},o.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":d("column-hostname")},s))}},{field:"comment",name:c.c.comments,width:r?"30%":"21%",truncateText:!0,render:e=>o.a.createElement(a.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},o.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":d("column-comments")},null!=e?e:Y))},{field:"status",name:c.c.status,width:r?"10%":"15%",render:e=>{const t=F(e);return o.a.createElement(a.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},o.a.createElement(k,{color:"failed"===e?"danger":"successful"===e?"success":"warning",status:t}))}},{field:"",align:a.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:o.a.createElement(a.EuiScreenReaderOnly,null,o.a.createElement("span",null,c.d.screenReaderExpand)),render:e=>o.a.createElement(a.EuiButtonIcon,{"data-test-subj":d("expand-button"),onClick:f(e),"aria-label":m[e.id]?"Collapse":"Expand",iconType:m[e.id]?"arrowUp":"arrowDown"})}];return r?e:e.filter((e=>"hosts"!==e.field))}),[r,d,m,f]),h=Object(s.useMemo)((()=>({pageIndex:e,pageSize:t,totalItemCount:l,pageSizeOptions:K.f})),[e,t,l]),E=Object(s.useMemo)((()=>{var e,t;const a=null!==(e=n.page)&&void 0!==e?e:1,s=null!==(t=null==n?void 0:n.pageSize)&&void 0!==t?t:10,o=Math.ceil(l/s),i=s*a-s+1;return{fromCount:i,toCount:a===o||1===o?l:i+s-1}}),[n.page,n.pageSize,l]),y=Object(s.useMemo)((()=>o.a.createElement(a.EuiText,{color:"default",size:"xs","data-test-subj":d("endpointListTableTotal")},o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.list.recordRange",defaultMessage:"Showing {range} of {total} {recordsLabel}",values:{range:o.a.createElement("strong",null,o.a.createElement(a.EuiI18nNumber,{value:E.fromCount}),"-",o.a.createElement(a.EuiI18nNumber,{value:E.toCount})),total:o.a.createElement(a.EuiI18nNumber,{value:l}),recordsLabel:o.a.createElement("strong",null,c.d.recordsLabel(l))}}))),[d,E.fromCount,E.toCount,l]);return{itemIdToExpandedRowMap:m,responseActionListColumns:b,recordRangeLabel:y,tablePagination:h}})({showHostNames:t,pageIndex:n?(I.page||1)-1:g.page-1,pageSize:n?I.pageSize||10:g.pageSize,queryParams:I,totalItemCount:W});Object(s.useEffect)((()=>{var e,t;_||404!==(null==L||null===(e=L.body)||void 0===e?void 0:e.statusCode)||"index_not_found_exception"!==(null==L||null===(t=L.body)||void 0===t?void 0:t.message)?!_&&U&&(C(!1),d&&d(!0)):d&&d(!1)}),[U,L,_,d]);const ae=Object(s.useCallback)((()=>{T.autoRefreshOptions.enabled&&B()}),[T.autoRefreshOptions.enabled,B]),se=Object(s.useCallback)((e=>{w((t=>({...t,commands:e})))}),[w]),oe=Object(s.useCallback)((e=>{w((t=>({...t,statuses:e})))}),[w]),ie=Object(s.useCallback)((e=>{w((t=>({...t,agentIds:e})))}),[w]),re=Object(s.useCallback)((e=>{w((t=>({...t,userIds:e})))}),[w]),le=Object(s.useCallback)((({page:e})=>{const{index:t,size:a}=e,s={page:t+1,pageSize:a};w((e=>({...e,...s}))),n||f({...s}),B()}),[n,B,w,f]);return 404===(null==L||null===(m=L.body)||void 0===m?void 0:m.statusCode)&&"index_not_found_exception"===(null==L||null===(p=L.body)||void 0===p?void 0:p.message)?o.a.createElement(q,{"data-test-subj":O("empty-state")}):_&&x?o.a.createElement(z.a,{"data-test-subj":O("global-loader")}):o.a.createElement(o.a.Fragment,null,o.a.createElement(D,{isFlyout:n,dateRangePickerState:T,isDataLoading:_,onClick:B,onChangeHostsFilter:ie,onChangeCommandsFilter:se,onChangeStatusesFilter:oe,onChangeUsersFilter:re,onRefresh:ae,onRefreshChange:R,onTimeChange:P,showHostsFilter:t}),H&&!W?o.a.createElement(r.a,null,o.a.createElement(a.EuiFlexItem,{"data-test-subj":O("empty-prompt")},o.a.createElement(a.EuiEmptyPrompt,{iconType:"editorUnorderedList",titleSize:"s",title:o.a.createElement("h2",null,o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.empty.title",defaultMessage:"No results match your search criteria"})),body:o.a.createElement("p",null,o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.empty.body",defaultMessage:"Try modifying your search or filter set"})),"data-test-subj":"responseActions-empty"}))):o.a.createElement(o.a.Fragment,null,X,o.a.createElement(a.EuiHorizontalRule,{margin:"xs"}),o.a.createElement(a.EuiBasicTable,{"data-test-subj":O("table-view"),items:(null==U?void 0:U.data)||[],columns:Z,itemId:"id",itemIdToExpandedRowMap:Q,isExpandable:!0,pagination:ne,onChange:le,loading:_,error:null!==L?c.d.fetchError:void 0})))}));ne.displayName="ResponseActionsLog"},963:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(5),s=n(4),o=n(1),i=n(202),r=n(367),l=n(542);const c=({alertId:e})=>{const[t,n]=Object(s.useState)(!1),[c,u]=Object(s.useState)([]),{addError:d}=Object(i.a)();return Object(s.useEffect)((()=>{let t=!0;return n(!0),Object(a.isEmpty)(e)||(async()=>{try{const n=await Object(r.f)({alertId:e,owner:[o.o]});t&&u(n)}catch(e){d(e.message,{title:l.a})}t&&n(!1)})(),()=>{t=!1}}),[e,d]),{loading:t,casesInfo:c}}},965:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(6);const s=e=>a.i18n.translate("xpack.securitySolution.endpoint.list.hostStatusValue",{defaultMessage:"{hostStatus, select, healthy {Healthy} unhealthy {Unhealthy} updating {Updating} offline {Offline} inactive {Inactive} unenrolled {Unenrolled} other {Unhealthy}}",values:{hostStatus:e}})}}]);