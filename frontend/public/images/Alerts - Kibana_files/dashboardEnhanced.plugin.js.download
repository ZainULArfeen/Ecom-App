/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=29)}([function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,n){e.exports=n(9)(2)},function(e,t,n){e.exports=n(9)(2684)},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,n){e.exports=n(9)(24)},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){e.exports=n(9)(10)},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/embeddableEnhanced/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){e.exports=n(9)(48)},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t,n){"use strict";function r(e,t,n,o){var a=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(a,r.prototype),a.expected=t,a.found=n,a.location=o,a.name="SyntaxError",a}function o(e,t,n){return n=n||" ",e.length>t?e:(t-=e.length,e+(n+=n.repeat(t)).slice(0,t))}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(r,Error),r.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var n,r=null;for(n=0;n<e.length;n++)if(e[n].source===this.location.source){r=e[n].text.split(/\r\n|\n|\r/g);break}var a=this.location.start,i=this.location.source+":"+a.line+":"+a.column;if(r){var s=this.location.end,u=o("",a.line.toString().length),c=r[a.line-1],d=a.line===s.line?s.column:c.length+1;t+="\n --\x3e "+i+"\n"+u+" |\n"+a.line+" | "+c+"\n"+u+" | "+o("",a.column-1)+o("",d-a.column,"^")}else t+="\n at "+i}return t},r.buildMessage=function(e,t){var n={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?a(e[0])+"-"+a(e[1]):a(e)}));return"["+(e.inverted?"^":"")+t+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function i(e){return n[e.type](e)}return"Expected "+function(e){var t,n,r=e.map(i);if(r.sort(),r.length>0){for(t=1,n=1;t<r.length;t++)r[t-1]!==r[t]&&(r[n]=r[t],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:r,parse:function(e,t){var n,o={},a=(t=void 0!==t?t:{}).grammarSource,i={start:le,Literal:Ee},s=le,u='"',c="\\",d="@kuery-cursor@",l=/^[\\"]/,f=/^[^"]/,p=/^[\\():<>"*{}]/,h=/^[0-9a-f]/i,b=/^[ \t\r\n\xA0]/,g=ae("(",!1),v=ae(")",!1),m=ae(":",!1),y=ae("{",!1),_=ae("}",!1),w=se("fieldName"),O=se("value"),j=se("OR"),E=ae("or",!0),C=se("AND"),D=ae("and",!0),x=se("NOT"),I=ae("not",!0),T=se("literal"),A=ae('"',!1),S=ae("\\",!1),R=ie(["\\",'"'],!1,!1),N=ie(['"'],!0,!1),L={type:"any"},F=ae("*",!1),k=ae("\\t",!1),M=ae("\\r",!1),P=ae("\\n",!1),U=ie(["\\","(",")",":","<",">",'"',"*","{","}"],!1,!1),Q=ae("u",!1),G=ie([["0","9"],["a","f"]],!1,!0),q=ae("<=",!1),$=ae(">=",!1),B=ae("<",!1),W=ae(">",!1),K=se("whitespace"),Y=ie([" ","\t","\r","\n","Â "],!1,!1),H=ae("@kuery-cursor@",!1),V=function(e,t){return t},X=function(e,t){return t},z=function(){return ke},Z=function(t,n,r){const{start:o,end:a}=ce(ee,J);return{type:"cursor",start:o.offset,end:a.offset-n.length,prefix:t.join(""),suffix:r.join(""),text:e.substring(ee,J).replace(n,"")}},J=0,ee=0,te=[{line:1,column:1}],ne=0,re=[],oe=0;if("startRule"in t){if(!(t.startRule in i))throw new Error("Can't start parsing from rule \""+t.startRule+'".');s=i[t.startRule]}function ae(e,t){return{type:"literal",text:e,ignoreCase:t}}function ie(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function se(e){return{type:"other",description:e}}function ue(t){var n,r=te[t];if(r)return r;for(n=t-1;!te[n];)n--;for(r={line:(r=te[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return te[t]=r,r}function ce(e,t){var n=ue(e),r=ue(t);return{source:a,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function de(e){J<ne||(J>ne&&(ne=J,re=[]),re.push(e))}function le(){var e,t,n,r,a,i;for(e=J,t=[],n=Le();n!==o;)t.push(n),n=Le();return(n=fe())===o&&(n=null),(r=Te())!==o?(ee=e,a=n,e="cursor"===(i=r).type?{...i,suggestionTypes:["conjunction"]}:null!==a?a:Ue.function.buildNode("is","*","*")):(J=e,e=o),e}function fe(){var e,t,n,r,a;if(e=J,(t=pe())!==o){if(n=[],r=J,we()!==o&&(a=pe())!==o?(ee=r,r=V(0,a)):(J=r,r=o),r!==o)for(;r!==o;)n.push(r),r=J,we()!==o&&(a=pe())!==o?(ee=r,r=V(0,a)):(J=r,r=o);else n=o;n!==o?(ee=e,e=function(e,t){const n=[e,...t];return ke&&n.find((e=>"cursor"===e.type))||Qe("or",n)}(t,n)):(J=e,e=o)}else J=e,e=o;return e===o&&(e=pe()),e}function pe(){var e,t,n,r,a;if(e=J,(t=he())!==o){if(n=[],r=J,Oe()!==o&&(a=he())!==o?(ee=r,r=V(0,a)):(J=r,r=o),r!==o)for(;r!==o;)n.push(r),r=J,Oe()!==o&&(a=he())!==o?(ee=r,r=V(0,a)):(J=r,r=o);else n=o;n!==o?(ee=e,e=function(e,t){const n=[e,...t];return ke&&n.find((e=>"cursor"===e.type))||Qe("and",n)}(t,n)):(J=e,e=o)}else J=e,e=o;return e===o&&(e=he()),e}function he(){var e,t,n;return e=J,je()!==o&&(t=be())!==o?(ee=e,e="cursor"===(n=t).type?n:Qe("not",[n])):(J=e,e=o),e===o&&(e=be()),e}function be(){var t,n,r,a,i,s,u,c;if(t=J,40===e.charCodeAt(J)?(n="(",J++):(n=o,0===oe&&de(g)),n!==o){for(r=[],a=Le();a!==o;)r.push(a),a=Le();(a=fe())!==o&&(i=Te())!==o?(41===e.charCodeAt(J)?(s=")",J++):(s=o,0===oe&&de(v)),s!==o?(ee=t,u=a,t="cursor"===(c=i).type?{...c,suggestionTypes:["conjunction"]}:u):(J=t,t=o)):(J=t,t=o)}else J=t,t=o;return t===o&&(t=function(){var t,n,r,a,i,s,u,c,d,l;if(t=J,(n=ge())!==o){for(r=[],a=Le();a!==o;)r.push(a),a=Le();if(58===e.charCodeAt(J)?(a=":",J++):(a=o,0===oe&&de(m)),a!==o){for(i=[],s=Le();s!==o;)i.push(s),s=Le();if(123===e.charCodeAt(J)?(s="{",J++):(s=o,0===oe&&de(y)),s!==o){for(u=[],c=Le();c!==o;)u.push(c),c=Le();(c=fe())!==o&&(d=Te())!==o?(125===e.charCodeAt(J)?(l="}",J++):(l=o,0===oe&&de(_)),l!==o?(ee=t,t=function(e,t,n){return"cursor"===t.type?{...t,nestedPath:t.nestedPath?`${e.value}.${t.nestedPath}`:e.value}:"cursor"===n.type?{...n,suggestionTypes:["conjunction"]}:Qe("nested",[e,t])}(n,c,d)):(J=t,t=o)):(J=t,t=o)}else J=t,t=o}else J=t,t=o}else J=t,t=o;return t===o&&(t=function(){var t;return t=function(){var t,n,r,a,i,s,u,c,d;if(t=J,(n=ge())!==o){for(r=[],a=Le();a!==o;)r.push(a),a=Le();if(a=function(){var t,n;return t=J,"<="===e.substr(J,2)?(n="<=",J+=2):(n=o,0===oe&&de(q)),n!==o&&(ee=t,n="lte"),(t=n)===o&&(t=J,">="===e.substr(J,2)?(n=">=",J+=2):(n=o,0===oe&&de($)),n!==o&&(ee=t,n="gte"),(t=n)===o&&(t=J,60===e.charCodeAt(J)?(n="<",J++):(n=o,0===oe&&de(B)),n!==o&&(ee=t,n="lt"),(t=n)===o&&(t=J,62===e.charCodeAt(J)?(n=">",J++):(n=o,0===oe&&de(W)),n!==o&&(ee=t,n="gt"),t=n))),t}(),a!==o){for(i=[],s=Le();s!==o;)i.push(s),s=Le();(s=Ee())!==o?(ee=t,u=n,c=a,t="cursor"===(d=s).type?{...d,suggestionTypes:["conjunction"]}:Qe("range",[u,c,d])):(J=t,t=o)}else J=t,t=o}else J=t,t=o;return t}(),t===o&&(t=function(){var t,n,r,a,i,s,u,c;if(t=J,(n=ge())!==o){for(r=[],a=Le();a!==o;)r.push(a),a=Le();if(58===e.charCodeAt(J)?(a=":",J++):(a=o,0===oe&&de(m)),a!==o){for(i=[],s=Le();s!==o;)i.push(s),s=Le();(s=ve())!==o?(ee=t,u=n,t="cursor"===(c=s).type?{...c,fieldName:u.value,suggestionTypes:["value","conjunction"]}:c(u)):(J=t,t=o)}else J=t,t=o}else J=t,t=o;return t}(),t===o&&(t=function(){var e,t;return e=J,(t=_e())!==o&&(ee=e,t=function(e){if("cursor"===e.type){const t=`${e.prefix}${e.suffix}`.trim();return{...e,fieldName:t,suggestionTypes:["field","operator","conjunction"]}}return e(Ge(null))}(t)),t}())),t}()),t}()),t}function ge(){var e;return oe++,e=Ee(),oe--,e===o&&0===oe&&de(w),e}function ve(){var t,n,r,a,i,s,u,c;if(t=J,40===e.charCodeAt(J)?(n="(",J++):(n=o,0===oe&&de(g)),n!==o){for(r=[],a=Le();a!==o;)r.push(a),a=Le();a=function(){var e,t,n,r,a;if(e=J,(t=me())!==o){if(n=[],r=J,we()!==o&&(a=me())!==o?(ee=r,r=X(0,a)):(J=r,r=o),r!==o)for(;r!==o;)n.push(r),r=J,we()!==o&&(a=me())!==o?(ee=r,r=X(0,a)):(J=r,r=o);else n=o;n!==o?(ee=e,e=function(e,t){const n=[e,...t],r=ke&&n.find((e=>"cursor"===e.type));return r?{...r,suggestionTypes:["value"]}:e=>Qe("or",n.map((t=>t(e))))}(t,n)):(J=e,e=o)}else J=e,e=o;return e===o&&(e=me()),e}(),a!==o&&(i=Te())!==o?(41===e.charCodeAt(J)?(s=")",J++):(s=o,0===oe&&de(v)),s!==o?(ee=t,u=a,t="cursor"===(c=i).type?{...c,suggestionTypes:["conjunction"]}:u):(J=t,t=o)):(J=t,t=o)}else J=t,t=o;return t===o&&(t=_e()),t}function me(){var e,t,n,r,a;if(e=J,(t=ye())!==o){if(n=[],r=J,Oe()!==o&&(a=ye())!==o?(ee=r,r=X(0,a)):(J=r,r=o),r!==o)for(;r!==o;)n.push(r),r=J,Oe()!==o&&(a=ye())!==o?(ee=r,r=X(0,a)):(J=r,r=o);else n=o;n!==o?(ee=e,e=function(e,t){const n=[e,...t],r=ke&&n.find((e=>"cursor"===e.type));return r?{...r,suggestionTypes:["value"]}:e=>Qe("and",n.map((t=>t(e))))}(t,n)):(J=e,e=o)}else J=e,e=o;return e===o&&(e=ye()),e}function ye(){var e,t,n;return e=J,je()!==o&&(t=ve())!==o?(ee=e,e="cursor"===(n=t).type?{...list,suggestionTypes:["value"]}:e=>Qe("not",[n(e)])):(J=e,e=o),e===o&&(e=ve()),e}function _e(){var e,t,n;return oe++,e=J,(t=Ce())!==o&&(ee=e,t="cursor"===(n=t).type?n:e=>Qe("is",[e,n])),(e=t)===o&&(e=J,(t=xe())!==o&&(ee=e,t=function(e){return"cursor"===e.type?e:(!Pe&&Ue.wildcard.isNode(e)&&Ue.wildcard.hasLeadingWildcard(e)&&function(e,t){throw function(e,t){return new r("Leading wildcards are disabled. See query:allowLeadingWildcards in Advanced Settings.",null,null,t)}(0,t=void 0!==t?t:ce(ee,J))}(),t=>Qe("is",[t,e]))}(t)),e=t),oe--,e===o&&(t=o,0===oe&&de(O)),e}function we(){var t,n,r,a,i;if(oe++,t=J,n=[],(r=Le())!==o)for(;r!==o;)n.push(r),r=Le();else n=o;if(n!==o)if("or"===e.substr(J,2).toLowerCase()?(r=e.substr(J,2),J+=2):(r=o,0===oe&&de(E)),r!==o){if(a=[],(i=Le())!==o)for(;i!==o;)a.push(i),i=Le();else a=o;a!==o?t=n=[n,r,a]:(J=t,t=o)}else J=t,t=o;else J=t,t=o;return oe--,t===o&&(n=o,0===oe&&de(j)),t}function Oe(){var t,n,r,a,i;if(oe++,t=J,n=[],(r=Le())!==o)for(;r!==o;)n.push(r),r=Le();else n=o;if(n!==o)if("and"===e.substr(J,3).toLowerCase()?(r=e.substr(J,3),J+=3):(r=o,0===oe&&de(D)),r!==o){if(a=[],(i=Le())!==o)for(;i!==o;)a.push(i),i=Le();else a=o;a!==o?t=n=[n,r,a]:(J=t,t=o)}else J=t,t=o;else J=t,t=o;return oe--,t===o&&(n=o,0===oe&&de(C)),t}function je(){var t,n,r,a;if(oe++,t=J,"not"===e.substr(J,3).toLowerCase()?(n=e.substr(J,3),J+=3):(n=o,0===oe&&de(I)),n!==o){if(r=[],(a=Le())!==o)for(;a!==o;)r.push(a),a=Le();else r=o;r!==o?t=n=[n,r]:(J=t,t=o)}else J=t,t=o;return oe--,t===o&&(n=o,0===oe&&de(x)),t}function Ee(){var e;return oe++,(e=Ce())===o&&(e=xe()),oe--,e===o&&0===oe&&de(T),e}function Ce(){var t,n,r,a,i,s,c;if(t=J,ee=J,(n=(n=z())?void 0:o)!==o)if(34===e.charCodeAt(J)?(r=u,J++):(r=o,0===oe&&de(A)),r!==o){for(a=[],i=De();i!==o;)a.push(i),i=De();if((i=Fe())!==o){for(s=[],c=De();c!==o;)s.push(c),c=De();34===e.charCodeAt(J)?(c=u,J++):(c=o,0===oe&&de(A)),c!==o?(ee=t,t=Z(a,i,s)):(J=t,t=o)}else J=t,t=o}else J=t,t=o;else J=t,t=o;if(t===o)if(t=J,34===e.charCodeAt(J)?(n=u,J++):(n=o,0===oe&&de(A)),n!==o){for(r=[],a=De();a!==o;)r.push(a),a=De();34===e.charCodeAt(J)?(a=u,J++):(a=o,0===oe&&de(A)),a!==o?(ee=t,t=Ge(r.join(""),!0)):(J=t,t=o)}else J=t,t=o;return t}function De(){var t,n,r;return(t=Ae())===o&&(t=Re())===o&&(t=J,92===e.charCodeAt(J)?(n=c,J++):(n=o,0===oe&&de(S)),n!==o?(l.test(e.charAt(J))?(r=e.charAt(J),J++):(r=o,0===oe&&de(R)),r!==o?(ee=t,t=r):(J=t,t=o)):(J=t,t=o),t===o&&(t=J,n=J,oe++,r=Fe(),oe--,r===o?n=void 0:(J=n,n=o),n!==o?(f.test(e.charAt(J))?(r=e.charAt(J),J++):(r=o,0===oe&&de(N)),r!==o?(ee=t,t=r):(J=t,t=o)):(J=t,t=o))),t}function xe(){var e,t,n,r,a,i;if(e=J,ee=J,(t=(t=z())?void 0:o)!==o){for(n=[],r=Ie();r!==o;)n.push(r),r=Ie();if((r=Fe())!==o){for(a=[],i=Ie();i!==o;)a.push(i),i=Ie();ee=e,e=Z(n,r,a)}else J=e,e=o}else J=e,e=o;if(e===o){if(e=J,t=[],(n=Ie())!==o)for(;n!==o;)t.push(n),n=Ie();else t=o;t!==o&&(ee=e,t=function(e){const t=e.join("").trim();return"null"===t?Ge(null):"true"===t?Ge(!0):"false"===t?Ge(!1):e.includes($e)?qe(t):Ge(t)}(t)),e=t}return e}function Ie(){var t,n,r,a,i;return(t=Ae())===o&&(t=function(){var t,n,r;return t=J,92===e.charCodeAt(J)?(n=c,J++):(n=o,0===oe&&de(S)),n!==o&&(r=Se())!==o?(ee=t,t=r):(J=t,t=o),t}(),t===o&&(t=Re())===o&&(t=function(){var t,n,r;return t=J,92===e.charCodeAt(J)?(n=c,J++):(n=o,0===oe&&de(S)),n!==o?("or"===e.substr(J,2).toLowerCase()?(r=e.substr(J,2),J+=2):(r=o,0===oe&&de(E)),r===o&&("and"===e.substr(J,3).toLowerCase()?(r=e.substr(J,3),J+=3):(r=o,0===oe&&de(D)),r===o&&("not"===e.substr(J,3).toLowerCase()?(r=e.substr(J,3),J+=3):(r=o,0===oe&&de(I)))),r!==o?(ee=t,t=r):(J=t,t=o)):(J=t,t=o),t}(),t===o&&(t=function(){var t,n;return t=J,42===e.charCodeAt(J)?(n="*",J++):(n=o,0===oe&&de(F)),n!==o&&(ee=t,n=$e),n}(),t===o&&(t=J,n=J,oe++,r=Se(),oe--,r===o?n=void 0:(J=n,n=o),n!==o?(r=J,oe++,a=function(){var e;return(e=we())===o&&(e=Oe())===o&&(e=je()),e}(),oe--,a===o?r=void 0:(J=r,r=o),r!==o?(a=J,oe++,i=Fe(),oe--,i===o?a=void 0:(J=a,a=o),a!==o?(e.length>J?(i=e.charAt(J),J++):(i=o,0===oe&&de(L)),i!==o?(ee=t,t=i):(J=t,t=o)):(J=t,t=o)):(J=t,t=o)):(J=t,t=o))))),t}function Te(){var e,t,n,r,a,i;if(e=J,ee=J,(t=(t=z())?void 0:o)!==o){for(n=[],r=Le();r!==o;)n.push(r),r=Le();if((r=Fe())!==o){for(a=[],i=Le();i!==o;)a.push(i),i=Le();ee=e,e=Z(n,r,a)}else J=e,e=o}else J=e,e=o;if(e===o)for(e=[],t=Le();t!==o;)e.push(t),t=Le();return e}function Ae(){var t,n;return t=J,"\\t"===e.substr(J,2)?(n="\\t",J+=2):(n=o,0===oe&&de(k)),n!==o&&(ee=t,n="\t"),(t=n)===o&&(t=J,"\\r"===e.substr(J,2)?(n="\\r",J+=2):(n=o,0===oe&&de(M)),n!==o&&(ee=t,n="\r"),(t=n)===o&&(t=J,"\\n"===e.substr(J,2)?(n="\\n",J+=2):(n=o,0===oe&&de(P)),n!==o&&(ee=t,n="\n"),t=n)),t}function Se(){var t;return p.test(e.charAt(J))?(t=e.charAt(J),J++):(t=o,0===oe&&de(U)),t}function Re(){var t,n,r;return t=J,92===e.charCodeAt(J)?(n=c,J++):(n=o,0===oe&&de(S)),n!==o?(r=function(){var t,n,r,a,i,s,u,c,d;return t=J,117===e.charCodeAt(J)?(n="u",J++):(n=o,0===oe&&de(Q)),n!==o?(r=J,a=J,(i=Ne())!==o&&(s=Ne())!==o&&(u=Ne())!==o&&(c=Ne())!==o?a=i=[i,s,u,c]:(J=a,a=o),(r=a!==o?e.substring(r,J):a)!==o?(ee=t,d=r,t=String.fromCharCode(parseInt(d,16))):(J=t,t=o)):(J=t,t=o),t}(),r!==o?(ee=t,t=r):(J=t,t=o)):(J=t,t=o),t}function Ne(){var t;return h.test(e.charAt(J))?(t=e.charAt(J),J++):(t=o,0===oe&&de(G)),t}function Le(){var t;return oe++,b.test(e.charAt(J))?(t=e.charAt(J),J++):(t=o,0===oe&&de(Y)),oe--,t===o&&0===oe&&de(K),t}function Fe(){var t,n;return t=J,ee=J,(z()?void 0:o)!==o?(e.substr(J,14)===d?(n=d,J+=14):(n=o,0===oe&&de(H)),n!==o?(ee=t,t=Me):(J=t,t=o)):(J=t,t=o),t}const{parseCursor:ke,cursorSymbol:Me,allowLeadingWildcards:Pe=!0,helpers:{nodeTypes:Ue}}=t,Qe=Ue.function.buildNodeWithArgumentNodes,Ge=Ue.literal.buildNode,qe=Ue.wildcard.buildNode,{KQL_WILDCARD_SYMBOL:$e}=Ue.wildcard;if((n=s())!==o&&J===e.length)return n;throw n!==o&&J<e.length&&de({type:"end"}),Be=re,We=ne<e.length?e.charAt(ne):null,Ke=ne<e.length?ce(ne,ne+1):ce(ne,ne),new r(r.buildMessage(Be,We),Be,We,Ke);var Be,We,Ke}}},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t,n){e.exports=n(9)(17)},function(e,t,n){e.exports=n(9)(16)},function(e,t,n){e.exports=n(9)(4)},function(e,t,n){e.exports=n(9)(19)},function(e,t,n){e.exports=n(9)(2680)},function(e,t,n){e.exports=n(9)(2692)},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/dashboard/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){e.exports=n(9)(3)},function(e,t,n){n(30),__kbnBundles__.define("plugin/dashboardEnhanced/public",n,31)},function(e,t,n){n.p=window.__kbnPublicPath__.dashboardEnhanced},function(e,t,n){"use strict";n.r(t),n.d(t,"DashboardEnhancedAbstractDashboardDrilldown",(function(){return abstract_dashboard_drilldown_AbstractDashboardDrilldown})),n.d(t,"plugin",(function(){return rt}));var r={};n.r(r),n.d(r,"KQL_NODE_TYPE_LITERAL",(function(){return ee})),n.d(r,"isNode",(function(){return te})),n.d(r,"buildNode",(function(){return ne})),n.d(r,"toElasticsearchQuery",(function(){return re}));var o={};n.r(o),n.d(o,"KQL_WILDCARD_SYMBOL",(function(){return oe})),n.d(o,"KQL_NODE_TYPE_WILDCARD",(function(){return ae})),n.d(o,"isNode",(function(){return ue})),n.d(o,"isMatchAll",(function(){return ce})),n.d(o,"buildNode",(function(){return de})),n.d(o,"test",(function(){return le})),n.d(o,"toElasticsearchQuery",(function(){return fe})),n.d(o,"toQueryStringQuery",(function(){return pe})),n.d(o,"isLoneWildcard",(function(){return he})),n.d(o,"hasLeadingWildcard",(function(){return be}));var a={};n.r(a),n.d(a,"buildNodeParams",(function(){return Oe})),n.d(a,"toElasticsearchQuery",(function(){return je}));var i={};n.r(i),n.d(i,"buildNodeParams",(function(){return Ee})),n.d(i,"toElasticsearchQuery",(function(){return Ce}));var s={};n.r(s),n.d(s,"buildNodeParams",(function(){return De})),n.d(s,"toElasticsearchQuery",(function(){return xe}));var u={};n.r(u),n.d(u,"buildNodeParams",(function(){return Ie})),n.d(u,"toElasticsearchQuery",(function(){return Te}));var c={};n.r(c),n.d(c,"buildNodeParams",(function(){return Ae})),n.d(c,"toElasticsearchQuery",(function(){return Se}));var d={};n.r(d),n.d(d,"buildNodeParams",(function(){return Re})),n.d(d,"toElasticsearchQuery",(function(){return Ne}));var l={};n.r(l),n.d(l,"buildNodeParams",(function(){return Le})),n.d(l,"toElasticsearchQuery",(function(){return Fe}));var f={};n.r(f),n.d(f,"buildNode",(function(){return Me})),n.d(f,"buildNodeWithArgumentNodes",(function(){return Pe})),n.d(f,"toElasticsearchQuery",(function(){return Ue}));var p=n(1),h=n.n(p),b=n(7),g=n(15),v=n(12),m=n.n(v),y=n(5),_=n(6),w=n(17),O=n(13),j=n(11),E=n(14);function C(e){return e.includes(E.APPLY_FILTER_TRIGGER)||!e.includes(b.VALUE_CLICK_TRIGGER)&&!e.includes(b.SELECT_RANGE_TRIGGER)?e:[...e,E.APPLY_FILTER_TRIGGER]}const D=e=>{const t=[],n=e.id,r=e.getRoot();if(!r)return t;if(!(r instanceof b.Container))return t;const o=r.getChildIds();for(const e of o){const o=r.getChild(e);if(o.id===n)continue;if(!Object(j.isEnhancedEmbeddable)(o))continue;const a=o.enhancements.dynamicActions.state.get().events;for(const e of a){const n={id:e.eventId,name:e.action.name,icon:"dashboardApp",description:o.getTitle()||o.id,config:e.action.config,factoryId:e.action.factoryId,triggers:e.triggers};t.push(n)}}return t};var x=n(3);const I="OPEN_FLYOUT_ADD_DRILLDOWN";class flyout_create_drilldown_FlyoutCreateDrilldownAction{constructor(e){h()(this,"type",I),h()(this,"id",I),h()(this,"order",12),h()(this,"grouping",j.embeddableEnhancedDrilldownGrouping),this.params=e}getDisplayName(){return y.i18n.translate("xpack.dashboard.FlyoutCreateDrilldownAction.displayName",{defaultMessage:"Create drilldown"})}getIconType(){return"plusInCircle"}isEmbeddableCompatible(e){if(!Object(j.isEnhancedEmbeddable)(e.embeddable))return!1;if("dashboard"!==e.embeddable.getRoot().type)return!1;const t=[b.CONTEXT_MENU_TRIGGER,...e.embeddable.supportedTriggers()||[]],n=this.params.start().plugins.uiActionsEnhanced.getActionFactories().map((e=>e.isCompatibleLicense()?e.supportedTriggers():[])).reduce(((e,t)=>e.concat(t)),[]);return C(t).some((e=>n.includes(e)))}async isCompatible(e){return"edit"===e.embeddable.getInput().viewMode&&this.isEmbeddableCompatible(e)}async execute(e){const{core:t,plugins:n}=this.params.start(),{embeddable:r}=e;if(!Object(j.isEnhancedEmbeddable)(r))throw new Error("Need embeddable to be EnhancedEmbeddable to execute FlyoutCreateDrilldownAction.");const o=D(r),a=new w.Subject,i=()=>{a.next(!0),c.close()},s=()=>{i()},u=[...C(r.supportedTriggers()),b.CONTEXT_MENU_TRIGGER],c=t.overlays.openFlyout(Object(O.toMountPoint)(Object(x.jsx)(n.uiActionsEnhanced.DrilldownManager,{closeAfterCreate:!0,initialRoute:"/new",dynamicActionManager:r.enhancements.dynamicActions,triggers:u,placeContext:{embeddable:r},templates:o,onClose:i})),{ownFocus:!0,"data-test-subj":"createDrilldownFlyout"});t.application.currentAppId$.pipe(Object(_.takeUntil)(a),Object(_.skip)(1),Object(_.take)(1)).subscribe(s),r.getInput$().pipe(Object(_.takeUntil)(a),Object(_.map)((e=>e.viewMode)),Object(_.distinctUntilChanged)(),Object(_.filter)((e=>e!==b.ViewMode.EDIT)),Object(_.take)(1)).subscribe({next:s,complete:s})}}const T=y.i18n.translate("xpack.dashboard.panel.openFlyoutEditDrilldown.displayName",{defaultMessage:"Manage drilldowns"});var A=n(8);const S=({context:e})=>{const{events:t}=Object(g.useContainerState)(e.embeddable.enhancements.dynamicActions.state),n=t.length;return Object(x.jsx)(A.EuiFlexGroup,{alignItems:"center"},Object(x.jsx)(A.EuiFlexItem,{grow:!0},T),n>0&&Object(x.jsx)(A.EuiFlexItem,{grow:!1},Object(x.jsx)(A.EuiNotificationBadge,null,n)))},R="OPEN_FLYOUT_EDIT_DRILLDOWN";class flyout_edit_drilldown_FlyoutEditDrilldownAction{constructor(e){h()(this,"type",R),h()(this,"id",R),h()(this,"order",10),h()(this,"grouping",j.embeddableEnhancedDrilldownGrouping),h()(this,"MenuItem",Object(O.reactToUiComponent)(S)),this.params=e}getDisplayName(){return T}getIconType(){return"list"}async isCompatible({embeddable:e}){return e.getInput().viewMode===b.ViewMode.EDIT&&!!Object(j.isEnhancedEmbeddable)(e)&&e.enhancements.dynamicActions.state.get().events.length>0}async execute(e){const{core:t,plugins:n}=this.params.start(),{embeddable:r}=e;if(!Object(j.isEnhancedEmbeddable)(r))throw new Error("Need embeddable to be EnhancedEmbeddable to execute FlyoutEditDrilldownAction.");const o=D(r),a=new w.Subject,i=()=>{a.next(!0),u.close()},s=()=>{i()},u=t.overlays.openFlyout(Object(O.toMountPoint)(Object(x.jsx)(n.uiActionsEnhanced.DrilldownManager,{initialRoute:"/manage",dynamicActionManager:r.enhancements.dynamicActions,triggers:[...C(r.supportedTriggers()),b.CONTEXT_MENU_TRIGGER],placeContext:{embeddable:r},templates:o,onClose:i})),{ownFocus:!0,"data-test-subj":"editDrilldownFlyout"});t.application.currentAppId$.pipe(Object(_.takeUntil)(a),Object(_.skip)(1),Object(_.take)(1)).subscribe(s),r.getInput$().pipe(Object(_.takeUntil)(a),Object(_.map)((e=>e.viewMode)),Object(_.distinctUntilChanged)(),Object(_.filter)((e=>e!==b.ViewMode.EDIT)),Object(_.take)(1)).subscribe({next:s,complete:s})}}var N,L,F=n(2),k=n.n(F),M=n(0),P=n.n(M),U=(n(16),function(e,t){if("boolean"!=typeof t&&"boolean"===e.type){if([1,"true"].includes(t))return!0;if([0,"false"].includes(t))return!1;throw new Error("".concat(t," is not a valid boolean value for boolean field ").concat(e.name))}return"number"!=typeof t&&"number"===e.type?Number(t):t}),Q={gt:">",gte:">=",lte:"<=",lt:"<"},G={gt:"boolean gt(Supplier s, def v) {return s.get() > v}",gte:"boolean gte(Supplier s, def v) {return s.get() >= v}",lte:"boolean lte(Supplier s, def v) {return s.get() <= v}",lt:"boolean lt(Supplier s, def v) {return s.get() < v}"},q={gt:"boolean gt(Supplier s, def v) {return s.get().toInstant().isAfter(Instant.parse(v))}",gte:"boolean gte(Supplier s, def v) {return !s.get().toInstant().isBefore(Instant.parse(v))}",lte:"boolean lte(Supplier s, def v) {return !s.get().toInstant().isAfter(Instant.parse(v))}",lt:"boolean lt(Supplier s, def v) {return s.get().toInstant().isBefore(Instant.parse(v))}"},$=function(e,t){var n=Object(M.mapValues)(Object(M.pickBy)(t,(function(e,t){return t in Q})),(function(t){return"number"===e.type&&"string"==typeof t?parseFloat(t):t})),r=Object(M.map)(n,(function(t,n){return"("+e.script+")"+Object(M.get)(Q,n)+n})).join(" && ");if("painless"===e.lang){var o="date"===e.type?q:G,a=Object(M.reduce)(n,(function(e,t,n){return e.concat(Object(M.get)(o,n))}),[]).join(" "),i=Object(M.map)(n,(function(t,n){return"".concat(n,"(() -> { ").concat(e.script," }, params.").concat(n,")")})).join(" && ");r="".concat(a).concat(i)}return{script:{source:r,params:n,lang:e.lang}}},B=function(e,t){var n=U(e,t);return{script:{source:W(e),lang:e.lang,params:{value:n}}}},W=function(e){return"painless"===e.lang?"boolean compare(Supplier s, def v) {return s.get() == v;}"+"compare(() -> { ".concat(e.script," }, params.value);"):"(".concat(e.script,") == value")};!function(e){e.CUSTOM="custom",e.PHRASES="phrases",e.PHRASE="phrase",e.EXISTS="exists",e.MATCH_ALL="match_all",e.QUERY_STRING="query_string",e.RANGE="range",e.RANGE_FROM_VALUE="range_from_value",e.SPATIAL_FILTER="spatial_filter"}(N||(N={})),function(e){e.APP_STATE="appState",e.GLOBAL_STATE="globalState"}(L||(L={}));var K=function(e){return e.$state&&e.$state.store===L.GLOBAL_STATE},Y=n(10),H=n.n(Y),V=n(18),X=n.n(V);function z(e,t){if(!t)return{restOfFilters:e,timeRange:void 0};var n,r,o,a,i=function(e,t){var n=Object(M.partition)(t,(function(t){var n,r;return r=t,Object(M.has)(r,"query.range")&&(n=Object(M.keys)(t.query.range)[0]),Boolean(n&&n===e)})),r=H()(n,2),o=r[0];return{restOfFilters:r[1],timeRangeFilter:o[0]}}(t,e),s=i.timeRangeFilter;return{restOfFilters:i.restOfFilters,timeRange:s?(n=s,r=function(e){var t=Object(M.keys)(e.query.range)[0],n=e.query.range[t];return{from:X()(n.gt||n.gte),to:X()(n.lt||n.lte)}}(n),o=r.from,a=r.to,{from:null==o?void 0:o.toISOString(),to:null==a?void 0:a.toISOString()}):void 0}}var Z=n(4),J=n.n(Z),ee="literal";function te(e){return e.type===ee}function ne(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:ee,value:e,isQuoted:t}}function re(e){return e.value}var oe="@kuery-wildcard@",ae="wildcard";function ie(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function se(e){return e.replace(/[+-=&|><!(){}[\]^"~*?:\\/]/g,"\\$&")}function ue(e){return e.type===ae}function ce(e){return e.value===oe}function de(e){return!e.includes(ae)&&e.includes("*")?de(e.replaceAll("*",oe)):{type:ae,value:e}}function le(e,t){var n=e.value.split(oe).map(ie).join("[\\s\\S]*");return new RegExp("^".concat(n,"$")).test(t)}function fe(e){return e.value.split(oe).join("*")}function pe(e){return e.value.split(oe).map(se).join("*")}function he(e){var t=e.value;return t.includes(oe)&&0===t.replace(oe,"").length}function be(e){return!he(e)&&e.value.startsWith(oe)}function ge(e,t){if(!t)return[];if(te(e)){var n=re(e),r=t.fields.find((function(e){return e.name===n}));return r?[r]:[]}return ue(e)?t.fields.filter((function(t){return le(e,t.name)})):void 0}var ve=n(20),me=n.n(ve);function ye(e){var t=me.a.tz.guess();return"Browser"===e?t:e}function _e(e){return function(e){var t,n=null==e?void 0:e.subType;return!(null==n||null===(t=n.nested)||void 0===t||!t.path)}(e)?e.subType:void 0}function we(e,t,n){var r=k()(k()({},e),{},{value:n?"".concat(n,".").concat(e.value):e.value});if(!t||ue(r)&&!n)return r;var o=ge(r,t).reduce((function(e,t){var r=_e(t),o=null==r?void 0:r.nested.path;return n&&!o?[].concat(J()(e),["".concat(t.name,' is not a nested field but is in nested group "').concat(n,'" in the KQL expression.')]):o&&!n?[].concat(J()(e),["".concat(t.name," is a nested field, but is not in a nested group in the KQL expression.")]):o!==n?[].concat(J()(e),["Nested field ".concat(t.name," is being queried with the incorrect nested path. The correct path is ").concat(null==r?void 0:r.nested.path,".")]):e}),[]);if(o.length>0)throw new Error(o.join("\n"));return r}function Oe(e,t){if(Object(M.isUndefined)(e))throw new Error("fieldName is a required argument");if(Object(M.isUndefined)(t))throw new Error("value is a required argument");return{arguments:["string"==typeof e?$e(e):ne(e),"string"==typeof t?$e(t):ne(t)]}}function je(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=H()(e.arguments,2),a=o[0],i=o[1],s=ue(i)&&he(i),u=ue(a)&&he(a),c=s&&u;if(c)return{match_all:{}};var d=we(a,t,null!=r&&r.nested?r.nested.path:void 0),l=Object(M.isUndefined)(i)?i:Be(i),f=i.isQuoted?"phrase":"best_fields";if(null===d.value)return ue(i)?{query_string:{query:pe(i)}}:{multi_match:{type:f,query:l,lenient:!0}};var p=t?ge(d,t):[];if(p&&0===p.length&&p.push({name:Be(d),scripted:!1,type:""}),s&&(null==p||!p.length||(null==p?void 0:p.length)===(null==t?void 0:t.fields.length)))return{match_all:{}};var b=p.reduce((function(e,t){var o=function(e){var o=_e(t);return!ue(d)||null==o||!o.nested||null!=r&&r.nested?e:{nested:k()({path:o.nested.path,query:e,score_mode:"none"},"boolean"==typeof n.nestedIgnoreUnmapped&&{ignore_unmapped:n.nestedIgnoreUnmapped})}};if(!t.scripted){if(s)return[].concat(J()(e),[o({exists:{field:t.name}})]);if(ue(i)){var a,u=null!==(a=t.esTypes)&&void 0!==a&&a.includes("keyword")?{wildcard:h()({},t.name,l)}:{query_string:{fields:[t.name],query:pe(i)}};return[].concat(J()(e),[o(u)])}if("date"===t.type){var c=n.dateFormatTZ?{time_zone:ye(n.dateFormatTZ)}:{};return[].concat(J()(e),[o({range:h()({},t.name,k()({gte:l,lte:l},c))})])}var p="phrase"===f?"match_phrase":"match";return[].concat(J()(e),[o(h()({},p,h()({},t.name,l)))])}if(!s)return[].concat(J()(e),[{script:k()({},B(t,l))}])}),[]);return{bool:{should:b||[],minimum_should_match:1}}}function Ee(e){return{arguments:e}}function Ce(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.filtersInMustClause,a=e.arguments||[],i=o?"must":"filter";return{bool:h()({},i,a.map((function(e){return Be(e,t,n,r)})))}}function De(e){return{arguments:e}}function xe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.arguments||[];return{bool:{should:o.map((function(e){return Be(e,t,n,r)})),minimum_should_match:1}}}function Ie(e){return{arguments:[e]}}function Te(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=H()(e.arguments,1),a=o[0];return{bool:{must_not:Be(a,t,n,r)}}}function Ae(e,t,n){return{arguments:[$e(e),t,Qe.literal.buildNode(n)]}}function Se(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=H()(e.arguments,3),a=o[0],i=o[1],s=o[2],u=we(a,t,null!=r&&r.nested?r.nested.path:void 0),c=t?ge(u,t):[];c&&0===c.length&&c.push({name:Be(u),scripted:!1,type:""});var d=c.map((function(e){var t=function(t){var o=_e(e);return Qe.wildcard.isNode(u)&&null!=o&&o.nested&&!r.nested?{nested:k()({path:o.nested.path,query:t,score_mode:"none"},"boolean"==typeof n.nestedIgnoreUnmapped&&{ignore_unmapped:n.nestedIgnoreUnmapped})}:t},o=h()({},i,Be(s));if(e.scripted)return{script:$(e,o)};if("date"===e.type){var a=n.dateFormatTZ?{time_zone:ye(n.dateFormatTZ)}:{};return t({range:h()({},e.name,k()(k()({},o),a))})}return t({range:h()({},e.name,o)})}));return{bool:{should:d,minimum_should_match:1}}}function Re(e){return{arguments:[ne(e)]}}function Ne(e,t){var n,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=H()(e.arguments,1),a=o[0],i=k()(k()({},a),{},{value:null!=r&&r.nested?"".concat(r.nested.path,".").concat(a.value):a.value}),s=re(i),u=null==t||null===(n=t.fields)||void 0===n?void 0:n.find((function(e){return e.name===s}));if(null!=u&&u.scripted)throw new Error("Exists query does not support scripted fields");return{exists:{field:s}}}function Le(e,t){return{arguments:["string"==typeof e?$e(e):ne(e),t]}}function Fe(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=H()(e.arguments,2),i=a[0],s=a[1],u=Be(i),c=null!=o&&null!==(n=o.nested)&&void 0!==n&&n.path?"".concat(o.nested.path,".").concat(u):u;return{nested:k()({path:c,query:Be(s,t,r,k()(k()({},o),{},{nested:{path:c}})),score_mode:"none"},"boolean"==typeof r.nestedIgnoreUnmapped&&{ignore_unmapped:r.nestedIgnoreUnmapped})}}var ke={is:a,and:i,or:s,not:u,range:c,exists:d,nested:l};function Me(e){var t=ke[e];if(P.a.isUndefined(t))throw new Error('Unknown function "'.concat(e,'"'));for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return k()({type:"function",function:e},t.buildNodeParams.apply(t,r))}function Pe(e,t){if(P.a.isUndefined(ke[e]))throw new Error('Unknown function "'.concat(e,'"'));return{type:"function",function:e,arguments:t}}function Ue(e,t,n,r){return ke[e.function].toElasticsearchQuery(e,t,n,r)}var Qe={function:f,literal:r,wildcard:o},Ge=(n(21),n(22),n(23),n(24),n(25),n(26),y.i18n.translate("esQuery.kql.errors.endOfInputText",{defaultMessage:"end of input"}),y.i18n.translate("esQuery.kql.errors.fieldNameText",{defaultMessage:"field name"}),y.i18n.translate("esQuery.kql.errors.valueText",{defaultMessage:"value"}),y.i18n.translate("esQuery.kql.errors.literalText",{defaultMessage:"literal"}),y.i18n.translate("esQuery.kql.errors.whitespaceText",{defaultMessage:"whitespace"}),Error,n(19)),qe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ge.parse;if(void 0===e)throw new Error("expression must be a string, got undefined instead");return n(e,k()(k()({},t),{},{helpers:{nodeTypes:Qe}}))},$e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return qe(e,k()(k()({},t),{},{startRule:"Literal"}),Ge.parse)},Be=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;if(!t||!t.type||!Qe[t.type])return e(Qe.function.buildNode("and",[]),n);var a=Qe[t.type];return a.toElasticsearchQuery(t,n,r,o)};Object(M.flow)((function(e){return e.replace(/[\\():<>"*]/g,"\\$&")}),(function(e){return e.replace(/(\s+)(and|or)(\s+)/gi,"$1\\$2$3")}),(function(e){return e.replace(/not(\s+)/gi,"\\$&")}),(function(e){return e.replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n")}));var We=n(27),Ke=n(28),Ye=n.n(Ke);const He=y.i18n.translate("xpack.dashboard.components.DashboardDrilldownConfig.chooseDestinationDashboard",{defaultMessage:"Choose destination dashboard"}),Ve=y.i18n.translate("xpack.dashboard.components.DashboardDrilldownConfig.useCurrentFilters",{defaultMessage:"Use filters and query from origin dashboard"}),Xe=y.i18n.translate("xpack.dashboard.components.DashboardDrilldownConfig.useCurrentDateRange",{defaultMessage:"Use date range from origin dashboard"}),ze=y.i18n.translate("xpack.dashboard.components.DashboardDrilldownConfig.openInNewTab",{defaultMessage:"Open dashboard in new tab"}),Ze=({activeDashboardId:e,dashboards:t,currentFilters:n,keepRange:r,openInNewTab:o,onDashboardSelect:a,onCurrentFiltersToggle:i,onKeepRangeToggle:s,onOpenInNewTab:u,onSearchChange:c,isLoading:d,error:l})=>{var f;const p=(null===(f=t.find((t=>t.value===e)))||void 0===f?void 0:f.label)||"";return Object(x.jsx)(m.a.Fragment,null,Object(x.jsx)(A.EuiFormRow,{label:He,fullWidth:!0,isInvalid:!!l,error:l},Object(x.jsx)(A.EuiComboBox,{async:!0,selectedOptions:e?[{label:p,value:e}]:[],options:t,onChange:([{value:e=""}={value:""}])=>a(e),onSearchChange:c,isLoading:d,singleSelection:{asPlainText:!0},fullWidth:!0,"data-test-subj":"dashboardDrilldownSelectDashboard",isInvalid:!!l})),!!i&&Object(x.jsx)(A.EuiFormRow,{hasChildLabel:!1},Object(x.jsx)(A.EuiSwitch,{name:"useCurrentFilters",label:Ve,checked:!!n,onChange:i})),!!s&&Object(x.jsx)(A.EuiFormRow,{hasChildLabel:!1},Object(x.jsx)(A.EuiSwitch,{name:"useCurrentDateRange",label:Xe,checked:!!r,onChange:s})),!!u&&Object(x.jsx)(A.EuiFormRow,{hasChildLabel:!1},Object(x.jsx)(A.EuiSwitch,{name:"openInNewTab",label:ze,checked:!!o,onChange:u})))},Je=(e,t)=>t&&-1===Object(M.findIndex)(e,{value:t.value})?[t,...e]:e,et=e=>({value:e.id,label:e.attributes.title});class collect_config_container_CollectConfigContainer extends m.a.Component{constructor(e){super(e),h()(this,"isMounted",!0),h()(this,"state",{dashboards:[],isLoading:!1,searchString:void 0,selectedDashboard:void 0,error:void 0}),h()(this,"debouncedLoadDashboards",void 0),this.debouncedLoadDashboards=Object(M.debounce)(this.loadDashboards.bind(this),500)}componentDidMount(){this.loadSelectedDashboard(),this.loadDashboards()}componentWillUnmount(){this.isMounted=!1}render(){const{config:e,onConfig:t}=this.props,{dashboards:n,selectedDashboard:r,isLoading:o,error:a}=this.state;return Object(x.jsx)(Ze,{activeDashboardId:e.dashboardId,dashboards:Je(n,r),currentFilters:e.useCurrentFilters,keepRange:e.useCurrentDateRange,openInNewTab:e.openInNewTab,isLoading:o,error:a,onDashboardSelect:n=>{t({...e,dashboardId:n}),this.state.error&&this.setState({error:void 0})},onSearchChange:this.debouncedLoadDashboards,onCurrentFiltersToggle:()=>t({...e,useCurrentFilters:!e.useCurrentFilters}),onKeepRangeToggle:()=>t({...e,useCurrentDateRange:!e.useCurrentDateRange}),onOpenInNewTab:()=>t({...e,openInNewTab:!e.openInNewTab})})}async loadSelectedDashboard(){var e;const{config:t,params:{start:n}}=this.props;if(!t.dashboardId)return;const r=await n().core.savedObjects.client.get("dashboard",t.dashboardId);var o;return this.isMounted?404===(null===(e=r.error)||void 0===e?void 0:e.statusCode)?(this.setState({error:(o=t.dashboardId,y.i18n.translate("xpack.dashboard.drilldown.errorDestinationDashboardIsMissing",{defaultMessage:"Destination dashboard ('{dashboardId}') no longer exists. Choose another dashboard.",values:{dashboardId:o}}))}),void this.props.onConfig({...t,dashboardId:void 0})):r.error?(this.setState({error:r.error.message}),void this.props.onConfig({...t,dashboardId:void 0})):void this.setState({selectedDashboard:et(r)}):void 0}async loadDashboards(e){this.setState({searchString:e,isLoading:!0});const t=this.props.params.start().core.savedObjects.client,{savedObjects:n}=await t.find({type:"dashboard",search:e?`${e}*`:void 0,searchFields:["title^3","description"],defaultSearchOperator:"AND",perPage:100});if(!this.isMounted)return;if(e!==this.state.searchString)return;const r=n.map(et);this.setState({dashboards:r,isLoading:!1})}}const tt=y.i18n.translate("xpack.dashboard.drilldown.goToDashboard",{defaultMessage:"Go to Dashboard"});class abstract_dashboard_drilldown_AbstractDashboardDrilldown{constructor(e){h()(this,"id",void 0),h()(this,"supportedTriggers",void 0),h()(this,"order",100),h()(this,"getDisplayName",(()=>tt)),h()(this,"euiIcon","dashboardApp"),h()(this,"ReactCollectConfig",void 0),h()(this,"CollectConfig",void 0),h()(this,"createConfig",(()=>({dashboardId:"",useCurrentFilters:!0,useCurrentDateRange:!0,openInNewTab:!1}))),h()(this,"isConfigValid",(e=>!!e.dashboardId)),h()(this,"getHref",(async(e,t)=>{const{app:n,path:r}=await this.getLocation(e,t,!0);return await this.params.start().core.application.getUrlForApp(n,{path:r,absolute:!0})})),h()(this,"execute",(async(e,t)=>{if(e.openInNewTab)window.open(await this.getHref(e,t),"_blank");else{const{app:n,path:r,state:o}=await this.getLocation(e,t,!1);await this.params.start().core.application.navigateToApp(n,{path:r,state:o})}})),this.params=e,this.ReactCollectConfig=e=>Object(x.jsx)(collect_config_container_CollectConfigContainer,Ye()({},e,{params:this.params})),this.CollectConfig=Object(O.reactToUiComponent)(this.ReactCollectConfig)}get locator(){const e=this.params.start().plugins.dashboard.locator;if(!e)throw new Error("Dashboard locator is required for dashboard drilldown.");return e}}const nt=(e,t)=>`drilldown:${t}:${e.eventId}:dashboardId`;class embeddable_to_dashboard_drilldown_EmbeddableToDashboardDrilldown extends abstract_dashboard_drilldown_AbstractDashboardDrilldown{constructor(...e){super(...e),h()(this,"id","DASHBOARD_TO_DASHBOARD_DRILLDOWN"),h()(this,"supportedTriggers",(()=>[E.APPLY_FILTER_TRIGGER])),h()(this,"inject",(({drilldownId:e})=>(t,n)=>{const r=t.action,o=nt(t,e),a=n.find((e=>e.name===o));return a?a.id&&a.id===r.config.dashboardId?t:((e,t)=>({...e,action:{...e.action,config:{...e.action.config,dashboardId:t}}}))(t,a.id):t})({drilldownId:this.id})),h()(this,"extract",(({drilldownId:e})=>t=>{const n=t.action,r=n.config.dashboardId?[{name:nt(t,e),type:"dashboard",id:n.config.dashboardId}]:[],{dashboardId:o,...a}=n.config;return{state:{...t,action:{...t.action,config:a}},references:r}})({drilldownId:this.id}))}async getLocation(e,t,n){const r={dashboardId:e.dashboardId};if(t.embeddable){var o;const n=t.embeddable.getInput();Object(E.isQuery)(n.query)&&e.useCurrentFilters&&(r.query=n.query),Object(E.isTimeRange)(n.timeRange)&&e.useCurrentDateRange&&(r.timeRange=n.timeRange),r.filters=e.useCurrentFilters?n.filters:null===(o=n.filters)||void 0===o?void 0:o.filter((e=>K(e)))}const{restOfFilters:a,timeRange:i}=z(t.filters,t.timeFieldName);var s;a&&(r.filters=[...null!==(s=r.filters)&&void 0!==s?s:[],...a]),i&&(r.timeRange=i);const u=await this.locator.getLocation(r);return n&&this.useUrlForState(u),u}useUrlForState(e){var t;const n=e.state;e.path=Object(g.setStateToKbnUrl)("_a",Object(We.cleanEmptyKeys)({query:n.query,filters:null===(t=n.filters)||void 0===t?void 0:t.filter((e=>!K(e))),savedQuery:n.savedQuery}),{useHash:!1,storeInHashQuery:!0},e.path)}}class dashboard_drilldowns_services_DashboardDrilldownsService{bootstrap(e,t,{enableDrilldowns:n}){n&&this.setupDrilldowns(e,t)}setupDrilldowns(e,{uiActionsEnhanced:t}){const n=Object(g.createStartServicesGetter)(e.getStartServices),r=new flyout_create_drilldown_FlyoutCreateDrilldownAction({start:n});t.addTriggerAction(b.CONTEXT_MENU_TRIGGER,r);const o=new flyout_edit_drilldown_FlyoutEditDrilldownAction({start:n});t.addTriggerAction(b.CONTEXT_MENU_TRIGGER,o);const a=new embeddable_to_dashboard_drilldown_EmbeddableToDashboardDrilldown({start:n});t.registerDrilldown(a)}}class plugin_DashboardEnhancedPlugin{constructor(e){h()(this,"drilldowns",new dashboard_drilldowns_services_DashboardDrilldownsService),this.context=e}setup(e,t){return this.drilldowns.bootstrap(e,t,{enableDrilldowns:!0}),{}}start(e,t){return{}}stop(){}}function rt(e){return new plugin_DashboardEnhancedPlugin(e)}}]);