/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[16],Array(205).concat([function(e,t,a){"use strict";a.d(t,"A",(function(){return g})),a.d(t,"e",(function(){return f})),a.d(t,"H",(function(){return b})),a.d(t,"O",(function(){return h})),a.d(t,"m",(function(){return y})),a.d(t,"F",(function(){return E})),a.d(t,"s",(function(){return v})),a.d(t,"M",(function(){return k})),a.d(t,"N",(function(){return S})),a.d(t,"f",(function(){return T})),a.d(t,"E",(function(){return x})),a.d(t,"x",(function(){return w})),a.d(t,"C",(function(){return O})),a.d(t,"n",(function(){return j})),a.d(t,"d",(function(){return I})),a.d(t,"K",(function(){return C})),a.d(t,"a",(function(){return M})),a.d(t,"I",(function(){return D})),a.d(t,"q",(function(){return P})),a.d(t,"i",(function(){return _})),a.d(t,"k",(function(){return q})),a.d(t,"j",(function(){return N})),a.d(t,"l",(function(){return L})),a.d(t,"J",(function(){return H})),a.d(t,"P",(function(){return $})),a.d(t,"c",(function(){return V})),a.d(t,"y",(function(){return U})),a.d(t,"b",(function(){return Q})),a.d(t,"z",(function(){return W})),a.d(t,"D",(function(){return G})),a.d(t,"L",(function(){return K})),a.d(t,"B",(function(){return J})),a.d(t,"w",(function(){return Y})),a.d(t,"r",(function(){return X})),a.d(t,"h",(function(){return Z})),a.d(t,"p",(function(){return ee})),a.d(t,"o",(function(){return te})),a.d(t,"v",(function(){return ae})),a.d(t,"u",(function(){return ne})),a.d(t,"g",(function(){return ie})),a.d(t,"t",(function(){return se})),a.d(t,"G",(function(){return re}));var n=a(14),i=a(363),s=a(454),r=a(182),o=a(364),l=a(353);const c=Object(n.createSelector)((e=>e),(({ariaActiveDescendant:e})=>e)),u=Object(n.createSelector)((e=>e),(({selectedNode:e})=>e)),d=Object(n.createSelector)((e=>e.locationSearch),(e=>e.resolverComponentInstanceID),((e,t)=>Object(o.a)({locationSearch:e,resolverComponentInstanceID:t}))),p=Object(n.createSelector)((e=>e.locationSearch),(e=>e.resolverComponentInstanceID),((e,t)=>a=>{if(void 0===e||void 0===t)return;const n=new URLSearchParams(e),i=Object(r.encode)(a);return n.set(Object(l.a)(t),i),`?${n.toString()}`}));var m=a(237);const g=oe(A,i.c),f=(oe(A,i.f),oe(F,s.d)),b=(oe(A,i.a),oe(A,i.d),oe(A,i.e)),h=oe(A,i.g),y=oe(A,i.b),E=oe(F,s.B),v=oe(F,s.q),k=oe(F,s.G),S=oe(F,s.H),T=oe(F,s.e),x=oe(F,s.A),w=oe(F,s.u),O=oe(F,s.z),j=oe(F,s.l),I=oe(F,s.c),C=oe(F,s.E),M=oe(R,c),D=oe(R,u);function A(e){return e.camera}function F(e){return e.data}function R(e){return e.ui}const P=oe(F,s.o),_=oe(F,s.h),q=oe(F,s.j),N=oe(F,s.i),L=oe(F,s.k),B=oe(A,i.h),z=oe(F,s.v),H=oe(F,s.D),$=Object(n.createSelector)(z,B,(function(e,t){return a=>e(t(a))})),V=oe(F,s.b),U=oe(F,s.w),Q=Object(n.createSelector)($,oe(F,s.a),(function(e,t){return Object(n.defaultMemoize)((a=>{const{processNodePositions:n}=e(a),i=new Set;for(const e of n.keys()){const t=m.b(e);void 0!==t&&i.add(t)}return e=>{const a=t(e);return null===a||!1===i.has(a)?null:a}}))})),W=oe(R,d),G=oe(R,p),K=oe(F,s.F),J=oe(F,s.y),Y=oe(F,s.t),X=oe(F,s.p),Z=oe(F,s.g),ee=oe(F,s.n),te=oe(F,s.m),ae=oe(F,s.s),ne=oe(F,s.r),ie=oe(F,s.f),se=Object(n.createSelector)(oe(F,(e=>e.nodeData)),$,(function(e,t){return Object(n.defaultMemoize)((a=>{const{processNodePositions:n}=t(a),i=new Set;for(const t of n.keys()){const a=m.b(t);void 0===a||e&&e.has(a)||i.add(a)}return i}))})),re=oe(F,s.C);function oe(e,t){return a=>t(e(a))}},,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"e",(function(){return n})),a.d(t,"a",(function(){return g})),a.d(t,"d",(function(){return f}));var n={};a.r(n),a.d(n,"dnsSelector",(function(){return E})),a.d(n,"topNFlowSelector",(function(){return k})),a.d(n,"tlsSelector",(function(){return T})),a.d(n,"topCountriesSelector",(function(){return w})),a.d(n,"httpSelector",(function(){return j})),a.d(n,"usersSelector",(function(){return I})),a.d(n,"networkAnomaliesJobIdFilterSelector",(function(){return C})),a.d(n,"networkAnomaliesIntervalSelector",(function(){return M}));var i=a(389),s=a(294),r=a(14),o=a(3),l=a(99),c=a(45),u=a(77),d=a(319);const p=e=>({...e.page.queries,[s.NetworkTableType.topCountriesSource]:{...e.page.queries[s.NetworkTableType.topCountriesSource],activePage:d.a},[s.NetworkTableType.topCountriesDestination]:{...e.page.queries[s.NetworkTableType.topCountriesDestination],activePage:d.a},[s.NetworkTableType.topNFlowSource]:{...e.page.queries[s.NetworkTableType.topNFlowSource],activePage:d.a},[s.NetworkTableType.topNFlowDestination]:{...e.page.queries[s.NetworkTableType.topNFlowDestination],activePage:d.a},[s.NetworkTableType.dns]:{...e.page.queries[s.NetworkTableType.dns],activePage:d.a},[s.NetworkTableType.tls]:{...e.page.queries[s.NetworkTableType.tls],activePage:d.a},[s.NetworkTableType.http]:{...e.page.queries[s.NetworkTableType.http],activePage:d.a}}),m=e=>({...e.details.queries,[s.NetworkDetailsTableType.topCountriesSource]:{...e.details.queries[s.NetworkDetailsTableType.topCountriesSource],activePage:d.a},[s.NetworkDetailsTableType.topCountriesDestination]:{...e.details.queries[s.NetworkDetailsTableType.topCountriesDestination],activePage:d.a},[s.NetworkDetailsTableType.topNFlowSource]:{...e.details.queries[s.NetworkDetailsTableType.topNFlowSource],activePage:d.a},[s.NetworkDetailsTableType.topNFlowDestination]:{...e.details.queries[s.NetworkDetailsTableType.topNFlowDestination],activePage:d.a},[s.NetworkDetailsTableType.tls]:{...e.details.queries[s.NetworkDetailsTableType.tls],activePage:d.a},[s.NetworkDetailsTableType.users]:{...e.details.queries[s.NetworkDetailsTableType.users],activePage:d.a},[s.NetworkDetailsTableType.http]:{...e.details.queries[s.NetworkDetailsTableType.http],activePage:d.a}}),g={page:{queries:{[s.NetworkTableType.topNFlowSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[s.NetworkTableType.topNFlowDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[s.NetworkTableType.dns]:{activePage:d.a,limit:d.b,sort:{field:u.n.uniqueDomains,direction:u.b.desc},isPtrIncluded:!1},[s.NetworkTableType.http]:{activePage:d.a,limit:d.b,sort:{direction:u.b.desc}},[s.NetworkTableType.tls]:{activePage:d.a,limit:d.b,sort:{field:u.r._id,direction:u.b.desc}},[s.NetworkTableType.topCountriesSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[s.NetworkTableType.topCountriesDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[s.NetworkTableType.alerts]:{activePage:d.a,limit:d.b},[s.NetworkTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}}},details:{queries:{[s.NetworkDetailsTableType.http]:{activePage:d.a,limit:d.b,sort:{direction:u.b.desc}},[s.NetworkDetailsTableType.topCountriesSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[s.NetworkDetailsTableType.topCountriesDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[s.NetworkDetailsTableType.topNFlowSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[s.NetworkDetailsTableType.topNFlowDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[s.NetworkDetailsTableType.tls]:{activePage:d.a,limit:d.b,sort:{field:u.r._id,direction:u.b.desc}},[s.NetworkDetailsTableType.users]:{activePage:d.a,limit:d.b,sort:{field:u.t.name,direction:u.b.asc}},[s.NetworkDetailsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}},flowTarget:u.f.source}},f=Object(c.reducerWithInitialState)(g).case(i.updateNetworkTable,((e,{networkType:t,tableType:a,updates:n})=>({...e,[t]:{...e[t],queries:{...e[t].queries,[a]:{...Object(o.get)([t,"queries",a],e),...n}}}}))).case(i.setNetworkTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:p(e)},details:{...e.details,queries:m(e)}}))).case(i.setNetworkDetailsTablesActivePageToZero,(e=>({...e,details:{...e.details,queries:m(e)}}))).case(i.updateNetworkAnomaliesJobIdFilter,((e,{jobIds:t,networkType:a})=>a===s.NetworkType.page?Object(o.set)("page.queries.anomalies.jobIdSelection",t,e):Object(o.set)("details.queries.anomalies.jobIdSelection",t,e))).case(i.updateNetworkAnomaliesInterval,((e,{interval:t,networkType:a})=>a===s.NetworkType.page?Object(o.set)("page.queries.anomalies.intervalSelection",t,e):Object(o.set)("details.queries.anomalies.intervalSelection",t,e))).build(),b=(e,t)=>Object(o.get)(t,e.network),h=e=>e.network.page,y=e=>e.network.details,E=()=>Object(r.createSelector)(h,(e=>e.queries.dns)),v=(e,t,a)=>{const n=a===l.b.source?"topNFlowSource":"topNFlowDestination",i=t===s.NetworkType.page?s.NetworkTableType[n]:s.NetworkDetailsTableType[n];return Object(o.get)([t,"queries",i],e.network)||Object(o.get)([t,"queries",i],g)},k=()=>Object(r.createSelector)(v,(e=>e)),S=(e,t)=>{const a=t===s.NetworkType.page?s.NetworkTableType.tls:s.NetworkDetailsTableType.tls;return Object(o.get)([t,"queries",a],e.network)||Object(o.get)([t,"queries",a],g)},T=()=>Object(r.createSelector)(S,(e=>e)),x=(e,t,a)=>{const n=a===l.b.source?"topCountriesSource":"topCountriesDestination",i=t===s.NetworkType.page?s.NetworkTableType[n]:s.NetworkDetailsTableType[n];return Object(o.get)([t,"queries",i],e.network)||Object(o.get)([t,"queries",i],g)},w=()=>Object(r.createSelector)(x,(e=>e)),O=(e,t)=>{const a=t===s.NetworkType.page?s.NetworkTableType.http:s.NetworkDetailsTableType.http;return Object(o.get)([t,"queries",a],e.network)||Object(o.get)([t,"queries",a],g)},j=()=>Object(r.createSelector)(O,(e=>e)),I=()=>Object(r.createSelector)(y,(e=>e.queries.users)),C=()=>Object(r.createSelector)(b,(e=>e.queries[s.NetworkTableType.anomalies].jobIdSelection)),M=()=>Object(r.createSelector)(b,(e=>e.queries[s.NetworkTableType.anomalies].intervalSelection))},,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return o}));var n=a(3),i=a(4),s=a.n(i);function r(e){var t;const a=t=>{const{loading:a,id:i,refetch:r,setQuery:l,deleteQuery:c,inspect:u=null}=t;o({queryId:i,loading:a,refetch:r,setQuery:l,deleteQuery:c,inspect:u});const d=Object(n.omit)(["refetch","setQuery"],t);return s.a.createElement(e,d)};return a.displayName=`ManageQuery (${null!==(t=null==e?void 0:e.displayName)&&void 0!==t?t:"Unknown"})`,a}const o=({setQuery:e,deleteQuery:t,refetch:a,inspect:n,loading:s,queryId:r})=>{Object(i.useEffect)((()=>{e({id:r,inspect:null!=n?n:null,loading:s,refetch:a})}),[t,e,r,a,n,s]),Object(i.useEffect)((()=>()=>{t&&t({id:r})}),[t,r])}},function(e,t,a){"use strict";e.exports=function(e){return e<-2}},,,function(e,t,a){"use strict";var n=a(268);e.exports=function(e,t,a,i){var s=i?i-1:1/0,r=0;return function(i){return n(i)?(e.enter(a),o(i)):t(i)};function o(i){return n(i)&&r++<s?(e.consume(i),o):(e.exit(a),t(i))}}},,,function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return m}));var n=a(4),i=a(62),s=a(47),r=a(217),o=a(209),l=a(234),c=a(231),u=a(1);function d(e){return Object(s.useSelector)((t=>e(t[o.u][o.v])))}function p(e){const t=d(c.c),a=Object(i.useHistory)(),s=d(c.o),o=Object(n.useCallback)((a=>e===r.m?Object(l.k)(s,{...t,...a}):e===r.e?Object(l.l)(s,{...t,...a}):e===r.b?Object(l.i)(s,{...t,...a}):Object(l.m)(s,{...t,...a})),[e,t,s]);return Object(n.useCallback)((e=>a.push(o(e))),[o,a])}const m=()=>window.location.pathname.includes(u.ac)&&window.location.pathname.includes("/settings")},,function(e,t,a){"use strict";let n,i,s;a.r(t),a.d(t,"UsersType",(function(){return n})),a.d(t,"UsersTableType",(function(){return i})),a.d(t,"UsersDetailsTableType",(function(){return s})),function(e){e.page="page",e.details="details"}(n||(n={})),function(e){e.allUsers="allUsers",e.authentications="authentications",e.anomalies="anomalies",e.risk="userRisk",e.events="events"}(i||(i={})),function(e){e.authentications="authentications",e.anomalies="anomalies",e.risk="userRisk",e.events="events"}(s||(s={}))},function(e,t,a){"use strict";var n=a(332);a.d(t,"a",(function(){return n.a})),a.d(t,"b",(function(){return n.b})),a.d(t,"d",(function(){return n.d})),a.d(t,"e",(function(){return n.e})),a.d(t,"f",(function(){return n.f})),a.d(t,"l",(function(){return n.j})),a.d(t,"m",(function(){return n.k})),a.d(t,"n",(function(){return n.l})),a.d(t,"o",(function(){return n.m})),a.d(t,"p",(function(){return n.n}));var i=a(318);a.d(t,"c",(function(){return i.a})),a.d(t,"g",(function(){return i.b})),a.d(t,"h",(function(){return i.c})),a.d(t,"i",(function(){return i.d})),a.d(t,"j",(function(){return i.e})),a.d(t,"k",(function(){return i.f}))},,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a(62),s=a(92),r=a.n(s),o=a(293);const l=Object(n.memo)((({location:{pathname:e,search:t},history:a,match:{params:{detailName:i,tabName:s,flowTarget:l}},pageName:c,state:u})=>{const[d,p]=Object(n.useState)(!0),[m,g]=Object(o.a)();return Object(n.useEffect)((()=>{d&&""!==t?(g({type:"updateSearch",search:t}),p(!1)):""!==t&&t!==m.search&&g({type:"updateSearch",search:t})}),[t]),Object(n.useEffect)((()=>{c&&!r()(m.pathName,e)?d&&null==i?(g({type:"updateRouteWithOutSearch",route:{detailName:i,flowTarget:l,history:a,pageName:c,pathName:e,state:u,tabName:s}}),p(!1)):g({type:"updateRoute",route:{detailName:i,flowTarget:l,history:a,pageName:c,pathName:e,search:t,state:u,tabName:s}}):c&&!r()(u,m.state)&&g({type:"updateRoute",route:{detailName:i,flowTarget:l,history:a,pageName:c,pathName:e,search:t,state:u,tabName:s}})}),[e,t,c,i,s,l,u]),null}));l.displayName="SpyRouteComponent";const c=Object(i.withRouter)(l)},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return l}));var n=a(306);function i(e){return null!=e&&e.id?String(Object(n.a)(e.id)):void 0}function s(e){return null!=e&&e.parent?String(Object(n.a)(null==e?void 0:e.parent)):void 0}function r(e){const t=o(e);if(void 0===t)return;const a=new Date(t);return isFinite(a.getTime())?a:void 0}function o(e){return Object(n.a)(null==e?void 0:e.data["@timestamp"])}function l(e){return null!=e&&e.name?String(Object(n.a)(e.name)):void 0}},,,,,function(e,t,a){"use strict";a.d(t,"i",(function(){return i})),a.d(t,"m",(function(){return s})),a.d(t,"g",(function(){return r})),a.d(t,"o",(function(){return o})),a.d(t,"k",(function(){return l})),a.d(t,"j",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"n",(function(){return d})),a.d(t,"l",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"p",(function(){return g})),a.d(t,"c",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"d",(function(){return h})),a.d(t,"h",(function(){return y})),a.d(t,"f",(function(){return E}));var n=a(306);function i(e){return"endgame"in e&&void 0!==e.endgame}function s(e){return Object(n.a)(null==e?void 0:e["@timestamp"])}function r(e){return Object(n.a)(e["@timestamp"])}function o(e){var t;if(!i(e))return Object(n.a)(null===(t=e.user)||void 0===t?void 0:t.name)}function l(e){var t,a;return Object(n.a)(i(e)?e.endgame.ppid:null===(t=e.process)||void 0===t||null===(a=t.parent)||void 0===a?void 0:a.pid)}function c(e){var t,a;return Object(n.a)(i(e)||null===(t=e.process)||void 0===t||null===(a=t.hash)||void 0===a?void 0:a.md5)}function u(e){var t;if(!i(e))return Object(n.c)(null===(t=e.process)||void 0===t?void 0:t.args)}function d(e){var t;if(!i(e))return Object(n.a)(null===(t=e.user)||void 0===t?void 0:t.domain)}function p(e){return i(e)?Object(n.a)(e.endgame.process_name):Object(n.a)(null===(t=e.process)||void 0===t?void 0:t.name);var t}function m(e){var t,a;return i(e)?Object(n.a)(null===(t=e.endgame)||void 0===t?void 0:t.serial_event_id):Object(n.a)(null===(a=e.event)||void 0===a?void 0:a.id)}function g(e){var t;return Object(n.a)(null===(t=e.winlog)||void 0===t?void 0:t.record_id)}function f(e){var t;return i(e)?e.endgame.unique_pid?String(e.endgame.unique_pid):"":Object(n.a)(null===(t=e.process)||void 0===t?void 0:t.entity_id)}function b(e){var t,a;return i(e)?void 0===(null===(t=e.endgame)||void 0===t?void 0:t.unique_pid)?void 0:String(Object(n.a)(e.endgame.unique_pid)):Object(n.a)(null===(a=e.process)||void 0===a?void 0:a.entity_id)}function h(e){var t;return Object(n.c)(i(e)?e.endgame.event_type_full:null===(t=e.event)||void 0===t?void 0:t.category)}function y(e){var t;return Object(n.c)(i(e)?e.endgame.event_subtype_full:null===(t=e.event)||void 0===t?void 0:t.type)}function E(e){return i(e)?[]:Object(n.c)(null===(t=e.event)||void 0===t?void 0:t.kind);var t}},,,,function(e,t,a){"use strict";function n(e,t){return[e[0]+t[0],e[1]+t[1]]}function i(e,t){return[e[0]-t[0],e[1]-t[1]]}function s(e,t){return[e[0]/t[0],e[1]/t[1]]}function r(e,t){return[e[0]*t[0],e[1]*t[1]]}function o([e,t],[a,n,i,s,r,o]){return[e*a+t*n+i,e*s+t*r+o]}function l([e,t],[a,n]){return e===a&&t===n}function c(e,t){const[a,n]=e,[i,s]=t;return Math.sqrt(Math.pow(i-a,2)+Math.pow(s-n,2))}function u(e,t){const a=t[0]-e[0],n=t[1]-e[1];return Math.atan2(n,a)}function d(e,t){return[e[0]*t,e[1]*t]}function p(e,t,a){return n(d(e,1-a),d(t,a))}a.d(t,"a",(function(){return n})),a.d(t,"j",(function(){return i})),a.d(t,"e",(function(){return s})),a.d(t,"h",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"g",(function(){return p}))},,,,function(e,t,a){"use strict";let n,i;a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),function(e){e.defineRule="define-rule",e.aboutRule="about-rule",e.scheduleRule="schedule-rule",e.ruleActions="rule-actions"}(n||(n={})),function(e){e.IndexPatterns="indexPatterns",e.DataView="dataView"}(i||(i={}))},function(e,t,a){class Range{constructor(e,t){if(t=i(t),e instanceof Range)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Range(e.raw,t);if(e instanceof s)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!m(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&g(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,a=n.get(t);if(a)return a;const i=this.options.loose,o=i?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE];e=e.replace(o,O(this.options.includePrerelease)),r("hyphen replace",e),e=e.replace(l[c.COMPARATORTRIM],u),r("comparator trim",e);let g=(e=(e=(e=e.replace(l[c.TILDETRIM],d)).replace(l[c.CARETTRIM],p)).split(/\s+/).join(" ")).split(" ").map((e=>b(e,this.options))).join(" ").split(/\s+/).map((e=>w(e,this.options)));i&&(g=g.filter((e=>(r("loose invalid filter",e,this.options),!!e.match(l[c.COMPARATORLOOSE]))))),r("range list",g);const f=new Map,h=g.map((e=>new s(e,this.options)));for(const e of h){if(m(e))return[e];f.set(e.value,e)}f.size>1&&f.has("")&&f.delete("");const y=[...f.values()];return n.set(t,y),y}intersects(e,t){if(!(e instanceof Range))throw new TypeError("a Range is required");return this.set.some((a=>f(a,t)&&e.set.some((e=>f(e,t)&&a.every((a=>e.every((e=>a.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(j(this.set[t],e,this.options))return!0;return!1}}e.exports=Range;const n=new(a(777))({max:1e3}),i=a(399),s=a(403),r=a(397),o=a(233),{re:l,t:c,comparatorTrimReplace:u,tildeTrimReplace:d,caretTrimReplace:p}=a(325),m=e=>"<0.0.0-0"===e.value,g=e=>""===e.value,f=(e,t)=>{let a=!0;const n=e.slice();let i=n.pop();for(;a&&n.length;)a=n.every((e=>i.intersects(e,t))),i=n.pop();return a},b=(e,t)=>(r("comp",e,t),e=v(e,t),r("caret",e),e=y(e,t),r("tildes",e),e=S(e,t),r("xrange",e),e=x(e,t),r("stars",e),e),h=e=>!e||"x"===e.toLowerCase()||"*"===e,y=(e,t)=>e.trim().split(/\s+/).map((e=>E(e,t))).join(" "),E=(e,t)=>{const a=t.loose?l[c.TILDELOOSE]:l[c.TILDE];return e.replace(a,((t,a,n,i,s)=>{let o;return r("tilde",e,t,a,n,i,s),h(a)?o="":h(n)?o=`>=${a}.0.0 <${+a+1}.0.0-0`:h(i)?o=`>=${a}.${n}.0 <${a}.${+n+1}.0-0`:s?(r("replaceTilde pr",s),o=`>=${a}.${n}.${i}-${s} <${a}.${+n+1}.0-0`):o=`>=${a}.${n}.${i} <${a}.${+n+1}.0-0`,r("tilde return",o),o}))},v=(e,t)=>e.trim().split(/\s+/).map((e=>k(e,t))).join(" "),k=(e,t)=>{r("caret",e,t);const a=t.loose?l[c.CARETLOOSE]:l[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(a,((t,a,i,s,o)=>{let l;return r("caret",e,t,a,i,s,o),h(a)?l="":h(i)?l=`>=${a}.0.0${n} <${+a+1}.0.0-0`:h(s)?l="0"===a?`>=${a}.${i}.0${n} <${a}.${+i+1}.0-0`:`>=${a}.${i}.0${n} <${+a+1}.0.0-0`:o?(r("replaceCaret pr",o),l="0"===a?"0"===i?`>=${a}.${i}.${s}-${o} <${a}.${i}.${+s+1}-0`:`>=${a}.${i}.${s}-${o} <${a}.${+i+1}.0-0`:`>=${a}.${i}.${s}-${o} <${+a+1}.0.0-0`):(r("no pr"),l="0"===a?"0"===i?`>=${a}.${i}.${s}${n} <${a}.${i}.${+s+1}-0`:`>=${a}.${i}.${s}${n} <${a}.${+i+1}.0-0`:`>=${a}.${i}.${s} <${+a+1}.0.0-0`),r("caret return",l),l}))},S=(e,t)=>(r("replaceXRanges",e,t),e.split(/\s+/).map((e=>T(e,t))).join(" ")),T=(e,t)=>{e=e.trim();const a=t.loose?l[c.XRANGELOOSE]:l[c.XRANGE];return e.replace(a,((a,n,i,s,o,l)=>{r("xRange",e,a,n,i,s,o,l);const c=h(i),u=c||h(s),d=u||h(o),p=d;return"="===n&&p&&(n=""),l=t.includePrerelease?"-0":"",c?a=">"===n||"<"===n?"<0.0.0-0":"*":n&&p?(u&&(s=0),o=0,">"===n?(n=">=",u?(i=+i+1,s=0,o=0):(s=+s+1,o=0)):"<="===n&&(n="<",u?i=+i+1:s=+s+1),"<"===n&&(l="-0"),a=`${n+i}.${s}.${o}${l}`):u?a=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(a=`>=${i}.${s}.0${l} <${i}.${+s+1}.0-0`),r("xRange return",a),a}))},x=(e,t)=>(r("replaceStars",e,t),e.trim().replace(l[c.STAR],"")),w=(e,t)=>(r("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),O=e=>(t,a,n,i,s,r,o,l,c,u,d,p,m)=>`${a=h(n)?"":h(i)?`>=${n}.0.0${e?"-0":""}`:h(s)?`>=${n}.${i}.0${e?"-0":""}`:r?`>=${a}`:`>=${a}${e?"-0":""}`} ${l=h(c)?"":h(u)?`<${+c+1}.0.0-0`:h(d)?`<${c}.${+u+1}.0-0`:p?`<=${c}.${u}.${d}-${p}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),j=(e,t,a)=>{for(let a=0;a<e.length;a++)if(!e[a].test(t))return!1;if(t.prerelease.length&&!a.includePrerelease){for(let a=0;a<e.length;a++)if(r(e[a].semver),e[a].semver!==s.ANY&&e[a].semver.prerelease.length>0){const n=e[a].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},,,,function(e,t,a){"use strict";a.d(t,"h",(function(){return T})),a.d(t,"i",(function(){return x})),a.d(t,"e",(function(){return g})),a.d(t,"d",(function(){return b})),a.d(t,"c",(function(){return j})),a.d(t,"f",(function(){return l})),a.d(t,"g",(function(){return I})),a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return m}));var n=a(0),i=a(310),s=a(16),r=a(330);const o=e=>{const t=Object.values(e);return e=>e&&t.includes(e)?e:null};let l;a(2),function(e){e["going to run"]="going to run",e.running="running",e["partial failure"]="partial failure",e.failed="failed",e.succeeded="succeeded"}(l||(l={}));const c=Object(s.u)("RuleExecutionStatus",l),u=(Object.values(l),s.n);let d;!function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error"}(d||(d={}));const p=Object(s.u)("LogLevel",d),m=Object.values(d);let g;o(d),function(e){e.message="message",e["status-change"]="status-change",e["execution-metrics"]="execution-metrics"}(g||(g={}));const f=Object(s.u)("RuleExecutionEventType",g),b=Object.values(g),h=(o(g),n.type({timestamp:s.h,sequence:n.number,level:p,type:f,message:n.string})),y=(n.exact(n.type({ruleId:s.k})),n.exact(n.type({event_types:Object(s.s)(f),log_levels:Object(s.s)(p),sort_order:r.a,page:i.b,per_page:i.c})),n.exact(n.type({events:n.array(h),pagination:r.b})),n.type({execution_uuid:n.string,timestamp:s.h,duration_ms:n.number,status:n.string,message:n.string,num_active_alerts:n.number,num_new_alerts:n.number,num_recovered_alerts:n.number,num_triggered_actions:n.number,num_succeeded_actions:n.number,num_errored_actions:n.number,total_search_duration_ms:n.number,es_search_duration_ms:n.number,schedule_delay_ms:n.number,timed_out:n.boolean,indexing_duration_ms:n.number,search_duration_ms:n.number,gap_duration_s:n.number,security_status:n.string,security_message:n.string})),E=n.keyof({timestamp:s.h,duration_ms:n.number,gap_duration_s:n.number,indexing_duration_ms:n.number,search_duration_ms:n.number,schedule_delay_ms:n.number}),v=Object(s.s)(c),k=Object(s.t)(E,"timestamp","DefaultSortField");n.exact(n.type({ruleId:s.k})),n.exact(n.type({start:s.h,end:s.h,query_text:s.b,status_filters:v,sort_field:k,sort_order:r.a,page:i.b,per_page:i.c})),n.exact(n.type({events:n.array(y),total:n.number}));var S=a(1);S.Lb;const T=e=>`${S.Lb}/rules/${e}/execution/events`,x=(S.Lb,e=>`${S.Lb}/rules/${e}/execution/results`),w=s.n,O=n.partial({total_search_duration_ms:w,total_indexing_duration_ms:w,total_enrichment_duration_ms:w,execution_gap_duration_s:w});let j;!function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.off="off"}(j||(j={}));const I=n.type({last_execution:n.type({date:s.h,status:c,status_order:u,message:n.string,metrics:O})})},,,,,,,,function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return c}));const n=["started","opened"],i=["starting","stopping","opening","closing"],s=["deleted","failed"],r=(e,t)=>n.includes(e)&&n.includes(t),o=(e,t)=>i.includes(e)||i.includes(t),l=(e,t)=>s.includes(e)||s.includes(t),c=e=>"machine_learning"===e},function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(17),i=a(3),s=a(4),r=a.n(s),o=a(24),l=a.n(o),c=a(1),u=a(216),d=a(249),p=a(51),m=a(6);const g=m.i18n.translate("xpack.securitySolution.paginatedTable.showingSubtitle",{defaultMessage:"Showing"}),f=m.i18n.translate("xpack.securitySolution.paginatedTable.rowsButtonLabel",{defaultMessage:"Rows per page"}),b=m.i18n.translate("xpack.securitySolution.paginatedTable.tooManyResultsToastTitle",{defaultMessage:" - too many results"}),h=m.i18n.translate("xpack.securitySolution.paginatedTable.tooManyResultsToastText",{defaultMessage:"Narrow your query to better filter the results"});var y=a(348),E=a(227),v=a(208);const k=({activePage:e,columns:t,dataTestSubj:a="paginated-table",headerCount:o,headerFilters:l,headerSupplement:m,headerTitle:k,headerTooltip:S,headerUnit:O,headerSubtitle:j,id:I,isInspect:C,itemsPerRow:M,limit:D,loading:A,loadPage:F,onChange:R=i.noop,pageOfItems:P,setQuerySkip:_,showMorePagesIndicator:q,sorting:N=null,split:L,stackHeader:B,totalCount:z,updateActivePage:H,updateLimitPagination:$})=>{const[V,U]=Object(s.useState)(A),[Q,W]=Object(s.useState)(e),[G,K]=Object(s.useState)(-1===o),[J,Y]=Object(s.useState)(!1),X=Math.ceil(z/D),Z=Object(p.g)()[1];Object(s.useEffect)((()=>{W(e)}),[e]),Object(s.useEffect)((()=>{o>=0&&G&&K(!1)}),[G,o]),Object(s.useEffect)((()=>{U(A)}),[A]);const ee=()=>{Y(!1)},te=r.a.createElement(n.EuiButtonEmpty,{size:"xs",color:"text",iconType:"arrowDown",iconSide:"right",onClick:()=>{Y(!J)}},`${f}: ${D}`),ae=M&&M.map((e=>r.a.createElement(n.EuiContextMenuItem,{key:e.text,icon:D===e.numberOfRow?"check":"empty",onClick:()=>{ee(),$(e.numberOfRow),H(0)}},e.text))),ne=q?w:n.EuiFlexItem,ie=Object(s.useMemo)((()=>N?{sort:{field:N.field,direction:N.direction}}:void 0),[N]),{toggleStatus:se,setToggleStatus:re}=Object(v.a)(I),oe=Object(s.useCallback)((e=>{re(e),_(!e)}),[_,re]);return r.a.createElement(E.c,{show:!G},r.a.createElement(y.a,{"data-test-subj":`${a}-loading-${A}`,loading:A},r.a.createElement(u.a,{toggleStatus:se,toggleQuery:oe,headerFilters:l,id:I,split:L,stackHeader:B,subtitle:!G&&j?`${g}: ${j}`:O&&`${g}: ${o>=0?o.toLocaleString():0} ${O}`,title:k,tooltip:S},!G&&m),se&&(G?r.a.createElement(n.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelPaginatedTable",lines:10}):r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{"data-test-subj":"paginated-basic-table",columns:t,items:P,onChange:R,sorting:ie}),r.a.createElement(x,null,r.a.createElement(n.EuiFlexItem,null,M&&M.length>0&&z>=M[0].numberOfRow&&r.a.createElement(n.EuiPopover,{id:"customizablePagination","data-test-subj":"loadingMoreSizeRowPopover",button:te,isOpen:J,closePopover:ee,panelPaddingSize:"none",repositionOnScroll:!0},r.a.createElement(n.EuiContextMenuPanel,{items:ae,"data-test-subj":"loadingMorePickSizeRow"}))),r.a.createElement(ne,{grow:!1},z>0&&r.a.createElement(n.EuiPagination,{"data-test-subj":"numberedPagination",pageCount:X,activePage:Q,onPageClick:e=>{if((e+1)*D>=c.X)return Z({type:"addToaster",toast:{id:"PaginationWarningMsg",title:k+b,color:"warning",iconType:"alert",toastLifeTimeMs:1e4,text:h}});W(e),F(e),H(e)}}))),(C||V)&&r.a.createElement(d.a,{"data-test-subj":"loadingPanelPaginatedTable",overlay:!0,size:"xl"})))))},S=Object(s.memo)(k),T=l()(n.EuiBasicTable).withConfig({displayName:"BasicTable",componentId:"sc-53ob89-0"})(["tbody{th,td{vertical-align:top;}.euiTableCellContent{display:block;}}"]);T.displayName="BasicTable";const x=l()(n.EuiFlexGroup).attrs((()=>({alignItems:"center",responsive:!1}))).withConfig({displayName:"FooterAction",componentId:"sc-53ob89-1"})(["margin-top:",";"],(({theme:e})=>e.eui.euiSizeXS));x.displayName="FooterAction";const w=l()(n.EuiFlexItem).withConfig({displayName:"PaginationEuiFlexItem",componentId:"sc-53ob89-2"})(["@media only screen and (min-width:","){.euiButtonIcon:last-child{margin-left:28px;}.euiPagination{position:relative;}.euiPagination::before{bottom:0;color:",";content:'\\2026';font-size:",";padding:5px ",";position:absolute;right:",";}}"],(({theme:e})=>e.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiButtonColorDisabled),(({theme:e})=>e.eui.euiFontSizeS),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeL));w.displayName="PaginationEuiFlexItem"},,function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(17),i=a(4),s=a.n(i),r=a(24),o=a.n(r),l=a(731),c=a(728),u=a(643),d=a(260),p=a(19);o.a.header.attrs({className:"securitySolutionHeaderPage"}).withConfig({displayName:"Header",componentId:"sc-fdx6r8-0"})(["",""],(({border:e,theme:t})=>Object(r.css)(["margin-bottom:",";"],t.eui.euiSizeL))).displayName="Header";const m=o.a.div.attrs({className:"securitySolutionHeaderPage__linkBack"}).withConfig({displayName:"LinkBack",componentId:"sc-fdx6r8-1"})(["",""],(({theme:e})=>Object(r.css)(["font-size:",";line-height:",";margin-bottom:",";"],e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiSizeS)));m.displayName="LinkBack";const g=o()(n.EuiPageHeaderSection).withConfig({displayName:"HeaderSection",componentId:"sc-fdx6r8-2"})(["min-width:0;max-width:100%;"]);g.displayName="HeaderSection";const f=s.a.memo((({backOptions:e})=>{var t,a;const{navigateToUrl:n}=Object(p.k)().services.application,{formatUrl:i}=Object(d.l)(e.pageId),r=i(null!==(t=e.path)&&void 0!==t?t:"");return s.a.createElement(m,null,s.a.createElement(l.a,{dataTestSubj:null!==(a=e.dataTestSubj)&&void 0!==a?a:"link-back",onClick:e=>{e.preventDefault(),n(r)},href:r,iconType:"arrowLeft"},e.text))}));f.displayName="HeaderLinkBack";const b=({backOptions:e,backComponent:t,badgeOptions:a,border:i,children:r,draggableArguments:o,isLoading:l,subtitle:d,subtitle2:p,title:m,titleNode:b})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiPageHeader,{alignItems:"center",bottomBorder:i},s.a.createElement(g,null,e&&s.a.createElement(f,{backOptions:e}),!e&&t&&s.a.createElement(s.a.Fragment,null,t),b||s.a.createElement(u.a,{draggableArguments:o,title:m,badgeOptions:a}),d&&s.a.createElement(c.a,{"data-test-subj":"header-page-subtitle",items:d}),p&&s.a.createElement(c.a,{"data-test-subj":"header-page-subtitle-2",items:p}),i&&l&&s.a.createElement(n.EuiProgress,{size:"xs",color:"accent"})),r&&s.a.createElement(n.EuiPageHeaderSection,{"data-test-subj":"header-page-supplements"},r)),s.a.createElement(n.EuiSpacer,{size:"l"})),h=s.a.memo(b)},,function(e,t,a){"use strict";e.exports=function(e){return-2===e||-1===e||32===e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(0),i=a(16),s=a(310),r=a(48);let o,l;!function(e){e.enable="enable",e.disable="disable",e.export="export",e.delete="delete",e.duplicate="duplicate",e.edit="edit"}(o||(o={})),Object(i.u)("BulkAction",o),function(e){e.add_tags="add_tags",e.delete_tags="delete_tags",e.set_tags="set_tags",e.add_index_patterns="add_index_patterns",e.delete_index_patterns="delete_index_patterns",e.set_index_patterns="set_index_patterns",e.set_timeline="set_timeline",e.add_rule_actions="add_rule_actions",e.set_rule_actions="set_rule_actions",e.set_schedule="set_schedule"}(l||(l={}));const c=n.union([n.literal("rule"),Object(i.q)({allowedDurations:[[1,"h"],[1,"d"],[7,"d"]]})]),u=n.type({type:n.union([n.literal(l.add_tags),n.literal(l.delete_tags),n.literal(l.set_tags)]),value:r.Q}),d=n.intersection([n.type({type:n.union([n.literal(l.add_index_patterns),n.literal(l.delete_index_patterns),n.literal(l.set_index_patterns)]),value:r.s}),n.exact(n.partial({overwrite_data_views:n.boolean}))]),p=n.type({type:n.literal(l.set_timeline),value:n.type({timeline_id:r.T,timeline_title:r.U})}),m=n.exact(n.type({group:s.d,id:s.e,params:s.f})),g=n.type({type:n.union([n.literal(l.add_rule_actions),n.literal(l.set_rule_actions)]),value:n.type({throttle:c,actions:n.array(m)})}),f=n.type({type:n.literal(l.set_schedule),value:n.type({interval:Object(i.q)({allowedUnits:["s","m","h"]}),lookback:Object(i.q)({allowedUnits:["s","m","h"]})})}),b=n.union([u,d,p,g,f]);n.intersection([n.exact(n.type({query:r.F})),n.exact(n.partial({ids:Object(i.j)(n.string)})),n.union([n.exact(n.type({action:n.union([n.literal(o.delete),n.literal(o.disable),n.literal(o.duplicate),n.literal(o.enable),n.literal(o.export)])})),n.exact(n.type({action:n.literal(o.edit),[o.edit]:Object(i.j)(b)}))])]),n.exact(n.partial({dry_run:n.union([n.literal("true"),n.literal("false")])}))},function(e,t,a){"use strict";a.r(t),a.d(t,"listData",(function(){return g})),a.d(t,"pageIndex",(function(){return f})),a.d(t,"pageSize",(function(){return b})),a.d(t,"totalHits",(function(){return h})),a.d(t,"listLoading",(function(){return y})),a.d(t,"listError",(function(){return E})),a.d(t,"detailsData",(function(){return v})),a.d(t,"detailsLoading",(function(){return k})),a.d(t,"detailsError",(function(){return S})),a.d(t,"policyItems",(function(){return T})),a.d(t,"policyItemsLoading",(function(){return x})),a.d(t,"selectedPolicyId",(function(){return w})),a.d(t,"endpointPackageInfo",(function(){return O})),a.d(t,"getIsEndpointPackageInfoUninitialized",(function(){return j})),a.d(t,"isAutoRefreshEnabled",(function(){return I})),a.d(t,"autoRefreshInterval",(function(){return C})),a.d(t,"policyVersionInfo",(function(){return M})),a.d(t,"areEndpointsEnrolling",(function(){return D})),a.d(t,"agentsWithEndpointsTotalError",(function(){return A})),a.d(t,"endpointsTotalError",(function(){return F})),a.d(t,"endpointPackageVersion",(function(){return R})),a.d(t,"patterns",(function(){return P})),a.d(t,"patternsError",(function(){return _})),a.d(t,"isOnEndpointPage",(function(){return q})),a.d(t,"uiQueryParams",(function(){return N})),a.d(t,"hasSelectedEndpoint",(function(){return L})),a.d(t,"showView",(function(){return B})),a.d(t,"hostStatusInfo",(function(){return z})),a.d(t,"policyResponseStatus",(function(){return H})),a.d(t,"nonExistingPolicies",(function(){return $})),a.d(t,"agentPolicies",(function(){return V})),a.d(t,"endpointsExist",(function(){return U})),a.d(t,"searchBarQuery",(function(){return Q})),a.d(t,"getCurrentIsolationRequestState",(function(){return W})),a.d(t,"getIsIsolationRequestPending",(function(){return G})),a.d(t,"getWasIsolationRequestSuccessful",(function(){return K})),a.d(t,"getIsolationRequestError",(function(){return J})),a.d(t,"getIsOnEndpointDetailsActivityLog",(function(){return Y})),a.d(t,"getIsEndpointHostIsolated",(function(){return X})),a.d(t,"getEndpointPendingActionsState",(function(){return Z})),a.d(t,"getEndpointHostIsolationStatusPropsCallback",(function(){return ee})),a.d(t,"getMetadataTransformStats",(function(){return te})),a.d(t,"metadataTransformStats",(function(){return ae})),a.d(t,"isMetadataTransformStatsLoading",(function(){return ne}));var n=a(369),i=a.n(n),s=a(14),r=a(62),o=a(182),l=a(226),c=a(234),u=a(209),d=a(427),p=a(292),m=a(675);const g=e=>e.hosts,f=e=>e.pageIndex,b=e=>e.pageSize,h=e=>e.total,y=e=>e.loading,E=e=>e.error,v=e=>e.endpointDetails.hostDetails.details,k=e=>e.endpointDetails.hostDetails.detailsLoading,S=e=>e.endpointDetails.hostDetails.detailsError,T=e=>e.policyItems,x=e=>e.policyItemsLoading,w=e=>e.selectedPolicyId,O=e=>e.endpointPackageInfo,j=Object(s.createSelector)(O,(e=>Object(d.i)(e))),I=e=>e.isAutoRefreshEnabled,C=e=>e.autoRefreshInterval,M=e=>e.policyVersionInfo,D=e=>e.agentsWithEndpointsTotal>e.endpointsTotal,A=e=>e.agentsWithEndpointsTotalError,F=e=>e.endpointsTotalError,R=Object(s.createSelector)(O,(e=>Object(d.g)(e)?e.data.version:void 0)),P=e=>e.patterns,_=e=>e.patternsError,q=e=>{var t,a;return null!==Object(r.matchPath)(null!==(t=null===(a=e.location)||void 0===a?void 0:a.pathname)&&void 0!==t?t:"",{path:u.h,exact:!0})},N=Object(s.createSelector)((e=>e.location),(e=>{const t={page_index:String(u.b),page_size:String(u.c)};if(e){const a=i.a.parse(e.search.slice(1)),n=Object(c.a)(a),s=["selected_endpoint","show","admin_query"],r=["policy_response","details","isolate","unisolate","activity_log"];for(const e of s){const n="string"==typeof a[e]?a[e]:Array.isArray(a[e])?a[e][a[e].length-1]:void 0;void 0!==n&&("show"===e?r.includes(n)&&(t[e]=n):t[e]=n)}t.page_size=String(n.page_size),t.page_index=String(n.page_index)}return t})),L=Object(s.createSelector)(N,(({selected_endpoint:e})=>void 0!==e)),B=Object(s.createSelector)(N,(e=>{var t;return null!==(t=e.show)&&void 0!==t?t:"details"})),z=Object(s.createSelector)((e=>e.hostStatus),(e=>e||l.b.UNHEALTHY)),H=Object(s.createSelector)((e=>e.policyResponse),(e=>{var t,a,n;return e&&(null==e||null===(t=e.Endpoint)||void 0===t||null===(a=t.policy)||void 0===a||null===(n=a.applied)||void 0===n?void 0:n.status)||""})),$=e=>e.nonExistingPolicies,V=e=>e.agentPolicies,U=e=>e.endpointsExist,Q=Object(s.createSelector)(N,(({admin_query:e})=>{const t={query:"",language:"kuery"};if(e){const a=Object(o.decode)(e);a&&"string"==typeof a.query&&(t.query=a.query),!a||"string"!=typeof a.language||"kuery"!==a.language&&"lucene"!==a.language||(t.language=a.language)}return t})),W=e=>e.isolationRequestState,G=Object(s.createSelector)(W,(e=>Object(d.h)(e))),K=Object(s.createSelector)(W,(e=>Object(d.g)(e))),J=Object(s.createSelector)(W,(e=>{if(Object(d.f)(e))return e.error})),Y=Object(s.createSelector)(N,(e=>e.show===m.b.activityLog)),X=Object(s.createSelector)(v,(e=>e&&Object(p.b)(e)||!1)),Z=e=>e.endpointPendingActions,ee=Object(s.createSelector)(Z,(e=>t=>{let a=0,n=0,i=0,s=0,r=0;if(Object(d.g)(e)){const d=e.data.get(t.elastic.agent.id);var o,l,c,u,m;d&&(a=null!==(o=null==d?void 0:d.isolate)&&void 0!==o?o:0,n=null!==(l=null==d?void 0:d.unisolate)&&void 0!==l?l:0,i=null!==(c=null==d?void 0:d["kill-process"])&&void 0!==c?c:0,s=null!==(u=null==d?void 0:d["suspend-process"])&&void 0!==u?u:0,r=null!==(m=null==d?void 0:d["running-processes"])&&void 0!==m?m:0)}return{isIsolated:Object(p.b)(t),pendingActions:{pendingIsolate:a,pendingUnIsolate:n,pendingKillProcess:i,pendingSuspendProcess:s,pendingRunningProcesses:r}}})),te=e=>e.metadataTransformStats,ae=e=>Object(d.g)(e.metadataTransformStats)?e.metadataTransformStats.data:[],ne=e=>Object(d.h)(e.metadataTransformStats)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return n})),a.d(t,"e",(function(){return v})),a.d(t,"c",(function(){return k}));var n={};a.r(n),a.d(n,"authenticationsSelector",(function(){return c})),a.d(n,"hostsSelector",(function(){return u})),a.d(n,"hostRiskScoreSelector",(function(){return d})),a.d(n,"hostRiskScoreSeverityFilterSelector",(function(){return p})),a.d(n,"uncommonProcessesSelector",(function(){return m})),a.d(n,"hostsAnomaliesJobIdFilterSelector",(function(){return g})),a.d(n,"hostsAnomaliesIntervalSelector",(function(){return f}));var i=a(435),s=a(232),r=a(3),o=a(14);const l=(e,t)=>Object(r.get)(t,e.hosts),c=()=>Object(o.createSelector)(l,(e=>e.queries.authentications)),u=()=>Object(o.createSelector)(l,(e=>e.queries[s.HostsTableType.hosts])),d=()=>Object(o.createSelector)(l,(e=>e.queries[s.HostsTableType.risk])),p=()=>Object(o.createSelector)(l,(e=>e.queries[s.HostsTableType.risk].severitySelection)),m=()=>Object(o.createSelector)(l,(e=>e.queries.uncommonProcesses)),g=()=>Object(o.createSelector)(l,(e=>e.queries[s.HostsTableType.anomalies].jobIdSelection)),f=()=>Object(o.createSelector)(l,(e=>e.queries[s.HostsTableType.anomalies].intervalSelection));var b=a(45),h=a(77),y=a(319),E=a(464);const v={page:{queries:{[s.HostsTableType.authentications]:{activePage:y.a,limit:y.b},[s.HostsTableType.hosts]:{activePage:y.a,limit:y.b,direction:h.b.desc,sortField:h.h.lastSeen},[s.HostsTableType.events]:{activePage:y.a,limit:y.b},[s.HostsTableType.uncommonProcesses]:{activePage:y.a,limit:y.b},[s.HostsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[s.HostsTableType.risk]:{activePage:y.a,limit:y.b,sort:{field:h.w.hostRiskScore,direction:h.b.desc},severitySelection:[]},[s.HostsTableType.sessions]:{activePage:y.a,limit:y.b}}},details:{queries:{[s.HostsTableType.authentications]:{activePage:y.a,limit:y.b},[s.HostsTableType.hosts]:{activePage:y.a,direction:h.b.desc,limit:y.b,sortField:h.h.lastSeen},[s.HostsTableType.events]:{activePage:y.a,limit:y.b},[s.HostsTableType.uncommonProcesses]:{activePage:y.a,limit:y.b},[s.HostsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[s.HostsTableType.risk]:{activePage:y.a,limit:y.b,sort:{field:h.w.hostRiskScore,direction:h.b.desc},severitySelection:[]},[s.HostsTableType.sessions]:{activePage:y.a,limit:y.b}}}},k=Object(b.reducerWithInitialState)(v).case(i.setHostTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:Object(E.c)(e)},details:{...e.details,queries:Object(E.b)(e)}}))).case(i.setHostDetailsTablesActivePageToZero,(e=>({...e,details:{...e.details,queries:Object(E.b)(e)}}))).case(i.updateTableActivePage,((e,{activePage:t,hostsType:a,tableType:n})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[n]:{...e[a].queries[n],activePage:t}}}}))).case(i.updateTableLimit,((e,{limit:t,hostsType:a,tableType:n})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[n]:{...e[a].queries[n],limit:t}}}}))).case(i.updateHostsSort,((e,{sort:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[s.HostsTableType.hosts]:{...e[a].queries[s.HostsTableType.hosts],direction:t.direction,sortField:t.field,activePage:y.a}}}}))).case(i.updateHostRiskScoreSort,((e,{sort:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[s.HostsTableType.risk]:{...e[a].queries[s.HostsTableType.risk],sort:t}}}}))).case(i.updateHostRiskScoreSeverityFilter,((e,{severitySelection:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[s.HostsTableType.risk]:{...e[a].queries[s.HostsTableType.risk],severitySelection:t,activePage:y.a}}}}))).case(i.updateHostsAnomaliesJobIdFilter,((e,{jobIds:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[s.HostsTableType.anomalies]:{...e[a].queries[s.HostsTableType.anomalies],jobIdSelection:t}}}}))).case(i.updateHostsAnomaliesInterval,((e,{interval:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[s.HostsTableType.anomalies]:{...e[a].queries[s.HostsTableType.anomalies],intervalSelection:t}}}}))).build()},,,,,,,function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(242),i=a(354);function s(e=new Map,t){const a=Array.from(t);return new Map([...e,...a.map((e=>[e,{events:[],status:"loading"}]))])}function r(e=new Map,t){const a=Array.from(t);return new Map([...e,...a.map((e=>[e,{events:[],status:"error"}]))])}function o(e=new Map,t){const a=new Map([...e]);return a.delete(t),a}function l({storedNodeInfo:e=new Map,receivedEvents:t,requestedNodes:a,numberOfRequestedEvents:s}){const r=new Map([...e]),o=t.length>=s,l=function(e){const t=new Map;for(const a of e){const e=Object(n.b)(a),s=Object(i.a)(a);if(e){const n=t.get(e);n?(n.events.push(a),n.terminated=n.terminated||s):t.set(e,{events:[a],terminated:s})}}return t}(t);for(const e of a.values())l.has(e)||(o?r.delete(e):r.set(e,{events:[],status:"running"}));for(const[e,t]of l.entries())r.set(e,{events:[...t.events],status:t.terminated?"terminated":"running"});return r}function c(e){return!e||"loading"===e.status||"error"===e.status||e.events.length<=0?void 0:e.events[0]}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t,a)=>{const n=e*t;return{activePage:e,cursorStart:n,fakePossibleCount:4<=e&&e>0?t*(e+2):5*t,querySize:a?t:t+n}}},function(e,t,a){"use strict";var n=a(805);e.exports=function(e,t,a,i){var s,r=e.length,o=0;if(t=t<0?-t>r?0:r+t:t>r?r:t,a=a>0?a:0,i.length<1e4)(s=Array.from(i)).unshift(t,a),n.apply(e,s);else for(a&&n.apply(e,[t,a]);o<i.length;)(s=i.slice(o,o+1e4)).unshift(t,0),n.apply(e,s),o+=1e4,t+=1e4}},function(e,t,a){"use strict";e.exports=function(e){return e<0||32===e}},function(e,t,a){"use strict";var n=a(407);e.exports=function(e){return function(t){return e.test(n(t))}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return b}));var n=a(4),i=a(254),s=a(351),r=a(1);const o=e=>e.groups.some((e=>r.Rb.includes(e)));var l=a(202),c=a(19),u=a(224),d=a(514),p=a(271),m=a(468);const g=Object(p.d)(m.a),f=()=>{const[e,t]=Object(n.useState)([]),{addError:a}=Object(l.a)(),r=Object(u.a)(),m=Object(c.j)(),{error:f,loading:b,result:h,start:y}=Object(p.a)(g),E=Object(i.a)(r),v=Object(s.a)(r);return Object(n.useEffect)((()=>{E&&v&&y({http:m})}),[m,E,v,y]),Object(n.useEffect)((()=>{if(h){const e=h.filter(o);t(e)}}),[h]),Object(n.useEffect)((()=>{f&&a(f,{title:d.a})}),[a,f]),{isLicensed:v,isMlUser:E,jobs:e,loading:b}},b=()=>{const{jobs:e,loading:t}=f();return{jobIds:Object(n.useMemo)((()=>e.map((e=>e.id))),[e]),loading:t}}},,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"e",(function(){return n})),a.d(t,"a",(function(){return S})),a.d(t,"d",(function(){return T}));var n={};a.r(n),a.d(n,"allUsersSelector",(function(){return c})),a.d(n,"userRiskScoreSelector",(function(){return u})),a.d(n,"userRiskScoreSeverityFilterSelector",(function(){return d})),a.d(n,"authenticationsSelector",(function(){return p})),a.d(n,"usersAnomaliesJobIdFilterSelector",(function(){return m})),a.d(n,"usersAnomaliesIntervalSelector",(function(){return g}));var i=a(440),s=a(230),r=a(14);const o=e=>e.users.page,l=(e,t)=>e.users[t],c=()=>Object(r.createSelector)(o,(e=>e.queries[s.UsersTableType.allUsers])),u=()=>Object(r.createSelector)(o,(e=>e.queries[s.UsersTableType.risk])),d=()=>Object(r.createSelector)(o,(e=>e.queries[s.UsersTableType.risk].severitySelection)),p=()=>Object(r.createSelector)(o,(e=>e.queries[s.UsersTableType.authentications])),m=()=>Object(r.createSelector)(l,(e=>e.queries[s.UsersTableType.anomalies].jobIdSelection)),g=()=>Object(r.createSelector)(l,(e=>e.queries[s.UsersTableType.anomalies].intervalSelection));var f=a(45),b=a(3),h=a(319);const y=e=>({...e.page.queries,[s.UsersTableType.allUsers]:{...e.page.queries[s.UsersTableType.allUsers],activePage:h.a}});var E=a(64),v=a(77),k=a(116);const S={page:{queries:{[s.UsersTableType.allUsers]:{activePage:h.a,limit:h.b,sort:{field:k.a.lastSeen,direction:E.a.desc}},[s.UsersTableType.authentications]:{activePage:h.a,limit:h.b},[s.UsersTableType.risk]:{activePage:h.a,limit:h.b,sort:{field:v.w.userRiskScore,direction:E.a.desc},severitySelection:[]},[s.UsersTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[s.UsersTableType.events]:{activePage:h.a,limit:h.b}}},details:{queries:{[s.UsersTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[s.UsersTableType.events]:{activePage:h.a,limit:h.b}}}},T=Object(f.reducerWithInitialState)(S).case(i.setUsersTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:y(e)}}))).case(i.updateTableActivePage,((e,{activePage:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],activePage:t}}}}))).case(i.updateTableLimit,((e,{limit:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],limit:t}}}}))).case(i.updateTableSorting,((e,{sort:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],sort:t,activePage:h.a}}}}))).case(i.updateUserRiskScoreSeverityFilter,((e,{severitySelection:t})=>({...e,page:{...e.page,queries:{...e.page.queries,[s.UsersTableType.risk]:{...e.page.queries[s.UsersTableType.risk],severitySelection:t,activePage:h.a}}}}))).case(i.updateUsersAnomaliesJobIdFilter,((e,{jobIds:t,usersType:a})=>"page"===a?Object(b.set)("page.queries.anomalies.jobIdSelection",t,e):Object(b.set)("details.queries.anomalies.jobIdSelection",t,e))).case(i.updateUsersAnomaliesInterval,((e,{interval:t,usersType:a})=>"page"===a?Object(b.set)("page.queries.anomalies.intervalSelection",t,e):Object(b.set)("details.queries.anomalies.intervalSelection",t,e))).build()},,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(17),i=a(6),s=a(175),r=a(4),o=a.n(r);const l=({count:e})=>{const[t,a,l]=Object(r.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const a=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),n={compactThousands:i.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},s=new Map([[1,""],[1e3,n.compactThousands],[1e6,n.compactMillions],[1e9,n.compactBillions],[1e12,n.compactTrillions]]),r=i.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),o=null!==(t=s.get(a))&&void 0!==t?t:"";return[Math.floor(e/a),o,e/a%1>Number.EPSILON?r:""]}(e||0)),[e]);return null==e?null:0===e?o.a.createElement(o.a.Fragment,null,0):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:o.a.createElement(n.EuiI18nNumber,{value:t}),scale:a,hasRemainder:l}})},c=o.a.memo(l)},function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(709),i=a(3),s=a(4),r=a.n(s),o=a(47),l=a(20),c=a(92),u=a.n(c),d=a(29),p=a(433),m=a(14),g=a(261);const f=e=>e.query,b=e=>e.savedQuery;var h=a(91),y=a(19),E=a(291),v=a(272),k=a(214),S=a(78),T=a(315),x=a(421),w=a(238);const O=Object(s.memo)((({end:e,filterQuery:t,fromStr:a,hideFilterBar:c=!1,hideQueryInput:m=!1,id:g,indexPattern:f,isLoading:b=!1,pollForSignalIndex:h,queries:O,savedQuery:j,setSavedQuery:I,setSearchBarFilter:C,start:M,toStr:D,updateSearch:A,dataTestSubj:F})=>{const{data:{query:{timefilter:{timefilter:R},filterManager:P}},unifiedSearch:{ui:{SearchBar:_}}}=Object(y.k)().services,q=Object(o.useDispatch)(),N=Object(s.useCallback)((()=>{q(E.b.setUsersTablesActivePageToZero()),q(v.a.setHostTablesActivePageToZero()),q(k.b.setNetworkTablesActivePageToZero())}),[q]);(()=>{const e=Object(T.d)(x.a.savedQuery),t=Object(T.d)(x.a.appQuery),a=Object(T.d)(x.a.filters),n=Object(s.useMemo)((()=>S.f.globalQuerySelector()),[]),r=Object(s.useMemo)((()=>S.f.globalFiltersQuerySelector()),[]),l=Object(s.useMemo)((()=>S.f.globalSavedQuerySelector()),[]),c=Object(o.useSelector)(n),u=Object(o.useSelector)(r),d=Object(o.useSelector)(l);Object(s.useEffect)((()=>{var n;null!=d&&""!==d.id?(e(null!==(n=null==d?void 0:d.id)&&void 0!==n?n:null),t(null),a(null)):(e(null),t(Object(i.isEmpty)(c.query)?null:c),a(Object(i.isEmpty)(u)?null:u))}),[d,c,u,e,t,a])})(),(()=>{const e=Object(T.d)(x.a.timerange),t=Object(s.useMemo)((()=>d.d.inputsSelector()),[]),a=Object(o.useSelector)(t),n=Object(w.a)("socTrendsEnabled"),{linkTo:i,timerange:r}=a.global,{linkTo:l,timerange:c}=a.timeline,u=Object(s.useMemo)((()=>{if(n&&a.socTrends){const{linkTo:e,timerange:t}=a.socTrends;return{socTrends:{[x.a.timerange]:t,linkTo:e}}}return{}}),[a.socTrends,n]);Object(s.useEffect)((()=>{e({global:{[x.a.timerange]:r,linkTo:i},timeline:{[x.a.timerange]:c,linkTo:l},...u})}),[e,i,r,l,c,u])})(),Object(s.useEffect)((()=>{null!=a&&null!=D?R.setTime({from:a,to:D}):null!=M&&null!=e&&(N(),R.setTime({from:new Date(M).toISOString(),to:new Date(e).toISOString()}))}),[e,a,M,R,D,N]);const L=Object(s.useCallback)((i=>{null!=h&&h();const s=i.dateRange.from.includes("now")||i.dateRange.to.includes("now");let r={id:g,end:null!=D?D:new Date(e).toISOString(),start:null!=a?a:new Date(M).toISOString(),isInvalid:!1,isQuickSelection:s,updateTime:!1,filterManager:P,setTablesActivePageToZero:N},o=!1;(!s||a===i.dateRange.from&&D===i.dateRange.to)&&(s||M===Object(p.c)(i.dateRange.from)&&e===Object(p.c)(i.dateRange.to))||(o=!0,r.updateTime=!0,r.end=i.dateRange.to,r.start=i.dateRange.from),null==i.query||u()(i.query,t)||(o=!0,r=Object(n.set)("query",i.query,r)),o||(s&&i.dateRange.to!==i.dateRange.from?(r.updateTime=!0,r.end=i.dateRange.to,r.start=i.dateRange.from):O.forEach((e=>e.refetch&&e.refetch()))),window.setTimeout((()=>A(r)),0)}),[g,h,D,e,a,M,P,t,O,A,N]),B=Object(s.useCallback)((e=>{e.dateRange.from.includes("now")||e.dateRange.to.includes("now")?A({id:g,end:e.dateRange.to,start:e.dateRange.from,isInvalid:!1,isQuickSelection:!0,updateTime:!0,filterManager:P,setTablesActivePageToZero:N}):O.forEach((e=>e.refetch&&e.refetch()))}),[A,g,P,O,N]),z=Object(s.useCallback)((e=>{I({id:g,savedQuery:e})}),[g,I]),H=Object(s.useCallback)((t=>{const i=!!t.attributes.timefilter&&(t.attributes.timefilter.from.includes("now")||t.attributes.timefilter.to.includes("now"));let s={id:g,filters:t.attributes.filters||[],end:null!=D?D:new Date(e).toISOString(),start:null!=a?a:new Date(M).toISOString(),isInvalid:!1,isQuickSelection:i,updateTime:!1,filterManager:P,setTablesActivePageToZero:N};t.attributes.timefilter&&(s.end=t.attributes.timefilter?t.attributes.timefilter.to:s.end,s.start=t.attributes.timefilter?t.attributes.timefilter.from:s.start,s.updateTime=!0),s=Object(n.set)("query",t.attributes.query,s),s=Object(n.set)("savedQuery",t,s),A(s)}),[g,D,e,a,M,P,A,N]),$=Object(s.useCallback)((()=>{null!=j&&A({id:g,filters:[],end:null!=D?D:new Date(e).toISOString(),start:null!=a?a:new Date(M).toISOString(),isInvalid:!1,isQuickSelection:!1,updateTime:!1,query:{query:"",language:j.attributes.query.language},resetSavedQuery:!0,savedQuery:void 0,filterManager:P,setTablesActivePageToZero:N})}),[j,A,g,D,e,a,M,P,N]);Object(s.useEffect)((()=>{let e=!0;const t=new l.Subscription;return t.add(P.getUpdates$().subscribe({next:()=>{if(e){const e=P.getFilters();C({id:g,filters:e}),N()}}})),()=>{e=!1,t.unsubscribe()}}),[]);const V=Object(s.useMemo)((()=>[f]),[f]);return r.a.createElement("div",{"data-test-subj":`${g}DatePicker`},r.a.createElement(_,{appName:"siem",isLoading:b,indexPatterns:V,query:t,onClearSavedQuery:$,onQuerySubmit:L,onRefresh:B,onSaved:z,onSavedQueryUpdated:H,savedQuery:j,showFilterBar:!c,showDatePicker:!0,showQueryBar:!0,showQueryInput:!m,showSaveQuery:!0,dataTestSubj:F}))}),((e,t)=>e.end===t.end&&e.filterQuery===t.filterQuery&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.savedQuery===t.savedQuery&&e.setSavedQuery===t.setSavedQuery&&e.setSearchBarFilter===t.setSearchBarFilter&&e.start===t.start&&e.toStr===t.toStr&&e.updateSearch===t.updateSearch&&e.dataTestSubj===t.dataTestSubj&&u()(e.indexPattern,t.indexPattern)&&u()(e.queries,t.queries)));O.displayName="SiemSearchBar";const j=e=>({end:t,filters:a,id:n,isQuickSelection:i,query:s,resetSavedQuery:r,savedQuery:o,start:l,timelineId:c,updateTime:u=!1,filterManager:m,setTablesActivePageToZero:g})=>{if(u){const a=Object(p.c)(l);let s=Object(p.c)(t,{roundUp:!0});i?e(t===l?d.b.setAbsoluteRangeDatePicker({id:n,fromStr:l,toStr:t,from:a,to:s}):d.b.setRelativeRangeDatePicker({id:n,fromStr:l,toStr:t,from:a,to:s})):(s=Object(p.c)(t),e(d.b.setAbsoluteRangeDatePicker({id:n,from:Object(p.c)(l),to:Object(p.c)(t)}))),null!=c&&e(h.a.updateRange({id:c,start:a,end:s}))}null!=s&&e(d.b.setFilterQuery({id:n,...s})),null!=a&&m.setFilters(a),(null!=o||r)&&e(d.b.setSavedQuery({id:n,savedQuery:o})),g()},I=Object(o.connect)((()=>{const e=Object(g.b)(),t=Object(g.c)(),a=Object(g.d)(),n=Object(g.h)(),s=Object(g.i)(),r=Object(g.j)(),o=Object(m.createSelector)(f,(e=>e)),l=Object(m.createSelector)(b,(e=>e));return(c,{id:u})=>{const d=Object(i.getOr)({},`inputs.${u}`,c);return{end:e(d),fromStr:t(d),filterQuery:o(d),isLoading:a(d),queries:n(c,u),savedQuery:l(d),start:s(d),toStr:r(d)}}}),(e=>({updateSearch:j(e),setSavedQuery:({id:t,savedQuery:a})=>e(d.b.setSavedQuery({id:t,savedQuery:a})),setSearchBarFilter:({id:t,filters:a})=>e(d.b.setSearchBarFilter({id:t,filters:a}))})))(O)},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(4),i=a.n(n),s=a(24),r=a.n(s),o=a(323),l=a(17),c=a(642);const u=r.a.header.withConfig({displayName:"FiltersGlobalContainer",componentId:"sc-z1qy4y-0"})(["display:",";"],(({show:e})=>e?"block":"none"));u.displayName="FiltersGlobalContainer";const d=i.a.memo((({children:e,show:t=!0})=>{const{globalKQLHeaderPortalNode:a}=Object(c.a)();return i.a.createElement(o.a,{node:a},i.a.createElement(l.EuiPanel,{borderRadius:"none",color:"subdued",paddingSize:"none"},i.a.createElement(u,{"data-test-subj":"filters-global-container",show:t},e)))}));d.displayName="FiltersGlobal"},,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),s=a(623),r=a(95);const o=Object(n.memo)((()=>i.a.createElement(r.a,null,i.a.createElement(s.a,null))));o.displayName="LandingPageComponent"},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"f",(function(){return s})),a.d(t,"e",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return l}));const n=.5,i=2,s=2,r=50,o=300,l=1e3},function(e,t,a){"use strict";function n(e,t){return Array.isArray(e)?e.includes(t):e===t}function i(e){if(null!==e){if(!Array.isArray(e))return e;for(const t of e)if(null!==t)return t}}function s(e){if(Array.isArray(e)){const t=[];for(const a of e)null!=a&&t.push(a);return t}return null!=e?[e]:[]}a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return s}))},function(e,t,a){"use strict";a.d(t,"g",(function(){return y})),a.d(t,"b",(function(){return O})),a.d(t,"e",(function(){return C})),a.d(t,"f",(function(){return M})),a.d(t,"h",(function(){return D})),a.d(t,"c",(function(){return N})),a.d(t,"d",(function(){return L})),a.d(t,"a",(function(){return B}));var n=a(102),i=a.n(n),s=a(26),r=a.n(s),o=a(68),l=a.n(o),c=(a(62),a(24)),u=a.n(c),d=a(17),p=a(217),m=a(262),g=a(2),f=a(582),b=a(250),h=a(524);const y=({rule:e,detailsView:t=!1})=>{const a=v(e);return{aboutRuleData:x(e,t),modifiedAboutRuleDetailsData:I(e),defineRuleData:a,scheduleRuleData:S(e),ruleActionsData:E(e)}},E=e=>{const{enabled:t,throttle:a,meta:n,actions:i=[],response_actions:s}=e;return{actions:null==i?void 0:i.map(f.c),responseActions:null==s?void 0:s.map(f.d),throttle:a,kibanaSiemAppUrl:null==n?void 0:n.kibana_siem_app_url,enabled:t}},v=e=>{var t,a,n,i,s,r,o,l,c,u,d,p,g,f,h,y,E,v,S,T,x;return{ruleType:e.type,anomalyThreshold:null!==(t=e.anomaly_threshold)&&void 0!==t?t:50,machineLearningJobId:null!==(a=e.machine_learning_job_id)&&void 0!==a?a:[],index:null!==(n=e.index)&&void 0!==n?n:[],dataViewId:e.data_view_id,threatIndex:null!==(i=e.threat_index)&&void 0!==i?i:[],threatQueryBar:{query:{query:null!==(s=e.threat_query)&&void 0!==s?s:"",language:null!==(r=e.threat_language)&&void 0!==r?r:""},filters:null!==(o=e.threat_filters)&&void 0!==o?o:[],saved_id:null},threatMapping:null!==(l=e.threat_mapping)&&void 0!==l?l:[],queryBar:{query:{query:null!==(c=e.query)&&void 0!==c?c:"",language:null!==(u=e.language)&&void 0!==u?u:""},filters:null!==(d=e.filters)&&void 0!==d?d:[],saved_id:null!==(p=e.saved_id)&&void 0!==p?p:null},relatedIntegrations:null!==(g=e.related_integrations)&&void 0!==g?g:[],requiredFields:null!==(f=e.required_fields)&&void 0!==f?f:[],timeline:{id:null!==(h=e.timeline_id)&&void 0!==h?h:null,title:null!==(y=e.timeline_title)&&void 0!==y?y:null},threshold:{field:Object(m.g)(null===(E=e.threshold)||void 0===E?void 0:E.field),value:`${(null===(v=e.threshold)||void 0===v?void 0:v.value)||100}`,...null!==(S=e.threshold)&&void 0!==S&&null!==(T=S.cardinality)&&void 0!==T&&T.length?{cardinality:{field:[`${e.threshold.cardinality[0].field}`],value:`${e.threshold.cardinality[0].value}`}}:{}},eqlOptions:{timestampField:e.timestamp_field,eventCategoryField:e.event_category_override,tiebreakerField:e.tiebreaker_field},dataSourceType:e.data_view_id?b.a.DataView:b.a.IndexPatterns,newTermsFields:null!==(x=e.new_terms_fields)&&void 0!==x?x:[],historyWindowSize:e.history_window_start?k(e.history_window_start):"7d",shouldLoadQueryDynamically:Boolean("saved_query"===e.type&&e.saved_id)}},k=e=>e.startsWith("now-")?e.substring(4):e,S=e=>{const{interval:t,from:a}=e;return{interval:t,from:T(a,t)}},T=(e,t)=>{var a,n;const s=null!==(a=i.a.parse(e))&&void 0!==a?a:r()(),o=null!==(n=i.a.parse(`now-${t}`))&&void 0!==n?n:r()(),l=r.a.duration(o.diff(s)),c=Math.floor(l.asSeconds());return 0===c?"0s":c%3600==0?c/3600+"h":c%60==0?c/60+"m":`${c}s`},x=(e,t)=>{var a;const{name:n,description:i,note:s}=j(e,t),{author:r,building_block_type:o,exceptions_list:l,license:c,risk_score_mapping:u,rule_name_override:d,severity_mapping:m,timestamp_override:g,timestamp_override_fallback_disabled:f,references:b,severity:h,false_positives:y,risk_score:E,tags:v,threat:k,threat_indicator_path:S}=e;return{author:r,isAssociatedToEndpointList:null!==(a=null==l?void 0:l.some((({id:e})=>e===p.j)))&&void 0!==a&&a,isBuildingBlock:void 0!==o,license:null!=c?c:"",ruleNameOverride:null!=d?d:"",timestampOverride:null!=g?g:"",timestampOverrideFallbackDisabled:f,name:n,description:i,note:s,references:b,severity:{value:h,mapping:O(m),isMappingChecked:m.length>0},tags:v,riskScore:{value:E,mapping:u,isMappingChecked:u.length>0},falsePositives:y,threat:k,threatIndicatorPath:S}},w={low:0,medium:1,high:2,critical:3},O=e=>{const t=h.i.flatMap((t=>null==e.find((e=>e.severity===t.value))?[{field:"",value:"",operator:"equals",severity:t.value}]:[]));return[...e,...t].sort(((e,t)=>w[e.severity]-w[t.severity]))},j=(e,t)=>{const{name:a,description:n,note:i}=e;return t?{name:"",description:"",note:""}:{name:a,description:n,note:null!=i?i:""}},I=e=>{var t,a;return{note:null!==(t=e.note)&&void 0!==t?t:"",description:e.description,setup:null!==(a=e.setup)&&void 0!==a?a:""}},C=(e,t,a)=>null!=t&&0===e&&t>0&&0===a?"ruleNotInstalled":null!=e&&e>0&&0===t&&0===a?"ruleInstalled":null!=e&&null!=t&&e>0&&t>0&&0===a?"someRuleUninstall":null!=e&&null!=t&&null!=a&&e>0&&t>=0&&a>0?"ruleNeedUpdate":"unknown",M=(e,t,a)=>null!=t&&0===e&&t>0&&0===a?"timelinesNotInstalled":null!=e&&e>0&&0===t&&0===a?"timelinesInstalled":null!=e&&null!=t&&e>0&&t>0&&0===a?"someTimelineUninstall":null!=e&&null!=t&&null!=a&&e>0&&t>=0&&a>0?"timelineNeedUpdate":"unknown",D=(e,t,a,n)=>!1===e||!1===t||!1===a||n,A=["id","name","description","false_positives","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version"],F=["index","filters","language","query","saved_id","response_actions"],R=["anomaly_threshold","machine_learning_job_id"],P=["threshold",...F],_=e=>{switch(e){case"machine_learning":return R;case"threshold":return P;case"new_terms":case"threat_match":case"query":case"saved_query":case"eql":return F}Object(g.a)(e)},q=e=>({state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link",useWithTripleBracesInTemplates:!0},{name:"alerts",description:"context.alerts"},...e.map((e=>{const t=`rule.${e}`;return{name:t,description:`context.${t}`}}))]}),N=l()((e=>{if(!e)return{state:[],params:[]};const t=(e=>[...A,..._(e)].sort())(e);return q(t)})),L=()=>q((()=>{const e=[...A,...F,...R,...P].sort();return Array.from(new Set(e))})()),B=u()(d.EuiFlexItem).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-97v502-0"})(["max-width:1000px;overflow:hidden;"])},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(4),i=a(218),s=a(202),r=a(244),o=a(274);const l="findRules",c=(e,t,a)=>{const{addError:n}=Object(s.a)();return Object(i.useQuery)([l,...e,t],(async({signal:e})=>{const a=await Object(r.e)({signal:e,...t});return{rules:a.data,total:a.total}}),{refetchIntervalInBackground:!1,onError:e=>n(e,{title:o.h}),...a})},u=()=>{const e=Object(i.useQueryClient)();return Object(n.useCallback)((()=>{e.invalidateQueries([l],{refetchType:"active"})}),[e])},d=()=>{const e=Object(i.useQueryClient)();return Object(n.useCallback)((t=>{e.setQueriesData([l],(e=>e?{rules:p(e.rules,t),total:e.total}:void 0))}),[e])};function p(e,t){const a=new Map(t.map((e=>[e.id,e])));return e.some((e=>a.has(e.id)))?e.map((e=>{var t;return null!==(t=a.get(e.id))&&void 0!==t?t:e})):e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),s=a(175),r=a(17),o=a(95);const l=i.a.memo((()=>i.a.createElement(o.a,null,i.a.createElement(r.EuiPageTemplate_Deprecated,{template:"centeredContent"},i.a.createElement(r.EuiEmptyPrompt,{"data-test-subj":"notFoundPage",iconColor:"default",iconType:"logoElastic",title:i.a.createElement("p",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.pages.fourohfour.pageNotFoundDescription",defaultMessage:"Page not found"}))})))));l.displayName="NotFoundPage"},function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"f",(function(){return u})),a.d(t,"g",(function(){return p})),a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return E})),a.d(t,"c",(function(){return v})),a.d(t,"i",(function(){return f})),a.d(t,"k",(function(){return X})),a.d(t,"l",(function(){return y})),a.d(t,"m",(function(){return k})),a.d(t,"n",(function(){return O})),a.d(t,"o",(function(){return j})),a.d(t,"p",(function(){return D})),a.d(t,"x",(function(){return G})),a.d(t,"w",(function(){return Z})),a.d(t,"t",(function(){return ee})),a.d(t,"r",(function(){return te})),a.d(t,"q",(function(){return ie})),a.d(t,"v",(function(){return se})),a.d(t,"s",(function(){return re})),a.d(t,"u",(function(){return oe})),a.d(t,"h",(function(){return le})),a.d(t,"j",(function(){return ce})),a.d(t,"y",(function(){return ue})),a.d(t,"z",(function(){return de}));var n=a(0),i=n.recursion("saved_object_attribute_single",(function(){return n.union([n.string,n.number,n.boolean,n.null,n[void 0],r])})),s=n.recursion("saved_object_attribute",(function(){return n.union([i,n.array(i)])})),r=n.recursion("saved_object_attributes",(function(){return n.record(n.string,s)})),o=n.string,l=n.string,c=n.string,u=r,d=n.exact(n.type({group:o,id:l,action_type_id:c,params:u})),p=n.array(d),m=(n.array(n.exact(n.type({group:o,id:l,actionTypeId:c,params:u}))),new n.Type("DefaultActionsArray",p.is,(function(e,t){return null==e?n.success([]):p.validate(e,t)}),n.identity),new n.Type("DefaultExportFileName",n.string.is,(function(e,t){return null==e?n.success("export.ndjson"):n.string.validate(e,t)}),n.identity)),g=a(613),f=new n.Type("From",n.string.is,(function(e,t){return function(e){return"string"==typeof e}(e)&&null==Object(g.a)(e)?n.failure(e,t,'Failed to parse "from" on rule param'):n.string.validate(e,t)}),n.identity),b=(n.union([f,n[void 0]]),new n.Type("DefaultFromString",n.string.is,(function(e,t){return null==e?n.success("now-6m"):f.validate(e,t)}),n.identity),new n.Type("DefaultIntervalString",n.string.is,(function(e,t){return null==e?n.success("5m"):n.string.validate(e,t)}),n.identity),n.keyof({eql:null,kuery:null,lucene:null})),h=(n.union([b,n[void 0]]),new n.Type("DefaultLanguageString",n.string.is,(function(e,t){return null==e?n.success("kuery"):b.validate(e,t)}),n.identity),a(16)),y=h.o,E=(n.union([y,n[void 0]]),new n.Type("DefaultMaxSignals",n.number.is,(function(e,t){return null==e?n.success(100):y.validate(e,t)}),n.identity),new n.Type("DefaultPerPage",n.number.is,(function(e,t){return null==e?n.success(1):"string"==typeof e?h.o.validate(parseInt(e,10),t):h.o.validate(e,t)}),n.identity)),v=new n.Type("DefaultPerPage",n.number.is,(function(e,t){return null==e?n.success(20):"string"==typeof e?h.o.validate(parseInt(e,10),t):h.o.validate(e,t)}),n.identity),k=new n.Type("RiskScore",n.number.is,(function(e,t){return"number"==typeof e&&Number.isSafeInteger(e)&&e>=0&&e<=100?n.success(e):n.failure(e,t)}),n.identity),S=n.union([k,n[void 0]]),T=n.string,x=n.string,w=n.exact(n.type({field:T,value:x,operator:h.w,risk_score:S})),O=n.array(w),j=(n.union([O,n[void 0]]),new n.Type("DefaultRiskScoreMappingArray",O.is,(function(e,t){return null==e?n.success([]):O.validate(e,t)}),n.identity),n.keyof({low:null,medium:null,high:null,critical:null})),I=(n.union([j,n[void 0]]),n.string),C=n.string,M=n.exact(n.type({field:I,operator:h.w,value:C,severity:j})),D=n.array(M),A=(n.union([D,n[void 0]]),new n.Type("DefaultSeverityMappingArray",D.is,(function(e,t){return null==e?n.success([]):D.validate(e,t)}),n.identity),n.string),F=n.string,R=n.string,P=n.type({id:A,name:F,reference:R}),_=n.string,q=n.string,N=n.string,L=n.type({id:_,name:q,reference:N}),B=n.array(L),z=n.string,H=n.string,$=n.string,V=n.intersection([n.exact(n.type({id:z,name:H,reference:$})),n.exact(n.partial({subtechnique:B}))]),U=n.array(V),Q=n.string,W=n.intersection([n.exact(n.type({framework:Q,tactic:P})),n.exact(n.partial({technique:U}))]),G=n.array(W),K=(n.union([G,n[void 0]]),new n.Type("DefaultThreatArray",G.is,(function(e,t){return null==e?n.success([]):G.validate(e,t)}),n.identity),new n.Type("DefaultToString",n.string.is,(function(e,t){return null==e?n.success("now"):n.string.validate(e,t)}),n.identity),a(50)),J=a.n(K),Y=(new n.Type("DefaultUuid",n.string.is,(function(e,t){return null==e?n.success(J.a.v4()):h.k.validate(e,t)}),n.identity),Object(h.j)(n.string)),X=(n.union([Y,n[void 0]]),n.union([n.string,Y])),Z=(n.union([X,n[void 0]]),new n.Type("referencesWithDefaultArray",n.array(n.string).is,(function(e,t){return null==e?n.success([]):n.array(n.string).validate(e,t)}),n.identity),n.string),ee=(n.union([Z,n[void 0]]),n.string),te=(n.union([ee,n[void 0]]),n.array(n.unknown)),ae=(n.union([te,n[void 0]]),n.exact(n.type({field:h.k,type:n.keyof({mapping:null}),value:h.k}))),ne=n.array(ae),ie=n.exact(n.type({entries:ne})),se=Object(h.j)(ie,"NonEmptyArray<ThreatMap>"),re=(n.union([se,n[void 0]]),n.array(n.string)),oe=(n.union([re,n[void 0]]),n.union([b,n[void 0]])),le=(n.union([oe,n[void 0]]),h.o),ce=(n.union([le,n[void 0]]),h.o),ue=(n.union([ce,n[void 0]]),n.union([n.literal("no_actions"),n.literal("rule"),Object(h.q)({allowedUnits:["h","d"]})])),de=(n.union([ue,n.null]),n.keyof({eql:null,machine_learning:null,query:null,saved_query:null,threshold:null,threat_match:null,new_terms:null}));n.union([de,n[void 0]])},,function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return S}));var n=a(47),i=a(209);function s(e){return Object(n.useSelector)((function(t){return e(t[i.u][i.t])}))}var r=a(4),o=a.n(r),l=a(175),c=a(189),u=a(235),d=a(526),p=a(238),m=a(1),g=a(234),f=a(270),b=a(100),h=a(292),y=a(79),E=a(654),v=a(653),k=a(83);const S=(e,t)=>{const a=Object(y.b)().isPlatinumPlus(),{getAppUrl:n}=Object(b.b)(),i=s(f.agentPolicies),S=s(f.uiQueryParams),T=Object(d.c)(),x=Object(p.a)("responseActionsConsoleEnabled"),w=Object(u.a)().endpointPrivileges.canAccessResponseConsole,O=Object(v.a)(e);return Object(r.useMemo)((()=>{if(e){const s=Object(h.b)(e),r=e.agent.id,u=e.Endpoint.policy.applied.id,d=e.host.hostname,p=e.elastic.agent.id,f=Object(E.a)({osName:e.host.os.name,version:e.agent.version,capabilities:e.Endpoint.capabilities}),{show:b,selected_endpoint:y,...v}=S,j=Object(g.d)({name:"endpointActivityLog",...v,selected_endpoint:r}),I=Object(g.d)({name:"endpointIsolate",...v,selected_endpoint:r}),C=Object(g.d)({name:"endpointUnIsolate",...v,selected_endpoint:r}),M=[];return s?M.push({"data-test-subj":"unIsolateLink",icon:"lockOpen",key:"unIsolateHost",navigateAppId:m.A,navigateOptions:{path:C},href:n({path:C}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.unIsolateHost",defaultMessage:"Release host"})}):a&&f&&M.push({"data-test-subj":"isolateLink",icon:"lock",key:"isolateHost",navigateAppId:m.A,navigateOptions:{path:I},href:n({path:I}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.isolateHost",defaultMessage:"Isolate host"})}),[...M,...x&&w?[{"data-test-subj":"console",icon:"console",key:"consoleLink",disabled:!O,onClick:t=>{t.preventDefault(),T(e)},children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.console",defaultMessage:"Respond"}),toolTipContent:O?"":k.g}]:[],...null!=t&&t.isEndpointList?[{"data-test-subj":"actionsLink",icon:"logoSecurity",key:"actionsLogLink",navigateAppId:m.A,navigateOptions:{path:j},href:n({path:j}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.responseActionsHistory",defaultMessage:"View response actions history"})}]:[],{"data-test-subj":"hostLink",icon:"logoSecurity",key:"hostDetailsLink",navigateAppId:m.A,navigateOptions:{path:`/hosts/${d}`},href:n({path:`/hosts/${d}`}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.hostDetails",defaultMessage:"View host details"})},{icon:"gear",key:"agentConfigLink","data-test-subj":"agentPolicyLink",navigateAppId:"fleet",navigateOptions:{path:`${c.pagePathGetters.policy_details({policyId:i[u]})[1]}`},href:`${n({appId:"fleet"})}${c.pagePathGetters.policy_details({policyId:i[u]})[1]}`,disabled:void 0===i[u],children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicy",defaultMessage:"View agent policy"})},{icon:"gear",key:"agentDetailsLink","data-test-subj":"agentDetailsLink",navigateAppId:"fleet",navigateOptions:{path:`${c.pagePathGetters.agent_details({agentId:p})[1]}`},href:`${n({appId:"fleet"})}${c.pagePathGetters.agent_details({agentId:p})[1]}`,children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentDetails",defaultMessage:"View agent details"})},{icon:"gear",key:"agentPolicyReassignLink","data-test-subj":"agentPolicyReassignLink",navigateAppId:"fleet",navigateOptions:{path:`${c.pagePathGetters.agent_details({agentId:p})[1]}?openReassignFlyout=true`},href:`${n({appId:"fleet"})}${c.pagePathGetters.agent_details({agentId:p})[1]}?openReassignFlyout=true`,children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicyReassign",defaultMessage:"Reassign agent policy"})}]}return[]}),[S,w,e,i,n,a,x,T,null==t?void 0:t.isEndpointList,O])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),s=a(17),r=a(6),o=a(175);const l=r.i18n.translate("xpack.securitySolution.detectionResponse.updating",{defaultMessage:"Updating..."}),c=r.i18n.translate("xpack.securitySolution.detectionResponse.updated",{defaultMessage:"Updated"}),u=({isUpdating:e,updatedAt:t})=>i.a.createElement(s.EuiFlexGroup,null,e?i.a.createElement(s.EuiFlexItem,{grow:!1},l):i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(i.a.Fragment,null,c," "),i.a.createElement(o.FormattedRelative,{"data-test-subj":"last-updated-at-date",value:new Date(t)})))},,,,function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"e",(function(){return s})),a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(226);const i=()=>({windows:{events:{dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:n.e.prevent,blocklist:!0},ransomware:{mode:n.e.prevent,supported:!0},memory_protection:{mode:n.e.prevent,supported:!0},behavior_protection:{mode:n.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{enabled:!1},attack_surface_reduction:{credential_hardening:{enabled:!0}}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:n.e.prevent,blocklist:!0},behavior_protection:{mode:n.e.prevent,supported:!0},memory_protection:{mode:n.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}},linux:{events:{process:!0,file:!0,network:!0,session_data:!1,tty_io:!1},malware:{mode:n.e.prevent,blocklist:!0},behavior_protection:{mode:n.e.prevent,supported:!0},memory_protection:{mode:n.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}}}),s=(e=i())=>{const t={rollback:{self_healing:{enabled:!1}}};return{...e,windows:{...e.windows,advanced:void 0===e.windows.advanced?void 0:{...e.windows.advanced,alerts:void 0===e.windows.advanced.alerts?{...t}:{...e.windows.advanced.alerts,...t}},ransomware:{mode:n.e.off,supported:!1},memory_protection:{mode:n.e.off,supported:!1},behavior_protection:{mode:n.e.off,supported:!1},attack_surface_reduction:{credential_hardening:{enabled:!1}},popup:{...e.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},mac:{...e.mac,behavior_protection:{mode:n.e.off,supported:!1},memory_protection:{mode:n.e.off,supported:!1},popup:{...e.mac.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},linux:{...e.linux,behavior_protection:{mode:n.e.off,supported:!1},memory_protection:{mode:n.e.off,supported:!1},popup:{...e.linux.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}}}},r=(e=i())=>({...e,windows:{...e.windows,ransomware:{...e.windows.ransomware,supported:!0},memory_protection:{...e.windows.memory_protection,supported:!0},behavior_protection:{...e.windows.behavior_protection,supported:!0}},mac:{...e.mac,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.mac.memory_protection,supported:!0}},linux:{...e.linux,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.linux.memory_protection,supported:!0}}}),o="Elastic Security {action} {filename}",l="Elastic Security {action} {rule}"},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"e",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return p}));var n=a(62),i=a(14),s=a(209);const r=e=>e.artifacts.location,o=e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.pathname},l=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:s.n,exact:!0}))),c=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:s.q,exact:!0}))),u=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:s.m,exact:!0}))),d=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:s.o,exact:!0}))),p=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:s.l,exact:!0})))},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i}));const n=10,i=0},,,,function(e,t,a){"use strict";a.d(t,"c",(function(){return p})),a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n,i=a(4),s=a(146),r=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},n(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),o="html",l="svg",c=function(e,t){var a,n,i,s={};if(e===o)i=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');i=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var r=0,c=Object.entries(t.attributes);r<c.length;r++){var u=c[r],d=u[0],p=u[1];i.setAttribute(d,p)}var m={element:i,elementType:e,setPortalProps:function(e){s=e},getInitialPortalProps:function(){return s},mount:function(t,i){if(i!==n){if(m.unmount(),t!==a&&!function(e,t){if(t===o)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(m.element,i),a=t,n=i}},unmount:function(e){e&&e!==n||a&&n&&(a.replaceChild(n,m.element),a=void 0,n=void 0)}};return m},u=function(e){function t(t){var a=e.call(this,t)||this;return a.addPropsChannel=function(){Object.assign(a.props.node,{setPortalProps:function(e){a.setState({nodeProps:e})}})},a.state={nodeProps:a.props.node.getInitialPortalProps()},a}return r(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,a=t.children,n=t.node;return s.createPortal(i.Children.map(a,(function(t){return i.isValidElement(t)?i.cloneElement(t,e.state.nodeProps):t})),n.element)},t}(i.PureComponent),d=function(e){function t(t){var a=e.call(this,t)||this;return a.placeholderNode=i.createRef(),a.passPropsThroughPortal(),a}return r(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return i.createElement("div",{ref:this.placeholderNode})},t}(i.PureComponent),p=c.bind(null,o);c.bind(null,l)},function(e,t,a){"use strict";a.d(t,"o",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"r",(function(){return r})),a.d(t,"q",(function(){return o})),a.d(t,"n",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"s",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"m",(function(){return g})),a.d(t,"p",(function(){return f})),a.d(t,"l",(function(){return b})),a.d(t,"k",(function(){return h})),a.d(t,"f",(function(){return y})),a.d(t,"g",(function(){return E})),a.d(t,"i",(function(){return v})),a.d(t,"h",(function(){return k})),a.d(t,"j",(function(){return S}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.anomaliesTable.table.showingDescription",{defaultMessage:"Showing"}),s=n.i18n.translate("xpack.securitySolution.anomaliesTable.table.anomaliesDescription",{defaultMessage:"Anomalies"}),r=e=>n.i18n.translate("xpack.securitySolution.anomaliesTable.table.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {anomaly} other {anomalies}}"}),o=n.i18n.translate("xpack.securitySolution.anomaliesTable.table.anomaliesTooltip",{defaultMessage:"The anomalies table is not filterable via the SIEM global KQL search."}),l=n.i18n.translate("xpack.securitySolution.ml.table.scoreTitle",{defaultMessage:"Anomaly score"}),c=n.i18n.translate("xpack.securitySolution.ml.table.hostNameTitle",{defaultMessage:"Host name"}),u=n.i18n.translate("xpack.securitySolution.ml.table.userNameTitle",{defaultMessage:"User name"}),d=n.i18n.translate("xpack.securitySolution.ml.table.influencedByTitle",{defaultMessage:"Influenced by"}),p=n.i18n.translate("xpack.securitySolution.ml.table.entityTitle",{defaultMessage:"Entity"}),m=n.i18n.translate("xpack.securitySolution.ml.table.detectorTitle",{defaultMessage:"Job"}),g=n.i18n.translate("xpack.securitySolution.ml.table.networkNameTitle",{defaultMessage:"Network IP"}),f=n.i18n.translate("xpack.securitySolution.ml.table.timestampTitle",{defaultMessage:"Timestamp"}),b=n.i18n.translate("xpack.securitySolution.ml.table.jobIdFilter",{defaultMessage:"Job"}),h=n.i18n.translate("xpack.securitySolution.ml.table.intervalTooltip",{defaultMessage:"Show only the highest severity anomaly for each interval (such as hour or day) or show all anomalies in the selected time period."}),y=n.i18n.translate("xpack.securitySolution.ml.table.intervalLabel",{defaultMessage:"Interval"}),E=n.i18n.translate("xpack.securitySolution.ml.table.intervalAutoOption",{defaultMessage:"Auto"}),v=n.i18n.translate("xpack.securitySolution.ml.table.intervalHourOption",{defaultMessage:"1 hour"}),k=n.i18n.translate("xpack.securitySolution.ml.table.intervalDayOption",{defaultMessage:"1 day"}),S=n.i18n.translate("xpack.securitySolution.ml.table.intervalshowAllOption",{defaultMessage:"Show all"})},,function(e,t,a){const{MAX_LENGTH:n}=a(398),{re:i,t:s}=a(325),r=a(233),o=a(399);e.exports=(e,t)=>{if(t=o(t),e instanceof r)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?i[s.LOOSE]:i[s.FULL]).test(e))return null;try{return new r(e,t)}catch(e){return null}}},function(e,t,a){"use strict";var n=a(358);e.exports=function(e){return n({},e)}},function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(215),i=a(263),s=a(414);const r=e=>"boolean"==typeof e,o=(e,t)=>{var a;return null==e||!((null===(a=e.actions)||void 0===a?void 0:a.length)>0&&r(t))||t},l=e=>null==e||e,c=(e,t,a,r)=>null==e?void 0:Object(i.d)(e.type)&&!t?s.f:o(e,a)?l(r)?void 0:n.Pb:n.Ob},,function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return c})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"k",(function(){return m.d})),a.d(t,"l",(function(){return m.e})),a.d(t,"p",(function(){return m.j})),a.d(t,"G",(function(){return m.B})),a.d(t,"i",(function(){return m.b})),a.d(t,"h",(function(){return m.a})),a.d(t,"q",(function(){return m.k})),a.d(t,"r",(function(){return m.l})),a.d(t,"Q",(function(){return m.S})),a.d(t,"T",(function(){return m.V})),a.d(t,"s",(function(){return m.m})),a.d(t,"D",(function(){return m.y})),a.d(t,"u",(function(){return m.o})),a.d(t,"x",(function(){return m.r})),a.d(t,"L",(function(){return m.H})),a.d(t,"w",(function(){return m.q})),a.d(t,"y",(function(){return m.s})),a.d(t,"o",(function(){return m.i})),a.d(t,"z",(function(){return m.t})),a.d(t,"I",(function(){return m.D})),a.d(t,"A",(function(){return m.u})),a.d(t,"H",(function(){return m.C})),a.d(t,"N",(function(){return m.J})),a.d(t,"R",(function(){return m.T})),a.d(t,"S",(function(){return m.U})),a.d(t,"U",(function(){return m.W})),a.d(t,"j",(function(){return m.c})),a.d(t,"V",(function(){return m.X})),a.d(t,"B",(function(){return m.w})),a.d(t,"C",(function(){return m.x})),a.d(t,"M",(function(){return m.I})),a.d(t,"W",(function(){return m.Y})),a.d(t,"J",(function(){return m.E})),a.d(t,"K",(function(){return m.G})),a.d(t,"O",(function(){return m.Q})),a.d(t,"t",(function(){return m.n})),a.d(t,"P",(function(){return m.R})),a.d(t,"E",(function(){return m.z})),a.d(t,"v",(function(){return m.p})),a.d(t,"m",(function(){return m.g})),a.d(t,"X",(function(){return m.Z})),a.d(t,"Y",(function(){return m.ab})),a.d(t,"n",(function(){return m.h})),a.d(t,"F",(function(){return m.A})),a.d(t,"f",(function(){return f})),a.d(t,"g",(function(){return b})),a.d(t,"a",(function(){return y}));var n=a(0),i=a(16);const s=i.o,r=(n.union([s,n[void 0]]),i.n),o=(n.union([r,n[void 0]]),n.type({page:s,per_page:r,total:i.n})),l=n.exact(n.intersection([n.type({package:i.k,version:i.k}),n.partial({integration:i.k})])),c=n.array(l),u=n.exact(n.type({name:i.k,type:i.k,ecs:n.boolean})),d=n.array(u),p=n.string;var m=a(48),g=a(5);const f=n.string,b=(n.union([f,n[void 0]]),n.keyof({asc:null,desc:null})),h=(n.union([b,n[void 0]]),e=>new n.Type(`DefaultSortOrder${Object(g.capitalize)(e)}`,b.is,((t,a)=>null==t?n.success(e):b.validate(t,a)),n.identity)),y=(h("asc"),h("desc"))},,function(e,t,a){"use strict";a.d(t,"k",(function(){return u})),a.d(t,"l",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"g",(function(){return g})),a.d(t,"h",(function(){return f})),a.d(t,"m",(function(){return b})),a.d(t,"c",(function(){return y})),a.d(t,"j",(function(){return S})),a.d(t,"d",(function(){return T})),a.d(t,"e",(function(){return x})),a.d(t,"f",(function(){return w})),a.d(t,"b",(function(){return O})),a.d(t,"a",(function(){return j})),a.d(t,"n",(function(){return I}));var n=a(62),i=a(14),s=a(108),r=a(317),o=a(209),l=a(428),c=a(318);const u=e=>e.policyItem,d=Object(i.createSelector)(u,(e=>e.license),((e,t)=>{if(e){const a=((e,t)=>Object(s.b)(t,"platinum")?Object(r.d)(e):Object(r.e)(e))(e.inputs[0].config.policy.value,t);return{...e,inputs:[{...e.inputs[0],config:{...e.inputs[0].config,policy:{...e.inputs[0].config.policy,value:a}}}]}}return e})),p=Object(i.createSelector)(d,(e=>{if(e)return Object(l.a)(e)})),m=e=>!e.policyItem&&!e.apiError,g=e=>Object(c.e)(e)||Object(c.f)(e)||Object(c.d)(e)||Object(c.c)(e)||Object(c.b)(e),f=e=>e.license,b=Object(i.createSelector)((e=>e.location),(e=>{var t,a,i,s;return null!==(t=null===(a=Object(n.matchPath)(null!==(s=null==e?void 0:e.pathname)&&void 0!==s?s:"",{path:[o.n,o.q,o.m,o.o,o.l],exact:!0}))||void 0===a||null===(i=a.params)||void 0===i?void 0:i.policyId)&&void 0!==t?t:""})),h=Object(r.c)(),y=Object(i.createSelector)(d,(e=>{var t,a,n,i;return null!==(t=null==e||null===(a=e.inputs[0])||void 0===a||null===(n=a.config)||void 0===n||null===(i=n.policy)||void 0===i?void 0:i.value)&&void 0!==t?t:h})),E=Object(i.createSelector)(y,(e=>null==e?void 0:e.windows)),v=Object(i.createSelector)(y,(e=>null==e?void 0:e.mac)),k=Object(i.createSelector)(y,(e=>null==e?void 0:e.linux)),S=Object(i.createSelector)(E,v,k,((e,t,a)=>({windows:{advanced:e.advanced,events:e.events,malware:e.malware,ransomware:e.ransomware,memory_protection:e.memory_protection,behavior_protection:e.behavior_protection,popup:e.popup,antivirus_registration:e.antivirus_registration,attack_surface_reduction:e.attack_surface_reduction},mac:{advanced:t.advanced,events:t.events,malware:t.malware,behavior_protection:t.behavior_protection,memory_protection:t.memory_protection,popup:t.popup},linux:{advanced:a.advanced,events:a.events,malware:a.malware,behavior_protection:a.behavior_protection,memory_protection:a.memory_protection,popup:a.popup}}))),T=Object(i.createSelector)(S,(e=>e.windows.antivirus_registration.enabled)),x=Object(i.createSelector)(S,(e=>e.windows.attack_surface_reduction.credential_hardening.enabled)),w=e=>e.isLoading,O=e=>e.apiError,j=e=>e.agentStatusSummary,I=e=>e.updateStatus},,function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return r}));var n=a(219),i=a(217);const s=["item_id","name","description","entries.value"],r={name:i.i,namespace_type:"agnostic",description:i.g,list_id:i.h,type:n.a.ENDPOINT_HOST_ISOLATION_EXCEPTIONS}},,function(e,t,a){"use strict";a.d(t,"D",(function(){return i})),a.d(t,"E",(function(){return s})),a.d(t,"H",(function(){return r})),a.d(t,"G",(function(){return o})),a.d(t,"B",(function(){return l})),a.d(t,"I",(function(){return c})),a.d(t,"C",(function(){return u})),a.d(t,"F",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"d",(function(){return f})),a.d(t,"e",(function(){return b})),a.d(t,"M",(function(){return h})),a.d(t,"A",(function(){return y})),a.d(t,"m",(function(){return E})),a.d(t,"J",(function(){return v})),a.d(t,"j",(function(){return k})),a.d(t,"p",(function(){return S})),a.d(t,"q",(function(){return T})),a.d(t,"y",(function(){return x})),a.d(t,"x",(function(){return w})),a.d(t,"w",(function(){return O})),a.d(t,"z",(function(){return j})),a.d(t,"u",(function(){return I})),a.d(t,"s",(function(){return C})),a.d(t,"t",(function(){return M})),a.d(t,"v",(function(){return D})),a.d(t,"r",(function(){return A})),a.d(t,"N",(function(){return F})),a.d(t,"l",(function(){return R})),a.d(t,"K",(function(){return P})),a.d(t,"g",(function(){return _})),a.d(t,"i",(function(){return q})),a.d(t,"f",(function(){return N})),a.d(t,"h",(function(){return L})),a.d(t,"k",(function(){return B})),a.d(t,"n",(function(){return z})),a.d(t,"L",(function(){return H})),a.d(t,"o",(function(){return $}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.criticalLabel",{defaultMessage:"Critical"}),s=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.highLabel",{defaultMessage:"High"}),r=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.mediumLabel",{defaultMessage:"Medium"}),o=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.lowLabel",{defaultMessage:"Low"}),l=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.status.acknowledged",{defaultMessage:"Acknowledged"}),c=n.i18n.translate("xpack.securitySolution.detectionResponse.status.open",{defaultMessage:"Open"}),u=n.i18n.translate("xpack.securitySolution.detectionResponse.status.closed",{defaultMessage:"Closed"}),d=n.i18n.translate("xpack.securitySolution.detectionResponse.status.inProgress",{defaultMessage:"In progress"}),p=e=>n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.totalAlerts",{values:{totalAlerts:e},defaultMessage:"total {totalAlerts, plural, =1 {alert} other {alerts}}"}),m=n.i18n.translate("xpack.securitySolution.detectionResponse.alerts",{defaultMessage:"Alerts"}),g=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsBySeverity",{defaultMessage:"Alerts by Severity"}),f=(n.i18n.translate("xpack.securitySolution.detectionResponse.updating",{defaultMessage:"Updating..."}),n.i18n.translate("xpack.securitySolution.detectionResponse.updated",{defaultMessage:"Updated"}),e=>n.i18n.translate("xpack.securitySolution.detectionResponse.casesByStatus.totalCases",{values:{totalCases:e},defaultMessage:"total {totalCases, plural, =1 {case} other {cases}}"})),b=n.i18n.translate("xpack.securitySolution.detectionResponse.casesByStatusSectionTitle",{defaultMessage:"Cases"}),h=n.i18n.translate("xpack.securitySolution.detectionResponse.viewCases",{defaultMessage:"View cases"}),y=n.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsSectionTitle",{defaultMessage:"Open alerts by rule"}),E=n.i18n.translate("xpack.securitySolution.detectionResponse.hostAlertsSectionTitle",{defaultMessage:"Hosts by alert severity"}),v=n.i18n.translate("xpack.securitySolution.detectionResponse.userAlertsSectionTitle",{defaultMessage:"Users by alert severity"}),k=n.i18n.translate("xpack.securitySolution.detectionResponse.caseSectionTitle",{defaultMessage:"Recently created cases"}),S=n.i18n.translate("xpack.securitySolution.detectionResponse.noRuleAlerts",{defaultMessage:"No alerts to display"}),T=n.i18n.translate("xpack.securitySolution.detectionResponse.noRecentCases",{defaultMessage:"No cases to display"}),x=n.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnRuleName",{defaultMessage:"Rule name"}),w=n.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnLastAlert",{defaultMessage:"Last alert"}),O=n.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnAlertCount",{defaultMessage:"Alert count"}),j=n.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnSeverity",{defaultMessage:"Severity"}),I=n.i18n.translate("xpack.securitySolution.detectionResponse.openRuleDetailTooltip",{defaultMessage:"Open rule detail"}),C=n.i18n.translate("xpack.securitySolution.detectionResponse.openCaseDetailTooltip",{defaultMessage:"Open case detail"}),M=n.i18n.translate("xpack.securitySolution.detectionResponse.openHostDetailTooltip",{defaultMessage:"Open host detail"}),D=n.i18n.translate("xpack.securitySolution.detectionResponse.openUserDetailTooltip",{defaultMessage:"Open user detail"}),A=n.i18n.translate("xpack.securitySolution.detectionResponse.openAllAlertsButton",{defaultMessage:"View all open alerts"}),F=n.i18n.translate("xpack.securitySolution.detectionResponse.viewRecentCases",{defaultMessage:"View recent cases"}),R=n.i18n.translate("xpack.securitySolution.detectionResponse.hostAlertsHostName",{defaultMessage:"Host name"}),P=n.i18n.translate("xpack.securitySolution.detectionResponse.userAlertsUserName",{defaultMessage:"User name"}),_=n.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnName",{defaultMessage:"Name"}),q=n.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnTime",{defaultMessage:"Time"}),N=n.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnCreatedBy",{defaultMessage:"Created by"}),L=n.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnStatus",{defaultMessage:"Status"}),B=n.i18n.translate("xpack.securitySolution.detectionResponse.errorMessage",{defaultMessage:"Error fetching case data"}),z=n.i18n.translate("xpack.securitySolution.detectionResponse.hostSectionTooltip",{defaultMessage:"Maximum of 100 hosts. Please consult Alerts page for further information."}),H=n.i18n.translate("xpack.securitySolution.detectionResponse.userSectionTooltip",{defaultMessage:"Maximum of 100 users. Please consult Alerts page for further information."}),$=n.i18n.translate("xpack.securitySolution.detectionResponse.investigateInTimeline",{defaultMessage:"Investigate in Timeline"})},,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return HostIsolationExceptionsApiClient}));var n=a(217),i=a(314),s=a(334);class HostIsolationExceptionsApiClient extends i.a{constructor(e){super(e,n.h,s.a)}static getInstance(e){return super.getInstance(e,n.h,s.a)}}},,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(26),i=a.n(n);const s=(e,t)=>"second"===t||"minute"===t||"hour"===t?{from:i()(e.time).subtract(1,"hour").toISOString(),to:i()(e.time).add(1,"hour").toISOString()}:{from:i()(e.time).subtract(1,"day").toISOString(),to:i()(e.time).add(1,"day").toISOString()}},,,function(e,t,a){"use strict";function n(e){return`resolver-${e}`}a.d(t,"a",(function(){return n}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(306),i=a(242),s=a(237);function r(e){return"processTerminated"===function(e){if(i.i(e)){const{endgame:{event_type_full:t,event_subtype_full:a}}=e;if("process_event"===t)return"creation_event"===a||"fork_event"===a||"exec_event"===a?"processCreated":"already_running"===a?"processRan":"termination_event"===a?"processTerminated":"unknownProcessEvent";if("alert_event"===t)return"processCausedAlert"}else{const t=new Set(i.h(e)),a=new Set(i.d(e)),n=new Set(i.f(e));if(a.has("process"))return t.has("start")||t.has("change")||t.has("creation")?"processCreated":t.has("info")?"processRan":t.has("end")?"processTerminated":"unknownProcessEvent";if(n.has("alert"))return"processCausedAlert"}return"unknownEvent"}(e)}function o(e){const t=s.a(e),a=void 0===t?0:new Date(t).getTime();return isNaN(a)?null:a}function l(e){var t;return Object(n.a)(i.i(e)?e.endgame.pid:null===(t=e.process)||void 0===t?void 0:t.pid)}function c(e){var t;return Object(n.a)(i.i(e)?e.endgame.process_path:null===(t=e.process)||void 0===t?void 0:t.executable)}function u(e,t){const a=o(e),n=o(t);return a===n?String(s.b(e)).localeCompare(String(s.b(t))):null===a||null===n?(null===a?1:0)-(null===n?1:0):a-n}},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return r}));var n=a(6);const i=[{id:"TA0009",name:"Collection",reference:"https://attack.mitre.org/tactics/TA0009",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.collectionDescription",{defaultMessage:"Collection (TA0009)"}),value:"collection"},{id:"TA0011",name:"Command and Control",reference:"https://attack.mitre.org/tactics/TA0011",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.commandAndControlDescription",{defaultMessage:"Command and Control (TA0011)"}),value:"commandAndControl"},{id:"TA0006",name:"Credential Access",reference:"https://attack.mitre.org/tactics/TA0006",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.credentialAccessDescription",{defaultMessage:"Credential Access (TA0006)"}),value:"credentialAccess"},{id:"TA0005",name:"Defense Evasion",reference:"https://attack.mitre.org/tactics/TA0005",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.defenseEvasionDescription",{defaultMessage:"Defense Evasion (TA0005)"}),value:"defenseEvasion"},{id:"TA0007",name:"Discovery",reference:"https://attack.mitre.org/tactics/TA0007",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.discoveryDescription",{defaultMessage:"Discovery (TA0007)"}),value:"discovery"},{id:"TA0002",name:"Execution",reference:"https://attack.mitre.org/tactics/TA0002",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.executionDescription",{defaultMessage:"Execution (TA0002)"}),value:"execution"},{id:"TA0010",name:"Exfiltration",reference:"https://attack.mitre.org/tactics/TA0010",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.exfiltrationDescription",{defaultMessage:"Exfiltration (TA0010)"}),value:"exfiltration"},{id:"TA0040",name:"Impact",reference:"https://attack.mitre.org/tactics/TA0040",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.impactDescription",{defaultMessage:"Impact (TA0040)"}),value:"impact"},{id:"TA0001",name:"Initial Access",reference:"https://attack.mitre.org/tactics/TA0001",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.initialAccessDescription",{defaultMessage:"Initial Access (TA0001)"}),value:"initialAccess"},{id:"TA0008",name:"Lateral Movement",reference:"https://attack.mitre.org/tactics/TA0008",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.lateralMovementDescription",{defaultMessage:"Lateral Movement (TA0008)"}),value:"lateralMovement"},{id:"TA0003",name:"Persistence",reference:"https://attack.mitre.org/tactics/TA0003",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.persistenceDescription",{defaultMessage:"Persistence (TA0003)"}),value:"persistence"},{id:"TA0004",name:"Privilege Escalation",reference:"https://attack.mitre.org/tactics/TA0004",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.privilegeEscalationDescription",{defaultMessage:"Privilege Escalation (TA0004)"}),value:"privilegeEscalation"},{id:"TA0043",name:"Reconnaissance",reference:"https://attack.mitre.org/tactics/TA0043",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.reconnaissanceDescription",{defaultMessage:"Reconnaissance (TA0043)"}),value:"reconnaissance"},{id:"TA0042",name:"Resource Development",reference:"https://attack.mitre.org/tactics/TA0042",text:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.resourceDevelopmentDescription",{defaultMessage:"Resource Development (TA0042)"}),value:"resourceDevelopment"}],s=[{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.abuseElevationControlMechanismDescription",{defaultMessage:"Abuse Elevation Control Mechanism (T1548)"}),id:"T1548",name:"Abuse Elevation Control Mechanism",reference:"https://attack.mitre.org/techniques/T1548",tactics:"privilege-escalation,defense-evasion",value:"abuseElevationControlMechanism"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accessTokenManipulationDescription",{defaultMessage:"Access Token Manipulation (T1134)"}),id:"T1134",name:"Access Token Manipulation",reference:"https://attack.mitre.org/techniques/T1134",tactics:"defense-evasion,privilege-escalation",value:"accessTokenManipulation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accessibilityFeaturesDescription",{defaultMessage:"Accessibility Features (T1015)"}),id:"T1015",name:"Accessibility Features",reference:"https://attack.mitre.org/techniques/T1015",tactics:"persistence,privilege-escalation",value:"accessibilityFeatures"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountAccessRemovalDescription",{defaultMessage:"Account Access Removal (T1531)"}),id:"T1531",name:"Account Access Removal",reference:"https://attack.mitre.org/techniques/T1531",tactics:"impact",value:"accountAccessRemoval"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountDiscoveryDescription",{defaultMessage:"Account Discovery (T1087)"}),id:"T1087",name:"Account Discovery",reference:"https://attack.mitre.org/techniques/T1087",tactics:"discovery",value:"accountDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountManipulationDescription",{defaultMessage:"Account Manipulation (T1098)"}),id:"T1098",name:"Account Manipulation",reference:"https://attack.mitre.org/techniques/T1098",tactics:"persistence",value:"accountManipulation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.acquireInfrastructureDescription",{defaultMessage:"Acquire Infrastructure (T1583)"}),id:"T1583",name:"Acquire Infrastructure",reference:"https://attack.mitre.org/techniques/T1583",tactics:"resource-development",value:"acquireInfrastructure"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.activeScanningDescription",{defaultMessage:"Active Scanning (T1595)"}),id:"T1595",name:"Active Scanning",reference:"https://attack.mitre.org/techniques/T1595",tactics:"reconnaissance",value:"activeScanning"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.adversaryInTheMiddleDescription",{defaultMessage:"Adversary-in-the-Middle (T1557)"}),id:"T1557",name:"Adversary-in-the-Middle",reference:"https://attack.mitre.org/techniques/T1557",tactics:"credential-access,collection",value:"adversaryInTheMiddle"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.appCertDlLsDescription",{defaultMessage:"AppCert DLLs (T1182)"}),id:"T1182",name:"AppCert DLLs",reference:"https://attack.mitre.org/techniques/T1182",tactics:"persistence,privilege-escalation",value:"appCertDlLs"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.appInitDlLsDescription",{defaultMessage:"AppInit DLLs (T1103)"}),id:"T1103",name:"AppInit DLLs",reference:"https://attack.mitre.org/techniques/T1103",tactics:"persistence,privilege-escalation",value:"appInitDlLs"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.appleScriptDescription",{defaultMessage:"AppleScript (T1155)"}),id:"T1155",name:"AppleScript",reference:"https://attack.mitre.org/techniques/T1155",tactics:"execution",value:"appleScript"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationAccessTokenDescription",{defaultMessage:"Application Access Token (T1527)"}),id:"T1527",name:"Application Access Token",reference:"https://attack.mitre.org/techniques/T1527",tactics:"defense-evasion,lateral-movement",value:"applicationAccessToken"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationDeploymentSoftwareDescription",{defaultMessage:"Application Deployment Software (T1017)"}),id:"T1017",name:"Application Deployment Software",reference:"https://attack.mitre.org/techniques/T1017",tactics:"lateral-movement",value:"applicationDeploymentSoftware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationLayerProtocolDescription",{defaultMessage:"Application Layer Protocol (T1071)"}),id:"T1071",name:"Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1071",tactics:"command-and-control",value:"applicationLayerProtocol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationShimmingDescription",{defaultMessage:"Application Shimming (T1138)"}),id:"T1138",name:"Application Shimming",reference:"https://attack.mitre.org/techniques/T1138",tactics:"persistence,privilege-escalation",value:"applicationShimming"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationWindowDiscoveryDescription",{defaultMessage:"Application Window Discovery (T1010)"}),id:"T1010",name:"Application Window Discovery",reference:"https://attack.mitre.org/techniques/T1010",tactics:"discovery",value:"applicationWindowDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.archiveCollectedDataDescription",{defaultMessage:"Archive Collected Data (T1560)"}),id:"T1560",name:"Archive Collected Data",reference:"https://attack.mitre.org/techniques/T1560",tactics:"collection",value:"archiveCollectedData"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.audioCaptureDescription",{defaultMessage:"Audio Capture (T1123)"}),id:"T1123",name:"Audio Capture",reference:"https://attack.mitre.org/techniques/T1123",tactics:"collection",value:"audioCapture"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.authenticationPackageDescription",{defaultMessage:"Authentication Package (T1131)"}),id:"T1131",name:"Authentication Package",reference:"https://attack.mitre.org/techniques/T1131",tactics:"persistence",value:"authenticationPackage"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedCollectionDescription",{defaultMessage:"Automated Collection (T1119)"}),id:"T1119",name:"Automated Collection",reference:"https://attack.mitre.org/techniques/T1119",tactics:"collection",value:"automatedCollection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedExfiltrationDescription",{defaultMessage:"Automated Exfiltration (T1020)"}),id:"T1020",name:"Automated Exfiltration",reference:"https://attack.mitre.org/techniques/T1020",tactics:"exfiltration",value:"automatedExfiltration"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bitsJobsDescription",{defaultMessage:"BITS Jobs (T1197)"}),id:"T1197",name:"BITS Jobs",reference:"https://attack.mitre.org/techniques/T1197",tactics:"defense-evasion,persistence",value:"bitsJobs"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bashHistoryDescription",{defaultMessage:"Bash History (T1139)"}),id:"T1139",name:"Bash History",reference:"https://attack.mitre.org/techniques/T1139",tactics:"credential-access",value:"bashHistory"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.binaryPaddingDescription",{defaultMessage:"Binary Padding (T1009)"}),id:"T1009",name:"Binary Padding",reference:"https://attack.mitre.org/techniques/T1009",tactics:"defense-evasion",value:"binaryPadding"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootOrLogonAutostartExecutionDescription",{defaultMessage:"Boot or Logon Autostart Execution (T1547)"}),id:"T1547",name:"Boot or Logon Autostart Execution",reference:"https://attack.mitre.org/techniques/T1547",tactics:"persistence,privilege-escalation",value:"bootOrLogonAutostartExecution"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootOrLogonInitializationScriptsDescription",{defaultMessage:"Boot or Logon Initialization Scripts (T1037)"}),id:"T1037",name:"Boot or Logon Initialization Scripts",reference:"https://attack.mitre.org/techniques/T1037",tactics:"persistence,privilege-escalation",value:"bootOrLogonInitializationScripts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootkitDescription",{defaultMessage:"Bootkit (T1067)"}),id:"T1067",name:"Bootkit",reference:"https://attack.mitre.org/techniques/T1067",tactics:"persistence",value:"bootkit"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserBookmarkDiscoveryDescription",{defaultMessage:"Browser Bookmark Discovery (T1217)"}),id:"T1217",name:"Browser Bookmark Discovery",reference:"https://attack.mitre.org/techniques/T1217",tactics:"discovery",value:"browserBookmarkDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserExtensionsDescription",{defaultMessage:"Browser Extensions (T1176)"}),id:"T1176",name:"Browser Extensions",reference:"https://attack.mitre.org/techniques/T1176",tactics:"persistence",value:"browserExtensions"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserSessionHijackingDescription",{defaultMessage:"Browser Session Hijacking (T1185)"}),id:"T1185",name:"Browser Session Hijacking",reference:"https://attack.mitre.org/techniques/T1185",tactics:"collection",value:"browserSessionHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bruteForceDescription",{defaultMessage:"Brute Force (T1110)"}),id:"T1110",name:"Brute Force",reference:"https://attack.mitre.org/techniques/T1110",tactics:"credential-access",value:"bruteForce"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.buildImageOnHostDescription",{defaultMessage:"Build Image on Host (T1612)"}),id:"T1612",name:"Build Image on Host",reference:"https://attack.mitre.org/techniques/T1612",tactics:"defense-evasion",value:"buildImageOnHost"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bypassUserAccountControlDescription",{defaultMessage:"Bypass User Account Control (T1088)"}),id:"T1088",name:"Bypass User Account Control",reference:"https://attack.mitre.org/techniques/T1088",tactics:"defense-evasion,privilege-escalation",value:"bypassUserAccountControl"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cmstpDescription",{defaultMessage:"CMSTP (T1191)"}),id:"T1191",name:"CMSTP",reference:"https://attack.mitre.org/techniques/T1191",tactics:"defense-evasion,execution",value:"cmstp"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.changeDefaultFileAssociationDescription",{defaultMessage:"Change Default File Association (T1042)"}),id:"T1042",name:"Change Default File Association",reference:"https://attack.mitre.org/techniques/T1042",tactics:"persistence",value:"changeDefaultFileAssociation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.clearCommandHistoryDescription",{defaultMessage:"Clear Command History (T1146)"}),id:"T1146",name:"Clear Command History",reference:"https://attack.mitre.org/techniques/T1146",tactics:"defense-evasion",value:"clearCommandHistory"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.clipboardDataDescription",{defaultMessage:"Clipboard Data (T1115)"}),id:"T1115",name:"Clipboard Data",reference:"https://attack.mitre.org/techniques/T1115",tactics:"collection",value:"clipboardData"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudInfrastructureDiscoveryDescription",{defaultMessage:"Cloud Infrastructure Discovery (T1580)"}),id:"T1580",name:"Cloud Infrastructure Discovery",reference:"https://attack.mitre.org/techniques/T1580",tactics:"discovery",value:"cloudInfrastructureDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudInstanceMetadataApiDescription",{defaultMessage:"Cloud Instance Metadata API (T1522)"}),id:"T1522",name:"Cloud Instance Metadata API",reference:"https://attack.mitre.org/techniques/T1522",tactics:"credential-access",value:"cloudInstanceMetadataApi"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDashboardDescription",{defaultMessage:"Cloud Service Dashboard (T1538)"}),id:"T1538",name:"Cloud Service Dashboard",reference:"https://attack.mitre.org/techniques/T1538",tactics:"discovery",value:"cloudServiceDashboard"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDiscoveryDescription",{defaultMessage:"Cloud Service Discovery (T1526)"}),id:"T1526",name:"Cloud Service Discovery",reference:"https://attack.mitre.org/techniques/T1526",tactics:"discovery",value:"cloudServiceDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudStorageObjectDiscoveryDescription",{defaultMessage:"Cloud Storage Object Discovery (T1619)"}),id:"T1619",name:"Cloud Storage Object Discovery",reference:"https://attack.mitre.org/techniques/T1619",tactics:"discovery",value:"cloudStorageObjectDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.codeSigningDescription",{defaultMessage:"Code Signing (T1116)"}),id:"T1116",name:"Code Signing",reference:"https://attack.mitre.org/techniques/T1116",tactics:"defense-evasion",value:"codeSigning"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commandAndScriptingInterpreterDescription",{defaultMessage:"Command and Scripting Interpreter (T1059)"}),id:"T1059",name:"Command and Scripting Interpreter",reference:"https://attack.mitre.org/techniques/T1059",tactics:"execution",value:"commandAndScriptingInterpreter"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commonlyUsedPortDescription",{defaultMessage:"Commonly Used Port (T1043)"}),id:"T1043",name:"Commonly Used Port",reference:"https://attack.mitre.org/techniques/T1043",tactics:"command-and-control",value:"commonlyUsedPort"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.communicationThroughRemovableMediaDescription",{defaultMessage:"Communication Through Removable Media (T1092)"}),id:"T1092",name:"Communication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1092",tactics:"command-and-control",value:"communicationThroughRemovableMedia"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compileAfterDeliveryDescription",{defaultMessage:"Compile After Delivery (T1500)"}),id:"T1500",name:"Compile After Delivery",reference:"https://attack.mitre.org/techniques/T1500",tactics:"defense-evasion",value:"compileAfterDelivery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compiledHtmlFileDescription",{defaultMessage:"Compiled HTML File (T1223)"}),id:"T1223",name:"Compiled HTML File",reference:"https://attack.mitre.org/techniques/T1223",tactics:"defense-evasion,execution",value:"compiledHtmlFile"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.componentFirmwareDescription",{defaultMessage:"Component Firmware (T1109)"}),id:"T1109",name:"Component Firmware",reference:"https://attack.mitre.org/techniques/T1109",tactics:"defense-evasion,persistence",value:"componentFirmware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.componentObjectModelHijackingDescription",{defaultMessage:"Component Object Model Hijacking (T1122)"}),id:"T1122",name:"Component Object Model Hijacking",reference:"https://attack.mitre.org/techniques/T1122",tactics:"defense-evasion,persistence",value:"componentObjectModelHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.componentObjectModelAndDistributedComDescription",{defaultMessage:"Component Object Model and Distributed COM (T1175)"}),id:"T1175",name:"Component Object Model and Distributed COM",reference:"https://attack.mitre.org/techniques/T1175",tactics:"lateral-movement,execution",value:"componentObjectModelAndDistributedCom"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseAccountsDescription",{defaultMessage:"Compromise Accounts (T1586)"}),id:"T1586",name:"Compromise Accounts",reference:"https://attack.mitre.org/techniques/T1586",tactics:"resource-development",value:"compromiseAccounts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseClientSoftwareBinaryDescription",{defaultMessage:"Compromise Client Software Binary (T1554)"}),id:"T1554",name:"Compromise Client Software Binary",reference:"https://attack.mitre.org/techniques/T1554",tactics:"persistence",value:"compromiseClientSoftwareBinary"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseInfrastructureDescription",{defaultMessage:"Compromise Infrastructure (T1584)"}),id:"T1584",name:"Compromise Infrastructure",reference:"https://attack.mitre.org/techniques/T1584",tactics:"resource-development",value:"compromiseInfrastructure"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.containerAdministrationCommandDescription",{defaultMessage:"Container Administration Command (T1609)"}),id:"T1609",name:"Container Administration Command",reference:"https://attack.mitre.org/techniques/T1609",tactics:"execution",value:"containerAdministrationCommand"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.containerAndResourceDiscoveryDescription",{defaultMessage:"Container and Resource Discovery (T1613)"}),id:"T1613",name:"Container and Resource Discovery",reference:"https://attack.mitre.org/techniques/T1613",tactics:"discovery",value:"containerAndResourceDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.controlPanelItemsDescription",{defaultMessage:"Control Panel Items (T1196)"}),id:"T1196",name:"Control Panel Items",reference:"https://attack.mitre.org/techniques/T1196",tactics:"defense-evasion,execution",value:"controlPanelItems"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.createAccountDescription",{defaultMessage:"Create Account (T1136)"}),id:"T1136",name:"Create Account",reference:"https://attack.mitre.org/techniques/T1136",tactics:"persistence",value:"createAccount"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.createOrModifySystemProcessDescription",{defaultMessage:"Create or Modify System Process (T1543)"}),id:"T1543",name:"Create or Modify System Process",reference:"https://attack.mitre.org/techniques/T1543",tactics:"persistence,privilege-escalation",value:"createOrModifySystemProcess"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialsFromPasswordStoresDescription",{defaultMessage:"Credentials from Password Stores (T1555)"}),id:"T1555",name:"Credentials from Password Stores",reference:"https://attack.mitre.org/techniques/T1555",tactics:"credential-access",value:"credentialsFromPasswordStores"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialsFromWebBrowsersDescription",{defaultMessage:"Credentials from Web Browsers (T1503)"}),id:"T1503",name:"Credentials from Web Browsers",reference:"https://attack.mitre.org/techniques/T1503",tactics:"credential-access",value:"credentialsFromWebBrowsers"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialsInFilesDescription",{defaultMessage:"Credentials in Files (T1081)"}),id:"T1081",name:"Credentials in Files",reference:"https://attack.mitre.org/techniques/T1081",tactics:"credential-access",value:"credentialsInFiles"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialsInRegistryDescription",{defaultMessage:"Credentials in Registry (T1214)"}),id:"T1214",name:"Credentials in Registry",reference:"https://attack.mitre.org/techniques/T1214",tactics:"credential-access",value:"credentialsInRegistry"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.customCommandAndControlProtocolDescription",{defaultMessage:"Custom Command and Control Protocol (T1094)"}),id:"T1094",name:"Custom Command and Control Protocol",reference:"https://attack.mitre.org/techniques/T1094",tactics:"command-and-control",value:"customCommandAndControlProtocol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.customCryptographicProtocolDescription",{defaultMessage:"Custom Cryptographic Protocol (T1024)"}),id:"T1024",name:"Custom Cryptographic Protocol",reference:"https://attack.mitre.org/techniques/T1024",tactics:"command-and-control",value:"customCryptographicProtocol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dllSearchOrderHijackingDescription",{defaultMessage:"DLL Search Order Hijacking (T1038)"}),id:"T1038",name:"DLL Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1038",tactics:"persistence,privilege-escalation,defense-evasion",value:"dllSearchOrderHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dllSideLoadingDescription",{defaultMessage:"DLL Side-Loading (T1073)"}),id:"T1073",name:"DLL Side-Loading",reference:"https://attack.mitre.org/techniques/T1073",tactics:"defense-evasion",value:"dllSideLoading"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataCompressedDescription",{defaultMessage:"Data Compressed (T1002)"}),id:"T1002",name:"Data Compressed",reference:"https://attack.mitre.org/techniques/T1002",tactics:"exfiltration",value:"dataCompressed"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataDestructionDescription",{defaultMessage:"Data Destruction (T1485)"}),id:"T1485",name:"Data Destruction",reference:"https://attack.mitre.org/techniques/T1485",tactics:"impact",value:"dataDestruction"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncodingDescription",{defaultMessage:"Data Encoding (T1132)"}),id:"T1132",name:"Data Encoding",reference:"https://attack.mitre.org/techniques/T1132",tactics:"command-and-control",value:"dataEncoding"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncryptedDescription",{defaultMessage:"Data Encrypted (T1022)"}),id:"T1022",name:"Data Encrypted",reference:"https://attack.mitre.org/techniques/T1022",tactics:"exfiltration",value:"dataEncrypted"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncryptedForImpactDescription",{defaultMessage:"Data Encrypted for Impact (T1486)"}),id:"T1486",name:"Data Encrypted for Impact",reference:"https://attack.mitre.org/techniques/T1486",tactics:"impact",value:"dataEncryptedForImpact"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataManipulationDescription",{defaultMessage:"Data Manipulation (T1565)"}),id:"T1565",name:"Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565",tactics:"impact",value:"dataManipulation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataObfuscationDescription",{defaultMessage:"Data Obfuscation (T1001)"}),id:"T1001",name:"Data Obfuscation",reference:"https://attack.mitre.org/techniques/T1001",tactics:"command-and-control",value:"dataObfuscation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataStagedDescription",{defaultMessage:"Data Staged (T1074)"}),id:"T1074",name:"Data Staged",reference:"https://attack.mitre.org/techniques/T1074",tactics:"collection",value:"dataStaged"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataTransferSizeLimitsDescription",{defaultMessage:"Data Transfer Size Limits (T1030)"}),id:"T1030",name:"Data Transfer Size Limits",reference:"https://attack.mitre.org/techniques/T1030",tactics:"exfiltration",value:"dataTransferSizeLimits"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromCloudStorageObjectDescription",{defaultMessage:"Data from Cloud Storage Object (T1530)"}),id:"T1530",name:"Data from Cloud Storage Object",reference:"https://attack.mitre.org/techniques/T1530",tactics:"collection",value:"dataFromCloudStorageObject"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromConfigurationRepositoryDescription",{defaultMessage:"Data from Configuration Repository (T1602)"}),id:"T1602",name:"Data from Configuration Repository",reference:"https://attack.mitre.org/techniques/T1602",tactics:"collection",value:"dataFromConfigurationRepository"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromInformationRepositoriesDescription",{defaultMessage:"Data from Information Repositories (T1213)"}),id:"T1213",name:"Data from Information Repositories",reference:"https://attack.mitre.org/techniques/T1213",tactics:"collection",value:"dataFromInformationRepositories"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromLocalSystemDescription",{defaultMessage:"Data from Local System (T1005)"}),id:"T1005",name:"Data from Local System",reference:"https://attack.mitre.org/techniques/T1005",tactics:"collection",value:"dataFromLocalSystem"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromNetworkSharedDriveDescription",{defaultMessage:"Data from Network Shared Drive (T1039)"}),id:"T1039",name:"Data from Network Shared Drive",reference:"https://attack.mitre.org/techniques/T1039",tactics:"collection",value:"dataFromNetworkSharedDrive"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromRemovableMediaDescription",{defaultMessage:"Data from Removable Media (T1025)"}),id:"T1025",name:"Data from Removable Media",reference:"https://attack.mitre.org/techniques/T1025",tactics:"collection",value:"dataFromRemovableMedia"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.debuggerEvasionDescription",{defaultMessage:"Debugger Evasion (T1622)"}),id:"T1622",name:"Debugger Evasion",reference:"https://attack.mitre.org/techniques/T1622",tactics:"defense-evasion,discovery",value:"debuggerEvasion"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.defacementDescription",{defaultMessage:"Defacement (T1491)"}),id:"T1491",name:"Defacement",reference:"https://attack.mitre.org/techniques/T1491",tactics:"impact",value:"defacement"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.deobfuscateDecodeFilesOrInformationDescription",{defaultMessage:"Deobfuscate/Decode Files or Information (T1140)"}),id:"T1140",name:"Deobfuscate/Decode Files or Information",reference:"https://attack.mitre.org/techniques/T1140",tactics:"defense-evasion",value:"deobfuscateDecodeFilesOrInformation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.deployContainerDescription",{defaultMessage:"Deploy Container (T1610)"}),id:"T1610",name:"Deploy Container",reference:"https://attack.mitre.org/techniques/T1610",tactics:"defense-evasion,execution",value:"deployContainer"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.developCapabilitiesDescription",{defaultMessage:"Develop Capabilities (T1587)"}),id:"T1587",name:"Develop Capabilities",reference:"https://attack.mitre.org/techniques/T1587",tactics:"resource-development",value:"developCapabilities"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.directVolumeAccessDescription",{defaultMessage:"Direct Volume Access (T1006)"}),id:"T1006",name:"Direct Volume Access",reference:"https://attack.mitre.org/techniques/T1006",tactics:"defense-evasion",value:"directVolumeAccess"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.disablingSecurityToolsDescription",{defaultMessage:"Disabling Security Tools (T1089)"}),id:"T1089",name:"Disabling Security Tools",reference:"https://attack.mitre.org/techniques/T1089",tactics:"defense-evasion",value:"disablingSecurityTools"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.diskContentWipeDescription",{defaultMessage:"Disk Content Wipe (T1488)"}),id:"T1488",name:"Disk Content Wipe",reference:"https://attack.mitre.org/techniques/T1488",tactics:"impact",value:"diskContentWipe"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.diskStructureWipeDescription",{defaultMessage:"Disk Structure Wipe (T1487)"}),id:"T1487",name:"Disk Structure Wipe",reference:"https://attack.mitre.org/techniques/T1487",tactics:"impact",value:"diskStructureWipe"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.diskWipeDescription",{defaultMessage:"Disk Wipe (T1561)"}),id:"T1561",name:"Disk Wipe",reference:"https://attack.mitre.org/techniques/T1561",tactics:"impact",value:"diskWipe"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainFrontingDescription",{defaultMessage:"Domain Fronting (T1172)"}),id:"T1172",name:"Domain Fronting",reference:"https://attack.mitre.org/techniques/T1172",tactics:"command-and-control",value:"domainFronting"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainGenerationAlgorithmsDescription",{defaultMessage:"Domain Generation Algorithms (T1483)"}),id:"T1483",name:"Domain Generation Algorithms",reference:"https://attack.mitre.org/techniques/T1483",tactics:"command-and-control",value:"domainGenerationAlgorithms"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainPolicyModificationDescription",{defaultMessage:"Domain Policy Modification (T1484)"}),id:"T1484",name:"Domain Policy Modification",reference:"https://attack.mitre.org/techniques/T1484",tactics:"defense-evasion,privilege-escalation",value:"domainPolicyModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainTrustDiscoveryDescription",{defaultMessage:"Domain Trust Discovery (T1482)"}),id:"T1482",name:"Domain Trust Discovery",reference:"https://attack.mitre.org/techniques/T1482",tactics:"discovery",value:"domainTrustDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.driveByCompromiseDescription",{defaultMessage:"Drive-by Compromise (T1189)"}),id:"T1189",name:"Drive-by Compromise",reference:"https://attack.mitre.org/techniques/T1189",tactics:"initial-access",value:"driveByCompromise"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dylibHijackingDescription",{defaultMessage:"Dylib Hijacking (T1157)"}),id:"T1157",name:"Dylib Hijacking",reference:"https://attack.mitre.org/techniques/T1157",tactics:"persistence,privilege-escalation",value:"dylibHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dynamicDataExchangeDescription",{defaultMessage:"Dynamic Data Exchange (T1173)"}),id:"T1173",name:"Dynamic Data Exchange",reference:"https://attack.mitre.org/techniques/T1173",tactics:"execution",value:"dynamicDataExchange"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dynamicResolutionDescription",{defaultMessage:"Dynamic Resolution (T1568)"}),id:"T1568",name:"Dynamic Resolution",reference:"https://attack.mitre.org/techniques/T1568",tactics:"command-and-control",value:"dynamicResolution"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.elevatedExecutionWithPromptDescription",{defaultMessage:"Elevated Execution with Prompt (T1514)"}),id:"T1514",name:"Elevated Execution with Prompt",reference:"https://attack.mitre.org/techniques/T1514",tactics:"privilege-escalation",value:"elevatedExecutionWithPrompt"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.emailCollectionDescription",{defaultMessage:"Email Collection (T1114)"}),id:"T1114",name:"Email Collection",reference:"https://attack.mitre.org/techniques/T1114",tactics:"collection",value:"emailCollection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.emondDescription",{defaultMessage:"Emond (T1519)"}),id:"T1519",name:"Emond",reference:"https://attack.mitre.org/techniques/T1519",tactics:"persistence,privilege-escalation",value:"emond"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.encryptedChannelDescription",{defaultMessage:"Encrypted Channel (T1573)"}),id:"T1573",name:"Encrypted Channel",reference:"https://attack.mitre.org/techniques/T1573",tactics:"command-and-control",value:"encryptedChannel"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.endpointDenialOfServiceDescription",{defaultMessage:"Endpoint Denial of Service (T1499)"}),id:"T1499",name:"Endpoint Denial of Service",reference:"https://attack.mitre.org/techniques/T1499",tactics:"impact",value:"endpointDenialOfService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.escapeToHostDescription",{defaultMessage:"Escape to Host (T1611)"}),id:"T1611",name:"Escape to Host",reference:"https://attack.mitre.org/techniques/T1611",tactics:"privilege-escalation",value:"escapeToHost"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.establishAccountsDescription",{defaultMessage:"Establish Accounts (T1585)"}),id:"T1585",name:"Establish Accounts",reference:"https://attack.mitre.org/techniques/T1585",tactics:"resource-development",value:"establishAccounts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.eventTriggeredExecutionDescription",{defaultMessage:"Event Triggered Execution (T1546)"}),id:"T1546",name:"Event Triggered Execution",reference:"https://attack.mitre.org/techniques/T1546",tactics:"privilege-escalation,persistence",value:"eventTriggeredExecution"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.executionGuardrailsDescription",{defaultMessage:"Execution Guardrails (T1480)"}),id:"T1480",name:"Execution Guardrails",reference:"https://attack.mitre.org/techniques/T1480",tactics:"defense-evasion",value:"executionGuardrails"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverAlternativeProtocolDescription",{defaultMessage:"Exfiltration Over Alternative Protocol (T1048)"}),id:"T1048",name:"Exfiltration Over Alternative Protocol",reference:"https://attack.mitre.org/techniques/T1048",tactics:"exfiltration",value:"exfiltrationOverAlternativeProtocol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverC2ChannelDescription",{defaultMessage:"Exfiltration Over C2 Channel (T1041)"}),id:"T1041",name:"Exfiltration Over C2 Channel",reference:"https://attack.mitre.org/techniques/T1041",tactics:"exfiltration",value:"exfiltrationOverC2Channel"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverOtherNetworkMediumDescription",{defaultMessage:"Exfiltration Over Other Network Medium (T1011)"}),id:"T1011",name:"Exfiltration Over Other Network Medium",reference:"https://attack.mitre.org/techniques/T1011",tactics:"exfiltration",value:"exfiltrationOverOtherNetworkMedium"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverPhysicalMediumDescription",{defaultMessage:"Exfiltration Over Physical Medium (T1052)"}),id:"T1052",name:"Exfiltration Over Physical Medium",reference:"https://attack.mitre.org/techniques/T1052",tactics:"exfiltration",value:"exfiltrationOverPhysicalMedium"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverWebServiceDescription",{defaultMessage:"Exfiltration Over Web Service (T1567)"}),id:"T1567",name:"Exfiltration Over Web Service",reference:"https://attack.mitre.org/techniques/T1567",tactics:"exfiltration",value:"exfiltrationOverWebService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitPublicFacingApplicationDescription",{defaultMessage:"Exploit Public-Facing Application (T1190)"}),id:"T1190",name:"Exploit Public-Facing Application",reference:"https://attack.mitre.org/techniques/T1190",tactics:"initial-access",value:"exploitPublicFacingApplication"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForClientExecutionDescription",{defaultMessage:"Exploitation for Client Execution (T1203)"}),id:"T1203",name:"Exploitation for Client Execution",reference:"https://attack.mitre.org/techniques/T1203",tactics:"execution",value:"exploitationForClientExecution"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForCredentialAccessDescription",{defaultMessage:"Exploitation for Credential Access (T1212)"}),id:"T1212",name:"Exploitation for Credential Access",reference:"https://attack.mitre.org/techniques/T1212",tactics:"credential-access",value:"exploitationForCredentialAccess"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForDefenseEvasionDescription",{defaultMessage:"Exploitation for Defense Evasion (T1211)"}),id:"T1211",name:"Exploitation for Defense Evasion",reference:"https://attack.mitre.org/techniques/T1211",tactics:"defense-evasion",value:"exploitationForDefenseEvasion"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForPrivilegeEscalationDescription",{defaultMessage:"Exploitation for Privilege Escalation (T1068)"}),id:"T1068",name:"Exploitation for Privilege Escalation",reference:"https://attack.mitre.org/techniques/T1068",tactics:"privilege-escalation",value:"exploitationForPrivilegeEscalation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationOfRemoteServicesDescription",{defaultMessage:"Exploitation of Remote Services (T1210)"}),id:"T1210",name:"Exploitation of Remote Services",reference:"https://attack.mitre.org/techniques/T1210",tactics:"lateral-movement",value:"exploitationOfRemoteServices"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.externalRemoteServicesDescription",{defaultMessage:"External Remote Services (T1133)"}),id:"T1133",name:"External Remote Services",reference:"https://attack.mitre.org/techniques/T1133",tactics:"persistence,initial-access",value:"externalRemoteServices"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.extraWindowMemoryInjectionDescription",{defaultMessage:"Extra Window Memory Injection (T1181)"}),id:"T1181",name:"Extra Window Memory Injection",reference:"https://attack.mitre.org/techniques/T1181",tactics:"defense-evasion,privilege-escalation",value:"extraWindowMemoryInjection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fallbackChannelsDescription",{defaultMessage:"Fallback Channels (T1008)"}),id:"T1008",name:"Fallback Channels",reference:"https://attack.mitre.org/techniques/T1008",tactics:"command-and-control",value:"fallbackChannels"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileDeletionDescription",{defaultMessage:"File Deletion (T1107)"}),id:"T1107",name:"File Deletion",reference:"https://attack.mitre.org/techniques/T1107",tactics:"defense-evasion",value:"fileDeletion"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileSystemPermissionsWeaknessDescription",{defaultMessage:"File System Permissions Weakness (T1044)"}),id:"T1044",name:"File System Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1044",tactics:"persistence,privilege-escalation",value:"fileSystemPermissionsWeakness"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryDiscoveryDescription",{defaultMessage:"File and Directory Discovery (T1083)"}),id:"T1083",name:"File and Directory Discovery",reference:"https://attack.mitre.org/techniques/T1083",tactics:"discovery",value:"fileAndDirectoryDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryPermissionsModificationDescription",{defaultMessage:"File and Directory Permissions Modification (T1222)"}),id:"T1222",name:"File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222",tactics:"defense-evasion",value:"fileAndDirectoryPermissionsModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.firmwareCorruptionDescription",{defaultMessage:"Firmware Corruption (T1495)"}),id:"T1495",name:"Firmware Corruption",reference:"https://attack.mitre.org/techniques/T1495",tactics:"impact",value:"firmwareCorruption"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.forcedAuthenticationDescription",{defaultMessage:"Forced Authentication (T1187)"}),id:"T1187",name:"Forced Authentication",reference:"https://attack.mitre.org/techniques/T1187",tactics:"credential-access",value:"forcedAuthentication"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.forgeWebCredentialsDescription",{defaultMessage:"Forge Web Credentials (T1606)"}),id:"T1606",name:"Forge Web Credentials",reference:"https://attack.mitre.org/techniques/T1606",tactics:"credential-access",value:"forgeWebCredentials"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatekeeperBypassDescription",{defaultMessage:"Gatekeeper Bypass (T1144)"}),id:"T1144",name:"Gatekeeper Bypass",reference:"https://attack.mitre.org/techniques/T1144",tactics:"defense-evasion",value:"gatekeeperBypass"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimHostInformationDescription",{defaultMessage:"Gather Victim Host Information (T1592)"}),id:"T1592",name:"Gather Victim Host Information",reference:"https://attack.mitre.org/techniques/T1592",tactics:"reconnaissance",value:"gatherVictimHostInformation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimIdentityInformationDescription",{defaultMessage:"Gather Victim Identity Information (T1589)"}),id:"T1589",name:"Gather Victim Identity Information",reference:"https://attack.mitre.org/techniques/T1589",tactics:"reconnaissance",value:"gatherVictimIdentityInformation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimNetworkInformationDescription",{defaultMessage:"Gather Victim Network Information (T1590)"}),id:"T1590",name:"Gather Victim Network Information",reference:"https://attack.mitre.org/techniques/T1590",tactics:"reconnaissance",value:"gatherVictimNetworkInformation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimOrgInformationDescription",{defaultMessage:"Gather Victim Org Information (T1591)"}),id:"T1591",name:"Gather Victim Org Information",reference:"https://attack.mitre.org/techniques/T1591",tactics:"reconnaissance",value:"gatherVictimOrgInformation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.graphicalUserInterfaceDescription",{defaultMessage:"Graphical User Interface (T1061)"}),id:"T1061",name:"Graphical User Interface",reference:"https://attack.mitre.org/techniques/T1061",tactics:"execution",value:"graphicalUserInterface"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.groupPolicyDiscoveryDescription",{defaultMessage:"Group Policy Discovery (T1615)"}),id:"T1615",name:"Group Policy Discovery",reference:"https://attack.mitre.org/techniques/T1615",tactics:"discovery",value:"groupPolicyDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.histcontrolDescription",{defaultMessage:"HISTCONTROL (T1148)"}),id:"T1148",name:"HISTCONTROL",reference:"https://attack.mitre.org/techniques/T1148",tactics:"defense-evasion",value:"histcontrol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hardwareAdditionsDescription",{defaultMessage:"Hardware Additions (T1200)"}),id:"T1200",name:"Hardware Additions",reference:"https://attack.mitre.org/techniques/T1200",tactics:"initial-access",value:"hardwareAdditions"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hiddenFilesAndDirectoriesDescription",{defaultMessage:"Hidden Files and Directories (T1158)"}),id:"T1158",name:"Hidden Files and Directories",reference:"https://attack.mitre.org/techniques/T1158",tactics:"defense-evasion,persistence",value:"hiddenFilesAndDirectories"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hiddenUsersDescription",{defaultMessage:"Hidden Users (T1147)"}),id:"T1147",name:"Hidden Users",reference:"https://attack.mitre.org/techniques/T1147",tactics:"defense-evasion",value:"hiddenUsers"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hiddenWindowDescription",{defaultMessage:"Hidden Window (T1143)"}),id:"T1143",name:"Hidden Window",reference:"https://attack.mitre.org/techniques/T1143",tactics:"defense-evasion",value:"hiddenWindow"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hideArtifactsDescription",{defaultMessage:"Hide Artifacts (T1564)"}),id:"T1564",name:"Hide Artifacts",reference:"https://attack.mitre.org/techniques/T1564",tactics:"defense-evasion",value:"hideArtifacts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hijackExecutionFlowDescription",{defaultMessage:"Hijack Execution Flow (T1574)"}),id:"T1574",name:"Hijack Execution Flow",reference:"https://attack.mitre.org/techniques/T1574",tactics:"persistence,privilege-escalation,defense-evasion",value:"hijackExecutionFlow"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hookingDescription",{defaultMessage:"Hooking (T1179)"}),id:"T1179",name:"Hooking",reference:"https://attack.mitre.org/techniques/T1179",tactics:"persistence,privilege-escalation,credential-access",value:"hooking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hypervisorDescription",{defaultMessage:"Hypervisor (T1062)"}),id:"T1062",name:"Hypervisor",reference:"https://attack.mitre.org/techniques/T1062",tactics:"persistence",value:"hypervisor"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.imageFileExecutionOptionsInjectionDescription",{defaultMessage:"Image File Execution Options Injection (T1183)"}),id:"T1183",name:"Image File Execution Options Injection",reference:"https://attack.mitre.org/techniques/T1183",tactics:"privilege-escalation,persistence,defense-evasion",value:"imageFileExecutionOptionsInjection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.impairDefensesDescription",{defaultMessage:"Impair Defenses (T1562)"}),id:"T1562",name:"Impair Defenses",reference:"https://attack.mitre.org/techniques/T1562",tactics:"defense-evasion",value:"impairDefenses"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.implantInternalImageDescription",{defaultMessage:"Implant Internal Image (T1525)"}),id:"T1525",name:"Implant Internal Image",reference:"https://attack.mitre.org/techniques/T1525",tactics:"persistence",value:"implantInternalImage"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indicatorBlockingDescription",{defaultMessage:"Indicator Blocking (T1054)"}),id:"T1054",name:"Indicator Blocking",reference:"https://attack.mitre.org/techniques/T1054",tactics:"defense-evasion",value:"indicatorBlocking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indicatorRemovalFromToolsDescription",{defaultMessage:"Indicator Removal from Tools (T1066)"}),id:"T1066",name:"Indicator Removal from Tools",reference:"https://attack.mitre.org/techniques/T1066",tactics:"defense-evasion",value:"indicatorRemovalFromTools"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indicatorRemovalOnHostDescription",{defaultMessage:"Indicator Removal on Host (T1070)"}),id:"T1070",name:"Indicator Removal on Host",reference:"https://attack.mitre.org/techniques/T1070",tactics:"defense-evasion",value:"indicatorRemovalOnHost"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indirectCommandExecutionDescription",{defaultMessage:"Indirect Command Execution (T1202)"}),id:"T1202",name:"Indirect Command Execution",reference:"https://attack.mitre.org/techniques/T1202",tactics:"defense-evasion",value:"indirectCommandExecution"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.ingressToolTransferDescription",{defaultMessage:"Ingress Tool Transfer (T1105)"}),id:"T1105",name:"Ingress Tool Transfer",reference:"https://attack.mitre.org/techniques/T1105",tactics:"command-and-control",value:"ingressToolTransfer"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inhibitSystemRecoveryDescription",{defaultMessage:"Inhibit System Recovery (T1490)"}),id:"T1490",name:"Inhibit System Recovery",reference:"https://attack.mitre.org/techniques/T1490",tactics:"impact",value:"inhibitSystemRecovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inputCaptureDescription",{defaultMessage:"Input Capture (T1056)"}),id:"T1056",name:"Input Capture",reference:"https://attack.mitre.org/techniques/T1056",tactics:"collection,credential-access",value:"inputCapture"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inputPromptDescription",{defaultMessage:"Input Prompt (T1141)"}),id:"T1141",name:"Input Prompt",reference:"https://attack.mitre.org/techniques/T1141",tactics:"credential-access",value:"inputPrompt"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.installRootCertificateDescription",{defaultMessage:"Install Root Certificate (T1130)"}),id:"T1130",name:"Install Root Certificate",reference:"https://attack.mitre.org/techniques/T1130",tactics:"defense-evasion",value:"installRootCertificate"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.installUtilDescription",{defaultMessage:"InstallUtil (T1118)"}),id:"T1118",name:"InstallUtil",reference:"https://attack.mitre.org/techniques/T1118",tactics:"defense-evasion,execution",value:"installUtil"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.interProcessCommunicationDescription",{defaultMessage:"Inter-Process Communication (T1559)"}),id:"T1559",name:"Inter-Process Communication",reference:"https://attack.mitre.org/techniques/T1559",tactics:"execution",value:"interProcessCommunication"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.internalSpearphishingDescription",{defaultMessage:"Internal Spearphishing (T1534)"}),id:"T1534",name:"Internal Spearphishing",reference:"https://attack.mitre.org/techniques/T1534",tactics:"lateral-movement",value:"internalSpearphishing"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.kerberoastingDescription",{defaultMessage:"Kerberoasting (T1208)"}),id:"T1208",name:"Kerberoasting",reference:"https://attack.mitre.org/techniques/T1208",tactics:"credential-access",value:"kerberoasting"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.kernelModulesAndExtensionsDescription",{defaultMessage:"Kernel Modules and Extensions (T1215)"}),id:"T1215",name:"Kernel Modules and Extensions",reference:"https://attack.mitre.org/techniques/T1215",tactics:"persistence",value:"kernelModulesAndExtensions"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.keychainDescription",{defaultMessage:"Keychain (T1142)"}),id:"T1142",name:"Keychain",reference:"https://attack.mitre.org/techniques/T1142",tactics:"credential-access",value:"keychain"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lcLoadDylibAdditionDescription",{defaultMessage:"LC_LOAD_DYLIB Addition (T1161)"}),id:"T1161",name:"LC_LOAD_DYLIB Addition",reference:"https://attack.mitre.org/techniques/T1161",tactics:"persistence",value:"lcLoadDylibAddition"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lcMainHijackingDescription",{defaultMessage:"LC_MAIN Hijacking (T1149)"}),id:"T1149",name:"LC_MAIN Hijacking",reference:"https://attack.mitre.org/techniques/T1149",tactics:"defense-evasion",value:"lcMainHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.llmnrNbtNsPoisoningAndRelayDescription",{defaultMessage:"LLMNR/NBT-NS Poisoning and Relay (T1171)"}),id:"T1171",name:"LLMNR/NBT-NS Poisoning and Relay",reference:"https://attack.mitre.org/techniques/T1171",tactics:"credential-access",value:"llmnrNbtNsPoisoningAndRelay"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lsassDriverDescription",{defaultMessage:"LSASS Driver (T1177)"}),id:"T1177",name:"LSASS Driver",reference:"https://attack.mitre.org/techniques/T1177",tactics:"execution,persistence",value:"lsassDriver"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lateralToolTransferDescription",{defaultMessage:"Lateral Tool Transfer (T1570)"}),id:"T1570",name:"Lateral Tool Transfer",reference:"https://attack.mitre.org/techniques/T1570",tactics:"lateral-movement",value:"lateralToolTransfer"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.launchAgentDescription",{defaultMessage:"Launch Agent (T1159)"}),id:"T1159",name:"Launch Agent",reference:"https://attack.mitre.org/techniques/T1159",tactics:"persistence",value:"launchAgent"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.launchDaemonDescription",{defaultMessage:"Launch Daemon (T1160)"}),id:"T1160",name:"Launch Daemon",reference:"https://attack.mitre.org/techniques/T1160",tactics:"persistence,privilege-escalation",value:"launchDaemon"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.launchctlDescription",{defaultMessage:"Launchctl (T1152)"}),id:"T1152",name:"Launchctl",reference:"https://attack.mitre.org/techniques/T1152",tactics:"defense-evasion,execution,persistence",value:"launchctl"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.localJobSchedulingDescription",{defaultMessage:"Local Job Scheduling (T1168)"}),id:"T1168",name:"Local Job Scheduling",reference:"https://attack.mitre.org/techniques/T1168",tactics:"persistence,execution",value:"localJobScheduling"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.loginItemDescription",{defaultMessage:"Login Item (T1162)"}),id:"T1162",name:"Login Item",reference:"https://attack.mitre.org/techniques/T1162",tactics:"persistence",value:"loginItem"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.maliciousShellModificationDescription",{defaultMessage:"Malicious Shell Modification (T1156)"}),id:"T1156",name:"Malicious Shell Modification",reference:"https://attack.mitre.org/techniques/T1156",tactics:"persistence",value:"maliciousShellModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.masqueradingDescription",{defaultMessage:"Masquerading (T1036)"}),id:"T1036",name:"Masquerading",reference:"https://attack.mitre.org/techniques/T1036",tactics:"defense-evasion",value:"masquerading"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyAuthenticationProcessDescription",{defaultMessage:"Modify Authentication Process (T1556)"}),id:"T1556",name:"Modify Authentication Process",reference:"https://attack.mitre.org/techniques/T1556",tactics:"credential-access,defense-evasion,persistence",value:"modifyAuthenticationProcess"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyCloudComputeInfrastructureDescription",{defaultMessage:"Modify Cloud Compute Infrastructure (T1578)"}),id:"T1578",name:"Modify Cloud Compute Infrastructure",reference:"https://attack.mitre.org/techniques/T1578",tactics:"defense-evasion",value:"modifyCloudComputeInfrastructure"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyExistingServiceDescription",{defaultMessage:"Modify Existing Service (T1031)"}),id:"T1031",name:"Modify Existing Service",reference:"https://attack.mitre.org/techniques/T1031",tactics:"persistence",value:"modifyExistingService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyRegistryDescription",{defaultMessage:"Modify Registry (T1112)"}),id:"T1112",name:"Modify Registry",reference:"https://attack.mitre.org/techniques/T1112",tactics:"defense-evasion",value:"modifyRegistry"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifySystemImageDescription",{defaultMessage:"Modify System Image (T1601)"}),id:"T1601",name:"Modify System Image",reference:"https://attack.mitre.org/techniques/T1601",tactics:"defense-evasion",value:"modifySystemImage"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.mshtaDescription",{defaultMessage:"Mshta (T1170)"}),id:"T1170",name:"Mshta",reference:"https://attack.mitre.org/techniques/T1170",tactics:"defense-evasion,execution",value:"mshta"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multiFactorAuthenticationInterceptionDescription",{defaultMessage:"Multi-Factor Authentication Interception (T1111)"}),id:"T1111",name:"Multi-Factor Authentication Interception",reference:"https://attack.mitre.org/techniques/T1111",tactics:"credential-access",value:"multiFactorAuthenticationInterception"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multiFactorAuthenticationRequestGenerationDescription",{defaultMessage:"Multi-Factor Authentication Request Generation (T1621)"}),id:"T1621",name:"Multi-Factor Authentication Request Generation",reference:"https://attack.mitre.org/techniques/T1621",tactics:"credential-access",value:"multiFactorAuthenticationRequestGeneration"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multiStageChannelsDescription",{defaultMessage:"Multi-Stage Channels (T1104)"}),id:"T1104",name:"Multi-Stage Channels",reference:"https://attack.mitre.org/techniques/T1104",tactics:"command-and-control",value:"multiStageChannels"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multiHopProxyDescription",{defaultMessage:"Multi-hop Proxy (T1188)"}),id:"T1188",name:"Multi-hop Proxy",reference:"https://attack.mitre.org/techniques/T1188",tactics:"command-and-control",value:"multiHopProxy"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multibandCommunicationDescription",{defaultMessage:"Multiband Communication (T1026)"}),id:"T1026",name:"Multiband Communication",reference:"https://attack.mitre.org/techniques/T1026",tactics:"command-and-control",value:"multibandCommunication"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multilayerEncryptionDescription",{defaultMessage:"Multilayer Encryption (T1079)"}),id:"T1079",name:"Multilayer Encryption",reference:"https://attack.mitre.org/techniques/T1079",tactics:"command-and-control",value:"multilayerEncryption"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.ntfsFileAttributesDescription",{defaultMessage:"NTFS File Attributes (T1096)"}),id:"T1096",name:"NTFS File Attributes",reference:"https://attack.mitre.org/techniques/T1096",tactics:"defense-evasion",value:"ntfsFileAttributes"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nativeApiDescription",{defaultMessage:"Native API (T1106)"}),id:"T1106",name:"Native API",reference:"https://attack.mitre.org/techniques/T1106",tactics:"execution",value:"nativeApi"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.netshHelperDllDescription",{defaultMessage:"Netsh Helper DLL (T1128)"}),id:"T1128",name:"Netsh Helper DLL",reference:"https://attack.mitre.org/techniques/T1128",tactics:"persistence",value:"netshHelperDll"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkBoundaryBridgingDescription",{defaultMessage:"Network Boundary Bridging (T1599)"}),id:"T1599",name:"Network Boundary Bridging",reference:"https://attack.mitre.org/techniques/T1599",tactics:"defense-evasion",value:"networkBoundaryBridging"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkDenialOfServiceDescription",{defaultMessage:"Network Denial of Service (T1498)"}),id:"T1498",name:"Network Denial of Service",reference:"https://attack.mitre.org/techniques/T1498",tactics:"impact",value:"networkDenialOfService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkServiceDiscoveryDescription",{defaultMessage:"Network Service Discovery (T1046)"}),id:"T1046",name:"Network Service Discovery",reference:"https://attack.mitre.org/techniques/T1046",tactics:"discovery",value:"networkServiceDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkShareConnectionRemovalDescription",{defaultMessage:"Network Share Connection Removal (T1126)"}),id:"T1126",name:"Network Share Connection Removal",reference:"https://attack.mitre.org/techniques/T1126",tactics:"defense-evasion",value:"networkShareConnectionRemoval"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkShareDiscoveryDescription",{defaultMessage:"Network Share Discovery (T1135)"}),id:"T1135",name:"Network Share Discovery",reference:"https://attack.mitre.org/techniques/T1135",tactics:"discovery",value:"networkShareDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkSniffingDescription",{defaultMessage:"Network Sniffing (T1040)"}),id:"T1040",name:"Network Sniffing",reference:"https://attack.mitre.org/techniques/T1040",tactics:"credential-access,discovery",value:"networkSniffing"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.newServiceDescription",{defaultMessage:"New Service (T1050)"}),id:"T1050",name:"New Service",reference:"https://attack.mitre.org/techniques/T1050",tactics:"persistence,privilege-escalation",value:"newService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nonApplicationLayerProtocolDescription",{defaultMessage:"Non-Application Layer Protocol (T1095)"}),id:"T1095",name:"Non-Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1095",tactics:"command-and-control",value:"nonApplicationLayerProtocol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nonStandardPortDescription",{defaultMessage:"Non-Standard Port (T1571)"}),id:"T1571",name:"Non-Standard Port",reference:"https://attack.mitre.org/techniques/T1571",tactics:"command-and-control",value:"nonStandardPort"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.osCredentialDumpingDescription",{defaultMessage:"OS Credential Dumping (T1003)"}),id:"T1003",name:"OS Credential Dumping",reference:"https://attack.mitre.org/techniques/T1003",tactics:"credential-access",value:"osCredentialDumping"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.obfuscatedFilesOrInformationDescription",{defaultMessage:"Obfuscated Files or Information (T1027)"}),id:"T1027",name:"Obfuscated Files or Information",reference:"https://attack.mitre.org/techniques/T1027",tactics:"defense-evasion",value:"obfuscatedFilesOrInformation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.obtainCapabilitiesDescription",{defaultMessage:"Obtain Capabilities (T1588)"}),id:"T1588",name:"Obtain Capabilities",reference:"https://attack.mitre.org/techniques/T1588",tactics:"resource-development",value:"obtainCapabilities"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.officeApplicationStartupDescription",{defaultMessage:"Office Application Startup (T1137)"}),id:"T1137",name:"Office Application Startup",reference:"https://attack.mitre.org/techniques/T1137",tactics:"persistence",value:"officeApplicationStartup"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.parentPidSpoofingDescription",{defaultMessage:"Parent PID Spoofing (T1502)"}),id:"T1502",name:"Parent PID Spoofing",reference:"https://attack.mitre.org/techniques/T1502",tactics:"defense-evasion,privilege-escalation",value:"parentPidSpoofing"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passTheHashDescription",{defaultMessage:"Pass the Hash (T1075)"}),id:"T1075",name:"Pass the Hash",reference:"https://attack.mitre.org/techniques/T1075",tactics:"lateral-movement",value:"passTheHash"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passTheTicketDescription",{defaultMessage:"Pass the Ticket (T1097)"}),id:"T1097",name:"Pass the Ticket",reference:"https://attack.mitre.org/techniques/T1097",tactics:"lateral-movement",value:"passTheTicket"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passwordFilterDllDescription",{defaultMessage:"Password Filter DLL (T1174)"}),id:"T1174",name:"Password Filter DLL",reference:"https://attack.mitre.org/techniques/T1174",tactics:"credential-access",value:"passwordFilterDll"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passwordPolicyDiscoveryDescription",{defaultMessage:"Password Policy Discovery (T1201)"}),id:"T1201",name:"Password Policy Discovery",reference:"https://attack.mitre.org/techniques/T1201",tactics:"discovery",value:"passwordPolicyDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.pathInterceptionDescription",{defaultMessage:"Path Interception (T1034)"}),id:"T1034",name:"Path Interception",reference:"https://attack.mitre.org/techniques/T1034",tactics:"persistence,privilege-escalation",value:"pathInterception"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.peripheralDeviceDiscoveryDescription",{defaultMessage:"Peripheral Device Discovery (T1120)"}),id:"T1120",name:"Peripheral Device Discovery",reference:"https://attack.mitre.org/techniques/T1120",tactics:"discovery",value:"peripheralDeviceDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.permissionGroupsDiscoveryDescription",{defaultMessage:"Permission Groups Discovery (T1069)"}),id:"T1069",name:"Permission Groups Discovery",reference:"https://attack.mitre.org/techniques/T1069",tactics:"discovery",value:"permissionGroupsDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.phishingDescription",{defaultMessage:"Phishing (T1566)"}),id:"T1566",name:"Phishing",reference:"https://attack.mitre.org/techniques/T1566",tactics:"initial-access",value:"phishing"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.phishingForInformationDescription",{defaultMessage:"Phishing for Information (T1598)"}),id:"T1598",name:"Phishing for Information",reference:"https://attack.mitre.org/techniques/T1598",tactics:"reconnaissance",value:"phishingForInformation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.plistFileModificationDescription",{defaultMessage:"Plist File Modification (T1647)"}),id:"T1647",name:"Plist File Modification",reference:"https://attack.mitre.org/techniques/T1647",tactics:"defense-evasion",value:"plistFileModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.plistModificationDescription",{defaultMessage:"Plist Modification (T1150)"}),id:"T1150",name:"Plist Modification",reference:"https://attack.mitre.org/techniques/T1150",tactics:"defense-evasion,persistence,privilege-escalation",value:"plistModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.portMonitorsDescription",{defaultMessage:"Port Monitors (T1013)"}),id:"T1013",name:"Port Monitors",reference:"https://attack.mitre.org/techniques/T1013",tactics:"persistence,privilege-escalation",value:"portMonitors"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.powerShellDescription",{defaultMessage:"PowerShell (T1086)"}),id:"T1086",name:"PowerShell",reference:"https://attack.mitre.org/techniques/T1086",tactics:"execution",value:"powerShell"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.powerShellProfileDescription",{defaultMessage:"PowerShell Profile (T1504)"}),id:"T1504",name:"PowerShell Profile",reference:"https://attack.mitre.org/techniques/T1504",tactics:"persistence,privilege-escalation",value:"powerShellProfile"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.preOsBootDescription",{defaultMessage:"Pre-OS Boot (T1542)"}),id:"T1542",name:"Pre-OS Boot",reference:"https://attack.mitre.org/techniques/T1542",tactics:"defense-evasion,persistence",value:"preOsBoot"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.privateKeysDescription",{defaultMessage:"Private Keys (T1145)"}),id:"T1145",name:"Private Keys",reference:"https://attack.mitre.org/techniques/T1145",tactics:"credential-access",value:"privateKeys"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processDiscoveryDescription",{defaultMessage:"Process Discovery (T1057)"}),id:"T1057",name:"Process Discovery",reference:"https://attack.mitre.org/techniques/T1057",tactics:"discovery",value:"processDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processDoppelgangingDescription",{defaultMessage:"Process Doppelgänging (T1186)"}),id:"T1186",name:"Process Doppelgänging",reference:"https://attack.mitre.org/techniques/T1186",tactics:"defense-evasion",value:"processDoppelganging"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processHollowingDescription",{defaultMessage:"Process Hollowing (T1093)"}),id:"T1093",name:"Process Hollowing",reference:"https://attack.mitre.org/techniques/T1093",tactics:"defense-evasion",value:"processHollowing"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processInjectionDescription",{defaultMessage:"Process Injection (T1055)"}),id:"T1055",name:"Process Injection",reference:"https://attack.mitre.org/techniques/T1055",tactics:"defense-evasion,privilege-escalation",value:"processInjection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.protocolTunnelingDescription",{defaultMessage:"Protocol Tunneling (T1572)"}),id:"T1572",name:"Protocol Tunneling",reference:"https://attack.mitre.org/techniques/T1572",tactics:"command-and-control",value:"protocolTunneling"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.proxyDescription",{defaultMessage:"Proxy (T1090)"}),id:"T1090",name:"Proxy",reference:"https://attack.mitre.org/techniques/T1090",tactics:"command-and-control",value:"proxy"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.queryRegistryDescription",{defaultMessage:"Query Registry (T1012)"}),id:"T1012",name:"Query Registry",reference:"https://attack.mitre.org/techniques/T1012",tactics:"discovery",value:"queryRegistry"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rcCommonDescription",{defaultMessage:"Rc.common (T1163)"}),id:"T1163",name:"Rc.common",reference:"https://attack.mitre.org/techniques/T1163",tactics:"persistence",value:"rcCommon"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.reOpenedApplicationsDescription",{defaultMessage:"Re-opened Applications (T1164)"}),id:"T1164",name:"Re-opened Applications",reference:"https://attack.mitre.org/techniques/T1164",tactics:"persistence",value:"reOpenedApplications"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.redundantAccessDescription",{defaultMessage:"Redundant Access (T1108)"}),id:"T1108",name:"Redundant Access",reference:"https://attack.mitre.org/techniques/T1108",tactics:"defense-evasion,persistence",value:"redundantAccess"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.reflectiveCodeLoadingDescription",{defaultMessage:"Reflective Code Loading (T1620)"}),id:"T1620",name:"Reflective Code Loading",reference:"https://attack.mitre.org/techniques/T1620",tactics:"defense-evasion",value:"reflectiveCodeLoading"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.registryRunKeysStartupFolderDescription",{defaultMessage:"Registry Run Keys / Startup Folder (T1060)"}),id:"T1060",name:"Registry Run Keys / Startup Folder",reference:"https://attack.mitre.org/techniques/T1060",tactics:"persistence",value:"registryRunKeysStartupFolder"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.regsvcsRegasmDescription",{defaultMessage:"Regsvcs/Regasm (T1121)"}),id:"T1121",name:"Regsvcs/Regasm",reference:"https://attack.mitre.org/techniques/T1121",tactics:"defense-evasion,execution",value:"regsvcsRegasm"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.regsvr32Description",{defaultMessage:"Regsvr32 (T1117)"}),id:"T1117",name:"Regsvr32",reference:"https://attack.mitre.org/techniques/T1117",tactics:"defense-evasion,execution",value:"regsvr32"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteAccessSoftwareDescription",{defaultMessage:"Remote Access Software (T1219)"}),id:"T1219",name:"Remote Access Software",reference:"https://attack.mitre.org/techniques/T1219",tactics:"command-and-control",value:"remoteAccessSoftware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteDesktopProtocolDescription",{defaultMessage:"Remote Desktop Protocol (T1076)"}),id:"T1076",name:"Remote Desktop Protocol",reference:"https://attack.mitre.org/techniques/T1076",tactics:"lateral-movement",value:"remoteDesktopProtocol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteServiceSessionHijackingDescription",{defaultMessage:"Remote Service Session Hijacking (T1563)"}),id:"T1563",name:"Remote Service Session Hijacking",reference:"https://attack.mitre.org/techniques/T1563",tactics:"lateral-movement",value:"remoteServiceSessionHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteServicesDescription",{defaultMessage:"Remote Services (T1021)"}),id:"T1021",name:"Remote Services",reference:"https://attack.mitre.org/techniques/T1021",tactics:"lateral-movement",value:"remoteServices"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteSystemDiscoveryDescription",{defaultMessage:"Remote System Discovery (T1018)"}),id:"T1018",name:"Remote System Discovery",reference:"https://attack.mitre.org/techniques/T1018",tactics:"discovery",value:"remoteSystemDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.replicationThroughRemovableMediaDescription",{defaultMessage:"Replication Through Removable Media (T1091)"}),id:"T1091",name:"Replication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1091",tactics:"lateral-movement,initial-access",value:"replicationThroughRemovableMedia"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.resourceHijackingDescription",{defaultMessage:"Resource Hijacking (T1496)"}),id:"T1496",name:"Resource Hijacking",reference:"https://attack.mitre.org/techniques/T1496",tactics:"impact",value:"resourceHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.revertCloudInstanceDescription",{defaultMessage:"Revert Cloud Instance (T1536)"}),id:"T1536",name:"Revert Cloud Instance",reference:"https://attack.mitre.org/techniques/T1536",tactics:"defense-evasion",value:"revertCloudInstance"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rogueDomainControllerDescription",{defaultMessage:"Rogue Domain Controller (T1207)"}),id:"T1207",name:"Rogue Domain Controller",reference:"https://attack.mitre.org/techniques/T1207",tactics:"defense-evasion",value:"rogueDomainController"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rootkitDescription",{defaultMessage:"Rootkit (T1014)"}),id:"T1014",name:"Rootkit",reference:"https://attack.mitre.org/techniques/T1014",tactics:"defense-evasion",value:"rootkit"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rundll32Description",{defaultMessage:"Rundll32 (T1085)"}),id:"T1085",name:"Rundll32",reference:"https://attack.mitre.org/techniques/T1085",tactics:"defense-evasion,execution",value:"rundll32"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.runtimeDataManipulationDescription",{defaultMessage:"Runtime Data Manipulation (T1494)"}),id:"T1494",name:"Runtime Data Manipulation",reference:"https://attack.mitre.org/techniques/T1494",tactics:"impact",value:"runtimeDataManipulation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sidHistoryInjectionDescription",{defaultMessage:"SID-History Injection (T1178)"}),id:"T1178",name:"SID-History Injection",reference:"https://attack.mitre.org/techniques/T1178",tactics:"privilege-escalation",value:"sidHistoryInjection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sipAndTrustProviderHijackingDescription",{defaultMessage:"SIP and Trust Provider Hijacking (T1198)"}),id:"T1198",name:"SIP and Trust Provider Hijacking",reference:"https://attack.mitre.org/techniques/T1198",tactics:"defense-evasion,persistence",value:"sipAndTrustProviderHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sshHijackingDescription",{defaultMessage:"SSH Hijacking (T1184)"}),id:"T1184",name:"SSH Hijacking",reference:"https://attack.mitre.org/techniques/T1184",tactics:"lateral-movement",value:"sshHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTaskJobDescription",{defaultMessage:"Scheduled Task/Job (T1053)"}),id:"T1053",name:"Scheduled Task/Job",reference:"https://attack.mitre.org/techniques/T1053",tactics:"execution,persistence,privilege-escalation",value:"scheduledTaskJob"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTransferDescription",{defaultMessage:"Scheduled Transfer (T1029)"}),id:"T1029",name:"Scheduled Transfer",reference:"https://attack.mitre.org/techniques/T1029",tactics:"exfiltration",value:"scheduledTransfer"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.screenCaptureDescription",{defaultMessage:"Screen Capture (T1113)"}),id:"T1113",name:"Screen Capture",reference:"https://attack.mitre.org/techniques/T1113",tactics:"collection",value:"screenCapture"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.screensaverDescription",{defaultMessage:"Screensaver (T1180)"}),id:"T1180",name:"Screensaver",reference:"https://attack.mitre.org/techniques/T1180",tactics:"persistence",value:"screensaver"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scriptingDescription",{defaultMessage:"Scripting (T1064)"}),id:"T1064",name:"Scripting",reference:"https://attack.mitre.org/techniques/T1064",tactics:"defense-evasion,execution",value:"scripting"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchClosedSourcesDescription",{defaultMessage:"Search Closed Sources (T1597)"}),id:"T1597",name:"Search Closed Sources",reference:"https://attack.mitre.org/techniques/T1597",tactics:"reconnaissance",value:"searchClosedSources"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchOpenTechnicalDatabasesDescription",{defaultMessage:"Search Open Technical Databases (T1596)"}),id:"T1596",name:"Search Open Technical Databases",reference:"https://attack.mitre.org/techniques/T1596",tactics:"reconnaissance",value:"searchOpenTechnicalDatabases"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchOpenWebsitesDomainsDescription",{defaultMessage:"Search Open Websites/Domains (T1593)"}),id:"T1593",name:"Search Open Websites/Domains",reference:"https://attack.mitre.org/techniques/T1593",tactics:"reconnaissance",value:"searchOpenWebsitesDomains"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchVictimOwnedWebsitesDescription",{defaultMessage:"Search Victim-Owned Websites (T1594)"}),id:"T1594",name:"Search Victim-Owned Websites",reference:"https://attack.mitre.org/techniques/T1594",tactics:"reconnaissance",value:"searchVictimOwnedWebsites"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.securitySoftwareDiscoveryDescription",{defaultMessage:"Security Software Discovery (T1063)"}),id:"T1063",name:"Security Software Discovery",reference:"https://attack.mitre.org/techniques/T1063",tactics:"discovery",value:"securitySoftwareDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.securitySupportProviderDescription",{defaultMessage:"Security Support Provider (T1101)"}),id:"T1101",name:"Security Support Provider",reference:"https://attack.mitre.org/techniques/T1101",tactics:"persistence",value:"securitySupportProvider"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.securitydMemoryDescription",{defaultMessage:"Securityd Memory (T1167)"}),id:"T1167",name:"Securityd Memory",reference:"https://attack.mitre.org/techniques/T1167",tactics:"credential-access",value:"securitydMemory"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serverSoftwareComponentDescription",{defaultMessage:"Server Software Component (T1505)"}),id:"T1505",name:"Server Software Component",reference:"https://attack.mitre.org/techniques/T1505",tactics:"persistence",value:"serverSoftwareComponent"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serviceExecutionDescription",{defaultMessage:"Service Execution (T1035)"}),id:"T1035",name:"Service Execution",reference:"https://attack.mitre.org/techniques/T1035",tactics:"execution",value:"serviceExecution"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serviceRegistryPermissionsWeaknessDescription",{defaultMessage:"Service Registry Permissions Weakness (T1058)"}),id:"T1058",name:"Service Registry Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1058",tactics:"persistence,privilege-escalation",value:"serviceRegistryPermissionsWeakness"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serviceStopDescription",{defaultMessage:"Service Stop (T1489)"}),id:"T1489",name:"Service Stop",reference:"https://attack.mitre.org/techniques/T1489",tactics:"impact",value:"serviceStop"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.setuidAndSetgidDescription",{defaultMessage:"Setuid and Setgid (T1166)"}),id:"T1166",name:"Setuid and Setgid",reference:"https://attack.mitre.org/techniques/T1166",tactics:"privilege-escalation,persistence",value:"setuidAndSetgid"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sharedModulesDescription",{defaultMessage:"Shared Modules (T1129)"}),id:"T1129",name:"Shared Modules",reference:"https://attack.mitre.org/techniques/T1129",tactics:"execution",value:"sharedModules"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sharedWebrootDescription",{defaultMessage:"Shared Webroot (T1051)"}),id:"T1051",name:"Shared Webroot",reference:"https://attack.mitre.org/techniques/T1051",tactics:"lateral-movement",value:"sharedWebroot"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.shortcutModificationDescription",{defaultMessage:"Shortcut Modification (T1023)"}),id:"T1023",name:"Shortcut Modification",reference:"https://attack.mitre.org/techniques/T1023",tactics:"persistence",value:"shortcutModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwareDeploymentToolsDescription",{defaultMessage:"Software Deployment Tools (T1072)"}),id:"T1072",name:"Software Deployment Tools",reference:"https://attack.mitre.org/techniques/T1072",tactics:"execution,lateral-movement",value:"softwareDeploymentTools"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwareDiscoveryDescription",{defaultMessage:"Software Discovery (T1518)"}),id:"T1518",name:"Software Discovery",reference:"https://attack.mitre.org/techniques/T1518",tactics:"discovery",value:"softwareDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwarePackingDescription",{defaultMessage:"Software Packing (T1045)"}),id:"T1045",name:"Software Packing",reference:"https://attack.mitre.org/techniques/T1045",tactics:"defense-evasion",value:"softwarePacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sourceDescription",{defaultMessage:"Source (T1153)"}),id:"T1153",name:"Source",reference:"https://attack.mitre.org/techniques/T1153",tactics:"execution",value:"source"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.spaceAfterFilenameDescription",{defaultMessage:"Space after Filename (T1151)"}),id:"T1151",name:"Space after Filename",reference:"https://attack.mitre.org/techniques/T1151",tactics:"defense-evasion,execution",value:"spaceAfterFilename"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.spearphishingAttachmentDescription",{defaultMessage:"Spearphishing Attachment (T1193)"}),id:"T1193",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1193",tactics:"initial-access",value:"spearphishingAttachment"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.spearphishingLinkDescription",{defaultMessage:"Spearphishing Link (T1192)"}),id:"T1192",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1192",tactics:"initial-access",value:"spearphishingLink"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.spearphishingViaServiceDescription",{defaultMessage:"Spearphishing via Service (T1194)"}),id:"T1194",name:"Spearphishing via Service",reference:"https://attack.mitre.org/techniques/T1194",tactics:"initial-access",value:"spearphishingViaService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stageCapabilitiesDescription",{defaultMessage:"Stage Capabilities (T1608)"}),id:"T1608",name:"Stage Capabilities",reference:"https://attack.mitre.org/techniques/T1608",tactics:"resource-development",value:"stageCapabilities"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.standardCryptographicProtocolDescription",{defaultMessage:"Standard Cryptographic Protocol (T1032)"}),id:"T1032",name:"Standard Cryptographic Protocol",reference:"https://attack.mitre.org/techniques/T1032",tactics:"command-and-control",value:"standardCryptographicProtocol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.startupItemsDescription",{defaultMessage:"Startup Items (T1165)"}),id:"T1165",name:"Startup Items",reference:"https://attack.mitre.org/techniques/T1165",tactics:"persistence,privilege-escalation",value:"startupItems"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealApplicationAccessTokenDescription",{defaultMessage:"Steal Application Access Token (T1528)"}),id:"T1528",name:"Steal Application Access Token",reference:"https://attack.mitre.org/techniques/T1528",tactics:"credential-access",value:"stealApplicationAccessToken"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealWebSessionCookieDescription",{defaultMessage:"Steal Web Session Cookie (T1539)"}),id:"T1539",name:"Steal Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1539",tactics:"credential-access",value:"stealWebSessionCookie"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealOrForgeKerberosTicketsDescription",{defaultMessage:"Steal or Forge Kerberos Tickets (T1558)"}),id:"T1558",name:"Steal or Forge Kerberos Tickets",reference:"https://attack.mitre.org/techniques/T1558",tactics:"credential-access",value:"stealOrForgeKerberosTickets"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.storedDataManipulationDescription",{defaultMessage:"Stored Data Manipulation (T1492)"}),id:"T1492",name:"Stored Data Manipulation",reference:"https://attack.mitre.org/techniques/T1492",tactics:"impact",value:"storedDataManipulation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.subvertTrustControlsDescription",{defaultMessage:"Subvert Trust Controls (T1553)"}),id:"T1553",name:"Subvert Trust Controls",reference:"https://attack.mitre.org/techniques/T1553",tactics:"defense-evasion",value:"subvertTrustControls"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sudoDescription",{defaultMessage:"Sudo (T1169)"}),id:"T1169",name:"Sudo",reference:"https://attack.mitre.org/techniques/T1169",tactics:"privilege-escalation",value:"sudo"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sudoCachingDescription",{defaultMessage:"Sudo Caching (T1206)"}),id:"T1206",name:"Sudo Caching",reference:"https://attack.mitre.org/techniques/T1206",tactics:"privilege-escalation",value:"sudoCaching"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.supplyChainCompromiseDescription",{defaultMessage:"Supply Chain Compromise (T1195)"}),id:"T1195",name:"Supply Chain Compromise",reference:"https://attack.mitre.org/techniques/T1195",tactics:"initial-access",value:"supplyChainCompromise"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemBinaryProxyExecutionDescription",{defaultMessage:"System Binary Proxy Execution (T1218)"}),id:"T1218",name:"System Binary Proxy Execution",reference:"https://attack.mitre.org/techniques/T1218",tactics:"defense-evasion",value:"systemBinaryProxyExecution"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemFirmwareDescription",{defaultMessage:"System Firmware (T1019)"}),id:"T1019",name:"System Firmware",reference:"https://attack.mitre.org/techniques/T1019",tactics:"persistence",value:"systemFirmware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemInformationDiscoveryDescription",{defaultMessage:"System Information Discovery (T1082)"}),id:"T1082",name:"System Information Discovery",reference:"https://attack.mitre.org/techniques/T1082",tactics:"discovery",value:"systemInformationDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemLocationDiscoveryDescription",{defaultMessage:"System Location Discovery (T1614)"}),id:"T1614",name:"System Location Discovery",reference:"https://attack.mitre.org/techniques/T1614",tactics:"discovery",value:"systemLocationDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConfigurationDiscoveryDescription",{defaultMessage:"System Network Configuration Discovery (T1016)"}),id:"T1016",name:"System Network Configuration Discovery",reference:"https://attack.mitre.org/techniques/T1016",tactics:"discovery",value:"systemNetworkConfigurationDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConnectionsDiscoveryDescription",{defaultMessage:"System Network Connections Discovery (T1049)"}),id:"T1049",name:"System Network Connections Discovery",reference:"https://attack.mitre.org/techniques/T1049",tactics:"discovery",value:"systemNetworkConnectionsDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemOwnerUserDiscoveryDescription",{defaultMessage:"System Owner/User Discovery (T1033)"}),id:"T1033",name:"System Owner/User Discovery",reference:"https://attack.mitre.org/techniques/T1033",tactics:"discovery",value:"systemOwnerUserDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemScriptProxyExecutionDescription",{defaultMessage:"System Script Proxy Execution (T1216)"}),id:"T1216",name:"System Script Proxy Execution",reference:"https://attack.mitre.org/techniques/T1216",tactics:"defense-evasion",value:"systemScriptProxyExecution"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemServiceDiscoveryDescription",{defaultMessage:"System Service Discovery (T1007)"}),id:"T1007",name:"System Service Discovery",reference:"https://attack.mitre.org/techniques/T1007",tactics:"discovery",value:"systemServiceDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemServicesDescription",{defaultMessage:"System Services (T1569)"}),id:"T1569",name:"System Services",reference:"https://attack.mitre.org/techniques/T1569",tactics:"execution",value:"systemServices"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemShutdownRebootDescription",{defaultMessage:"System Shutdown/Reboot (T1529)"}),id:"T1529",name:"System Shutdown/Reboot",reference:"https://attack.mitre.org/techniques/T1529",tactics:"impact",value:"systemShutdownReboot"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemTimeDiscoveryDescription",{defaultMessage:"System Time Discovery (T1124)"}),id:"T1124",name:"System Time Discovery",reference:"https://attack.mitre.org/techniques/T1124",tactics:"discovery",value:"systemTimeDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemdServiceDescription",{defaultMessage:"Systemd Service (T1501)"}),id:"T1501",name:"Systemd Service",reference:"https://attack.mitre.org/techniques/T1501",tactics:"persistence",value:"systemdService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.taintSharedContentDescription",{defaultMessage:"Taint Shared Content (T1080)"}),id:"T1080",name:"Taint Shared Content",reference:"https://attack.mitre.org/techniques/T1080",tactics:"lateral-movement",value:"taintSharedContent"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.templateInjectionDescription",{defaultMessage:"Template Injection (T1221)"}),id:"T1221",name:"Template Injection",reference:"https://attack.mitre.org/techniques/T1221",tactics:"defense-evasion",value:"templateInjection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.timeProvidersDescription",{defaultMessage:"Time Providers (T1209)"}),id:"T1209",name:"Time Providers",reference:"https://attack.mitre.org/techniques/T1209",tactics:"persistence",value:"timeProviders"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.timestompDescription",{defaultMessage:"Timestomp (T1099)"}),id:"T1099",name:"Timestomp",reference:"https://attack.mitre.org/techniques/T1099",tactics:"defense-evasion",value:"timestomp"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trafficSignalingDescription",{defaultMessage:"Traffic Signaling (T1205)"}),id:"T1205",name:"Traffic Signaling",reference:"https://attack.mitre.org/techniques/T1205",tactics:"defense-evasion,persistence,command-and-control",value:"trafficSignaling"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.transferDataToCloudAccountDescription",{defaultMessage:"Transfer Data to Cloud Account (T1537)"}),id:"T1537",name:"Transfer Data to Cloud Account",reference:"https://attack.mitre.org/techniques/T1537",tactics:"exfiltration",value:"transferDataToCloudAccount"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.transmittedDataManipulationDescription",{defaultMessage:"Transmitted Data Manipulation (T1493)"}),id:"T1493",name:"Transmitted Data Manipulation",reference:"https://attack.mitre.org/techniques/T1493",tactics:"impact",value:"transmittedDataManipulation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trapDescription",{defaultMessage:"Trap (T1154)"}),id:"T1154",name:"Trap",reference:"https://attack.mitre.org/techniques/T1154",tactics:"execution,persistence",value:"trap"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedDeveloperUtilitiesProxyExecutionDescription",{defaultMessage:"Trusted Developer Utilities Proxy Execution (T1127)"}),id:"T1127",name:"Trusted Developer Utilities Proxy Execution",reference:"https://attack.mitre.org/techniques/T1127",tactics:"defense-evasion",value:"trustedDeveloperUtilitiesProxyExecution"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedRelationshipDescription",{defaultMessage:"Trusted Relationship (T1199)"}),id:"T1199",name:"Trusted Relationship",reference:"https://attack.mitre.org/techniques/T1199",tactics:"initial-access",value:"trustedRelationship"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.uncommonlyUsedPortDescription",{defaultMessage:"Uncommonly Used Port (T1065)"}),id:"T1065",name:"Uncommonly Used Port",reference:"https://attack.mitre.org/techniques/T1065",tactics:"command-and-control",value:"uncommonlyUsedPort"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.unsecuredCredentialsDescription",{defaultMessage:"Unsecured Credentials (T1552)"}),id:"T1552",name:"Unsecured Credentials",reference:"https://attack.mitre.org/techniques/T1552",tactics:"credential-access",value:"unsecuredCredentials"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.unusedUnsupportedCloudRegionsDescription",{defaultMessage:"Unused/Unsupported Cloud Regions (T1535)"}),id:"T1535",name:"Unused/Unsupported Cloud Regions",reference:"https://attack.mitre.org/techniques/T1535",tactics:"defense-evasion",value:"unusedUnsupportedCloudRegions"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.useAlternateAuthenticationMaterialDescription",{defaultMessage:"Use Alternate Authentication Material (T1550)"}),id:"T1550",name:"Use Alternate Authentication Material",reference:"https://attack.mitre.org/techniques/T1550",tactics:"defense-evasion,lateral-movement",value:"useAlternateAuthenticationMaterial"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.userExecutionDescription",{defaultMessage:"User Execution (T1204)"}),id:"T1204",name:"User Execution",reference:"https://attack.mitre.org/techniques/T1204",tactics:"execution",value:"userExecution"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.validAccountsDescription",{defaultMessage:"Valid Accounts (T1078)"}),id:"T1078",name:"Valid Accounts",reference:"https://attack.mitre.org/techniques/T1078",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",value:"validAccounts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.videoCaptureDescription",{defaultMessage:"Video Capture (T1125)"}),id:"T1125",name:"Video Capture",reference:"https://attack.mitre.org/techniques/T1125",tactics:"collection",value:"videoCapture"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.virtualizationSandboxEvasionDescription",{defaultMessage:"Virtualization/Sandbox Evasion (T1497)"}),id:"T1497",name:"Virtualization/Sandbox Evasion",reference:"https://attack.mitre.org/techniques/T1497",tactics:"defense-evasion,discovery",value:"virtualizationSandboxEvasion"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.weakenEncryptionDescription",{defaultMessage:"Weaken Encryption (T1600)"}),id:"T1600",name:"Weaken Encryption",reference:"https://attack.mitre.org/techniques/T1600",tactics:"defense-evasion",value:"weakenEncryption"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.webServiceDescription",{defaultMessage:"Web Service (T1102)"}),id:"T1102",name:"Web Service",reference:"https://attack.mitre.org/techniques/T1102",tactics:"command-and-control",value:"webService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.webSessionCookieDescription",{defaultMessage:"Web Session Cookie (T1506)"}),id:"T1506",name:"Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1506",tactics:"defense-evasion,lateral-movement",value:"webSessionCookie"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.webShellDescription",{defaultMessage:"Web Shell (T1100)"}),id:"T1100",name:"Web Shell",reference:"https://attack.mitre.org/techniques/T1100",tactics:"persistence,privilege-escalation",value:"webShell"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsAdminSharesDescription",{defaultMessage:"Windows Admin Shares (T1077)"}),id:"T1077",name:"Windows Admin Shares",reference:"https://attack.mitre.org/techniques/T1077",tactics:"lateral-movement",value:"windowsAdminShares"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsManagementInstrumentationDescription",{defaultMessage:"Windows Management Instrumentation (T1047)"}),id:"T1047",name:"Windows Management Instrumentation",reference:"https://attack.mitre.org/techniques/T1047",tactics:"execution",value:"windowsManagementInstrumentation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsManagementInstrumentationEventSubscriptionDescription",{defaultMessage:"Windows Management Instrumentation Event Subscription (T1084)"}),id:"T1084",name:"Windows Management Instrumentation Event Subscription",reference:"https://attack.mitre.org/techniques/T1084",tactics:"persistence",value:"windowsManagementInstrumentationEventSubscription"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsRemoteManagementDescription",{defaultMessage:"Windows Remote Management (T1028)"}),id:"T1028",name:"Windows Remote Management",reference:"https://attack.mitre.org/techniques/T1028",tactics:"execution,lateral-movement",value:"windowsRemoteManagement"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.winlogonHelperDllDescription",{defaultMessage:"Winlogon Helper DLL (T1004)"}),id:"T1004",name:"Winlogon Helper DLL",reference:"https://attack.mitre.org/techniques/T1004",tactics:"persistence",value:"winlogonHelperDll"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.xslScriptProcessingDescription",{defaultMessage:"XSL Script Processing (T1220)"}),id:"T1220",name:"XSL Script Processing",reference:"https://attack.mitre.org/techniques/T1220",tactics:"defense-evasion",value:"xslScriptProcessing"}],r=[{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.etcPasswdAndEtcShadowT1003Description",{defaultMessage:"/etc/passwd and /etc/shadow (T1003.008)"}),id:"T1003.008",name:"/etc/passwd and /etc/shadow",reference:"https://attack.mitre.org/techniques/T1003/008",tactics:"credential-access",techniqueId:"T1003",value:"etcPasswdAndEtcShadow"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.arpCachePoisoningT1557Description",{defaultMessage:"ARP Cache Poisoning (T1557.002)"}),id:"T1557.002",name:"ARP Cache Poisoning",reference:"https://attack.mitre.org/techniques/T1557/002",tactics:"credential-access,collection",techniqueId:"T1557",value:"arpCachePoisoning"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asRepRoastingT1558Description",{defaultMessage:"AS-REP Roasting (T1558.004)"}),id:"T1558.004",name:"AS-REP Roasting",reference:"https://attack.mitre.org/techniques/T1558/004",tactics:"credential-access",techniqueId:"T1558",value:"asRepRoasting"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.accessibilityFeaturesT1546Description",{defaultMessage:"Accessibility Features (T1546.008)"}),id:"T1546.008",name:"Accessibility Features",reference:"https://attack.mitre.org/techniques/T1546/008",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"accessibilityFeatures"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.activeSetupT1547Description",{defaultMessage:"Active Setup (T1547.014)"}),id:"T1547.014",name:"Active Setup",reference:"https://attack.mitre.org/techniques/T1547/014",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"activeSetup"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.addInsT1137Description",{defaultMessage:"Add-ins (T1137.006)"}),id:"T1137.006",name:"Add-ins",reference:"https://attack.mitre.org/techniques/T1137/006",tactics:"persistence",techniqueId:"T1137",value:"addIns"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.additionalCloudCredentialsT1098Description",{defaultMessage:"Additional Cloud Credentials (T1098.001)"}),id:"T1098.001",name:"Additional Cloud Credentials",reference:"https://attack.mitre.org/techniques/T1098/001",tactics:"persistence",techniqueId:"T1098",value:"additionalCloudCredentials"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.additionalCloudRolesT1098Description",{defaultMessage:"Additional Cloud Roles (T1098.003)"}),id:"T1098.003",name:"Additional Cloud Roles",reference:"https://attack.mitre.org/techniques/T1098/003",tactics:"persistence",techniqueId:"T1098",value:"additionalCloudRoles"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.additionalEmailDelegatePermissionsT1098Description",{defaultMessage:"Additional Email Delegate Permissions (T1098.002)"}),id:"T1098.002",name:"Additional Email Delegate Permissions",reference:"https://attack.mitre.org/techniques/T1098/002",tactics:"persistence",techniqueId:"T1098",value:"additionalEmailDelegatePermissions"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appCertDlLsT1546Description",{defaultMessage:"AppCert DLLs (T1546.009)"}),id:"T1546.009",name:"AppCert DLLs",reference:"https://attack.mitre.org/techniques/T1546/009",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"appCertDlLs"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appInitDlLsT1546Description",{defaultMessage:"AppInit DLLs (T1546.010)"}),id:"T1546.010",name:"AppInit DLLs",reference:"https://attack.mitre.org/techniques/T1546/010",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"appInitDlLs"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appleScriptT1059Description",{defaultMessage:"AppleScript (T1059.002)"}),id:"T1059.002",name:"AppleScript",reference:"https://attack.mitre.org/techniques/T1059/002",tactics:"execution",techniqueId:"T1059",value:"appleScript"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationAccessTokenT1550Description",{defaultMessage:"Application Access Token (T1550.001)"}),id:"T1550.001",name:"Application Access Token",reference:"https://attack.mitre.org/techniques/T1550/001",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"applicationAccessToken"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationExhaustionFloodT1499Description",{defaultMessage:"Application Exhaustion Flood (T1499.003)"}),id:"T1499.003",name:"Application Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/003",tactics:"impact",techniqueId:"T1499",value:"applicationExhaustionFlood"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationShimmingT1546Description",{defaultMessage:"Application Shimming (T1546.011)"}),id:"T1546.011",name:"Application Shimming",reference:"https://attack.mitre.org/techniques/T1546/011",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"applicationShimming"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationOrSystemExploitationT1499Description",{defaultMessage:"Application or System Exploitation (T1499.004)"}),id:"T1499.004",name:"Application or System Exploitation",reference:"https://attack.mitre.org/techniques/T1499/004",tactics:"impact",techniqueId:"T1499",value:"applicationOrSystemExploitation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaCustomMethodT1560Description",{defaultMessage:"Archive via Custom Method (T1560.003)"}),id:"T1560.003",name:"Archive via Custom Method",reference:"https://attack.mitre.org/techniques/T1560/003",tactics:"collection",techniqueId:"T1560",value:"archiveViaCustomMethod"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaLibraryT1560Description",{defaultMessage:"Archive via Library (T1560.002)"}),id:"T1560.002",name:"Archive via Library",reference:"https://attack.mitre.org/techniques/T1560/002",tactics:"collection",techniqueId:"T1560",value:"archiveViaLibrary"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaUtilityT1560Description",{defaultMessage:"Archive via Utility (T1560.001)"}),id:"T1560.001",name:"Archive via Utility",reference:"https://attack.mitre.org/techniques/T1560/001",tactics:"collection",techniqueId:"T1560",value:"archiveViaUtility"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asymmetricCryptographyT1573Description",{defaultMessage:"Asymmetric Cryptography (T1573.002)"}),id:"T1573.002",name:"Asymmetric Cryptography",reference:"https://attack.mitre.org/techniques/T1573/002",tactics:"command-and-control",techniqueId:"T1573",value:"asymmetricCryptography"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asynchronousProcedureCallT1055Description",{defaultMessage:"Asynchronous Procedure Call (T1055.004)"}),id:"T1055.004",name:"Asynchronous Procedure Call",reference:"https://attack.mitre.org/techniques/T1055/004",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"asynchronousProcedureCall"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.atT1053Description",{defaultMessage:"At (T1053.002)"}),id:"T1053.002",name:"At",reference:"https://attack.mitre.org/techniques/T1053/002",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"at"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.atLinuxT1053Description",{defaultMessage:"At (Linux) (T1053.001)"}),id:"T1053.001",name:"At (Linux)",reference:"https://attack.mitre.org/techniques/T1053/001",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"atLinux"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.authenticationPackageT1547Description",{defaultMessage:"Authentication Package (T1547.002)"}),id:"T1547.002",name:"Authentication Package",reference:"https://attack.mitre.org/techniques/T1547/002",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"authenticationPackage"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bashHistoryT1552Description",{defaultMessage:"Bash History (T1552.003)"}),id:"T1552.003",name:"Bash History",reference:"https://attack.mitre.org/techniques/T1552/003",tactics:"credential-access",techniqueId:"T1552",value:"bashHistory"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bidirectionalCommunicationT1102Description",{defaultMessage:"Bidirectional Communication (T1102.002)"}),id:"T1102.002",name:"Bidirectional Communication",reference:"https://attack.mitre.org/techniques/T1102/002",tactics:"command-and-control",techniqueId:"T1102",value:"bidirectionalCommunication"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.binaryPaddingT1027Description",{defaultMessage:"Binary Padding (T1027.001)"}),id:"T1027.001",name:"Binary Padding",reference:"https://attack.mitre.org/techniques/T1027/001",tactics:"defense-evasion",techniqueId:"T1027",value:"binaryPadding"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bootkitT1542Description",{defaultMessage:"Bootkit (T1542.003)"}),id:"T1542.003",name:"Bootkit",reference:"https://attack.mitre.org/techniques/T1542/003",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"bootkit"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.botnetT1583Description",{defaultMessage:"Botnet (T1583.005)"}),id:"T1583.005",name:"Botnet",reference:"https://attack.mitre.org/techniques/T1583/005",tactics:"resource-development",techniqueId:"T1583",value:"botnet"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.botnetT1584Description",{defaultMessage:"Botnet (T1584.005)"}),id:"T1584.005",name:"Botnet",reference:"https://attack.mitre.org/techniques/T1584/005",tactics:"resource-development",techniqueId:"T1584",value:"botnet"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.businessRelationshipsT1591Description",{defaultMessage:"Business Relationships (T1591.002)"}),id:"T1591.002",name:"Business Relationships",reference:"https://attack.mitre.org/techniques/T1591/002",tactics:"reconnaissance",techniqueId:"T1591",value:"businessRelationships"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bypassUserAccountControlT1548Description",{defaultMessage:"Bypass User Account Control (T1548.002)"}),id:"T1548.002",name:"Bypass User Account Control",reference:"https://attack.mitre.org/techniques/T1548/002",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"bypassUserAccountControl"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cdNsT1596Description",{defaultMessage:"CDNs (T1596.004)"}),id:"T1596.004",name:"CDNs",reference:"https://attack.mitre.org/techniques/T1596/004",tactics:"reconnaissance",techniqueId:"T1596",value:"cdNs"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cmstpT1218Description",{defaultMessage:"CMSTP (T1218.003)"}),id:"T1218.003",name:"CMSTP",reference:"https://attack.mitre.org/techniques/T1218/003",tactics:"defense-evasion",techniqueId:"T1218",value:"cmstp"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.corProfilerT1574Description",{defaultMessage:"COR_PROFILER (T1574.012)"}),id:"T1574.012",name:"COR_PROFILER",reference:"https://attack.mitre.org/techniques/T1574/012",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"corProfiler"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cachedDomainCredentialsT1003Description",{defaultMessage:"Cached Domain Credentials (T1003.005)"}),id:"T1003.005",name:"Cached Domain Credentials",reference:"https://attack.mitre.org/techniques/T1003/005",tactics:"credential-access",techniqueId:"T1003",value:"cachedDomainCredentials"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.changeDefaultFileAssociationT1546Description",{defaultMessage:"Change Default File Association (T1546.001)"}),id:"T1546.001",name:"Change Default File Association",reference:"https://attack.mitre.org/techniques/T1546/001",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"changeDefaultFileAssociation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearCommandHistoryT1070Description",{defaultMessage:"Clear Command History (T1070.003)"}),id:"T1070.003",name:"Clear Command History",reference:"https://attack.mitre.org/techniques/T1070/003",tactics:"defense-evasion",techniqueId:"T1070",value:"clearCommandHistory"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearLinuxOrMacSystemLogsT1070Description",{defaultMessage:"Clear Linux or Mac System Logs (T1070.002)"}),id:"T1070.002",name:"Clear Linux or Mac System Logs",reference:"https://attack.mitre.org/techniques/T1070/002",tactics:"defense-evasion",techniqueId:"T1070",value:"clearLinuxOrMacSystemLogs"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearWindowsEventLogsT1070Description",{defaultMessage:"Clear Windows Event Logs (T1070.001)"}),id:"T1070.001",name:"Clear Windows Event Logs",reference:"https://attack.mitre.org/techniques/T1070/001",tactics:"defense-evasion",techniqueId:"T1070",value:"clearWindowsEventLogs"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clientConfigurationsT1592Description",{defaultMessage:"Client Configurations (T1592.004)"}),id:"T1592.004",name:"Client Configurations",reference:"https://attack.mitre.org/techniques/T1592/004",tactics:"reconnaissance",techniqueId:"T1592",value:"clientConfigurations"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountT1087Description",{defaultMessage:"Cloud Account (T1087.004)"}),id:"T1087.004",name:"Cloud Account",reference:"https://attack.mitre.org/techniques/T1087/004",tactics:"discovery",techniqueId:"T1087",value:"cloudAccount"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountT1136Description",{defaultMessage:"Cloud Account (T1136.003)"}),id:"T1136.003",name:"Cloud Account",reference:"https://attack.mitre.org/techniques/T1136/003",tactics:"persistence",techniqueId:"T1136",value:"cloudAccount"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountsT1078Description",{defaultMessage:"Cloud Accounts (T1078.004)"}),id:"T1078.004",name:"Cloud Accounts",reference:"https://attack.mitre.org/techniques/T1078/004",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"cloudAccounts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudGroupsT1069Description",{defaultMessage:"Cloud Groups (T1069.003)"}),id:"T1069.003",name:"Cloud Groups",reference:"https://attack.mitre.org/techniques/T1069/003",tactics:"discovery",techniqueId:"T1069",value:"cloudGroups"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudInstanceMetadataApiT1552Description",{defaultMessage:"Cloud Instance Metadata API (T1552.005)"}),id:"T1552.005",name:"Cloud Instance Metadata API",reference:"https://attack.mitre.org/techniques/T1552/005",tactics:"credential-access",techniqueId:"T1552",value:"cloudInstanceMetadataApi"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeRepositoriesT1213Description",{defaultMessage:"Code Repositories (T1213.003)"}),id:"T1213.003",name:"Code Repositories",reference:"https://attack.mitre.org/techniques/T1213/003",tactics:"collection",techniqueId:"T1213",value:"codeRepositories"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningT1553Description",{defaultMessage:"Code Signing (T1553.002)"}),id:"T1553.002",name:"Code Signing",reference:"https://attack.mitre.org/techniques/T1553/002",tactics:"defense-evasion",techniqueId:"T1553",value:"codeSigning"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningCertificatesT1587Description",{defaultMessage:"Code Signing Certificates (T1587.002)"}),id:"T1587.002",name:"Code Signing Certificates",reference:"https://attack.mitre.org/techniques/T1587/002",tactics:"resource-development",techniqueId:"T1587",value:"codeSigningCertificates"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningCertificatesT1588Description",{defaultMessage:"Code Signing Certificates (T1588.003)"}),id:"T1588.003",name:"Code Signing Certificates",reference:"https://attack.mitre.org/techniques/T1588/003",tactics:"resource-development",techniqueId:"T1588",value:"codeSigningCertificates"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningPolicyModificationT1553Description",{defaultMessage:"Code Signing Policy Modification (T1553.006)"}),id:"T1553.006",name:"Code Signing Policy Modification",reference:"https://attack.mitre.org/techniques/T1553/006",tactics:"defense-evasion",techniqueId:"T1553",value:"codeSigningPolicyModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compileAfterDeliveryT1027Description",{defaultMessage:"Compile After Delivery (T1027.004)"}),id:"T1027.004",name:"Compile After Delivery",reference:"https://attack.mitre.org/techniques/T1027/004",tactics:"defense-evasion",techniqueId:"T1027",value:"compileAfterDelivery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compiledHtmlFileT1218Description",{defaultMessage:"Compiled HTML File (T1218.001)"}),id:"T1218.001",name:"Compiled HTML File",reference:"https://attack.mitre.org/techniques/T1218/001",tactics:"defense-evasion",techniqueId:"T1218",value:"compiledHtmlFile"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentFirmwareT1542Description",{defaultMessage:"Component Firmware (T1542.002)"}),id:"T1542.002",name:"Component Firmware",reference:"https://attack.mitre.org/techniques/T1542/002",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"componentFirmware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentObjectModelT1559Description",{defaultMessage:"Component Object Model (T1559.001)"}),id:"T1559.001",name:"Component Object Model",reference:"https://attack.mitre.org/techniques/T1559/001",tactics:"execution",techniqueId:"T1559",value:"componentObjectModel"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentObjectModelHijackingT1546Description",{defaultMessage:"Component Object Model Hijacking (T1546.015)"}),id:"T1546.015",name:"Component Object Model Hijacking",reference:"https://attack.mitre.org/techniques/T1546/015",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"componentObjectModelHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseHardwareSupplyChainT1195Description",{defaultMessage:"Compromise Hardware Supply Chain (T1195.003)"}),id:"T1195.003",name:"Compromise Hardware Supply Chain",reference:"https://attack.mitre.org/techniques/T1195/003",tactics:"initial-access",techniqueId:"T1195",value:"compromiseHardwareSupplyChain"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseSoftwareDependenciesAndDevelopmentToolsT1195Description",{defaultMessage:"Compromise Software Dependencies and Development Tools (T1195.001)"}),id:"T1195.001",name:"Compromise Software Dependencies and Development Tools",reference:"https://attack.mitre.org/techniques/T1195/001",tactics:"initial-access",techniqueId:"T1195",value:"compromiseSoftwareDependenciesAndDevelopmentTools"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseSoftwareSupplyChainT1195Description",{defaultMessage:"Compromise Software Supply Chain (T1195.002)"}),id:"T1195.002",name:"Compromise Software Supply Chain",reference:"https://attack.mitre.org/techniques/T1195/002",tactics:"initial-access",techniqueId:"T1195",value:"compromiseSoftwareSupplyChain"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.confluenceT1213Description",{defaultMessage:"Confluence (T1213.001)"}),id:"T1213.001",name:"Confluence",reference:"https://attack.mitre.org/techniques/T1213/001",tactics:"collection",techniqueId:"T1213",value:"confluence"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.containerApiT1552Description",{defaultMessage:"Container API (T1552.007)"}),id:"T1552.007",name:"Container API",reference:"https://attack.mitre.org/techniques/T1552/007",tactics:"credential-access",techniqueId:"T1552",value:"containerApi"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.containerOrchestrationJobT1053Description",{defaultMessage:"Container Orchestration Job (T1053.007)"}),id:"T1053.007",name:"Container Orchestration Job",reference:"https://attack.mitre.org/techniques/T1053/007",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"containerOrchestrationJob"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.controlPanelT1218Description",{defaultMessage:"Control Panel (T1218.002)"}),id:"T1218.002",name:"Control Panel",reference:"https://attack.mitre.org/techniques/T1218/002",tactics:"defense-evasion",techniqueId:"T1218",value:"controlPanel"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createCloudInstanceT1578Description",{defaultMessage:"Create Cloud Instance (T1578.002)"}),id:"T1578.002",name:"Create Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/002",tactics:"defense-evasion",techniqueId:"T1578",value:"createCloudInstance"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createProcessWithTokenT1134Description",{defaultMessage:"Create Process with Token (T1134.002)"}),id:"T1134.002",name:"Create Process with Token",reference:"https://attack.mitre.org/techniques/T1134/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"createProcessWithToken"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createSnapshotT1578Description",{defaultMessage:"Create Snapshot (T1578.001)"}),id:"T1578.001",name:"Create Snapshot",reference:"https://attack.mitre.org/techniques/T1578/001",tactics:"defense-evasion",techniqueId:"T1578",value:"createSnapshot"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialApiHookingT1056Description",{defaultMessage:"Credential API Hooking (T1056.004)"}),id:"T1056.004",name:"Credential API Hooking",reference:"https://attack.mitre.org/techniques/T1056/004",tactics:"collection,credential-access",techniqueId:"T1056",value:"credentialApiHooking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialStuffingT1110Description",{defaultMessage:"Credential Stuffing (T1110.004)"}),id:"T1110.004",name:"Credential Stuffing",reference:"https://attack.mitre.org/techniques/T1110/004",tactics:"credential-access",techniqueId:"T1110",value:"credentialStuffing"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsT1589Description",{defaultMessage:"Credentials (T1589.001)"}),id:"T1589.001",name:"Credentials",reference:"https://attack.mitre.org/techniques/T1589/001",tactics:"reconnaissance",techniqueId:"T1589",value:"credentials"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsInFilesT1552Description",{defaultMessage:"Credentials In Files (T1552.001)"}),id:"T1552.001",name:"Credentials In Files",reference:"https://attack.mitre.org/techniques/T1552/001",tactics:"credential-access",techniqueId:"T1552",value:"credentialsInFiles"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsFromWebBrowsersT1555Description",{defaultMessage:"Credentials from Web Browsers (T1555.003)"}),id:"T1555.003",name:"Credentials from Web Browsers",reference:"https://attack.mitre.org/techniques/T1555/003",tactics:"credential-access",techniqueId:"T1555",value:"credentialsFromWebBrowsers"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsInRegistryT1552Description",{defaultMessage:"Credentials in Registry (T1552.002)"}),id:"T1552.002",name:"Credentials in Registry",reference:"https://attack.mitre.org/techniques/T1552/002",tactics:"credential-access",techniqueId:"T1552",value:"credentialsInRegistry"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cronT1053Description",{defaultMessage:"Cron (T1053.003)"}),id:"T1053.003",name:"Cron",reference:"https://attack.mitre.org/techniques/T1053/003",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"cron"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dcSyncT1003Description",{defaultMessage:"DCSync (T1003.006)"}),id:"T1003.006",name:"DCSync",reference:"https://attack.mitre.org/techniques/T1003/006",tactics:"credential-access",techniqueId:"T1003",value:"dcSync"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dhcpSpoofingT1557Description",{defaultMessage:"DHCP Spoofing (T1557.003)"}),id:"T1557.003",name:"DHCP Spoofing",reference:"https://attack.mitre.org/techniques/T1557/003",tactics:"credential-access,collection",techniqueId:"T1557",value:"dhcpSpoofing"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dllSearchOrderHijackingT1574Description",{defaultMessage:"DLL Search Order Hijacking (T1574.001)"}),id:"T1574.001",name:"DLL Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1574/001",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dllSearchOrderHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dllSideLoadingT1574Description",{defaultMessage:"DLL Side-Loading (T1574.002)"}),id:"T1574.002",name:"DLL Side-Loading",reference:"https://attack.mitre.org/techniques/T1574/002",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dllSideLoading"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsT1590Description",{defaultMessage:"DNS (T1590.002)"}),id:"T1590.002",name:"DNS",reference:"https://attack.mitre.org/techniques/T1590/002",tactics:"reconnaissance",techniqueId:"T1590",value:"dns"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsT1071Description",{defaultMessage:"DNS (T1071.004)"}),id:"T1071.004",name:"DNS",reference:"https://attack.mitre.org/techniques/T1071/004",tactics:"command-and-control",techniqueId:"T1071",value:"dns"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsCalculationT1568Description",{defaultMessage:"DNS Calculation (T1568.003)"}),id:"T1568.003",name:"DNS Calculation",reference:"https://attack.mitre.org/techniques/T1568/003",tactics:"command-and-control",techniqueId:"T1568",value:"dnsCalculation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsServerT1583Description",{defaultMessage:"DNS Server (T1583.002)"}),id:"T1583.002",name:"DNS Server",reference:"https://attack.mitre.org/techniques/T1583/002",tactics:"resource-development",techniqueId:"T1583",value:"dnsServer"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsServerT1584Description",{defaultMessage:"DNS Server (T1584.002)"}),id:"T1584.002",name:"DNS Server",reference:"https://attack.mitre.org/techniques/T1584/002",tactics:"resource-development",techniqueId:"T1584",value:"dnsServer"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsPassiveDnsT1596Description",{defaultMessage:"DNS/Passive DNS (T1596.001)"}),id:"T1596.001",name:"DNS/Passive DNS",reference:"https://attack.mitre.org/techniques/T1596/001",tactics:"reconnaissance",techniqueId:"T1596",value:"dnsPassiveDns"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.deadDropResolverT1102Description",{defaultMessage:"Dead Drop Resolver (T1102.001)"}),id:"T1102.001",name:"Dead Drop Resolver",reference:"https://attack.mitre.org/techniques/T1102/001",tactics:"command-and-control",techniqueId:"T1102",value:"deadDropResolver"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.defaultAccountsT1078Description",{defaultMessage:"Default Accounts (T1078.001)"}),id:"T1078.001",name:"Default Accounts",reference:"https://attack.mitre.org/techniques/T1078/001",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"defaultAccounts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.deleteCloudInstanceT1578Description",{defaultMessage:"Delete Cloud Instance (T1578.003)"}),id:"T1578.003",name:"Delete Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/003",tactics:"defense-evasion",techniqueId:"T1578",value:"deleteCloudInstance"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.determinePhysicalLocationsT1591Description",{defaultMessage:"Determine Physical Locations (T1591.001)"}),id:"T1591.001",name:"Determine Physical Locations",reference:"https://attack.mitre.org/techniques/T1591/001",tactics:"reconnaissance",techniqueId:"T1591",value:"determinePhysicalLocations"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.deviceRegistrationT1098Description",{defaultMessage:"Device Registration (T1098.005)"}),id:"T1098.005",name:"Device Registration",reference:"https://attack.mitre.org/techniques/T1098/005",tactics:"persistence",techniqueId:"T1098",value:"deviceRegistration"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1596Description",{defaultMessage:"Digital Certificates (T1596.003)"}),id:"T1596.003",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1596/003",tactics:"reconnaissance",techniqueId:"T1596",value:"digitalCertificates"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1588Description",{defaultMessage:"Digital Certificates (T1588.004)"}),id:"T1588.004",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1588/004",tactics:"resource-development",techniqueId:"T1588",value:"digitalCertificates"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1587Description",{defaultMessage:"Digital Certificates (T1587.003)"}),id:"T1587.003",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1587/003",tactics:"resource-development",techniqueId:"T1587",value:"digitalCertificates"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.directNetworkFloodT1498Description",{defaultMessage:"Direct Network Flood (T1498.001)"}),id:"T1498.001",name:"Direct Network Flood",reference:"https://attack.mitre.org/techniques/T1498/001",tactics:"impact",techniqueId:"T1498",value:"directNetworkFlood"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableCloudLogsT1562Description",{defaultMessage:"Disable Cloud Logs (T1562.008)"}),id:"T1562.008",name:"Disable Cloud Logs",reference:"https://attack.mitre.org/techniques/T1562/008",tactics:"defense-evasion",techniqueId:"T1562",value:"disableCloudLogs"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableCryptoHardwareT1600Description",{defaultMessage:"Disable Crypto Hardware (T1600.002)"}),id:"T1600.002",name:"Disable Crypto Hardware",reference:"https://attack.mitre.org/techniques/T1600/002",tactics:"defense-evasion",techniqueId:"T1600",value:"disableCryptoHardware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableWindowsEventLoggingT1562Description",{defaultMessage:"Disable Windows Event Logging (T1562.002)"}),id:"T1562.002",name:"Disable Windows Event Logging",reference:"https://attack.mitre.org/techniques/T1562/002",tactics:"defense-evasion",techniqueId:"T1562",value:"disableWindowsEventLogging"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifyCloudFirewallT1562Description",{defaultMessage:"Disable or Modify Cloud Firewall (T1562.007)"}),id:"T1562.007",name:"Disable or Modify Cloud Firewall",reference:"https://attack.mitre.org/techniques/T1562/007",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifyCloudFirewall"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifySystemFirewallT1562Description",{defaultMessage:"Disable or Modify System Firewall (T1562.004)"}),id:"T1562.004",name:"Disable or Modify System Firewall",reference:"https://attack.mitre.org/techniques/T1562/004",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifySystemFirewall"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifyToolsT1562Description",{defaultMessage:"Disable or Modify Tools (T1562.001)"}),id:"T1562.001",name:"Disable or Modify Tools",reference:"https://attack.mitre.org/techniques/T1562/001",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifyTools"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.diskContentWipeT1561Description",{defaultMessage:"Disk Content Wipe (T1561.001)"}),id:"T1561.001",name:"Disk Content Wipe",reference:"https://attack.mitre.org/techniques/T1561/001",tactics:"impact",techniqueId:"T1561",value:"diskContentWipe"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.diskStructureWipeT1561Description",{defaultMessage:"Disk Structure Wipe (T1561.002)"}),id:"T1561.002",name:"Disk Structure Wipe",reference:"https://attack.mitre.org/techniques/T1561/002",tactics:"impact",techniqueId:"T1561",value:"diskStructureWipe"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.distributedComponentObjectModelT1021Description",{defaultMessage:"Distributed Component Object Model (T1021.003)"}),id:"T1021.003",name:"Distributed Component Object Model",reference:"https://attack.mitre.org/techniques/T1021/003",tactics:"lateral-movement",techniqueId:"T1021",value:"distributedComponentObjectModel"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountT1087Description",{defaultMessage:"Domain Account (T1087.002)"}),id:"T1087.002",name:"Domain Account",reference:"https://attack.mitre.org/techniques/T1087/002",tactics:"discovery",techniqueId:"T1087",value:"domainAccount"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountT1136Description",{defaultMessage:"Domain Account (T1136.002)"}),id:"T1136.002",name:"Domain Account",reference:"https://attack.mitre.org/techniques/T1136/002",tactics:"persistence",techniqueId:"T1136",value:"domainAccount"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountsT1078Description",{defaultMessage:"Domain Accounts (T1078.002)"}),id:"T1078.002",name:"Domain Accounts",reference:"https://attack.mitre.org/techniques/T1078/002",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"domainAccounts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainControllerAuthenticationT1556Description",{defaultMessage:"Domain Controller Authentication (T1556.001)"}),id:"T1556.001",name:"Domain Controller Authentication",reference:"https://attack.mitre.org/techniques/T1556/001",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"domainControllerAuthentication"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainFrontingT1090Description",{defaultMessage:"Domain Fronting (T1090.004)"}),id:"T1090.004",name:"Domain Fronting",reference:"https://attack.mitre.org/techniques/T1090/004",tactics:"command-and-control",techniqueId:"T1090",value:"domainFronting"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainGenerationAlgorithmsT1568Description",{defaultMessage:"Domain Generation Algorithms (T1568.002)"}),id:"T1568.002",name:"Domain Generation Algorithms",reference:"https://attack.mitre.org/techniques/T1568/002",tactics:"command-and-control",techniqueId:"T1568",value:"domainGenerationAlgorithms"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainGroupsT1069Description",{defaultMessage:"Domain Groups (T1069.002)"}),id:"T1069.002",name:"Domain Groups",reference:"https://attack.mitre.org/techniques/T1069/002",tactics:"discovery",techniqueId:"T1069",value:"domainGroups"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainPropertiesT1590Description",{defaultMessage:"Domain Properties (T1590.001)"}),id:"T1590.001",name:"Domain Properties",reference:"https://attack.mitre.org/techniques/T1590/001",tactics:"reconnaissance",techniqueId:"T1590",value:"domainProperties"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainTrustModificationT1484Description",{defaultMessage:"Domain Trust Modification (T1484.002)"}),id:"T1484.002",name:"Domain Trust Modification",reference:"https://attack.mitre.org/techniques/T1484/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1484",value:"domainTrustModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainsT1583Description",{defaultMessage:"Domains (T1583.001)"}),id:"T1583.001",name:"Domains",reference:"https://attack.mitre.org/techniques/T1583/001",tactics:"resource-development",techniqueId:"T1583",value:"domains"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainsT1584Description",{defaultMessage:"Domains (T1584.001)"}),id:"T1584.001",name:"Domains",reference:"https://attack.mitre.org/techniques/T1584/001",tactics:"resource-development",techniqueId:"T1584",value:"domains"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.doubleFileExtensionT1036Description",{defaultMessage:"Double File Extension (T1036.007)"}),id:"T1036.007",name:"Double File Extension",reference:"https://attack.mitre.org/techniques/T1036/007",tactics:"defense-evasion",techniqueId:"T1036",value:"doubleFileExtension"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.downgradeAttackT1562Description",{defaultMessage:"Downgrade Attack (T1562.010)"}),id:"T1562.010",name:"Downgrade Attack",reference:"https://attack.mitre.org/techniques/T1562/010",tactics:"defense-evasion",techniqueId:"T1562",value:"downgradeAttack"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.downgradeSystemImageT1601Description",{defaultMessage:"Downgrade System Image (T1601.002)"}),id:"T1601.002",name:"Downgrade System Image",reference:"https://attack.mitre.org/techniques/T1601/002",tactics:"defense-evasion",techniqueId:"T1601",value:"downgradeSystemImage"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.driveByTargetT1608Description",{defaultMessage:"Drive-by Target (T1608.004)"}),id:"T1608.004",name:"Drive-by Target",reference:"https://attack.mitre.org/techniques/T1608/004",tactics:"resource-development",techniqueId:"T1608",value:"driveByTarget"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dylibHijackingT1574Description",{defaultMessage:"Dylib Hijacking (T1574.004)"}),id:"T1574.004",name:"Dylib Hijacking",reference:"https://attack.mitre.org/techniques/T1574/004",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dylibHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicDataExchangeT1559Description",{defaultMessage:"Dynamic Data Exchange (T1559.002)"}),id:"T1559.002",name:"Dynamic Data Exchange",reference:"https://attack.mitre.org/techniques/T1559/002",tactics:"execution",techniqueId:"T1559",value:"dynamicDataExchange"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicLinkerHijackingT1574Description",{defaultMessage:"Dynamic Linker Hijacking (T1574.006)"}),id:"T1574.006",name:"Dynamic Linker Hijacking",reference:"https://attack.mitre.org/techniques/T1574/006",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dynamicLinkerHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicLinkLibraryInjectionT1055Description",{defaultMessage:"Dynamic-link Library Injection (T1055.001)"}),id:"T1055.001",name:"Dynamic-link Library Injection",reference:"https://attack.mitre.org/techniques/T1055/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"dynamicLinkLibraryInjection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.elevatedExecutionWithPromptT1548Description",{defaultMessage:"Elevated Execution with Prompt (T1548.004)"}),id:"T1548.004",name:"Elevated Execution with Prompt",reference:"https://attack.mitre.org/techniques/T1548/004",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"elevatedExecutionWithPrompt"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountT1087Description",{defaultMessage:"Email Account (T1087.003)"}),id:"T1087.003",name:"Email Account",reference:"https://attack.mitre.org/techniques/T1087/003",tactics:"discovery",techniqueId:"T1087",value:"emailAccount"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountsT1586Description",{defaultMessage:"Email Accounts (T1586.002)"}),id:"T1586.002",name:"Email Accounts",reference:"https://attack.mitre.org/techniques/T1586/002",tactics:"resource-development",techniqueId:"T1586",value:"emailAccounts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountsT1585Description",{defaultMessage:"Email Accounts (T1585.002)"}),id:"T1585.002",name:"Email Accounts",reference:"https://attack.mitre.org/techniques/T1585/002",tactics:"resource-development",techniqueId:"T1585",value:"emailAccounts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAddressesT1589Description",{defaultMessage:"Email Addresses (T1589.002)"}),id:"T1589.002",name:"Email Addresses",reference:"https://attack.mitre.org/techniques/T1589/002",tactics:"reconnaissance",techniqueId:"T1589",value:"emailAddresses"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailForwardingRuleT1114Description",{defaultMessage:"Email Forwarding Rule (T1114.003)"}),id:"T1114.003",name:"Email Forwarding Rule",reference:"https://attack.mitre.org/techniques/T1114/003",tactics:"collection",techniqueId:"T1114",value:"emailForwardingRule"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailHidingRulesT1564Description",{defaultMessage:"Email Hiding Rules (T1564.008)"}),id:"T1564.008",name:"Email Hiding Rules",reference:"https://attack.mitre.org/techniques/T1564/008",tactics:"defense-evasion",techniqueId:"T1564",value:"emailHidingRules"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emondT1546Description",{defaultMessage:"Emond (T1546.014)"}),id:"T1546.014",name:"Emond",reference:"https://attack.mitre.org/techniques/T1546/014",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"emond"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.employeeNamesT1589Description",{defaultMessage:"Employee Names (T1589.003)"}),id:"T1589.003",name:"Employee Names",reference:"https://attack.mitre.org/techniques/T1589/003",tactics:"reconnaissance",techniqueId:"T1589",value:"employeeNames"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.environmentalKeyingT1480Description",{defaultMessage:"Environmental Keying (T1480.001)"}),id:"T1480.001",name:"Environmental Keying",reference:"https://attack.mitre.org/techniques/T1480/001",tactics:"defense-evasion",techniqueId:"T1480",value:"environmentalKeying"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.executableInstallerFilePermissionsWeaknessT1574Description",{defaultMessage:"Executable Installer File Permissions Weakness (T1574.005)"}),id:"T1574.005",name:"Executable Installer File Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/005",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"executableInstallerFilePermissionsWeakness"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverAsymmetricEncryptedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol (T1048.002)"}),id:"T1048.002",name:"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/002",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverAsymmetricEncryptedNonC2Protocol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverBluetoothT1011Description",{defaultMessage:"Exfiltration Over Bluetooth (T1011.001)"}),id:"T1011.001",name:"Exfiltration Over Bluetooth",reference:"https://attack.mitre.org/techniques/T1011/001",tactics:"exfiltration",techniqueId:"T1011",value:"exfiltrationOverBluetooth"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverSymmetricEncryptedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Symmetric Encrypted Non-C2 Protocol (T1048.001)"}),id:"T1048.001",name:"Exfiltration Over Symmetric Encrypted Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/001",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverSymmetricEncryptedNonC2Protocol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverUnencryptedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Unencrypted Non-C2 Protocol (T1048.003)"}),id:"T1048.003",name:"Exfiltration Over Unencrypted Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/003",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverUnencryptedNonC2Protocol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverUsbT1052Description",{defaultMessage:"Exfiltration over USB (T1052.001)"}),id:"T1052.001",name:"Exfiltration over USB",reference:"https://attack.mitre.org/techniques/T1052/001",tactics:"exfiltration",techniqueId:"T1052",value:"exfiltrationOverUsb"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationToCloudStorageT1567Description",{defaultMessage:"Exfiltration to Cloud Storage (T1567.002)"}),id:"T1567.002",name:"Exfiltration to Cloud Storage",reference:"https://attack.mitre.org/techniques/T1567/002",tactics:"exfiltration",techniqueId:"T1567",value:"exfiltrationToCloudStorage"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationToCodeRepositoryT1567Description",{defaultMessage:"Exfiltration to Code Repository (T1567.001)"}),id:"T1567.001",name:"Exfiltration to Code Repository",reference:"https://attack.mitre.org/techniques/T1567/001",tactics:"exfiltration",techniqueId:"T1567",value:"exfiltrationToCodeRepository"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exploitsT1587Description",{defaultMessage:"Exploits (T1587.004)"}),id:"T1587.004",name:"Exploits",reference:"https://attack.mitre.org/techniques/T1587/004",tactics:"resource-development",techniqueId:"T1587",value:"exploits"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exploitsT1588Description",{defaultMessage:"Exploits (T1588.005)"}),id:"T1588.005",name:"Exploits",reference:"https://attack.mitre.org/techniques/T1588/005",tactics:"resource-development",techniqueId:"T1588",value:"exploits"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.externalDefacementT1491Description",{defaultMessage:"External Defacement (T1491.002)"}),id:"T1491.002",name:"External Defacement",reference:"https://attack.mitre.org/techniques/T1491/002",tactics:"impact",techniqueId:"T1491",value:"externalDefacement"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.externalProxyT1090Description",{defaultMessage:"External Proxy (T1090.002)"}),id:"T1090.002",name:"External Proxy",reference:"https://attack.mitre.org/techniques/T1090/002",tactics:"command-and-control",techniqueId:"T1090",value:"externalProxy"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.extraWindowMemoryInjectionT1055Description",{defaultMessage:"Extra Window Memory Injection (T1055.011)"}),id:"T1055.011",name:"Extra Window Memory Injection",reference:"https://attack.mitre.org/techniques/T1055/011",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"extraWindowMemoryInjection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fastFluxDnsT1568Description",{defaultMessage:"Fast Flux DNS (T1568.001)"}),id:"T1568.001",name:"Fast Flux DNS",reference:"https://attack.mitre.org/techniques/T1568/001",tactics:"command-and-control",techniqueId:"T1568",value:"fastFluxDns"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fileDeletionT1070Description",{defaultMessage:"File Deletion (T1070.004)"}),id:"T1070.004",name:"File Deletion",reference:"https://attack.mitre.org/techniques/T1070/004",tactics:"defense-evasion",techniqueId:"T1070",value:"fileDeletion"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fileTransferProtocolsT1071Description",{defaultMessage:"File Transfer Protocols (T1071.002)"}),id:"T1071.002",name:"File Transfer Protocols",reference:"https://attack.mitre.org/techniques/T1071/002",tactics:"command-and-control",techniqueId:"T1071",value:"fileTransferProtocols"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.firmwareT1592Description",{defaultMessage:"Firmware (T1592.003)"}),id:"T1592.003",name:"Firmware",reference:"https://attack.mitre.org/techniques/T1592/003",tactics:"reconnaissance",techniqueId:"T1592",value:"firmware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.guiInputCaptureT1056Description",{defaultMessage:"GUI Input Capture (T1056.002)"}),id:"T1056.002",name:"GUI Input Capture",reference:"https://attack.mitre.org/techniques/T1056/002",tactics:"collection,credential-access",techniqueId:"T1056",value:"guiInputCapture"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.gatekeeperBypassT1553Description",{defaultMessage:"Gatekeeper Bypass (T1553.001)"}),id:"T1553.001",name:"Gatekeeper Bypass",reference:"https://attack.mitre.org/techniques/T1553/001",tactics:"defense-evasion",techniqueId:"T1553",value:"gatekeeperBypass"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.goldenTicketT1558Description",{defaultMessage:"Golden Ticket (T1558.001)"}),id:"T1558.001",name:"Golden Ticket",reference:"https://attack.mitre.org/techniques/T1558/001",tactics:"credential-access",techniqueId:"T1558",value:"goldenTicket"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.groupPolicyModificationT1484Description",{defaultMessage:"Group Policy Modification (T1484.001)"}),id:"T1484.001",name:"Group Policy Modification",reference:"https://attack.mitre.org/techniques/T1484/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1484",value:"groupPolicyModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.groupPolicyPreferencesT1552Description",{defaultMessage:"Group Policy Preferences (T1552.006)"}),id:"T1552.006",name:"Group Policy Preferences",reference:"https://attack.mitre.org/techniques/T1552/006",tactics:"credential-access",techniqueId:"T1552",value:"groupPolicyPreferences"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.htmlSmugglingT1027Description",{defaultMessage:"HTML Smuggling (T1027.006)"}),id:"T1027.006",name:"HTML Smuggling",reference:"https://attack.mitre.org/techniques/T1027/006",tactics:"defense-evasion",techniqueId:"T1027",value:"htmlSmuggling"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hardwareT1592Description",{defaultMessage:"Hardware (T1592.001)"}),id:"T1592.001",name:"Hardware",reference:"https://attack.mitre.org/techniques/T1592/001",tactics:"reconnaissance",techniqueId:"T1592",value:"hardware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenFileSystemT1564Description",{defaultMessage:"Hidden File System (T1564.005)"}),id:"T1564.005",name:"Hidden File System",reference:"https://attack.mitre.org/techniques/T1564/005",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenFileSystem"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenFilesAndDirectoriesT1564Description",{defaultMessage:"Hidden Files and Directories (T1564.001)"}),id:"T1564.001",name:"Hidden Files and Directories",reference:"https://attack.mitre.org/techniques/T1564/001",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenFilesAndDirectories"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenUsersT1564Description",{defaultMessage:"Hidden Users (T1564.002)"}),id:"T1564.002",name:"Hidden Users",reference:"https://attack.mitre.org/techniques/T1564/002",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenUsers"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenWindowT1564Description",{defaultMessage:"Hidden Window (T1564.003)"}),id:"T1564.003",name:"Hidden Window",reference:"https://attack.mitre.org/techniques/T1564/003",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenWindow"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.iisComponentsT1505Description",{defaultMessage:"IIS Components (T1505.004)"}),id:"T1505.004",name:"IIS Components",reference:"https://attack.mitre.org/techniques/T1505/004",tactics:"persistence",techniqueId:"T1505",value:"iisComponents"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ipAddressesT1590Description",{defaultMessage:"IP Addresses (T1590.005)"}),id:"T1590.005",name:"IP Addresses",reference:"https://attack.mitre.org/techniques/T1590/005",tactics:"reconnaissance",techniqueId:"T1590",value:"ipAddresses"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.identifyBusinessTempoT1591Description",{defaultMessage:"Identify Business Tempo (T1591.003)"}),id:"T1591.003",name:"Identify Business Tempo",reference:"https://attack.mitre.org/techniques/T1591/003",tactics:"reconnaissance",techniqueId:"T1591",value:"identifyBusinessTempo"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.identifyRolesT1591Description",{defaultMessage:"Identify Roles (T1591.004)"}),id:"T1591.004",name:"Identify Roles",reference:"https://attack.mitre.org/techniques/T1591/004",tactics:"reconnaissance",techniqueId:"T1591",value:"identifyRoles"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.imageFileExecutionOptionsInjectionT1546Description",{defaultMessage:"Image File Execution Options Injection (T1546.012)"}),id:"T1546.012",name:"Image File Execution Options Injection",reference:"https://attack.mitre.org/techniques/T1546/012",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"imageFileExecutionOptionsInjection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.impairCommandHistoryLoggingT1562Description",{defaultMessage:"Impair Command History Logging (T1562.003)"}),id:"T1562.003",name:"Impair Command History Logging",reference:"https://attack.mitre.org/techniques/T1562/003",tactics:"defense-evasion",techniqueId:"T1562",value:"impairCommandHistoryLogging"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.indicatorBlockingT1562Description",{defaultMessage:"Indicator Blocking (T1562.006)"}),id:"T1562.006",name:"Indicator Blocking",reference:"https://attack.mitre.org/techniques/T1562/006",tactics:"defense-evasion",techniqueId:"T1562",value:"indicatorBlocking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.indicatorRemovalFromToolsT1027Description",{defaultMessage:"Indicator Removal from Tools (T1027.005)"}),id:"T1027.005",name:"Indicator Removal from Tools",reference:"https://attack.mitre.org/techniques/T1027/005",tactics:"defense-evasion",techniqueId:"T1027",value:"indicatorRemovalFromTools"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installDigitalCertificateT1608Description",{defaultMessage:"Install Digital Certificate (T1608.003)"}),id:"T1608.003",name:"Install Digital Certificate",reference:"https://attack.mitre.org/techniques/T1608/003",tactics:"resource-development",techniqueId:"T1608",value:"installDigitalCertificate"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installRootCertificateT1553Description",{defaultMessage:"Install Root Certificate (T1553.004)"}),id:"T1553.004",name:"Install Root Certificate",reference:"https://attack.mitre.org/techniques/T1553/004",tactics:"defense-evasion",techniqueId:"T1553",value:"installRootCertificate"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installUtilT1218Description",{defaultMessage:"InstallUtil (T1218.004)"}),id:"T1218.004",name:"InstallUtil",reference:"https://attack.mitre.org/techniques/T1218/004",tactics:"defense-evasion",techniqueId:"T1218",value:"installUtil"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internalDefacementT1491Description",{defaultMessage:"Internal Defacement (T1491.001)"}),id:"T1491.001",name:"Internal Defacement",reference:"https://attack.mitre.org/techniques/T1491/001",tactics:"impact",techniqueId:"T1491",value:"internalDefacement"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internalProxyT1090Description",{defaultMessage:"Internal Proxy (T1090.001)"}),id:"T1090.001",name:"Internal Proxy",reference:"https://attack.mitre.org/techniques/T1090/001",tactics:"command-and-control",techniqueId:"T1090",value:"internalProxy"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internetConnectionDiscoveryT1016Description",{defaultMessage:"Internet Connection Discovery (T1016.001)"}),id:"T1016.001",name:"Internet Connection Discovery",reference:"https://attack.mitre.org/techniques/T1016/001",tactics:"discovery",techniqueId:"T1016",value:"internetConnectionDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.invalidCodeSignatureT1036Description",{defaultMessage:"Invalid Code Signature (T1036.001)"}),id:"T1036.001",name:"Invalid Code Signature",reference:"https://attack.mitre.org/techniques/T1036/001",tactics:"defense-evasion",techniqueId:"T1036",value:"invalidCodeSignature"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.javaScriptT1059Description",{defaultMessage:"JavaScript (T1059.007)"}),id:"T1059.007",name:"JavaScript",reference:"https://attack.mitre.org/techniques/T1059/007",tactics:"execution",techniqueId:"T1059",value:"javaScript"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.junkDataT1001Description",{defaultMessage:"Junk Data (T1001.001)"}),id:"T1001.001",name:"Junk Data",reference:"https://attack.mitre.org/techniques/T1001/001",tactics:"command-and-control",techniqueId:"T1001",value:"junkData"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.kerberoastingT1558Description",{defaultMessage:"Kerberoasting (T1558.003)"}),id:"T1558.003",name:"Kerberoasting",reference:"https://attack.mitre.org/techniques/T1558/003",tactics:"credential-access",techniqueId:"T1558",value:"kerberoasting"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.kernelModulesAndExtensionsT1547Description",{defaultMessage:"Kernel Modules and Extensions (T1547.006)"}),id:"T1547.006",name:"Kernel Modules and Extensions",reference:"https://attack.mitre.org/techniques/T1547/006",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"kernelModulesAndExtensions"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.kernelCallbackTableT1574Description",{defaultMessage:"KernelCallbackTable (T1574.013)"}),id:"T1574.013",name:"KernelCallbackTable",reference:"https://attack.mitre.org/techniques/T1574/013",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"kernelCallbackTable"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.keychainT1555Description",{defaultMessage:"Keychain (T1555.001)"}),id:"T1555.001",name:"Keychain",reference:"https://attack.mitre.org/techniques/T1555/001",tactics:"credential-access",techniqueId:"T1555",value:"keychain"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.keyloggingT1056Description",{defaultMessage:"Keylogging (T1056.001)"}),id:"T1056.001",name:"Keylogging",reference:"https://attack.mitre.org/techniques/T1056/001",tactics:"collection,credential-access",techniqueId:"T1056",value:"keylogging"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lcLoadDylibAdditionT1546Description",{defaultMessage:"LC_LOAD_DYLIB Addition (T1546.006)"}),id:"T1546.006",name:"LC_LOAD_DYLIB Addition",reference:"https://attack.mitre.org/techniques/T1546/006",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"lcLoadDylibAddition"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.llmnrNbtNsPoisoningAndSmbRelayT1557Description",{defaultMessage:"LLMNR/NBT-NS Poisoning and SMB Relay (T1557.001)"}),id:"T1557.001",name:"LLMNR/NBT-NS Poisoning and SMB Relay",reference:"https://attack.mitre.org/techniques/T1557/001",tactics:"credential-access,collection",techniqueId:"T1557",value:"llmnrNbtNsPoisoningAndSmbRelay"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsaSecretsT1003Description",{defaultMessage:"LSA Secrets (T1003.004)"}),id:"T1003.004",name:"LSA Secrets",reference:"https://attack.mitre.org/techniques/T1003/004",tactics:"credential-access",techniqueId:"T1003",value:"lsaSecrets"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsassDriverT1547Description",{defaultMessage:"LSASS Driver (T1547.008)"}),id:"T1547.008",name:"LSASS Driver",reference:"https://attack.mitre.org/techniques/T1547/008",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"lsassDriver"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsassMemoryT1003Description",{defaultMessage:"LSASS Memory (T1003.001)"}),id:"T1003.001",name:"LSASS Memory",reference:"https://attack.mitre.org/techniques/T1003/001",tactics:"credential-access",techniqueId:"T1003",value:"lsassMemory"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchAgentT1543Description",{defaultMessage:"Launch Agent (T1543.001)"}),id:"T1543.001",name:"Launch Agent",reference:"https://attack.mitre.org/techniques/T1543/001",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"launchAgent"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchDaemonT1543Description",{defaultMessage:"Launch Daemon (T1543.004)"}),id:"T1543.004",name:"Launch Daemon",reference:"https://attack.mitre.org/techniques/T1543/004",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"launchDaemon"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchctlT1569Description",{defaultMessage:"Launchctl (T1569.001)"}),id:"T1569.001",name:"Launchctl",reference:"https://attack.mitre.org/techniques/T1569/001",tactics:"execution",techniqueId:"T1569",value:"launchctl"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchdT1053Description",{defaultMessage:"Launchd (T1053.004)"}),id:"T1053.004",name:"Launchd",reference:"https://attack.mitre.org/techniques/T1053/004",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"launchd"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.linkTargetT1608Description",{defaultMessage:"Link Target (T1608.005)"}),id:"T1608.005",name:"Link Target",reference:"https://attack.mitre.org/techniques/T1608/005",tactics:"resource-development",techniqueId:"T1608",value:"linkTarget"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.linuxAndMacFileAndDirectoryPermissionsModificationT1222Description",{defaultMessage:"Linux and Mac File and Directory Permissions Modification (T1222.002)"}),id:"T1222.002",name:"Linux and Mac File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222/002",tactics:"defense-evasion",techniqueId:"T1222",value:"linuxAndMacFileAndDirectoryPermissionsModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.listPlantingT1055Description",{defaultMessage:"ListPlanting (T1055.015)"}),id:"T1055.015",name:"ListPlanting",reference:"https://attack.mitre.org/techniques/T1055/015",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"listPlanting"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountT1087Description",{defaultMessage:"Local Account (T1087.001)"}),id:"T1087.001",name:"Local Account",reference:"https://attack.mitre.org/techniques/T1087/001",tactics:"discovery",techniqueId:"T1087",value:"localAccount"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountT1136Description",{defaultMessage:"Local Account (T1136.001)"}),id:"T1136.001",name:"Local Account",reference:"https://attack.mitre.org/techniques/T1136/001",tactics:"persistence",techniqueId:"T1136",value:"localAccount"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountsT1078Description",{defaultMessage:"Local Accounts (T1078.003)"}),id:"T1078.003",name:"Local Accounts",reference:"https://attack.mitre.org/techniques/T1078/003",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"localAccounts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localDataStagingT1074Description",{defaultMessage:"Local Data Staging (T1074.001)"}),id:"T1074.001",name:"Local Data Staging",reference:"https://attack.mitre.org/techniques/T1074/001",tactics:"collection",techniqueId:"T1074",value:"localDataStaging"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localEmailCollectionT1114Description",{defaultMessage:"Local Email Collection (T1114.001)"}),id:"T1114.001",name:"Local Email Collection",reference:"https://attack.mitre.org/techniques/T1114/001",tactics:"collection",techniqueId:"T1114",value:"localEmailCollection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localGroupsT1069Description",{defaultMessage:"Local Groups (T1069.001)"}),id:"T1069.001",name:"Local Groups",reference:"https://attack.mitre.org/techniques/T1069/001",tactics:"discovery",techniqueId:"T1069",value:"localGroups"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.loginHookT1037Description",{defaultMessage:"Login Hook (T1037.002)"}),id:"T1037.002",name:"Login Hook",reference:"https://attack.mitre.org/techniques/T1037/002",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"loginHook"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.loginItemsT1547Description",{defaultMessage:"Login Items (T1547.015)"}),id:"T1547.015",name:"Login Items",reference:"https://attack.mitre.org/techniques/T1547/015",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"loginItems"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.logonScriptWindowsT1037Description",{defaultMessage:"Logon Script (Windows) (T1037.001)"}),id:"T1037.001",name:"Logon Script (Windows)",reference:"https://attack.mitre.org/techniques/T1037/001",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"logonScriptWindows"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mmcT1218Description",{defaultMessage:"MMC (T1218.014)"}),id:"T1218.014",name:"MMC",reference:"https://attack.mitre.org/techniques/T1218/014",tactics:"defense-evasion",techniqueId:"T1218",value:"mmc"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.msBuildT1127Description",{defaultMessage:"MSBuild (T1127.001)"}),id:"T1127.001",name:"MSBuild",reference:"https://attack.mitre.org/techniques/T1127/001",tactics:"defense-evasion",techniqueId:"T1127",value:"msBuild"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mailProtocolsT1071Description",{defaultMessage:"Mail Protocols (T1071.003)"}),id:"T1071.003",name:"Mail Protocols",reference:"https://attack.mitre.org/techniques/T1071/003",tactics:"command-and-control",techniqueId:"T1071",value:"mailProtocols"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.makeAndImpersonateTokenT1134Description",{defaultMessage:"Make and Impersonate Token (T1134.003)"}),id:"T1134.003",name:"Make and Impersonate Token",reference:"https://attack.mitre.org/techniques/T1134/003",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"makeAndImpersonateToken"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousFileT1204Description",{defaultMessage:"Malicious File (T1204.002)"}),id:"T1204.002",name:"Malicious File",reference:"https://attack.mitre.org/techniques/T1204/002",tactics:"execution",techniqueId:"T1204",value:"maliciousFile"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousImageT1204Description",{defaultMessage:"Malicious Image (T1204.003)"}),id:"T1204.003",name:"Malicious Image",reference:"https://attack.mitre.org/techniques/T1204/003",tactics:"execution",techniqueId:"T1204",value:"maliciousImage"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousLinkT1204Description",{defaultMessage:"Malicious Link (T1204.001)"}),id:"T1204.001",name:"Malicious Link",reference:"https://attack.mitre.org/techniques/T1204/001",tactics:"execution",techniqueId:"T1204",value:"maliciousLink"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.malwareT1587Description",{defaultMessage:"Malware (T1587.001)"}),id:"T1587.001",name:"Malware",reference:"https://attack.mitre.org/techniques/T1587/001",tactics:"resource-development",techniqueId:"T1587",value:"malware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.malwareT1588Description",{defaultMessage:"Malware (T1588.001)"}),id:"T1588.001",name:"Malware",reference:"https://attack.mitre.org/techniques/T1588/001",tactics:"resource-development",techniqueId:"T1588",value:"malware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.markOfTheWebBypassT1553Description",{defaultMessage:"Mark-of-the-Web Bypass (T1553.005)"}),id:"T1553.005",name:"Mark-of-the-Web Bypass",reference:"https://attack.mitre.org/techniques/T1553/005",tactics:"defense-evasion",techniqueId:"T1553",value:"markOfTheWebBypass"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.masqueradeTaskOrServiceT1036Description",{defaultMessage:"Masquerade Task or Service (T1036.004)"}),id:"T1036.004",name:"Masquerade Task or Service",reference:"https://attack.mitre.org/techniques/T1036/004",tactics:"defense-evasion",techniqueId:"T1036",value:"masqueradeTaskOrService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.matchLegitimateNameOrLocationT1036Description",{defaultMessage:"Match Legitimate Name or Location (T1036.005)"}),id:"T1036.005",name:"Match Legitimate Name or Location",reference:"https://attack.mitre.org/techniques/T1036/005",tactics:"defense-evasion",techniqueId:"T1036",value:"matchLegitimateNameOrLocation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mavinjectT1218Description",{defaultMessage:"Mavinject (T1218.013)"}),id:"T1218.013",name:"Mavinject",reference:"https://attack.mitre.org/techniques/T1218/013",tactics:"defense-evasion",techniqueId:"T1218",value:"mavinject"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mshtaT1218Description",{defaultMessage:"Mshta (T1218.005)"}),id:"T1218.005",name:"Mshta",reference:"https://attack.mitre.org/techniques/T1218/005",tactics:"defense-evasion",techniqueId:"T1218",value:"mshta"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.msiexecT1218Description",{defaultMessage:"Msiexec (T1218.007)"}),id:"T1218.007",name:"Msiexec",reference:"https://attack.mitre.org/techniques/T1218/007",tactics:"defense-evasion",techniqueId:"T1218",value:"msiexec"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.multiHopProxyT1090Description",{defaultMessage:"Multi-hop Proxy (T1090.003)"}),id:"T1090.003",name:"Multi-hop Proxy",reference:"https://attack.mitre.org/techniques/T1090/003",tactics:"command-and-control",techniqueId:"T1090",value:"multiHopProxy"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ntdsT1003Description",{defaultMessage:"NTDS (T1003.003)"}),id:"T1003.003",name:"NTDS",reference:"https://attack.mitre.org/techniques/T1003/003",tactics:"credential-access",techniqueId:"T1003",value:"ntds"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ntfsFileAttributesT1564Description",{defaultMessage:"NTFS File Attributes (T1564.004)"}),id:"T1564.004",name:"NTFS File Attributes",reference:"https://attack.mitre.org/techniques/T1564/004",tactics:"defense-evasion",techniqueId:"T1564",value:"ntfsFileAttributes"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.netshHelperDllT1546Description",{defaultMessage:"Netsh Helper DLL (T1546.007)"}),id:"T1546.007",name:"Netsh Helper DLL",reference:"https://attack.mitre.org/techniques/T1546/007",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"netshHelperDll"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkAddressTranslationTraversalT1599Description",{defaultMessage:"Network Address Translation Traversal (T1599.001)"}),id:"T1599.001",name:"Network Address Translation Traversal",reference:"https://attack.mitre.org/techniques/T1599/001",tactics:"defense-evasion",techniqueId:"T1599",value:"networkAddressTranslationTraversal"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceAuthenticationT1556Description",{defaultMessage:"Network Device Authentication (T1556.004)"}),id:"T1556.004",name:"Network Device Authentication",reference:"https://attack.mitre.org/techniques/T1556/004",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"networkDeviceAuthentication"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceCliT1059Description",{defaultMessage:"Network Device CLI (T1059.008)"}),id:"T1059.008",name:"Network Device CLI",reference:"https://attack.mitre.org/techniques/T1059/008",tactics:"execution",techniqueId:"T1059",value:"networkDeviceCli"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceConfigurationDumpT1602Description",{defaultMessage:"Network Device Configuration Dump (T1602.002)"}),id:"T1602.002",name:"Network Device Configuration Dump",reference:"https://attack.mitre.org/techniques/T1602/002",tactics:"collection",techniqueId:"T1602",value:"networkDeviceConfigurationDump"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkLogonScriptT1037Description",{defaultMessage:"Network Logon Script (T1037.003)"}),id:"T1037.003",name:"Network Logon Script",reference:"https://attack.mitre.org/techniques/T1037/003",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"networkLogonScript"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkSecurityAppliancesT1590Description",{defaultMessage:"Network Security Appliances (T1590.006)"}),id:"T1590.006",name:"Network Security Appliances",reference:"https://attack.mitre.org/techniques/T1590/006",tactics:"reconnaissance",techniqueId:"T1590",value:"networkSecurityAppliances"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkShareConnectionRemovalT1070Description",{defaultMessage:"Network Share Connection Removal (T1070.005)"}),id:"T1070.005",name:"Network Share Connection Removal",reference:"https://attack.mitre.org/techniques/T1070/005",tactics:"defense-evasion",techniqueId:"T1070",value:"networkShareConnectionRemoval"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkTopologyT1590Description",{defaultMessage:"Network Topology (T1590.004)"}),id:"T1590.004",name:"Network Topology",reference:"https://attack.mitre.org/techniques/T1590/004",tactics:"reconnaissance",techniqueId:"T1590",value:"networkTopology"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkTrustDependenciesT1590Description",{defaultMessage:"Network Trust Dependencies (T1590.003)"}),id:"T1590.003",name:"Network Trust Dependencies",reference:"https://attack.mitre.org/techniques/T1590/003",tactics:"reconnaissance",techniqueId:"T1590",value:"networkTrustDependencies"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.nonStandardEncodingT1132Description",{defaultMessage:"Non-Standard Encoding (T1132.002)"}),id:"T1132.002",name:"Non-Standard Encoding",reference:"https://attack.mitre.org/techniques/T1132/002",tactics:"command-and-control",techniqueId:"T1132",value:"nonStandardEncoding"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.osExhaustionFloodT1499Description",{defaultMessage:"OS Exhaustion Flood (T1499.001)"}),id:"T1499.001",name:"OS Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/001",tactics:"impact",techniqueId:"T1499",value:"osExhaustionFlood"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.odbcconfT1218Description",{defaultMessage:"Odbcconf (T1218.008)"}),id:"T1218.008",name:"Odbcconf",reference:"https://attack.mitre.org/techniques/T1218/008",tactics:"defense-evasion",techniqueId:"T1218",value:"odbcconf"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.officeTemplateMacrosT1137Description",{defaultMessage:"Office Template Macros (T1137.001)"}),id:"T1137.001",name:"Office Template Macros",reference:"https://attack.mitre.org/techniques/T1137/001",tactics:"persistence",techniqueId:"T1137",value:"officeTemplateMacros"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.officeTestT1137Description",{defaultMessage:"Office Test (T1137.002)"}),id:"T1137.002",name:"Office Test",reference:"https://attack.mitre.org/techniques/T1137/002",tactics:"persistence",techniqueId:"T1137",value:"officeTest"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.oneWayCommunicationT1102Description",{defaultMessage:"One-Way Communication (T1102.003)"}),id:"T1102.003",name:"One-Way Communication",reference:"https://attack.mitre.org/techniques/T1102/003",tactics:"command-and-control",techniqueId:"T1102",value:"oneWayCommunication"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookFormsT1137Description",{defaultMessage:"Outlook Forms (T1137.003)"}),id:"T1137.003",name:"Outlook Forms",reference:"https://attack.mitre.org/techniques/T1137/003",tactics:"persistence",techniqueId:"T1137",value:"outlookForms"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookHomePageT1137Description",{defaultMessage:"Outlook Home Page (T1137.004)"}),id:"T1137.004",name:"Outlook Home Page",reference:"https://attack.mitre.org/techniques/T1137/004",tactics:"persistence",techniqueId:"T1137",value:"outlookHomePage"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookRulesT1137Description",{defaultMessage:"Outlook Rules (T1137.005)"}),id:"T1137.005",name:"Outlook Rules",reference:"https://attack.mitre.org/techniques/T1137/005",tactics:"persistence",techniqueId:"T1137",value:"outlookRules"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.parentPidSpoofingT1134Description",{defaultMessage:"Parent PID Spoofing (T1134.004)"}),id:"T1134.004",name:"Parent PID Spoofing",reference:"https://attack.mitre.org/techniques/T1134/004",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"parentPidSpoofing"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passTheHashT1550Description",{defaultMessage:"Pass the Hash (T1550.002)"}),id:"T1550.002",name:"Pass the Hash",reference:"https://attack.mitre.org/techniques/T1550/002",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"passTheHash"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passTheTicketT1550Description",{defaultMessage:"Pass the Ticket (T1550.003)"}),id:"T1550.003",name:"Pass the Ticket",reference:"https://attack.mitre.org/techniques/T1550/003",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"passTheTicket"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordCrackingT1110Description",{defaultMessage:"Password Cracking (T1110.002)"}),id:"T1110.002",name:"Password Cracking",reference:"https://attack.mitre.org/techniques/T1110/002",tactics:"credential-access",techniqueId:"T1110",value:"passwordCracking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordFilterDllT1556Description",{defaultMessage:"Password Filter DLL (T1556.002)"}),id:"T1556.002",name:"Password Filter DLL",reference:"https://attack.mitre.org/techniques/T1556/002",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"passwordFilterDll"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordGuessingT1110Description",{defaultMessage:"Password Guessing (T1110.001)"}),id:"T1110.001",name:"Password Guessing",reference:"https://attack.mitre.org/techniques/T1110/001",tactics:"credential-access",techniqueId:"T1110",value:"passwordGuessing"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordManagersT1555Description",{defaultMessage:"Password Managers (T1555.005)"}),id:"T1555.005",name:"Password Managers",reference:"https://attack.mitre.org/techniques/T1555/005",tactics:"credential-access",techniqueId:"T1555",value:"passwordManagers"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordSprayingT1110Description",{defaultMessage:"Password Spraying (T1110.003)"}),id:"T1110.003",name:"Password Spraying",reference:"https://attack.mitre.org/techniques/T1110/003",tactics:"credential-access",techniqueId:"T1110",value:"passwordSpraying"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.patchSystemImageT1601Description",{defaultMessage:"Patch System Image (T1601.001)"}),id:"T1601.001",name:"Patch System Image",reference:"https://attack.mitre.org/techniques/T1601/001",tactics:"defense-evasion",techniqueId:"T1601",value:"patchSystemImage"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionByPathEnvironmentVariableT1574Description",{defaultMessage:"Path Interception by PATH Environment Variable (T1574.007)"}),id:"T1574.007",name:"Path Interception by PATH Environment Variable",reference:"https://attack.mitre.org/techniques/T1574/007",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionByPathEnvironmentVariable"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionBySearchOrderHijackingT1574Description",{defaultMessage:"Path Interception by Search Order Hijacking (T1574.008)"}),id:"T1574.008",name:"Path Interception by Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1574/008",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionBySearchOrderHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionByUnquotedPathT1574Description",{defaultMessage:"Path Interception by Unquoted Path (T1574.009)"}),id:"T1574.009",name:"Path Interception by Unquoted Path",reference:"https://attack.mitre.org/techniques/T1574/009",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionByUnquotedPath"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.plistModificationT1547Description",{defaultMessage:"Plist Modification (T1547.011)"}),id:"T1547.011",name:"Plist Modification",reference:"https://attack.mitre.org/techniques/T1547/011",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"plistModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pluggableAuthenticationModulesT1556Description",{defaultMessage:"Pluggable Authentication Modules (T1556.003)"}),id:"T1556.003",name:"Pluggable Authentication Modules",reference:"https://attack.mitre.org/techniques/T1556/003",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"pluggableAuthenticationModules"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portKnockingT1205Description",{defaultMessage:"Port Knocking (T1205.001)"}),id:"T1205.001",name:"Port Knocking",reference:"https://attack.mitre.org/techniques/T1205/001",tactics:"defense-evasion,persistence,command-and-control",techniqueId:"T1205",value:"portKnocking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portMonitorsT1547Description",{defaultMessage:"Port Monitors (T1547.010)"}),id:"T1547.010",name:"Port Monitors",reference:"https://attack.mitre.org/techniques/T1547/010",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"portMonitors"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portableExecutableInjectionT1055Description",{defaultMessage:"Portable Executable Injection (T1055.002)"}),id:"T1055.002",name:"Portable Executable Injection",reference:"https://attack.mitre.org/techniques/T1055/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"portableExecutableInjection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.powerShellT1059Description",{defaultMessage:"PowerShell (T1059.001)"}),id:"T1059.001",name:"PowerShell",reference:"https://attack.mitre.org/techniques/T1059/001",tactics:"execution",techniqueId:"T1059",value:"powerShell"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.powerShellProfileT1546Description",{defaultMessage:"PowerShell Profile (T1546.013)"}),id:"T1546.013",name:"PowerShell Profile",reference:"https://attack.mitre.org/techniques/T1546/013",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"powerShellProfile"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.printProcessorsT1547Description",{defaultMessage:"Print Processors (T1547.012)"}),id:"T1547.012",name:"Print Processors",reference:"https://attack.mitre.org/techniques/T1547/012",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"printProcessors"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.privateKeysT1552Description",{defaultMessage:"Private Keys (T1552.004)"}),id:"T1552.004",name:"Private Keys",reference:"https://attack.mitre.org/techniques/T1552/004",tactics:"credential-access",techniqueId:"T1552",value:"privateKeys"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.procFilesystemT1003Description",{defaultMessage:"Proc Filesystem (T1003.007)"}),id:"T1003.007",name:"Proc Filesystem",reference:"https://attack.mitre.org/techniques/T1003/007",tactics:"credential-access",techniqueId:"T1003",value:"procFilesystem"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.procMemoryT1055Description",{defaultMessage:"Proc Memory (T1055.009)"}),id:"T1055.009",name:"Proc Memory",reference:"https://attack.mitre.org/techniques/T1055/009",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"procMemory"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.processArgumentSpoofingT1564Description",{defaultMessage:"Process Argument Spoofing (T1564.010)"}),id:"T1564.010",name:"Process Argument Spoofing",reference:"https://attack.mitre.org/techniques/T1564/010",tactics:"defense-evasion",techniqueId:"T1564",value:"processArgumentSpoofing"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.processDoppelgangingT1055Description",{defaultMessage:"Process Doppelgänging (T1055.013)"}),id:"T1055.013",name:"Process Doppelgänging",reference:"https://attack.mitre.org/techniques/T1055/013",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"processDoppelganging"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.processHollowingT1055Description",{defaultMessage:"Process Hollowing (T1055.012)"}),id:"T1055.012",name:"Process Hollowing",reference:"https://attack.mitre.org/techniques/T1055/012",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"processHollowing"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.protocolImpersonationT1001Description",{defaultMessage:"Protocol Impersonation (T1001.003)"}),id:"T1001.003",name:"Protocol Impersonation",reference:"https://attack.mitre.org/techniques/T1001/003",tactics:"command-and-control",techniqueId:"T1001",value:"protocolImpersonation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ptraceSystemCallsT1055Description",{defaultMessage:"Ptrace System Calls (T1055.008)"}),id:"T1055.008",name:"Ptrace System Calls",reference:"https://attack.mitre.org/techniques/T1055/008",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"ptraceSystemCalls"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pubPrnT1216Description",{defaultMessage:"PubPrn (T1216.001)"}),id:"T1216.001",name:"PubPrn",reference:"https://attack.mitre.org/techniques/T1216/001",tactics:"defense-evasion",techniqueId:"T1216",value:"pubPrn"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.purchaseTechnicalDataT1597Description",{defaultMessage:"Purchase Technical Data (T1597.002)"}),id:"T1597.002",name:"Purchase Technical Data",reference:"https://attack.mitre.org/techniques/T1597/002",tactics:"reconnaissance",techniqueId:"T1597",value:"purchaseTechnicalData"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pythonT1059Description",{defaultMessage:"Python (T1059.006)"}),id:"T1059.006",name:"Python",reference:"https://attack.mitre.org/techniques/T1059/006",tactics:"execution",techniqueId:"T1059",value:"python"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rcScriptsT1037Description",{defaultMessage:"RC Scripts (T1037.004)"}),id:"T1037.004",name:"RC Scripts",reference:"https://attack.mitre.org/techniques/T1037/004",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"rcScripts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rdpHijackingT1563Description",{defaultMessage:"RDP Hijacking (T1563.002)"}),id:"T1563.002",name:"RDP Hijacking",reference:"https://attack.mitre.org/techniques/T1563/002",tactics:"lateral-movement",techniqueId:"T1563",value:"rdpHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rommoNkitT1542Description",{defaultMessage:"ROMMONkit (T1542.004)"}),id:"T1542.004",name:"ROMMONkit",reference:"https://attack.mitre.org/techniques/T1542/004",tactics:"defense-evasion,persistence",techniqueId:"T1542",value:"rommoNkit"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reOpenedApplicationsT1547Description",{defaultMessage:"Re-opened Applications (T1547.007)"}),id:"T1547.007",name:"Re-opened Applications",reference:"https://attack.mitre.org/techniques/T1547/007",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"reOpenedApplications"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reduceKeySpaceT1600Description",{defaultMessage:"Reduce Key Space (T1600.001)"}),id:"T1600.001",name:"Reduce Key Space",reference:"https://attack.mitre.org/techniques/T1600/001",tactics:"defense-evasion",techniqueId:"T1600",value:"reduceKeySpace"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reflectionAmplificationT1498Description",{defaultMessage:"Reflection Amplification (T1498.002)"}),id:"T1498.002",name:"Reflection Amplification",reference:"https://attack.mitre.org/techniques/T1498/002",tactics:"impact",techniqueId:"T1498",value:"reflectionAmplification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.registryRunKeysStartupFolderT1547Description",{defaultMessage:"Registry Run Keys / Startup Folder (T1547.001)"}),id:"T1547.001",name:"Registry Run Keys / Startup Folder",reference:"https://attack.mitre.org/techniques/T1547/001",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"registryRunKeysStartupFolder"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.regsvcsRegasmT1218Description",{defaultMessage:"Regsvcs/Regasm (T1218.009)"}),id:"T1218.009",name:"Regsvcs/Regasm",reference:"https://attack.mitre.org/techniques/T1218/009",tactics:"defense-evasion",techniqueId:"T1218",value:"regsvcsRegasm"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.regsvr32T1218Description",{defaultMessage:"Regsvr32 (T1218.010)"}),id:"T1218.010",name:"Regsvr32",reference:"https://attack.mitre.org/techniques/T1218/010",tactics:"defense-evasion",techniqueId:"T1218",value:"regsvr32"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteDataStagingT1074Description",{defaultMessage:"Remote Data Staging (T1074.002)"}),id:"T1074.002",name:"Remote Data Staging",reference:"https://attack.mitre.org/techniques/T1074/002",tactics:"collection",techniqueId:"T1074",value:"remoteDataStaging"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteDesktopProtocolT1021Description",{defaultMessage:"Remote Desktop Protocol (T1021.001)"}),id:"T1021.001",name:"Remote Desktop Protocol",reference:"https://attack.mitre.org/techniques/T1021/001",tactics:"lateral-movement",techniqueId:"T1021",value:"remoteDesktopProtocol"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteEmailCollectionT1114Description",{defaultMessage:"Remote Email Collection (T1114.002)"}),id:"T1114.002",name:"Remote Email Collection",reference:"https://attack.mitre.org/techniques/T1114/002",tactics:"collection",techniqueId:"T1114",value:"remoteEmailCollection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.renameSystemUtilitiesT1036Description",{defaultMessage:"Rename System Utilities (T1036.003)"}),id:"T1036.003",name:"Rename System Utilities",reference:"https://attack.mitre.org/techniques/T1036/003",tactics:"defense-evasion",techniqueId:"T1036",value:"renameSystemUtilities"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.resourceForkingT1564Description",{defaultMessage:"Resource Forking (T1564.009)"}),id:"T1564.009",name:"Resource Forking",reference:"https://attack.mitre.org/techniques/T1564/009",tactics:"defense-evasion",techniqueId:"T1564",value:"resourceForking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reversibleEncryptionT1556Description",{defaultMessage:"Reversible Encryption (T1556.005)"}),id:"T1556.005",name:"Reversible Encryption",reference:"https://attack.mitre.org/techniques/T1556/005",tactics:"credential-access,defense-evasion,persistence",techniqueId:"T1556",value:"reversibleEncryption"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.revertCloudInstanceT1578Description",{defaultMessage:"Revert Cloud Instance (T1578.004)"}),id:"T1578.004",name:"Revert Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/004",tactics:"defense-evasion",techniqueId:"T1578",value:"revertCloudInstance"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rightToLeftOverrideT1036Description",{defaultMessage:"Right-to-Left Override (T1036.002)"}),id:"T1036.002",name:"Right-to-Left Override",reference:"https://attack.mitre.org/techniques/T1036/002",tactics:"defense-evasion",techniqueId:"T1036",value:"rightToLeftOverride"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.runVirtualInstanceT1564Description",{defaultMessage:"Run Virtual Instance (T1564.006)"}),id:"T1564.006",name:"Run Virtual Instance",reference:"https://attack.mitre.org/techniques/T1564/006",tactics:"defense-evasion",techniqueId:"T1564",value:"runVirtualInstance"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rundll32T1218Description",{defaultMessage:"Rundll32 (T1218.011)"}),id:"T1218.011",name:"Rundll32",reference:"https://attack.mitre.org/techniques/T1218/011",tactics:"defense-evasion",techniqueId:"T1218",value:"rundll32"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.runtimeDataManipulationT1565Description",{defaultMessage:"Runtime Data Manipulation (T1565.003)"}),id:"T1565.003",name:"Runtime Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/003",tactics:"impact",techniqueId:"T1565",value:"runtimeDataManipulation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.samlTokensT1606Description",{defaultMessage:"SAML Tokens (T1606.002)"}),id:"T1606.002",name:"SAML Tokens",reference:"https://attack.mitre.org/techniques/T1606/002",tactics:"credential-access",techniqueId:"T1606",value:"samlTokens"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sidHistoryInjectionT1134Description",{defaultMessage:"SID-History Injection (T1134.005)"}),id:"T1134.005",name:"SID-History Injection",reference:"https://attack.mitre.org/techniques/T1134/005",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"sidHistoryInjection"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sipAndTrustProviderHijackingT1553Description",{defaultMessage:"SIP and Trust Provider Hijacking (T1553.003)"}),id:"T1553.003",name:"SIP and Trust Provider Hijacking",reference:"https://attack.mitre.org/techniques/T1553/003",tactics:"defense-evasion",techniqueId:"T1553",value:"sipAndTrustProviderHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.smbWindowsAdminSharesT1021Description",{defaultMessage:"SMB/Windows Admin Shares (T1021.002)"}),id:"T1021.002",name:"SMB/Windows Admin Shares",reference:"https://attack.mitre.org/techniques/T1021/002",tactics:"lateral-movement",techniqueId:"T1021",value:"smbWindowsAdminShares"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.snmpMibDumpT1602Description",{defaultMessage:"SNMP (MIB Dump) (T1602.001)"}),id:"T1602.001",name:"SNMP (MIB Dump)",reference:"https://attack.mitre.org/techniques/T1602/001",tactics:"collection",techniqueId:"T1602",value:"snmpMibDump"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sqlStoredProceduresT1505Description",{defaultMessage:"SQL Stored Procedures (T1505.001)"}),id:"T1505.001",name:"SQL Stored Procedures",reference:"https://attack.mitre.org/techniques/T1505/001",tactics:"persistence",techniqueId:"T1505",value:"sqlStoredProcedures"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshT1021Description",{defaultMessage:"SSH (T1021.004)"}),id:"T1021.004",name:"SSH",reference:"https://attack.mitre.org/techniques/T1021/004",tactics:"lateral-movement",techniqueId:"T1021",value:"ssh"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshAuthorizedKeysT1098Description",{defaultMessage:"SSH Authorized Keys (T1098.004)"}),id:"T1098.004",name:"SSH Authorized Keys",reference:"https://attack.mitre.org/techniques/T1098/004",tactics:"persistence",techniqueId:"T1098",value:"sshAuthorizedKeys"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshHijackingT1563Description",{defaultMessage:"SSH Hijacking (T1563.001)"}),id:"T1563.001",name:"SSH Hijacking",reference:"https://attack.mitre.org/techniques/T1563/001",tactics:"lateral-movement",techniqueId:"T1563",value:"sshHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.safeModeBootT1562Description",{defaultMessage:"Safe Mode Boot (T1562.009)"}),id:"T1562.009",name:"Safe Mode Boot",reference:"https://attack.mitre.org/techniques/T1562/009",tactics:"defense-evasion",techniqueId:"T1562",value:"safeModeBoot"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scanDatabasesT1596Description",{defaultMessage:"Scan Databases (T1596.005)"}),id:"T1596.005",name:"Scan Databases",reference:"https://attack.mitre.org/techniques/T1596/005",tactics:"reconnaissance",techniqueId:"T1596",value:"scanDatabases"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scanningIpBlocksT1595Description",{defaultMessage:"Scanning IP Blocks (T1595.001)"}),id:"T1595.001",name:"Scanning IP Blocks",reference:"https://attack.mitre.org/techniques/T1595/001",tactics:"reconnaissance",techniqueId:"T1595",value:"scanningIpBlocks"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scheduledTaskT1053Description",{defaultMessage:"Scheduled Task (T1053.005)"}),id:"T1053.005",name:"Scheduled Task",reference:"https://attack.mitre.org/techniques/T1053/005",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"scheduledTask"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.screensaverT1546Description",{defaultMessage:"Screensaver (T1546.002)"}),id:"T1546.002",name:"Screensaver",reference:"https://attack.mitre.org/techniques/T1546/002",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"screensaver"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.searchEnginesT1593Description",{defaultMessage:"Search Engines (T1593.002)"}),id:"T1593.002",name:"Search Engines",reference:"https://attack.mitre.org/techniques/T1593/002",tactics:"reconnaissance",techniqueId:"T1593",value:"searchEngines"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securityAccountManagerT1003Description",{defaultMessage:"Security Account Manager (T1003.002)"}),id:"T1003.002",name:"Security Account Manager",reference:"https://attack.mitre.org/techniques/T1003/002",tactics:"credential-access",techniqueId:"T1003",value:"securityAccountManager"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitySoftwareDiscoveryT1518Description",{defaultMessage:"Security Software Discovery (T1518.001)"}),id:"T1518.001",name:"Security Software Discovery",reference:"https://attack.mitre.org/techniques/T1518/001",tactics:"discovery",techniqueId:"T1518",value:"securitySoftwareDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitySupportProviderT1547Description",{defaultMessage:"Security Support Provider (T1547.005)"}),id:"T1547.005",name:"Security Support Provider",reference:"https://attack.mitre.org/techniques/T1547/005",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"securitySupportProvider"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitydMemoryT1555Description",{defaultMessage:"Securityd Memory (T1555.002)"}),id:"T1555.002",name:"Securityd Memory",reference:"https://attack.mitre.org/techniques/T1555/002",tactics:"credential-access",techniqueId:"T1555",value:"securitydMemory"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serverT1583Description",{defaultMessage:"Server (T1583.004)"}),id:"T1583.004",name:"Server",reference:"https://attack.mitre.org/techniques/T1583/004",tactics:"resource-development",techniqueId:"T1583",value:"server"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serverT1584Description",{defaultMessage:"Server (T1584.004)"}),id:"T1584.004",name:"Server",reference:"https://attack.mitre.org/techniques/T1584/004",tactics:"resource-development",techniqueId:"T1584",value:"server"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serviceExecutionT1569Description",{defaultMessage:"Service Execution (T1569.002)"}),id:"T1569.002",name:"Service Execution",reference:"https://attack.mitre.org/techniques/T1569/002",tactics:"execution",techniqueId:"T1569",value:"serviceExecution"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serviceExhaustionFloodT1499Description",{defaultMessage:"Service Exhaustion Flood (T1499.002)"}),id:"T1499.002",name:"Service Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/002",tactics:"impact",techniqueId:"T1499",value:"serviceExhaustionFlood"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.servicesFilePermissionsWeaknessT1574Description",{defaultMessage:"Services File Permissions Weakness (T1574.010)"}),id:"T1574.010",name:"Services File Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/010",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"servicesFilePermissionsWeakness"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.servicesRegistryPermissionsWeaknessT1574Description",{defaultMessage:"Services Registry Permissions Weakness (T1574.011)"}),id:"T1574.011",name:"Services Registry Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/011",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"servicesRegistryPermissionsWeakness"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.setuidAndSetgidT1548Description",{defaultMessage:"Setuid and Setgid (T1548.001)"}),id:"T1548.001",name:"Setuid and Setgid",reference:"https://attack.mitre.org/techniques/T1548/001",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"setuidAndSetgid"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sharepointT1213Description",{defaultMessage:"Sharepoint (T1213.002)"}),id:"T1213.002",name:"Sharepoint",reference:"https://attack.mitre.org/techniques/T1213/002",tactics:"collection",techniqueId:"T1213",value:"sharepoint"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.shortcutModificationT1547Description",{defaultMessage:"Shortcut Modification (T1547.009)"}),id:"T1547.009",name:"Shortcut Modification",reference:"https://attack.mitre.org/techniques/T1547/009",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"shortcutModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.silverTicketT1558Description",{defaultMessage:"Silver Ticket (T1558.002)"}),id:"T1558.002",name:"Silver Ticket",reference:"https://attack.mitre.org/techniques/T1558/002",tactics:"credential-access",techniqueId:"T1558",value:"silverTicket"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaT1593Description",{defaultMessage:"Social Media (T1593.001)"}),id:"T1593.001",name:"Social Media",reference:"https://attack.mitre.org/techniques/T1593/001",tactics:"reconnaissance",techniqueId:"T1593",value:"socialMedia"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaAccountsT1586Description",{defaultMessage:"Social Media Accounts (T1586.001)"}),id:"T1586.001",name:"Social Media Accounts",reference:"https://attack.mitre.org/techniques/T1586/001",tactics:"resource-development",techniqueId:"T1586",value:"socialMediaAccounts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaAccountsT1585Description",{defaultMessage:"Social Media Accounts (T1585.001)"}),id:"T1585.001",name:"Social Media Accounts",reference:"https://attack.mitre.org/techniques/T1585/001",tactics:"resource-development",techniqueId:"T1585",value:"socialMediaAccounts"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.softwareT1592Description",{defaultMessage:"Software (T1592.002)"}),id:"T1592.002",name:"Software",reference:"https://attack.mitre.org/techniques/T1592/002",tactics:"reconnaissance",techniqueId:"T1592",value:"software"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.softwarePackingT1027Description",{defaultMessage:"Software Packing (T1027.002)"}),id:"T1027.002",name:"Software Packing",reference:"https://attack.mitre.org/techniques/T1027/002",tactics:"defense-evasion",techniqueId:"T1027",value:"softwarePacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spaceAfterFilenameT1036Description",{defaultMessage:"Space after Filename (T1036.006)"}),id:"T1036.006",name:"Space after Filename",reference:"https://attack.mitre.org/techniques/T1036/006",tactics:"defense-evasion",techniqueId:"T1036",value:"spaceAfterFilename"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingAttachmentT1566Description",{defaultMessage:"Spearphishing Attachment (T1566.001)"}),id:"T1566.001",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1566/001",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingAttachment"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingAttachmentT1598Description",{defaultMessage:"Spearphishing Attachment (T1598.002)"}),id:"T1598.002",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1598/002",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingAttachment"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingLinkT1566Description",{defaultMessage:"Spearphishing Link (T1566.002)"}),id:"T1566.002",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1566/002",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingLink"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingLinkT1598Description",{defaultMessage:"Spearphishing Link (T1598.003)"}),id:"T1598.003",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1598/003",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingLink"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingServiceT1598Description",{defaultMessage:"Spearphishing Service (T1598.001)"}),id:"T1598.001",name:"Spearphishing Service",reference:"https://attack.mitre.org/techniques/T1598/001",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingViaServiceT1566Description",{defaultMessage:"Spearphishing via Service (T1566.003)"}),id:"T1566.003",name:"Spearphishing via Service",reference:"https://attack.mitre.org/techniques/T1566/003",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingViaService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.standardEncodingT1132Description",{defaultMessage:"Standard Encoding (T1132.001)"}),id:"T1132.001",name:"Standard Encoding",reference:"https://attack.mitre.org/techniques/T1132/001",tactics:"command-and-control",techniqueId:"T1132",value:"standardEncoding"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.startupItemsT1037Description",{defaultMessage:"Startup Items (T1037.005)"}),id:"T1037.005",name:"Startup Items",reference:"https://attack.mitre.org/techniques/T1037/005",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"startupItems"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.steganographyT1027Description",{defaultMessage:"Steganography (T1027.003)"}),id:"T1027.003",name:"Steganography",reference:"https://attack.mitre.org/techniques/T1027/003",tactics:"defense-evasion",techniqueId:"T1027",value:"steganography"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.steganographyT1001Description",{defaultMessage:"Steganography (T1001.002)"}),id:"T1001.002",name:"Steganography",reference:"https://attack.mitre.org/techniques/T1001/002",tactics:"command-and-control",techniqueId:"T1001",value:"steganography"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.storedDataManipulationT1565Description",{defaultMessage:"Stored Data Manipulation (T1565.001)"}),id:"T1565.001",name:"Stored Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/001",tactics:"impact",techniqueId:"T1565",value:"storedDataManipulation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sudoAndSudoCachingT1548Description",{defaultMessage:"Sudo and Sudo Caching (T1548.003)"}),id:"T1548.003",name:"Sudo and Sudo Caching",reference:"https://attack.mitre.org/techniques/T1548/003",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"sudoAndSudoCaching"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.symmetricCryptographyT1573Description",{defaultMessage:"Symmetric Cryptography (T1573.001)"}),id:"T1573.001",name:"Symmetric Cryptography",reference:"https://attack.mitre.org/techniques/T1573/001",tactics:"command-and-control",techniqueId:"T1573",value:"symmetricCryptography"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemChecksT1497Description",{defaultMessage:"System Checks (T1497.001)"}),id:"T1497.001",name:"System Checks",reference:"https://attack.mitre.org/techniques/T1497/001",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"systemChecks"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemFirmwareT1542Description",{defaultMessage:"System Firmware (T1542.001)"}),id:"T1542.001",name:"System Firmware",reference:"https://attack.mitre.org/techniques/T1542/001",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"systemFirmware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemLanguageDiscoveryT1614Description",{defaultMessage:"System Language Discovery (T1614.001)"}),id:"T1614.001",name:"System Language Discovery",reference:"https://attack.mitre.org/techniques/T1614/001",tactics:"discovery",techniqueId:"T1614",value:"systemLanguageDiscovery"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemdServiceT1543Description",{defaultMessage:"Systemd Service (T1543.002)"}),id:"T1543.002",name:"Systemd Service",reference:"https://attack.mitre.org/techniques/T1543/002",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"systemdService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemdTimersT1053Description",{defaultMessage:"Systemd Timers (T1053.006)"}),id:"T1053.006",name:"Systemd Timers",reference:"https://attack.mitre.org/techniques/T1053/006",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"systemdTimers"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.tftpBootT1542Description",{defaultMessage:"TFTP Boot (T1542.005)"}),id:"T1542.005",name:"TFTP Boot",reference:"https://attack.mitre.org/techniques/T1542/005",tactics:"defense-evasion,persistence",techniqueId:"T1542",value:"tftpBoot"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.terminalServicesDllT1505Description",{defaultMessage:"Terminal Services DLL (T1505.005)"}),id:"T1505.005",name:"Terminal Services DLL",reference:"https://attack.mitre.org/techniques/T1505/005",tactics:"persistence",techniqueId:"T1505",value:"terminalServicesDll"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threadExecutionHijackingT1055Description",{defaultMessage:"Thread Execution Hijacking (T1055.003)"}),id:"T1055.003",name:"Thread Execution Hijacking",reference:"https://attack.mitre.org/techniques/T1055/003",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"threadExecutionHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threadLocalStorageT1055Description",{defaultMessage:"Thread Local Storage (T1055.005)"}),id:"T1055.005",name:"Thread Local Storage",reference:"https://attack.mitre.org/techniques/T1055/005",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"threadLocalStorage"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threatIntelVendorsT1597Description",{defaultMessage:"Threat Intel Vendors (T1597.001)"}),id:"T1597.001",name:"Threat Intel Vendors",reference:"https://attack.mitre.org/techniques/T1597/001",tactics:"reconnaissance",techniqueId:"T1597",value:"threatIntelVendors"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timeBasedEvasionT1497Description",{defaultMessage:"Time Based Evasion (T1497.003)"}),id:"T1497.003",name:"Time Based Evasion",reference:"https://attack.mitre.org/techniques/T1497/003",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"timeBasedEvasion"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timeProvidersT1547Description",{defaultMessage:"Time Providers (T1547.003)"}),id:"T1547.003",name:"Time Providers",reference:"https://attack.mitre.org/techniques/T1547/003",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"timeProviders"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timestompT1070Description",{defaultMessage:"Timestomp (T1070.006)"}),id:"T1070.006",name:"Timestomp",reference:"https://attack.mitre.org/techniques/T1070/006",tactics:"defense-evasion",techniqueId:"T1070",value:"timestomp"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.tokenImpersonationTheftT1134Description",{defaultMessage:"Token Impersonation/Theft (T1134.001)"}),id:"T1134.001",name:"Token Impersonation/Theft",reference:"https://attack.mitre.org/techniques/T1134/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"tokenImpersonationTheft"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.toolT1588Description",{defaultMessage:"Tool (T1588.002)"}),id:"T1588.002",name:"Tool",reference:"https://attack.mitre.org/techniques/T1588/002",tactics:"resource-development",techniqueId:"T1588",value:"tool"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.trafficDuplicationT1020Description",{defaultMessage:"Traffic Duplication (T1020.001)"}),id:"T1020.001",name:"Traffic Duplication",reference:"https://attack.mitre.org/techniques/T1020/001",tactics:"exfiltration",techniqueId:"T1020",value:"trafficDuplication"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.transmittedDataManipulationT1565Description",{defaultMessage:"Transmitted Data Manipulation (T1565.002)"}),id:"T1565.002",name:"Transmitted Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/002",tactics:"impact",techniqueId:"T1565",value:"transmittedDataManipulation"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.transportAgentT1505Description",{defaultMessage:"Transport Agent (T1505.002)"}),id:"T1505.002",name:"Transport Agent",reference:"https://attack.mitre.org/techniques/T1505/002",tactics:"persistence",techniqueId:"T1505",value:"transportAgent"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.trapT1546Description",{defaultMessage:"Trap (T1546.005)"}),id:"T1546.005",name:"Trap",reference:"https://attack.mitre.org/techniques/T1546/005",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"trap"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.unixShellT1059Description",{defaultMessage:"Unix Shell (T1059.004)"}),id:"T1059.004",name:"Unix Shell",reference:"https://attack.mitre.org/techniques/T1059/004",tactics:"execution",techniqueId:"T1059",value:"unixShell"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.unixShellConfigurationModificationT1546Description",{defaultMessage:"Unix Shell Configuration Modification (T1546.004)"}),id:"T1546.004",name:"Unix Shell Configuration Modification",reference:"https://attack.mitre.org/techniques/T1546/004",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"unixShellConfigurationModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.uploadMalwareT1608Description",{defaultMessage:"Upload Malware (T1608.001)"}),id:"T1608.001",name:"Upload Malware",reference:"https://attack.mitre.org/techniques/T1608/001",tactics:"resource-development",techniqueId:"T1608",value:"uploadMalware"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.uploadToolT1608Description",{defaultMessage:"Upload Tool (T1608.002)"}),id:"T1608.002",name:"Upload Tool",reference:"https://attack.mitre.org/techniques/T1608/002",tactics:"resource-development",techniqueId:"T1608",value:"uploadTool"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.userActivityBasedChecksT1497Description",{defaultMessage:"User Activity Based Checks (T1497.002)"}),id:"T1497.002",name:"User Activity Based Checks",reference:"https://attack.mitre.org/techniques/T1497/002",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"userActivityBasedChecks"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vbaStompingT1564Description",{defaultMessage:"VBA Stomping (T1564.007)"}),id:"T1564.007",name:"VBA Stomping",reference:"https://attack.mitre.org/techniques/T1564/007",tactics:"defense-evasion",techniqueId:"T1564",value:"vbaStomping"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vdsoHijackingT1055Description",{defaultMessage:"VDSO Hijacking (T1055.014)"}),id:"T1055.014",name:"VDSO Hijacking",reference:"https://attack.mitre.org/techniques/T1055/014",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"vdsoHijacking"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vncT1021Description",{defaultMessage:"VNC (T1021.005)"}),id:"T1021.005",name:"VNC",reference:"https://attack.mitre.org/techniques/T1021/005",tactics:"lateral-movement",techniqueId:"T1021",value:"vnc"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.verclsidT1218Description",{defaultMessage:"Verclsid (T1218.012)"}),id:"T1218.012",name:"Verclsid",reference:"https://attack.mitre.org/techniques/T1218/012",tactics:"defense-evasion",techniqueId:"T1218",value:"verclsid"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.virtualPrivateServerT1584Description",{defaultMessage:"Virtual Private Server (T1584.003)"}),id:"T1584.003",name:"Virtual Private Server",reference:"https://attack.mitre.org/techniques/T1584/003",tactics:"resource-development",techniqueId:"T1584",value:"virtualPrivateServer"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.virtualPrivateServerT1583Description",{defaultMessage:"Virtual Private Server (T1583.003)"}),id:"T1583.003",name:"Virtual Private Server",reference:"https://attack.mitre.org/techniques/T1583/003",tactics:"resource-development",techniqueId:"T1583",value:"virtualPrivateServer"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.visualBasicT1059Description",{defaultMessage:"Visual Basic (T1059.005)"}),id:"T1059.005",name:"Visual Basic",reference:"https://attack.mitre.org/techniques/T1059/005",tactics:"execution",techniqueId:"T1059",value:"visualBasic"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vulnerabilitiesT1588Description",{defaultMessage:"Vulnerabilities (T1588.006)"}),id:"T1588.006",name:"Vulnerabilities",reference:"https://attack.mitre.org/techniques/T1588/006",tactics:"resource-development",techniqueId:"T1588",value:"vulnerabilities"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vulnerabilityScanningT1595Description",{defaultMessage:"Vulnerability Scanning (T1595.002)"}),id:"T1595.002",name:"Vulnerability Scanning",reference:"https://attack.mitre.org/techniques/T1595/002",tactics:"reconnaissance",techniqueId:"T1595",value:"vulnerabilityScanning"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.whoisT1596Description",{defaultMessage:"WHOIS (T1596.002)"}),id:"T1596.002",name:"WHOIS",reference:"https://attack.mitre.org/techniques/T1596/002",tactics:"reconnaissance",techniqueId:"T1596",value:"whois"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webCookiesT1606Description",{defaultMessage:"Web Cookies (T1606.001)"}),id:"T1606.001",name:"Web Cookies",reference:"https://attack.mitre.org/techniques/T1606/001",tactics:"credential-access",techniqueId:"T1606",value:"webCookies"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webPortalCaptureT1056Description",{defaultMessage:"Web Portal Capture (T1056.003)"}),id:"T1056.003",name:"Web Portal Capture",reference:"https://attack.mitre.org/techniques/T1056/003",tactics:"collection,credential-access",techniqueId:"T1056",value:"webPortalCapture"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webProtocolsT1071Description",{defaultMessage:"Web Protocols (T1071.001)"}),id:"T1071.001",name:"Web Protocols",reference:"https://attack.mitre.org/techniques/T1071/001",tactics:"command-and-control",techniqueId:"T1071",value:"webProtocols"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webServicesT1583Description",{defaultMessage:"Web Services (T1583.006)"}),id:"T1583.006",name:"Web Services",reference:"https://attack.mitre.org/techniques/T1583/006",tactics:"resource-development",techniqueId:"T1583",value:"webServices"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webServicesT1584Description",{defaultMessage:"Web Services (T1584.006)"}),id:"T1584.006",name:"Web Services",reference:"https://attack.mitre.org/techniques/T1584/006",tactics:"resource-development",techniqueId:"T1584",value:"webServices"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webSessionCookieT1550Description",{defaultMessage:"Web Session Cookie (T1550.004)"}),id:"T1550.004",name:"Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1550/004",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"webSessionCookie"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webShellT1505Description",{defaultMessage:"Web Shell (T1505.003)"}),id:"T1505.003",name:"Web Shell",reference:"https://attack.mitre.org/techniques/T1505/003",tactics:"persistence",techniqueId:"T1505",value:"webShell"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsCommandShellT1059Description",{defaultMessage:"Windows Command Shell (T1059.003)"}),id:"T1059.003",name:"Windows Command Shell",reference:"https://attack.mitre.org/techniques/T1059/003",tactics:"execution",techniqueId:"T1059",value:"windowsCommandShell"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsCredentialManagerT1555Description",{defaultMessage:"Windows Credential Manager (T1555.004)"}),id:"T1555.004",name:"Windows Credential Manager",reference:"https://attack.mitre.org/techniques/T1555/004",tactics:"credential-access",techniqueId:"T1555",value:"windowsCredentialManager"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsFileAndDirectoryPermissionsModificationT1222Description",{defaultMessage:"Windows File and Directory Permissions Modification (T1222.001)"}),id:"T1222.001",name:"Windows File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222/001",tactics:"defense-evasion",techniqueId:"T1222",value:"windowsFileAndDirectoryPermissionsModification"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsManagementInstrumentationEventSubscriptionT1546Description",{defaultMessage:"Windows Management Instrumentation Event Subscription (T1546.003)"}),id:"T1546.003",name:"Windows Management Instrumentation Event Subscription",reference:"https://attack.mitre.org/techniques/T1546/003",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"windowsManagementInstrumentationEventSubscription"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsRemoteManagementT1021Description",{defaultMessage:"Windows Remote Management (T1021.006)"}),id:"T1021.006",name:"Windows Remote Management",reference:"https://attack.mitre.org/techniques/T1021/006",tactics:"lateral-movement",techniqueId:"T1021",value:"windowsRemoteManagement"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsServiceT1543Description",{defaultMessage:"Windows Service (T1543.003)"}),id:"T1543.003",name:"Windows Service",reference:"https://attack.mitre.org/techniques/T1543/003",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"windowsService"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.winlogonHelperDllT1547Description",{defaultMessage:"Winlogon Helper DLL (T1547.004)"}),id:"T1547.004",name:"Winlogon Helper DLL",reference:"https://attack.mitre.org/techniques/T1547/004",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"winlogonHelperDll"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.wordlistScanningT1595Description",{defaultMessage:"Wordlist Scanning (T1595.003)"}),id:"T1595.003",name:"Wordlist Scanning",reference:"https://attack.mitre.org/techniques/T1595/003",tactics:"reconnaissance",techniqueId:"T1595",value:"wordlistScanning"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.xdgAutostartEntriesT1547Description",{defaultMessage:"XDG Autostart Entries (T1547.013)"}),id:"T1547.013",name:"XDG Autostart Entries",reference:"https://attack.mitre.org/techniques/T1547/013",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"xdgAutostartEntries"},{label:n.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.xpcServicesT1559Description",{defaultMessage:"XPC Services (T1559.003)"}),id:"T1559.003",name:"XPC Services",reference:"https://attack.mitre.org/techniques/T1559/003",tactics:"execution",techniqueId:"T1559",value:"xpcServices"}]},function(e,t,a){"use strict";var n=Object.assign;e.exports=n},function(e,t,a){"use strict";a.d(t,"m",(function(){return i})),a.d(t,"k",(function(){return s})),a.d(t,"l",(function(){return r})),a.d(t,"i",(function(){return o})),a.d(t,"j",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"c",(function(){return g})),a.d(t,"f",(function(){return f})),a.d(t,"e",(function(){return b}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return T})),a.d(t,"a",(function(){return B})),a.d(t,"d",(function(){return q})),a.d(t,"c",(function(){return d}));var n=a(6),i=n.i18n.translate("autocomplete.loadingDescription",{defaultMessage:"Loading..."}),s=n.i18n.translate("autocomplete.selectField",{defaultMessage:"Please select a field first..."}),r=n.i18n.translate("autocomplete.fieldRequiredError",{defaultMessage:"Value cannot be empty"}),o=n.i18n.translate("autocomplete.invalidNumberError",{defaultMessage:"Not a valid number"}),l=n.i18n.translate("autocomplete.invalidDateError",{defaultMessage:"Not a valid date"}),c=n.i18n.translate("autocomplete.invalidBinaryType",{defaultMessage:"Binary fields are currently unsupported"}),u=n.i18n.translate("autocomplete.fieldSpaceWarning",{defaultMessage:"Warning: Spaces at the start or end of this value aren't being displayed."}),d=(n.i18n.translate("autocomplete.listsTooltipWarning",{defaultMessage:"Lists that aren't able to be processed by this rule type will be disabled."}),n.i18n.translate("autocomplete.seeDocumentation",{defaultMessage:"See Documentation"}),{LOADING:i,SELECT_FIELD_FIRST:s,FIELD_REQUIRED_ERR:r,NUMBER_ERR:o,DATE_ERR:l,FIELD_SPACE_WARNING:u,BINARY_TYPE_NOT_SUPPORTED:c}),p=a(4),m=a.n(p),g=a(17),f=a(30),b=a.n(f),h=a(12),y=a.n(h),E=function(e){var t=e.getLabel,a=e.options,n=e.selectedOptions,i=e.disabledOptions,s=a.map(t),r=null==i?void 0:i.map(t),o=s.map((function(e){return{label:e,disabled:r&&0!==r.length&&r.includes(e)}})),l=n.map(t).filter((function(e){return-1!==s.indexOf(e)})).map((function(e){return o[s.indexOf(e)]}));return{comboOptions:o,labels:s,selectedComboOptions:l}},v={binary:c},k=a(176),S={asPlainText:!0},T=function(e){var t=e.fieldInputWidth,a=e.fieldTypeFilter,n=void 0===a?[]:a,i=e.indexPattern,s=e.isClearable,r=void 0!==s&&s,o=e.isDisabled,l=void 0!==o&&o,c=e.isLoading,u=void 0!==c&&c,d=e.isRequired,f=void 0!==d&&d,h=e.onChange,T=e.placeholder,x=function(e){var t=e.indexPattern,a=e.fieldTypeFilter,n=e.isRequired,i=e.selectedField,s=e.fieldInputWidth,r=e.onChange,o=Object(p.useState)(!1),l=b()(o,2),c=l[0],u=l[1],d=Object(p.useMemo)((function(){return function(e,t,a){var n=function(e){return null!=e?e.fields:[]}(e),i=function(e){return e?[e]:[]}(t),s=function(e,t,a){var n=new Map;e.forEach((function(e){return n.set(e.name,e)})),t.forEach((function(e){return n.set(e.name,e)}));var i=Array.from(n.values());return a&&(null==a?void 0:a.length)>0?i.filter((function(e){var t=e.type;return a.includes(t)})):i}(n,i,a);return{availableFields:s,selectedFields:i}}(t,i,a)}),[t,a,i]),f=d.availableFields,h=d.selectedFields,S=Object(p.useMemo)((function(){return function(e){var t=e.availableFields,a=e.selectedFields,n=E({getLabel:function(e){return e.name},options:t,selectedOptions:a}),i=function(e){return e.availableFields.reduce((function(e,t){var a,n=null===(a=t.esTypes)||void 0===a?void 0:a.find((function(e){return v[e]})),i=n&&v[n]||v[t.type];return i&&(e[t.name]=i),e}),{})}(e);return y()(y()({},n),{},{disabledLabelTooltipTexts:i})}({availableFields:f,selectedFields:h})}),[f,h]),T=S.comboOptions,x=S.labels,w=S.selectedComboOptions,O=S.disabledLabelTooltipTexts,j=Object(p.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return f[x.indexOf(t)]}));r(t)}),[f,x,r]),I=Object(p.useCallback)((function(){u(!0)}),[u]),C=Object(p.useMemo)((function(){return s?{width:"".concat(s,"px")}:{}}),[s]);return{isInvalid:Object(p.useMemo)((function(){return!!n&&c&&null==i}),[n,i,c]),comboOptions:T,selectedComboOptions:w,fieldWidth:C,renderFields:function(e,t,a){var n=e.label,i=O[n];return i?(e.disabled=!0,Object(k.jsx)(g.EuiToolTip,{"data-test-subj":"disabledLabelWithTooltip",content:i,position:"bottom"},Object(k.jsx)(m.a.Fragment,null,n))):n},handleTouch:I,handleValuesChange:j}}({indexPattern:i,fieldTypeFilter:n,isRequired:f,selectedField:e.selectedField,fieldInputWidth:t,onChange:h}),w=x.isInvalid,O=x.comboOptions,j=x.selectedComboOptions,I=x.fieldWidth,C=x.renderFields,M=x.handleTouch,D=x.handleValuesChange;return Object(k.jsx)(g.EuiComboBox,{placeholder:T,options:O,selectedOptions:j,onChange:D,isLoading:u,isDisabled:l,isClearable:r,isInvalid:w,onFocus:M,singleSelection:S,"data-test-subj":"fieldAutocompleteComboBox",style:I,fullWidth:!0,renderOption:C})};T.displayName="Field";var x=a(21),w=a.n(x),O=(a(341),a(190),a(5)),j=a(219),I=a(382),C=a.n(I),M=a(383),D=a.n(M),A=a(44),F=function(e){var t=e.selectedField,a=e.operatorType,n=e.fieldValue,i=e.query,s=e.indexPattern,r=e.autocompleteService,o=Object(p.useState)(!1),l=b()(o,2),c=l[0],u=l[1],d=Object(p.useState)(!0),m=b()(d,2),g=m[0],f=m[1],h=Object(p.useState)([]),E=b()(h,2),v=E[0],k=E[1],S=Object(p.useRef)(null);return Object(p.useEffect)((function(){var e=!0,o=new AbortController,l=Object(O.debounce)(function(){var t=C()(D.a.mark((function t(a){var n,i,s,l,c,d;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.fieldSelected,i=a.patterns,s=a.searchQuery,t.prev=1,!e){t.next=17;break}if(null!=n&&null!=i){t.next=5;break}return t.abrupt("return");case 5:if("boolean"!==n.type){t.next=8;break}return f(!1),t.abrupt("return");case 8:return u(!0),l=Object(A.f)(n),c=l?y()(y()({},n),{},{name:"".concat(l.nested.path,".").concat(n.name)}):n,t.next=13,r.getValueSuggestions({field:c,indexPattern:i,query:s,signal:o.signal,useTimeRange:!1});case 13:0===(d=t.sent).length&&f(!1),u(!1),k(w()(d));case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(1),e&&(k([]),u(!1));case 22:case"end":return t.stop()}}),t,null,[[1,19]])})));return function(e){return t.apply(this,arguments)}}(),500);return a!==j.c.EXISTS&&l({fieldSelected:t,patterns:s,searchQuery:i,value:n}),S.current=l,function(){e=!1,o.abort()}}),[t,a,n,s,i,r]),[c,g,v,S.current]},R=a(102),P=a.n(R),_=function(e,t,a,n){if(null!=t){var i=function(e,t,a,n){return a&&n&&(null==e||""===e.trim())?r:null==t||a&&!n||!(a||null!=e&&""!==e)?void 0:null}(e,t,a,n);if(null!==i)return i;switch(t.type){case"date":var s=P.a.parse(null!=e?e:"");return Boolean(s&&s.isValid())?void 0:l;case"number":return null==e||""===e.trim()||isNaN(+e)?o:void 0;default:return}}},q=function(e){return e&&e.trim().length!==e.length},N=[{inputDisplay:"true",value:"true"},{inputDisplay:"false",value:"false"}],L={asPlainText:!0},B=function(e){var t=e.placeholder,a=e.rowLabel,n=e.selectedField,r=e.selectedValue,o=e.indexPattern,l=e.isLoading,c=e.isDisabled,d=void 0!==c&&c,m=e.isClearable,f=void 0!==m&&m,h=e.isRequired,y=void 0!==h&&h,v=e.fieldInputWidth,S=e.autocompleteService,T=e.onChange,x=e.onError,I=Object(p.useState)(""),C=b()(I,2),M=C[0],D=C[1],A=Object(p.useState)(!1),R=b()(A,2),P=R[0],B=R[1],z=Object(p.useState)(void 0),H=b()(z,2),$=H[0],V=H[1],U=Object(p.useState)(!1),Q=b()(U,2),W=Q[0],G=Q[1],K=F({autocompleteService:S,fieldValue:r,indexPattern:o,operatorType:j.c.MATCH,query:M,selectedField:n}),J=b()(K,3),Y=J[0],X=J[1],Z=J[2],ee=Object(p.useCallback)((function(e){return e}),[]),te=Object(p.useMemo)((function(){var e=String(r);return null!=r&&""!==r.trim()?Object(O.uniq)([e].concat(w()(Z))):Z}),[Z,r]),ae=Object(p.useMemo)((function(){var e=String(r);return r?[e]:[]}),[r]),ne=Object(p.useCallback)((function(e){if(!e)return G(!1);G(!!q(e))}),[G]),ie=Object(p.useCallback)((function(e){V((function(t){var a=null!=e;return null!=t!==a&&null!=x&&x(a),e}))}),[V,x]),se=Object(p.useMemo)((function(){return E({getLabel:ee,options:te,selectedOptions:ae})}),[te,ae,ee]),re=se.comboOptions,oe=se.labels,le=se.selectedComboOptions,ce=Object(p.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return te[oe.indexOf(t)]})),a=b()(t,1)[0];ne(a),ie(void 0),T(null!=a?a:"")}),[ie,ne,oe,T,te]),ue=Object(p.useCallback)((function(e){if(""!==e&&null!=n){var t=_(e,n,y,P);ie(t),t||ne(e),D(e)}}),[ie,ne,y,n,P]),de=Object(p.useCallback)((function(e){var t=_(e,n,y,P);if(ie(t),null!=t)return G(!1),!1;ne(e),T(e)}),[y,T,n,P,ie,ne]),pe=Object(p.useCallback)((function(e){var t=e.target.value;T(t)}),[T]),me=Object(p.useCallback)((function(e){T(e)}),[T]),ge=Object(p.useCallback)((function(){B(!0);var e=_(r,n,y,!0);ie(e)}),[B,ie,r,n,y]),fe=Object(p.useMemo)((function(){return l||Y?i:null==n?s:t}),[l,n,Y,t]),be=Object(p.useMemo)((function(){return l||Y}),[l,Y]);Object(p.useEffect)((function(){V(void 0),null!=x&&x(!1),ne(r)}),[n,r,ne,x]);var he=Object(p.useMemo)((function(){return Object(k.jsx)(g.EuiFormRow,{label:a,error:$,isInvalid:null!=n&&null!=$,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0,helpText:W&&u},Object(k.jsx)(g.EuiComboBox,{placeholder:fe,isDisabled:d||!n,isLoading:be,isClearable:f,options:re,selectedOptions:le,onChange:ce,singleSelection:L,onSearchChange:ue,onCreateOption:de,isInvalid:null!=n&&null!=$,onBlur:ge,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteMatch",style:v?{width:"".concat(v,"px")}:{},fullWidth:!0,async:!0}))}),[re,$,v,fe,f,d,be,a,le,n,W,de,ue,ce,ge]);if(X||null==n)return he;switch(n.type){case"number":return Object(k.jsx)(g.EuiFormRow,{label:a,error:$,isInvalid:null!=n&&null!=$,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(k.jsx)(g.EuiFieldNumber,{placeholder:fe,onBlur:ge,value:"string"==typeof r&&r.trim().length>0?parseFloat(r):null!=r?r:"",onChange:pe,"data-test-subj":"valueAutocompleteFieldMatchNumber",style:v?{width:"".concat(v,"px")}:{},fullWidth:!0}));case"boolean":return Object(k.jsx)(g.EuiFormRow,{label:a,error:$,isInvalid:null!=n&&null!=$,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(k.jsx)(g.EuiSuperSelect,{isLoading:be,options:N,valueOfSelected:null!=r?r:"true",onChange:me,"data-test-subj":"valuesAutocompleteMatchBoolean",style:v?{width:"".concat(v,"px")}:{},fullWidth:!0}));default:return he}};B.displayName="AutocompleteFieldMatch";var z={asPlainText:!0};Object(p.memo)((function(e){var t=e.autocompleteService,a=e.placeholder,n=e.rowLabel,r=e.selectedField,o=e.selectedValue,l=e.indexPattern,c=e.isLoading,d=e.isDisabled,m=void 0!==d&&d,f=e.isClearable,h=void 0!==f&&f,y=e.isRequired,v=void 0!==y&&y,S=e.fieldInputWidth,T=e.onChange,x=e.onError,I=e.onWarning,C=e.warning,M=Object(p.useState)(""),D=b()(M,2),A=D[0],R=D[1],P=Object(p.useState)(!1),N=b()(P,2),L=N[0],B=N[1],H=Object(p.useState)(void 0),$=b()(H,2),V=$[0],U=$[1],Q=Object(p.useState)(!1),W=b()(Q,2),G=W[0],K=W[1],J=F({autocompleteService:t,fieldValue:o,indexPattern:l,operatorType:j.c.WILDCARD,query:A,selectedField:r}),Y=b()(J,3),X=Y[0],Z=Y[2],ee=Object(p.useCallback)((function(e){return e}),[]),te=Object(p.useMemo)((function(){var e=String(o);return null!=o&&""!==o.trim()?Object(O.uniq)([e].concat(w()(Z))):Z}),[Z,o]),ae=Object(p.useMemo)((function(){var e=String(o);return o?[e]:[]}),[o]),ne=Object(p.useCallback)((function(e){if(!e)return K(!1);K(!!q(e))}),[K]),ie=Object(p.useCallback)((function(e){U((function(t){var a=null!=e;return null!=t!==a&&null!=x&&x(a),e}))}),[U,x]),se=Object(p.useCallback)((function(e){I(void 0!==e)}),[I]),re=Object(p.useMemo)((function(){return E({getLabel:ee,options:te,selectedOptions:ae})}),[te,ae,ee]),oe=re.comboOptions,le=re.labels,ce=re.selectedComboOptions,ue=Object(p.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return te[le.indexOf(t)]})),a=b()(t,1)[0];ie(void 0),ne(a),K(!1),T(null!=a?a:"")}),[ie,ne,le,T,te]),de=Object(p.useCallback)((function(e){if(""!==e.trim()&&null!=r){var t=_(e,r,v,L);ie(t),se(C),t||ne(e),R(e)}}),[ie,ne,v,r,L,C,se]),pe=Object(p.useCallback)((function(e){var t=_(e,r,v,L);if(ie(t),se(C),null!=t)return K(!1),!1;ne(e),T(e)}),[v,ne,T,r,L,ie,se,C]),me=Object(p.useCallback)((function(){B(!0);var e=_(o,r,v,!0);ie(e),se(C)}),[B,ie,o,r,v,se,C]),ge=Object(p.useMemo)((function(){return c||X?i:null==r?s:a}),[c,r,X,a]),fe=Object(p.useMemo)((function(){return c||X}),[c,X]);return Object(p.useEffect)((function(){U(void 0),null!=x&&x(!1),ne(o),I(!1)}),[r,o,x,I,ne]),Object(p.useMemo)((function(){return Object(k.jsx)(g.EuiFormRow,{label:n,error:V,helpText:C||G&&u,isInvalid:null!=r&&null!=V,"data-test-subj":"valuesAutocompleteWildcardLabel",fullWidth:!0},Object(k.jsx)(g.EuiComboBox,{placeholder:ge,isDisabled:m||!r,isLoading:fe,isClearable:h,options:oe,selectedOptions:ce,onChange:ue,singleSelection:z,onSearchChange:de,onCreateOption:pe,isInvalid:null!=r&&null!=V,onBlur:me,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteWildcard",style:S?{width:"".concat(S,"px")}:{},fullWidth:!0,async:!0}))}),[oe,V,S,pe,de,ue,ge,h,m,fe,n,ce,r,me,C,G])})).displayName="AutocompleteFieldWildcard";a(451)},,,function(e,t,a){"use strict";a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return g})),a.d(t,"f",(function(){return f})),a.d(t,"a",(function(){return b})),a.d(t,"h",(function(){return h})),a.d(t,"c",(function(){return y})),a.d(t,"e",(function(){return E})),a.d(t,"g",(function(){return v}));var n=a(14),i=a(557),s=a(442),r=a(246);function o([e,t,a,n,i,s,r,o,l],[c,u,d,p,m,g,f,b,h]){return[e*c+t*p+a*f,e*u+t*m+a*b,e*d+t*g+a*h,n*c+i*p+s*f,n*u+i*m+s*b,n*d+i*g+s*h,r*c+o*p+l*f,r*u+o*m+l*b,r*d+o*g+l*h]}function l([e,t,a,n,i,s,r,o,l],[c,u,d,p,m,g,f,b,h]){return[e+c,t+u,a+d,n+p,i+m,s+g,r+f,o+b,l+h]}function c([e,t]){return[e,0,0,0,t,0,0,0,0]}var u=a(305);function d(e,t){return e.startTime+e.duration>=t}const p=Object(n.createSelector)((e=>e.scalingFactor),(e=>e.animation),((e,t)=>{const a=(o=e,Object(s.b)(u.b,u.a,Math.pow(o,u.f)));var o;if(void 0!==t){const e=r.d(t.targetTranslation,t.initialTranslation),o=e*a/t.duration,l=.4,c=.4,p=o<l?o:o**c-(l**c-l),m=Object(s.a)(p*t.duration/e,u.b,u.a);return Object(n.defaultMemoize)((e=>{if(!1===d(t,e))return[a,a];{const n=k(t,e),r=i.easing.inOutCubic(1-Math.abs(2*n-1)),o=Object(s.b)(a,m,r);return[o,o]}}))}return Object(n.defaultMemoize)((()=>[a,a]))})),m=Object(n.createSelector)((e=>e.rasterSize),p,((e,t)=>Object(n.defaultMemoize)((a=>{const[n,i]=t(a),s=e[0],r=e[1],o=s/2/n,l=r/2/i;return{renderWidth:s,renderHeight:r,clippingPlaneRight:o,clippingPlaneTop:l,clippingPlaneLeft:-o,clippingPlaneBottom:-l}})))),g=Object(n.createSelector)((e=>e.animation),(e=>t=>void 0!==e&&d(e,t))),f=Object(n.createSelector)((e=>e.panning),(e=>e.translationNotCountingCurrentPanning),p,(e=>e.animation),((e,t,a,s)=>Object(n.defaultMemoize)((n=>{const[o,l]=a(n);if(void 0!==s&&d(s,n))return r.g(s.initialTranslation,s.targetTranslation,i.easing.inOutCubic(k(s,n)));if(e){const a=r.j(e.currentOffset,e.origin),n=r.e(a,[-o,l]);return r.a(t,n)}return t})))),b=Object(n.createSelector)(m,f,((e,t)=>Object(n.defaultMemoize)((a=>{const{renderWidth:n,renderHeight:i,clippingPlaneRight:s,clippingPlaneTop:r,clippingPlaneLeft:u,clippingPlaneBottom:d}=e(a),p=[0===n?0:2/n,0,-1,0,0===i?0:2/i,-1,0,0,0],m=c([1,-1]),[g,f]=t(a);return l([0,0,g,0,0,f,0,0,0],o(function(e,t,a,n){let i,s,r,o;return t-n==0?(i=0,s=0):(i=(t-n)/2,s=(t+n)/(t-n)),e-a==0?(r=0,o=0):(r=(e-a)/2,o=(e+a)/(e-a)),[i,0,s,0,r,o,0,0,0]}(r,s,d,u),o(m,p)))})))),h=Object(n.createSelector)(m,b,((e,t)=>Object(n.defaultMemoize)((a=>{const{renderWidth:n,renderHeight:i}=e(a),s=t(a),o=[0,i],l=[n,0];return{minimum:r.c(o,s),maximum:r.c(l,s)}})))),y=Object(n.createSelector)(m,f,((e,t)=>Object(n.defaultMemoize)((a=>{const{renderWidth:n,renderHeight:i,clippingPlaneRight:s,clippingPlaneTop:u,clippingPlaneLeft:d,clippingPlaneBottom:p}=e(a),m=function([e,t]){return[1,0,e,0,1,t,0,0,0]}(r.i(t(a),-1)),g=function(e,t,a,n){let i,s,r,o;return t-n==0?(i=0,s=0):(i=2/(t-n),s=-(t+n)/(t-n)),e-a==0?(r=0,o=0):(r=e-a==0?0:2/(e-a),o=e-a==0?0:-(e+a)/(e-a)),[i,0,s,0,r,o,0,0,0]}(u,s,p,d),f=c([1,-1]);return o(c([n/2,i/2]),l([0,0,1,0,0,1,0,0,0],o(f,o(g,m))))})))),E=e=>e.scalingFactor,v=e=>void 0!==e.panning;function k(e,t){return Object(s.a)((t-e.startTime)/e.duration,0,1)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(182);function i(e){return function(t){for(const a of e)if(a(t))return!0;return!1}}function s(e){return function(t){if("object"!=typeof t||null===t)return!1;const a=t;for(const t of Object.keys(e))if(!(0,e[t])(a[t]))return!1;return!0}}function r(e){return function(t){return e===t}}const o=i([s({panelView:r("nodes")}),s({panelView:r("nodeDetail"),panelParameters:s({nodeID:function(e){return"string"==typeof e}})}),s({panelView:r("nodeEvents"),panelParameters:s({nodeID:function(e){return"string"==typeof e}})}),s({panelView:r("nodeEventsInCategory"),panelParameters:s({nodeID:function(e){return"string"==typeof e},eventCategory:function(e){return"string"==typeof e}})}),s({panelView:r("eventDetail"),panelParameters:s({nodeID:function(e){return"string"==typeof e},eventCategory:function(e){return"string"==typeof e},eventID:i([function(e){return"string"==typeof e},r(void 0),function(e){return"number"==typeof e}]),eventTimestamp:function(e){return"string"==typeof e},winlogRecordID:function(e){return"string"==typeof e}})})]);var l=a(353);function c({locationSearch:e,resolverComponentInstanceID:t}){if(void 0===e||void 0===t)return{panelView:"nodes"};const a=new URLSearchParams(e).get(Object(l.a)(t));if(null===a)return{panelView:"nodes"};const i=Object(n.decode)(a);return o(i)?i:{panelView:"nodes"}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(4),i=a(1),s=a(19);const r=async(e,t)=>s.b.get().http.fetch("/api/ml/results/anomalies_table_data",{method:"POST",body:JSON.stringify(e),asSystemRequest:!0,signal:t});var o=a(644),l=a(202),c=a(501),u=a(224),d=a(254);const p=e=>null==e?"":e.reduce(((e,t)=>`${e}${t.fieldName}:${t.fieldValue}`),""),m=(e,t)=>-1!==t?t:null==e?50:e<0?0:e>100?100:Math.floor(e),g=({criteriaFields:e=[],influencers:t=[],startDate:a,endDate:g,threshold:f=-1,skip:b=!1,filterQuery:h,jobIds:y,aggregationInterval:E})=>{const v=Object(u.a)(),k=Object(d.a)(v),{addError:S}=Object(l.a)(),T=Object(s.n)(),[x]=Object(s.q)(i.I),w=Object(n.useMemo)((()=>new Date(a).getTime()),[a]),O=Object(n.useMemo)((()=>new Date(g).getTime()),[g]),{fetch:j,data:I=null,isLoading:C,error:M}=Object(c.b)(c.a.ANOMALIES_TABLE,r,{disabled:b});return Object(n.useEffect)((()=>{M&&S(M,{title:o.a})}),[M,S]),Object(n.useEffect)((()=>{k&&y.length>0&&j({jobIds:y,criteriaFields:e,influencersFilterQuery:h,aggregationInterval:E,threshold:m(x,f),earliestMs:w,latestMs:O,influencers:t,dateFormatTz:T,maxRecords:500,maxExamples:10})}),[p(t),p(e),w,O,k,E,y.sort().join()]),[C,I]}},,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"j",(function(){return p})),a.d(t,"f",(function(){return m}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.timeline.categoryTooltip",{defaultMessage:"Category"}),s=n.i18n.translate("xpack.securitySolution.timeline.descriptionTooltip",{defaultMessage:"Description"}),r=n.i18n.translate("xpack.securitySolution.timeline.fieldTooltip",{defaultMessage:"Field"}),o=n.i18n.translate("xpack.securitySolution.timeline.fullScreenButton",{defaultMessage:"Full screen"}),l=n.i18n.translate("xpack.securitySolution.timeline.hideColumnLabel",{defaultMessage:"Hide column"}),c=n.i18n.translate("xpack.securitySolution.timeline.sortAZLabel",{defaultMessage:"Sort A-Z"}),u=n.i18n.translate("xpack.securitySolution.timeline.sortFieldsButton",{defaultMessage:"Sort fields"}),d=n.i18n.translate("xpack.securitySolution.timeline.sortZALabel",{defaultMessage:"Sort Z-A"}),p=n.i18n.translate("xpack.securitySolution.timeline.typeTooltip",{defaultMessage:"Type"}),m=n.i18n.translate("xpack.securitySolution.timeline.flyout.pane.removeColumnButtonLabel",{defaultMessage:"Remove column"})},,,function(e,t,a){const n=a(248);e.exports=(e,t,a)=>n(e,t,a)>=0},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>i(e)&&s(e)&&r(e)&&o(e),i=({capabilities:e})=>e.canGetDatafeeds&&e.canStartStopDatafeed&&e.canUpdateDatafeed&&e.canPreviewDatafeed,s=({capabilities:e})=>e.canCreateJob&&e.canGetJobs&&e.canUpdateJob&&e.canDeleteJob&&e.canOpenJob&&e.canCloseJob&&e.canForecastJob,r=({capabilities:e})=>e.canGetFilters&&e.canCreateFilter&&e.canDeleteFilter,o=({capabilities:e})=>e.canCreateCalendar&&e.canGetCalendars&&e.canDeleteCalendar},,function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return h}));var n=a(4),i=a.n(n),s=a(1),r=a(598),o=a(19),l=a(308),c=a(5);const u=(e,t,a)=>e>t?a:e<t?-a:0,d={filter:"",tags:[],showCustomRules:!1,showElasticRules:!1},p={field:"enabled",order:"desc"},m=Object(n.createContext)(null),g="detection-rules-table-in-memory",f=({children:e})=>{var t;const[a]=Object(o.q)(s.bb),{storage:r}=Object(o.k)().services,[f,b]=Object(n.useState)(null!==(t=r.get(g))&&void 0!==t&&t),[h,y]=Object(n.useState)(d),[E,v]=Object(n.useState)(p),[k,S]=Object(n.useState)(!1),[T,x]=Object(n.useState)(a.on),[w,O]=Object(n.useState)({ids:[],action:null}),[j,I]=Object(n.useState)(1),[C,M]=Object(n.useState)(20),[D,A]=Object(n.useState)([]),F=Object(n.useRef)(null),R=Object(n.useCallback)((e=>{b(e),r.set(g,e),!1===e&&v(p)}),[r]),P=Object(n.useMemo)((()=>{var e;return w.ids.length>0&&!["disable","enable","edit"].includes(null!==(e=w.action)&&void 0!==e?e:"")}),[w.action,w.ids.length]),_=Object(n.useMemo)((()=>({page:j,perPage:C})),[j,C]),q=Object(n.useCallback)((e=>{y((t=>({...t,...e}))),I(1),A([]),S(!1)}),[]),N=Object(n.useCallback)((()=>{A([]),S(!1)}),[]);Object(n.useEffect)((()=>{var e;D.length>0?(x(!1),null==F.current&&(F.current=T)):(x(null!==(e=F.current)&&void 0!==e?e:T),F.current=null)}),[D,T]);const{data:{rules:L,total:B}={rules:[],total:0},refetch:z,dataUpdatedAt:H,isFetched:$,isFetching:V,isLoading:U,isRefetching:Q}=(e=>{const{pagination:t,filterOptions:a,sortingOptions:n,isInMemorySorting:i,refetchInterval:s}=e,r=Object(l.a)(["all"],{pagination:{page:1,perPage:1e4},filterOptions:a},{refetchInterval:s,enabled:i,keepPreviousData:!0}),o=Object(l.a)(["paged"],{pagination:t,filterOptions:a,sortingOptions:n},{refetchInterval:s,enabled:!i,keepPreviousData:!0});return i?r:o})({isInMemorySorting:f,filterOptions:h,sortingOptions:E,pagination:_,refetchInterval:T&&!P&&a.value}),W=f?L.sort(function(e){return(t,a)=>{const{field:n,order:i}=e,s="asc"===i?1:-1;switch(n){case"enabled":{const e=Object(c.get)(t,n),i=Object(c.get)(a,n);return u(Number(e),Number(i),s)}case"version":case"risk_score":case"execution_summary.last_execution.metrics.execution_gap_duration_s":case"execution_summary.last_execution.metrics.total_indexing_duration_ms":case"execution_summary.last_execution.metrics.total_search_duration_ms":{var r,o;const e=null!==(r=Object(c.get)(t,n))&&void 0!==r?r:-1/0,i=null!==(o=Object(c.get)(a,n))&&void 0!==o?o:-1/0;return u(e,i,s)}case"updated_at":case"created_at":case"execution_summary.last_execution.date":{const e=Object(c.get)(t,n),i=Object(c.get)(a,n);return u(null==e?0:new Date(e).getTime(),null==i?0:new Date(i).getTime(),s)}case"execution_summary.last_execution.status":case"severity":case"name":{const e=Object(c.get)(t,n),i=Object(c.get)(a,n);return(e||"").localeCompare(i||"")*s}}}}(E)).slice((j-1)*C,j*C):L,G=Object(n.useMemo)((()=>({state:{rules:W,pagination:{page:j,perPage:C,total:f?L.length:B},filterOptions:h,isActionInProgress:P,isAllSelected:k,isFetched:$,isFetching:V,isInMemorySorting:f,isLoading:U,isRefetching:Q,isRefreshOn:T,lastUpdated:H,loadingRuleIds:w.ids,loadingRulesAction:w.action,selectedRuleIds:D,sortingOptions:E},actions:{reFetchRules:z,setFilterOptions:q,setIsAllSelected:S,setIsInMemorySorting:R,setIsRefreshOn:x,setLoadingRules:O,setPage:I,setPerPage:M,setSelectedRuleIds:A,setSortingOptions:v,clearRulesSelection:N}})),[H,h,q,P,k,$,V,f,U,Q,T,w.action,w.ids,j,C,z,L.length,W,D,E,R,A,B,N]);return i.a.createElement(m.Provider,{value:G},e)},b=()=>{const e=Object(n.useContext)(m);return Object(r.a)(e,"useRulesTableContext should be used inside RulesTableContextProvider"),e},h=()=>Object(n.useContext)(m)},function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var n=a(4),i=a.n(n),s=a(92),r=a.n(s),o=a(19),l=a(293),c=a(680),u=a(17),d=a(3),p=a(62),m=a(70),g=a(83);const f=({disabled:e,hrefWithSearch:t,id:a,name:s,isSelected:r,isBeta:l,betaOptions:c})=>{var d;const{getAppUrl:p,navigateTo:f}=Object(o.m)(),b=Object(n.useCallback)((e=>{e.preventDefault(),f({path:t}),Object(m.e)(m.a.CLICK,`${m.b.TAB_CLICKED}${a}`)}),[f,t,a]),h=p({path:t});return i.a.createElement(u.EuiTab,{"data-href":h,"data-test-subj":`navigation-${a}`,disabled:e,isSelected:r,href:h,onClick:b,append:l&&i.a.createElement(u.EuiBetaBadge,{label:null!==(d=null==c?void 0:c.text)&&void 0!==d?d:g.a,size:"s"})},s)},b=i.a.memo(f),h=({navTabs:e,tabName:t})=>{const a=Object(n.useCallback)((()=>Object(d.getOr)("","id",Object.values(e).find((e=>t===e.id)))),[t,e]),[s,r]=Object(n.useState)(a());Object(n.useEffect)((()=>{const e=a();e!==s&&r(e)}),[t,e,a,s]);const{search:o}=Object(p.useLocation)(),l=Object(n.useMemo)((()=>Object.values(e).map((e=>{const t=s===e.id;return i.a.createElement(b,{key:`navigation-${e.id}`,id:e.id,hrefWithSearch:e.href+o,name:e.name,disabled:e.disabled,isSelected:t,isBeta:e.isBeta,betaOptions:e.betaOptions})}))),[e,s,o]);return i.a.createElement(u.EuiTabs,null,l)};h.displayName="TabNavigationComponent";const y=i.a.memo(h,((e,t)=>e.display===t.display&&e.tabName===t.tabName&&r()(e.navTabs,t.navTabs)));y.displayName="TabNavigation";const E=i.a.memo((({detailName:e,display:t,flowTarget:a,navTabs:s,pageName:r,pathName:l,search:u,state:d,tabName:p})=>{const{chrome:m,application:{getUrlForApp:g,navigateToUrl:f}}=Object(o.k)().services,b=Object(c.a)();return Object(n.useEffect)((()=>{(l||r)&&b({detailName:e,flowTarget:a,navTabs:s,pageName:r,pathName:l,search:u,state:d,tabName:p},m,f)}),[m,r,l,u,s,d,e,a,p,g,f,b]),i.a.createElement(y,{display:t,navTabs:s,pageName:r,pathName:l,tabName:p})}));E.displayName="TabNavigationComponent";const v=i.a.memo(E,((e,t)=>e.pathName===t.pathName&&e.search===t.search&&r()(e.navTabs,t.navTabs)&&r()(e.state,t.state))),k=i.a.memo((e=>{const[t]=Object(l.a)(),a={...t,...e};return i.a.createElement(v,a)}),((e,t)=>r()(e.navTabs,t.navTabs)));k.displayName="SecuritySolutionTabNavigation"},,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>{const t=Object.entries(e);if(Array.isArray(t[0])){const[[e,a]]=t;return[e,a]}return[null,null]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(17),i=a(4),s=a.n(i),r=a(98);const o=({dataTestSubj:e,descriptionList:t})=>s.a.createElement(n.EuiFlexItem,{grow:!0},s.a.createElement(r.d,{"data-test-subj":e,listItems:t}))},function(e,t,a){"use strict";a.r(t),a.d(t,"updateNetworkTable",(function(){return s})),a.d(t,"setNetworkDetailsTablesActivePageToZero",(function(){return r})),a.d(t,"setNetworkTablesActivePageToZero",(function(){return o})),a.d(t,"updateNetworkAnomaliesJobIdFilter",(function(){return l})),a.d(t,"updateNetworkAnomaliesInterval",(function(){return c}));var n=a(37);const i=a.n(n)()("x-pack/security_solution/local/network"),s=i("UPDATE_NETWORK_TABLE"),r=i("SET_IP_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),o=i("SET_NETWORK_TABLES_ACTIVE_PAGE_TO_ZERO"),l=i("UPDATE_NETWORK_ANOMALIES_JOB_ID_FILTER"),c=i("UPDATE_NETWORK_ANOMALIES_INTERVAL")},,,,,,,,,,,,,function(e,t,a){const n=a(248);e.exports=(e,t,a)=>n(e,t,a)>0},function(e,t,a){const n=Symbol("SemVer ANY");class Comparator{static get ANY(){return n}constructor(e,t){if(t=i(t),e instanceof Comparator){if(e.loose===!!t.loose)return e;e=e.value}l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?s[r.COMPARATORLOOSE]:s[r.COMPARATOR],a=e.match(t);if(!a)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==a[1]?a[1]:"","="===this.operator&&(this.operator=""),a[2]?this.semver=new c(a[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return o(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new u(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new u(this.value,t).test(e.semver);const a=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),r=o(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),l=o(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return a||n||i&&s||r||l}}e.exports=Comparator;const i=a(399),{re:s,t:r}=a(325),o=a(579),l=a(397),c=a(233),u=a(251)},function(e,t,a){const n=a(251);e.exports=(e,t,a)=>{try{t=new n(t,a)}catch(e){return!1}return t.test(e)}},function(e,t,a){"use strict";a.d(t,"f",(function(){return b})),a.d(t,"k",(function(){return h})),a.d(t,"i",(function(){return y})),a.d(t,"g",(function(){return E})),a.d(t,"j",(function(){return v})),a.d(t,"h",(function(){return k})),a.d(t,"b",(function(){return S})),a.d(t,"a",(function(){return x})),a.d(t,"e",(function(){return w})),a.d(t,"d",(function(){return M})),a.d(t,"c",(function(){return D}));var n=a(3),i=a(26),s=a.n(i),r=a(385),o=a.n(r),l=a(791),c=a.n(l),u=a(217),d=a(1),p=a(2),m=a(582),g=a(250),f=a(606);const b=e=>{const t={unit:"ms",value:0},a=e.match(/\d+/g),i=e.match(/[a-zA-Z]+/g);return Object(n.isEmpty)(a)||null==a||isNaN(Number(a[0]))||(t.value=Number(a[0])),!Object(n.isEmpty)(i)&&null!=i&&["s","m","h"].includes(i[0])&&(t.unit=i[0]),t},h=e=>!(null==e||!e.isValid||!e.data),y=e=>Object(n.has)("data.ruleType",e),E=e=>Object(n.has)("data.name",e),v=e=>Object(n.has)("data.interval",e),k=e=>Object(n.has)("data.actions",e),S=(e,t)=>{switch(t){case"machine_learning":const{index:t,queryBar:a,threshold:n,threatIndex:i,threatQueryBar:s,threatMapping:r,eqlOptions:o,newTermsFields:l,historyWindowSize:c,...u}=e;return u;case"threshold":const{anomalyThreshold:d,machineLearningJobId:p,threatIndex:m,threatQueryBar:g,threatMapping:f,eqlOptions:b,newTermsFields:h,historyWindowSize:y,...E}=e;return E;case"threat_match":const{anomalyThreshold:v,machineLearningJobId:k,threshold:S,eqlOptions:T,newTermsFields:x,historyWindowSize:w,...O}=e;return O;case"query":case"saved_query":const{anomalyThreshold:j,machineLearningJobId:I,threshold:C,threatIndex:M,threatQueryBar:D,threatMapping:A,eqlOptions:F,newTermsFields:R,historyWindowSize:P,..._}=e;return _;case"eql":const{anomalyThreshold:q,machineLearningJobId:N,threshold:L,threatIndex:B,threatQueryBar:z,threatMapping:H,newTermsFields:$,historyWindowSize:V,...U}=e;return U;case"new_terms":const{anomalyThreshold:Q,machineLearningJobId:W,threshold:G,threatIndex:K,threatQueryBar:J,threatMapping:Y,eqlOptions:X,...Z}=e;return Z}Object(p.a)(t)};function T(e){return e.filter((e=>"none"!==e.name))}const x=e=>e.filter((e=>"none"!==e.tactic.name)).map((e=>{var t;return{...e,technique:T(null!==(t=e.technique)&&void 0!==t?t:[]).map((e=>({...e,subtechnique:null!=e.subtechnique?T(e.subtechnique):[]})))}})),w=e=>{const t={...e};return e.dataSourceType===g.a.DataView?c()(t,["index","dataSourceType"]):e.dataSourceType===g.a.IndexPatterns?c()(t,["dataViewId","dataSourceType"]):t},O=e=>{var t,a,i,s,r,o,l,c,u,d,p,m,g,f,b,h,y,E,v,k,T,x,O,j,I,C,M,D,A,F,R,P,_,q,N,L,B,z,H,$,V,U,Q,W,G,K;const J=w(e),Y=S(J,J.ruleType),{ruleType:X,timeline:Z}=Y;var ee;return{...{type:X,...null!=Z.id&&null!=Z.title&&{timeline_id:Z.id,timeline_title:Z.title}},...(ee=Y,Object(n.has)("anomalyThreshold",ee)?{anomaly_threshold:Y.anomalyThreshold,machine_learning_job_id:Y.machineLearningJobId}:(e=>Object(n.has)("threshold",e))(Y)?{index:Y.index,filters:null===(t=Y.queryBar)||void 0===t?void 0:t.filters,language:null===(a=Y.queryBar)||void 0===a||null===(i=a.query)||void 0===i?void 0:i.language,query:null===(s=Y.queryBar)||void 0===s||null===(r=s.query)||void 0===r?void 0:r.query,saved_id:null!==(o=null===(l=Y.queryBar)||void 0===l?void 0:l.saved_id)&&void 0!==o?o:void 0,..."threshold"===X&&{threshold:{field:null!==(c=null===(u=Y.threshold)||void 0===u?void 0:u.field)&&void 0!==c?c:[],value:null!==(d=parseInt(null===(p=Y.threshold)||void 0===p?void 0:p.value,10))&&void 0!==d?d:0,cardinality:Object(n.isEmpty)(null===(m=Y.threshold.cardinality)||void 0===m?void 0:m.field)||null==(null===(g=Y.threshold.cardinality)||void 0===g?void 0:g.value)?[]:[{field:Y.threshold.cardinality.field[0],value:parseInt(Y.threshold.cardinality.value,10)}]}}}:(e=>Object(n.has)("threatIndex",e))(Y)?{index:Y.index,filters:null===(f=Y.queryBar)||void 0===f?void 0:f.filters,language:null===(b=Y.queryBar)||void 0===b||null===(h=b.query)||void 0===h?void 0:h.language,query:null===(y=Y.queryBar)||void 0===y||null===(E=y.query)||void 0===E?void 0:E.query,saved_id:null!==(v=null===(k=Y.queryBar)||void 0===k?void 0:k.saved_id)&&void 0!==v?v:void 0,threat_index:Y.threatIndex,threat_query:null===(T=Y.threatQueryBar)||void 0===T||null===(x=T.query)||void 0===x?void 0:x.query,threat_filters:null===(O=Y.threatQueryBar)||void 0===O?void 0:O.filters,threat_mapping:Y.threatMapping,threat_language:null===(j=Y.threatQueryBar)||void 0===j||null===(I=j.query)||void 0===I?void 0:I.language}:(e=>Object(n.has)("eqlOptions",e))(Y)?{index:Y.index,filters:null===(C=Y.queryBar)||void 0===C?void 0:C.filters,language:null===(M=Y.queryBar)||void 0===M||null===(D=M.query)||void 0===D?void 0:D.language,query:null===(A=Y.queryBar)||void 0===A||null===(F=A.query)||void 0===F?void 0:F.query,saved_id:null!==(R=null===(P=Y.queryBar)||void 0===P?void 0:P.saved_id)&&void 0!==R?R:void 0,timestamp_field:null===(_=Y.eqlOptions)||void 0===_?void 0:_.timestampField,event_category_override:null===(q=Y.eqlOptions)||void 0===q?void 0:q.eventCategoryField,tiebreaker_field:null===(N=Y.eqlOptions)||void 0===N?void 0:N.tiebreakerField}:(e=>Object(n.has)("newTermsFields",e))(Y)?{index:Y.index,filters:null===(L=Y.queryBar)||void 0===L?void 0:L.filters,language:null===(B=Y.queryBar)||void 0===B||null===(z=B.query)||void 0===z?void 0:z.language,query:null===(H=Y.queryBar)||void 0===H||null===($=H.query)||void 0===$?void 0:$.query,new_terms_fields:Y.newTermsFields,history_window_start:`now-${Y.historyWindowSize}`}:{index:Y.index,filters:null===(V=Y.queryBar)||void 0===V?void 0:V.filters,language:null===(U=Y.queryBar)||void 0===U||null===(Q=U.query)||void 0===Q?void 0:Q.language,query:null===(W=Y.queryBar)||void 0===W||null===(G=W.query)||void 0===G?void 0:G.query,saved_id:void 0,type:"query",...["query","saved_query"].includes(X)&&(null===(K=Y.queryBar)||void 0===K?void 0:K.saved_id)&&Y.shouldLoadQueryDynamically&&{type:"saved_query",query:void 0,filters:void 0,saved_id:Y.queryBar.saved_id}}),data_view_id:Y.dataViewId}},j=e=>{const{...t}=e;if(!Object(n.isEmpty)(t.interval)&&!Object(n.isEmpty)(t.from)){const{unit:e,value:a}=b(t.interval),{unit:n,value:i}=b(t.from),r=s.a.duration(a,e);r.add(i,n),t.from=`now-${r.asSeconds()}s`,t.to="now"}return{...t,meta:{from:e.from}}},I=(e,t)=>{const{author:a,falsePositives:i,references:s,riskScore:r,severity:o,threat:l,isAssociatedToEndpointList:c,isBuildingBlock:d,note:p,ruleNameOverride:m,threatIndicatorPath:g,timestampOverride:f,timestampOverrideFallbackDisabled:b,...h}=e,y=null!=t?t.filter((e=>"endpoint"!==e.type)):[];return{author:a.filter((e=>!Object(n.isEmpty)(e))),...d?{building_block_type:"default"}:{},...c?{exceptions_list:[{id:u.j,list_id:u.j,namespace_type:"agnostic",type:"endpoint"},...y]}:null!=t?{exceptions_list:[...y]}:{},false_positives:i.filter((e=>!Object(n.isEmpty)(e))),references:s.filter((e=>!Object(n.isEmpty)(e))),risk_score:r.value,risk_score_mapping:r.isMappingChecked?r.mapping.filter((e=>null!=e.field&&""!==e.field)):[],rule_name_override:""!==m?m:void 0,severity:o.value,severity_mapping:o.isMappingChecked?o.mapping.filter((e=>null!=e.field&&""!==e.field&&null!=e.value)):[],threat:x(l).map((e=>({...e,framework:"MITRE ATT&CK"}))),threat_indicator_path:g,timestamp_override:""!==f?f:void 0,timestamp_override_fallback_disabled:b,...Object(n.isEmpty)(p)?{}:{note:p},...h}},C=e=>{const{actions:t=[],responseActions:a,enabled:n,kibanaSiemAppUrl:i,throttle:s=d.Vb}=e;return{actions:t.map(m.a),response_actions:null==a?void 0:a.map(m.b),enabled:n,throttle:t.length?s:d.Vb,meta:{kibana_siem_app_url:i}}},M=(e,t,a,n,i)=>o.a.all([O(e),I(t,i),j(a),C(n)]),D=({defineRuleData:e,aboutRuleData:t,scheduleRuleData:a,exceptionsList:n})=>{const i={...t,name:"Preview Rule",description:"Preview Rule"};return{...M(e,i,a,f.b,n)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),s=a(24);const r=a.n(s).a.div.withConfig({displayName:"StyledDiv",componentId:"sc-1adamx3-0"})(["padding-left:",";"],(({addPadding:e})=>e&&"53px"));r.defaultProps={addPadding:!1};const o=i.a.memo(r);o.displayName="StepContentWrapper"},function(e,t,a){"use strict";var n=String.fromCharCode;e.exports=n},function(e,t,a){"use strict";var n=a(222),i=a(225),s={tokenize:function(e,t,a){return i(e,(function(e){return null===e||n(e)?t(e):a(e)}),"linePrefix")},partial:!0};e.exports=s},function(e,t,a){"use strict";var n=a(584);e.exports=function(e,t){var a=e[e.length-1];return a&&a[1].type===t?n(a[2].sliceStream(a[1])):0}},function(e,t,a){"use strict";var n=a(284)(/[\dA-Za-z]/);e.exports=n},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"e",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"h",(function(){return l})),a.d(t,"n",(function(){return c})),a.d(t,"m",(function(){return u})),a.d(t,"l",(function(){return d})),a.d(t,"i",(function(){return p})),a.d(t,"j",(function(){return m})),a.d(t,"o",(function(){return g})),a.d(t,"k",(function(){return f})),a.d(t,"g",(function(){return b})),a.d(t,"f",(function(){return h})),a.d(t,"p",(function(){return y})),a.d(t,"q",(function(){return E})),a.d(t,"a",(function(){return v})),a.d(t,"r",(function(){return k})),a.d(t,"s",(function(){return S}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.stepDefineRule.lastHour",{defaultMessage:"Last hour"}),s=n.i18n.translate("xpack.securitySolution.stepDefineRule.lastDay",{defaultMessage:"Last day"}),r=n.i18n.translate("xpack.securitySolution.stepDefineRule.lastWeek",{defaultMessage:"Last week"}),o=n.i18n.translate("xpack.securitySolution.stepDefineRule.lastMonth",{defaultMessage:"Last month"}),l=(n.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryButton",{defaultMessage:"Preview results"}),n.i18n.translate("xpack.securitySolution.stepDefineRule.quickPreviewToggleButton",{defaultMessage:"Quick query preview"}),n.i18n.translate("xpack.securitySolution.stepDefineRule.advancedPreviewToggleButton",{defaultMessage:"Advanced query preview"}),n.i18n.translate("xpack.securitySolution.stepDefineRule.previewTimeoutWarning",{defaultMessage:"Preview timed out after 60 seconds"})),c=(n.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryAriaLabel",{defaultMessage:"Query preview timeframe select"}),n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewLabel",{defaultMessage:"Select a preview timeframe"})),u=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewInvocationCountWarningTitle",{defaultMessage:"Rule preview timeframe might cause timeout"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewInvocationCountWarningMessage",{defaultMessage:"The timeframe and rule interval that you selected for previewing this rule might cause timeout or take long time to execute. Try to decrease the timeframe and/or increase the interval if preview has timed out (this won't affect the actual rule run)."}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphCountLabel",{defaultMessage:"Count"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewTitle",{defaultMessage:"Rule Preview"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewNoiseWarning",{defaultMessage:"Noise warning: This rule may cause a lot of noise. Consider narrowing your query. This is based on a linear progression of 1 alert per hour."}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewError",{defaultMessage:"Error fetching preview"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.histogramDisclaimer",{defaultMessage:"Note: Alerts with multiple event.category values will be counted more than once."}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.mlHistogramDisclaimer",{defaultMessage:"Note: Alerts with multiple host.name values will be counted more than once."}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSeeAllErrors",{defaultMessage:"See all errors"}),E=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSeeAllWarnings",{defaultMessage:"See all warnings"}),v=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.actions",{defaultMessage:"Actions"}),k=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.viewDetailsAriaLabel",{defaultMessage:"View details"}),S=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.viewDetailsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"View details for the alert or event in row {ariaRowindex}, with columns {columnValues}"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return u}));var n=a(4),i=a(218),s=a(202),r=a(244),o=a(274);const l="prePackagedRulesStatus",c=()=>{const{addError:e}=Object(s.a)();return Object(i.useQuery)([l],(async({signal:e})=>{const t=await Object(r.h)({signal:e});return{rulesCustomInstalled:t.rules_custom_installed,rulesInstalled:t.rules_installed,rulesNotInstalled:t.rules_not_installed,rulesNotUpdated:t.rules_not_updated,timelinesInstalled:t.timelines_installed,timelinesNotInstalled:t.timelines_not_installed,timelinesNotUpdated:t.timelines_not_updated}}),{staleTime:3e5,onError:t=>{e(t,{title:o.h})}})},u=()=>{const e=Object(i.useQueryClient)();return Object(n.useCallback)((()=>{e.invalidateQueries([l],{refetchType:"active"})}),[e])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(4);const i=(e=!1)=>{const[t,a]=Object(n.useState)(e);return[t,Object(n.useCallback)((()=>{a(!0)}),[]),Object(n.useCallback)((()=>{a(!1)}),[]),Object(n.useCallback)((()=>{a((e=>!e))}),[])]}},function(e,t,a){"use strict";a.d(t,"m",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return r})),a.d(t,"l",(function(){return o})),a.d(t,"j",(function(){return l})),a.d(t,"k",(function(){return c})),a.d(t,"i",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"o",(function(){return m})),a.d(t,"n",(function(){return g})),a.d(t,"f",(function(){return f})),a.d(t,"g",(function(){return b})),a.d(t,"d",(function(){return h})),a.d(t,"b",(function(){return y}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.detectionsPageTitle",{defaultMessage:"Alerts"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.alertTitle",{defaultMessage:"Alerts"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.buttonManageRules",{defaultMessage:"Manage rules"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.noIndexTitle",{defaultMessage:"Let’s set up your detection engine"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsAndListsIndexesMessage",{defaultMessage:"You need permissions for the signals and lists indices."}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsIndexMessage",{defaultMessage:"You need permissions for the signals index."}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.needsListsIndexesMessage",{defaultMessage:"You need permissions for the lists indices."}),d=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.needsIndexPermissionsMessage",{values:{additionalContext:e},defaultMessage:"To use the detection engine, a user with the required cluster and index privileges must first access this page. {additionalContext} For more help, contact your Elastic Stack administrator."}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.goToDocumentationButton",{defaultMessage:"View documentation"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedTitle",{defaultMessage:"Detection engine permissions required"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedMsgBody",{defaultMessage:"You do not have the required permissions for viewing the detection engine. For more help, contact your administrator."}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.mlRulesDisabledMessageTitle",{defaultMessage:"ML rules require Platinum License and ML Admin Permissions"}),b=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.mlUnavailableTitle",{values:{totalRules:e},defaultMessage:"{totalRules} {totalRules, plural, =1 {rule requires} other {rules require}} Machine Learning to enable."}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.noPermissionsTitle",{defaultMessage:"Privileges required"}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.noPermissionsMessage",{defaultMessage:"To view alerts, you must update privileges. For more information, contact your Kibana administrator."})},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a(62);const s=(e,t)=>{const a=Object(i.useHistory)();return Object(n.useCallback)((n=>{try{t&&t(n)}catch(e){throw n.preventDefault(),e}n.defaultPrevented||0===n.button&&(n.currentTarget instanceof HTMLAnchorElement&&""!==n.currentTarget.target&&"_self"!==n.currentTarget.target||n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||(n.preventDefault(),Array.isArray(e)?a.push(...e):a.push(e)))}),[a,t,e])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return BlocklistsApiClient}));var n=a(217),i=a(458),s=a(314),r=a(496);function o(e){return{...e,entries:Object(i.b)(e.entries)}}function l(e){return{...e,entries:Object(i.a)(e.entries)}}class BlocklistsApiClient extends s.a{constructor(e){super(e,n.b,r.a,o,l)}static getInstance(e){return super.getInstance(e,n.b,r.a,o,l)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return Re}));var n,i,s=a(17),r=a(3),o=a(4),l=a.n(o),c=a(24),u=a.n(c),d=a(44),p=a(180),m=a(684),g=a(370),f=a(19),b=a(40),h=a(121),y=a.n(h),E=a(122),v=a.n(E),k=a(11),S=a.n(k);!function(e){e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram"}(n||(n={})),function(e){e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing"}(i||(i={}));var T=y()((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v()(this,e),S()(this,"name",void 0),S()(this,"sortable",void 0),S()(this,"filterable",void 0),S()(this,"esTypes",void 0),this.name=t.name||i.UNKNOWN,this.sortable=t.sortable||!1,this.filterable=t.filterable||!1,this.esTypes=Object.freeze((t.esTypes||[]).slice())})),x=new T({name:i.UNKNOWN}),w=[new T({name:i.STRING,sortable:!0,filterable:!0,esTypes:[n.STRING,n.TEXT,n.MATCH_ONLY_TEXT,n.KEYWORD,n.VERSION,n._TYPE,n._ID]}),new T({name:i.NUMBER,sortable:!0,filterable:!0,esTypes:[n.FLOAT,n.HALF_FLOAT,n.SCALED_FLOAT,n.DOUBLE,n.INTEGER,n.LONG,n.UNSIGNED_LONG,n.SHORT,n.BYTE,n.TOKEN_COUNT,n.AGGREGATE_METRIC_DOUBLE]}),new T({name:i.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[n.FLOAT_RANGE,n.DOUBLE_RANGE,n.INTEGER_RANGE,n.LONG_RANGE]}),new T({name:i.DATE,sortable:!0,filterable:!0,esTypes:[n.DATE,n.DATE_NANOS]}),new T({name:i.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[n.DATE_RANGE]}),new T({name:i.IP,sortable:!0,filterable:!0,esTypes:[n.IP]}),new T({name:i.IP_RANGE,sortable:!0,filterable:!0,esTypes:[n.IP_RANGE]}),new T({name:i.BOOLEAN,sortable:!0,filterable:!0,esTypes:[n.BOOLEAN]}),new T({name:i.OBJECT,esTypes:[n.OBJECT]}),new T({name:i.NESTED,esTypes:[n.NESTED]}),new T({name:i.GEO_POINT,esTypes:[n.GEO_POINT]}),new T({name:i.GEO_SHAPE,esTypes:[n.GEO_SHAPE]}),new T({name:i.ATTACHMENT,esTypes:[n.ATTACHMENT]}),new T({name:i.MURMUR3,esTypes:[n.MURMUR3]}),new T({name:i._SOURCE,esTypes:[n._SOURCE]}),new T({name:i.HISTOGRAM,filterable:!0,esTypes:[n.HISTOGRAM]}),new T({name:i.CONFLICT}),x],O=a(882),j=a(188),I=a(482),C=a(2),M=a(580),D=a(581),A=a(357),F=a(6);const R=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"}),P=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.QueryLabel",{defaultMessage:"Custom query"}),_=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"}),q=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"}),N=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryFiltersLabel",{defaultMessage:"Saved query filters"}),L=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryLabel",{defaultMessage:"Saved query"}),B=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"}),z=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"}),H=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"}),$=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"}),V=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"}),U=F.i18n.translate("xpack.securitySolution.detectionEngine.createRule.newTermsRuleTypeDescription",{defaultMessage:"New Terms"}),Q=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"}),W=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),G=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"}),K=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"}),J=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlEventCategoryFieldLabel",{defaultMessage:"Event category field"}),Y=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTiebreakerFieldLabel",{defaultMessage:"Tiebreaker field"}),X=F.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTimestampFieldLabel",{defaultMessage:"Timestamp field"});var Z=a(563),ee=a(790),te=a.n(ee),ae=a(203);const ne=u()(s.EuiFlexItem).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-123zi2b-0"})(["height:105px;overflow-y:hidden;"]),ie=e=>!Object(r.isEmpty)(e.join("")),se=u()(s.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-123zi2b-1"})([".euiBadge__text{white-space:pre-wrap !important;}"]),re=u.a.div.withConfig({displayName:"Query",componentId:"sc-123zi2b-2"})(["white-space:pre-wrap;"]),oe=({field:e,filters:t,filterManager:a,query:n,savedId:i,savedQueryName:o,indexPatterns:c,queryLabel:u})=>{let d=[];const m=!Object(r.isEmpty)(i)&&!Object(r.isEmpty)(o);return m&&(d=[...d,{title:l.a.createElement(l.a.Fragment,null,q," "),description:l.a.createElement(l.a.Fragment,null,o," ")}]),Object(r.isEmpty)(t)||(a.setFilters(t),d=[...d,{title:l.a.createElement(l.a.Fragment,null,m?N:R," "),description:l.a.createElement(s.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},a.getFilters().map(((t,a)=>l.a.createElement(s.EuiFlexItem,{grow:!1,key:`${e}-filter-${a}`},l.a.createElement(se,{color:"hollow"},null!=c?l.a.createElement(j.FilterLabel,{filter:t,valueLabel:Object(p.getDisplayValueFromFilter)(t,[c])}):l.a.createElement(s.EuiLoadingSpinner,{size:"m"}))))))}]),Object(r.isEmpty)(n)||(d=[...d,{title:l.a.createElement(l.a.Fragment,null,m?L:null!=u?u:P),description:l.a.createElement(re,null,n)}]),d},le=u()(s.EuiFlexGroup).withConfig({displayName:"ThreatEuiFlexGroup",componentId:"sc-123zi2b-3"})([".euiFlexItem{margin-bottom:0px;}"]),ce=u()(s.EuiFlexItem).withConfig({displayName:"SubtechniqueFlexItem",componentId:"sc-123zi2b-4"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),ue=u()(s.EuiButtonEmpty).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-123zi2b-5"})([".euiIcon{width:8px;height:8px;}align-self:flex-start;"]),de=u()(s.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-123zi2b-6"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),pe=u()(s.EuiLink).withConfig({displayName:"MyRefUrlLink",componentId:"sc-123zi2b-7"})(["word-break:break-word;"]),me=u()(s.EuiText).withConfig({displayName:"FieldTypeText",componentId:"sc-123zi2b-8"})(["font-size:",";font-family:",";display:inline;"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily));var ge,fe=a(186),be=a(263),he=a(502);!function(e){e.info="info",e.warning="warning",e.error="error"}(ge||(ge={}));const ye=({message:e})=>{if(!e)return null;let t="primary",a="alert";return e.level===ge.info?a="iInCircle":e.level===ge.warning?t="warning":e.level===ge.error&&(t="danger"),l.a.createElement(s.EuiToolTip,{content:e.text},l.a.createElement(s.EuiIcon,{type:a,color:t}))},Ee=l.a.memo(ye),ve=({job:e})=>{const t=Object(be.c)(e.jobState,e.datafeedState),a=t?"success":"danger",n=t?Q:W;return l.a.createElement(s.EuiBadge,{"data-test-subj":"machineLearningJobStatus",color:a},n)},ke=l.a.memo(ve),Se=u()(s.EuiLink).withConfig({displayName:"JobLink",componentId:"sc-c3w1h4-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),Te=u.a.div.withConfig({displayName:"Wrapper",componentId:"sc-c3w1h4-1"})(["overflow:hidden;"]),xe=({jobId:e})=>{const{jobs:t}=Object(he.a)(!1),{services:{http:a,ml:n}}=Object(f.k)(),i=Object(fe.useMlHref)(n,a.basePath.get(),{page:fe.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[e]}}),s=t.find((({id:t})=>t===e)),r=l.a.createElement("span",{"data-test-subj":"machineLearningJobId"},e);return null!=s?l.a.createElement(Te,null,l.a.createElement("div",null,l.a.createElement(Se,{href:i,target:"_blank"},r),l.a.createElement(Ee,{message:s.auditMessage})),l.a.createElement(ke,{job:s})):r},we=l.a.memo(xe),Oe=({jobIds:e})=>l.a.createElement(l.a.Fragment,null,e.map((e=>l.a.createElement(we,{key:e,jobId:e})))),je=({actions:e})=>e.length?l.a.createElement("ul",null,e.map(((e,t)=>l.a.createElement("li",{key:t},Ie(e.actionTypeId))))):null,Ie=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(r.startCase)(t):""};var Ce=a(523);const Me=(e=Ce.a.value,t)=>{const a=Object(r.find)(["value",e],Ce.c);return{title:t,description:a?a.text:e}};var De=a(405);const Ae=u()(s.EuiDescriptionList).withConfig({displayName:"DescriptionListContainer",componentId:"sc-1jqwta0-0"})(["&.euiDescriptionList--column .euiDescriptionList__title{width:30%;}&.euiDescriptionList--column .euiDescriptionList__description{width:70%;overflow-wrap:anywhere;}"]),Fe=({data:e,columns:t="multi",indexPatterns:a,schema:n})=>{const i=Object(f.k)(),[c]=Object(o.useState)(new p.FilterManager(i.services.uiSettings)),u=Object.keys(n).reduce(((t,i)=>{return"machineLearningJobId"===i?[...t,(s=Object(r.get)(i,e),o=Object(r.get)(i,n).label,{title:o,description:l.a.createElement(Oe,{jobIds:s})})]:"throttle"===i?[...t,Me(Object(r.get)(i,e),Object(r.get)([i,"label"],n))]:"actions"===i?[...t,(u=Object(r.get)(i,e),d=Object(r.get)([i,"label"],n),{title:u.length?d:"",description:l.a.createElement(je,{actions:u})})]:[...t,...Pe(e,Object(r.pick)(i,n),c,a)];var s,o,u,d}),[]);return"multi"===t?l.a.createElement(s.EuiFlexGroup,null,Object(r.chunk)(Math.ceil(u.length/2),u).map(((e,t)=>l.a.createElement(s.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription",key:`description-step-rule-${t}`},l.a.createElement(s.EuiDescriptionList,{listItems:e}))))):l.a.createElement(s.EuiFlexGroup,null,l.a.createElement(s.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription"},"single"===t?l.a.createElement(s.EuiDescriptionList,{listItems:u}):l.a.createElement(Ae,{"data-test-subj":"singleSplitStepRuleDescriptionList",type:"column",listItems:u})))},Re=Object(o.memo)(Fe),Pe=(e,t,a,n)=>Object.keys(t).reduce(((i,s)=>[...i,...qe(s,Object(r.get)([s,"label"],t),e,a,n)]),[]),_e=e=>e.map((e=>null==e.$state?{$state:{store:d.b.APP_STATE},...e}:e)),qe=(e,t,a,n,o)=>{if("queryBar"===e){var c;const t=_e(null!==(c=Object(r.get)("queryBar.filters",a))&&void 0!==c?c:[]),i=Object(r.get)("queryBar.query.query",a),s=Object(r.get)("queryBar.saved_id",a),l=Object(r.get)("queryBar.title",a);return oe({field:e,filters:t,filterManager:n,query:i,savedId:s,savedQueryName:l,indexPatterns:o})}if("eqlOptions"===e)return(e=>{let t=[];return Object(r.isEmpty)(e.eventCategoryField)||(t=[...t,{title:l.a.createElement(l.a.Fragment,null,J),description:l.a.createElement(l.a.Fragment,null,e.eventCategoryField)}]),Object(r.isEmpty)(e.tiebreakerField)||(t=[...t,{title:l.a.createElement(l.a.Fragment,null,Y),description:l.a.createElement(l.a.Fragment,null,e.tiebreakerField)}]),Object(r.isEmpty)(e.timestampField)||(t=[...t,{title:l.a.createElement(l.a.Fragment,null,X),description:l.a.createElement(l.a.Fragment,null,e.timestampField)}]),t})(Object(r.get)(e,a));if("threat"===e){const n=Object(r.get)(e,a);return(({label:e,threat:t})=>t.length>0?[{title:e,description:l.a.createElement(le,{direction:"column"},t.map(((e,t)=>{const a=A.b.find((t=>t.id===e.tactic.id));return l.a.createElement(s.EuiFlexItem,{key:`${e.tactic.name}-${t}`},l.a.createElement(s.EuiLink,{"data-test-subj":"threatTacticLink",href:e.tactic.reference,target:"_blank"},null!=a?a.text:`${e.tactic.name} (${e.tactic.id})`),l.a.createElement(s.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},e.technique&&e.technique.map(((e,t)=>{var a;const n=A.c.find((t=>t.id===e.id));return l.a.createElement(s.EuiFlexItem,{key:null!==(a=null==n?void 0:n.id)&&void 0!==a?a:t},l.a.createElement(ue,{"data-test-subj":"threatTechniqueLink",href:e.reference,target:"_blank",iconType:te.a,size:"xs"},null!=n?n.label:`${e.name} (${e.id})`),l.a.createElement(s.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},null!=e.subtechnique&&e.subtechnique.map(((e,t)=>{var a;const n=A.a.find((t=>t.id===e.id));return l.a.createElement(ce,{key:null!==(a=null==n?void 0:n.id)&&void 0!==a?a:t},l.a.createElement(ue,{"data-test-subj":"threatSubtechniqueLink",href:e.reference,target:"_blank",iconType:te.a,size:"xs"},null!=n?n.label:`${e.name} (${e.id})`))}))))}))))})),l.a.createElement(s.EuiSpacer,null))}]:[])({label:t,threat:Object(De.a)(n)})}if("threshold"===e)return((e,t)=>[{title:e,description:l.a.createElement(l.a.Fragment,null,Object(r.isEmpty)(t.field[0])?`${G} >= ${t.value}`:`${K} ${Array.isArray(t.field)?t.field.join(","):t.field} >= ${t.value}`)}])(t,Object(r.get)(e,a));if("references"===e)return((e,t)=>ie(t)?[{title:e,description:l.a.createElement(s.EuiText,{size:"s"},l.a.createElement("ul",null,t.filter((e=>!Object(r.isEmpty)(e))).map(((e,t)=>l.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},l.a.createElement(pe,{href:e,external:!0,target:"_blank"},e))))))}]:[])(t,Object(r.get)(e,a));if("falsePositives"===e)return((e,t,a)=>ie(a)?[{title:e,description:l.a.createElement(s.EuiText,{size:"s"},l.a.createElement("ul",null,a.map((e=>Object(r.isEmpty)(e)?null:l.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:`${t}-${e}`},e)))))}]:[])(t,e,Object(r.get)(e,a));if("riskScore"===e){return p=Object(r.get)(e,a),[{title:D.b,description:p.value},...p.isMappingChecked?p.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?D.e:"",description:l.a.createElement(s.EuiFlexGroup,{alignItems:"center"},l.a.createElement(de,null,l.a.createElement(s.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField${t}`},l.a.createElement(l.a.Fragment,null,e.field))),l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(s.EuiIcon,{type:"sortRight"})),l.a.createElement(s.EuiFlexItem,null,b.j))}))):[]]}if("severity"===e){return d=Object(r.get)(e,a),[{title:M.a,description:l.a.createElement(Z.a,{value:d.value})},...d.isMappingChecked?d.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?M.d:"",description:l.a.createElement(s.EuiFlexGroup,{alignItems:"center"},l.a.createElement(de,null,l.a.createElement(s.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField${t}`},l.a.createElement(l.a.Fragment,null,`${e.field}:`))),l.a.createElement(de,null,l.a.createElement(s.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue${t}`},Object(ae.a)(e.value))),l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(s.EuiIcon,{type:"sortRight"})),l.a.createElement(s.EuiFlexItem,null,l.a.createElement(Z.a,{"data-test-subj":`severityOverrideSeverity${t}`,value:e.severity})))}))):[]]}if("requiredFields"===e)return((e,t)=>Object(r.isEmpty)(t)?[]:[{title:e,description:l.a.createElement(s.EuiFlexGrid,{gutterSize:"s"},t.map(((e,a)=>{return l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(O.a,{"data-test-subj":"field-type-icon",type:(n=e.type,r=w.find((function(e){return e.esTypes.includes(n)})),r&&r.name?r.name:i.UNKNOWN),label:e.type})),l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(me,{grow:!1,size:"s"},` ${e.name}${a+1!==t.length?", ":""}`))));var n,r})))}])(t,Object(r.get)(e,a));if("relatedIntegrations"===e){const n=Object(r.get)(e,a);return Object(m.b)(t,n)}var u,d,p;if("timeline"===e)return[{title:t,description:null!==(u=Object(r.get)(e,a).title)&&void 0!==u?u:g.b}];if("note"===e)return((e,t)=>""!==t.trim()?[{title:e,description:l.a.createElement(ne,null,l.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[])(t,Object(r.get)(e,a));if("ruleType"===e)return((e,t)=>{switch(t){case"machine_learning":return[{title:e,description:B}];case"query":case"saved_query":return[{title:e,description:H}];case"threshold":return[{title:e,description:$}];case"eql":return[{title:e,description:z}];case"threat_match":return[{title:e,description:V}];case"new_terms":return[{title:e,description:U}];default:return Object(C.a)(t)}})(t,Object(r.get)(e,a));if("kibanaSiemAppUrl"===e)return[];if("threatQueryBar"===e){var f;const t=_e(null!==(f=Object(r.get)("threatQueryBar.filters",a))&&void 0!==f?f:[]),i=Object(r.get)("threatQueryBar.query.query",a),s=Object(r.get)("threatQueryBar.saved_id",a);return oe({field:e,filters:t,filterManager:n,query:i,savedId:s,indexPatterns:o,queryLabel:_})}if("threatMapping"===e){return[{title:t,description:Object(r.get)(e,a).reduce(((e,t,a,{length:n})=>{const i=t.entries.reduce(((e,t,a,{length:n})=>1===n?`${t.field} ${I.d} ${t.value}`:0===a?`(${t.field} ${I.d} ${t.value})`:`${e} ${I.a} (${t.field} ${I.d} ${t.value})`),"");return 1===n?`${i}`:0===a?`(${i})`:`${e} ${I.e} (${i})`}),"")}]}if("dataViewId"===e)return[];if(Array.isArray(Object(r.get)(e,a))&&"threatMapping"!==e)return((e,t,a)=>ie(a)?[{title:e,description:l.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},a.map((e=>Object(r.isEmpty)(e)?null:l.a.createElement(s.EuiFlexItem,{grow:!1,key:`${t}-${e}`},l.a.createElement(se,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},e)))))}]:[])(t,e,Object(r.get)(e,a));if("index"===e&&Object(r.get)("dataViewId",a))return[];const h=Object(r.get)(e,a);return Object(r.isNumber)(h)||!Object(r.isEmpty)(h)?[{title:t,description:h}]:[]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return Ie}));var n=a(4),i=a.n(n),s=a(47),r=a(17),o=a(91),l=a(94),c=a(15),u=a(76),d=a(92),p=a.n(d),m=a(676),g=a(887),f=a(757),b=a(877),h=a(559),y=a(394),E=a(362),v=a(880);const k=({browserFields:e,entityType:t="events",expandedEvent:a,handleOnEventClosed:s,isDraggable:o,isFlyoutView:l,runtimeMappings:c,tabType:u,timelineId:d,isReadOnly:p})=>{var k,S;const T=Object(y.a)(),{indexName:x}=a,w=null!==(k=Object(h.a)(x,T))&&void 0!==k?k:x,[O,j,I,C,M]=Object(g.a)({entityType:t,indexName:null!=w?w:"",eventId:null!==(S=a.eventId)&&void 0!==S?S:"",runtimeMappings:c,skip:!a.eventId}),{isolateAction:D,isHostIsolationPanelOpen:A,isIsolateActionSuccessBannerVisible:F,handleIsolationActionSuccess:R,showAlertDetails:P,showHostIsolationPanel:_}=Object(f.a)(),{alertId:q,isAlert:N,hostName:L,ruleName:B,timestamp:z}=Object(h.b)(j),H=Object(n.useMemo)((()=>l||A?i.a.createElement(b.c,{isHostIsolationPanelOpen:A,isAlert:N,isolateAction:D,loading:O,ruleName:B,showAlertDetails:P,timestamp:z}):i.a.createElement(m.b,{isAlert:N,loading:O,ruleName:B,handleOnEventClosed:s})),[s,N,l,A,D,O,B,P,z]),$=Object(n.useMemo)((()=>l?i.a.createElement(b.a,{alertId:q,browserFields:e,detailsData:j,detailsEcsData:C,event:a,hostName:L,handleIsolationActionSuccess:R,handleOnEventClosed:s,isAlert:N,isDraggable:o,isolateAction:D,isIsolateActionSuccessBannerVisible:F,isHostIsolationPanelOpen:A,loading:O,rawEventData:I,showAlertDetails:P,timelineId:d,isReadOnly:p}):A?i.a.createElement(i.a.Fragment,null,F&&i.a.createElement(E.d,{hostName:L,alertId:q,isolateAction:D}),i.a.createElement(r.EuiFlyoutBody,null,i.a.createElement(v.a,{details:j,cancelCallback:P,successCallback:R,isolateAction:D}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(m.a,{browserFields:e,detailsData:j,detailsEcsData:C,event:a,isAlert:N,isDraggable:o,loading:O,rawEventData:I,timelineId:d,timelineTabType:u,handleOnEventClosed:s}))),[q,e,j,C,a,R,s,L,N,o,l,A,F,p,D,O,I,P,u,d]);return null!=a&&a.eventId?i.a.createElement(i.a.Fragment,null,H,$,i.a.createElement(b.b,{detailsData:j,detailsEcsData:C,expandedEvent:a,refetchFlyoutData:M,handleOnEventClosed:s,isHostIsolationPanelOpen:A,isReadOnly:p,loadingEventDetails:O,onAddIsolationStatusClick:_,timelineId:d})):null},S=i.a.memo(k,((e,t)=>p()(e.browserFields,t.browserFields)&&p()(e.expandedEvent,t.expandedEvent)&&e.timelineId===t.timelineId&&e.isDraggable===t.isDraggable));var T=a(6),x=a(24),w=a.n(x),O=a(8),j=a(204),I=a(213),C=a(207),M=a(682),D=a(23),A=a(475),F=a(658),R=a(350),P=a(693);const _=w.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-18s5s5o-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),q=({hostName:e})=>i.a.createElement(r.EuiTitle,{size:"s"},i.a.createElement(_,null,T.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.title",{defaultMessage:"Host details"}),`: ${e}`)),N=({hostName:e})=>i.a.createElement(j.d,{hostName:e,isButton:!0},T.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.hostDetailsPageLink",{defaultMessage:"View details page"})),L=({contextID:e,hostName:t,isDraggable:a=!1})=>{const{to:r,from:o,isInitializing:l}=Object(I.a)(),{selectedPatterns:c}=Object(C.d)(),u=Object(s.useDispatch)(),[d,{hostDetails:p}]=Object(P.b)({endDate:r,hostName:t,indexNames:c,startDate:o}),m=Object(n.useCallback)(((e,t)=>{const a=Object(R.a)(e,t);u(Object(D.setAbsoluteRangeDatePicker)({id:O.a.global,from:a.from,to:a.to}))}),[u]);return i.a.createElement(A.a,{criteriaFields:Object(F.a)(p),startDate:o,endDate:r,skip:l},(({isLoadingAnomaliesData:n,anomaliesData:s})=>i.a.createElement(M.a,{contextID:e,id:P.a,isInDetailsSidePanel:!0,data:p,anomaliesData:s,isDraggable:a,isLoadingAnomaliesData:n,indexNames:c,loading:d,startDate:o,endDate:r,narrowDateRange:m,hostName:t})))},B=w()(r.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-hctd1a-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;margin-bottom:64px;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 0px`)),z=w()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-hctd1a-1"})(["flex:1 0 auto;"]),H=w()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-hctd1a-2"})(["align-self:flex-start;flex:1 0 auto;"]),$=w.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-hctd1a-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),V=i.a.memo((({contextID:e,expandedHost:t,handleOnHostClosed:a,isDraggable:n,isFlyoutView:s})=>{const{hostName:o}=t;return o?s?i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(q,{hostName:o})),i.a.createElement(B,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(N,{hostName:o}),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(L,{contextID:e,hostName:o}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(z,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(q,{hostName:o})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonIcon,{iconType:"cross","aria-label":T.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.close",{defaultMessage:"close"}),onClick:a}))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(H,{grow:!1},i.a.createElement(N,{hostName:o})),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement($,null,i.a.createElement(L,{contextID:e,hostName:o,isDraggable:n}))):null}));var U=a(177),Q=a(296),W=a(549),G=a(548),K=a(19),J=a(253),Y=a(78),X=a(620),Z=a(214),ee=a(365),te=a(623),ae=a(286);const ne=w.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-rlvmr5-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),ie=({ip:e})=>i.a.createElement(r.EuiTitle,{size:"s"},i.a.createElement(ne,null,T.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.title",{defaultMessage:"Network details"}),`: ${e}`)),se=({expandedNetwork:{ip:e,flowTarget:t}})=>i.a.createElement(j.h,{ip:e,flowTarget:t,isButton:!0},T.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.networkDetailsPageLink",{defaultMessage:"View details page"})),re=({contextID:e,expandedNetwork:t,isDraggable:a})=>{const{ip:r,flowTarget:o}=t,l=Object(s.useDispatch)(),{to:c,from:d,isInitializing:p}=Object(I.a)(),m=Object(n.useMemo)((()=>Y.f.globalQuerySelector()),[]),g=Object(n.useMemo)((()=>Y.f.globalFiltersQuerySelector()),[]),f=Object(u.a)(m),b=Object(u.a)(g),h=Z.c.NetworkType.details,y=Object(n.useCallback)(((e,t)=>{const a=Object(R.a)(e,t);l(Object(D.setAbsoluteRangeDatePicker)({id:O.a.global,from:a.from,to:a.to}))}),[l]),{services:{uiSettings:E}}=Object(K.k)(),{indicesExist:v,indexPattern:k,selectedPatterns:S}=Object(C.d)(),[T,x]=Object(J.c)({config:Object(U.getEsQueryConfig)(E),indexPattern:k,queries:[f],filters:b}),[w,{id:j,networkDetails:M}]=Object(X.b)({skip:p||void 0===T,filterQuery:T,indexNames:S,ip:r});Object(Q.a)({id:j,filterQuery:T,kqlError:x,query:f,startDate:d,endDate:c});const{jobIds:A}=Object(ae.b)(),[F,P]=Object(ee.a)({criteriaFields:Object(G.a)(r,o),startDate:d,endDate:c,skip:p,jobIds:A,aggregationInterval:"auto"});return v?i.a.createElement(W.a,{contextID:e,id:j,ip:r,data:M,anomaliesData:P,loading:w,isInDetailsSidePanel:!0,isLoadingAnomaliesData:F,isDraggable:a,type:h,flowTarget:o,startDate:d,endDate:c,narrowDateRange:y,indexPatterns:S}):i.a.createElement(te.a,null)},oe=w()(r.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-uvw88-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),le=w()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-uvw88-1"})(["flex:1 0 auto;"]),ce=w()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-uvw88-2"})(["align-self:flex-start;flex:1 0 auto;"]),ue=w.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-uvw88-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),de=i.a.memo((({contextID:e,expandedNetwork:t,handleOnNetworkClosed:a,isFlyoutView:n,isDraggable:s})=>{const{ip:o}=t;return n?i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(ie,{ip:o})),i.a.createElement(oe,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(se,{expandedNetwork:t}),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(re,{contextID:e,expandedNetwork:t}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(le,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(ie,{ip:o})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonIcon,{iconType:"cross","aria-label":T.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:a}))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(ce,{grow:!1},i.a.createElement(se,{expandedNetwork:t})),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(ue,null,i.a.createElement(re,{contextID:e,expandedNetwork:t,isDraggable:s})))}));var pe=a(694),me=a(695),ge=a(574),fe=a(230);const be=w.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-1tknvzp-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),he=({userName:e})=>i.a.createElement(r.EuiTitle,{size:"s"},i.a.createElement(be,null,T.i18n.translate("xpack.securitySolution.timeline.sidePanel.userDetails.title",{defaultMessage:"User details"}),`: ${e}`)),ye=({userName:e})=>i.a.createElement(j.m,{userName:e,isButton:!0},T.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.userDetails",{defaultMessage:"View details page"})),Ee=({contextID:e,userName:t,isDraggable:a})=>{const{to:r,from:o,isInitializing:l}=Object(I.a)(),{selectedPatterns:c}=Object(C.d)(),u=Object(s.useDispatch)(),[d,{userDetails:p}]=Object(me.a)({endDate:r,startDate:o,userName:t,indexNames:c,skip:l}),m=Object(n.useCallback)(((e,t)=>{const a=Object(R.a)(e,t);u(Object(D.setAbsoluteRangeDatePicker)({id:O.a.global,from:a.from,to:a.to}))}),[u]);return i.a.createElement(A.a,{criteriaFields:Object(ge.a)(fe.UsersType.details,t),startDate:o,endDate:r,skip:l},(({isLoadingAnomaliesData:n,anomaliesData:s})=>i.a.createElement(pe.a,{userName:t,isInDetailsSidePanel:!0,data:p,loading:d,contextID:e,isDraggable:a,id:"usersDetailsQuery",anomaliesData:s,isLoadingAnomaliesData:n,startDate:o,endDate:r,narrowDateRange:m,indexPatterns:c})))},ve=w()(r.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-shafkc-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),ke=({contextID:e,userName:t})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(he,{userName:t})),i.a.createElement(ve,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(ye,{userName:t}),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(Ee,{contextID:e,userName:t}))),Se=w()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1t5j3rb-0"})(["flex:1 0 auto;"]),Te=w()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-1t5j3rb-1"})(["align-self:flex-start;flex:1 0 auto;"]),xe=w.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-1t5j3rb-2"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),we=({contextID:e,userName:t,isDraggable:a,handleOnClose:n})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Se,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(he,{userName:t})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonIcon,{iconType:"cross","aria-label":T.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:n}))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(Te,{grow:!1},i.a.createElement(ye,{userName:t})),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(xe,null,i.a.createElement(Ee,{contextID:e,userName:t,isDraggable:a}))),Oe=({contextID:e,userName:t,handleOnClose:a,isFlyoutView:n,isDraggable:s})=>n?i.a.createElement(ke,{userName:t,contextID:e}):i.a.createElement(we,{userName:t,contextID:e,isDraggable:s,handleOnClose:a}),je=i.a.memo(Oe),Ie=i.a.memo((({browserFields:e,entityType:t,handleOnPanelClosed:a,isFlyoutView:d,runtimeMappings:p,tabType:m,timelineId:g,isReadOnly:f})=>{var b,h,y,E;const v=Object(s.useDispatch)(),k=Object(n.useMemo)((()=>o.b.getTimelineByIdSelector()),[]),T=Object(u.a)((e=>{var t;return(null!==(t=k(e,g))&&void 0!==t?t:l.a).expandedDetail})),x=Object(n.useCallback)((()=>{v(o.a.toggleDetailPanel({timelineId:g}))}),[v,g]),w=null!=m?m:c.l.query,O=Object(n.useCallback)((()=>{a?a():x()}),[x,a]);if(!T)return null;const j=T[w];if(null==j||!j.panelView)return null;let I=null,C="s",M=g;const D=`${g}-${w}`,A=g===c.i.active&&w===c.l.query;return"eventDetail"===(null==j?void 0:j.panelView)&&null!=j&&null!==(b=j.params)&&void 0!==b&&b.eventId&&(C="m",M=j.params.eventId,I=i.a.createElement(S,{browserFields:e,entityType:t,expandedEvent:null==j?void 0:j.params,handleOnEventClosed:O,isDraggable:A,isFlyoutView:d,runtimeMappings:p,tabType:w,timelineId:g,isReadOnly:f})),"hostDetail"===(null==j?void 0:j.panelView)&&null!=j&&null!==(h=j.params)&&void 0!==h&&h.hostName&&(M=j.params.hostName,I=i.a.createElement(V,{contextID:D,expandedHost:null==j?void 0:j.params,handleOnHostClosed:O,isDraggable:A,isFlyoutView:d})),"userDetail"===(null==j?void 0:j.panelView)&&null!=j&&null!==(y=j.params)&&void 0!==y&&y.userName&&(M=j.params.userName,I=i.a.createElement(je,{contextID:D,userName:j.params.userName,handleOnClose:O,isDraggable:A,isFlyoutView:d})),"networkDetail"===(null==j?void 0:j.panelView)&&null!=j&&null!==(E=j.params)&&void 0!==E&&E.ip&&(M=j.params.ip,I=i.a.createElement(de,{contextID:D,expandedNetwork:null==j?void 0:j.params,handleOnNetworkClosed:O,isDraggable:A,isFlyoutView:d})),d?i.a.createElement(r.EuiFlyout,{"data-test-subj":"timeline:details-panel:flyout",size:C,onClose:O,ownFocus:!1,key:M},I):I}));Ie.displayName="DetailsPanel"},,function(e,t,a){"use strict";a.d(t,"c",(function(){return E})),a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return k}));var n=a(4),i=a.n(n),s=a(17),r=a(2),o=a(3);const l=a(6).i18n.translate("xpack.securitySolution.callouts.dismissButton",{defaultMessage:"Dismiss"}),c=({message:e,text:t,onClick:a=o.noop})=>{const{type:r}=e,c=r,u=null!=t?t:l,d=Object(n.useCallback)((()=>a(e)),[a,e]);return i.a.createElement(s.EuiButton,{color:c,"data-test-subj":"callout-dismiss-btn",onClick:d},u)},u=({message:e,iconType:t,dismissButtonText:a,onDismiss:n,showDismissButton:r=!0})=>{const{type:o,id:l,title:u,description:p}=e,m=null!=t?t:d(o);return i.a.createElement(s.EuiCallOut,{color:o,title:u,iconType:m,"data-test-subj":`callout-${l}`,"data-test-messages":`[${l}]`},p,r&&i.a.createElement(c,{message:e,text:a,onClick:n}))},d=e=>{switch(e){case"primary":return"iInCircle";case"success":return"cheer";case"warning":return"help";case"danger":return"alert";default:return Object(r.a)(e)}},p=Object(n.memo)(u);var m=a(862),g=a.n(m),f=a(669);const b=(e,t)=>h(e,o.identity,(()=>t)),h=(e,t,a)=>{const n=e.map((e=>[t(e),a(e)]));return Object(o.fromPairs)(n)},y=({namespace:e,condition:t,message:a})=>{const{isVisible:r,dismiss:l}=((e,t="common")=>{const{getMessages:a,addMessage:i}=Object(f.a)(),[s,r]=g()({}),l=(e=>`kibana.securitySolution.${e}.callouts.dismissed`)(t),c=Object(n.useCallback)((()=>Object.entries(s).filter((([e,t])=>t)).map((([e,t])=>e))),[s]),u=Object(n.useCallback)((e=>{var t;return null!==(t=s[e.id])&&void 0!==t&&t}),[s]),d=Object(n.useCallback)((e=>{const{id:t,type:a}=e;r.set(t,!1),"primary"!==a&&"success"!==a||i(l,t)}),[r,i,l]),p=Object(n.useCallback)((e=>{const t=a(l),n=Object(o.difference)(e,t),i=Object(o.intersection)(e,t);r.setAll({...b(n,!0),...b(i,!1)})}),[a,l,r]);return Object(n.useEffect)((()=>{const t=e.map((e=>e.id)),a=Object.keys(s);Object(o.isEqual)(t,a)||p(t)}),[e,s,p]),{getVisibleMessageIds:c,isVisible:u,dismiss:d}})([a],e);return t&&r(a)?i.a.createElement(i.a.Fragment,null,i.a.createElement(p,{message:a,onDismiss:l}),i.a.createElement(s.EuiSpacer,{size:"l"})):null},E=Object(n.memo)(y),v=({condition:e,message:t})=>e?i.a.createElement(p,{message:t,showDismissButton:!1}):null,k=Object(n.memo)(v)},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return $}));var n=a(4),i=a.n(n),s=a(22),r=a(47),o=a(17),l=a(3),c=a(24),u=a.n(c),d=a(238),p=a(393),m=a(890),g=a(245);const f=({width:e=s.DEFAULT_ACTION_BUTTON_WIDTH,dataTestSubj:t,content:a,ariaLabel:n,iconType:r="",isDisabled:l=!1,onClick:c,children:u,buttonType:d="icon"})=>i.a.createElement(i.a.Fragment,null,"icon"===d&&i.a.createElement("div",null,i.a.createElement(g.l,{textAlign:"center",width:e},null!=u?u:i.a.createElement(o.EuiToolTip,{"data-test-subj":`${t}-tool-tip`,content:a},i.a.createElement(o.EuiButtonIcon,{"aria-label":n,"data-test-subj":`${t}-button`,iconType:r,isDisabled:l,onClick:c,size:"s"})))),"text"===d&&i.a.createElement(o.EuiContextMenuItem,{"aria-label":n,"data-test-subj":`${t}-button-menu-item`,disabled:l,onClick:c,color:"text",size:"s"},i.a.createElement(o.EuiText,{"data-test-subj":`${t}-button`,size:"m"},a)));f.displayName="ActionIconItemComponent";const b=i.a.memo(f);var h=a(259),y=a(759);const E=({ariaLabel:e=h.g,ecsRowData:t,buttonType:a,onInvestigateInTimelineAlertClick:n})=>{const{investigateInTimelineAlertClick:s}=Object(y.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:n});return i.a.createElement(b,{ariaLabel:e,content:h.f,dataTestSubj:"send-alert-to-timeline",iconType:"timeline",onClick:s,isDisabled:!1,buttonType:a})},v=i.a.memo(E);var k=a(15),S=a(373),T=a(515),x=a(235);const w=({ariaLabel:e,showNotes:t,timelineType:a,toggleShowNotes:n})=>{const{kibanaSecuritySolutionsPrivileges:s}=Object(x.a)();return i.a.createElement(b,null,i.a.createElement(T.d,{ariaLabel:e,"data-test-subj":"add-note",isDisabled:!1===s.crud,showNotes:t,timelineType:a,toggleShowNotes:n,toolTip:a===k.m.template?S.h:S.i}))};w.displayName="AddEventNoteActionComponent";const O=i.a.memo(w);var j=a(660);const I=({ariaLabel:e,isAlert:t,noteIds:a,onPinClicked:r,eventIsPinned:l,timelineType:c})=>{const{kibanaSecuritySolutionsPrivileges:u}=Object(x.a)(),d=Object(n.useMemo)((()=>Object(p.g)({isPinned:l,isAlert:t,eventHasNotes:Object(p.b)(a),timelineType:c})),[l,t,a,c]);return i.a.createElement("div",{key:"timeline-action-pin-tool-tip"},i.a.createElement(g.l,{textAlign:"center",width:s.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(o.EuiToolTip,{"data-test-subj":"timeline-action-pin-tool-tip",content:d},i.a.createElement(j.a,{ariaLabel:e,allowUnpinning:!Object(p.b)(a),"data-test-subj":"pin-event",isDisabled:!1===u.crud,isAlert:t,onClick:r,pinned:l,timelineType:c}))))};I.displayName="PinEventActionComponent";const C=i.a.memo(I);var M=a(76),D=a(7),A=a(96),F=a(91),R=a(94),P=a(258),_=a(267),q=a(79);const N=e=>"signal"===e,L=u.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-1sc1j22-0"})(["align-items:center;display:flex;"]),B=({ariaRowindex:e,checked:t,columnValues:a,ecsData:c,eventId:u,eventIdToNoteIds:f,isEventPinned:b=!1,isEventViewer:h=!1,loadingEventIds:y,onEventDetailsPanelOpened:E,onRowSelected:T,onRuleChange:x,refetch:w,showCheckboxes:j,showNotes:I,timelineId:B,toggleShowNotes:z})=>{const H=Object(r.useDispatch)(),$=Object(d.a)("tGridEnabled"),V=Object(n.useMemo)((()=>F.b.getTimelineByIdSelector()),[]),{startTransaction:U}=Object(P.a)(),Q=Object(q.b)().isEnterprise(),W=Object(n.useCallback)((e=>H(F.a.pinEvent({id:B,eventId:e}))),[H,B]),G=Object(n.useCallback)((e=>H(F.a.unPinEvent({id:B,eventId:e}))),[H,B]),K=Object(n.useCallback)((e=>T({eventIds:[u],isSelected:e.currentTarget.checked})),[u,T]),J=Object(n.useCallback)((()=>Object(p.f)({allowUnpinning:!f||!Object(p.b)(f[u]),eventId:u,onPinEvent:W,onUnPinEvent:G,isEventPinned:b})),[f,u,b,W,G]),Y=Object(M.b)((e=>{var t;return(null!==(t=V(e,B))&&void 0!==t?t:R.a).timelineType})),X=Object(p.e)(c),Z=Object(n.useMemo)((()=>{var e,t,a,n;return"signal"!==X&&!(null!==(e=c.event)&&void 0!==e&&null!==(t=e.kind)&&void 0!==t&&t.includes("event")&&null!==(a=c.agent)&&void 0!==a&&null!==(n=a.type)&&void 0!==n&&n.includes("endpoint"))}),[c,X]),ee=Object(n.useMemo)((()=>!(e=>{var t;return("endpoint"===Object(l.get)(["agent","type",0],e)||"winlogbeat"===Object(l.get)(["agent","type",0],e)&&"sysmon"===Object(l.get)(["event","module",0],e))&&1===(null===(t=Object(l.get)(["process","entity_id"],e))||void 0===t?void 0:t.length)&&""!==Object(l.get)(["process","entity_id",0],e)})(c)),[c]),{setGlobalFullScreen:te}=Object(A.a)(),{setTimelineFullScreen:ae}=Object(A.c)(),ne=Object(n.useCallback)((()=>{U({name:_.a.OPEN_ANALYZER});const e=document.querySelector(".euiDataGrid--fullScreen");H(Object(D.updateTimelineGraphEventId)({id:B,graphEventId:c._id})),B===k.i.active?(e&&ae(!0),H(Object(D.setActiveTabTimeline)({id:B,activeTab:k.l.graph}))):e&&te(!0)}),[U,H,B,c._id,ae,te]),ie=Object(n.useMemo)((()=>{var e,t,a,n,i;const{process:s,_id:r,timestamp:o}=c,l=null==s||null===(e=s.entry_leader)||void 0===e||null===(t=e.entity_id)||void 0===t?void 0:t[0];if(void 0===l)return null;const u=null==s||null===(a=s.entity_id)||void 0===a?void 0:a[0],d="signal"===X||"eql"===X?r:void 0;return{sessionEntityId:l,jumpToEntityId:u,jumpToCursor:d&&(null===(n=c.kibana)||void 0===n||null===(i=n.alert.original_time)||void 0===i?void 0:i[0])||o,investigatedAlertId:d}}),[c,X]),se=Object(n.useCallback)((()=>{const e=document.querySelector(".euiDataGrid--fullScreen");U({name:_.a.OPEN_SESSION_VIEW}),B===k.i.active?(e&&ae(!0),null!==ie&&H(Object(D.setActiveTabTimeline)({id:B,activeTab:k.l.session}))):e&&te(!0),null!==ie&&H(Object(D.updateTimelineSessionViewConfig)({id:B,sessionViewConfig:ie}))}),[U,B,ie,ae,H,te]);return i.a.createElement(L,null,j&&!$&&i.a.createElement("div",{key:"select-event-container","data-test-subj":"select-event-container"},i.a.createElement(g.l,{textAlign:"center",width:s.DEFAULT_ACTION_BUTTON_WIDTH},y.includes(u)?i.a.createElement(o.EuiLoadingSpinner,{size:"m","data-test-subj":"event-loader"}):i.a.createElement(o.EuiCheckbox,{"aria-label":S.e({ariaRowindex:e,columnValues:a,checked:t}),"data-test-subj":"select-event",id:u,checked:t,onChange:K}))),i.a.createElement("div",{key:"expand-event"},i.a.createElement(g.l,{textAlign:"center",width:s.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(o.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:S.r},i.a.createElement(o.EuiButtonIcon,{"aria-label":S.s({ariaRowindex:e,columnValues:a}),"data-test-subj":"expand-event",iconType:"expand",onClick:E,size:"s"})))),i.a.createElement(i.a.Fragment,null,B!==k.i.active&&i.a.createElement(v,{ariaLabel:S.n({ariaRowindex:e,columnValues:a}),key:"investigate-in-timeline",ecsRowData:c}),!h&&z&&i.a.createElement(i.a.Fragment,null,i.a.createElement(O,{ariaLabel:S.c({ariaRowindex:e,columnValues:a}),key:"add-event-note",showNotes:null!=I&&I,toggleShowNotes:z,timelineType:Y}),i.a.createElement(C,{ariaLabel:S.m({ariaRowindex:e,columnValues:a,isEventPinned:b}),isAlert:N(X),key:"pin-event",onPinClicked:J,noteIds:f&&f[u]||[],eventIsPinned:b,timelineType:Y})),i.a.createElement(m.b,{ariaLabel:S.g({ariaRowindex:e,columnValues:a}),ariaRowindex:e,columnValues:a,key:"alert-context-menu",ecsRowData:c,timelineId:B,disabled:Z,refetch:null!=w?w:l.noop,onRuleChange:x}),!1===ee?i.a.createElement("div",null,i.a.createElement(g.l,{textAlign:"center",width:s.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(o.EuiToolTip,{"data-test-subj":"view-in-analyzer-tool-tip",content:S.a},i.a.createElement(o.EuiButtonIcon,{"aria-label":S.b({ariaRowindex:e,columnValues:a}),"data-test-subj":"view-in-analyzer",iconType:"analyzeEvent",onClick:ne,size:"s"})))):null,null===ie||!Q&&B!==k.i.kubernetesPageSessions?null:i.a.createElement("div",null,i.a.createElement(g.l,{textAlign:"center",width:s.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(o.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:S.j},i.a.createElement(o.EuiButtonIcon,{"aria-label":S.s({ariaRowindex:e,columnValues:a}),"data-test-subj":"session-view-button",iconType:"sessionViewer",onClick:se,size:"s"}))))))};B.displayName="ActionsComponent";const z=i.a.memo(B);var H=a(725);const $=e=>[{headerCellRender:()=>i.a.createElement(i.a.Fragment,null,H.a),id:"default-timeline-control-column",rowCellRender:z,width:Object(s.getActionsColumnWidth)(e)}]},,function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a(53),i=a.n(n),s=a(4),r=a.n(s),o=a(1),l=a(385),c=a.n(l),u=a(229),d=a(286),p=a(19),m=a(429),g=a(6);const f=g.i18n.translate("xpack.securitySolution.containers.anomalies.stackByJobId",{defaultMessage:"job"}),b=g.i18n.translate("xpack.securitySolution.containers.anomalies.title",{defaultMessage:"Anomalies"}),h=g.i18n.translate("xpack.securitySolution.containers.anomalies.errorFetchingAnomaliesData",{defaultMessage:"Failed to query anomalies data"});var y,E=a(118);const v=[{text:f,value:"job_id"}],k=f,S={defaultStackByOption:null!==(y=v.find((e=>e.text===k)))&&void 0!==y?y:v[0],errorMessage:h,hideHistogramIfEmpty:!0,histogramType:E.b.anomalies,stackByOptions:v,subtitle:void 0,title:b},T="anomaliesHistogramQuery",x=({deleteQuery:e,endDate:t,setQuery:a,skip:n,startDate:l,type:g,filterQuery:f,anomaliesFilterQuery:b,AnomaliesTableComponent:h,flowTarget:y,ip:E,hostName:v,userName:k,indexNames:x})=>{const{jobs:w}=Object(d.a)(),[O]=Object(p.q)(o.I),j=((e,t={},a=[],n,i,s)=>{const r=a.map((e=>e.id)).map((e=>({match_phrase:{job_id:e}}))),o=Object(u.a)(e),l=o?JSON.parse(o):{},d=c.a.all([l,t,{bool:{filter:[{bool:{should:r,minimum_should_match:1}},{match_phrase:{result_type:"record"}},i&&s&&{match_phrase:{[`${i}.ip`]:s}},{range:{record_score:{gte:n}}}]}}]);return JSON.stringify(d)})(f,b,w,O,y,E);return Object(s.useEffect)((()=>()=>{e&&e({id:T})}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,i()({endDate:t,filterQuery:j,id:T,indexNames:x,setQuery:a,startDate:l},S)),r.a.createElement(h,{startDate:l,endDate:t,skip:n,type:g,flowTarget:y,ip:E,hostName:v,userName:k}))};x.displayName="AnomaliesQueryTabBodyComponent";const w=r.a.memo(x);w.displayName="AnomaliesQueryTabBody"},function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(4),i=a.n(n),s=a(17),r=a(24),o=a.n(r),l=a(6);const c=l.i18n.translate("xpack.securitySolution.andOrBadge.and",{defaultMessage:"AND"}),u=l.i18n.translate("xpack.securitySolution.andOrBadge.or",{defaultMessage:"OR"}),d=o()(s.EuiBadge).withConfig({displayName:"RoundBadge",componentId:"sc-wu3h16-0"})(["align-items:center;border-radius:100%;display:inline-flex;font-size:9px;height:34px;justify-content:center;margin:0 5px 0 5px;padding:7px 6px 4px 6px;user-select:none;width:34px;.euiBadge__content{position:relative;top:-1px;}.euiBadge__text{text-overflow:clip;}"]);d.displayName="RoundBadge";const p=({type:e})=>i.a.createElement(d,{"data-test-subj":"and-or-badge",color:"hollow"},"and"===e?c:u);p.displayName="RoundedBadge";const m=Object(r.css)(["background:",";position:relative;width:2px;&:after{background:",";content:'';height:8px;right:-4px;position:absolute;width:10px;clip-path:circle();}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiColorLightShade)),g=o()(s.EuiFlexItem).withConfig({displayName:"TopAntenna",componentId:"sc-10c57g6-0"})([""," &:after{top:0;}"],m),f=o()(s.EuiFlexItem).withConfig({displayName:"BottomAntenna",componentId:"sc-10c57g6-1"})([""," &:after{bottom:0;}"],m),b=({type:e})=>i.a.createElement(s.EuiFlexGroup,{className:"andBadgeContainer",gutterSize:"none",direction:"column",alignItems:"center"},i.a.createElement(g,{"data-test-subj":"andOrBadgeBarTop",grow:1}),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(p,{type:e})),i.a.createElement(f,{"data-test-subj":"andOrBadgeBarBottom",grow:1}));b.displayName="RoundedBadgeAntenna";const h=i.a.memo((({type:e,includeAntennas:t=!1})=>t?i.a.createElement(b,{type:e}):i.a.createElement(p,{type:e})));h.displayName="AndOrBadge"},function(e,t,a){"use strict";a.d(t,"i",(function(){return n})),a.d(t,"h",(function(){return i})),a.d(t,"g",(function(){return s})),a.d(t,"f",(function(){return r})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return d}));const n=e=>"UninitialisedResourceState"===e.type,i=e=>"LoadingResourceState"===e.type,s=e=>"LoadedResourceState"===e.type,r=e=>"FailedResourceState"===e.type,o=()=>({type:"UninitialisedResourceState"}),l=e=>({type:"LoadingResourceState",previousState:e}),c=e=>({type:"LoadedResourceState",data:e}),u=(e,t)=>({type:"FailedResourceState",error:e,lastLoadedState:t}),d=e=>{switch(e.type){case"LoadedResourceState":case"FailedResourceState":return e;case"UninitialisedResourceState":case"LoadingResourceState":return o()}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(5);const i=e=>{const{id:t,revision:a,created_by:i,created_at:s,updated_by:r,updated_at:o,...l}=e,c=Object(n.cloneDeep)(l),u=c.inputs[0].config.policy.value;return[u.windows.popup.malware,u.mac.popup.malware].forEach((e=>e.message.trim())),c}},,,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"updateTableActivePage",(function(){return s})),a.d(t,"setHostTablesActivePageToZero",(function(){return r})),a.d(t,"setHostDetailsTablesActivePageToZero",(function(){return o})),a.d(t,"updateTableLimit",(function(){return l})),a.d(t,"updateHostsSort",(function(){return c})),a.d(t,"updateHostRiskScoreSort",(function(){return u})),a.d(t,"updateHostRiskScoreSeverityFilter",(function(){return d})),a.d(t,"updateHostsAnomaliesJobIdFilter",(function(){return p})),a.d(t,"updateHostsAnomaliesInterval",(function(){return m}));var n=a(37);const i=a.n(n)()("x-pack/security_solution/local/hosts"),s=i("UPDATE_HOST_TABLE_ACTIVE_PAGE"),r=i("SET_HOST_TABLES_ACTIVE_PAGE_TO_ZERO"),o=i("SET_HOST_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),l=i("UPDATE_HOST_TABLE_LIMIT"),c=i("UPDATE_HOSTS_SORT"),u=i("UPDATE_HOST_RISK_SCORE_SORT"),d=i("UPDATE_HOST_RISK_SCORE_SEVERITY"),p=i("UPDATE_HOSTS_ANOMALIES_JOB_ID_FILTER"),m=i("UPDATE_HOSTS_ANOMALIES_INTERVAL")},,function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return r}));const n={critical:"#E7664C",high:"#DA8B45",medium:"#D6BF57",low:"#54B399"},i=4,s=(e=0)=>Math.ceil(Math.min(e||0,100)/i),r={field:"kibana.alert.workflow_status",value:"open"}},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(4),i=a(47),s=a(76),r=a(13),o=a(33),l=a(466),c=a(15),u=a(439),d=a(7),p=a(78);const m=()=>{const e=Object(i.useDispatch)(),t=Object(n.useMemo)((()=>p.g.getSourcererDataViewsSelector()),[]),{defaultDataView:a,signalIndexName:m}=Object(s.a)((e=>t(e))),g=Object(u.a)({timelineId:c.i.active,timelineType:c.m.default}),f=t=>{g(),e(Object(d.updateProviders)({id:c.i.active,providers:t})),e(o.a.setSelectedDataView({id:r.SourcererScopeName.timeline,selectedDataViewId:a.id,selectedPatterns:[m||""]}))};return{openTimelineWithFilters:e=>{const t=[];for(const a of e){const e=a[0];if(e){const n=Object(l.a)(e.field,"",e.value);for(const e of a.slice(1))n.and.push(Object(l.a)(e.field,"",e.value));t.push(n)}}f(t)},openHostInTimeline:({hostName:e,severity:t})=>{const a=Object(l.a)("host.name","",e);t&&a.and.push(Object(l.a)("kibana.alert.severity","",t)),f([a])},openRuleInTimeline:e=>{const t=Object(l.a)("kibana.alert.rule.name","",e);f([t])},openUserInTimeline:({userName:e,severity:t})=>{const a=Object(l.a)("user.name","",e);t&&a.and.push(Object(l.a)("kibana.alert.severity","",t)),f([a])}}}},,function(e,t,a){"use strict";a.r(t),a.d(t,"setUsersTablesActivePageToZero",(function(){return s})),a.d(t,"setUsersDetailsTablesActivePageToZero",(function(){return r})),a.d(t,"updateTableLimit",(function(){return o})),a.d(t,"updateTableActivePage",(function(){return l})),a.d(t,"updateTableSorting",(function(){return c})),a.d(t,"updateUserRiskScoreSeverityFilter",(function(){return u})),a.d(t,"updateUsersAnomaliesJobIdFilter",(function(){return d})),a.d(t,"updateUsersAnomaliesInterval",(function(){return p}));var n=a(37);const i=a.n(n)()("x-pack/security_solution/local/users"),s=i("SET_USERS_TABLES_ACTIVE_PAGE_TO_ZERO"),r=i("SET_USERS_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),o=i("UPDATE_USERS_TABLE_LIMIT"),l=i("UPDATE_USERS_ACTIVE_PAGE"),c=i("UPDATE_USERS_SORTING"),u=i("UPDATE_USERS_RISK_SEVERITY_FILTER"),d=i("UPDATE_USERS_ANOMALIES_JOB_ID_FILTER"),p=i("UPDATE_USERS_ANOMALIES_INTERVAL")},function(e,t,a){"use strict";a.d(t,"h",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return r})),a.d(t,"g",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.network.pageTitle",{defaultMessage:"Network"}),s=n.i18n.translate("xpack.securitySolution.network.navigation.flowsTitle",{defaultMessage:"Flows"}),r=n.i18n.translate("xpack.securitySolution.network.navigation.dnsTitle",{defaultMessage:"DNS"}),o=n.i18n.translate("xpack.securitySolution.network.navigation.usersTitle",{defaultMessage:"Users"}),l=n.i18n.translate("xpack.securitySolution.network.navigation.tlsTitle",{defaultMessage:"TLS"}),c=n.i18n.translate("xpack.securitySolution.network.navigation.httpTitle",{defaultMessage:"HTTP"}),u=n.i18n.translate("xpack.securitySolution.network.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),d=n.i18n.translate("xpack.securitySolution.network.navigation.eventsTitle",{defaultMessage:"Events"})},function(e,t,a){"use strict";function n(e,t,a){return Math.max(Math.min(e,a),t)}function i(e,t,a){return e*(1-a)+t*a}a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}))},function(e,t,a){"use strict";function n(e,t){return"nodeEventsInCategory"===t.panelView&&t.panelParameters.nodeID===e.nodeID&&t.panelParameters.eventCategory===e.eventCategory}function i(e,t){return e.nodeID===t.nodeID&&e.eventCategory===t.eventCategory?{nodeID:e.nodeID,eventCategory:e.eventCategory,events:[...e.events,...t.events],cursor:t.cursor,lastCursorRequested:null}:void 0}a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return o}));var n=a(237);function i(e){return void 0!==(null==e?void 0:e.ancestry)?200:20}function s(e){return void 0!==(null==e?void 0:e.ancestry)?0:10}function r(){return 500}function o(e){const t=new Map;for(const a of e.nodes)if(a.stats){const e=n.b(a);t.set(e,a.stats)}return t}},function(e,t,a){"use strict";function n(e,t){return!!t&&(e===t||e.databaseDocumentID===t.databaseDocumentID&&e.filters.from===t.filters.from&&e.filters.to===t.filters.to&&function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;const a=new Set(e);for(let e=0;e<t.length;e++)if(!a.has(t[e]))return!1;return!0}(e.indices,t.indices))}a.d(t,"a",(function(){return n}))},,,function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return o}));const n=({rulesCustomInstalled:e,rulesInstalled:t})=>null!=e&&e>0||null!=t&&t>0,i=e=>e.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),s=({query:e,searchValue:t,filterOptions:a,defaultSearchTerm:n})=>{const i=null==e?void 0:e.ast.getFieldClauses();return null!=i&&i.length>0?i.reduce(((e,{field:t,value:a})=>(e[t]=`${a}`,e)),a):{[n]:t}},r=async e=>{const t=(await e.text()).split("\n").filter(Boolean).slice(-1)[0];return JSON.parse(t)},o=async e=>{const t=await r(e);return{succeeded:t.exported_rules_count,failed:t.missing_rules_count,total:t.exported_rules_count+t.missing_rules_count}}},function(e,t,a){"use strict";a.d(t,"f",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"h",(function(){return d}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.users.pageTitle",{defaultMessage:"Users"}),s=n.i18n.translate("xpack.securitySolution.users.navigation.allUsersTitle",{defaultMessage:"All users"}),r=n.i18n.translate("xpack.securitySolution.users.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),o=n.i18n.translate("xpack.securitySolution.users.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),l=n.i18n.translate("xpack.securitySolution.users.navigation.riskTitle",{defaultMessage:"User risk"}),c=n.i18n.translate("xpack.securitySolution.users.navigation.eventsTitle",{defaultMessage:"Events"}),u=n.i18n.translate("xpack.securitySolution.users.navigation.userScoreOverTimeTitle",{defaultMessage:"User risk score over time"}),d=n.i18n.translate("xpack.securitySolution.hosts.navigaton.hostRisk.viewDashboardButtonLabel",{defaultMessage:"View source dashboard"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return r}));var n=a(219),i=a(217);const s=["name","description","item_id","entries.value","entries.entries.value"],r={name:i.n,namespace_type:"agnostic",description:i.l,list_id:i.m,type:n.a.ENDPOINT_TRUSTED_APPS}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return n.k})),a.d(t,"a",(function(){return n.i})),a.d(t,"f",(function(){return u})),a.d(t,"c",(function(){return p})),a.d(t,"e",(function(){return k})),a.d(t,"d",(function(){return w}));var n=a(244),i=a(4),s=a.n(i),r=a(202),o=a(392),l=a(274),c=a(308);const u=()=>{const[e,t]=Object(i.useState)(null),[a,s]=Object(i.useState)(!1),[u,d]=Object(i.useState)(!1),{addError:p}=Object(r.a)(),m=Object(c.b)();return Object(i.useEffect)((()=>{let t=!0;const a=new AbortController;return s(!1),(async()=>{if(null!=e){try{d(!0),await Object(n.n)({rule:Object(o.b)(e),signal:a.signal}),m(),t&&s(!0)}catch(e){t&&p(e,{title:l.g})}t&&d(!1)}})(),()=>{t=!1,a.abort()}}),[e,p,m]),[{isLoading:u,isSaved:a},t]};var d=a(412);const p=()=>{const[e,t]=Object(i.useState)(null),[a,s]=Object(i.useState)(null),[u,p]=Object(i.useState)(!1),{addError:m}=Object(r.a)(),g=Object(c.b)(),f=Object(d.a)();return Object(i.useEffect)((()=>{let t=!0;const a=new AbortController;return s(null),(async()=>{if(null!=e){try{p(!0);const i=await Object(n.b)({rule:Object(o.b)(e),signal:a.signal});g(),f(),t&&s(i.id)}catch(e){t&&m(e,{title:l.g})}t&&p(!1)}})(),()=>{t=!1,a.abort()}}),[e,m,g,f]),[{isLoading:u,ruleId:a},t]};var m=a(0),g=a(219),f=a(310),b=a(255),h=a(330);const y=m.exact(m.type({group:m.string,id:m.string,action_type_id:m.string,params:m.record(m.string,m.any)})),E=m.intersection([m.type({from:m.string}),m.partial({throttle:m.string,kibana_siem_app_url:m.string})]),v=m.intersection([m.type({author:h.k,created_at:m.string,created_by:m.string,description:m.string,enabled:m.boolean,false_positives:m.array(m.string),from:m.string,id:m.string,interval:m.string,immutable:m.boolean,name:m.string,max_signals:m.number,references:m.array(m.string),related_integrations:h.c,required_fields:h.d,risk_score:m.number,risk_score_mapping:f.n,rule_id:m.string,severity:f.o,severity_mapping:f.p,setup:h.e,tags:m.array(m.string),type:f.z,to:m.string,threat:f.x,updated_at:m.string,updated_by:m.string,actions:m.array(y),throttle:m.union([m.string,m.null])}),m.partial({outcome:h.G,alias_target_id:m.string,alias_purpose:h.h,building_block_type:h.l,anomaly_threshold:m.number,filters:m.array(m.unknown),index:m.array(m.string),data_view_id:h.o,language:m.string,license:h.A,meta:E,machine_learning_job_id:m.array(m.string),new_terms_fields:m.array(m.string),history_window_start:m.string,output_index:m.string,query:m.string,rule_name_override:h.M,saved_id:m.string,threshold:h.P,threat_query:f.w,threat_filters:f.r,threat_index:f.s,threat_indicator_path:f.t,threat_mapping:f.v,threat_language:f.u,timeline_id:m.string,timeline_title:m.string,timestamp_override:h.U,timestamp_override_fallback_disabled:h.V,timestamp_field:h.T,event_category_override:h.r,tiebreaker_field:h.Q,note:m.string,exceptions_list:g.w,uuid:m.string,version:m.number,execution_summary:b.g})]),k=(m.array(v),e=>{const[t,a]=Object(i.useState)(null),[s,c]=Object(i.useState)(!0),{addError:u}=Object(r.a)();return Object(i.useEffect)((()=>{let t=!0;const i=new AbortController;return null!=e&&(async e=>{try{c(!0);const s=Object(o.a)(await Object(n.d)({id:e,signal:i.signal}));t&&a(s)}catch(e){t&&(a(null),u(e,{title:l.h}))}t&&c(!1)})(e),()=>{t=!1,i.abort()}}),[e,u]),[s,t]});var S=a(17),T=a(307),x=a(218);const w=({canUserCRUD:e,hasIndexWrite:t,isAuthenticated:a,hasEncryptionKey:o,isSignalIndexExists:u})=>{const{data:p,isFetching:m}=Object(d.b)(),{mutate:g,isLoading:f}=(()=>{const{addError:e,addSuccess:t}=Object(r.a)(),a=Object(c.b)(),i=Object(d.a)();return Object(x.useMutation)((()=>Object(n.a)()),{onError:t=>{e(t,{title:l.i})},onSuccess:e=>{t((e=>{const{rules_installed:t,rules_updated:a,timelines_installed:n,timelines_updated:i}=e;return 0===t&&(n>0||i>0)?l.m:(t>0||a>0)&&0===n?l.k:l.j})(e)),i(),a()}})})(),b=Object(i.useCallback)((()=>{e&&t&&a&&o&&u&&g()}),[e,o,t,g,a,u]),h=Object(i.useMemo)((()=>Object(T.e)(null==p?void 0:p.rulesInstalled,null==p?void 0:p.rulesNotInstalled,null==p?void 0:p.rulesNotUpdated)),[null==p?void 0:p.rulesInstalled,null==p?void 0:p.rulesNotInstalled,null==p?void 0:p.rulesNotUpdated]),y=Object(i.useMemo)((()=>Object(T.f)(null==p?void 0:p.timelinesInstalled,null==p?void 0:p.timelinesNotInstalled,null==p?void 0:p.timelinesNotUpdated)),[null==p?void 0:p.timelinesInstalled,null==p?void 0:p.timelinesNotInstalled,null==p?void 0:p.timelinesNotUpdated]),E=Object(i.useCallback)((({isDisabled:e,onClick:t,fill:a,"data-test-subj":n="loadPrebuiltRulesBtn"})=>"ruleNotInstalled"!==h&&"timelinesNotInstalled"!==y||"someRuleUninstall"===h?null:s.a.createElement(S.EuiButton,{fill:a,iconType:"indexOpen",isLoading:f,isDisabled:e,onClick:t,"data-test-subj":n},"ruleNotInstalled"===h&&"timelinesNotInstalled"===y&&l.b,"ruleNotInstalled"===h&&"timelinesNotInstalled"!==y&&l.a,"ruleNotInstalled"!==h&&"timelinesNotInstalled"===y&&l.c)),[f,h,y]),v=Object(i.useCallback)(((e,t)=>e>0&&0===t?l.d(e):0===e&&t>0?l.f(t):e>0&&t>0?l.e(e,t):void 0),[]),k=Object(i.useCallback)((({isDisabled:e,onClick:t,fill:a=!1})=>{var n,i;return"someRuleUninstall"===h||"someTimelineUninstall"===y?s.a.createElement(S.EuiButton,{fill:a,iconType:"plusInCircle",isLoading:f,isDisabled:e,onClick:t,"data-test-subj":"reloadPrebuiltRulesBtn"},v(null!==(n=null==p?void 0:p.rulesNotInstalled)&&void 0!==n?n:0,null!==(i=null==p?void 0:p.timelinesNotInstalled)&&void 0!==i?i:0)):null}),[v,f,h,null==p?void 0:p.rulesNotInstalled,null==p?void 0:p.timelinesNotInstalled,y]);return{loading:m,loadingCreatePrePackagedRules:f,createPrePackagedRules:b,getLoadPrebuiltRulesAndTemplatesButton:E,getReloadPrebuiltRulesAndTemplatesButton:k,...p}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(4),i=a(19),s=a(93),r=a(341),o=a(6);const l=o.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.fetchListsIndex.errorDescription",{defaultMessage:"Failed to retrieve the lists index"}),c=o.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.createListsIndex.errorDescription",{defaultMessage:"Failed to create the lists index"});var u=a(202),d=a(235);const p=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.manage},m=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.read},g=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&(a.create||a.create_doc||a.index||a.write)},f=()=>{const[e,t]=Object(n.useState)({isAuthenticated:null,canManageIndex:null,canReadIndex:null,canWriteIndex:null}),{listPrivileges:a}=Object(d.a)();return Object(n.useEffect)((()=>{if(null!=a.result){const{is_authenticated:e,lists:{index:n},listItems:{index:i}}=a.result;t({isAuthenticated:e,canReadIndex:m(n)&&m(i),canManageIndex:p(n)&&p(i),canWriteIndex:g(n)&&g(i)})}}),[a.result]),Object(n.useEffect)((()=>{null!=a.error&&t({isAuthenticated:!1,canManageIndex:!1,canReadIndex:!1,canWriteIndex:!1})}),[a.error]),{loading:a.loading,...e}},b=()=>{const{createIndex:e,indexExists:t,loading:a,error:o}=(()=>{const[e,t]=Object(n.useState)(null),[a,o]=Object(n.useState)(null),{lists:d}=Object(i.k)().services,p=Object(i.j)(),{addError:m}=Object(u.a)(),{canReadIndex:g,canManageIndex:b,canWriteIndex:h}=f(),{loading:y,start:E,...v}=Object(r.k)(),{loading:k,start:S,...T}=Object(r.d)(),x=y||k,w=Object(n.useCallback)((()=>{d&&g&&b&&E({http:p})}),[p,d,E,g,b]),O=Object(n.useCallback)((()=>{d&&b&&h&&S({http:p})}),[S,p,d,b,h]);return Object(n.useEffect)((()=>{y||a||null!==e||w()}),[a,e,w,y]),Object(n.useEffect)((()=>{null!=v.result&&t(v.result.list_index&&v.result.list_item_index)}),[v.result]),Object(n.useEffect)((()=>{null!=T.result&&w()}),[T.result,w]),Object(n.useEffect)((()=>{const e=v.error;null!=e&&(Object(s.t)(e)&&404===e.body.status_code?t(!1):(o(e),m(e,{title:l})))}),[m,v.error]),Object(n.useEffect)((()=>{const e=T.error;null!=e&&(o(e),m(e,{title:c}))}),[m,T.error]),{createIndex:O,error:a,indexExists:e,loading:x}})(),{canManageIndex:d,canWriteIndex:p,loading:m}=f(),{lists:g}=Object(i.k)().services,b=null!=g,h=a||m,y=!1===t,E=!b||y&&(!1===d||!0===d&&null!=o);return Object(n.useEffect)((()=>{y&&d&&e()}),[d,e,y]),{canManageIndex:d,canWriteIndex:p,enabled:b,loading:h,needsConfiguration:E}}},function(e,t,a){"use strict";a.d(t,"o",(function(){return f})),a.d(t,"d",(function(){return b})),a.d(t,"h",(function(){return h})),a.d(t,"A",(function(){return y})),a.d(t,"B",(function(){return v})),a.d(t,"C",(function(){return k})),a.d(t,"w",(function(){return S})),a.d(t,"r",(function(){return T})),a.d(t,"s",(function(){return x})),a.d(t,"u",(function(){return j})),a.d(t,"z",(function(){return I})),a.d(t,"l",(function(){return C})),a.d(t,"c",(function(){return M})),a.d(t,"k",(function(){return D})),a.d(t,"j",(function(){return A})),a.d(t,"i",(function(){return F})),a.d(t,"G",(function(){return R})),a.d(t,"E",(function(){return P})),a.d(t,"e",(function(){return _})),a.d(t,"q",(function(){return q})),a.d(t,"f",(function(){return N})),a.d(t,"b",(function(){return L})),a.d(t,"a",(function(){return B})),a.d(t,"v",(function(){return H})),a.d(t,"H",(function(){return $})),a.d(t,"D",(function(){return V})),a.d(t,"F",(function(){return U})),a.d(t,"y",(function(){return Q})),a.d(t,"x",(function(){return W})),a.d(t,"t",(function(){return G})),a.d(t,"p",(function(){return K})),a.d(t,"g",(function(){return J})),a.d(t,"n",(function(){return Y})),a.d(t,"m",(function(){return X}));var n=a(558),i=a.n(n),s=a(14),r=a(364),o=a(459),l=a(237),c=a(443),u=a(444),d=a(445),p=a(457);var m=a(246);function g(e,t){return m.f(e.minimum,t.minimum)&&m.f(e.maximum,t.maximum)}function f(e){var t;return void 0!==(null===(t=e.tree)||void 0===t?void 0:t.pendingRequestParameters)}function b(e){return e.detectedBounds}function h(e){var t,a;return!(null===(t=e.tree)||void 0===t||!t.lastResponse||null!==(a=e.tree)&&void 0!==a&&a.lastResponse.successful)}function y(e){return e.resolverComponentInstanceID?e.resolverComponentInstanceID:""}const E=e=>{var t,a,n;return null!==(t=e.tree)&&void 0!==t&&null!==(a=t.lastResponse)&&void 0!==a&&a.successful?null===(n=e.tree)||void 0===n?void 0:n.lastResponse.result:void 0},v=e=>{var t,a,n,i,s;return!(null===(t=e.tree)||void 0===t||null===(a=t.lastResponse)||void 0===a||!a.successful)&&(null===(n=e.tree)||void 0===n||null===(i=n.lastResponse)||void 0===i||null===(s=i.result)||void 0===s?void 0:s.nodes.length)>0};function k(e){var t,a;if(null!==(t=e.tree)&&void 0!==t&&null!==(a=t.lastResponse)&&void 0!==a&&a.successful){var n;const{schema:t,dataSource:a}=null===(n=e.tree)||void 0===n?void 0:n.lastResponse;return{schema:t,dataSource:a}}}const S=Object(s.createSelector)(E,(function(e){return null==e?void 0:e.originID})),T=Object(s.createSelector)((e=>e.nodeData),(e=>t=>null==e?void 0:e.get(t))),x=Object(s.createSelector)(T,(e=>t=>{const a=e(t);return a?a.status:"loading"})),w=Object(s.createSelector)(E,(function(e){const t=new Map;if(null!=e&&e.nodes){for(const a of e.nodes){const e=l.b(a);void 0!==e&&t.set(e,a)}return[...t.values()]}return[]})),O=Object(s.createSelector)(w,S,(function(e,t){return o.b(e,t)})),j=Object(s.createSelector)(E,(e=>{if(e){const t=u.d(e);return e=>t.get(e)}return()=>{}})),I=Object(s.createSelector)(j,(e=>t=>{var a;return null===(a=e(t))||void 0===a?void 0:a.total}));function C(e){return e.currentRelatedEvent.loading}function M(e){return e.currentRelatedEvent.data}const D=Object(s.createSelector)(O,k,((e,t)=>{var a,n;return(null==t||null===(a=t.schema)||void 0===a||!a.ancestry)&&(null!==(n=e.generations)&&void 0!==n?n:0)>=u.c(null==t?void 0:t.schema)})),A=Object(s.createSelector)(O,(e=>{var t;return(null!==(t=e.descendants)&&void 0!==t?t:0)>=u.b()})),F=Object(s.createSelector)(O,k,((e,t)=>{var a;return(null!==(a=e.ancestors)&&void 0!==a?a:0)>=u.a(null==t?void 0:t.schema)}));function R(e){var t,a,n,i,s,r;return void 0===(null===(t=e.tree)||void 0===t?void 0:t.currentParameters)||d.a(null===(a=e.tree)||void 0===a?void 0:a.currentParameters,null===(n=e.tree)||void 0===n||null===(i=n.lastResponse)||void 0===i?void 0:i.parameters)||d.a(null===(s=e.tree)||void 0===s?void 0:s.currentParameters,null===(r=e.tree)||void 0===r?void 0:r.pendingRequestParameters)?null:e.tree.currentParameters}const P=Object(s.createSelector)((e=>{var t;return null===(t=e.tree)||void 0===t?void 0:t.currentParameters}),(function(e){const t=new Date(0),a=new Date(864e13),n={from:t.toISOString(),to:a.toISOString()};return void 0!==e&&(e.filters.from&&(n.from=e.filters.from),e.filters.to&&(n.to=e.filters.to)),n})),_=(Object(s.createSelector)(R,(e=>{var t;return null!==(t=null==e?void 0:e.indices)&&void 0!==t?t:[]})),Object(s.createSelector)((e=>{var t,a,n,i,s;return null!==(t=e.tree)&&void 0!==t&&null!==(a=t.lastResponse)&&void 0!==a&&a.successful?null===(n=e.tree)||void 0===n||null===(i=n.lastResponse)||void 0===i||null===(s=i.parameters)||void 0===s?void 0:s.indices:void 0}),(e=>e.indices),(function(e,t){var a;return null!==(a=null!=e?e:t)&&void 0!==a?a:[]}))),q=Object(s.createSelector)(O,S,(function(e,t){const a=p.a(e);if(!t)return a;if(null===o.f(e,t))return a;const n=p.b(a,t);return void 0===n?a:p.c(a,m.i(n,-1))})),N=Object(s.createSelector)(O,(e=>t=>o.f(e,t))),L=Object(s.createSelector)(q,N,(({ariaLevels:e},t)=>a=>{var n;const i=t(a);return i&&null!==(n=e.get(i))&&void 0!==n?n:null})),B=Object(s.createSelector)(O,N,((e,t)=>{const a=new Map;return function n(i){const s=a.get(i);if(void 0!==s)return s;const r=t(i);if(!r)throw new Error("could not find child event in process tree.");const c=o.a(e,l.d(r));let u=null;for(const e of c){if(null!==u){const t=l.b(u),n=l.b(e);void 0!==t&&void 0!==n&&a.set(t,n)}u=e}if(u){const e=l.b(u);void 0!==e&&a.set(e,null)}return n(i)}})),z=Object(s.createSelector)(q,(function({processNodePositions:e,edgeLineSegments:t}){const a=new i.a,n=[],s=[];for(const[t,a]of e){const[e,i]=a,s={minX:e-360,minY:i-120,maxX:e+360,maxY:i+120,position:a,entity:t,type:"treeNode"};n.push(s)}for(const e of t){const{points:[[t,a],[n,i]]}=e,r={minX:Math.min(t,n)-30,minY:Math.min(a,i)-30,maxX:Math.max(t,n)+30,maxY:Math.max(a,i)+30,entity:e,type:"edgeLine"};s.push(r)}return a.load([...n,...s]),a})),H=Object(s.createSelector)(z,(function(e){return Object(s.defaultMemoize)((t=>{const{minimum:[a,n],maximum:[i,s]}=t,r=e.search({minX:a,minY:n,maxX:i,maxY:s});return{processNodePositions:new Map(r.filter((e=>"treeNode"===e.type)).map((e=>[e.entity,e.position]))),connectingEdgeLineSegments:r.filter((e=>"edgeLine"===e.type)).map((e=>e.entity))}}),g)}));function $(e){var t,a,n;return void 0===(null===(t=e.tree)||void 0===t?void 0:t.pendingRequestParameters)||d.a(null===(a=e.tree)||void 0===a?void 0:a.pendingRequestParameters,null===(n=e.tree)||void 0===n?void 0:n.currentParameters)?null:e.tree.pendingRequestParameters}const V=Object(s.createSelector)(j,(e=>t=>{const a=l.b(t);if(void 0===a)return null;const n=e(a);return n?n.total:null})),U=Object(s.createSelector)(j,(e=>t=>{const a=e(t);return void 0===a?void 0:a.total})),Q=Object(s.createSelector)(j,(e=>(t,a)=>{const n=e(t);return n?n.byCategory[a]:void 0})),W=Object(s.createSelector)((e=>e.locationSearch),y,((e,t)=>Object(r.a)({locationSearch:e,resolverComponentInstanceID:t}))),G=e=>{var t,a;return null!==(t=null===(a=e.nodeEventsInCategory)||void 0===a?void 0:a.events)&&void 0!==t?t:[]},K=Object(s.createSelector)((e=>e.nodeEventsInCategory),W,(function(e,t){return!(void 0===e||!c.a(e,t))&&null!==e.cursor})),J=Object(s.createSelector)((e=>e.nodeEventsInCategory),W,(function(e,t){return!(void 0===e||!c.a(e,t))&&e&&!0===e.error})),Y=Object(s.createSelector)((e=>e.nodeEventsInCategory),W,(function(e,t){const{panelView:a}=t;return"nodeEventsInCategory"===a&&void 0===e})),X=Object(s.createSelector)((e=>e.nodeEventsInCategory),W,(function(e,t){return!(void 0===e||!c.a(e,t))&&e&&null!==e.lastCursorRequested&&e.cursor===e.lastCursorRequested}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(17),i=a(175),s=a(4),r=a.n(s),o=a(92),l=a.n(o),c=a(3),u=a(20),d=a(177),p=a(19),m=a(113),g=a(6);const f=g.i18n.translate("xpack.securitySolution.lastEventTime.errorSearchDescription",{defaultMessage:"An error has occurred on last event time search"}),b=g.i18n.translate("xpack.securitySolution.lastEventTime.failSearchDescription",{defaultMessage:"Failed to run search on last event time"});var h=a(202),y=a(203),E=a(211);const v=Object(s.memo)((({hostName:e,userName:t,indexKey:a,ip:o,indexNames:g})=>{const[v,{lastSeen:k,errorMessage:S}]=(({indexKey:e,indexNames:t,details:a})=>{const{data:n}=Object(p.k)().services,i=Object(s.useRef)(c.noop),r=Object(s.useRef)(new AbortController),o=Object(s.useRef)(new u.Subscription),[g,y]=Object(s.useState)(!1),[E,v]=Object(s.useState)({defaultIndex:t,factoryQueryType:m.c.lastEventTime,indexKey:e,details:a}),[k,S]=Object(s.useState)({lastSeen:null,refetch:i.current,errorMessage:void 0}),{addError:T,addWarning:x}=Object(h.a)(),w=Object(s.useCallback)((e=>{const t=async()=>{r.current=new AbortController,y(!0),o.current=n.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:r.current.signal}).subscribe({next:e=>{Object(d.isCompleteResponse)(e)?(y(!1),S((t=>({...t,errorMessage:void 0,lastSeen:e.lastSeen,refetch:i.current})))):Object(d.isErrorResponse)(e)&&(y(!1),x(f))},error:e=>{y(!1),T(e,{title:b}),S((t=>({...t,errorMessage:e.message})))}})};o.current.unsubscribe(),r.current.abort(),t(),i.current=t}),[n.search,T,x]);return Object(s.useEffect)((()=>{v((n=>{const i={...n,defaultIndex:t,indexKey:e,details:a};return l()(n,i)?n:i}))}),[t,a,e]),Object(s.useEffect)((()=>(w(E),()=>{o.current.unsubscribe(),r.current.abort()})),[E,w]),[g,k]})({indexKey:a,indexNames:g,details:{hostName:e,ip:o,userName:t}});return null!=S?r.a.createElement(n.EuiToolTip,{position:"top",content:S,"data-test-subj":"last_event_time_error","aria-label":"last_event_time_error",id:`last_event_time_error-${a}`},r.a.createElement(n.EuiIcon,{"aria-describedby":`last_event_time_error-${a}`,type:"alert"})):r.a.createElement(r.a.Fragment,null,v&&r.a.createElement(n.EuiLoadingSpinner,{size:"m"}),v||null==k||"Invalid Date"!==new Date(k).toString()?!v&&null!=k&&r.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.headerPage.pageSubtitle",defaultMessage:"Last event: {beat}",values:{beat:r.a.createElement(E.b,{value:k})}}):k,!v&&null==k&&Object(y.d)())}));v.displayName="LastEventTime"},,function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return m})),a.d(t,"c",(function(){return g}));var n=a(237),i=a(246),s=a(459);const r=e=>{if(!e)return NaN;if("number"==typeof e)return e;let t=Date.parse(e);return Number.isNaN(t)&&(t=parseInt(e,10)),t},o=(e,t)=>{const a=r(e),n=r(t);if(Number.isNaN(a)||Number.isNaN(n))return;const i=n-a,s=36e5,o=24*s,l=7*o,c=30*o,u=365*o;let d,p,m;switch(!0){case i>=u:d=Math.floor(i/u),p="year",m="years";break;case i>=c:d=Math.floor(i/c),p="month",m="months";break;case i>=l:d=Math.floor(i/l),p="week",m="weeks";break;case i>=o:d=Math.floor(i/o),p="day",m="days";break;case i>=s:d=Math.floor(i/s),p="hour",m="hours";break;case i>=6e4:d=Math.floor(i/6e4),p="minute",m="minutes";break;case i>=1e3:d=Math.floor(i/1e3),p="second",m="seconds";break;case 0===i:d="<1",p="millisecond",m="millisecond";break;default:d=i,p="millisecond",m="milliseconds"}return{duration:d,durationType:1===d?p:m}};function l(e){const t=function(e){const t=new Map;if(0===s.e(e))return t;const a=[...s.c(e)].reverse();for(const i of a){const a=s.a(e,n.b(i)),r=a.reduce((function(e,a){var n;return e+(null!==(n=t.get(a))&&void 0!==n?n:0)}),0)+Math.max(0,a.length-1)*p;t.set(i,r)}return t}(e),a=function(e,t){const a=new Map;let n,s=0,r=0;for(const o of u(e,t))if(null===o.parent){const{node:e}=o;a.set(e,[0,0])}else{const{node:e,parent:t,isOnlyChild:l,width:c,parentWidth:u}=o;n!==t&&(s=0,r=0,n=t);const d=a.get(t);if(void 0===d)throw new Error;const m=u/-2+s*p+r+c/2;let g=-p;l||(g*=2);const f=i.a([m,g],d);a.set(e,f),s+=1,r+=c}return a}(e,t),r=function(e,t,a){const i=[];for(const r of u(e,t)){if(null===r.parent)continue;const{node:t,parent:l,parentWidth:c}=r,u=a.get(t),d=a.get(l),p=n.b(l),m=n.b(t);if(void 0===m)throw new Error("tried to graph a Resolver that had a node with without an id");const g=`edge:${null!=p?p:"undefined"}:${m}`;if(void 0===u||void 0===d)throw new Error;const f=n.a(l),b=n.a(t),h={elapsedTime:void 0!==f&&void 0!==b?o(f,b):void 0,reactKey:g},y=d[1]+(u[1]-d[1])/2,E={points:[[u[0],y],u],metadata:h},v=t===s.a(e,n.b(l))[0];if(r.isOnlyChild)i.push({points:[d,u],metadata:h});else if(v){const{firstChildWidth:e,lastChildWidth:t}=r,a={points:[d,[d[0],y]],metadata:{reactKey:`parentToMid${g}`}},n=c/-2+e/2,s=n+(c-e/2-t/2),o={points:[[d[0]+n,y],[d[0]+s,y]],metadata:{reactKey:`midway${g}`}};i.push(a,o,E)}else i.push(E)}return i}(e,t,a),l=[],m=new Map;for(const[e,t]of a)m.set(e,i.c(t,d));for(const e of r){const{points:[t,a]}=e,n={...e,points:[i.c(t,d),i.c(a,d)]};l.push(n)}return{processNodePositions:m,edgeLineSegments:l,ariaLevels:c(e)}}function c(e){const t=new Map;for(const a of s.c(e)){const n=s.d(e,a);if(void 0===n)t.set(a,1);else{const e=t.get(n);if(void 0===e)throw new Error("failed to calculate aria levels");t.set(a,e+1)}}return t}function*u(e,t){for(const a of s.c(e)){const i=s.d(e,a),r=t.get(a);if(void 0===r)throw new Error;if(void 0===i)yield{node:a,width:r,parent:null,parentWidth:null,isOnlyChild:null,firstChildWidth:null,lastChildWidth:null};else{const o=t.get(i);if(void 0===o)throw new Error;const l={node:a,width:r,parent:i,parentWidth:o},c=s.a(e,n.b(i));if(1===c.length)l.isOnlyChild=!0,l.lastChildWidth=r,l.firstChildWidth=r;else{const e=t.get(c[0]),a=t.get(c[c.length-1]);if(void 0===e||void 0===a)throw new Error;l.isOnlyChild=!1,l.firstChildWidth=e,l.lastChildWidth=a}yield l}}}const d=[Math.sqrt(2)/2,-Math.sqrt(2)/2,0,Math.sqrt(6)/6,Math.sqrt(6)/6,-Math.sqrt(6)/3,0,0,1],p=280;function m(e,t){for(const[a,i]of e.processNodePositions.entries())if(n.b(a)===t)return i}function g(e,t){return{processNodePositions:new Map([...e.processNodePositions.entries()].map((([e,a])=>[e,i.a(a,t)]))),edgeLineSegments:e.edgeLineSegments.map((({points:e,metadata:a})=>({points:[i.a(e[0],t),i.a(e[1],t)],metadata:a}))),ariaLevels:e.ariaLevels}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return d}));var n=a(223);const i="included",s=e=>{switch(e.length){case 32:return"md5";case 40:return"sha1";case 64:return"sha256"}},r=(e,t)=>({field:e,value:t,type:"match",operator:i}),o=(e,t)=>({field:e,value:t,type:"match_any",operator:i});const l=(e,t=!1)=>{const a=[];return e.forEach((e=>{if(e.field.includes(n.b.HASH))(function(e,t){const a=[];if(!Array.isArray(t.value)){const i=r(`${e}${n.b.HASH}${s(t.value)}`,t.value.toLowerCase());return a.push(i),a}const i=t.value.reduce(((e,t)=>{const a=s(t);return a?{...e,[a]:[...e[a],t]}:e}),{md5:[],sha1:[],sha256:[]});return Object.entries(i).forEach((([t,i])=>{if(!i.length)return;const s=o(`${e}${n.b.HASH}${t}`,i);a.push(s)})),a})(e.field.split(".")[0],e).forEach((e=>a.push(e)));else if(e.field.includes(n.b.SIGNER)){const n=function(e,t,a=!1){const n=Array.isArray(t)?o("subject_name",t):r("subject_name",t),i=[];return a&&i.push(r("trusted","true")),i.push(n),((e,t)=>({field:e,entries:t,type:"nested"}))(e,i)}(e.field,e.value,t);a.push(n)}else if((e.field.includes(n.b.EXECUTABLE)||e.field.includes(n.b.PATH))&&"wildcard"===e.type){const t=function(e,t){return Array.isArray(t)?o(e,t):((e,t)=>({field:e,value:t,type:"wildcard",operator:i}))(e,t)}(e.field,e.value);a.push(t)}else{const t=(l=e.field,c=e.value,Array.isArray(c)?o(l,c):r(l,c));a.push(t)}var l,c})),a},c=(e,t,a)=>({field:e,value:a,type:t,operator:i});function u(e){return`${e.split(".")[0]}${n.b.HASH}*`}const d=e=>{const t=(e=>e.reduce(((e,t)=>{const a=t.field;if(a.includes(n.b.HASH)&&"match"===t.type){const n=u(a);return{...e,[n]:c(n,t.type,t.value)}}if(a.includes(n.b.HASH)&&"match_any"===t.type){var i,s;const n=u(a),r=null!==(i=null===(s=e[n])||void 0===s?void 0:s.value)&&void 0!==i?i:[];return{...e,[n]:c(n,t.type,[...r,...t.value])}}if((a.includes(n.b.EXECUTABLE)||a.includes(n.b.PATH))&&("match"===t.type||"match_any"===t.type||"wildcard"===t.type))return{...e,[a]:c(a,t.type,t.value)};if(a.includes(n.b.SIGNER)&&"nested"===t.type){const n=t.entries.find((e=>"subject_name"===e.field&&("match"===e.type||"match_any"===e.type)));if(n)return{...e,[a]:c(a,n.type,n.value)}}return e}),{}))(e);return Object.values(t).reduce(((e,t)=>t?[...e,t]:e),[])}},function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"c",(function(){return m}));var n=a(354);function i({node:e,currentLevel:t,totalDescendants:a,children:n}){const s=n(e);if(s.length<=0)return{generations:t,descendants:a};let r=0,o=a;for(const e of s){const{generations:a,descendants:s}=i({node:e,currentLevel:t+1,totalDescendants:o+1,children:n});o=s,r=Math.max(r,a)}return{generations:r,descendants:o}}var s=a(237);function r(e,t){if(e)return i({node:e,currentLevel:0,totalDescendants:0,children:e=>{var a;return null!==(a=t.get(s.b(e)))&&void 0!==a?a:[]}})}function o(e,t){const a=s.d(e);return void 0===a?void 0:t.get(a)}function l(e,t){const a=new Map,i=new Map;for(const t of e){const e=s.b(t);if(void 0!==e){i.set(e,t);const n=s.d(t);let r=a.get(n);r||(r=[],a.set(n,r)),r.push(t)}}for(const e of a.values())e.sort(n.b);let l,c;if(t){const e=r(i.get(t),a);l=null==e?void 0:e.generations,c=null==e?void 0:e.descendants}const u=function(e,t){if(!e)return;let a=1,n=t.get(e);for(;void 0!==n&&void 0!==o(n,t);)a++,n=o(n,t);return a}(t,i);return{idToChildren:a,idToNode:i,originID:t,generations:l,descendants:c,ancestors:u}}function c(e,t){const a=e.idToChildren.get(t);return void 0===a?[]:a}function u(e,t){var a;return null!==(a=e.idToNode.get(t))&&void 0!==a?a:null}function d(e,t){return o(t,e.idToNode)}function p(e){return e.idToNode.size}function*m(e){const t=function(e){if(0===p(e))return null;let t=e.idToNode.values().next().value;for(;void 0!==d(e,t);)t=d(e,t);return t}(e);null!==t&&(yield*function*(e,t){let a=[e];for(;0!==a.length;){let e=[];for(const n of a)yield n,e.push(...t(n)||[]);a=e,e=[]}}(t,(t=>c(e,s.b(t)))))}},,,,,function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l}));var n=a(77),i=a(319),s=a(232);const r=e=>({...e.page.queries,[s.HostsTableType.authentications]:{...e.page.queries[s.HostsTableType.authentications],activePage:i.a},[s.HostsTableType.hosts]:{...e.page.queries[s.HostsTableType.hosts],activePage:i.a},[s.HostsTableType.events]:{...e.page.queries[s.HostsTableType.events],activePage:i.a},[s.HostsTableType.uncommonProcesses]:{...e.page.queries[s.HostsTableType.uncommonProcesses],activePage:i.a}}),o=e=>({...e.details.queries,[s.HostsTableType.authentications]:{...e.details.queries[s.HostsTableType.authentications],activePage:i.a},[s.HostsTableType.hosts]:{...e.details.queries[s.HostsTableType.hosts],activePage:i.a},[s.HostsTableType.events]:{...e.details.queries[s.HostsTableType.events],activePage:i.a},[s.HostsTableType.uncommonProcesses]:{...e.details.queries[s.HostsTableType.uncommonProcesses],activePage:i.a}}),l=(e,t)=>e.length>0?[{query:{bool:{should:e.map((e=>({match_phrase:{[t===n.v.user?n.w.userRisk:n.w.hostRisk]:{query:e}}})))}},meta:{alias:null,disabled:!1,negate:!1}}]:[]},function(e,t,a){"use strict";a.d(t,"i",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return r})),a.d(t,"h",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"g",(function(){return d})),a.d(t,"j",(function(){return p})),a.d(t,"a",(function(){return m}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.hosts.pageTitle",{defaultMessage:"Hosts"}),s=n.i18n.translate("xpack.securitySolution.hosts.navigation.allHostsTitle",{defaultMessage:"All hosts"}),r=n.i18n.translate("xpack.securitySolution.hosts.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),o=n.i18n.translate("xpack.securitySolution.hosts.navigation.uncommonProcessesTitle",{defaultMessage:"Uncommon processes"}),l=n.i18n.translate("xpack.securitySolution.hosts.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),c=n.i18n.translate("xpack.securitySolution.hosts.navigation.eventsTitle",{defaultMessage:"Events"}),u=n.i18n.translate("xpack.securitySolution.hosts.navigation.hostRiskTitle",{defaultMessage:"Host risk"}),d=n.i18n.translate("xpack.securitySolution.hosts.navigation.sessionsTitle",{defaultMessage:"Sessions"}),p=(n.i18n.translate("xpack.securitySolution.hosts.navigaton.matrixHistogram.errorFetchingEventsData",{defaultMessage:"Failed to query events data"}),n.i18n.translate("xpack.securitySolution.hosts.navigaton.hostRisk.viewDashboardButtonLabel",{defaultMessage:"View source dashboard"})),m=n.i18n.translate("xpack.securitySolution.hosts.navigaton.hostScoreOverTimeTitle",{defaultMessage:"Host risk score over time"})},,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>`${e.entityName}-${e.entityValue}-${e.severity}-${e.jobId}`},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=async({http:e,jobIds:t,signal:a})=>e.fetch("/api/ml/jobs/jobs_summary",{method:"POST",body:JSON.stringify({jobIds:null!=t?t:[]}),asSystemRequest:!0,signal:a})},,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),s=a(286),r=a(365);const o=i.a.memo((({influencers:e,startDate:t,endDate:a,children:n,criteriaFields:o,skip:l})=>{const{jobIds:c}=Object(s.b)(),[u,d]=Object(r.a)({criteriaFields:o,influencers:e,startDate:t,endDate:a,skip:l,jobIds:c,aggregationInterval:"auto"});return i.a.createElement(i.a.Fragment,null,n({isLoadingAnomaliesData:u,anomaliesData:d}))}));o.displayName="AnomalyTableProvider"},function(e,t,a){"use strict";var n=a(500);a.d(t,"a",(function(){return n.a})),a(331)},function(e,t,a){"use strict";a.d(t,"d",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"f",(function(){return g})),a.d(t,"e",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return y}));var n=a(262),i=a(370),s=a(252),r=a(215),o=a(9),l=a(1),c=a(250),u=a(601),d=a(307);const p=[c.b.defineRule,c.b.aboutRule,c.b.scheduleRule,c.b.ruleActions],m=(e,t)=>{var a,n,i;let c=[];var d,p,m;return e.detailName&&null!==(a=e.state)&&void 0!==a&&a.ruleName&&(c=[...c,{text:e.state.ruleName,href:t({deepLinkId:o.a.rules,path:Object(s.d)(e.detailName,"")})}]),e.detailName&&null!==(n=e.state)&&void 0!==n&&n.ruleName&&e.tabName&&(c=[...c,{text:(d=e.tabName,null!==(p=u.a[d])&&void 0!==p?p:u.a[u.b.alerts]),href:t({deepLinkId:o.a.rules,path:Object(s.c)(e.detailName,e.tabName,"")})}]),(m=e.pathName).includes(l.mc)&&m.includes("/create")&&(c=[...c,{text:r.e,href:""}]),(e=>e.includes(l.mc)&&e.includes("/edit"))(e.pathName)&&e.detailName&&null!==(i=e.state)&&void 0!==i&&i.ruleName&&(c=[...c,{text:r.Ab,href:""}]),c},g={anomalyThreshold:50,index:[],indexPattern:{fields:[],title:""},machineLearningJobId:[],ruleType:"query",threatIndex:[],queryBar:{query:{query:"",language:"kuery"},filters:[],saved_id:null},threatQueryBar:{query:{query:l.eb,language:"kuery"},filters:[],saved_id:null},requiredFields:[],relatedIntegrations:[],threatMapping:[],threshold:{field:[],value:"200",cardinality:{field:[],value:""}},timeline:{id:null,title:i.b},eqlOptions:{},dataSourceType:c.a.IndexPatterns,newTermsFields:[],historyWindowSize:"7d",shouldLoadQueryDynamically:!1},f={author:[],name:"",description:"",isAssociatedToEndpointList:!1,isBuildingBlock:!1,severity:{value:"low",mapping:Object(d.b)([]),isMappingChecked:!1},riskScore:{value:21,mapping:[],isMappingChecked:!1},references:[""],falsePositives:[""],license:"",ruleNameOverride:"",tags:[],timestampOverride:"",threat:[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}],note:"",threatIndicatorPath:void 0,timestampOverrideFallbackDisabled:void 0},b=e=>({interval:Object(n.e)(e)?"1h":"5m",from:Object(n.e)(e)?"5m":"1m"}),h={...g.queryBar,query:{...g.queryBar.query,query:"*:*"}},y={forNormalRules:g.queryBar,forThreatMatchRules:h}},function(e,t,a){const n=a(248);e.exports=(e,t,a)=>0===n(e,t,a)},function(e,t,a){const n=a(233);e.exports=(e,t,a)=>{const i=new n(e,a),s=new n(t,a);return i.compare(s)||i.compareBuild(s)}},function(e,t,a){const n=a(248);e.exports=(e,t,a)=>n(e,t,a)<0},function(e,t,a){const n=a(233),i=a(403),{ANY:s}=i,r=a(251),o=a(404),l=a(402),c=a(480),u=a(396),d=a(375);e.exports=(e,t,a,p)=>{let m,g,f,b,h;switch(e=new n(e,p),t=new r(t,p),a){case">":m=l,g=u,f=c,b=">",h=">=";break;case"<":m=c,g=d,f=l,b="<",h="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(o(e,t,p))return!1;for(let a=0;a<t.set.length;++a){const n=t.set[a];let r=null,o=null;if(n.forEach((e=>{e.semver===s&&(e=new i(">=0.0.0")),r=r||e,o=o||e,m(e.semver,r.semver,p)?r=e:f(e.semver,o.semver,p)&&(o=e)})),r.operator===b||r.operator===h)return!1;if((!o.operator||o.operator===b)&&g(e,o.semver))return!1;if(o.operator===h&&f(e,o.semver))return!1}return!0}},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"f",(function(){return s})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"e",(function(){return c}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"}),s=n.i18n.translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"}),r=n.i18n.translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"}),o=n.i18n.translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"}),l=n.i18n.translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"}),c=n.i18n.translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"})},function(e,t,a){"use strict";e.exports=function(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}},function(e,t,a){"use strict";e.exports=function(e){return null==e?[]:"length"in e?e:[e]}},function(e,t,a){"use strict";var n=a(282);e.exports=function(e,t){return e.length?(n(e,e.length,0,t),e):t}},function(e,t,a){"use strict";e.exports=function(e,t,a){for(var n,i=[],s=-1;++s<e.length;)(n=e[s].resolveAll)&&i.indexOf(n)<0&&(t=n(t,a),i.push(n));return t}},function(e,t,a){"use strict";var n=a(284)(/[A-Za-z]/);e.exports=n},function(e,t,a){"use strict";var n=a(283),i=a(485),s=a(282),r=a(483),o=a(486),l=a(327),c=a(590),u=a(591),d=a(593),p=a(592),m={name:"labelEnd",tokenize:function(e,t,a){for(var n,i,s=this,o=s.events.length;o--;)if(("labelImage"===s.events[o][1].type||"labelLink"===s.events[o][1].type)&&!s.events[o][1]._balanced){n=s.events[o][1];break}return function(t){return n?n._inactive?c(t):(i=s.parser.defined.indexOf(r(s.sliceSerialize({start:n.end,end:s.now()})))>-1,e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),l):a(t)};function l(a){return 40===a?e.attempt(g,t,i?t:c)(a):91===a?e.attempt(f,t,i?e.attempt(b,t,c):c)(a):i?t(a):c(a)}function c(e){return n._balanced=!0,a(e)}},resolveTo:function(e,t){for(var a,n,r,c,u,d,p,m=e.length,g=0;m--;)if(c=e[m][1],u){if("link"===c.type||"labelLink"===c.type&&c._inactive)break;"enter"===e[m][0]&&"labelLink"===c.type&&(c._inactive=!0)}else if(d){if("enter"===e[m][0]&&("labelImage"===c.type||"labelLink"===c.type)&&!c._balanced&&(u=m,"labelLink"!==c.type)){g=2;break}}else"labelEnd"===c.type&&(d=m);return a={type:"labelLink"===e[u][1].type?"link":"image",start:l(e[u][1].start),end:l(e[e.length-1][1].end)},n={type:"label",start:l(e[u][1].start),end:l(e[d][1].end)},r={type:"labelText",start:l(e[u+g+2][1].end),end:l(e[d-2][1].start)},p=i(p=[["enter",a,t],["enter",n,t]],e.slice(u+1,u+g+3)),p=i(p,[["enter",r,t]]),p=i(p,o(t.parser.constructs.insideSpan.null,e.slice(u+g+4,d-3),t)),p=i(p,[["exit",r,t],e[d-2],e[d-1],["exit",n,t]]),p=i(p,e.slice(d+1)),p=i(p,[["exit",a,t]]),s(e,u,e.length,p),e},resolveAll:function(e){for(var t,a=-1;++a<e.length;)(t=e[a][1])._used||"labelImage"!==t.type&&"labelLink"!==t.type&&"labelEnd"!==t.type||(e.splice(a+1,"labelImage"===t.type?4:2),t.type="data",a++);return e}},g={tokenize:function(e,t,a){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),p(e,i)};function i(t){return 41===t?o(t):c(e,s,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(t)}function s(t){return n(t)?p(e,r)(t):o(t)}function r(t){return 34===t||39===t||40===t?d(e,p(e,o),a,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):o(t)}function o(n){return 41===n?(e.enter("resourceMarker"),e.consume(n),e.exit("resourceMarker"),e.exit("resource"),t):a(n)}}},f={tokenize:function(e,t,a){var n=this;return function(t){return u.call(n,e,i,a,"reference","referenceMarker","referenceString")(t)};function i(e){return n.parser.defined.indexOf(r(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))<0?a(e):t(e)}}},b={tokenize:function(e,t,a){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),n};function n(n){return 93===n?(e.enter("referenceMarker"),e.consume(n),e.exit("referenceMarker"),e.exit("reference"),t):a(n)}}};e.exports=m},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return r})),a.d(t,"g",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"j",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"k",(function(){return m})),a.d(t,"c",(function(){return g}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"URL is invalid format"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."})},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),s=a(17),r=a(215);const o=i.a.memo((({onClick:e,isDisabled:t,dataTestSubj:a="nextStep-continue"})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiHorizontalRule,{margin:"m"}),i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButton,{fill:!0,onClick:e,isDisabled:t,"data-test-subj":a},r.pb))))));o.displayName="NextStep"},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(180),s=a(19);const r=()=>{const e=Object(s.k)(),{http:t}=e.services,[a,r]=Object(n.useState)(Object(i.createSavedQueryService)(t));return Object(n.useEffect)((()=>{r(Object(i.createSavedQueryService)(t))}),[t]),a}},function(e,t,a){"use strict";a.d(t,"d",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"a",(function(){return f}));var n=a(1),i=a(269),s=a(9),r=a(252),o=a(70),l=a(741),c=a(452),u=a(215),d=a(448);const p=(e,t)=>{t(n.A,{deepLinkId:s.a.rules,path:Object(r.b)(null!=e?e:"")})};async function m({visibleRuleIds:e=[],action:t,setLoadingRules:a,toasts:n,search:s,payload:r,onSuccess:l=h,onError:u=b,onFinish:d}){let p=null;try{null==a||a({ids:e,action:t}),t===i.a.export?p=await Object(c.b)({...s,action:t}):(p=await Object(c.b)({...s,action:t,edit:null==r?void 0:r.edit}),function(e,t){e!==i.a.disable&&e!==i.a.enable||(t.attributes.results.updated.some((e=>e.immutable))&&Object(o.e)(o.a.COUNT,e===i.a.enable?o.b.SIEM_RULE_ENABLED:o.b.SIEM_RULE_DISABLED),t.attributes.results.updated.some((e=>!e.immutable))&&Object(o.e)(o.a.COUNT,e===i.a.disable?o.b.CUSTOM_RULE_ENABLED:o.b.CUSTOM_RULE_DISABLED))}(t,p),l(n,t,p.attributes.summary))}catch(e){u(n,t,e)}finally{null==a||a({ids:[],action:null}),null==d||d()}return p}async function g({response:e,toasts:t,onSuccess:a=h,onError:n=b}){try{Object(l.a)(e,`${u.Gb}.ndjson`),a(t,i.a.export,await Object(d.b)(e))}catch(e){n(t,i.a.export,e)}}async function f(e){const t=await m(e);t&&await g({response:t,toasts:e.toasts,onSuccess:e.onSuccess})}function b(e,t,a){var n,s;const r=null==a||null===(n=a.body)||void 0===n||null===(s=n.attributes)||void 0===s?void 0:s.summary;let o,l;switch(a.stack=JSON.stringify(a.body,null,2),t){case i.a.export:o=u.vc,r&&(l=u.wc(r.failed));break;case i.a.duplicate:o=u.jc,r&&(l=u.kc(r.failed));break;case i.a.delete:o=u.bc,r&&(l=u.cc(r.failed));break;case i.a.enable:o=u.rc,r&&(l=u.sc(r.failed));break;case i.a.disable:o=u.fc,r&&(l=u.gc(r.failed));break;case i.a.edit:o=u.nc,r&&(l=u.oc(r.failed))}e.addError(a,{title:o,toastMessage:l})}async function h(e,t,a){let n,s;switch(t){case i.a.export:n=u.yc,s=((e,t)=>{const a=[u.zc(e,t)];return t>e&&a.push(u.xc),a.join(" ")})(a.succeeded,a.total);break;case i.a.duplicate:n=u.lc,s=u.mc(a.succeeded);break;case i.a.delete:n=u.dc,s=u.ec(a.succeeded);break;case i.a.enable:n=u.tc,s=u.uc(a.succeeded);break;case i.a.disable:n=u.hc,s=u.ic(a.succeeded);break;case i.a.edit:n=u.pc,s=u.qc(a.succeeded)}e.addSuccess({title:n,text:s})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(24);const i=a.n(n).a.div.withConfig({displayName:"Display",componentId:"sc-1njjyjq-0"})(["",";"],(({show:e})=>e?"":"display: none;"));i.displayName="Display"},function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(5),i=a(2),s=a(255);const r=e=>null==e?null:e===s.f["partial failure"]?"warning":e,o=e=>{const t=r(e);return null!=t?Object(n.capitalize)(t):null},l=e=>null==e?"subdued":e===s.f.succeeded?"success":e===s.f.failed?"danger":e===s.f.running||e===s.f["partial failure"]||e===s.f["going to run"]?"warning":Object(i.a)(e,"Unknown rule execution status")},function(e,t,a){"use strict";a.d(t,"a",(function(){return TrustedAppsApiClient}));var n=a(217),i=a(458),s=a(314),r=a(450);function o(e){return{...e,entries:Object(i.b)(e.entries)}}function l(e){return{...e,entries:Object(i.a)(e.entries,!0)}}class TrustedAppsApiClient extends s.a{constructor(e){super(e,n.m,r.b,o,l)}static getInstance(e){return super.getInstance(e,n.m,r.b,o,l)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return o}));var n=a(219),i=a(217);const s=n.a.ENDPOINT_BLOCKLISTS,r={name:i.c,namespace_type:"agnostic",description:i.a,list_id:i.b,type:s},o=["name","description","item_id","entries.value","entries.entries.value","comments.comment"]},function(e,t,a){"use strict";a.d(t,"b",(function(){return le})),a.d(t,"a",(function(){return ue}));var n=a(53),i=a.n(n),s=a(4),r=a.n(s),o=a(187),l=a(256),c=a(346),u=a(24),d=a.n(u);const p=d.a.div.attrs((({width:e})=>{if(e)return{style:{width:`${e}px`}}})).withConfig({displayName:"Field",componentId:"sc-11dh2wt-0"})(["background-color:",";border:",";box-shadow:0 2px 2px -1px ",",0 1px 5px -2px ",";font-size:",";font-weight:",";line-height:",";padding:",";"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>Object(c.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>Object(c.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS));p.displayName="Field";const m=r.a.memo((({fieldId:e,fieldWidth:t})=>r.a.createElement(p,{"data-test-subj":"field",width:t},e)));m.displayName="DraggableFieldBadge";var g=a(220),f=a(15),b=a(245),h=a(17),y=a(736),E=a(47),v=a(93),k=a(36),S=a(77),T=a(241),x=a(3),w=a(44),O=a(76),j=a(91),I=a(372);const C=r.a.memo((({columnId:e,onColumnRemoved:t})=>{const a=Object(s.useCallback)((a=>{a.preventDefault(),a.stopPropagation(),t(e)}),[e,t]);return r.a.createElement(h.EuiButtonIcon,{"aria-label":I.f,color:"text","data-test-subj":"remove-column",iconType:"cross",onClick:a})}));C.displayName="CloseButton";const M=r.a.memo((({header:e,onColumnRemoved:t,sort:a,isLoading:n})=>r.a.createElement(r.a.Fragment,null,a.some((t=>t.columnId===e.id))&&n?r.a.createElement(b.d,{className:"siemEventsHeading__extra--loading"},r.a.createElement(b.h,{"data-test-subj":"timeline-loading-spinner"})):r.a.createElement(b.d,{className:"siemEventsHeading__extra--close"},r.a.createElement(C,{columnId:e.id,onColumnRemoved:t})))));M.displayName="Actions";const D=d()(h.EuiFieldText).withConfig({displayName:"FieldText",componentId:"sc-xd12j6-0"})(["min-width:",";"],(e=>e.minwidth));D.displayName="FieldText";const A=r.a.memo((({columnId:e,minWidth:t,filter:a="",onFilterChange:n=x.noop,placeholder:i="Filter"})=>r.a.createElement(D,{"data-test-subj":"textFilter",minwidth:`${t}px`,placeholder:i,value:a,onChange:t=>{n({columnId:e,filter:t.target.value})}})));A.displayName="TextFilter";const F=r.a.memo((({header:e,onFilterChange:t=x.noop})=>{var a;return"text-filter"===e.columnHeaderType?r.a.createElement(A,{columnId:e.id,minWidth:null!==(a=e.initialWidth)&&void 0!==a?a:k.a,onFilterChange:t,placeholder:e.placeholder}):null}));F.displayName="Filter";const R=({header:e,sort:t})=>t.reduce(((t,a)=>e.id===a.columnId?a.sortDirection:t),"none"),P=({header:e,sort:t})=>t.findIndex((t=>t.columnId===e.id));var _=a(366),q=a(373);const N=r.a.memo((({sortNumber:e})=>e>=0?r.a.createElement(h.EuiNotificationBadge,{color:"subdued","data-test-subj":"sortNumber"},e+1):r.a.createElement(h.EuiIcon,{"data-test-subj":"sortEmptyNumber",type:"empty"})));var L;N.displayName="SortNumber",function(e){e.SORT_UP="sortUp",e.SORT_DOWN="sortDown"}(L||(L={}));const B=r.a.memo((({sortDirection:e,sortNumber:t})=>{const a=(e=>{switch(e){case S.b.asc:return L.SORT_UP;case S.b.desc:return L.SORT_DOWN;case"none":return;default:throw new Error("Unhandled sort direction")}})(e);return null!=a?r.a.createElement(h.EuiToolTip,{content:a===L.SORT_UP?q.o:q.p,"data-test-subj":"sort-indicator-tooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:a}),r.a.createElement(N,{sortNumber:t}))):r.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:"empty"})}));B.displayName="SortIndicator";var z=a(352);const H=d()(h.EuiIcon).withConfig({displayName:"IconType",componentId:"sc-1xrxlc-0"})(["margin-right:3px;position:relative;top:-2px;"]);H.displayName="IconType";const $=d.a.span.withConfig({displayName:"P",componentId:"sc-1xrxlc-1"})(["margin-bottom:5px;"]);$.displayName="P";const V=d.a.span.withConfig({displayName:"ToolTipTableMetadata",componentId:"sc-1xrxlc-2"})(["margin-right:5px;display:block;font-weight:bold;"]);V.displayName="ToolTipTableMetadata";const U=d.a.span.withConfig({displayName:"ToolTipTableValue",componentId:"sc-1xrxlc-3"})(["word-wrap:break-word;"]);U.displayName="ToolTipTableValue";const Q=r.a.memo((({header:e})=>{var t;return r.a.createElement(r.a.Fragment,null,!Object(x.isEmpty)(e.category)&&r.a.createElement($,null,r.a.createElement(V,{"data-test-subj":"category"},I.a,":"),r.a.createElement(U,{"data-test-subj":"category-value"},e.category)),r.a.createElement($,null,r.a.createElement(V,{"data-test-subj":"field"},I.c,":"),r.a.createElement(U,{"data-test-subj":"field-value"},e.id)),r.a.createElement($,null,r.a.createElement(V,{"data-test-subj":"type"},I.j,":"),r.a.createElement(U,null,r.a.createElement(H,{"data-test-subj":"type-icon",type:Object(z.d)(e.type)}),null===(t=e.esTypes)||void 0===t?void 0:t.map((e=>r.a.createElement(h.EuiBadge,{"data-test-subj":`type-value-${e}`,key:e},e))))),!Object(x.isEmpty)(e.description)&&r.a.createElement($,null,r.a.createElement(V,{"data-test-subj":"description"},I.b,":"),r.a.createElement(U,{"data-test-subj":"description-value"},e.description)))}));Q.displayName="HeaderToolTipContent";const W=({children:e,header:t,isLoading:a,isResizing:n,onClick:i,showSortingCapability:s,sort:o})=>{var l,c;return r.a.createElement(b.c,{"data-test-subj":`header-${t.id}`,isLoading:a},t.aggregatable&&s?r.a.createElement(b.f,{"data-test-subj":"header-sort-button",onClick:n||a?x.noop:i},r.a.createElement(_.b,{"data-test-subj":`header-text-${t.id}`},r.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:r.a.createElement(Q,{header:t})},r.a.createElement(r.a.Fragment,null,r.a.isValidElement(t.display)?t.display:null!==(l=t.displayAsText)&&void 0!==l?l:t.id))),r.a.createElement(B,{"data-test-subj":"header-sort-indicator",sortDirection:R({header:t,sort:o}),sortNumber:P({header:t,sort:o})})):r.a.createElement(b.g,null,r.a.createElement(_.b,{"data-test-subj":`header-text-${t.id}`},r.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:r.a.createElement(Q,{header:t})},r.a.createElement(r.a.Fragment,null,r.a.isValidElement(t.display)?t.display:null!==(c=t.displayAsText)&&void 0!==c?c:t.id)))),e)},G=r.a.memo(W);var K=a(14),J=a(103);const Y=({header:e,onFilterChange:t=x.noop,sort:a,timelineId:n})=>{const i=Object(E.useDispatch)(),o=Object(s.useMemo)((()=>Object(K.createSelector)(J.selectTimeline,(e=>(null==e?void 0:e.activeTab)===f.l.eql))),[]),l=Object(O.b)((e=>o(e,n))),c=Object(s.useCallback)((()=>{var t,s;const r=e.id,o=null!==(t=e.type)&&void 0!==t?t:"",l=null!==(s=e.esTypes)&&void 0!==s?s:[],c=(({clickedHeader:e,currentSort:t})=>t.reduce(((t,a)=>e.id===a.columnId?(e=>{switch(e.sortDirection){case S.b.desc:return S.b.asc;case S.b.asc:default:return S.b.desc}})(a):t),S.b.desc))({clickedHeader:e,currentSort:a}),u=a.findIndex((e=>e.columnId===r));let d=[];d=-1===u?[...a,{columnId:r,columnType:o,esTypes:l,sortDirection:c}]:[...a.slice(0,u),{columnId:r,columnType:o,esTypes:l,sortDirection:c},...a.slice(u+1)],i(j.a.updateSort({id:n,sort:d}))}),[i,e,a,n]),u=Object(s.useCallback)((e=>i(j.a.removeColumn({id:n,columnId:e}))),[i,n]),d=Object(s.useMemo)((()=>j.b.getManageTimelineById()),[]),{isLoading:p}=Object(O.a)((e=>d(e,n)||{isLoading:!1})),m=!l&&!Object(w.g)(e);return r.a.createElement(r.a.Fragment,null,r.a.createElement(G,{header:e,isLoading:p,isResizing:!1,onClick:c,showSortingCapability:m,sort:a},r.a.createElement(M,{header:e,isLoading:p,onColumnRemoved:u,sort:a})),r.a.createElement(F,{header:e,onFilterChange:t}))},X=r.a.memo(Y);var Z=a(19);const ee=d()(h.EuiContextMenu).withConfig({displayName:"ContextMenu",componentId:"sc-1yjxccs-0"})(["width:115px;& .euiContextMenuItem{font-size:12px;padding:4px 8px;width:115px;}"]),te=d.a.div.withConfig({displayName:"PopoverContainer",componentId:"sc-1yjxccs-1"})(["& .euiPopover__anchor{padding-right:8px;width:","px;}"],(({$width:e})=>e)),ae={right:!0},ne=({draggableIndex:e,header:t,timelineId:a,isDragging:n,onFilterChange:l,sort:c,tabType:u})=>{const d=Object(s.useRef)(null),[p,m]=Object(s.useState)(!1),x=Object(s.useCallback)((()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.focus()}),[]),w=Object(E.useDispatch)(),{timelines:O}=Object(Z.k)().services,C=Object(s.useMemo)((()=>{var e;return{width:null!==(e=t.initialWidth)&&void 0!==e?e:k.a,height:"auto"}}),[t.initialWidth]),M=Object(s.useMemo)((()=>({position:n?"absolute":"relative"})),[n]),D=Object(s.useMemo)((()=>({right:r.a.createElement(b.e,null)})),[]),A=Object(s.useCallback)(((e,n,i,s)=>{w(j.a.applyDeltaToColumnWidth({columnId:t.id,delta:s.width,id:a}))}),[w,t.id,a]),F=Object(s.useMemo)((()=>Object(g.j)({contextId:`timeline-column-headers-${u}-${a}`,fieldId:t.id})),[u,a,t.id]),R=Object(s.useCallback)((e=>{var n,i;const s=t.id,r=null!==(n=t.type)&&void 0!==n?n:"",o=null!==(i=t.esTypes)&&void 0!==i?i:[],l=c.findIndex((e=>e.columnId===s)),u=-1===l?[...c,{columnId:s,columnType:r,esTypes:o,sortDirection:e}]:[...c.slice(0,l),{columnId:s,columnType:r,esTypes:o,sortDirection:e},...c.slice(l+1)];w(j.a.updateSort({id:a,sort:u}))}),[w,t,c,a]),P=Object(s.useCallback)((()=>{m(!1),x()}),[x]),_=Object(s.useMemo)((()=>[{id:0,items:[{icon:r.a.createElement(h.EuiIcon,{type:"eyeClosed",size:"s"}),name:I.e,onClick:()=>{w(j.a.removeColumn({id:a,columnId:t.id})),P()}},...u!==f.l.eql?[{disabled:!t.aggregatable,icon:r.a.createElement(h.EuiIcon,{type:"sortUp",size:"s"}),name:I.g,onClick:()=>{R(S.b.asc),P()}},{disabled:!t.aggregatable,icon:r.a.createElement(h.EuiIcon,{type:"sortDown",size:"s"}),name:I.i,onClick:()=>{R(S.b.desc),P()}}]:[]]}]),[w,P,t.aggregatable,t.id,R,u,a]),q=Object(s.useMemo)((()=>r.a.createElement(X,{timelineId:a,header:t,onFilterChange:l,sort:c})),[t,l,c,a]),N=Object(s.useCallback)((e=>{var a;return r.a.createElement(b.o,i()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),r.a.createElement(b.p,null,r.a.createElement(te,{$width:null!==(a=t.initialWidth)&&void 0!==a?a:k.a},r.a.createElement(h.EuiPopover,{anchorPosition:"downLeft",button:q,closePopover:P,isOpen:p,ownFocus:!0,panelPaddingSize:"none"},r.a.createElement(ee,{initialPanelId:0,panels:_})))))}),[P,q,t.initialWidth,p,_]),L=Object(s.useCallback)((()=>{var e;null===(e=d.current)||void 0===e||e.focus()}),[]),B=Object(s.useCallback)((()=>{m(!0)}),[]),{onBlur:z,onKeyDown:H}=O.getUseDraggableKeyboardWrapper()({closePopover:P,draggableId:F,fieldName:t.id,keyboardHandlerRef:d,openPopover:B}),$=Object(s.useCallback)((e=>{p||H(e)}),[p,H]);return r.a.createElement(y.Resizable,{enable:ae,size:C,style:M,handleComponent:D,onResizeStop:A},r.a.createElement("div",{"aria-colindex":null!=e?e+T.c:void 0,className:v.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:L,onBlur:z,onKeyDown:$,ref:d,role:"columnheader",tabIndex:0},r.a.createElement(o.Draggable,{"data-test-subj":"draggable",disableInteractiveElementBlocking:!0,draggableId:F,index:e,key:t.id},N)))},ie=r.a.memo(ne);var se=a(13),re=a(614);const oe=r.a.memo((({children:e,onMount:t,onUnmount:a})=>(Object(s.useEffect)((()=>(t(),()=>a())),[t,a]),r.a.createElement(r.a.Fragment,null,e))));oe.displayName="DraggableContainer";const le=({globalFullScreen:e,timelineId:t,timelineFullScreen:a})=>t===f.i.active&&a||t!==f.i.active&&e,ce=({actionsColumnWidth:e,browserFields:t,columnHeaders:a,isEventViewer:n=!1,isSelectAllChecked:c,onSelectAll:u,show:d,showEventsSelect:p,showSelectAllCheckbox:f,sort:h,tabType:y,timelineId:E,leadingControlColumns:v,trailingControlColumns:k})=>{const[S,T]=Object(s.useState)(null),x=Object(s.useRef)(null);Object(s.useEffect)((()=>()=>{x.current&&x.current.closeEditor()}),[]),Object(s.useEffect)((()=>{!d&&x.current&&x.current.closeEditor()}),[d]);const w=Object(s.useCallback)(((e,t,n)=>{const s=n.source.index,o=a[s];return r.a.createElement(b.o,i()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),r.a.createElement(oe,{onMount:()=>T(s),onUnmount:()=>T(null)},r.a.createElement(l.a,null,r.a.createElement(m,{fieldId:o.id,fieldWidth:o.initialWidth}))))}),[a,T]),O=Object(s.useMemo)((()=>a.map(((e,t)=>r.a.createElement(ie,{key:e.id,draggableIndex:t,timelineId:E,header:e,isDragging:S===t,sort:h,tabType:y})))),[a,E,S,h,y]),j=Object(s.useCallback)(((e,t)=>r.a.createElement(r.a.Fragment,null,r.a.createElement(b.r,i()({"data-test-subj":"headers-group",ref:e.innerRef,isDragging:t.isDraggingOver},e.droppableProps),O))),[O]),I=Object(s.useMemo)((()=>v?v.map((e=>e.headerCellRender)):[]),[v]),C=Object(s.useMemo)((()=>k?k.map((e=>e.headerCellRender)):[]),[k]),M=Object(re.a)({sourcererScope:se.SourcererScopeName.timeline,timelineId:E,editorActionsRef:x}),D=Object(s.useMemo)((()=>I.map(((i,s)=>{const o=v[s]&&v[s].width||e;return r.a.createElement(b.q,{actionsColumnWidth:o,"data-test-subj":"actions-container",isEventViewer:n,key:s},i&&r.a.createElement(i,{width:o,browserFields:t,columnHeaders:a,isEventViewer:n,isSelectAllChecked:c,onSelectAll:u,showEventsSelect:p,showSelectAllCheckbox:f,sort:h,tabType:y,timelineId:E,fieldBrowserOptions:M}))}))),[I,v,e,t,a,M,n,c,u,p,f,h,y,E]),A=Object(s.useMemo)((()=>C.map(((i,s)=>{const o=k[s]&&k[s].width||e;return r.a.createElement(b.q,{actionsColumnWidth:o,"data-test-subj":"actions-container",isEventViewer:n,key:s},i&&r.a.createElement(i,{width:o,browserFields:t,columnHeaders:a,isEventViewer:n,isSelectAllChecked:c,onSelectAll:u,showEventsSelect:p,showSelectAllCheckbox:f,sort:h,tabType:y,timelineId:E,fieldBrowserOptions:M}))}))),[C,k,e,t,a,M,n,c,u,p,f,h,y,E]);return r.a.createElement(b.s,{"data-test-subj":"column-headers"},r.a.createElement(b.v,null,D,r.a.createElement(o.Droppable,{direction:"horizontal",droppableId:`${g.f}-${y}.${E}`,isDropDisabled:!1,type:g.a,renderClone:w},j),A))},ue=r.a.memo(ce)},function(e,t,a){"use strict";a.d(t,"a",(function(){return D}));var n=a(4),i=a.n(n),s=a(17),r=a(203),o=a(3),l=a(24),c=a.n(l),u=a(550),d=a(220),p=a(551),m=a(211),g=a(387);const f=(e=[])=>e.filter((e=>!Object(o.isEmpty)(e))).map((e=>{const t=(e=>{const[t,a]=Object(g.a)(e);return null!=t&&null!=a?`${t}: "${a}"`:""})(e);return i.a.createElement(s.EuiFlexItem,{key:t,grow:!1},t)}));var b=a(6);const h=b.i18n.translate("xpack.securitySolution.ml.score.influencedByTitle",{defaultMessage:"Influenced By"}),y=b.i18n.translate("xpack.securitySolution.ml.score.maxAnomalyScoreTitle",{defaultMessage:"Max Anomaly Score"}),E=b.i18n.translate("xpack.securitySolution.ml.score.anomalyJobTitle",{defaultMessage:"Job"}),v=b.i18n.translate("xpack.securitySolution.ml.score.viewInMachineLearningLink",{defaultMessage:"View in Machine Learning"}),k=b.i18n.translate("xpack.securitySolution.ml.score.detectedTitle",{defaultMessage:"Detected"}),S=b.i18n.translate("xpack.securitySolution.ml.score.narrowToThisDateRangeLink",{defaultMessage:"Narrow to this date range"}),T=b.i18n.translate("xpack.securitySolution.ml.score.anomalousEntityTitle",{defaultMessage:"Anomalous Entity"});var x=a(552);const w=c()(s.EuiText).withConfig({displayName:"LargeScore",componentId:"sc-1ocpxoq-0"})(["font-size:45px;font-weight:lighter;"]);w.displayName="LargeScore";const O=(e,t,a,n,r)=>[{title:y,description:i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(w,null,Object(p.a)(e.severity)))},{title:i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"m"}),E),description:i.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},e.jobId),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(x.a,{score:e,startDate:t,endDate:a,linkName:v})))},{title:k,description:i.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(m.c,{value:new Date(e.time)})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiLink,{"data-test-subj":"anomaly-description-narrow-range-link",onClick:()=>{r(e,n)},target:"_blank"},S)))},{title:T,description:i.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},`${e.entityName}: "${e.entityValue}"`))},{title:h,description:i.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},f(e.influencers))}],j=c()(s.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1pfd59a-0"})(["vertical-align:text-bottom;cursor:pointer;"]);j.displayName="Icon";const I=({jobKey:e,startDate:t,endDate:a,index:r=0,score:o,interval:l,narrowDateRange:c})=>{const[p,m]=Object(n.useState)(!1);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(u.a,{id:Object(d.h)(`anomaly-scores-${e}`),index:r,score:o})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiPopover,{"data-test-subj":"anomaly-score-popover",id:"anomaly-score-popover",isOpen:p,onClick:()=>m(!p),closePopover:()=>m(!p),button:i.a.createElement(j,{type:"iInCircle"}),repositionOnScroll:!0},i.a.createElement(s.EuiDescriptionList,{"data-test-subj":"anomaly-description-list",listItems:O(o,t,a,l,c)}))))};I.displayName="AnomalyScoreComponent";const C=i.a.memo(I);C.displayName="AnomalyScore";const M=({anomalies:e,startDate:t,endDate:a,isLoading:n,narrowDateRange:l,limit:c})=>n?i.a.createElement(s.EuiLoadingSpinner,{"data-test-subj":"anomaly-score-spinner",size:"m"}):null==e||0===e.anomalies.length?Object(r.d)():i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{gutterSize:"none",responsive:!1},((e,t)=>{const a=e.reduce(((e,t)=>{const a=t.jobId,n=t.severity;return(null==e[a]||e[a].severity<n)&&(e[a]=t),e}),{}),n=Object(o.toArray)(a).sort(((e,t)=>t.severity-e.severity));return null==t?n:n.slice(0,t)})(e.anomalies,c).map(((n,s)=>{const r=(e=>`${e.jobId}-${e.severity}-${e.entityName}-${e.entityValue}`)(n);return i.a.createElement(C,{key:r,jobKey:r,startDate:t,endDate:a,index:s,score:n,interval:e.interval,narrowDateRange:l})}))));M.displayName="AnomalyScoresComponent";const D=i.a.memo(M);D.displayName="AnomalyScores"},function(e,t,a){"use strict";a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return m}));var n=a(4),i=a.n(n),s=a(17),r=a(6);r.i18n.translate("xpack.securitySolution.firstLastSeenHost.errorSearchDescription",{defaultMessage:"An error has occurred on first last seen host search"});const o=r.i18n.translate("xpack.securitySolution.firstLastSeenHost.failSearchDescription",{defaultMessage:"Failed to run search on first last seen host"});var l=a(240),c=a(77),u=a(203),d=a(211);let p;!function(e){e.FIRST_SEEN="first-seen",e.LAST_SEEN="last-seen"}(p||(p={}));const m=i.a.memo((({indexPatterns:e,field:t,type:a,value:r})=>{const[m,{firstSeen:g,lastSeen:f,errorMessage:b}]=(({field:e,value:t,order:a,defaultIndex:i})=>{const{loading:s,result:r,search:u,error:d}=Object(l.a)({factoryQueryType:c.d,initialResult:{firstSeen:null,lastSeen:null},errorMessage:o});return Object(n.useEffect)((()=>{u({defaultIndex:i,factoryQueryType:c.d,field:e,value:t,order:a})}),[i,e,t,a,u]),[s,Object(n.useMemo)((()=>({firstSeen:r.firstSeen,lastSeen:r.lastSeen,errorMessage:d?d.toString():null})),[r,d])]})({field:t,value:r,order:a===p.FIRST_SEEN?c.b.asc:c.b.desc,defaultIndex:e}),h=Object(n.useMemo)((()=>a===p.FIRST_SEEN?g:f),[g,f,a]);return null!=b?i.a.createElement(s.EuiToolTip,{position:"top",content:b,"data-test-subj":"firstLastSeenErrorToolTip","aria-label":`firstLastSeenError-${a}`,id:`firstLastSeenError-${t}-${a}`},i.a.createElement(s.EuiIcon,{"aria-describedby":`firstLastSeenError-${t}-${a}`,type:"alert"})):i.a.createElement(i.a.Fragment,null,m&&i.a.createElement(s.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:"m"}),m||null==h||"Invalid Date"!==new Date(h).toString()?!m&&null!==h&&i.a.createElement(s.EuiText,{"data-test-subj":"first-last-seen-value",size:"s"},i.a.createElement(d.b,{value:`${h}`})):h,!m&&null===h&&Object(u.d)())}));m.displayName="FirstLastSeen"},function(e,t,a){"use strict";a.d(t,"a",(function(){return A}));var n=a(53),i=a.n(n),s=a(4),r=a.n(s),o=a(47),l=a(17),c=a(15),u=a(534),d=a(91),p=a(80),m=a(36);const g=[{columnHeaderType:p.a,id:"@timestamp",initialWidth:m.b,esTypes:["date"],type:"date"},{columnHeaderType:p.a,id:"message"},{columnHeaderType:p.a,id:"host.name"},{columnHeaderType:p.a,id:"event.module"},{columnHeaderType:p.a,id:"agent.type"},{columnHeaderType:p.a,id:"event.dataset"},{columnHeaderType:p.a,id:"event.action"},{columnHeaderType:p.a,id:"user.name"},{columnHeaderType:p.a,id:"source.ip"},{columnHeaderType:p.a,id:"destination.ip"}],f={...a(94).a,columns:g};var b=a(429),h=a(96),y=a(729),E=a(1),v=a(331),k=a(423),S=a(377),T=a(576),x=a(13),w=a(238),O=a(609),j=a(79),I=a(19);const C={meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{bool:{filter:[{bool:{should:[{match:{"event.kind":"alert"}}],minimum_should_match:1}}]}}},M="alertsOrEventsHistogramQuery",D=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:n,externalAlertPageFilters:p=[],pageFilters:g=[],setQuery:D,startDate:A,timelineId:F})=>{const R=Object(o.useDispatch)(),{globalFullScreen:P}=Object(h.a)(),_=Object(w.a)("tGridEnabled"),[q]=Object(I.q)(E.Y),[N,L]=Object(s.useState)(!1),B=Object(j.b)().isEnterprise()?5:4,z=Object(s.useMemo)((()=>Object(k.a)(B)),[B]),H=Object(s.useCallback)((()=>L((e=>!e))),[]),$=Object(s.useMemo)((()=>Object(v.d)(q,N)),[q,N]);Object(s.useEffect)((()=>{R(d.a.initializeTGridSettings({id:F,defaultColumns:f.columns.map((e=>_||null!=e.initialWidth?e:{...e,initialWidth:m.a})),excludedRowRendererIds:N?Object.values(c.d):void 0}))}),[R,N,_,F]),Object(s.useEffect)((()=>()=>{e&&e({id:M})}),[e]);const V=Object(s.useMemo)((()=>r.a.createElement(l.EuiCheckbox,{id:"showExternalAlertsCheckbox","data-test-subj":"showExternalAlertsCheckbox","aria-label":y.h,checked:N,color:"text",label:y.h,onChange:H})),[N,H]),U=Object(s.useMemo)((()=>({...f,excludedRowRendererIds:N?Object.values(c.d):[]})),[N]),Q=Object(s.useMemo)((()=>[...g,...N?[C,...p]:[]]),[N,p,g]);return r.a.createElement(r.a.Fragment,null,!P&&r.a.createElement(b.a,i()({id:M,startDate:A,endDate:t,filterQuery:a,indexNames:n,setQuery:D},N?v.a:v.b,{subtitle:$})),r.a.createElement(u.a,{additionalFilters:V,defaultCellActions:O.a,start:A,end:t,entityType:"events",leadingControlColumns:z,renderCellValue:T.a,rowRenderers:S.b,scopeId:x.SourcererScopeName.default,id:F,unit:N?y.b:y.f,defaultModel:U,pageFilters:Q}))};D.displayName="EventsQueryTabBodyComponent";const A=r.a.memo(D);A.displayName="EventsQueryTabBody"},,function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(4),i=a(1),s=a(376),r=a(351),o=a(202),l=a(19),c=a(531);const u=["siem_cloudtrail","siem_packetbeat","security_auth","security_linux_v3","security_network","security_windows_v3"],d=(e,t,a)=>{const n=t.find((t=>t.id===e));return void 0!==n?{moduleId:n.moduleId,defaultIndexPattern:n.defaultIndexPattern,isCompatible:a.includes(n.moduleId),isElasticJob:!0}:{moduleId:"",defaultIndexPattern:"",isCompatible:!0,isElasticJob:!1}};var p=a(224),m=a(514),g=a(468);const f=e=>{const[t,a]=Object(n.useState)([]),[f,b]=Object(n.useState)(!0),h=Object(p.a)(),[y]=Object(l.q)(i.Q),E=Object(l.j)(),{addError:v}=Object(o.a)(),k=Object(s.a)(h),S=Object(r.a)(h);return Object(n.useEffect)((()=>{let e=!0;const t=new AbortController;return b(!0),async function(){if(k&&S)try{const[n,i,s]=await Promise.all([Object(g.a)({http:E,signal:t.signal}),Object(c.b)({signal:t.signal}),Object(c.a)({indexPatternName:y,signal:t.signal})]),r=((e,t,a)=>{const n=a.map((e=>e.id)),i=((e,t)=>e.filter((e=>u.includes(e.id))).map((e=>[...e.jobs.map((a=>((e,t,a)=>({datafeedId:"",datafeedIndices:[],datafeedState:"",hasDatafeed:!1,isSingleMetricViewerJob:!1,jobState:"closed",memory_status:"",processed_record_count:0,id:t.id,description:t.config.description,groups:[...t.config.groups].sort(),defaultIndexPattern:e.defaultIndexPattern,moduleId:e.id,isCompatible:a,isInstalled:!1,isElasticJob:!0,awaitingNodeAssignment:!1,jobTags:{},bucketSpanSeconds:900}))(e,a,t.includes(e.id))))])).flat())(t,n),s=((e,t,a)=>e.filter((({groups:e})=>e.includes("siem")||e.includes("security"))).map((e=>({...e,...d(e.id,t,a),isInstalled:!0}))))(e,i,n);return((e,t)=>{const a=e.map((e=>e.id));return[...e,...t.filter((e=>!a.includes(e.id)))].sort(((e,t)=>e.id.localeCompare(t.id)))})(s,i)})(n,i,s);e&&a(r)}catch(t){e&&v(t,{title:m.a})}e&&b(!1)}(),()=>{e=!1,t.abort()}}),[e,k,S,y,v,E]),{isLicensed:S,isMlAdmin:k,jobs:t,loading:f}}},function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(4),i=a.n(n),s=a(624),r=a(597);const o=()=>i.a.createElement(s.a,{docPath:r.f,linkText:r.g}),l=()=>i.a.createElement(s.a,{docPath:r.b,linkText:r.c}),c=()=>i.a.createElement(s.a,{docPath:r.d,linkText:r.e})},,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return d}));var n=a(4),i=a.n(n),s=a(24),r=a.n(s);const o="#FAFBFD",l=r.a.div.withConfig({displayName:"BigRing",componentId:"sc-1yoqpxe-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: ${o};\n    text-align: center;\n    line-height: ${e}px;`)),c=r.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1yoqpxe-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: white;\n    display: inline-block;\n    vertical-align: middle;`)),u=({size:e=90,donutWidth:t=20})=>e-t>0?i.a.createElement(l,{size:e,"data-test-subj":"empty-donut"},i.a.createElement(c,{size:e-t,"data-test-subj":"empty-donut-small"})):null,d=i.a.memo(u)},,,,,,,,,function(e,t,a){"use strict";a.d(t,"e",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return f}));var n=a(1),i=a(77),s=a(384),r=a(347);const o=[r.a.flows,r.a.dns,r.a.http,r.a.tls,r.a.events],l=o.join("|"),c=[...o,r.a.anomalies].join("|"),u=`${n.Sb}/:tabName(${c})`,d=`${n.Sb}/:tabName(${l})`,p=[s.a.flows,s.a.http,s.a.tls,s.a.anomalies,s.a.events,s.a.users].join("|"),m=[i.g.source,i.g.destination].join("|"),g=`${n.Sb}/ip/:detailName`,f=`${g}/:flowTarget(${m})/:tabName(${p})`},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"e",(function(){return s})),a.d(t,"i",(function(){return r})),a.d(t,"j",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"f",(function(){return m}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTitle",{defaultMessage:"Installed"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTooltip",{defaultMessage:"Integration is installed. Configure an integration policy and ensure Elastic Agents are assigned this policy to ingest compatible events."}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTitle",{defaultMessage:"Not installed"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTooltip",{defaultMessage:"Integration is not installed. Follow the integration link to install and configure the integration."}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTitle",{defaultMessage:"Installed: enabled"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTooltip",{defaultMessage:"Integration is installed and an integration policy with the required configuration exists. Ensure Elastic Agents are assigned this policy to ingest compatible events."}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.badgeTitle",{defaultMessage:"integrations"}),d=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverTitle",{values:{integrationsCount:e},defaultMessage:"[{integrationsCount}] Related {integrationsCount, plural, =1 {integration} other {integrations}} available"}),p=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescription",{values:{integrationsCount:e},defaultMessage:"Install and configure {integrationsCount, plural, =1 {the below integration} other {one or more of the below integrations}} to ingest the necessary data for this detection rule:"}),m=(e,t)=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescriptionInstalledVersionTooltip",{values:{installedVersion:e,requiredVersion:t},defaultMessage:"Version mismatch -- please resolve! Installed version `{installedVersion}` when required version `{requiredVersion}`"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"d",(function(){return p}));var n=a(53),i=a.n(n),s=a(4),r=a.n(s),o=a(1),l=a(210);const c=[{value:o.Wb,text:"On each rule execution"},{value:"1h",text:"Hourly"},{value:"1d",text:"Daily"},{value:"7d",text:"Weekly"}],u=[{value:o.Vb,text:"Perform no actions"},...c],d=u[0],p=e=>{const{setValue:t}=e.field,a=Object(s.useCallback)((e=>{const a=e.target.value;t(a)}),[t]),n={...e.euiFieldProps,onChange:a};return r.a.createElement(l.d,i()({},e,{euiFieldProps:n}))}},function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return g})),a.d(t,"g",(function(){return f})),a.d(t,"f",(function(){return b})),a.d(t,"e",(function(){return h})),a.d(t,"i",(function(){return y})),a.d(t,"h",(function(){return E}));var n=a(24),i=a.n(n),s=a(17),r=a(178),o=a(4),l=a.n(o),c=a(489);const u=i()(s.EuiHealth).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1mv5h4i-0"})(["line-height:inherit;"]),d=r.euiLightVars.euiColorVis0,p=r.euiLightVars.euiColorVis5,m=r.euiLightVars.euiColorVis7,g=r.euiLightVars.euiColorVis9,f=47,b=73,h=99,y=[{value:"low",inputDisplay:l.a.createElement(u,{color:d},c.i)},{value:"medium",inputDisplay:l.a.createElement(u,{color:p},c.j)},{value:"high",inputDisplay:l.a.createElement(u,{color:m},c.h)},{value:"critical",inputDisplay:l.a.createElement(u,{color:g},c.f)}],E={low:21,medium:f,high:b,critical:h}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(4),i=a(6),s=a(47),r=a(78),o=a(76),l=a(207),c=a(13),u=a(508),d=a(33),p=a(461),m=a(202);const g=()=>{const{indicesExist:e}=Object(l.d)(c.SourcererScopeName.detections),{indexFieldsSearch:t}=Object(p.b)(),a=Object(s.useDispatch)(),{addError:g}=Object(m.a)(),f=Object(n.useRef)(new AbortController),b=Object(n.useMemo)((()=>r.g.defaultDataViewSelector()),[]),h=Object(n.useMemo)((()=>r.g.signalIndexNameSelector()),[]),y=Object(o.a)(h),E=Object(o.a)(b),v=Object(n.useMemo)((()=>!E.title.includes(`${y}`)),[E.title,y]),k=Object(n.useMemo)((()=>!e&&!v),[e,v]),S=Object(n.useCallback)((()=>{null!==y&&(f.current.abort(),(async()=>{f.current=new AbortController;try{const e=await Object(u.b)({body:{patternList:E.title.split(",")},signal:f.current.signal});null!==y&&e.defaultDataView.patternList.includes(y)&&(t({dataViewId:e.defaultDataView.id}),a(d.a.setSourcererDataViews(e)))}catch(e){g(e,{title:i.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:i.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[g,E.title,a,t,y]);return{...k?{pollForSignalIndex:S}:{},signalIndexNeedsInit:v}}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"b",(function(){return k})),a.d(t,"c",(function(){return x})),a.d(t,"d",(function(){return n}));var n={};a.r(n),a.d(n,"STATUS",(function(){return d})),a.d(n,"STATUS_AT",(function(){return p})),a.d(n,"STATUS_DATE",(function(){return m})),a.d(n,"REFRESH",(function(){return g})),a.d(n,"ERROR_CALLOUT_TITLE",(function(){return f})),a.d(n,"PARTIAL_FAILURE_CALLOUT_TITLE",(function(){return b}));var i=a(4),s=a.n(i),r=a(17),o=a(211),l=a(203),c=a(494),u=a(6);const d=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDescription",{defaultMessage:"Last response"}),p=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusAtDescription",{defaultMessage:"at"}),m=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDateDescription",{defaultMessage:"Status date"}),g=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.refreshButton",{defaultMessage:"Refresh"}),f=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.errorCalloutTitle",{defaultMessage:"Rule failure at"}),b=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.partialErrorCalloutTitle",{defaultMessage:"Warning at"}),h=({status:e,date:t,children:a})=>{const n=Object(c.c)(e),i=Object(c.b)(e);return s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiHealth,{color:i},s.a.createElement(r.EuiText,{"data-test-subj":"ruleStatus",size:"xs"},null!=n?n:Object(l.d)()))),null!=t&&null!=e&&s.a.createElement(s.a.Fragment,null,s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(s.a.Fragment,null,p)),s.a.createElement(r.EuiFlexItem,{grow:!0},s.a.createElement(o.a,{value:t,fieldName:m}))),s.a.createElement(r.EuiFlexItem,{grow:!1},a))},y=s.a.memo(h);y.displayName="RuleStatus";var E=a(752);const v=({status:e})=>{const t=Object(c.a)(e),a=Object(c.b)(e);return s.a.createElement(E.a,{tooltipContent:t,healthColor:a,dataTestSubj:"ruleExecutionStatus"},null!=t?t:Object(l.d)())},k=s.a.memo(v);k.displayName="RuleStatusBadge";var S=a(255);const T=({date:e,message:t,status:a})=>{const{shouldBeDisplayed:n,color:i,title:l}=w(a);return n?s.a.createElement(r.EuiCallOut,{title:s.a.createElement(s.a.Fragment,null,l," ",s.a.createElement(o.a,{value:e,fieldName:"execution_summary.last_execution.date"})),color:i,iconType:"alert","data-test-subj":"ruleStatusFailedCallOut"},s.a.createElement("p",null,t)):null},x=s.a.memo(T);x.displayName="RuleStatusFailedCallOut";const w=e=>{switch(e){case S.f.failed:return{shouldBeDisplayed:!0,color:"danger",title:f};case S.f["partial failure"]:return{shouldBeDisplayed:!0,color:"warning",title:b};default:return{shouldBeDisplayed:!1,color:"warning",title:""}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return f})),a.d(t,"c",(function(){return b}));var n=a(5),i=a(262),s=a(19),r=a(250),o=a(20),l=a(177);const c=e=>"parsing_exception"===e||"verification_exception"===e||"mapping_exception"===e,u=e=>Object(n.has)(e,"error.type"),d=e=>e.error.root_cause.filter((e=>c(e.type))).map((e=>e.reason));var p=a(359);let m;!function(e){e.FAILED_REQUEST="ERR_FAILED_REQUEST",e.INVALID_EQL="ERR_INVALID_EQL"}(m||(m={}));const g=(e,t)=>{let a,n=[];return(...i)=>(a&&clearTimeout(a),a=setTimeout((()=>{const t=e(...i);n.forEach((e=>e(t))),n=[]}),t),new Promise((e=>n.push(e))))},f=async(...e)=>{const[{value:t,formData:a}]=e,{query:g}=t,f=g.query,{dataViewId:b,index:h,ruleType:y}=a;if(void 0===y&&!Object(n.isEmpty)(f)||Object(i.b)(y)&&!Object(n.isEmpty)(f))try{const{data:e}=s.b.get();let t=null==h?void 0:h.join(),i={};if(null!=b&&""!==b&&a.dataSourceType===r.a.DataView){const a=await e.dataViews.get(b);t=a.title,i=a.getRuntimeMappings()}const p=(new AbortController).signal,g=await(async({data:e,dataViewTitle:t,query:a,signal:i,runtimeMappings:s})=>{const{rawResponse:r}=await Object(o.firstValueFrom)(e.search.search({params:{index:t,body:{query:a,runtime_mappings:s,size:0}},options:{ignore:[400]}},{strategy:l.EQL_SEARCH_STRATEGY,abortSignal:i}));if((e=>u(e)&&c(Object(n.get)(e,"error.type")))(r.body))return{valid:!1,errors:d(r.body)};if(u(r.body))throw new Error(JSON.stringify(r.body));return{valid:!0,errors:[]}})({data:e,query:f,signal:p,dataViewTitle:t,runtimeMappings:i});if(!1===(null==g?void 0:g.valid))return{code:m.INVALID_EQL,message:"",messages:g.errors}}catch(e){return{code:m.FAILED_REQUEST,message:p.m,error:e}}},b=e=>{const t=e.errors.length>0,a=!e.isChangingValue&&!t;if(t){const[t]=e.errors,n=t.message;return t.code===m.INVALID_EQL?{isValid:a,message:n,messages:t.messages}:{isValid:a,message:n,error:t.error}}return{isValid:a,message:""}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(4),i=a.n(n),s=a(863),r=a.n(s),o=a(420),l=a(17),c=a(6),u=a(175),d=a(1);const p=({values:e})=>i.a.createElement(i.a.Fragment,null,e.map(((t,a)=>i.a.createElement(i.a.Fragment,{key:a},i.a.createElement(l.EuiCode,null,t),a<e.length-1?", ":""))));var m=a(503);const g=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageTitle",{defaultMessage:"Insufficient privileges"}),f=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditRules",{defaultMessage:"Without that privilege you cannot create or edit detection engine rules."}),b=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditLists",{defaultMessage:"Without these privileges, you cannot create or edit value lists."}),h=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditAlerts",{defaultMessage:"Without these privileges, you cannot view or change status of alerts."}),y=({indexPrivileges:e,featurePrivileges:t=[]})=>i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.messageDetail",defaultMessage:"{essence} {indexPrivileges} {featurePrivileges} Related documentation: {docs}",values:{essence:i.a.createElement("p",null,i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.essenceDescription",defaultMessage:"You need the following privileges to fully access this functionality. Contact your administrator for further assistance."})),indexPrivileges:e.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.indexPrivilegesTitle",defaultMessage:"Missing Elasticsearch index privileges:"}),i.a.createElement("ul",null,e.map((([e,t])=>i.a.createElement("li",{key:e},k(e,t)))))):null,featurePrivileges:t.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.featurePrivilegesTitle",defaultMessage:"Missing Kibana feature privileges:"}),i.a.createElement("ul",null,t.map((([e,t])=>i.a.createElement("li",{key:e},S(e,t)))))):null,docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(m.a,null)),i.a.createElement("li",null,i.a.createElement(m.c,null)))}}),E={[d.qc]:{all:f},[d.cb]:{write:h},[d.W]:{write:b},[d.V]:{write:b}},v=(e,t)=>{var a;const n=null===(a=Object.entries(E).find((([e])=>t.startsWith(e))))||void 0===a?void 0:a[1];return e.map((e=>null==n?void 0:n[e])).filter(Boolean).join(" ")},k=(e,t)=>i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingIndexPrivileges",defaultMessage:"Missing {privileges} privileges for the {index} index. {explanation}",values:{privileges:i.a.createElement(p,{values:t}),index:i.a.createElement(l.EuiCode,null,e),explanation:v(t,e)}}),S=(e,t)=>i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingFeaturePrivileges",defaultMessage:"Missing {privileges} privileges for the {index} feature. {explanation}",values:{privileges:i.a.createElement(p,{values:t}),index:i.a.createElement(l.EuiCode,null,e),explanation:v(t,e)}});var T=a(277),x=a(235);const w=["read","write","view_index_metadata","maintenance"],O=e=>{const t=(e=>{const[t]=Object.keys(e);return t})(e),a=e[t],n=w.filter((e=>!a[e]));if(n.length)return[t,n]},j=()=>{const e=(()=>{const{detectionEnginePrivileges:e,listPrivileges:t}=Object(x.a)(),[{canUserCRUD:a}]=Object(T.b)();return Object(n.useMemo)((()=>{const n=[],i=[];if(null==a||null==t.result||null==e.result)return{featurePrivileges:n,indexPrivileges:i};!1===a&&n.push([d.qc,["all"]]);const s=O(t.result.listItems.index);s&&i.push(s);const r=O(t.result.lists.index);r&&i.push(r);const o=O(e.result.index);return o&&i.push(o),{featurePrivileges:n,indexPrivileges:i}}),[a,t,e])})(),t=Object(n.useMemo)((()=>e.indexPrivileges.length>0||e.featurePrivileges.length>0?{type:"primary",id:`missing-user-privileges-${r()(e)}`,title:g,description:y(e)}:null),[e]);return t&&i.a.createElement(o.c,{namespace:"detections",condition:!0,message:t})},I=Object(n.memo)(j)},function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return p}));const n=a(6).i18n.translate("xpack.securitySolution.components.ml.api.errors.statusCodeFailureTitle",{defaultMessage:"Status Code:"});var i=a(51),s=a(3);const r=e=>{try{return JSON.stringify(JSON.parse(e),null,2)}catch(t){return e}};var o=a(19);const l=async({indexPatternName:e,signal:t})=>o.b.get().http.fetch(`/api/ml/modules/recognize/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),c=async({moduleId:e="",signal:t})=>o.b.get().http.fetch(`/api/ml/modules/get_module/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),u=async({configTemplate:e,indexPatternName:t="auditbeat-*",jobIdErrorFilter:a=[],groups:s=["security"],prefix:l=""})=>{const c=await o.b.get().http.fetch(`/api/ml/modules/setup/${e}`,{method:"POST",body:JSON.stringify({prefix:l,groups:s,indexPatternName:t,startDatafeed:!1,useDedicatedIndex:!0,applyToAllSpaces:!0}),asSystemRequest:!0});return((e,t=[])=>{const a=[...e.jobs.reduce(((e,a)=>null!=a.error&&t.includes(a.id)?[...e,a.error.msg,r(a.error.response),`${n} ${a.error.statusCode}`]:e),[]),...e.datafeeds.reduce(((e,a)=>null!=a.error&&t.includes(a.id.substr("datafeed-".length))?[...e,a.error.msg,r(a.error.response),`${n} ${a.error.statusCode}`]:e),[])];if(a.length>0)throw new i.c(a)})(c,a),c},d=async({datafeedIds:e,start:t=0})=>{const a=await o.b.get().http.fetch("/api/ml/jobs/force_start_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e,...0!==t&&{start:t}}),asSystemRequest:!0});return((e,t)=>{const a=t.reduce(((t,a)=>{const i=e[a];return o=i,Object(s.has)("error.msg",o)&&Object(s.has)("error.response",o)&&Object(s.has)("error.statusCode",o)?[...t,i.error.msg,r(i.error.response),`${n} ${i.error.statusCode}`]:t;var o}),[]);if(a.length>0)throw new i.c(a)})(a,e),a},p=async({datafeedIds:e})=>{const t=await o.b.get().http.fetch("/api/ml/jobs/stop_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e}),asSystemRequest:!0}),a="datafeed-";return[t,await o.b.get().http.fetch("/api/ml/jobs/close_jobs",{method:"POST",body:JSON.stringify({jobIds:e.map((e=>e.startsWith(a)?e.substring(a.length):e))}),asSystemRequest:!0})]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return P}));var n=a(17),i=a(4),s=a.n(i),r=a(24),o=a.n(r),l=a(634),c=a(1),u=a(216),d=a(322),p=a(227),m=a(213),g=a(289),f=a(290),b=a(221),h=a(336);const y={critical:h.D,high:h.E,medium:h.H,low:h.G},E=({additionalFilters:e=[],from:t,to:a,entityFilter:n})=>({size:0,query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:a}}},...n?[{term:{[n.field]:n.value}}]:[]]}},aggs:{alertsByStatus:{terms:{field:"kibana.alert.workflow_status"},aggs:{statusBySeverity:{terms:{field:"kibana.alert.severity"}}}}}});var v=a(208),k=a(335),S=a(437),T=a(297),x=a(641),w=a(698),O=a(512),j=a(313),I=a(204),C=a(438);const M=o()(n.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-3zhuyw-0"})(["padding:0 4px;"]),D=o()(n.EuiFlexItem).withConfig({displayName:"StyledLegendFlexItem",componentId:"sc-3zhuyw-1"})(["padding-left:32px;padding-top:45px;"]),A=[{key:"critical",label:h.D,color:S.b.critical},{key:"high",label:h.E,color:S.b.high},{key:"medium",label:h.H,color:S.b.medium},{key:"low",label:h.G,color:S.b.low}],F="detection-response-alerts-by-status",R={field:"event.kind",value:"signal"},P=({additionalFilters:e,signalIndexName:t,entityFilter:a})=>{var r,o,S,P,_,q,N,L,B;const{toggleStatus:z,setToggleStatus:H}=Object(v.a)(F),{openTimelineWithFilters:$}=Object(C.a)(),{onClick:V,href:U}=Object(I.o)()({deepLinkId:c.uc.alerts}),Q=Object(n.useIsWithinMinBreakpoint)("xl"),W=Object(n.useIsWithinMaxBreakpoint)("s")||Q?120:90,G=Object(i.useMemo)((()=>({name:a?h.o:k.k,href:a?void 0:U,onClick:a?()=>$([[a,R]]):V})),[a,U,V,$]),{items:K,isLoading:J,updatedAt:Y}=(({additionalFilters:e,entityFilter:t,queryId:a,signalIndexName:n,skip:s=!1})=>{const{to:r,from:o,deleteQuery:l,setQuery:c}=Object(m.a)(),[u,d]=Object(i.useState)(Date.now()),[p,h]=Object(i.useState)(null),{data:v,loading:k,refetch:S,request:T,response:x,setQuery:w}=Object(g.a)({query:E({from:o,to:r,entityFilter:t,additionalFilters:e}),indexName:n,skip:s,queryName:f.a.BY_STATUS});Object(i.useEffect)((()=>{w(E({from:o,to:r,entityFilter:t,additionalFilters:e}))}),[w,o,r,t,e]),Object(i.useEffect)((()=>{h(null==v?null:(e=>{var t,a,n;const i=null!==(t=null==e||null===(a=e.aggregations)||void 0===a||null===(n=a.alertsByStatus)||void 0===n?void 0:n.buckets)&&void 0!==t?t:[];return 0===i.length?null:i.reduce(((e,t)=>{var a,n;const i=null!==(a=null===(n=t.statusBySeverity)||void 0===n?void 0:n.buckets)&&void 0!==a?a:[];return{...e,[t.key]:{total:t.doc_count,severities:i.map((e=>({key:e.key,value:e.doc_count,label:y[e.key]})))}}}),{})})(v)),d(Date.now())}),[v]);const O=Object(i.useCallback)((()=>{!s&&S&&S()}),[s,S]);return Object(b.b)({deleteQuery:l,inspect:{dsl:[T],response:[x]},refetch:O,setQuery:c,queryId:a,loading:k}),{items:p,isLoading:k,updatedAt:u}})({additionalFilters:e,entityFilter:a,signalIndexName:t,skip:!z,queryId:F}),X=Object(i.useMemo)((()=>A.map((e=>({color:e.color,field:"kibana.alert.severity",value:e.label})))),[]),Z=null!==(r=null==K||null===(o=K.open)||void 0===o?void 0:o.total)&&void 0!==r?r:0,ee=null!==(S=null==K||null===(P=K.acknowledged)||void 0===P?void 0:P.total)&&void 0!==S?S:0,te=null!==(_=null==K||null===(q=K.closed)||void 0===q?void 0:q.total)&&void 0!==_?_:0,ae=J||null==K?0:Z+ee+te,ne=Object(i.useCallback)((e=>{var t,a;return null!==(t=null===(a=A.find((t=>t.label===e.dataName)))||void 0===a?void 0:a.color)&&void 0!==t?t:O.b}),[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.a,{show:!0,targetClassNames:[p.a]},s.a.createElement(n.EuiPanel,{hasBorder:!0,"data-test-subj":"detection-response-alerts-by-status-panel"},J&&s.a.createElement(n.EuiProgress,{"data-test-subj":"initialLoadingPanelMatrixOverTime",size:"xs",position:"absolute",color:"accent"}),s.a.createElement(u.a,{id:F,title:a?h.b:h.c,titleSize:"m",subtitle:s.a.createElement(j.a,{isUpdating:J,updatedAt:Y}),inspectMultiple:!0,toggleStatus:z,toggleQuery:H},s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(I.g,{"data-test-subj":"view-details-button",onClick:G.onClick,href:G.href},G.name)))),z&&s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},s.a.createElement(n.EuiFlexItem,{grow:!1},0!==ae&&s.a.createElement(n.EuiText,{className:"eui-textCenter",size:"s"},s.a.createElement(s.a.Fragment,null,s.a.createElement("b",null,s.a.createElement(T.a,{count:ae})),s.a.createElement(s.a.Fragment,null," "),s.a.createElement("small",null,Object(h.a)(ae)))),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(n.EuiFlexGroup,{justifyContent:"center"},s.a.createElement(M,{key:"alerts-status-open",grow:!1},s.a.createElement(l.a,{data:null==K||null===(N=K.open)||void 0===N?void 0:N.severities,fillColor:ne,height:W,label:h.I,title:s.a.createElement(x.a,{count:Z}),totalCount:Z})),s.a.createElement(M,{key:"alerts-status-acknowledged",grow:!1},s.a.createElement(l.a,{data:null==K||null===(L=K.acknowledged)||void 0===L?void 0:L.severities,fillColor:ne,height:W,label:h.B,title:s.a.createElement(x.a,{count:ee}),totalCount:ee})),s.a.createElement(M,{key:"alerts-status-closed",grow:!1},s.a.createElement(l.a,{data:null==K||null===(B=K.closed)||void 0===B?void 0:B.severities,fillColor:ne,height:W,label:h.C,title:s.a.createElement(x.a,{count:te}),totalCount:te})))),s.a.createElement(D,{grow:!1},X.length>0&&s.a.createElement(w.a,{legendItems:X}))),s.a.createElement(n.EuiSpacer,{size:"m"})))))}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(4),i=a.n(n),s=a(47),r=a(24),o=a.n(r),l=a(8),c=a(19),u=a(259),d=a(82),p=a(15),m=a(1),g=a(91),f=a(227),b=a(96),h=a(238),y=a(646),E=a(207),v=a(647),k=a(688),S=a(614),T=a(527),x=a(618);const w=[],O=o.a.div.withConfig({displayName:"FullScreenContainer",componentId:"sc-z1fvak-0"})(["height:",";flex:1 1 auto;display:flex;width:100%;"],(({$isFullScreen:e})=>e?"100%":void 0)),j=({defaultCellActions:e,defaultModel:t,end:a,entityType:r,id:o,leadingControlColumns:j,pageFilters:I,currentFilter:C,onRuleChange:M,renderCellValue:D,rowRenderers:A,start:F,scopeId:R,additionalFilters:P,hasAlertsCrud:_=!1,unit:q})=>{const N=Object(s.useDispatch)(),{filters:L,input:B,query:z,globalQueries:H,timelineQuery:$,timeline:{columns:V,dataProviders:U,defaultColumns:Q,deletedEventIds:W,excludedRowRendererIds:G,graphEventId:K,itemsPerPage:J,itemsPerPageOptions:Y,kqlMode:X,sessionViewConfig:Z,showCheckboxes:ee,sort:te}=t}=Object(s.useSelector)((e=>Object(y.a)(e,o))),{timelines:ae}=Object(c.k)().services,{browserFields:ne,dataViewId:ie,indexPattern:se,runtimeMappings:re,selectedPatterns:oe,dataViewId:le,loading:ce}=Object(E.d)(R),{globalFullScreen:ue}=Object(b.a)(),de=Object(h.a)("tGridEventRenderedViewEnabled"),pe=Object(n.useRef)(null);Object(n.useEffect)((()=>(N(g.a.createTimeline({columns:V,dataViewId:le,defaultColumns:Q,excludedRowRendererIds:G,id:o,indexNames:oe,itemsPerPage:J,showCheckboxes:ee,sort:te})),()=>{N(d.b.deleteOneQuery({id:o,inputId:l.a.global})),pe.current&&pe.current.closeEditor()})),[]);const me=Object(n.useMemo)((()=>[...L,...null!=I?I:[]]),[L,I]),ge=w,{Navigation:fe}=Object(x.b)({timelineId:o}),{DetailsPanel:be,SessionView:he}=Object(x.a)({entityType:r,timelineId:o}),ye=Object(n.useMemo)((()=>null!=K&&K.length>0||null!=Z?i.a.createElement(k.a,{timelineId:o,SessionView:he,Navigation:fe}):null),[K,o,Z,he,fe]),Ee=Object(n.useCallback)(((e,t,a)=>{N(d.b.setQuery({id:o,inputId:l.a.global,inspect:e,loading:t,refetch:a}))}),[N,o]),ve=e=>{e.forEach((e=>e.refetch&&e.refetch()))},ke=(({onClose:e,onSuccess:t}={})=>{const{cases:a}=Object(c.k)().services,i=Object(c.i)(),s=a.hooks.getUseCasesAddToNewCaseFlyout({onClose:e,onSuccess:t}),r=a.hooks.getUseCasesAddToExistingCaseModal({onClose:e,onRowClick:t});return Object(n.useMemo)((()=>i.create&&i.read?[{label:u.j,key:"attach-new-case","data-test-subj":"attach-new-case",disableOnQuery:!0,disabledLabel:u.h,onClick:e=>{const t=e?a.helpers.groupAlertsByRule(e):[];s.open({attachments:t})}},{label:u.i,key:"attach-existing-case",disableOnQuery:!0,disabledLabel:u.h,"data-test-subj":"attach-existing-case",onClick:e=>{const t=e?a.helpers.groupAlertsByRule(e):[];r.open({attachments:t})}}]:[]),[a.helpers,s,i.create,i.read,r])})(),Se=Object(n.useMemo)((()=>({onAlertStatusActionSuccess:()=>{o===p.i.active?ve([$]):ve(H)},customBulkActions:ke})),[ke,H,o,$]),Te=Object(S.a)({sourcererScope:R,timelineId:o,editorActionsRef:pe}),xe="interval"===B.policy.kind;return i.a.createElement(i.a.Fragment,null,i.a.createElement(O,{$isFullScreen:ue},i.a.createElement(f.c,null,ae.getTGrid({additionalFilters:P,appId:m.A,browserFields:ne,bulkActions:Se,columns:V,dataProviders:U,dataViewId:ie,defaultCellActions:e,deletedEventIds:W,disabledCellActions:v.a,end:a,entityType:r,fieldBrowserOptions:Te,filters:me,filterStatus:C,getRowRenderer:T.a,globalFullScreen:ue,graphEventId:K,graphOverlay:ye,hasAlertsCrud:_,id:o,indexNames:oe,indexPattern:se,isLive:xe,isLoadingIndexPattern:ce,itemsPerPage:J,itemsPerPageOptions:Y,kqlMode:X,leadingControlColumns:j,onRuleChange:M,query:z,renderCellValue:D,rowRenderers:A,runtimeMappings:re,setQuery:Ee,sort:te,start:F,tGridEventRenderedViewEnabled:de,trailingControlColumns:ge,type:"embedded",unit:q}))),be)},I=i.a.memo(j)},function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(53),i=a.n(n),s=a(17),r=a(3),o=a(4),l=a.n(o),c=a(24),u=a.n(c),d=a(210),p=a(6);const m=[{value:"s",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.secondsOptionDescription",{defaultMessage:"Seconds"})},{value:"m",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.minutesOptionDescription",{defaultMessage:"Minutes"})},{value:"h",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.hoursOptionDescription",{defaultMessage:"Hours"})},{value:"d",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.daysOptionDescription",{defaultMessage:"Days"})}],g=u()(s.EuiFlexItem).withConfig({displayName:"StyledLabelAppend",componentId:"sc-d3i8n6-0"})(["&.euiFlexItem.euiFlexItem--flexGrowZero{margin-left:31px;}"]),f=u()(s.EuiFormRow).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-d3i8n6-1"})(["max-width:none;.euiFormControlLayout{max-width:auto;width:auto;}.euiFormControlLayout__childrenWrapper > *:first-child{box-shadow:none;height:38px;width:100%;}.euiFormControlLayout__childrenWrapper > select{background-color:",";color:",";}.euiFormControlLayout--group .euiFormControlLayout{min-width:100px;}.euiFormControlLayoutIcons{color:",";}.euiFormControlLayout:not(:first-child){border-left:1px solid ",";}"],(({theme:e})=>Object(s.transparentize)(e.eui.euiColorPrimary,.1)),(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorLightShade)),b=u()(s.EuiSelect).withConfig({displayName:"MyEuiSelect",componentId:"sc-d3i8n6-2"})(["width:auto;"]),h=({dataTestSubj:e,field:t,idAria:a,isDisabled:n,minimumValue:c=0,timeTypes:u=["s","m","h"],fullWidth:p=!1})=>{const[h,y]=Object(o.useState)(u[0]),[E,v]=Object(o.useState)(0),{isInvalid:k,errorMessage:S}=Object(d.i)(t),{value:T,setValue:x}=t,w=Object(o.useCallback)((e=>{y(e.target.value),x(`${E}${e.target.value}`)}),[x,E]),O=Object(o.useCallback)((e=>{const t=((e,t=0)=>{const a=parseInt(e,10);return Number.isNaN(a)?t:Math.max(t,Math.min(a,Number.MAX_SAFE_INTEGER))})(e.target.value,c);v(t),x(`${t}${h}`)}),[c,x,h]);Object(o.useEffect)((()=>{if(T!==`${E}${h}`){const e=T.match(/\d+/g),t=T.match(/[a-zA-Z]+/g);Object(r.isEmpty)(e)||null==e||isNaN(Number(e[0]))||Number(e[0])===Number(E)||v(Number(e[0])),!Object(r.isEmpty)(t)&&null!=t&&u.includes(t[0])&&t[0]!==h&&y(t[0])}}),[h,u,E,T]);const j={disabled:n},I=Object(o.useMemo)((()=>l.a.createElement(s.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexStart",alignItems:"center"},l.a.createElement(s.EuiFlexItem,{grow:!1,component:"span"},t.label),l.a.createElement(g,{grow:!1,component:"span"},t.labelAppend))),[t.label,t.labelAppend]);return l.a.createElement(f,{label:I,helpText:t.helpText,error:S,isInvalid:k,fullWidth:p,"data-test-subj":e,describedByIds:a?[a]:void 0},l.a.createElement(s.EuiFormControlLayout,{append:l.a.createElement(b,i()({fullWidth:!1,options:m.filter((e=>u.includes(e.value))),onChange:w,value:h,"data-test-subj":"timeType"},j))},l.a.createElement(s.EuiFieldNumber,i()({fullWidth:!0,min:c,max:Number.MAX_SAFE_INTEGER,onChange:O,value:E,"data-test-subj":"interval"},j))))}},,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return r}));var n=a(4),i=a(58);const s=()=>{const e=Object(i.h)();return Object(n.useMemo)((()=>o(e)),[e])},r=e=>s().find((({id:t})=>t===e)),o=e=>e.map((e=>({id:e.id,title:e.title,...null!=e.categories?{categories:e.categories}:{},...null!=e.description?{description:e.description}:{},...!0===e.sideNavDisabled?{disabled:!0}:{},...null!=e.landingIcon?{icon:e.landingIcon}:{},...null!=e.landingImage?{image:e.landingImage}:{},...null!=e.skipUrlState?{skipUrlState:e.skipUrlState}:{},...null!=e.isBeta?{isBeta:e.isBeta}:{},...null!=e.betaOptions?{betaOptions:e.betaOptions}:{},...e.links&&e.links.length?{links:o(e.links)}:{}})))},,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(3),i=a(272),s=a(232),r=a(368),o=a(465),l=a(9);const c=i.b.HostsType.details,u={[s.HostsTableType.hosts]:o.b,[s.HostsTableType.authentications]:o.d,[s.HostsTableType.uncommonProcesses]:o.h,[s.HostsTableType.anomalies]:o.c,[s.HostsTableType.events]:o.e,[s.HostsTableType.risk]:o.f,[s.HostsTableType.sessions]:o.g},d=(e,t)=>{let a=[];if(null!=e.detailName&&(a=[...a,{text:e.detailName,href:t({path:Object(r.a)(e.detailName,""),deepLinkId:l.a.hosts})}]),null!=e.tabName){const t=Object(n.get)("tabName",e);if(!t)return a;a=[...a,{text:u[t],href:""}]}return a}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(77);const i=(e,t)=>t===n.g.source?[{fieldName:"source.ip",fieldValue:e}]:t===n.g.destination?[{fieldName:"destination.ip",fieldValue:e}]:[]},function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(178),i=a(4),s=a.n(i),r=a(1),o=a(19),l=a(203),c=a(337),u=a(499),d=a(460),p=a(98),m=a(249),g=a(498),f=a(224),b=a(254),h=a(227),y=a(388);const E=s.a.memo((({contextID:e,id:t,ip:a,data:i,isDraggable:E=!1,isInDetailsSidePanel:v=!1,loading:k,flowTarget:S,startDate:T,endDate:x,isLoadingAnomaliesData:w,anomaliesData:O,narrowDateRange:j,indexPatterns:I})=>{const C=Object(f.a)(),M=Object(b.a)(C),[D]=Object(o.q)(r.M),A=i[S],F=[{title:d.i,description:Object(c.g)([`${S}.geo.city_name`,`${S}.geo.region_name`],i,e,E)},{title:d.c,description:A?Object(c.d)(A.autonomousSystem,S,e,E):Object(l.d)()}],R=[M?[...F,{title:d.j,description:s.a.createElement(g.a,{anomalies:O,startDate:T,endDate:x,isLoading:w,narrowDateRange:j})}]:F,[{title:d.d,description:s.a.createElement(u.a,{indexPatterns:I,field:`${S}.ip`,value:a,type:u.b.FIRST_SEEN})},{title:d.h,description:s.a.createElement(u.a,{indexPatterns:I,field:`${S}.ip`,value:a,type:u.b.LAST_SEEN})}],[{title:d.e,description:A&&i.host?Object(c.e)({host:i.host,isDraggable:E,ipFilter:a,contextID:e}):Object(l.d)()},{title:d.f,description:A&&i.host?Object(c.f)(i.host,a,e,E):Object(l.d)()}],[{title:d.o,description:Object(c.i)(a)},{title:d.k,description:Object(c.h)(a)}]];return s.a.createElement(h.c,null,s.a.createElement(p.g,{direction:v?"column":"row"},!v&&s.a.createElement(h.b,{queryId:t,title:d.g,inspectIndex:0}),R.map(((e,t)=>s.a.createElement(y.a,{descriptionList:e,key:t}))),k&&s.a.createElement(m.a,{overlay:!0,overlayBackground:D?n.euiDarkVars.euiPageBackgroundColor:n.euiLightVars.euiPageBackgroundColor,size:"xl"})))}));E.displayName="IpOverview"},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(4),i=a.n(n),s=a(256),r=a(35),o=a(265),l=a(98),c=a(551);const u=({id:e,index:t=0,score:a})=>{const u=Object(c.a)(a.severity),d=Object(n.useMemo)((()=>({and:[],enabled:!0,id:e,name:a.entityName,excluded:!1,kqlQuery:"",queryMatch:{field:a.entityName,value:a.entityValue,operator:r.c}})),[e,a.entityName,a.entityValue]),p=Object(n.useCallback)(((e,a,n)=>n.isDragging?i.a.createElement(s.a,null,i.a.createElement(o.a,{dataProvider:e})):i.a.createElement(i.a.Fragment,null,0!==t&&i.a.createElement(i.a.Fragment,null,",",i.a.createElement(l.i,null)),u)),[t,u]);return i.a.createElement(s.b,{key:`draggable-score-draggable-wrapper-${e}`,dataProvider:d,render:p,isAggregatable:!0,fieldType:"keyword"})};u.displayName="DraggableScoreComponent";const d=i.a.memo(u);d.displayName="DraggableScore"},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a.n(n),s=a(17);const r=e=>String(Math.ceil(e));i.a.memo((({score:e})=>{const t=r(e),a=o(e);return i.a.createElement(s.EuiHealth,{color:a},t)})).displayName="ScoreHealth";const o=e=>e>=75?"#fe5050":e>=50?"#fba740":e>=25?"#fdec25":e>=3?"#8bc8fb":e>=0?"#d2e9f7":"#ffffff"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),s=a(17),r=a(186),o=a(19);const l=({score:e,startDate:t,endDate:a,linkName:n})=>{const{services:{ml:l,http:c}}=Object(o.k)(),u=Object(r.useMlHref)(l,c.basePath.get(),{page:"explorer",pageState:{jobIds:[e.jobId],timeRange:{from:new Date(t).toISOString(),to:new Date(a).toISOString(),mode:"absolute"},refreshInterval:{pause:!0,value:0,display:"Off"}}});return u?i.a.createElement(s.EuiLink,{href:u,target:"_blank"},n):null}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(24),i=a.n(n),s=a(17);const r=i()(s.EuiInMemoryTable).withConfig({displayName:"BasicTable",componentId:"sc-1c8nyx9-0"})(["tbody{th,td{vertical-align:top;}.euiTableCellContent{display:block;}}"]);r.displayName="BasicTable"},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a.n(n),s=a(17);const r=({selectedJobIds:e,onSelect:t,title:a,jobIds:r})=>{const[o,l]=Object(n.useState)(!1),c=Object(n.useCallback)((()=>{l(!o)}),[o]),u=Object(n.useCallback)((()=>{l(!1)}),[]),d=Object(n.useCallback)((a=>{const n=null!=e?e:[],i=n.includes(a)?n.filter((e=>e!==a)):[...n,a];t(i)}),[e,t]),p=Object(n.useMemo)((()=>i.a.createElement(s.EuiFilterButton,{disabled:0===r.length,"data-test-subj":"job-id-filter-button",hasActiveFilters:e.length>0,iconType:"arrowDown",isSelected:o,numActiveFilters:e.length,onClick:c,contentProps:{style:{minWidth:112}}},a)),[o,c,a,e.length,r]);return i.a.createElement(s.EuiFilterGroup,null,i.a.createElement(s.EuiPopover,{button:p,isOpen:o,closePopover:u,panelPaddingSize:"none"},i.a.createElement("div",{className:"euiFilterSelect__items"},r.map((t=>i.a.createElement(s.EuiFilterSelectItem,{"data-test-subj":`job-id-filter-item-${t}`,checked:e.includes(t)?"on":void 0,key:t,onClick:()=>d(t)},t))))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),s=a(17),r=a(324);const o=[{value:"auto",text:r.g},{value:"hour",text:r.i},{value:"day",text:r.h},{value:"second",text:r.j}],l=({interval:e,onChange:t})=>{const a=Object(n.useCallback)((e=>{t(e.target.value)}),[t]);return i.a.createElement(s.EuiSelect,{"data-test-subj":"selectInterval",prepend:r.f,append:i.a.createElement(s.EuiToolTip,{content:r.k},i.a.createElement(s.EuiIcon,{type:"questionInCircle",color:"subdued"})),options:o,value:e,onChange:a})}},function(e,t,a){"use strict";var n=a(57).compose;t.__esModule=!0,t.composeWithDevTools=function(){if(0!==arguments.length)return"object"==typeof arguments[0]?n:n.apply(null,arguments)},t.devToolsEnhancer=function(){return function(e){return e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.easing={linear:function(e){return e},quadratic:function(e){return e*(-e*e*e+4*e*e-6*e+4)},cubic:function(e){return e*(4*e*e-9*e+6)},elastic:function(e){return e*(33*e*e*e*e-106*e*e*e+126*e*e-67*e+15)},inQuad:function(e){return e*e},outQuad:function(e){return e*(2-e)},inOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},inCubic:function(e){return e*e*e},outCubic:function(e){return--e*e*e+1},inOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},inQuart:function(e){return e*e*e*e},outQuart:function(e){return 1- --e*e*e*e},inOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},inQuint:function(e){return e*e*e*e*e},outQuint:function(e){return 1+--e*e*e*e*e},inOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},inSine:function(e){return 1-Math.cos(e*(Math.PI/2))},outSine:function(e){return Math.sin(e*(Math.PI/2))},inOutSine:function(e){return-(Math.cos(Math.PI*e)-1)/2},inExpo:function(e){return Math.pow(2,10*(e-1))},outExpo:function(e){return 1-Math.pow(2,-10*e)},inOutExpo:function(e){return(e/=.5)<1?Math.pow(2,10*(e-1))/2:(e--,(2-Math.pow(2,-10*e))/2)},inCirc:function(e){return 1-Math.sqrt(1-e*e)},outCirc:function(e){return Math.sqrt(1-(e-=1)*e)},inOutCirc:function(e){return(e/=.5)<1?-(Math.sqrt(1-e*e)-1)/2:(e-=2,(Math.sqrt(1-e*e)+1)/2)}}},function(e,t,a){e.exports=function(){"use strict";function e(e,n,i,s,r){!function e(a,n,i,s,r){for(;s>i;){if(s-i>600){var o=s-i+1,l=n-i+1,c=Math.log(o),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(o-u)/o)*(l-o/2<0?-1:1);e(a,n,Math.max(i,Math.floor(n-l*u/o+d)),Math.min(s,Math.floor(n+(o-l)*u/o+d)),r)}var p=a[n],m=i,g=s;for(t(a,i,n),r(a[s],p)>0&&t(a,i,s);m<g;){for(t(a,m,g),m++,g--;r(a[m],p)<0;)m++;for(;r(a[g],p)>0;)g--}0===r(a[i],p)?t(a,i,g):t(a,++g,s),g<=n&&(i=g+1),n<=g&&(s=g-1)}}(e,n,i||0,s||e.length-1,r||a)}function t(e,t,a){var n=e[t];e[t]=e[a],e[a]=n}function a(e,t){return e<t?-1:e>t?1:0}var n=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(e,t,a){if(!a)return t.indexOf(e);for(var n=0;n<t.length;n++)if(a(e,t[n]))return n;return-1}function s(e,t){r(e,0,e.children.length,t,e)}function r(e,t,a,n,i){i||(i=g(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var s=t;s<a;s++){var r=e.children[s];o(i,e.leaf?n(r):r)}return i}function o(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function l(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function d(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function m(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function g(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function f(t,a,n,i,s){for(var r=[a,n];r.length;)if(!((n=r.pop())-(a=r.pop())<=i)){var o=a+Math.ceil((n-a)/i/2)*i;e(t,o,a,n,s),r.push(a,o,o,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(e){var t=this.data,a=[];if(!m(e,t))return a;for(var n=this.toBBox,i=[];t;){for(var s=0;s<t.children.length;s++){var r=t.children[s],o=t.leaf?n(r):r;m(e,o)&&(t.leaf?a.push(r):p(e,o)?this._all(r,a):i.push(r))}t=i.pop()}return a},n.prototype.collides=function(e){var t=this.data;if(!m(e,t))return!1;for(var a=[];t;){for(var n=0;n<t.children.length;n++){var i=t.children[n],s=t.leaf?this.toBBox(i):i;if(m(e,s)){if(t.leaf||p(e,s))return!0;a.push(i)}}t=a.pop()}return!1},n.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var a=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===a.height)this._splitRoot(this.data,a);else{if(this.data.height<a.height){var n=this.data;this.data=a,a=n}this._insert(a,this.data.height-a.height-1,!0)}else this.data=a;return this},n.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},n.prototype.clear=function(){return this.data=g([]),this},n.prototype.remove=function(e,t){if(!e)return this;for(var a,n,s,r=this.data,o=this.toBBox(e),l=[],c=[];r||l.length;){if(r||(r=l.pop(),n=l[l.length-1],a=c.pop(),s=!0),r.leaf){var u=i(e,r.children,t);if(-1!==u)return r.children.splice(u,1),l.push(r),this._condense(l),this}s||r.leaf||!p(r,o)?n?(a++,r=n.children[a],s=!1):r=null:(l.push(r),c.push(a),a=0,n=r,r=r.children[0])}return this},n.prototype.toBBox=function(e){return e},n.prototype.compareMinX=function(e,t){return e.minX-t.minX},n.prototype.compareMinY=function(e,t){return e.minY-t.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(e){return this.data=e,this},n.prototype._all=function(e,t){for(var a=[];e;)e.leaf?t.push.apply(t,e.children):a.push.apply(a,e.children),e=a.pop();return t},n.prototype._build=function(e,t,a,n){var i,r=a-t+1,o=this._maxEntries;if(r<=o)return s(i=g(e.slice(t,a+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,n-1))),(i=g([])).leaf=!1,i.height=n;var l=Math.ceil(r/o),c=l*Math.ceil(Math.sqrt(o));f(e,t,a,c,this.compareMinX);for(var u=t;u<=a;u+=c){var d=Math.min(u+c-1,a);f(e,u,d,l,this.compareMinY);for(var p=u;p<=d;p+=l){var m=Math.min(p+l-1,d);i.children.push(this._build(e,p,m,n-1))}}return s(i,this.toBBox),i},n.prototype._chooseSubtree=function(e,t,a,n){for(;n.push(t),!t.leaf&&n.length-1!==a;){for(var i=1/0,s=1/0,r=void 0,o=0;o<t.children.length;o++){var l=t.children[o],c=u(l),d=(p=e,m=l,(Math.max(m.maxX,p.maxX)-Math.min(m.minX,p.minX))*(Math.max(m.maxY,p.maxY)-Math.min(m.minY,p.minY))-c);d<s?(s=d,i=c<i?c:i,r=l):d===s&&c<i&&(i=c,r=l)}t=r||t.children[0]}var p,m;return t},n.prototype._insert=function(e,t,a){var n=a?e:this.toBBox(e),i=[],s=this._chooseSubtree(n,this.data,t,i);for(s.children.push(e),o(s,n);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(n,i,t)},n.prototype._split=function(e,t){var a=e[t],n=a.children.length,i=this._minEntries;this._chooseSplitAxis(a,i,n);var r=this._chooseSplitIndex(a,i,n),o=g(a.children.splice(r,a.children.length-r));o.height=a.height,o.leaf=a.leaf,s(a,this.toBBox),s(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(a,o)},n.prototype._splitRoot=function(e,t){this.data=g([e,t]),this.data.height=e.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(e,t,a){for(var n,i,s,o,l,c,d,p=1/0,m=1/0,g=t;g<=a-t;g++){var f=r(e,0,g,this.toBBox),b=r(e,g,a,this.toBBox),h=(i=f,s=b,void 0,void 0,void 0,void 0,o=Math.max(i.minX,s.minX),l=Math.max(i.minY,s.minY),c=Math.min(i.maxX,s.maxX),d=Math.min(i.maxY,s.maxY),Math.max(0,c-o)*Math.max(0,d-l)),y=u(f)+u(b);h<p?(p=h,n=g,m=y<m?y:m):h===p&&y<m&&(m=y,n=g)}return n||a-t},n.prototype._chooseSplitAxis=function(e,t,a){var n=e.leaf?this.compareMinX:l,i=e.leaf?this.compareMinY:c;this._allDistMargin(e,t,a,n)<this._allDistMargin(e,t,a,i)&&e.children.sort(n)},n.prototype._allDistMargin=function(e,t,a,n){e.children.sort(n);for(var i=this.toBBox,s=r(e,0,t,i),l=r(e,a-t,a,i),c=d(s)+d(l),u=t;u<a-t;u++){var p=e.children[u];o(s,e.leaf?i(p):p),c+=d(s)}for(var m=a-t-1;m>=t;m--){var g=e.children[m];o(l,e.leaf?i(g):g),c+=d(l)}return c},n.prototype._adjustParentBBoxes=function(e,t,a){for(var n=a;n>=0;n--)o(t[n],e)},n.prototype._condense=function(e){for(var t=e.length-1,a=void 0;t>=0;t--)0===e[t].children.length?t>0?(a=e[t-1].children).splice(a.indexOf(e[t]),1):this.clear():s(e[t],this.toBBox)},n}()},,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(230);const i=(e,t)=>e===n.UsersType.details&&null!=t?[{fieldName:"user.name",fieldValue:t}]:[]},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(6).i18n.translate("xpack.securitySolution.exitFullScreenButton",{defaultMessage:"Exit full screen"})},,function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(17),i=a(24);const s=a.n(i)()(n.EuiFlexGroup).withConfig({displayName:"ConditionalFlexGroup",componentId:"sc-jyindk-0"})(["@media only screen and (min-width:1441px){flex-direction:row !important;}"]);s.displayName="ConditionalFlexGroup"},function(e,t,a){const n=a(248);e.exports=(e,t,a)=>0!==n(e,t,a)},function(e,t,a){const n=a(478),i=a(578),s=a(402),r=a(375),o=a(480),l=a(396);e.exports=(e,t,a,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof a&&(a=a.version),e===a;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof a&&(a=a.version),e!==a;case"":case"=":case"==":return n(e,a,c);case"!=":return i(e,a,c);case">":return s(e,a,c);case">=":return r(e,a,c);case"<":return o(e,a,c);case"<=":return l(e,a,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"g",(function(){return r})),a.d(t,"h",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"f",(function(){return d}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"}),s=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"}),r=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"}),o=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"}),l=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"}),c=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."}),u=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."}),d=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."})},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return r})),a.d(t,"h",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"g",(function(){return d}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"}),s=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"}),r=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"kibana.alert.risk_score"}),o=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"}),l=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"}),c=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."}),u=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."}),d=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."})},function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return r}));const n=({group:e,id:t,action_type_id:a,params:n})=>({group:e,id:t,params:n,actionTypeId:a}),i=({group:e,id:t,actionTypeId:a,params:n})=>({group:e,id:t,params:n,action_type_id:a}),s=({action_type_id:e,params:t})=>{const{saved_query_id:a,ecs_mapping:n,pack_id:i,...s}=t;return{params:{...s,savedQueryId:a,ecsMapping:n,packId:i},actionTypeId:e}},r=({actionTypeId:e,params:t})=>{const{savedQueryId:a,ecsMapping:n,packId:i,...s}=t;return{params:{...s,saved_query_id:a,ecs_mapping:n,pack_id:i},action_type_id:e}}},function(e,t,a){"use strict";var n={}.hasOwnProperty;e.exports=n},function(e,t,a){"use strict";e.exports=function(e){for(var t=-1,a=0;++t<e.length;)a+="string"==typeof e[t]?e[t].length:1;return a}},function(e,t,a){"use strict";var n=a(358),i=a(282),s=a(327);function r(e,t){for(var a,n,s,r,o,l,c=e[t][1],u=e[t][2],d=t-1,p=[],m=c._tokenizer||u.parser[c.contentType](c.start),g=m.events,f=[],b={};c;){for(;e[++d][1]!==c;);p.push(d),c._tokenizer||(a=u.sliceStream(c),c.next||a.push(null),n&&m.defineSkip(c.start),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=!0),m.write(a),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=void 0)),n=c,c=c.next}for(c=n,s=g.length;s--;)"enter"===g[s][0]?r=!0:r&&g[s][1].type===g[s-1][1].type&&g[s][1].start.line!==g[s][1].end.line&&(h(g.slice(s+1,o)),c._tokenizer=c.next=void 0,c=c.previous,o=s+1);for(m.events=c._tokenizer=c.next=void 0,h(g.slice(0,o)),s=-1,l=0;++s<f.length;)b[l+f[s][0]]=l+f[s][1],l+=f[s][1]-f[s][0]-1;return b;function h(t){var a=p.pop();f.unshift([a,a+t.length-1]),i(e,a,2,t)}}e.exports=function(e){for(var t,a,o,l,c,u,d,p={},m=-1;++m<e.length;){for(;m in p;)m=p[m];if(t=e[m],m&&"chunkFlow"===t[1].type&&"listItemPrefix"===e[m-1][1].type&&((o=0)<(u=t[1]._tokenizer.events).length&&"lineEndingBlank"===u[o][1].type&&(o+=2),o<u.length&&"content"===u[o][1].type))for(;++o<u.length&&"content"!==u[o][1].type;)"chunkText"===u[o][1].type&&(u[o][1].isInFirstContentOfListItem=!0,o++);if("enter"===t[0])t[1].contentType&&(n(p,r(e,m)),m=p[m],d=!0);else if(t[1]._container||t[1]._movePreviousLineEndings){for(o=m,a=void 0;o--&&("lineEnding"===(l=e[o])[1].type||"lineEndingBlank"===l[1].type);)"enter"===l[0]&&(a&&(e[a][1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);a&&(t[1].end=s(e[a][1].start),(c=e.slice(a,m)).unshift(t),i(e,a,m-a+1,c))}}return!d}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(358),i=a(327),s=l("text"),r=l("string"),o={resolveAll:c()};function l(e){return{tokenize:function(t){var a=this,n=this.parser.constructs[e],i=t.attempt(n,s,r);return s;function s(e){return l(e)?i(e):r(e)}function r(e){if(null!==e)return t.enter("data"),t.consume(e),o;t.consume(e)}function o(e){return l(e)?(t.exit("data"),i(e)):(t.consume(e),o)}function l(e){var t=n[e],i=-1;if(null===e)return!0;if(t)for(;++i<t.length;)if(!t[i].previous||t[i].previous.call(a,a.previous))return!0}},resolveAll:c("text"===e?u:void 0)}}function c(e){return function(t,a){for(var n,i=-1;++i<=t.length;)void 0===n?t[i]&&"data"===t[i][1].type&&(n=i,i++):t[i]&&"data"===t[i][1].type||(i!==n+2&&(t[n][1].end=t[i-1][1].end,t.splice(n+2,i-n-2),i=n+2),n=void 0);return e?e(t,a):t}}function u(e,t){for(var a,s,r,o,l,c,u,d,p=-1;++p<=e.length;)if((p===e.length||"lineEnding"===e[p][1].type)&&"data"===e[p-1][1].type){for(s=e[p-1][1],o=(a=t.sliceStream(s)).length,l=-1,c=0,u=void 0;o--;)if("string"==typeof(r=a[o])){for(l=r.length;32===r.charCodeAt(l-1);)c++,l--;if(l)break;l=-1}else if(-2===r)u=!0,c++;else if(-1!==r){o++;break}c&&(d={type:p===e.length||u||c<2?"lineSuffix":"hardBreakTrailing",start:{line:s.end.line,column:s.end.column-c,offset:s.end.offset-c,_index:s.start._index+o,_bufferIndex:o?l:s.start._bufferIndex+l},end:i(s.end)},s.end=i(d.start),s.start.offset===s.end.offset?n(s,d):(e.splice(p,0,["enter",d,t],["exit",d,t]),p+=2)),p++}return e}t.resolver=o,t.string=r,t.text=s},function(e,t,a){"use strict";e.exports=function(e){return e<32||127===e}},function(e,t,a){e.exports=a(25)(3065)},function(e,t,a){"use strict";var n=a(284)(/\d/);e.exports=n},function(e,t,a){"use strict";var n=a(587),i=a(283),s=a(222);e.exports=function(e,t,a,r,o,l,c,u,d){var p=d||1/0,m=0;return function(t){return 60===t?(e.enter(r),e.enter(o),e.enter(l),e.consume(t),e.exit(l),g):n(t)||41===t?a(t):(e.enter(r),e.enter(c),e.enter(u),e.enter("chunkString",{contentType:"string"}),h(t))};function g(a){return 62===a?(e.enter(l),e.consume(a),e.exit(l),e.exit(o),e.exit(r),t):(e.enter(u),e.enter("chunkString",{contentType:"string"}),f(a))}function f(t){return 62===t?(e.exit("chunkString"),e.exit(u),g(t)):null===t||60===t||s(t)?a(t):(e.consume(t),92===t?b:f)}function b(t){return 60===t||62===t||92===t?(e.consume(t),f):f(t)}function h(s){return 40===s?++m>p?a(s):(e.consume(s),h):41===s?m--?(e.consume(s),h):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(r),t(s)):null===s||i(s)?m?a(s):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(r),t(s)):n(s)?a(s):(e.consume(s),92===s?y:h)}function y(t){return 40===t||41===t||92===t?(e.consume(t),h):h(t)}}},function(e,t,a){"use strict";var n=a(222),i=a(268);e.exports=function(e,t,a,s,r,o){var l,c=this,u=0;return function(t){return e.enter(s),e.enter(r),e.consume(t),e.exit(r),e.enter(o),d};function d(i){return null===i||91===i||93===i&&!l||94===i&&!u&&"_hiddenFootnoteSupport"in c.parser.constructs||u>999?a(i):93===i?(e.exit(o),e.enter(r),e.consume(i),e.exit(r),e.exit(s),t):n(i)?(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),p(i))}function p(t){return null===t||91===t||93===t||n(t)||u++>999?(e.exit("chunkString"),d(t)):(e.consume(t),l=l||!i(t),92===t?m:p)}function m(t){return 91===t||92===t||93===t?(e.consume(t),u++,p):p(t)}}},function(e,t,a){"use strict";var n=a(222),i=a(268),s=a(225);e.exports=function(e,t){var a;return function r(o){return n(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a=!0,r):i(o)?s(e,r,a?"linePrefix":"lineSuffix")(o):t(o)}}},function(e,t,a){"use strict";var n=a(222),i=a(225);e.exports=function(e,t,a,s,r,o){var l;return function(t){return e.enter(s),e.enter(r),e.consume(t),e.exit(r),l=40===t?41:t,c};function c(a){return a===l?(e.enter(r),e.consume(a),e.exit(r),e.exit(s),t):(e.enter(o),u(a))}function u(t){return t===l?(e.exit(o),c(l)):null===t?a(t):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return t===l||null===t||n(t)?(e.exit("chunkString"),u(t)):(e.consume(t),92===t?p:d)}function p(t){return t===l||92===t?(e.consume(t),d):d(t)}}},function(e,t,a){"use strict";var n=a(222),i=a(268),s=a(225),r={name:"thematicBreak",tokenize:function(e,t,a){var r,o=0;return function(t){return e.enter("thematicBreak"),r=t,l(t)};function l(u){return u===r?(e.enter("thematicBreakSequence"),c(u)):i(u)?s(e,l,"whitespace")(u):o<3||null!==u&&!n(u)?a(u):(e.exit("thematicBreak"),t(u))}function c(t){return t===r?(e.consume(t),o++,c):(e.exit("thematicBreakSequence"),l(t))}}};e.exports=r},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(17),i=a(4),s=a.n(i),r=a(215);const o=s.a.createElement(n.EuiText,{color:"subdued",size:"xs"},r.Ub)},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),s=a(92),r=a.n(s),o=a(180),l=a(188),c=a(105);const u=Object(n.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:a=!1,indexPattern:s,isLoading:u=!1,isRefreshPaused:d,filterQuery:p,filterManager:m,filters:g,onChangedQuery:f,onSubmitQuery:b,refreshInterval:h,savedQuery:y,onSavedQuery:E,dataTestSubj:v,displayStyle:k,isDisabled:S})=>{const T=Object(n.useCallback)((e=>{null==e.query||r()(e.query,p)||b(e.query)}),[p,b]),x=Object(n.useCallback)((e=>{f&&null!=e.query&&!r()(e.query,p)&&f(e.query)}),[p,f]),w=Object(n.useCallback)((e=>{const{query:t,filters:a,timefilter:n}=e.attributes;b(t,n),m.setFilters(a||[]),E(e)}),[m,b,E]),O=Object(n.useCallback)((()=>{null!=y&&(b({query:"",language:y.attributes.query.language}),m.setFilters([]),E(void 0))}),[m,b,E,y]),j=Object(n.useCallback)((e=>{m.setFilters(e)}),[m]),I=Object(n.useMemo)((()=>[s]),[s]),C=Object(n.useMemo)((()=>new o.TimeHistory(new c.Storage(localStorage))),[]);return i.a.createElement(l.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:g,indexPatterns:I,isLoading:u,isRefreshPaused:d,query:p,onClearSavedQuery:O,onFiltersUpdated:j,onQueryChange:x,onQuerySubmit:T,onSaved:E,onSavedQueryUpdated:w,refreshInterval:h,showAutoRefreshOnly:!1,showFilterBar:!a,showDatePicker:!1,showQueryBar:!0,showQueryInput:!0,showSaveQuery:!0,timeHistory:C,dataTestSubj:v,savedQuery:y,displayStyle:k,isDisabled:S})}));u.displayName="QueryBar"},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"f",(function(){return s})),a.d(t,"g",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return u}));var n=a(6);const i=n.i18n.translate("xpack.securitySolution.documentationLinks.ariaLabelEnding",{defaultMessage:"click to open documentation in a new tab"}),s="sec-requirements.html",r=n.i18n.translate("xpack.securitySolution.documentationLinks.solutionRequirements.text",{defaultMessage:"Elastic Security system requirements"}),o="detections-permissions-section.html",l=n.i18n.translate("xpack.securitySolution.documentationLinks.detectionsRequirements.text",{defaultMessage:"Detections prerequisites and requirements"}),c="alerts-ui-monitor.html#ml-job-compatibility",u=n.i18n.translate("xpack.securitySolution.documentationLinks.mlJobCompatibility.text",{defaultMessage:"ML job compatibility"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(11),i=a.n(n);class InvariantError extends Error{constructor(...e){super(...e),i()(this,"name","InvariantError")}}function s(e,t){if(!e)throw new InvariantError(t)}},function(e,t,a){"use strict";var n=a(416);a.d(t,"a",(function(){return n.a}))},,function(e,t,a){"use strict";a.d(t,"b",(function(){return ps})),a.d(t,"a",(function(){return ms})),a.d(t,"c",(function(){return bs}));var n=a(17),i=a(6),s=a(56),r=a(175),o=a(3),l=a(4),c=a.n(l),u=a(62),d=a(47),p=a(24),m=a.n(p),g=a(219),f=a(22),b=a(263),h=a(379),y=a(8),E=a(76),v=a(19),k=a(15),S=a(299),T=a(211),x=a(252),w=a(298),O=a(95),j=a(453),I=a(236),C=a(5),M=a(216),D=a(533);const A=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.detailsLabel",{defaultMessage:"Details"}),F=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.aboutText",{defaultMessage:"About"}),R=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.investigationGuideLabel",{defaultMessage:"Investigation guide"}),P=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.setupGuideLabel",{defaultMessage:"Setup guide"}),_=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.controlLegend",{defaultMessage:"Viewing"});var q=a(607);const N=m()(n.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-wtwaaw-0"})(["position:relative;"]),L=m()(n.EuiFlexGroup).withConfig({displayName:"FlexGroupFullHeight",componentId:"sc-wtwaaw-1"})(["height:100%;"]),B=m.a.div.withConfig({displayName:"VerticalOverflowContainer",componentId:"sc-wtwaaw-2"})((e=>({"max-height":`${e.maxHeight}px`,"overflow-y":"hidden","word-break":"break-word"}))),z=m.a.div.withConfig({displayName:"VerticalOverflowContent",componentId:"sc-wtwaaw-3"})((e=>({"max-height":`${e.maxHeight}px`}))),H=m.a.div.withConfig({displayName:"AboutContent",componentId:"sc-wtwaaw-4"})(["height:100%;"]),$={id:"details",label:A,"data-test-subj":"stepAboutDetailsToggle-details"},V={id:"notes",label:R,"data-test-subj":"stepAboutDetailsToggle-notes"},U={id:"setup",label:P,"data-test-subj":"stepAboutDetailsToggle-setup"},Q=({stepData:e,stepDataDetails:t,loading:a})=>{const[i,s]=Object(l.useState)("details"),[r,o]=Object(l.useState)(0),u=Object(l.useCallback)((e=>{o(e.height)}),[o]),d=Object(l.useMemo)((()=>{const e=!Object(C.isEmpty)(null==t?void 0:t.note)&&""!==(null==t?void 0:t.note.trim()),a=!Object(C.isEmpty)(null==t?void 0:t.setup)&&""!==(null==t?void 0:t.setup.trim());return[...e||a?[$]:[],...e?[V]:[],...a?[U]:[]]}),[t]);return c.a.createElement(N,{hasBorder:!0},a&&c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiProgress,{size:"xs",color:"accent",position:"absolute"}),c.a.createElement(M.a,{title:F})),null!=e&&null!=t&&c.a.createElement(L,{gutterSize:"xs",direction:"column"},c.a.createElement(n.EuiFlexItem,{grow:!1,key:"header"},c.a.createElement(M.a,{title:F},d.length>0&&c.a.createElement(n.EuiButtonGroup,{options:d,idSelected:i,onChange:e=>{s(e)},"data-test-subj":"stepAboutDetailsToggle",legend:_}))),c.a.createElement(n.EuiFlexItem,{key:"details"},"details"===i&&c.a.createElement(n.EuiResizeObserver,{"data-test-subj":"stepAboutDetailsContent",onResize:u},(a=>c.a.createElement(H,{ref:a},c.a.createElement(B,{maxHeight:120},c.a.createElement(z,{maxHeight:120,className:"eui-yScrollWithShadows"},c.a.createElement(n.EuiText,{size:"s","data-test-subj":"stepAboutRuleDetailsToggleDescriptionText"},t.description))),c.a.createElement(n.EuiSpacer,{size:"m"}),c.a.createElement(q.a,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:e})))),"notes"===i&&c.a.createElement(B,{"data-test-subj":"stepAboutDetailsNoteContent",maxHeight:r},c.a.createElement(z,{maxHeight:r,className:"eui-yScrollWithShadows"},c.a.createElement(D.b,null,t.note))),"setup"===i&&c.a.createElement(B,{"data-test-subj":"stepAboutDetailsSetupContent",maxHeight:r},c.a.createElement(z,{maxHeight:r,className:"eui-yScrollWithShadows"},c.a.createElement(D.b,null,t.setup))))))},W=Object(l.memo)(Q);var G=a(681),K=a(691),J=a(277),Y=a(605),X=a(621),Z=a(349),ee=a(664),te=a(665),ae=a(307),ne=a(213),ie=a(29),se=a(23),re=a(1),oe=a(269),le=a(202),ce=a(413),ue=a(267),de=a(258),pe=a(328),me=a(492),ge=a(215);const fe=i.i18n.translate("xpack.securitySolution.detectionEngine.rules.components.ruleActionsOverflow.allActionsTitle",{defaultMessage:"All actions"}),be=m()(n.EuiButtonIcon).withConfig({displayName:"MyEuiButtonIcon",componentId:"sc-wltxb1-0"})(["&.euiButtonIcon{svg{transform:rotate(90deg);}border:1px solid ",";width:40px;height:40px;}"],(({theme:e})=>e.euiColorPrimary)),he=({rule:e,userHasPermissions:t,canDuplicateRuleWithActions:a})=>{const[i,,s,r]=Object(ce.a)(),{navigateToApp:o}=Object(v.k)().services.application,u=Object(le.a)(),{startTransaction:d}=Object(de.a)(),p=Object(l.useCallback)((()=>{o(re.A,{deepLinkId:re.uc.rules,path:Object(x.e)()})}),[o]),m=Object(l.useMemo)((()=>null!=e?[c.a.createElement(n.EuiContextMenuItem,{key:ge.zb,icon:"copy",disabled:!a||!t,"data-test-subj":"rules-details-duplicate-rule",onClick:async()=>{d({name:ue.e.DUPLICATE}),s();const t=await Object(me.c)({action:oe.a.duplicate,onSuccess:C.noop,search:{ids:[e.id]},toasts:u}),a=null==t?void 0:t.attributes.results.created;null!=a&&a.length&&Object(me.d)(a[0].id,o)}},c.a.createElement(n.EuiToolTip,{position:"left",content:Object(pe.a)(e,a)?void 0:ge.Ob},c.a.createElement(c.a.Fragment,null,ge.zb))),c.a.createElement(n.EuiContextMenuItem,{key:ge.Hb,icon:"exportAction",disabled:!t||e.immutable,"data-test-subj":"rules-details-export-rule",onClick:async()=>{d({name:ue.e.EXPORT}),s(),await Object(me.a)({action:oe.a.export,search:{ids:[e.id]},toasts:u})}},ge.Hb),c.a.createElement(n.EuiContextMenuItem,{key:ge.yb,icon:"trash",disabled:!t,"data-test-subj":"rules-details-delete-rule",onClick:async()=>{d({name:ue.e.DELETE}),s(),await Object(me.c)({action:oe.a.delete,onSuccess:p,search:{ids:[e.id]},toasts:u})}},ge.yb)]:[]),[a,s,o,p,e,d,u,t]),g=Object(l.useMemo)((()=>c.a.createElement(n.EuiToolTip,{position:"top",content:fe},c.a.createElement(be,{iconType:"boxesHorizontal","aria-label":fe,isDisabled:!t,"data-test-subj":"rules-details-popover-button-icon",onClick:r}))),[r,t]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiPopover,{anchorPosition:"leftCenter",button:g,closePopover:s,id:"ruleActionsOverflow",isOpen:i,"data-test-subj":"rules-details-popover",ownFocus:!0,panelPaddingSize:"none",repositionOnScroll:!0},c.a.createElement(n.EuiContextMenuPanel,{"data-test-subj":"rules-details-menu-panel",items:m})))},ye=c.a.memo(he);ye.displayName="RuleActionsOverflow";var Ee=a(224),ve=a(376),ke=a(351),Se=a(9),Te=a(96),xe=a(493),we=a(241),Oe=a(91),je=a(94),Ie=a(207),Ce=a(13),Me=a(528),De=a(102),Ae=a.n(De),Fe=a(255);const Re=()=>v.b.get().http;var Pe=a(203),_e=a(494);const qe=Object(Pe.d)(),Ne=({status:e,showTooltip:t=!1})=>{var a;const i=null!==(a=Object(_e.a)(e))&&void 0!==a?a:qe,s=Object(_e.b)(e);return t?c.a.createElement(Me.b,{status:e}):c.a.createElement(n.EuiHealth,{color:s},i)},Le=c.a.memo(Ne);Le.displayName="ExecutionStatusIndicator";const Be=e=>{const{dataTestSubj:t,title:a,items:i,selectedItems:s,onSelectionChange:r,renderItem:o,renderLabel:u}=He(e),[d,,p,m]=Object(ce.a)(),g=Object(l.useCallback)((e=>{const t=s.includes(e)?s.filter((t=>t!==e)):[...s,e];r(t)}),[s,r]),f=Object(l.useMemo)((()=>i.map(((e,a)=>{const i=u(e),r=o(e);return c.a.createElement(n.EuiFilterSelectItem,{"data-test-subj":`${t}-item`,title:i,key:`${a}-${i}`,checked:s.includes(e)?"on":void 0,onClick:()=>g(e)},r)}))),[t,i,s,o,u,g]);return c.a.createElement(n.EuiFilterGroup,{"data-test-subj":t},c.a.createElement(n.EuiPopover,{"data-test-subj":`${t}-popover`,button:c.a.createElement(n.EuiFilterButton,{"data-test-subj":`${t}-popoverButton`,iconType:"arrowDown",grow:!1,numFilters:i.length,numActiveFilters:s.length,hasActiveFilters:s.length>0,isSelected:d,onClick:m},a),isOpen:d,closePopover:p,panelPaddingSize:"none",repositionOnScroll:!0},f))},ze=(()=>{const e=c.a.memo(Be);return e.displayName="MultiselectFilter",e})(),He=e=>{var t,a,n,i;const s=null!==(t=e.onSelectionChange)&&void 0!==t?t:C.noop,r=null!==(a=e.renderLabel)&&void 0!==a?a:String,o=null!==(n=e.renderItem)&&void 0!==n?n:r;return{dataTestSubj:null!==(i=e.dataTestSubj)&&void 0!==i?i:"multiselectFilter",title:e.title,items:e.items,selectedItems:e.selectedItems,onSelectionChange:s,renderLabel:r,renderItem:o}},$e=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionStatusFilter.filterTitle",{defaultMessage:"Status"}),Ve=({items:e,selectedItems:t,onChange:a})=>{const n=Object(l.useCallback)((e=>c.a.createElement(Le,{status:e})),[]);return c.a.createElement(ze,{dataTestSubj:"ExecutionStatusFilter",title:$e,items:e,selectedItems:t,onSelectionChange:a,renderItem:n})},Ue=c.a.memo(Ve);Ue.displayName="ExecutionStatusFilter";var Qe=a(2);const We=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.messageText",{defaultMessage:"Message"}),Ge=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.statusChangeText",{defaultMessage:"Status"}),Ke=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.executionMetricsText",{defaultMessage:"Metrics"}),Je=({type:e})=>{const t=(e=>{switch(e){case Fe.e.message:return"console";case Fe.e["status-change"]:return"dot";case Fe.e["execution-metrics"]:return"gear";default:return Object(Qe.a)(e,"Unknown rule execution event type")}})(e),a=(e=>{switch(e){case Fe.e.message:return We;case Fe.e["status-change"]:return Ge;case Fe.e["execution-metrics"]:return Ke;default:return Object(Qe.a)(e,"Unknown rule execution event type")}})(e);return c.a.createElement(n.EuiBadge,{color:"hollow",iconType:t},a)},Ye=c.a.memo(Je);Ye.displayName="EventTypeIndicator";const Xe=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeFilter.filterTitle",{defaultMessage:"Event type"}),Ze=({selectedItems:e,onChange:t})=>{const a=Object(l.useCallback)((e=>c.a.createElement(Ye,{type:e})),[]);return c.a.createElement(ze,{dataTestSubj:"eventTypeFilter",title:Xe,items:Fe.d,selectedItems:e,onSelectionChange:t,renderItem:a})},et=c.a.memo(Ze);et.displayName="EventTypeFilter";const tt=({logLevel:e})=>{const t=(e=>{switch(e){case Fe.b.trace:case Fe.b.debug:return"hollow";case Fe.b.info:return"default";case Fe.b.warn:return"warning";case Fe.b.error:return"danger";default:return Object(Qe.a)(e,"Unknown log level")}})(e),a=(e=>Object(C.upperCase)(e))(e);return c.a.createElement(n.EuiBadge,{color:t},a)},at=c.a.memo(tt);at.displayName="LogLevelIndicator";const nt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.logLevelFilter.filterTitle",{defaultMessage:"Log level"}),it=({selectedItems:e,onChange:t})=>{const a=Object(l.useCallback)((e=>c.a.createElement(at,{logLevel:e})),[]);return c.a.createElement(ze,{dataTestSubj:"logLevelFilter",title:nt,items:Fe.a,selectedItems:e,onSelectionChange:t,renderItem:a})},st=c.a.memo(it);st.displayName="LogLevelFilter";const rt=({text:e})=>c.a.createElement(n.EuiCodeBlock,{className:"eui-fullWidth",isCopyable:!0,overflowHeight:320,transparentBackground:!0},null!=e?e:""),ot=c.a.memo(rt);ot.displayName="TextBlock";const lt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.tableTitle",{defaultMessage:"Execution log"}),ct=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.tableSubtitle",{defaultMessage:"A detailed log of rule execution events"}),ut=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.timestampColumn",{defaultMessage:"Timestamp"}),dt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.logLevelColumn",{defaultMessage:"Level"}),pt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.eventTypeColumn",{defaultMessage:"Type"}),mt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.messageColumn",{defaultMessage:"Message"}),gt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.fetchErrorDescription",{defaultMessage:"Failed to fetch rule execution events"}),ft=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.rowDetails.messageTitle",{defaultMessage:"Message"}),bt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.rowDetails.jsonTitle",{defaultMessage:"Full JSON"}),ht=({item:e})=>c.a.createElement(n.EuiDescriptionList,{className:"eui-fullWidth",listItems:[{title:ft,description:c.a.createElement(ot,{text:e.message})},{title:bt,description:c.a.createElement(ot,{text:JSON.stringify(e,null,2)})}]}),yt=c.a.memo(ht);yt.displayName="ExecutionEventsTableRowDetails";const Et=[10,20,50],vt=({text:e})=>null!=e?c.a.createElement("span",{className:"eui-fullWidth eui-textTruncate"},e):null,kt=c.a.memo(vt);kt.displayName="TruncatedText";const St={field:"timestamp",name:ut,render:e=>c.a.createElement(T.a,{value:e,fieldName:"timestamp"}),sortable:!0,truncateText:!1,width:"20%"},Tt={field:"level",name:dt,render:e=>c.a.createElement(at,{logLevel:e}),sortable:!1,truncateText:!1,width:"8%"},xt={field:"type",name:pt,render:e=>c.a.createElement(Ye,{type:e}),sortable:!1,truncateText:!1,width:"8%"},wt={field:"message",name:mt,render:e=>c.a.createElement(kt,{text:e}),sortable:!1,truncateText:!0,width:"64%"},Ot=({toggleRowExpanded:e,isRowExpanded:t})=>({align:n.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:c.a.createElement(n.EuiScreenReaderOnly,null,c.a.createElement("span",null,"Expand rows")),render:a=>c.a.createElement(n.EuiButtonIcon,{onClick:()=>e(a),"aria-label":t(a)?"Collapse":"Expand",iconType:t(a)?"arrowUp":"arrowDown"})});var jt=a(218);const It=[10,20,50,100,200],Ct=({ruleId:e})=>{const t=Object(l.useCallback)((e=>`${e.timestamp} ${e.sequence}`),[]),a=(e=>{const{getItemId:t,renderItem:a}=e,[n,i]=Object(l.useState)({}),s=Object(l.useCallback)((e=>{const s={...n},r=t(e);s[r]?delete s[r]:s[r]=a(e),i(s)}),[n,t,a]),r=Object(l.useCallback)((e=>{const a=t(e);return null!=n[a]}),[n,t]);return Object(l.useMemo)((()=>({itemIdToExpandedRowMap:n,getItemId:t,toggleRowExpanded:s,isRowExpanded:r})),[n,t,s,r])})({getItemId:t,renderItem:Object(l.useCallback)((e=>c.a.createElement(yt,{item:e})),[])}),i=(e=>{const{toggleRowExpanded:t,isRowExpanded:a}=e;return Object(l.useMemo)((()=>[St,Tt,xt,wt,Ot({toggleRowExpanded:t,isRowExpanded:a})]),[t,a])})({toggleRowExpanded:a.toggleRowExpanded,isRowExpanded:a.isRowExpanded}),s=(()=>{const[e,t]=Object(l.useState)([]),[a,n]=Object(l.useState)([]),i=Object(l.useMemo)((()=>({logLevels:e,eventTypes:a})),[e,a]);return Object(l.useMemo)((()=>({state:i,setLogLevels:t,setEventTypes:n})),[i,t,n])})(),r=((e,t)=>{const[a,n]=Object(l.useState)("timestamp"),[i,s]=Object(l.useState)("desc"),r=Object(l.useMemo)((()=>({sort:{field:a,direction:i}})),[a,i]),o=Object(l.useCallback)((e=>{e.sort&&(n(e.sort.field),s(e.sort.direction))}),[n,s]);return Object(l.useMemo)((()=>({state:r,update:o})),[r,o])})(),o=(e=>{var t,a,n;const i=null!==(t=e.pageSizeOptions)&&void 0!==t?t:Et,s=null!==(a=e.pageSizeDefault)&&void 0!==a?a:i[0],r=null!==(n=e.pageNumberDefault)&&void 0!==n?n:1,[o,c]=Object(l.useState)(s),[u,d]=Object(l.useState)(r),[p,m]=Object(l.useState)(0),g=Object(l.useMemo)((()=>({pageSizeOptions:i,pageSize:o,pageNumber:u,pageIndex:u-1,totalItemCount:p})),[i,o,u,p]),f=Object(l.useCallback)((e=>{d(e.page.index+1),c(e.page.size)}),[d,c]),b=Object(l.useCallback)((e=>{m(null!=e?e:0)}),[m]);return Object(l.useMemo)((()=>({state:g,update:f,updateTotalItemCount:b})),[g,f,b])})({pageSizeOptions:It}),u=(e=>{const{addError:t}=Object(le.a)();return Object(jt.useQuery)(["detectionEngine","ruleMonitoring","executionEvents",e],(({signal:t})=>(e=>{const{ruleId:t,eventTypes:a,logLevels:n,sortOrder:i,page:s,perPage:r,signal:o}=e,l=Object(Fe.h)(t);return Re().fetch(l,{method:"GET",query:{event_types:null==a?void 0:a.join(","),log_levels:null==n?void 0:n.join(","),sort_order:i,page:s,per_page:r},signal:o})})({...e,signal:t})),{keepPreviousData:!0,refetchInterval:2e4,onError:e=>{t(e,{title:gt})}})})({ruleId:e,eventTypes:s.state.eventTypes,logLevels:s.state.logLevels,sortOrder:r.state.sort.direction,page:o.state.pageNumber,perPage:o.state.pageSize});Object(l.useEffect)((()=>{var e;o.updateTotalItemCount(null===(e=u.data)||void 0===e?void 0:e.pagination.total)}),[u,o]);const d=Object(l.useMemo)((()=>{var e,t;return null!==(e=null===(t=u.data)||void 0===t?void 0:t.events)&&void 0!==e?e:[]}),[u.data]),p=Object(l.useCallback)((e=>{r.update(e),o.update(e)}),[r,o]);return c.a.createElement(n.EuiPanel,{hasBorder:!0},c.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},c.a.createElement(n.EuiFlexItem,{grow:!0},c.a.createElement(M.a,{title:lt,subtitle:ct})),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(st,{selectedItems:s.state.logLevels,onChange:s.setLogLevels})),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(et,{selectedItems:s.state.eventTypes,onChange:s.setEventTypes}))),c.a.createElement(n.EuiBasicTable,{columns:i,items:d,itemId:t,itemIdToExpandedRowMap:a.itemIdToExpandedRowMap,isExpandable:!0,loading:u.isFetching,sorting:r.state,pagination:o.state,onChange:p}))},Mt=c.a.memo(Ct);Mt.displayName="RuleExecutionEventsTable";const Dt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionResultsTable.fetchErrorDescription",{defaultMessage:"Failed to fetch rule execution results"});var At=a(238);const Ft=(e,t)=>{try{const[t]=Object(v.q)(e);return t}catch(e){return t}};var Rt=a(26),Pt=a.n(Rt),_t=a(44),qt=1e3,Nt="siem",Lt=("".concat(Nt,".eqlRule"),"".concat(Nt,".indicatorRule"),"".concat(Nt,".mlRule"),"".concat(Nt,".queryRule"),"".concat(Nt,".savedQueryRule"),"".concat(Nt,".thresholdRule"),"".concat(Nt,".newTermsRule"),a(11),a(12),a(146)),Bt=(a(857),a(176)),zt=a(419),Ht=a(78),$t=a(114),Vt=a(598);const Ut=Object(l.createContext)(null),Qt=({children:e})=>{var t;const{storage:a}=Object(v.k)().services,[n,i]=Object(l.useState)([]),[s,r]=Object(l.useState)(1e3),[o,u]=Object(l.useState)(!0),[d,p]=Object(l.useState)("now-24h"),[m,g]=Object(l.useState)("now"),[f,b]=Object(l.useState)(""),[h,y]=Object(l.useState)([]),[E,k]=Object(l.useState)(null!==(t=a.get(re.oc))&&void 0!==t&&t),[S,T]=Object(l.useState)(1),[x,w]=Object(l.useState)(5),[O,j]=Object(l.useState)("timestamp"),[I,C]=Object(l.useState)("desc"),M=Object(l.useMemo)((()=>({[ps.executionResults]:{state:{superDatePicker:{recentlyUsedRanges:n,refreshInterval:s,isPaused:o,start:d,end:m},queryText:f,statusFilters:h,showMetricColumns:E,pagination:{pageIndex:S,pageSize:x},sort:{sortField:O,sortDirection:I}},actions:{setEnd:g,setIsPaused:u,setPageIndex:T,setPageSize:w,setQueryText:b,setRecentlyUsedRanges:i,setRefreshInterval:r,setShowMetricColumns:k,setSortDirection:C,setSortField:j,setStart:p,setStatusFilters:y}}})),[m,o,S,x,f,n,s,E,I,O,d,h]);return c.a.createElement(Ut.Provider,{value:M},e)},Wt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.tableTitle",{defaultMessage:"Execution log"}),Gt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.tableSubtitle",{defaultMessage:"A log of rule execution results"}),Kt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchPlaceholder",{defaultMessage:"duration > 100 and gapDuration > 10"}),Jt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.showMetricColumnsSwitchTitle",{defaultMessage:"Show metrics columns"}),Yt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.statusColumn",{defaultMessage:"Status"}),Xt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.statusColumnTooltip",{defaultMessage:"Overall status of execution."}),Zt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.timestampColumn",{defaultMessage:"Timestamp"}),ea=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.timestampColumnTooltip",{defaultMessage:"Datetime rule execution initiated."}),ta=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationColumn",{defaultMessage:"Duration"}),aa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationColumnTooltip",{defaultMessage:"The length of time it took for the rule to run (hh:mm:ss:SSS)."}),na=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.messageColumn",{defaultMessage:"Message"}),ia=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.messageColumnTooltip",{defaultMessage:"Relevant message from execution outcome."}),sa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapDurationColumn",{defaultMessage:"Gap Duration"}),ra=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),oa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.indexDurationColumn",{defaultMessage:"Index Duration"}),la=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.indexDurationColumnTooltip",{defaultMessage:"The length of time it took to index detected alerts (hh:mm:ss:SSS)."}),ca=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchDurationColumn",{defaultMessage:"Search Duration"}),ua=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchDurationColumnTooltip",{defaultMessage:"The length of time it took to search for alerts (hh:mm:ss:SSS)."}),da=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.schedulingDelayColumn",{defaultMessage:"Scheduling Delay"}),pa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.schedulingDelayColumnTooltip",{defaultMessage:"The length of time from rule scheduled till rule executed (hh:mm:ss:SSS)."}),ma=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionsColumn",{defaultMessage:"Actions"}),ga=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionsColumnTooltip",{defaultMessage:"Filter alerts by rule execution ID."}),fa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedTitle",{defaultMessage:"Global search filters have been updated"}),ba=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedDescription",{defaultMessage:"Search filters have been updated to show alerts from selected rule execution"}),ha=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedRestoreButtonTitle",{defaultMessage:"Restore previous filters"}),ya=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionFieldNotFoundErrorTitle",{defaultMessage:"Unable to filter alerts"}),Ea=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionFieldNotFoundErrorDescription",{defaultMessage:"Cannot find field 'kibana.alert.rule.execution.uuid' in alerts index."}),va=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationNotAvailableDescription",{defaultMessage:"N/A"}),ka=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationGreaterThanYearDescription",{defaultMessage:"> 1 Year"});var Sa=a(666),Ta=a(667);const xa=e=>{const{duration:t,isSeconds:a=!1,allowZero:n=!0}=e,i=Object(l.useMemo)((()=>n&&t>=0?(e=>{if(!e)return"00:00:00:000";const t=Pt.a.duration(e),a=Math.floor(t.asDays()).toString().padStart(3,"0"),n=Math.floor(t.asHours()%24).toString().padStart(2,"0"),i=Math.floor(t.asMinutes()%60).toString().padStart(2,"0"),s=t.seconds().toString().padStart(2,"0"),r=t.milliseconds().toString().padStart(3,"0");return Math.floor(t.asDays())>0?Math.floor(t.asDays())>=365?ka:`${a}:${n}:${i}:${s}:${r}`:`${n}:${i}:${s}:${r}`})(a?1e3*t:t):va),[n,t,a]);return c.a.createElement("span",{"data-test-subj":"rule-duration-format-value"},i)},wa=c.a.memo(xa);wa.displayName="RuleDurationFormat";const Oa=[{name:c.a.createElement(Ta.a,{title:Yt,tooltipContent:Xt}),field:"security_status",render:e=>c.a.createElement(Le,{status:e,showTooltip:!0}),sortable:!1,truncateText:!1,width:"10%"},{field:"timestamp",name:c.a.createElement(Ta.a,{title:Zt,tooltipContent:ea}),render:e=>c.a.createElement(T.a,{value:e,fieldName:"timestamp"}),sortable:!0,truncateText:!1,width:"15%"},{field:"duration_ms",name:c.a.createElement(Ta.a,{title:ta,tooltipContent:aa}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(wa,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"security_message",name:c.a.createElement(Ta.a,{title:na,tooltipContent:ia}),render:e=>c.a.createElement(c.a.Fragment,null,e),sortable:!1,truncateText:!1,width:"35%"}],ja=e=>[{field:"gap_duration_s",name:c.a.createElement(Ta.a,{title:sa,customTooltip:c.a.createElement("div",{style:{maxWidth:"20px"}},c.a.createElement(Sa.a,{columnName:sa},c.a.createElement(n.EuiText,{size:"s",style:{width:350}},c.a.createElement("p",null,c.a.createElement(r.FormattedMessage,{defaultMessage:"Duration of gap in Rule execution (hh:mm:ss:SSS). Adjust Rule look-back or {seeDocs} for mitigating gaps.",id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapDurationColumnTooltip",values:{seeDocs:c.a.createElement(n.EuiLink,{href:`${e.links.siem.troubleshootGaps}`,target:"_blank"},ra)}})))))}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(wa,{duration:e,isSeconds:!0}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"indexing_duration_ms",name:c.a.createElement(Ta.a,{title:oa,tooltipContent:la}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(wa,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"search_duration_ms",name:c.a.createElement(Ta.a,{title:ca,tooltipContent:ua}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(wa,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"schedule_delay_ms",name:c.a.createElement(Ta.a,{title:da,tooltipContent:pa}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(wa,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"}],Ia={status:"kibana.alert.rule.execution.status",timestamp:"@timestamp",duration:"event.duration",message:"message",gapDuration:"kibana.alert.rule.execution.metrics.execution_gap_duration_s",indexDuration:"kibana.alert.rule.execution.metrics.total_indexing_duration_ms",searchDuration:"kibana.alert.rule.execution.metrics.total_search_duration_ms",totalActions:"kibana.alert.rule.execution.metrics.number_of_triggered_actions",schedulingDelay:"kibana.task.schedule_delay"},Ca=[Fe.f.succeeded,Fe.f.failed,Fe.f["partial failure"]],Ma=c.a.memo((({onlyShowFilters:e,selectedStatuses:t,onStatusFilterChange:a,onSearch:i})=>{const s=Object(l.useCallback)((e=>{i((e=>Object.entries(Ia).reduce(((e,[t,a])=>Object(C.replace)(e,t,a)),e))(e))}),[i]);return c.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},c.a.createElement(n.EuiFlexItem,{grow:!0},!e&&c.a.createElement(n.EuiFieldSearch,{"data-test-subj":"executionLogSearch","aria-label":Kt,placeholder:Kt,onSearch:s,isClearable:!0,fullWidth:!0})),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(Ue,{items:Ca,selectedItems:t,onChange:a})))}));Ma.displayName="ExecutionLogSearchBar";const Da="kibana.alert.rule.execution.uuid",Aa=m()(n.EuiSwitch).withConfig({displayName:"UtilitySwitch",componentId:"sc-4svvej-0"})(["margin-left:17px;"]),Fa=m()(n.EuiFlexItem).withConfig({displayName:"DatePickerEuiFlexItem",componentId:"sc-4svvej-1"})(["max-width:582px;"]),Ra=({ruleId:e,selectAlertsTab:t})=>{var a,s;const{docLinks:o,data:{query:{filterManager:u}},storage:p,timelines:m}=Object(v.k)().services,{[ps.executionResults]:{state:{superDatePicker:{recentlyUsedRanges:g,refreshInterval:f,isPaused:b,start:h,end:k},queryText:S,statusFilters:T,showMetricColumns:x,pagination:{pageIndex:w,pageSize:O},sort:{sortField:j,sortDirection:I}},actions:{setEnd:C,setIsPaused:D,setPageIndex:A,setPageSize:F,setQueryText:R,setRecentlyUsedRanges:P,setRefreshInterval:_,setShowMetricColumns:q,setSortDirection:N,setSortField:L,setStart:B,setStatusFilters:z}}}=(()=>{const e=Object(l.useContext)(Ut);return Object(Vt.a)(e,"useRuleDetailsContext should be used inside RuleDetailsContextProvider"),e})(),{indexPattern:H}=Object(Ie.d)(Ce.SourcererScopeName.detections),{addError:$,addSuccess:V,remove:U}=Object(le.a)(),Q=Object(d.useDispatch)(),W=Object(l.useMemo)((()=>Ht.f.globalFiltersQuerySelector()),[]),G=Object(l.useMemo)((()=>Ht.f.globalQuerySelector()),[]),K=Object(E.a)(Ht.f.globalTimeRangeSelector),J=Object(E.a)(G),Y=Object(E.a)(W),X=Object(l.useRef)({filters:Y,query:J,timerange:K}),Z=Object(l.useRef)(""),ee=Object(l.useCallback)((()=>{Object($t.a)(X.current.timerange)?Q(Object(se.setAbsoluteRangeDatePicker)({id:y.a.global,from:X.current.timerange.from,to:X.current.timerange.to})):Object($t.b)(X.current.timerange)&&Q(Object(se.setRelativeRangeDatePicker)({id:y.a.global,from:X.current.timerange.from,fromStr:X.current.timerange.fromStr,to:X.current.timerange.to,toStr:X.current.timerange.toStr})),Q(Object(se.setFilterQuery)({id:y.a.global,query:X.current.query.query,language:X.current.query.language})),u.removeAll(),u.addFilters(X.current.filters),U(Z.current)}),[Q,u,U]),{data:te,dataUpdatedAt:ae,isFetching:ne,isLoading:ie,refetch:oe}=(e=>{const{addError:t}=Object(le.a)();return Object(jt.useQuery)(["detectionEngine","ruleMonitoring","executionResults",e],(({signal:t})=>(e=>{var t;const{ruleId:a,start:n,end:i,queryText:s,statusFilters:r,page:o,perPage:l,sortField:c,sortOrder:u,signal:d}=e,p=Object(Fe.i)(a),m=Ae.a.parse(n),g=Ae.a.parse(i,{roundUp:!0});return Re().fetch(p,{method:"GET",query:{start:null==m?void 0:m.utc().toISOString(),end:null==g?void 0:g.utc().toISOString(),query_text:s,status_filters:null==r||null===(t=r.sort())||void 0===t?void 0:t.join(","),sort_field:c,sort_order:u,page:o,per_page:l},signal:d})})({...e,signal:t})),{keepPreviousData:!0,onError:e=>{t(e,{title:Dt})}})})({ruleId:e,start:h,end:k,queryText:S,statusFilters:T,page:w,perPage:O,sortField:j,sortOrder:I}),ce=null!==(a=null==te?void 0:te.events)&&void 0!==a?a:[],ue=null!==(s=null==te?void 0:te.total)&&void 0!==s?s:0,de=Object(l.useMemo)((()=>H.fields.find((e=>e.name===Da))),[H]),pe=Object(l.useCallback)((({page:e={},sort:t={}})=>{const{index:a,size:n}=e,{field:i,direction:s}=t;A(a+1),F(n),L(i),N(s)}),[A,F,N,L]),me=Object(l.useCallback)((e=>{const t=g.filter((t=>!(t.start===e.start&&t.end===e.end)));t.unshift({start:e.start,end:e.end}),B(e.start),C(e.end),P(t.length>10?t.slice(0,9):t)}),[g,C,P,B]),ge=Object(l.useCallback)((e=>{D(e.isPaused),_(e.refreshInterval>6e4?e.refreshInterval:6e4)}),[D,_]),fe=Object(l.useCallback)((e=>{oe()}),[oe]),be=Object(l.useCallback)((e=>{R(e)}),[R]),he=Object(l.useCallback)((e=>{z(e)}),[z]),ye=Object(l.useCallback)(((e,a)=>{if(null!=de){X.current={filters:Y,query:J,timerange:K};const s=Object(_t.d)(H,de,_t.a.PHRASE,!1,!1,e,null);Q(Object(se.setAbsoluteRangeDatePicker)({id:y.a.global,from:Pt()(a).subtract(1,"days").toISOString(),to:Pt()(a).add(1,"days").toISOString()})),u.removeAll(),u.addFilters(s),Q(Object(se.setFilterQuery)({id:y.a.global,query:"",language:"kuery"})),t(),Z.current=V({title:fa,text:(i=c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,ba),c.a.createElement(n.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiButton,{size:"s",onClick:ee},ha)))),function(e){return Object(Lt.render)(Object(Bt.jsx)(r.I18nProvider,null,i),e),function(){return Object(Lt.unmountComponentAtNode)(e)}})},{toastLifeTimeMs:6e5}).id}else $(Ea,{title:ya});var i}),[$,V,Q,u,Y,H,J,ee,t,K,de]),Ee=Object(l.useCallback)((e=>{p.set(re.oc,e),q(e)}),[q,p]),ve=Object(l.useMemo)((()=>({pageIndex:w-1,pageSize:O,totalItemCount:ue>qt?qt:ue,pageSizeOptions:[5,10,25,50]})),[ue,w,O]),ke=Object(l.useMemo)((()=>({sort:{field:j,direction:I}})),[I,j]),Se=Object(l.useMemo)((()=>[{field:Da,name:ma,width:"5%",actions:[{name:"Edit",isPrimary:!0,field:"",description:ga,icon:"filter",type:"icon",onClick:e=>{null!=e&&e.execution_uuid&&ye(e.execution_uuid,e.timestamp)},"data-test-subj":"action-filter-by-execution-id"}]}]),[ye]),Te=Object(l.useMemo)((()=>x?[...Oa,...ja(o),...Se]:[...Oa,...Se]),[Se,o,x]);return c.a.createElement(n.EuiPanel,{hasBorder:!0},c.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},c.a.createElement(n.EuiFlexItem,{grow:!0},c.a.createElement(M.a,{title:Wt,subtitle:Gt})),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(Ma,{onlyShowFilters:!0,selectedStatuses:T,onStatusFilterChange:he,onSearch:be})),c.a.createElement(Fa,null,c.a.createElement(n.EuiSuperDatePicker,{start:h,end:k,onTimeChange:me,onRefresh:fe,isPaused:b,isLoading:ne,refreshInterval:f,onRefreshChange:ge,recentlyUsedRanges:g,width:"full"}))),c.a.createElement(n.EuiSpacer,{size:"s"}),c.a.createElement(zt.a,null,c.a.createElement(zt.d,null,c.a.createElement(zt.c,null,c.a.createElement(zt.e,{dataTestSubj:"executionsShowing"},(xe=ue>qt?qt:ue,i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.totalExecutionsLabel",{values:{totalItems:xe},defaultMessage:"Showing {totalItems} {totalItems, plural, =1 {rule execution} other {rule executions}}"})))),ue>qt&&c.a.createElement(zt.c,{grow:!0},c.a.createElement(zt.e,{dataTestSubj:"exceptionsShowing",shouldWrap:!0},c.a.createElement(n.EuiTextColor,{color:"danger"},((e,t)=>i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchLimitExceededLabel",{values:{totalItems:e,maxItems:1e3},defaultMessage:"More than {totalItems} rule executions match filters provided. Showing first {maxItems} by most recent '@timestamp'. Constrain filters further to view additional execution events."}))(ue))))),c.a.createElement(zt.d,null,c.a.createElement(zt.c,null,c.a.createElement(zt.e,{dataTestSubj:"lastUpdated"},m.getLastUpdated({showUpdating:ie||ne,updatedAt:ae})),c.a.createElement(Aa,{label:Jt,checked:x,compressed:!0,onChange:e=>Ee(e.target.checked)})))),c.a.createElement(n.EuiBasicTable,{columns:Te,items:ce,loading:ne,sorting:ke,pagination:ve,onChange:pe}));var xe},Pa=c.a.memo(Ra);Pa.displayName="ExecutionLogTable";var _a=a(414),qa=a(668);i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"});const Na=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesButton",{defaultMessage:"Rules"}),La=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.enableRuleLabel",{defaultMessage:"Enable"}),Ba=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"}),za=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExceptionsTab",{defaultMessage:"Rule exceptions"}),Ha=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.endpointExceptionsTab",{defaultMessage:"Endpoint exceptions"}),$a=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionResultsTab",{defaultMessage:"Execution results"}),Va=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionEventsTab",{defaultMessage:"Execution events"}),Ua=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deletedRule",{defaultMessage:"Deleted rule"});var Qa=a(622),Wa=a(530),Ga=a(743),Ka=a(670),Ja=a(525),Ya=a(266),Xa=a(341),Za=a(285),en=a(356);const tn=i.i18n.translate("xpack.securitySolution.exceptions.allItems.noSearchResultsPromptTitle",{defaultMessage:"No results match your search criteria"}),an=i.i18n.translate("xpack.securitySolution.exceptions.allItems.noSearchResultsPromptBody",{defaultMessage:"Try modifying your search."}),nn=i.i18n.translate("xpack.securitySolution.exceptions.allItems.addExceptionsEmptyPromptTitle",{defaultMessage:"Add exceptions to this rule"}),sn=i.i18n.translate("xpack.securitySolution.exceptions.allItems.emptyPromptBody",{defaultMessage:"There are no exceptions for this rule. Create your first rule exception."}),rn=i.i18n.translate("xpack.securitySolution.exceptions.allItems.endpoint.emptyPromptBody",{defaultMessage:"There are no endpoint exceptions. Create your first endpoint exception."}),on=i.i18n.translate("xpack.securitySolution.exceptions.allItems.emptyPromptButtonLabel",{defaultMessage:"Add rule exception"}),ln=i.i18n.translate("xpack.securitySolution.exceptions.allItems.endpoint.emptyPromptButtonLabel",{defaultMessage:"Add endpoint exception"}),cn=i.i18n.translate("xpack.securitySolution.exceptions.allItems.exceptionItemsFetchError",{defaultMessage:"Unable to load exception items"}),un=i.i18n.translate("xpack.securitySolution.exceptions.allItems.exceptionItemsFetchErrorDescription",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),dn=i.i18n.translate("xpack.securitySolution.exceptions.allItems.exceptionItemSearchErrorTitle",{defaultMessage:"Error searching"}),pn=i.i18n.translate("xpack.securitySolution.exceptions.allItems.exceptionItemSearchErrorBody",{defaultMessage:"An error occurred searching for exception items. Please try again."}),mn=i.i18n.translate("xpack.securitySolution.exceptions.allItems.exceptionDeleteErrorTitle",{defaultMessage:"Error deleting exception item"}),gn=i.i18n.translate("xpack.securitySolution.exceptions.allItems.paginationAriaLabel",{defaultMessage:"Exception item table pagination"}),fn=i.i18n.translate("xpack.securitySolution.exceptions.allItems.exceptionItemDeleteSuccessTitle",{defaultMessage:"Exception deleted"}),bn=i.i18n.translate("xpack.securitySolution.exceptions.allExceptionItems.exceptionEndpointDetailsDescription",{defaultMessage:"Endpoint exceptions are added to both the detection rule and the Elastic Endpoint agent on your hosts."}),hn=i.i18n.translate("xpack.securitySolution.exceptions.allExceptionItems.exceptionDetectionDetailsDescription",{defaultMessage:"Rule exceptions are added to the detection rule."}),yn=i.i18n.translate("xpack.securitySolution.exceptions.allExceptionItems.searchPlaceholder",{defaultMessage:'Filter exceptions using simple query syntax, for example, name:"my list"'}),En={strict:!0,fields:{created_by:{type:"string"},description:{type:"string"},id:{type:"string"},item_id:{type:"string"},list_id:{type:"string"},name:{type:"string"},os_types:{type:"string"},tags:{type:"string"}}},vn=({canAddException:e,listType:t,isSearching:a,onSearch:i,onAddExceptionClick:s})=>{const r=Object(l.useCallback)((({queryText:e})=>{i({search:e})}),[i]),o=Object(l.useCallback)((()=>{s(t)}),[s,t]),u=Object(l.useMemo)((()=>t===g.a.ENDPOINT?en.f:en.e),[t]);return c.a.createElement(n.EuiFlexGroup,{alignItems:"center"},c.a.createElement(n.EuiFlexItem,{grow:!0},c.a.createElement(n.EuiSearchBar,{box:{placeholder:yn,incremental:!0,schema:En,"data-test-subj":"exceptionsViewerSearchBar"},filters:[],onChange:r})),!e&&c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiButton,{"data-test-subj":"exceptionsHeaderAddExceptionBtn",onClick:o,isDisabled:a,fill:!0},u)))};vn.displayName="ExceptionsViewerSearchBarComponent";const kn=c.a.memo(vn);kn.displayName="ExceptionsViewerSearchBar";const Sn=({pagination:e,onPaginationChange:t})=>{var a;const i=Object(l.useCallback)((a=>{t({pagination:{page:e.pageIndex,perPage:a}})}),[t,e.pageIndex]),s=Object(l.useCallback)((a=>{t({pagination:{page:a,perPage:e.pageSize}})}),[t,e.pageSize]);return c.a.createElement(n.EuiTablePagination,{"aria-label":gn,pageCount:null!==(a=Math.ceil(e.totalItemCount/e.pageSize))&&void 0!==a?a:0,activePage:e.pageIndex,onChangePage:s,itemsPerPage:e.pageSize,onChangeItemsPerPage:i,itemsPerPageOptions:e.pageSizeOptions,"data-test-subj":"allExceptionItemsPagination"})};Sn.displayName="ExceptionsViewerPaginationComponent";const Tn=c.a.memo(Sn);Tn.displayName="ExceptionsViewerPagination";const xn=m.a.span.withConfig({displayName:"StyledText",componentId:"sc-kgjjyi-0"})(["font-weight:bold;"]),wn=m()(n.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"sc-kgjjyi-1"})(["height:50px;"]),On=m.a.span.withConfig({displayName:"StyledCondition",componentId:"sc-kgjjyi-2"})(["display:inline-block !important;vertical-align:middle !important;"]),jn=({pagination:e,lastUpdated:t})=>c.a.createElement(wn,{alignItems:"center",justifyContent:"spaceBetween"},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(zt.a,null,c.a.createElement(zt.d,null,c.a.createElement(zt.c,null,c.a.createElement(zt.e,{dataTestSubj:"exceptionsShowing"},c.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.paginationDetails",defaultMessage:"Showing {partOne} of {partTwo}",values:{partOne:c.a.createElement(xn,null,`1-${Math.min(e.pageSize,e.totalItemCount)}`),partTwo:c.a.createElement(xn,null,`${e.totalItemCount}`)}})))))),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiText,{size:"s","data-test-subj":"exceptionsViewerLastUpdated"},c.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.lastUpdated",defaultMessage:"Updated {updated}",values:{updated:c.a.createElement(On,null,c.a.createElement(T.b,{value:t,tooltipAnchorClassName:"eui-textTruncate"}))}}))));jn.displayName="ExceptionsViewerUtilityComponent";const In=c.a.memo(jn);In.displayName="ExceptionsViewerUtility";var Cn=a(424);const Mn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.editItemButton",{defaultMessage:"Edit rule exception"}),Dn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.deleteItemButton",{defaultMessage:"Delete rule exception"}),An=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.endpoint.editItemButton",{defaultMessage:"Edit endpoint exception"}),Fn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.endpoint.deleteItemButton",{defaultMessage:"Delete endpoint exception"}),Rn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.createdLabel",{defaultMessage:"Created"}),Pn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.updatedLabel",{defaultMessage:"Updated"}),_n=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.metaDetailsBy",{defaultMessage:"by"}),qn=e=>i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.showCommentsLabel",{values:{comments:e},defaultMessage:"Show {comments, plural, =1 {comment} other {comments}} ({comments})"}),Nn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.matchOperator",{defaultMessage:"IS"}),Ln=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),Bn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),zn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),Hn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.nestedOperator",{defaultMessage:"has"}),$n=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.matchAnyOperator",{defaultMessage:"is one of"}),Vn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),Un=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.existsOperator",{defaultMessage:"exists"}),Qn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.existsOperator.not",{defaultMessage:"does not exist"}),Wn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.listOperator",{defaultMessage:"included in"}),Gn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.listOperator.not",{defaultMessage:"is not included in"}),Kn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.and",{defaultMessage:"AND"}),Jn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.os",{defaultMessage:"OS"}),Yn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.windows",{defaultMessage:"Windows"}),Xn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.linux",{defaultMessage:"Linux"}),Zn=i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.conditions.macos",{defaultMessage:"Mac"}),ei=Object(l.memo)((({item:e,actions:t,disableActions:a=!1,dataTestSubj:i})=>{const[s,r]=Object(l.useState)(!1),o=()=>r(!1),u=Object(l.useMemo)((()=>t.map((e=>c.a.createElement(n.EuiContextMenuItem,{"data-test-subj":`${i}-actionItem-${e.key}`,key:e.key,icon:e.icon,onClick:()=>{o(),e.onClick()}},e.label)))),[i,t]);return c.a.createElement(n.EuiFlexGroup,{"data-test-subj":i,justifyContent:"spaceBetween"},c.a.createElement(n.EuiFlexItem,{grow:9},c.a.createElement(n.EuiTitle,{size:"xs",textTransform:"uppercase","data-test-subj":`${i}-title`},c.a.createElement("h3",null,e.name))),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiPopover,{button:c.a.createElement(n.EuiButtonIcon,{isDisabled:a,"aria-label":"Exception item actions menu",iconType:"boxesHorizontal",onClick:()=>r((e=>!e)),"data-test-subj":`${i}-actionButton`}),panelPaddingSize:"none",isOpen:s,closePopover:o,"data-test-subj":`${i}-items`},c.a.createElement(n.EuiContextMenuPanel,{size:"s",items:u}))))}));ei.displayName="ExceptionItemCardHeader";var ti=a(360);const ai=m.a.div.withConfig({displayName:"Container",componentId:"sc-hgc2b-0"})(["display:inline;margin-left:",";"],(({theme:e})=>`${e.eui.euiSizeXS}`)),ni=({value:e,tooltipIconType:t="iInCircle",tooltipIconText:a})=>{const{showSpaceWarningIcon:i,warningText:s}=(({value:e,tooltipIconText:t})=>({showSpaceWarningIcon:!!(Array.isArray(e)?e.find(ti.d):Object(ti.d)(e)),warningText:t||ti.c.FIELD_SPACE_WARNING}))({value:e,tooltipIconText:a});return i&&e?c.a.createElement(ai,null,c.a.createElement(n.EuiToolTip,{position:"top",content:s},c.a.createElement(n.EuiIcon,{"data-test-subj":"value_with_space_warning_tooltip",type:t,color:"warning"}))):null},ii=Object.freeze({linux:Xn,mac:Zn,macos:Zn,windows:Yn}),si=Object.freeze({[g.c.NESTED]:Hn,[g.c.MATCH_ANY]:$n,[g.c.MATCH]:Nn,[g.c.WILDCARD]:Bn,[g.c.EXISTS]:Un,[g.c.LIST]:Wn}),ri=Object.freeze({[g.c.MATCH_ANY]:Vn,[g.c.MATCH]:Ln,[g.c.WILDCARD]:zn,[g.c.EXISTS]:Qn,[g.c.LIST]:Gn}),oi=m()(n.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupNested",componentId:"sc-ob4wzw-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeXL)),li=m()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemNested",componentId:"sc-ob4wzw-1"})(["margin-bottom:6px !important;margin-top:6px !important;"]),ci=m()("span").withConfig({displayName:"StyledCondition",componentId:"sc-ob4wzw-2"})(["margin-right:6px;"]),ui=m()(n.EuiPanel).withConfig({displayName:"StyledConditionContent",componentId:"sc-ob4wzw-3"})(["border:1px;border-color:#d3dae6;border-style:solid;"]),di=Object(l.memo)((({os:e,entries:t,dataTestSubj:a})=>{const i=Object(l.useMemo)((()=>null!=e&&e.length>0?e.map((e=>{var t;return null!==(t=ii[e])&&void 0!==t?t:e})).join(", "):null),[e]),s=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map((e=>c.a.createElement(n.EuiBadge,{color:"hollow"},e))):null!=t?t:"",r=(e,t)=>{var a,n;return"nested"===e?"":"included"===t?null!==(a=si[e])&&void 0!==a?a:e:null!==(n=ri[e])&&void 0!==n?n:e},o=Object(l.useCallback)(((e,t)=>{if("nested"===e&&t.length)return t.map((e=>{const{field:t,type:i,operator:o}=e,l="value"in e?e.value:"";return c.a.createElement(oi,{"data-test-subj":`${a}-nestedCondition`,key:t+i+l,direction:"row",alignItems:"center",gutterSize:"m",responsive:!1},c.a.createElement(li,{grow:!1},c.a.createElement(n.EuiToken,{iconType:"tokenNested",size:"s"})),c.a.createElement(li,{grow:!1},c.a.createElement(n.EuiExpression,{description:"",value:t,color:"subdued"})),c.a.createElement(li,{grow:!1},c.a.createElement(n.EuiExpression,{description:r(i,o),value:s(i,l)})),c.a.createElement(ni,{value:l}))}))}),[a]),u=Object(l.useCallback)((e=>"list"===e.type?e.list.id:"value"in e?e.value:""),[]);return c.a.createElement(ui,{color:"subdued",hasBorder:!0,hasShadow:!1,"data-test-subj":a},null!=i&&c.a.createElement("div",{"data-test-subj":`${a}-os`},c.a.createElement("strong",null,c.a.createElement(n.EuiExpression,{description:"",value:Jn}),c.a.createElement(n.EuiExpression,{description:Nn,value:i}))),t.map(((e,t)=>{const{field:i,type:l}=e,d=u(e),p="entries"in e?e.entries:[],m="operator"in e?e.operator:"";return c.a.createElement("div",{"data-test-subj":`${a}-condition`,key:i+l+d+t},c.a.createElement("div",{className:"eui-xScroll"},c.a.createElement(n.EuiExpression,{description:0===t?"":c.a.createElement(ci,null,Kn),value:i,color:0===t?"primary":"subdued"}),c.a.createElement(n.EuiExpression,{description:r(l,m),value:s(l,d)}),c.a.createElement(ni,{value:d})),null!=p&&o(l,p))})))}));di.displayName="ExceptionItemCardConditions";var pi=a(204);const mi=m()(n.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-16r4vsz-0"})(["border-right:1px solid #d3dae6;padding:4px 12px 4px 0;"]),gi=Object(l.memo)((({item:e,references:t,dataTestSubj:a})=>{var s;const[r,o]=Object(l.useState)(!1),u=Object(l.useMemo)((()=>null==t?[]:t.map((e=>c.a.createElement(n.EuiContextMenuItem,{"data-test-subj":`${a}-actionItem-${e.id}`,key:e.id},c.a.createElement(n.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},c.a.createElement(pi.k,{"data-test-subj":"ruleName",deepLinkId:re.uc.rules,path:Object(x.c)(e.id,ps.alerts)},e.name)))))),[t,a]);return c.a.createElement(n.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s","data-test-subj":a},c.a.createElement(mi,{grow:!1},c.a.createElement(fi,{fieldName:"created_by",label:Rn,value1:c.a.createElement(T.a,{fieldName:"created_at",value:e.created_at}),value2:e.created_by,dataTestSubj:`${a}-createdBy`})),c.a.createElement(mi,{grow:!1},c.a.createElement(fi,{fieldName:"updated_by",label:Pn,value1:c.a.createElement(T.a,{fieldName:"updated_at",value:e.updated_at}),value2:e.updated_by,dataTestSubj:`${a}-updatedBy`})),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiPopover,{button:c.a.createElement(n.EuiButtonEmpty,{onClick:()=>o((e=>!e)),iconType:"list","data-test-subj":`${a}-affectedRulesButton`},(d=null!==(s=null==t?void 0:t.length)&&void 0!==s?s:0,i.i18n.translate("xpack.securitySolution.exceptions.exceptionItem.affectedRules",{values:{numRules:d},defaultMessage:"Affects {numRules} {numRules, plural, =1 {rule} other {rules}}"}))),panelPaddingSize:"none",isOpen:r,closePopover:()=>o(!1),"data-test-subj":`${a}-items`},c.a.createElement(n.EuiContextMenuPanel,{size:"s",items:u}))));var d}));gi.displayName="ExceptionItemCardMetaInfo";const fi=Object(l.memo)((({label:e,value1:t,value2:a,dataTestSubj:i})=>c.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!1,responsive:!1},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiText,{size:"xs",style:{fontFamily:"Inter"}},e)),c.a.createElement(n.EuiFlexItem,{grow:!1,"data-test-subj":`${i}-value1`},c.a.createElement(n.EuiBadge,{color:"default",style:{fontFamily:"Inter"}},t)),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiText,{size:"xs",style:{fontFamily:"Inter"}},_n)),c.a.createElement(n.EuiFlexItem,{grow:!1,"data-test-subj":`${i}-value2`},c.a.createElement(n.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center",wrap:!1},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiBadge,{color:"hollow",style:{fontFamily:"Inter"}},a)))))));fi.displayName="MetaInfoDetails";const bi=Object(l.memo)((({comments:e})=>{const{euiTheme:t}=Object(n.useEuiTheme)();return c.a.createElement(n.EuiFlexItem,null,c.a.createElement(n.EuiAccordion,{id:"exceptionItemCardComments",buttonContent:c.a.createElement(n.EuiText,{size:"s",style:{color:t.colors.primary}},qn(e.length)),arrowDisplay:"none","data-test-subj":"exceptionsViewerCommentAccordion"},c.a.createElement(n.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"m"},c.a.createElement(n.EuiCommentList,{comments:e}))))}));bi.displayName="ExceptionItemCardComments";const hi=({disableActions:e,exceptionItem:t,listType:a,ruleReferences:i,onDeleteException:s,onEditException:r,dataTestSubj:o})=>{const u=Object(l.useCallback)((()=>{s({id:t.id,name:t.name,namespaceType:t.namespace_type})}),[s,t.id,t.name,t.namespace_type]),d=Object(l.useCallback)((()=>{r(t)}),[r,t]),p=Object(l.useMemo)((()=>Object(Cn.j)(t.comments)),[t.comments]);return c.a.createElement(n.EuiPanel,{paddingSize:"l","data-test-subj":o,hasBorder:!0,hasShadow:!1},c.a.createElement(n.EuiFlexGroup,{gutterSize:"m",direction:"column"},c.a.createElement(n.EuiFlexItem,{"data-test-subj":`${o}-header`},c.a.createElement(ei,{item:t,actions:[{key:"edit",icon:"controlsHorizontal",label:a===g.a.ENDPOINT?An:Mn,onClick:d},{key:"delete",icon:"trash",label:a===g.a.ENDPOINT?Fn:Dn,onClick:u}],disableActions:e,dataTestSubj:"exceptionItemCardHeader"})),c.a.createElement(n.EuiFlexItem,{"data-test-subj":`${o}-meta`},c.a.createElement(gi,{item:t,references:i,dataTestSubj:"exceptionItemCardMetaInfo"})),c.a.createElement(n.EuiFlexItem,null,c.a.createElement(di,{os:t.os_types,entries:t.entries,dataTestSubj:"exceptionItemCardConditions"})),p.length>0&&c.a.createElement(bi,{comments:p})))};hi.displayName="ExceptionItemCardComponent";const yi=c.a.memo(hi);yi.displayName="ExceptionItemCard";var Ei=a(864),vi=a.n(Ei);const ki=({isReadOnly:e,listType:t,currentState:a,onCreateExceptionListItem:i})=>{const{euiTheme:s}=Object(n.useEuiTheme)(),r=Object(l.useMemo)((()=>{switch(a){case"error":return c.a.createElement(n.EuiEmptyPrompt,{color:"danger",iconType:"alert",title:c.a.createElement("h2",null,cn),body:c.a.createElement("p",null,un),"data-test-subj":"exceptionItemViewerEmptyPrompts-error"});case"empty":return c.a.createElement(n.EuiEmptyPrompt,{color:"subdued",iconType:"plusInCircle",iconColor:s.colors.darkestShade,title:c.a.createElement("h2",{"data-test-subj":"exceptionsEmptyPromptTitle"},nn),body:c.a.createElement("p",{"data-test-subj":"exceptionsEmptyPromptBody"},t===g.a.ENDPOINT?rn:sn),actions:[c.a.createElement(n.EuiButton,{"data-test-subj":"exceptionsEmptyPromptButton",onClick:i,iconType:"plusInCircle",color:"primary",isDisabled:e,fill:!0},t===g.a.ENDPOINT?ln:on)],"data-test-subj":`exceptionItemViewerEmptyPrompts-empty-${t}`});case"empty_search":return c.a.createElement(n.EuiEmptyPrompt,{color:"plain",layout:"horizontal",hasBorder:!0,hasShadow:!1,icon:c.a.createElement(n.EuiImage,{size:"fullWidth",alt:"",url:vi.a}),title:c.a.createElement("h3",null,tn),body:c.a.createElement("p",null,an),"data-test-subj":"exceptionItemViewerEmptyPrompts-emptySearch"});default:return c.a.createElement(n.EuiLoadingContent,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"})}}),[a,s.colors.darkestShade,e,t,i]);return c.a.createElement(n.EuiPanel,{hasShadow:!1,hasBorder:!1,color:"empty_search"===a?"subdued":"transparent",style:{margin:`${s.size.l} 0`,padding:`${s.size.l} 0`}},r)},Si=c.a.memo(ki);Si.displayName="ExeptionItemsViewerEmptyPrompts";const Ti=m()(n.EuiFlexItem).withConfig({displayName:"MyFlexItem",componentId:"sc-1ti6dq3-0"})(["margin:",";&:first-child{margin:",";}"],(({theme:e})=>`${e.eui.euiSize} 0`),(({theme:e})=>`${e.eui.euiSizeXS} 0 ${e.eui.euiSize}`)),xi=({isReadOnly:e,exceptions:t,listType:a,disableActions:i,ruleReferences:s,viewerState:r,onCreateExceptionListItem:o,onDeleteException:l,onEditExceptionItem:u})=>c.a.createElement(c.a.Fragment,null,null!=r&&"deleting"!==r?c.a.createElement(Si,{isReadOnly:e,listType:a,currentState:r,onCreateExceptionListItem:o}):c.a.createElement(n.EuiFlexGroup,{direction:"column",className:"eui-yScrollWithShadows"},c.a.createElement(n.EuiFlexItem,{grow:!1,className:"eui-yScrollWithShadows"},c.a.createElement(n.EuiFlexGroup,{"data-test-subj":"exceptionsContainer",gutterSize:"none",direction:"column"},t.map((e=>c.a.createElement(Ti,{"data-test-subj":"exceptionItemContainer",grow:!1,key:e.id},c.a.createElement(yi,{disableActions:i,exceptionItem:e,listType:a,ruleReferences:null!=s?s[e.list_id]:[],onDeleteException:l,onEditException:u,dataTestSubj:"exceptionItemsViewerItem"}))))))));xi.displayName="ExceptionItemsViewerComponent";const wi=c.a.memo(xi);wi.displayName="ExceptionsViewerItems";var Oi=a(192),ji=a(617),Ii=a(262),Ci=a(316),Mi=a(345),Di=a(761);const Ai=i.i18n.translate("xpack.securitySolution.exceptions.editException.cancel",{defaultMessage:"Cancel"}),Fi=i.i18n.translate("xpack.securitySolution.exceptions.editException.editExceptionSaveButton",{defaultMessage:"Save"}),Ri=i.i18n.translate("xpack.securitySolution.exceptions.editException.editExceptionTitle",{defaultMessage:"Edit Rule Exception"}),Pi=i.i18n.translate("xpack.securitySolution.exceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit Endpoint Exception"}),_i=i.i18n.translate("xpack.securitySolution.exceptions.editException.success",{defaultMessage:"Successfully updated exception"}),qi=i.i18n.translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by this rule"}),Ni=i.i18n.translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"}),Li=i.i18n.translate("xpack.securitySolution.exceptions.editException.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."}),Bi=i.i18n.translate("xpack.securitySolution.exceptions.editException.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"}),zi=i.i18n.translate("xpack.securitySolution.exceptions.editException.versionConflictTitle",{defaultMessage:"Sorry, there was an error"}),Hi=i.i18n.translate("xpack.securitySolution.exceptions.editException.versionConflictDescription",{defaultMessage:"It appears this exception was updated since you first selected to edit it. Try clicking 'Cancel' and editing the exception again."}),$i=i.i18n.translate("xpack.securitySolution.exceptions.editException.sequenceWarning",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."});var Vi=a(894),Ui=a(655),Qi=a(249),Wi=a(895),Gi=a(762);const Ki=m()(n.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-18pz2hd-0"})(["",""],(({theme:e})=>Object(p.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),Ji=m.a.div.withConfig({displayName:"FlyoutSubtitle",componentId:"sc-18pz2hd-1"})(["",""],(({theme:e})=>Object(p.css)(["color:",";"],e.eui.euiColorMediumShade))),Yi=m.a.section.withConfig({displayName:"FlyoutBodySection",componentId:"sc-18pz2hd-2"})(["",""],(({theme:e})=>Object(p.css)(["padding:"," ",";"],e.eui.euiSizeS,e.eui.euiSizeL))),Xi=m.a.section.withConfig({displayName:"FlyoutCheckboxesSection",componentId:"sc-18pz2hd-3"})(["overflow-y:inherit;height:auto;.euiFlyoutBody__overflowContent{padding-top:0;}"]),Zi=m()(n.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-18pz2hd-4"})(["",""],(({theme:e})=>Object(p.css)(["padding:",";"],e.eui.euiSizeS))),es=Object(l.memo)((function({ruleName:e,ruleId:t,ruleIndices:a,dataViewId:i,exceptionItem:s,exceptionListType:r,onCancel:o,onConfirm:u,onRuleChange:d}){const{http:p,unifiedSearch:m,data:g}=Object(v.k)().services,[f,b]=Object(l.useState)(""),[h,y]=Object(l.useState)(!1),{rule:E,loading:k}=Object(Di.a)(t),[S,T]=Object(l.useState)(null),[x,w]=Object(l.useState)(!1),[O,j]=Object(l.useState)(!1),[I,C]=Object(l.useState)(!1),[M,D]=Object(l.useState)([]),{addError:A,addSuccess:F}=Object(le.a)(),{loading:R,signalIndexName:P}=Object(Mi.a)(),_=Object(l.useMemo)((()=>null!==P?[P]:[]),[P]),[q,{indexPatterns:N}]=Object(Ci.b)(_),{mlJobLoading:L,ruleIndices:B}=Object(ji.a)(null==E?void 0:E.machine_learning_job_id,a),z=i||(null==E?void 0:E.data_view_id)||null,[H,$]=Object(l.useState)(null);Object(l.useEffect)((()=>{(async()=>{if(z){const e=await g.dataViews.get(z);$(e)}})()}),[z,g.dataViews,$]);const[V,{indexPatterns:U}]=Object(Ci.b)(z?[]:B),Q=Object(l.useMemo)((()=>z?H:U),[z,H,U]),W=Object(l.useCallback)(((e,t,a)=>{e.message.includes("Conflict")?w(!0):T({reason:e.message,code:t,details:a,listListId:s.list_id})}),[T,w,s.list_id]),G=Object(l.useCallback)((e=>{F(en.m(e)),d&&d(),o()}),[F,o,d]),K=Object(l.useCallback)((e=>{A(e,{title:en.l}),o()}),[A,o]),J=Object(l.useCallback)((()=>{F(_i),u()}),[F,u]),[{isLoading:Y},X]=Object(Vi.a)({http:p,onSuccess:J,onError:W});Object(l.useEffect)((()=>{!1===q&&!1===R&&C(Object(Cn.f)(M)||Object(Cn.g)(M,N)||M.every((e=>0===e.entries.length)))}),[C,M,q,R,N]),Object(l.useEffect)((()=>{!0===I&&j(!1)}),[I]);const Z=Object(l.useMemo)((()=>M.every((e=>0===e.entries.length))||x||h),[M,x,h]),ee=Object(l.useCallback)((({exceptionItems:e,errorExists:t})=>{D(e),y(t)}),[D]),te=Object(l.useCallback)((e=>{b(e)}),[b]),ae=Object(l.useCallback)((e=>{j(e.currentTarget.checked)}),[j]),ne=Object(l.useCallback)((()=>{const[e]=M;let t=[{...Object(Cn.d)(e,[...s.comments,...""!==f.trim()?[{comment:f}]:[]])}];return"endpoint"===r&&(t=Object(Cn.k)(Object(Cn.c)(t,s.os_types))),t}),[M,s,f,r]),ie=Object(l.useCallback)((()=>{if(null!==X){var e;const t=O&&null!==P?[P]:void 0;X(null!==(e=null==E?void 0:E.rule_id)&&void 0!==e?e:"",ne(),void 0,t)}}),[X,E,ne,O,P]),se=Object(l.useMemo)((()=>null!=E&&Object(Ii.b)(E.type)&&Object(Ii.a)(E.query)),[E]),re=Object(l.useMemo)((()=>null!=E&&Gi.a.includes(E.type)),[E]);return c.a.createElement(n.EuiFlyout,{size:"l",onClose:o,"data-test-subj":"edit-exception-flyout"},c.a.createElement(Ki,null,c.a.createElement(n.EuiTitle,null,c.a.createElement("h2",{"data-test-subj":"exception-flyout-title"},"endpoint"===r?Pi:Ri)),c.a.createElement(n.EuiSpacer,{size:"xs"}),c.a.createElement(Ji,{className:"eui-textTruncate",title:e}),c.a.createElement(n.EuiSpacer,{size:"m"})),(Y||V||R)&&c.a.createElement(Qi.a,{"data-test-subj":"loadingEditExceptionFlyout",size:"xl"}),!R&&null!=Q&&!Y&&!V&&!k&&!L&&c.a.createElement(n.EuiFlyoutBody,null,c.a.createElement(Yi,{className:"builder-section"},se&&c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiCallOut,{"data-test-subj":"eql-sequence-callout",title:$i}),c.a.createElement(n.EuiSpacer,null)),c.a.createElement(n.EuiText,null,Bi),c.a.createElement(n.EuiSpacer,null),"endpoint"===r&&c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiText,{size:"xs"},c.a.createElement("dl",null,c.a.createElement("dt",null,en.q),c.a.createElement("dd",null,s.os_types.reduce(((e,t)=>`${(e=>"linux"===e?en.r:"macos"===e?en.s:en.t)(t)}, ${e}`),"").slice(0,-2)))),c.a.createElement(n.EuiSpacer,null)),Object(Oi.getExceptionBuilderComponentLazy)({allowLargeValueLists:re,httpService:p,autocompleteService:m.autocomplete,exceptionListItems:[s],listType:r,listId:s.list_id,listNamespaceType:s.namespace_type,listTypeSpecificIndexPatternFilter:Cn.h,ruleName:e,isOrDisabled:!0,isAndDisabled:!1,osTypes:s.os_types,isNestedDisabled:!1,dataTestSubj:"edit-exception-builder",idAria:"edit-exception-builder",onChange:ee,indexPatterns:Q}),c.a.createElement(n.EuiSpacer,null),c.a.createElement(Ui.a,{exceptionItemComments:s.comments,newCommentValue:f,newCommentOnChange:te})),c.a.createElement(n.EuiHorizontalRule,null),c.a.createElement(Xi,null,c.a.createElement(n.EuiFormRow,{fullWidth:!0},c.a.createElement(n.EuiCheckbox,{"data-test-subj":"close-alert-on-add-edit-exception-checkbox",id:"close-alert-on-add-edit-exception-checkbox",label:I?Ni:qi,checked:O,onChange:ae,disabled:I})),"endpoint"===r&&c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiSpacer,{size:"s"}),c.a.createElement(n.EuiText,{"data-test-subj":"edit-exception-endpoint-text",color:"subdued",size:"s"},Li)))),c.a.createElement(n.EuiFlyoutFooter,null,x&&c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiCallOut,{title:zi,color:"danger",iconType:"alert","data-test-subj":"exceptionsFlyoutVersionConflict"},c.a.createElement("p",null,Hi)),c.a.createElement(n.EuiSpacer,{size:"m"})),null!=S&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Wi.a,{http:p,errorInfo:S,rule:E,onCancel:o,onSuccess:G,onError:K}),c.a.createElement(n.EuiSpacer,{size:"m"})),null===S&&c.a.createElement(Zi,{justifyContent:"spaceBetween"},c.a.createElement(n.EuiButtonEmpty,{"data-test-subj":"cancelExceptionAddButton",onClick:o},Ai),c.a.createElement(n.EuiButton,{"data-test-subj":"edit-exception-confirm-button",onClick:ie,isLoading:Y,isDisabled:Z,fill:!0},Fi))))}));var ts=a(885),as=a(244);const ns=m()(n.EuiText).withConfig({displayName:"StyledText",componentId:"sc-e71zkm-0"})(["font-style:italic;"]),is=["error","empty"],ss=["loading","empty_search","empty","error","searching"],rs={pagination:{pageIndex:0,pageSize:25,totalItemCount:0,pageSizeOptions:[5,10,25,50,100,200,300]},exceptions:[],exceptionToEdit:null,currenFlyout:null,viewerState:"loading",isReadOnly:!0,lastUpdated:Date.now()},os=({rule:e,listType:t,isViewReadOnly:a,onRuleChange:s})=>{var r,o;const{services:u}=Object(v.k)(),d=Object(v.o)(),[{canUserCRUD:p,hasIndexWrite:m}]=Object(J.b)(),f=Object(l.useMemo)((()=>null!=e&&null!=e.exceptions_list?e.exceptions_list.filter((e=>e.type===t)):[]),[t,e]),[{exceptions:b,pagination:h,currenFlyout:y,exceptionToEdit:E,viewerState:k,isReadOnly:S,lastUpdated:T},x]=Object(l.useReducer)(((e,t)=>{switch(t.type){case"setExceptions":{var a;const{exceptions:n,pagination:i}=t;return{...e,pagination:{...e.pagination,pageIndex:i.page-1,pageSize:i.perPage,totalItemCount:null!==(a=i.total)&&void 0!==a?a:0},exceptions:n}}case"updateExceptionToEdit":{const{exception:a}=t;return{...e,exceptionToEdit:a}}case"updateFlyoutOpen":return{...e,currenFlyout:t.flyoutType};case"setViewerState":return{...e,viewerState:t.state};case"setIsReadOnly":return{...e,isReadOnly:t.readOnly};case"setLastUpdateTime":return{...e,lastUpdated:t.lastUpdate};default:return e}}),{...rs}),w=Object(l.useCallback)((e=>{x({type:"setLastUpdateTime",lastUpdate:e})}),[x]),O=Object(l.useCallback)((({exceptions:e,pagination:t})=>{w(Date.now()),x({type:"setExceptions",exceptions:e,pagination:t})}),[x,w]),j=Object(l.useCallback)((e=>{x({type:"setViewerState",state:e})}),[x]),I=Object(l.useCallback)((e=>{x({type:"updateFlyoutOpen",flyoutType:e})}),[x]),C=Object(l.useCallback)((e=>{x({type:"setIsReadOnly",readOnly:e})}),[x]),[M,D,A]=(e=>{const t=Object(v.o)(),[a,n]=Object(l.useState)(!1),[i,s]=Object(l.useState)(!1),[r,o]=Object(l.useState)(null),c=Object(l.useMemo)((()=>e.map((e=>({id:e.id,listId:e.list_id,namespaceType:e.namespace_type})))),[e]);return Object(l.useEffect)((()=>{let e=!0;const a=new AbortController;return 0===c.length&&e?(s(!1),n(!1),o(null)):(async()=>{try{n(!0);const{references:t}=await Object(as.g)({lists:c,signal:a.signal}),i=t.reduce(((e,t)=>{const[[a,n]]=Object.entries(t);return e[a]=n,e}),{});e&&(s(!1),n(!1),o(i))}catch(a){e&&(s(!0),n(!1),t.addError(a,{title:en.o}))}})(),()=>{e=!1,a.abort()}}),[e,c,t]),[a,i,r]})(f);Object(l.useEffect)((()=>{D?j("error"):null==k&&M?j("loading"):"loading"!==k||M||j(null)}),[M,D,j,k]);const F=Object(l.useCallback)((async e=>{var t;const a=new AbortController,n=null!=(null==e?void 0:e.pagination)?{page:(null!==(t=e.pagination.page)&&void 0!==t?t:0)+1,perPage:e.pagination.perPage}:{page:h.pageIndex+1,perPage:h.pageSize};if(0===f.length)return{data:[],pageIndex:h.pageIndex,itemsPerPage:h.pageSize,total:0};const{page:i,per_page:s,total:r,data:o}=await Object(Za.m)({filter:void 0,http:u.http,listIds:f.map((e=>e.list_id)),namespaceTypes:f.map((e=>e.namespace_type)),search:null==e?void 0:e.search,pagination:n,signal:a.signal});return{data:o.map((e=>Object(Xa.b)(e))),pageIndex:i,itemsPerPage:s,total:r}}),[h.pageIndex,h.pageSize,f,u.http]),R=Object(l.useCallback)((async e=>{try{const{pageIndex:t,itemsPerPage:a,total:n,data:i}=await F(e);O({exceptions:i,pagination:{page:t,perPage:a,total:n}}),j(n>0?null:"empty")}catch(e){j("error"),d.addError(e,{title:cn,toastMessage:un})}}),[F,O,j,d]),P=Object(l.useCallback)((async e=>{try{j("searching");const{pageIndex:t,itemsPerPage:a,total:n,data:i}=await F(e);j(n>0?null:"empty_search"),O({exceptions:i,pagination:{page:t,perPage:a,total:n}})}catch(e){d.addError(e,{title:dn,toastMessage:pn})}}),[F,O,j,d]),_=Object(l.useCallback)((()=>{I("addException")}),[I]),q=Object(l.useCallback)((e=>{x({type:"updateExceptionToEdit",exception:e}),I("editException")}),[I]),N=Object(l.useCallback)((()=>{I(null),R()}),[I,R]),L=Object(l.useCallback)((()=>{I(null),R()}),[I,R]),B=Object(l.useCallback)((async({id:e,name:t,namespaceType:a})=>{const n=new AbortController;try{j("deleting"),await Object(Za.f)({http:u.http,id:e,namespaceType:a,signal:n.signal}),d.addSuccess({title:fn,text:(s=t,i.i18n.translate("xpack.securitySolution.exceptions.allItems.exceptionItemDeleteSuccessText",{values:{itemName:s},defaultMessage:'"{itemName}" deleted successfully.'}))}),await R()}catch(e){j("error"),d.addError(e,{title:mn})}var s}),[R,u.http,j,d]);return Object(l.useEffect)((()=>{C(a||!p||!m)}),[C,a,p,m]),Object(l.useEffect)((()=>{f.length>0?R():j("empty")}),[f.length,R,j]),c.a.createElement(c.a.Fragment,null,"editException"===y&&null!=E&&null!=e&&c.a.createElement(es,{ruleName:e.name,ruleId:e.id,ruleIndices:null!==(r=e.index)&&void 0!==r?r:re.R,dataViewId:e.data_view_id,exceptionListType:t,exceptionItem:E,onCancel:N,onConfirm:L,onRuleChange:s,"data-test-subj":"editExceptionItemFlyout"}),"addException"===y&&null!=e&&c.a.createElement(ts.a,{ruleName:e.name,ruleIndices:null!==(o=e.index)&&void 0!==o?o:re.R,dataViewId:e.data_view_id,ruleId:e.id,exceptionListType:t,onCancel:N,onConfirm:L,onRuleChange:s,"data-test-subj":"addExceptionItemFlyout"}),c.a.createElement(n.EuiPanel,{hasBorder:!1,hasShadow:!1},c.a.createElement(c.a.Fragment,null,c.a.createElement(ns,{size:"s"},t===g.a.ENDPOINT?bn:hn),c.a.createElement(n.EuiSpacer,{size:"l"}),!is.includes(k)&&c.a.createElement(kn,{canAddException:S,listType:t,isSearching:"searching"===k,onSearch:P,onAddExceptionClick:_}),!ss.includes(k)&&c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiSpacer,{size:"l"}),c.a.createElement(In,{pagination:h,lastUpdated:T})),c.a.createElement(wi,{isReadOnly:S,disableActions:S||"deleting"===k,exceptions:b,listType:t,ruleReferences:A,viewerState:k,onDeleteException:B,onEditExceptionItem:q,onCreateExceptionListItem:_}),!ss.includes(k)&&c.a.createElement(Tn,{onPaginationChange:R,pagination:h}))))};os.displayName="ExceptionsViewerComponent";const ls=c.a.memo(os);function cs({ruleId:e,disabled:t=!1,disabledReason:a}){const{application:{navigateToApp:i}}=Object(v.k)().services,s=Object(l.useCallback)((t=>{t.preventDefault(),i(re.A,{deepLinkId:Se.a.rules,path:Object(x.b)(e)})}),[i,e]);return c.a.createElement(n.EuiToolTip,{position:"top",content:a},c.a.createElement(pi.l,{"data-test-subj":"editRuleSettingsLink",onClick:s,iconType:"controlsHorizontal",isDisabled:t,deepLinkId:Se.a.rules,path:Object(x.b)(e)},ge.Bb))}ls.displayName="ExceptionsViewer";const us=m.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-ycgey0-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),ds=m.a.div.withConfig({displayName:"StyledMinHeightTabContainer",componentId:"sc-ycgey0-1"})(["min-height:800px;"]);let ps;!function(e){e.alerts="alerts",e.exceptions="rule_exceptions",e.endpointExceptions="endpoint_exceptions",e.executionResults="execution_results",e.executionEvents="execution_events"}(ps||(ps={}));const ms={[ps.alerts]:_a.a,[ps.exceptions]:za,[ps.endpointExceptions]:Ha,[ps.executionResults]:$a,[ps.executionEvents]:Va},gs=({clearEventsDeleted:e,clearEventsLoading:t,clearSelected:a})=>{var p,m,C,M,D;const{data:A,application:{navigateToApp:F,capabilities:{actions:R}},timelines:P,spaces:_}=Object(v.k)().services,q=Object(d.useDispatch)(),N=Object(l.useRef)(null),L=Object(l.useMemo)((()=>Oe.b.getTimelineByIdSelector()),[]),B=Object(E.b)((e=>{var t;return(null!==(t=L(e,k.i.detectionsRulesDetailsPage))&&void 0!==t?t:je.a).graphEventId})),z=Object(E.b)((e=>{var t;return(null!==(t=L(e,k.i.detectionsRulesDetailsPage))&&void 0!==t?t:je.a).updated})),H=Object(E.b)((e=>{var t;return(null!==(t=L(e,k.i.detectionsPage))&&void 0!==t?t:je.a).isLoading})),$=Object(l.useMemo)((()=>ie.d.globalFiltersQuerySelector()),[]),V=Object(l.useMemo)((()=>ie.d.globalQuerySelector()),[]),U=Object(E.a)(V),Q=Object(E.a)($),{to:oe,from:le}=Object(ne.a)(),[{loading:ce,isSignalIndexExists:ue,isAuthenticated:de,hasEncryptionKey:me,canUserCRUD:fe,hasIndexWrite:be,hasIndexRead:he,hasIndexMaintenance:De,signalIndexName:Ae}]=Object(J.b)(),{loading:Re,needsConfiguration:Pe}=Object(j.a)(),{indexPattern:_e,runtimeMappings:qe,loading:Ne}=Object(Ie.d)(Ce.SourcererScopeName.detections),Le=ce||Re,{detailName:Be}=Object(u.useParams)(),{rule:ze,refresh:He,loading:$e,isExistingRule:Ve}=Object(Ga.a)(Be),{pollForSignalIndex:Ue}=Object(Ja.a)(),[Qe,We]=Object(l.useState)(null),Ge=$e&&null==Qe,Ke=Object(l.useMemo)((()=>({[ps.alerts]:{id:ps.alerts,name:ms[ps.alerts],disabled:!1,href:`/rules/id/${Be}/${ps.alerts}`},[ps.exceptions]:{id:ps.exceptions,name:ms[ps.exceptions],disabled:null==Qe,href:`/rules/id/${Be}/${ps.exceptions}`},[ps.endpointExceptions]:{id:ps.endpointExceptions,name:ms[ps.endpointExceptions],disabled:null==Qe,href:`/rules/id/${Be}/${ps.endpointExceptions}`},[ps.executionResults]:{id:ps.executionResults,name:ms[ps.executionResults],disabled:!Ve,href:`/rules/id/${Be}/${ps.executionResults}`},[ps.executionEvents]:{id:ps.executionEvents,name:ms[ps.executionEvents],disabled:!Ve,href:`/rules/id/${Be}/${ps.executionEvents}`}})),[Ve,Qe,Be]),[Je,Ye]=Object(l.useState)(Ke),{aboutRuleData:Xe,modifiedAboutRuleDetailsData:Ze,defineRuleData:et,scheduleRuleData:tt}=null!=Qe?Object(ae.g)({rule:Qe,detailsView:!0}):{aboutRuleData:null,modifiedAboutRuleDetailsData:null,defineRuleData:null,scheduleRuleData:null},[at,nt]=Object(l.useState)();Object(l.useEffect)((()=>{(async()=>{if(null!=(null==et?void 0:et.dataViewId)&&""!==(null==et?void 0:et.dataViewId)){const e=await A.dataViews.get(null==et?void 0:et.dataViewId);nt(e.title)}})()}),[A.dataViews,null==et?void 0:et.dataViewId]);const[it,st]=Object(l.useState)(!1),[rt,ot]=Object(l.useState)(!1),lt=Object(Ee.a)(),{globalFullScreen:ct}=Object(Te.a)(),[ut,dt]=Object(l.useState)(Ka.b),[pt,mt]=Object(l.useState)({}),{isSavedQueryLoading:gt,savedQueryBar:ft}=Object(qa.a)(null==Qe?void 0:Qe.saved_id,{ruleType:null==Qe?void 0:Qe.type}),[bt]=Object(v.q)(re.Q),[ht]=Object(v.q)(re.db);Object(l.useEffect)((()=>{(async()=>{const e=await A.dataViews.getIdsWithTitle();if(e.length>0){const t=e.reduce(((e,t)=>({...e,[t.id]:t})),{});mt(t)}})()}),[A.dataViews]);const yt=Object(ke.a)(lt)&&Object(ve.a)(lt),Et=Object(l.useMemo)((()=>!(null!=(null==Qe?void 0:Qe.actions)&&(null==Qe?void 0:Qe.actions.length)>0&&Object(pe.d)(R.show))||R.show),[R,null==Qe?void 0:Qe.actions]),vt=Object(l.useCallback)((()=>{F(re.A,{deepLinkId:Se.a.rules,path:Object(x.c)(null!=Be?Be:"","alerts","")})}),[F,Be]);Object(l.useEffect)((()=>{null!=ze&&We(ze)}),[ze]),Object(l.useEffect)((()=>{if(Qe){const e=Qe.outcome;if(_&&"aliasMatch"===e){const e=`rules/id/${Qe.id}${window.location.search}${window.location.hash}`;_.ui.redirectLegacyUrl({path:e,aliasPurpose:Qe.alias_purpose,objectNoun:i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.redirectObjectNoun",{defaultMessage:"rule"})})}}}),[Qe,_]);const kt=Object(l.useMemo)((()=>{if(null!=(null==Qe?void 0:Qe.alias_target_id)&&_&&"conflict"===Qe.outcome){const e=Qe.alias_target_id,t=`rules/id/${e}${window.location.search}${window.location.hash}`;return c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiSpacer,null),_.ui.components.getLegacyUrlConflict({objectNoun:i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.redirectObjectNoun",{defaultMessage:"rule"}),currentObjectId:Qe.id,otherObjectId:e,otherObjectPath:t}))}return null}),[Qe,_]),St=(()=>{const e=Object(At.a)("extendedRuleExecutionLoggingEnabled"),t=Ft(re.Gb,!1),a=Ft(re.Hb,Fe.c.off);return Object(l.useMemo)((()=>({extendedLogging:{isEnabled:e&&t,minLevel:a}})),[e,t,a])})();Object(l.useEffect)((()=>{const e=[];var t;(he||e.push(ps.alerts),St.extendedLogging.isEnabled||e.push(ps.executionEvents),null!=Qe)&&((null!==(t=Qe.exceptions_list)&&void 0!==t?t:[]).some((e=>e.type===g.a.ENDPOINT))||e.push(ps.endpointExceptions));const a=Object(o.omit)(e,Ke);Ye(a)}),[he,Qe,Ke,St]);const Tt=Object(l.useMemo)((()=>Ne||H||Le),[Ne,H,Le]),xt=Object(l.useMemo)((()=>c.a.createElement(c.a.Fragment,null,null==Qe?void 0:Qe.name," ",$e&&c.a.createElement(n.EuiLoadingSpinner,{size:"m"}))),[Qe,$e]),wt=Object(l.useMemo)((()=>$e||Ve?void 0:{text:Ua,color:"default"}),[Ve,$e]),Ot=Object(l.useMemo)((()=>{var e,t,a,i;return Qe?[c.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:null!==(e=null==Qe?void 0:Qe.created_by)&&void 0!==e?e:Ba,date:c.a.createElement(T.a,{value:null!==(t=null==Qe?void 0:Qe.created_at)&&void 0!==t?t:(new Date).toISOString(),fieldName:"createdAt"})}}),null!=(null==Qe?void 0:Qe.updated_by)?c.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:null!==(a=null==Qe?void 0:Qe.updated_by)&&void 0!==a?a:Ba,date:c.a.createElement(T.a,{value:null!==(i=null==Qe?void 0:Qe.updated_at)&&void 0!==i?i:(new Date).toISOString(),fieldName:"updatedAt"})}}):""]:$e?c.a.createElement(n.EuiLoadingSpinner,{size:"m"}):null}),[Qe,$e]),jt=Object(l.useCallback)((n=>{const i=k.i.detectionsRulesDetailsPage;t({id:i}),e({id:i}),a({id:i}),dt(n)}),[t,e,a,dt]);Object(l.useEffect)((()=>{st(null!=(null==Qe?void 0:Qe.building_block_type))}),[Qe]);const It=Object(l.useMemo)((()=>{var e;return[...Object(Z.c)(null!==(e=null==Qe?void 0:Qe.rule_id)&&void 0!==e?e:""),...Object(Z.d)(it),...Object(Z.a)(ut),...Object(Z.e)(rt)]}),[Qe,it,rt,ut]),Ct=Object(l.useMemo)((()=>{var e;return[...Object(Z.c)(null!==(e=null==Qe?void 0:Qe.rule_id)&&void 0!==e?e:""),...Object(Z.d)(it),...Object(Z.e)(rt)]}),[Qe,it,rt]),Dt=Object(l.useMemo)((()=>[...It,...Q]),[It,Q]),Rt=null==Qe||null===(p=Qe.execution_summary)||void 0===p?void 0:p.last_execution,Pt=null==Rt?void 0:Rt.status,_t=null!==(m=null==Rt?void 0:Rt.date)&&void 0!==m?m:"",qt=null!==(C=null==Rt?void 0:Rt.message)&&void 0!==C?C:"",Nt=Object(l.useMemo)((()=>$e?c.a.createElement(n.EuiFlexItem,null,c.a.createElement(n.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):c.a.createElement(Me.a,{status:Pt,date:_t},c.a.createElement(n.EuiButtonIcon,{"data-test-subj":"refreshButton",color:"primary",onClick:He,iconType:"refresh","aria-label":ge.Yb,isDisabled:!Ve}))),[Pt,_t,$e,Ve,He]),Lt=Object(l.useMemo)((()=>$e?c.a.createElement(n.EuiFlexItem,null,c.a.createElement(n.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):c.a.createElement(Me.c,{status:Pt,date:_t,message:qt})),[Pt,_t,qt,$e]),Bt=Object(l.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;q(Object(se.setAbsoluteRangeDatePicker)({id:y.a.global,from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[q]),zt=Object(l.useCallback)((e=>{We((t=>t?{...t,enabled:e}:t))}),[]),Ht=Object(l.useCallback)((e=>{st(e)}),[st]),$t=Object(l.useCallback)((e=>{ot(e)}),[ot]),Vt=Object(l.useCallback)((()=>{Object(we.j)(N.current)}),[N]),Ut=Object(l.useCallback)((()=>{Object(we.l)()}),[]),Wt=Object(l.useCallback)((e=>{Object(f.isTab)(e)&&Object(we.k)({containerElement:N.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:Vt,onSkipFocusAfterEventsTable:Ut})}),[N,Vt,Ut]);return Object(ae.h)(ue,de,me,Pe)?(F(re.A,{deepLinkId:Se.a.alerts,path:Object(x.a)()}),null):c.a.createElement(c.a.Fragment,null,c.a.createElement(Qa.a,null),c.a.createElement(Wa.a,null),c.a.createElement(us,{onKeyDown:Wt,ref:N},c.a.createElement(n.EuiWindowEvent,{event:"resize",handler:o.noop}),c.a.createElement(S.a,{show:Object(we.m)({globalFullScreen:ct,graphEventId:B})},c.a.createElement(w.a,{id:y.a.global,pollForSignalIndex:Ue,indexPattern:_e})),c.a.createElement(Qt,null,c.a.createElement(O.a,{noPadding:ct},c.a.createElement(xe.a,{show:!ct},c.a.createElement(Ya.a,{backOptions:{path:Object(x.e)(),text:Na,pageId:Se.a.rules,dataTestSubj:"ruleDetailsBackToAllRules"},border:!0,subtitle:Ot,subtitle2:c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},c.a.createElement(n.EuiFlexItem,{grow:!1},Me.d.STATUS,":"),Nt)),title:xt,badgeOptions:wt},c.a.createElement(n.EuiFlexGroup,{alignItems:"center"},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiToolTip,{position:"top",content:Object(pe.b)(Qe,yt,Et,fe)},c.a.createElement(n.EuiFlexGroup,null,c.a.createElement(ee.a,{id:null!==(M=null==Qe?void 0:Qe.id)&&void 0!==M?M:"-1",isDisabled:!Ve||!Object(pe.a)(Qe,Et)||!Object(pe.c)(fe)||Object(b.d)(null==Qe?void 0:Qe.type)&&!yt,enabled:Ve&&null!==(D=null==Qe?void 0:Qe.enabled)&&void 0!==D&&D,onChange:zt}),c.a.createElement(n.EuiFlexItem,null,La)))),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(cs,{ruleId:Be,disabled:!Ve||!Object(pe.c)(fe)||Object(b.d)(null==Qe?void 0:Qe.type)&&!yt,disabledReason:Object(pe.b)(Qe,yt,Et,fe)})),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(ye,{rule:Qe,userHasPermissions:Ve&&Object(pe.c)(fe),canDuplicateRuleWithActions:Object(pe.a)(Qe,Et)})))))),Lt,kt,c.a.createElement(n.EuiSpacer,null),c.a.createElement(n.EuiFlexGroup,null,c.a.createElement(n.EuiFlexItem,{"data-test-subj":"aboutRule",component:"section",grow:1},c.a.createElement(W,{loading:Ge,stepData:Xe,stepDataDetails:Ze})),c.a.createElement(n.EuiFlexItem,{grow:1},c.a.createElement(n.EuiFlexGroup,{direction:"column"},c.a.createElement(n.EuiFlexItem,{component:"section",grow:1,"data-test-subj":"defineRule"},c.a.createElement(te.a,{loading:Ge||gt,title:ge.sb},null!=et&&!gt&&c.a.createElement(Y.b,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:{dataViewTitle:at,...et,queryBar:null!=ft?ft:et.queryBar},kibanaDataViews:pt,indicesConfig:bt,threatIndicesConfig:ht}))),c.a.createElement(n.EuiSpacer,null),c.a.createElement(n.EuiFlexItem,{"data-test-subj":"schedule",component:"section",grow:1},c.a.createElement(te.a,{loading:Ge,title:ge.Ec},null!=tt&&c.a.createElement(X.a,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:tt})))))),c.a.createElement(n.EuiSpacer,null),c.a.createElement(h.a,{navTabs:Je}),c.a.createElement(n.EuiSpacer,null)),c.a.createElement(ds,null,c.a.createElement(u.Switch,null,c.a.createElement(s.Route,{path:`/rules/id/:detailName/:tabName(${ps.alerts})`},c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(Ka.a,{status:ut,onFilterGroupChanged:jt})),c.a.createElement(n.EuiFlexItem,{grow:!1},z&&P.getLastUpdated({updatedAt:z||Date.now(),showUpdating:Tt}))),c.a.createElement(n.EuiSpacer,{size:"l"}),c.a.createElement(xe.a,{show:!ct},c.a.createElement(G.a,{filters:Dt,query:U,signalIndexName:Ae,defaultStackByOption:"event.category",updateDateRange:Bt,runtimeMappings:qe}),c.a.createElement(n.EuiSpacer,null)),null!=Be&&c.a.createElement(K.a,{filterGroup:ut,timelineId:k.i.detectionsRulesDetailsPage,defaultFilters:Ct,hasIndexWrite:null!=be&&be,hasIndexMaintenance:null!=De&&De,from:le,loading:Le,showBuildingBlockAlerts:it,showOnlyThreatIndicatorAlerts:rt,onShowBuildingBlockAlertsChanged:Ht,onShowOnlyThreatIndicatorAlertsChanged:$t,onRuleChange:He,to:oe}))),c.a.createElement(s.Route,{path:`/rules/id/:detailName/:tabName(${ps.exceptions})`},c.a.createElement(ls,{rule:Qe,listType:g.a.DETECTION,onRuleChange:He,isViewReadOnly:!Ve,"data-test-subj":"exceptionTab"})),c.a.createElement(s.Route,{path:`/rules/id/:detailName/:tabName(${ps.endpointExceptions})`},c.a.createElement(ls,{rule:Qe,listType:g.a.ENDPOINT,onRuleChange:He,isViewReadOnly:!Ve,"data-test-subj":"endpointExceptionsTab"})),c.a.createElement(s.Route,{path:`/rules/id/:detailName/:tabName(${ps.executionResults})`},c.a.createElement(Pa,{ruleId:Be,selectAlertsTab:vt})),c.a.createElement(s.Route,{path:`/rules/id/:detailName/:tabName(${ps.executionEvents})`},c.a.createElement(Mt,{ruleId:Be}))))))),c.a.createElement(I.a,{pageName:Se.a.rules,state:{ruleName:null==Qe?void 0:Qe.name}}))},fs=Object(d.connect)(null,(e=>({clearSelected:({id:t})=>e(Oe.a.clearSelected({id:t})),clearEventsLoading:({id:t})=>e(Oe.a.clearEventsLoading({id:t})),clearEventsDeleted:({id:t})=>e(Oe.a.clearEventsDeleted({id:t}))})));gs.displayName="RuleDetailsPageComponent";const bs=fs(c.a.memo(gs));bs.displayName="RuleDetailsPage"},function(e,t,a){"use strict";a.d(t,"e",(function(){return E})),a.d(t,"f",(function(){return S})),a.d(t,"j",(function(){return O})),a.d(t,"i",(function(){return I})),a.d(t,"a",(function(){return ge})),a.d(t,"b",(function(){return $e})),a.d(t,"c",(function(){return lt})),a.d(t,"d",(function(){return It})),a.d(t,"g",(function(){return Gt})),a.d(t,"h",(function(){return fa}));var n=a(53),i=a.n(n),s=a(4),r=a.n(s),o=a(62),l=a(56),c=a(17),u=a(99),d=a(476),p=a(612),m=a(321),g=a(425),f=a(239),b=a(577),h=a(347),y=a(1);const E=r.a.memo((({type:e,to:t,filterQuery:a,isInitializing:n,from:s,indexPattern:E,indexNames:v,setQuery:k})=>{const S={startDate:s,endDate:t,indexNames:v,skip:n,type:e,setQuery:k,filterQuery:a},T={...S,indexPattern:E},x={...S,anomaliesFilterQuery:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},AnomaliesTableComponent:p.a};return r.a.createElement(o.Switch,null,r.a.createElement(l.Route,{path:`${y.Sb}/:tabName(${h.a.dns})`},r.a.createElement($e,T)),r.a.createElement(l.Route,{path:`${y.Sb}/:tabName(${h.a.flows})`},r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{direction:"column"},r.a.createElement(c.EuiFlexItem,null,r.a.createElement(It,i()({},T,{flowTarget:u.b.source}))),r.a.createElement(c.EuiFlexItem,null,r.a.createElement(It,i()({},T,{flowTarget:u.b.destination})))),r.a.createElement(c.EuiSpacer,null),r.a.createElement(b.a,{direction:"column"},r.a.createElement(c.EuiFlexItem,null,r.a.createElement(ge,i()({},T,{flowTarget:u.b.source}))),r.a.createElement(c.EuiFlexItem,null,r.a.createElement(ge,i()({},T,{flowTarget:u.b.destination})))))),r.a.createElement(l.Route,{path:`${y.Sb}/:tabName(${h.a.http})`},r.a.createElement(lt,T)),r.a.createElement(l.Route,{path:`${y.Sb}/:tabName(${h.a.tls})`},r.a.createElement(Gt,i()({},T,{flowTarget:u.b.source}))),r.a.createElement(l.Route,{path:`${y.Sb}/:tabName(${h.a.anomalies})`},r.a.createElement(g.a,i()({},x,{AnomaliesTableComponent:p.a}))),r.a.createElement(l.Route,{path:`${y.Sb}/:tabName(${h.a.events})`},r.a.createElement(d.a,i()({pageFilters:m.a,timelineId:f.c.networkPageEvents},T))))}));E.displayName="NetworkRoutes";var v=a(24);const k=a.n(v)()(c.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1sbaj97-0"})(["min-height:200px;"]);k.displayName="FlexGroup";const S=()=>r.a.createElement(k,{justifyContent:"center",alignItems:"center"},r.a.createElement(c.EuiFlexItem,{grow:!1},r.a.createElement(c.EuiLoadingSpinner,{size:"xl"})));S.displayName="NetworkRoutesLoading";var T=a(3),x=a(441);const w=e=>`${y.Sb}/${e}`,O=e=>{const t={[h.a.flows]:{id:h.a.flows,name:x.d,href:w(h.a.flows),disabled:!1},[h.a.dns]:{id:h.a.dns,name:x.b,href:w(h.a.dns),disabled:!1},[h.a.http]:{id:h.a.http,name:x.e,href:w(h.a.http),disabled:!1},[h.a.tls]:{id:h.a.tls,name:x.f,href:w(h.a.tls),disabled:!1},[h.a.anomalies]:{id:h.a.anomalies,name:x.a,href:w(h.a.anomalies),disabled:!1},[h.a.events]:{id:h.a.events,name:x.c,href:w(h.a.events),disabled:!1}};return e?t:Object(T.omit)([h.a.anomalies],t)};var j=a(521);const I=(e,t)=>e&&!t?j.d:j.e;var C=a(47),M=a(92),D=a.n(M),A=a(214),F=a(77),R=a(76),P=a(264),_=a(179),q=a.n(_),N=a(565),L=a(256),B=a(220),z=a(203),H=a(35),$=a(265),V=a(6);const U=e=>V.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {Country} other {Countries}}"}),Q=V.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.countryTitle",{defaultMessage:"Country"}),W=V.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.bytesInTitle",{defaultMessage:"Bytes in"}),G=V.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.bytesOutTitle",{defaultMessage:"Bytes out"}),K=V.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.flows",{defaultMessage:"Flows"}),J=V.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.destinationCountries",{defaultMessage:"Destination countries"}),Y=V.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.sourceCountries",{defaultMessage:"Source countries"}),X=V.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.destinationIps",{defaultMessage:"Destination IPs"}),Z=V.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.sourceIps",{defaultMessage:"Source IPs"}),ee=V.i18n.translate("xpack.securitySolution.networkTopCountriesTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),te=V.i18n.translate("xpack.securitySolution.networkTopCountriesTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});var ae=a(386);const ne=e=>e===u.b.source?u.b.destination:u.b.source,ie=[{text:ee,numberOfRow:5},{text:te,numberOfRow:10}],se=({data:e,fakeTotalCount:t,flowTargeted:a,id:n,indexPattern:i,isInspect:o,loading:l,loadPage:c,setQuerySkip:d,showMorePagesIndicator:p,totalCount:m,type:g})=>{const f=Object(C.useDispatch)(),b=Object(s.useMemo)((()=>A.e.topCountriesSelector()),[]),{activePage:h,limit:y,sort:E}=Object(R.a)((e=>b(e,g,a))),v=Object(s.useMemo)((()=>a===F.g.source?Y:J),[a]),k=Object(s.useMemo)((()=>g===A.c.NetworkType.page?a===F.g.source?A.c.NetworkTableType.topCountriesSource:A.c.NetworkTableType.topCountriesDestination:a===F.g.source?A.c.NetworkDetailsTableType.topCountriesSource:A.c.NetworkDetailsTableType.topCountriesDestination),[a,g]),S=E.field===F.s.bytes_out||E.field===F.s.bytes_in?`node.network.${E.field}`:`node.${a}.${E.field}`,x=Object(s.useCallback)((e=>f(A.b.updateNetworkTable({networkType:g,tableType:k,updates:{limit:e}}))),[f,g,k]),w=Object(s.useCallback)((e=>f(A.b.updateNetworkTable({networkType:g,tableType:k,updates:{activePage:e}}))),[f,g,k]),O=Object(s.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a=Object(T.last)(t),n={field:a,direction:a!==E.field?F.b.desc:e.sort.direction};D()(n,E)||f(A.b.updateNetworkTable({networkType:g,tableType:k,updates:{sort:n}}))}}),[E,f,g,k]),j=Object(s.useMemo)((()=>((e,t,a,n)=>{const i=((e,t,a,n)=>[{name:Q,render:({node:e})=>{const a=Object(T.get)(`${t}.country`,e),i=`${t}.geo.country_iso_code`,s=Object(B.h)(`${n}-table-${t}-country-${a}`);return null!=a?r.a.createElement(L.b,{key:s,dataProvider:{and:[],enabled:!0,id:s,name:a,excluded:!1,kqlQuery:"",queryMatch:{field:i,value:a,operator:H.c}},isAggregatable:!0,fieldType:"keyword",render:(e,t,n)=>n.isDragging?r.a.createElement(L.a,null,r.a.createElement($.a,{dataProvider:e})):r.a.createElement(r.a.Fragment,null,r.a.createElement(N.b,{countryCode:a}))}):Object(z.d)()},width:"20%"},{align:"right",field:"node.network.bytes_in",name:W,sortable:!0,render:e=>null!=e?r.a.createElement(ae.a,{value:e}):Object(z.d)()},{align:"right",field:"node.network.bytes_out",name:G,sortable:!0,render:e=>null!=e?r.a.createElement(ae.a,{value:e}):Object(z.d)()},{align:"right",field:`node.${t}.flows`,name:K,sortable:!0,render:e=>null!=e?q()(e).format("0,000"):Object(z.d)()},{align:"right",field:`node.${t}.${t}_ips`,name:t===u.b.source?Z:X,sortable:!0,render:e=>null!=e?q()(e).format("0,000"):Object(z.d)()},{align:"right",field:`node.${t}.${ne(t)}_ips`,name:ne(t)===u.b.source?Z:X,sortable:!0,render:e=>null!=e?q()(e).format("0,000"):Object(z.d)()}])(0,t,0,n);return a===A.c.NetworkType.details?(i.pop(),i):i})(0,a,g,"networkTopCountries-top-talkers")),[i,a,g]);return r.a.createElement(P.a,{activePage:h,columns:j,dataTestSubj:`table-${k}`,headerCount:m,headerTitle:v,headerUnit:U(m),id:n,isInspect:o,itemsPerRow:ie,limit:y,loading:l,loadPage:c,onChange:O,pageOfItems:e,setQuerySkip:d,showMorePagesIndicator:p,sorting:{field:S,direction:E.direction},totalCount:t,updateActivePage:w,updateLimitPagination:x})};se.displayName="NetworkTopCountriesTableComponent";const re=r.a.memo(se);var oe=a(229),le=a(281);const ce=V.i18n.translate("xpack.securitySolution.networkTopCountries.failSearchDescription",{defaultMessage:"Failed to run search on network top countries"});var ue=a(240),de=a(221),pe=a(208);const me=Object(de.a)(re),ge=({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,indexPattern:i,ip:o,setQuery:l,skip:c,startDate:u,type:d})=>{const p=`networkTopCountriesQuery-${a}-${d}`,{toggleStatus:m}=Object(pe.a)(p),[g,f]=Object(s.useState)(c||!m);Object(s.useEffect)((()=>{f(c||!m)}),[c,m]);const[b,{id:h,inspect:y,isInspected:E,loadPage:v,networkTopCountries:k,pageInfo:S,refetch:x,totalCount:w}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,indexNames:i,ip:r,skip:o,startDate:l,type:c})=>{const u=Object(s.useMemo)((()=>A.e.topCountriesSelector()),[]),{activePage:d,limit:p,sort:m}=Object(R.a)((e=>u(e,c,a))),[g,f]=Object(s.useState)(null),b=Object(s.useCallback)((e=>{f((t=>t?{...t,pagination:Object(le.a)(e,p)}:t))}),[p]),{loading:h,result:y,search:E,refetch:v,inspect:k}=Object(ue.a)({factoryQueryType:F.q.topCountries,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:ce,abort:o}),S=Object(s.useMemo)((()=>({endDate:e,networkTopCountries:y.edges,id:n,inspect:k,isInspected:!1,loadPage:b,pageInfo:y.pageInfo,refetch:v,startDate:l,totalCount:y.totalCount})),[e,n,k,v,y.edges,y.pageInfo,y.totalCount,l,b]);return Object(s.useEffect)((()=>{f((n=>{const s={...null!=n?n:{},defaultIndex:i,factoryQueryType:F.q.topCountries,filterQuery:Object(oe.a)(t),flowTarget:a,ip:r,pagination:Object(le.a)(d,p),sort:m,timerange:{interval:"12h",from:l,to:e}};return D()(n,s)?n:s}))}),[d,i,e,t,r,p,l,m,a]),Object(s.useEffect)((()=>{!o&&g&&E(g)}),[g,E,o]),[h,S]})({endDate:e,flowTarget:a,filterQuery:t,id:p,indexNames:n,ip:o,skip:g,startDate:u,type:d});return r.a.createElement(me,{data:k,fakeTotalCount:Object(T.getOr)(50,"fakeTotalCount",S),flowTargeted:a,id:h,indexPattern:i,inspect:y,isInspect:E,loading:b,loadPage:v,refetch:x,setQuery:l,setQuerySkip:f,showMorePagesIndicator:Object(T.getOr)(!1,"showMorePagesIndicator",S),totalCount:w,type:d})};ge.displayName="CountriesQueryTabBody";const fe=V.i18n.translate("xpack.securitySolution.networkDnsTable.title",{defaultMessage:"Top DNS domains"}),be=e=>V.i18n.translate("xpack.securitySolution.networkDnsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {domain} other {domains}}"}),he=V.i18n.translate("xpack.securitySolution.networkDnsTable.helperTooltip",{defaultMessage:"This shows DNS protocol traffic only and can be useful for hunting domains used in DNS data exfiltration."}),ye=V.i18n.translate("xpack.securitySolution.networkDnsTable.column.registeredDomain",{defaultMessage:"Registered domain"}),Ee=V.i18n.translate("xpack.securitySolution.networkDnsTable.column.TotalQueriesTitle",{defaultMessage:"Total queries"}),ve=V.i18n.translate("xpack.securitySolution.networkDnsTable.column.uniqueDomainsTitle",{defaultMessage:"Unique domains"}),ke=V.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesInTitle",{defaultMessage:"DNS bytes in"}),Se=V.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesOutTitle",{defaultMessage:"DNS bytes out"}),Te=V.i18n.translate("xpack.securitySolution.networkDnsTable.select.includePtrRecords",{defaultMessage:"Include PTR records"}),xe=V.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),we=V.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Oe=r.a.memo((({isPtrIncluded:e,onChange:t})=>r.a.createElement(c.EuiSwitch,{name:"switch-ptr-included",label:Te,checked:e,onChange:t})));Oe.displayName="IsPtrIncluded";const je=A.c.NetworkTableType.dns,Ie=[{text:xe,numberOfRow:5},{text:we,numberOfRow:10}],Ce=({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:i,loadPage:o,showMorePagesIndicator:l,setQuerySkip:c,totalCount:u,type:d})=>{const p=Object(C.useDispatch)(),m=Object(s.useMemo)((()=>A.e.dnsSelector()),[]),{activePage:g,isPtrIncluded:f,limit:b,sort:h}=Object(R.a)(m),y=Object(s.useCallback)((e=>p(A.b.updateNetworkTable({networkType:d,tableType:je,updates:{limit:e}}))),[d,p]),E=Object(s.useCallback)((e=>p(A.b.updateNetworkTable({networkType:d,tableType:je,updates:{activePage:e}}))),[p,d]),v=Object(s.useCallback)((e=>{if(null!=e.sort){const t={field:e.sort.field.split(".")[1],direction:e.sort.direction};D()(t,h)||p(A.b.updateNetworkTable({networkType:d,tableType:je,updates:{sort:t}}))}}),[h,d,p]),k=Object(s.useCallback)((()=>p(A.b.updateNetworkTable({networkType:d,tableType:je,updates:{isPtrIncluded:!f}}))),[p,d,f]),S=Object(s.useMemo)((()=>[{field:`node.${F.n.dnsName}`,name:ye,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e){const t=Object(B.h)(`networkDns-table--name-${e}`);return r.a.createElement(L.b,{key:t,dataProvider:{and:[],enabled:!0,id:t,name:e,excluded:!1,kqlQuery:"",queryMatch:{field:"dns.question.registered_domain",value:e,operator:H.c}},isAggregatable:!0,fieldType:"keyword",render:(t,a,n)=>n.isDragging?r.a.createElement(L.a,null,r.a.createElement($.a,{dataProvider:t})):Object(z.a)(e)})}return Object(z.d)()}},{align:"right",field:`node.${F.n.queryCount}`,name:Ee,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?q()(e).format("0"):Object(z.d)()},{align:"right",field:`node.${F.n.uniqueDomains}`,name:ve,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?q()(e).format("0"):Object(z.d)()},{align:"right",field:`node.${F.n.dnsBytesIn}`,name:ke,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?r.a.createElement(ae.a,{value:e}):Object(z.d)()},{align:"right",field:`node.${F.n.dnsBytesOut}`,name:Se,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?r.a.createElement(ae.a,{value:e}):Object(z.d)()}]),[]),T=Object(s.useMemo)((()=>({field:`node.${h.field}`,direction:h.direction})),[h.direction,h.field]),x=Object(s.useMemo)((()=>r.a.createElement(Oe,{isPtrIncluded:f,onChange:k})),[f,k]);return r.a.createElement(P.a,{activePage:g,columns:S,dataTestSubj:`table-${je}`,headerCount:u,headerSupplement:x,headerTitle:fe,headerTooltip:he,headerUnit:be(u),id:a,itemsPerRow:Ie,isInspect:n,limit:b,loading:i,loadPage:o,onChange:v,pageOfItems:e,setQuerySkip:c,showMorePagesIndicator:l,sorting:T,totalCount:t,updateActivePage:E,updateLimitPagination:y})};Ce.displayName="NetworkDnsTableComponent";const Me=r.a.memo(Ce),De=V.i18n.translate("xpack.securitySolution.networkDns.errorSearchDescription",{defaultMessage:"An error has occurred on network dns search"}),Ae=V.i18n.translate("xpack.securitySolution.hosts.navigation.dns.histogram.errorFetchingDnsData",{defaultMessage:"Failed to query DNS data"});var Fe=a(429),Re=a(104),Pe=a(295);const _e={title:"Top domains by dns.question.registered_domain",description:"Security Solution Network DNS",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!0,position:"right"},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"bar",layers:[{layerId:"b1c3efc6-c886-4fba-978f-3b6bb5e7948a",accessors:["2a4d5e20-f570-48e4-b9ab-ff3068919377"],position:"top",seriesType:"bar",showGridlines:!1,layerType:"data",xAccessor:"d1452b87-0e9e-4fc0-a725-3727a18e0b37",splitAccessor:"e8842815-2a45-4c74-86de-c19a391e2424"}]},query:{query:"",language:"kuery"},filters:[{meta:{alias:null,negate:!0,disabled:!1,type:"phrase",key:"dns.question.type",params:{query:"PTR"},indexRefName:"filter-index-pattern-0"},query:{match_phrase:{"dns.question.type":"PTR"}},$state:{store:"appState"}}],datasourceStates:{indexpattern:{layers:{"b1c3efc6-c886-4fba-978f-3b6bb5e7948a":{columns:{"d1452b87-0e9e-4fc0-a725-3727a18e0b37":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"2a4d5e20-f570-48e4-b9ab-ff3068919377":{label:Object(Pe.o)("dns.question.registered_domain"),dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"dns.question.registered_domain",isBucketed:!1},"e8842815-2a45-4c74-86de-c19a391e2424":{label:Object(Pe.n)("dns.question.name"),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:"dns.question.name",isBucketed:!0,params:{size:6,orderBy:{type:"column",columnId:"2a4d5e20-f570-48e4-b9ab-ff3068919377"},orderDirection:"desc",otherBucket:!0,missingBucket:!1}}},columnOrder:["e8842815-2a45-4c74-86de-c19a391e2424","d1452b87-0e9e-4fc0-a725-3727a18e0b37","2a4d5e20-f570-48e4-b9ab-ff3068919377"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-b1c3efc6-c886-4fba-978f-3b6bb5e7948a"},{name:"filter-index-pattern-0",type:"index-pattern",id:"{dataViewId}"}]};var qe;const Ne="networkDnsHistogramQuery",Le=Object(de.a)(Me),Be=[{text:"dns.question.registered_domain",value:"dns.question.registered_domain"}],ze={defaultStackByOption:null!==(qe=Be.find((e=>"dns.question.registered_domain"===e.text)))&&void 0!==qe?qe:Be[0],errorMessage:Ae,histogramType:Re.j.dns,stackByOptions:Be,subtitle:void 0,lensAttributes:_e},He=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:n,skip:o,startDate:l,setQuery:c,type:u})=>{const d=A.e.dnsSelector(),p=Object(R.b)((e=>d(e).isPtrIncluded));Object(s.useEffect)((()=>()=>{e&&e({id:Ne})}),[e]);const m=`networkDnsQuery-${u}`,{toggleStatus:g}=Object(pe.a)(m),[f,b]=Object(s.useState)(o||!g);Object(s.useEffect)((()=>{b(o||!g)}),[o,g]);const[h,{totalCount:y,networkDns:E,pageInfo:v,loadPage:k,id:S,inspect:x,isInspected:w,refetch:O}]=(({endDate:e,filterQuery:t,id:a,indexNames:n,skip:i,startDate:r})=>{const o=Object(s.useMemo)((()=>A.e.dnsSelector()),[]),{activePage:l,sort:c,isPtrIncluded:u,limit:d}=Object(R.a)(o),[p,m]=Object(s.useState)(null),g=Object(s.useCallback)((e=>{m((t=>t?{...t,pagination:Object(le.a)(e,d)}:t))}),[d]),{loading:f,result:b,search:h,refetch:y,inspect:E}=Object(ue.a)({factoryQueryType:F.q.dns,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:De,abort:i}),v=Object(s.useMemo)((()=>({id:a,inspect:E,isInspected:!1,loadPage:g,networkDns:b.edges,pageInfo:b.pageInfo,refetch:y,totalCount:b.totalCount})),[a,E,y,b.edges,b.pageInfo,b.totalCount,g]);return Object(s.useEffect)((()=>{m((a=>{const i={...null!=a?a:{},defaultIndex:n,isPtrIncluded:u,factoryQueryType:F.q.dns,filterQuery:Object(oe.a)(t),pagination:Object(le.a)(l,d,!0),sort:c,timerange:{interval:"12h",from:r,to:e}};return D()(a,i)?a:i}))}),[l,n,e,t,d,r,c,u]),Object(s.useEffect)((()=>{!i&&p&&h(p)}),[p,h,i]),[f,v]})({endDate:t,filterQuery:a,id:m,indexNames:n,skip:f,startDate:l}),j=Object(s.useCallback)((e=>{return t=e.text,V.i18n.translate("xpack.securitySolution.network.dns.stackByUniqueSubdomain",{values:{groupByField:t},defaultMessage:"Top domains by {groupByField}"});var t}),[]),I=Object(s.useMemo)((()=>({...ze,title:j})),[j]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Fe.a,i()({id:Ne,isPtrIncluded:p,endDate:t,filterQuery:a,indexNames:n,setQuery:c,showLegend:!0,startDate:l},I)),r.a.createElement(Le,{data:E,fakeTotalCount:Object(T.getOr)(50,"fakeTotalCount",v),id:S,inspect:x,isInspect:w,loading:h,loadPage:k,refetch:O,setQuery:c,setQuerySkip:b,showMorePagesIndicator:Object(T.getOr)(!1,"showMorePagesIndicator",v),totalCount:y,type:u}))};He.displayName="DnsQueryTabBodyComponent";const $e=r.a.memo(He);var Ve=a(204);const Ue=V.i18n.translate("xpack.securitySolution.networkHttpTable.title",{defaultMessage:"HTTP Requests"}),Qe=e=>V.i18n.translate("xpack.securitySolution.networkHttpTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {request} other {requests}}"}),We=V.i18n.translate("xpack.securitySolution.networkHttpTable.column.methodTitle",{defaultMessage:"Method"}),Ge=V.i18n.translate("xpack.securitySolution.networkHttpTable.column.domainTitle",{defaultMessage:"Domain"}),Ke=V.i18n.translate("xpack.securitySolution.networkHttpTable.column.pathTitle",{defaultMessage:"Path"}),Je=V.i18n.translate("xpack.securitySolution.networkHttpTable.column.statusTitle",{defaultMessage:"Status"}),Ye=V.i18n.translate("xpack.securitySolution.networkHttpTable.column.lastHostTitle",{defaultMessage:"Last host"}),Xe=V.i18n.translate("xpack.securitySolution.networkHttpTable.column.lastSourceIpTitle",{defaultMessage:"Last source Ip"}),Ze=V.i18n.translate("xpack.securitySolution.networkHttpTable.column.requestsTitle",{defaultMessage:"Requests"}),et=V.i18n.translate("xpack.securitySolution.networkHttpTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),tt=V.i18n.translate("xpack.securitySolution.networkHttpTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});var at=a(273);const nt=[{text:et,numberOfRow:5},{text:tt,numberOfRow:10}],it=({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:i,loadPage:o,setQuerySkip:l,showMorePagesIndicator:c,totalCount:d,type:p})=>{const m=Object(C.useDispatch)(),g=Object(s.useMemo)((()=>A.e.httpSelector()),[]),{activePage:f,limit:b,sort:h}=Object(R.a)((e=>g(e,p))),y=p===A.c.NetworkType.page?A.c.NetworkTableType.http:A.c.NetworkDetailsTableType.http,E=Object(s.useCallback)((e=>m(A.b.updateNetworkTable({networkType:p,tableType:y,updates:{limit:e}}))),[m,p,y]),v=Object(s.useCallback)((e=>m(A.b.updateNetworkTable({networkType:p,tableType:y,updates:{activePage:e}}))),[m,p,y]),k=Object(s.useCallback)((e=>{null!=e.sort&&e.sort.direction!==h.direction&&m(A.b.updateNetworkTable({networkType:p,tableType:y,updates:{sort:{direction:e.sort.direction}}}))}),[h.direction,m,p,y]),S={field:`node.${F.o.requestCount}`,direction:h.direction},T=Object(s.useMemo)((()=>{return e=y,[{name:We,render:({node:{methods:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(at.c)({attrName:"http.request.method",displayCount:3,idPrefix:Object(B.h)(`${e}-table-methods-${a}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:Ge,render:({node:{domains:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(at.c)({attrName:"url.domain",displayCount:3,idPrefix:Object(B.h)(`${e}-table-domains-${a}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{field:`node.${u.e.path}`,name:Ke,render:t=>null!=t?Object(at.b)({attrName:"url.path",idPrefix:Object(B.h)(`${e}-table-path-${t}`),rowItem:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:Je,render:({node:{statuses:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(at.c)({attrName:"http.response.status_code",displayCount:3,idPrefix:Object(B.h)(`${e}-table-statuses-${a}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:Ye,render:({node:{lastHost:t,path:a}})=>null!=t?Object(at.b)({attrName:"host.name",idPrefix:Object(B.h)(`${e}-table-lastHost-${a}`),rowItem:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:Xe,render:({node:{lastSourceIp:t,path:a}})=>null!=t?Object(at.b)({attrName:"source.ip",idPrefix:Object(B.h)(`${e}-table-lastSourceIp-${a}`),rowItem:t,render:()=>r.a.createElement(Ve.h,{ip:t}),isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{align:"right",field:`node.${u.e.requestCount}`,name:Ze,sortable:!0,render:e=>null!=e?q()(e).format("0,000"):Object(z.d)()}];var e}),[y]);return r.a.createElement(P.a,{activePage:f,columns:T,dataTestSubj:`table-${y}`,headerCount:d,headerTitle:Ue,headerUnit:Qe(d),id:a,itemsPerRow:nt,isInspect:n,limit:b,loading:i,loadPage:o,onChange:k,pageOfItems:e,setQuerySkip:l,showMorePagesIndicator:c,sorting:S,totalCount:t,updateActivePage:v,updateLimitPagination:E})};it.displayName="NetworkHttpTableComponent";const st=r.a.memo(it),rt=V.i18n.translate("xpack.securitySolution.networkHttp.failSearchDescription",{defaultMessage:"Failed to run search on network http"}),ot=Object(de.a)(st),lt=({endDate:e,filterQuery:t,indexNames:a,skip:n,startDate:i,setQuery:o,type:l})=>{const c=`networkHttpQuery-${l}`,{toggleStatus:u}=Object(pe.a)(c),[d,p]=Object(s.useState)(n||!u);Object(s.useEffect)((()=>{p(n||!u)}),[n,u]);const[m,{id:g,inspect:f,isInspected:b,loadPage:h,networkHttp:y,pageInfo:E,refetch:v,totalCount:k}]=(({endDate:e,filterQuery:t,id:a,indexNames:n,ip:i,skip:r,startDate:o,type:l})=>{const c=Object(s.useMemo)((()=>A.e.httpSelector()),[]),{activePage:u,limit:d,sort:p}=Object(R.a)((e=>c(e,l))),[m,g]=Object(s.useState)(null),f=Object(s.useCallback)((e=>{g((t=>t?{...t,pagination:Object(le.a)(e,d)}:t))}),[d]),{loading:b,result:h,search:y,refetch:E,inspect:v}=Object(ue.a)({factoryQueryType:F.q.http,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:rt,abort:r}),k=Object(s.useMemo)((()=>({endDate:e,networkHttp:h.edges,id:a,inspect:v,isInspected:!1,loadPage:f,pageInfo:h.pageInfo,refetch:E,startDate:o,totalCount:h.totalCount})),[e,a,v,E,h.edges,h.pageInfo,h.totalCount,o,f]);return Object(s.useEffect)((()=>{g((a=>{const s={...null!=a?a:{},defaultIndex:n,factoryQueryType:F.q.http,filterQuery:Object(oe.a)(t),ip:i,pagination:Object(le.a)(u,d),sort:p,timerange:{interval:"12h",from:o,to:e}};return D()(a,s)?a:s}))}),[u,n,e,t,i,d,o,p]),Object(s.useEffect)((()=>{!r&&m&&y(m)}),[m,y,r]),[b,k]})({endDate:e,filterQuery:t,id:c,indexNames:a,skip:d,startDate:i,type:l});return r.a.createElement(ot,{data:y,fakeTotalCount:Object(T.getOr)(50,"fakeTotalCount",E),id:g,inspect:f,isInspect:b,loading:m,loadPage:h,refetch:v,setQuery:o,setQuerySkip:p,showMorePagesIndicator:Object(T.getOr)(!1,"showMorePagesIndicator",E),totalCount:k,type:l})};lt.displayName="HttpQueryTabBody";const ct=e=>V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {IP} other {IPs}}"}),ut=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.sourceIpTitle",{defaultMessage:"Source IPs"}),dt=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.destinationIpTitle",{defaultMessage:"Destination IPs"}),pt=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.IpTitle",{defaultMessage:"IP"}),mt=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.domainTitle",{defaultMessage:"Domain"}),gt=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.bytesInTitle",{defaultMessage:"Bytes in"}),ft=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.bytesOutTitle",{defaultMessage:"Bytes out"}),bt=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.asTitle",{defaultMessage:"Autonomous system"}),ht=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.flows",{defaultMessage:"Flows"}),yt=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.destinationIps",{defaultMessage:"Destination IPs"}),Et=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.sourceIps",{defaultMessage:"Source IPs"}),vt=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),kt=V.i18n.translate("xpack.securitySolution.networkTopNFlowTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),St=e=>e===F.g.source?F.g.destination:F.g.source,Tt=[{text:vt,numberOfRow:5},{text:kt,numberOfRow:10}],xt=({data:e,fakeTotalCount:t,flowTargeted:a,id:n,isInspect:i,loading:o,loadPage:l,setQuerySkip:c,showMorePagesIndicator:u,totalCount:d,type:p})=>{const m=Object(C.useDispatch)(),g=Object(s.useMemo)((()=>A.e.topNFlowSelector()),[]),{activePage:f,limit:b,sort:h}=Object(R.a)((e=>g(e,p,a))),y=Object(s.useMemo)((()=>((e,t,a)=>{const n=((e,t)=>[{name:pt,render:({node:a})=>{const n=`${e}.ip`,i=Object(T.get)(n,a),s=`${e}.location.geo.country_iso_code[0]`,o=`${e}.geo.country_iso_code`,l=Object(T.get)(s,a),c=Object(B.h)(`${t}-table-${e}-ip-${i}`);return null!=i?r.a.createElement(r.a.Fragment,null,r.a.createElement(L.b,{key:c,dataProvider:{and:[],enabled:!0,id:c,name:i,excluded:!1,kqlQuery:"",queryMatch:{field:n,value:i,operator:H.c}},isAggregatable:!0,fieldType:"ip",render:(t,a,n)=>n.isDragging?r.a.createElement(L.a,null,r.a.createElement($.a,{dataProvider:t})):r.a.createElement(Ve.h,{ip:i,flowTarget:e})}),l&&r.a.createElement(L.b,{key:`${c}-${l}`,dataProvider:{and:[],enabled:!0,id:`${c}-${l}`,name:l,excluded:!1,kqlQuery:"",queryMatch:{field:o,value:l,operator:H.c}},isAggregatable:!0,fieldType:"geo_point",render:(e,t,a)=>a.isDragging?r.a.createElement(L.a,null,r.a.createElement($.a,{dataProvider:e})):r.a.createElement(r.a.Fragment,null," ",r.a.createElement(N.a,{countryCode:l})," ",l)})):Object(z.d)()},width:"20%"},{name:mt,render:({node:a})=>{const n=`${e}.domain`,i=`${e}.ip`,s=Object(T.get)(n,a),r=Object(T.get)(i,a);if(Array.isArray(s)&&s.length>0){const e=Object(B.h)(`${t}-table-${r}`);return Object(at.c)({rowItems:s,attrName:n,idPrefix:e,displayCount:1,isAggregatable:!0,fieldType:"keyword"})}return Object(z.d)()},width:"20%"},{name:bt,render:({node:a,cursor:{value:n}})=>{const i=`${e}.autonomous_system`,s=Object(T.get)(i,a);if(null!=s){const a=Object(B.h)(`${t}-table-${e}-ip-${n}`);return r.a.createElement(r.a.Fragment,null,s.name&&Object(at.b)({rowItem:s.name,attrName:`${e}.as.organization.name`,idPrefix:`${a}-name`,isAggregatable:!0,fieldType:"keyword"}),s.number&&r.a.createElement(r.a.Fragment,null," ",Object(at.b)({rowItem:`${s.number}`,attrName:`${e}.as.number`,idPrefix:`${a}-number`,isAggregatable:!0,fieldType:"keyword"})))}return Object(z.d)()},width:"20%"},{align:"right",field:"node.network.bytes_in",name:gt,sortable:!0,render:e=>null!=e?r.a.createElement(ae.a,{value:e}):Object(z.d)()},{align:"right",field:"node.network.bytes_out",name:ft,sortable:!0,render:e=>null!=e?r.a.createElement(ae.a,{value:e}):Object(z.d)()},{align:"right",field:`node.${e}.flows`,name:ht,sortable:!0,render:e=>null!=e?q()(e).format("0,000"):Object(z.d)()},{align:"right",field:`node.${e}.${St(e)}_ips`,name:e===F.g.source?yt:Et,sortable:!0,render:e=>null!=e?q()(e).format("0,000"):Object(z.d)()}])(e,a);return t===A.c.NetworkType.details?(n.pop(),n):n})(a,p,"networkTopSourceFlow-top-talkers")),[a,p]);let E;const v=a===F.g.source?ut:dt;E=p===A.c.NetworkType.page?a===F.g.source?A.c.NetworkTableType.topNFlowSource:A.c.NetworkTableType.topNFlowDestination:a===F.g.source?A.c.NetworkDetailsTableType.topNFlowSource:A.c.NetworkDetailsTableType.topNFlowDestination;const k=Object(s.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a=Object(T.last)(t),n={field:a,direction:a!==h.field?F.b.desc:e.sort.direction};D()(n,h)||m(A.b.updateNetworkTable({networkType:p,tableType:E,updates:{sort:n}}))}}),[h,m,p,E]),S=Object(s.useMemo)((()=>({field:h.field===F.s.bytes_out||h.field===F.s.bytes_in?`node.network.${h.field}`:`node.${a}.${h.field}`,direction:h.direction})),[a,h]),x=Object(s.useCallback)((e=>m(A.b.updateNetworkTable({networkType:p,tableType:E,updates:{activePage:e}}))),[m,p,E]),w=Object(s.useCallback)((e=>m(A.b.updateNetworkTable({networkType:p,tableType:E,updates:{limit:e}}))),[m,p,E]);return r.a.createElement(P.a,{activePage:f,columns:y,dataTestSubj:`table-${E}`,headerCount:d,headerTitle:v,headerUnit:ct(d),id:n,isInspect:i,itemsPerRow:Tt,limit:b,loading:o,loadPage:l,onChange:k,pageOfItems:e,setQuerySkip:c,showMorePagesIndicator:u,sorting:S,totalCount:t,updateActivePage:x,updateLimitPagination:w})},wt=r.a.memo(xt),Ot=V.i18n.translate("xpack.securitySolution.networkTopNFlow.failSearchDescription",{defaultMessage:"Failed to run search on network top n flow"}),jt=Object(de.a)(wt),It=({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,ip:i,setQuery:o,skip:l,startDate:c,type:u})=>{const d=`networkTopNFlowQuery-${a}-${u}`,{toggleStatus:p}=Object(pe.a)(d),[m,g]=Object(s.useState)(l||!p);Object(s.useEffect)((()=>{g(l||!p)}),[l,p]);const[f,{id:b,inspect:h,isInspected:y,loadPage:E,networkTopNFlow:v,pageInfo:k,refetch:S,totalCount:x}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,indexNames:i,ip:r,skip:o,startDate:l,type:c})=>{const u=Object(s.useMemo)((()=>A.e.topNFlowSelector()),[]),{activePage:d,limit:p,sort:m}=Object(R.a)((e=>u(e,c,a))),[g,f]=Object(s.useState)(null),b=Object(s.useCallback)((e=>{f((t=>t?{...t,pagination:Object(le.a)(e,p)}:t))}),[p]),{loading:h,result:y,search:E,refetch:v,inspect:k}=Object(ue.a)({factoryQueryType:F.q.topNFlow,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Ot,abort:o}),S=Object(s.useMemo)((()=>({endDate:e,networkTopNFlow:y.edges,id:n,inspect:k,isInspected:!1,loadPage:b,pageInfo:y.pageInfo,refetch:v,startDate:l,totalCount:y.totalCount})),[e,n,k,v,y.edges,y.pageInfo,y.totalCount,l,b]);return Object(s.useEffect)((()=>{f((n=>{const s={...null!=n?n:{},defaultIndex:i,factoryQueryType:F.q.topNFlow,filterQuery:Object(oe.a)(t),flowTarget:a,ip:r,pagination:Object(le.a)(d,p),timerange:{interval:"12h",from:l,to:e},sort:m};return D()(n,s)?n:s}))}),[d,e,t,i,r,p,l,m,a]),Object(s.useEffect)((()=>{!o&&g&&E(g)}),[g,E,o]),[h,S]})({endDate:e,flowTarget:a,filterQuery:t,id:d,indexNames:n,ip:i,skip:m,startDate:c,type:u});return r.a.createElement(jt,{data:v,fakeTotalCount:Object(T.getOr)(50,"fakeTotalCount",k),flowTargeted:a,id:b,inspect:h,isInspect:y,loading:f,loadPage:E,refetch:S,setQuery:o,setQuerySkip:g,showMorePagesIndicator:Object(T.getOr)(!1,"showMorePagesIndicator",k),totalCount:x,type:u})};It.displayName="IPsQueryTabBody",V.i18n.translate("xpack.securitySolution.networkTls.errorSearchDescription",{defaultMessage:"An error has occurred on network tls search"});const Ct=V.i18n.translate("xpack.securitySolution.networkTls.failSearchDescription",{defaultMessage:"Failed to run search on network tls"});var Mt=a(26),Dt=a.n(Mt),At=a(732),Ft=a(211);const Rt=V.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.transportLayerSecurityTitle",{defaultMessage:"Transport Layer Security"}),Pt=e=>V.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {server certificate} other {server certificates}}"}),_t=V.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.issuerTitle",{defaultMessage:"Issuer"}),qt=V.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.subjectTitle",{defaultMessage:"Subject"}),Nt=V.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.sha1FingerPrintTitle",{defaultMessage:"SHA1 fingerprint"}),Lt=V.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.ja3FingerPrintTitle",{defaultMessage:"JA3 fingerprint"}),Bt=V.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.validUntilTitle",{defaultMessage:"Valid until"}),zt=[{text:V.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:5},{text:V.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:10}],Ht=({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:i,loadPage:o,setQuerySkip:l,showMorePagesIndicator:c,totalCount:u,type:d})=>{const p=Object(C.useDispatch)(),m=Object(s.useMemo)((()=>A.e.tlsSelector()),[]),{activePage:g,limit:f,sort:b}=Object(R.a)((e=>m(e,d))),h=d===A.c.NetworkType.page?A.c.NetworkTableType.tls:A.c.NetworkDetailsTableType.tls,y=Object(s.useCallback)((e=>p(A.b.updateNetworkTable({networkType:d,tableType:h,updates:{limit:e}}))),[p,d,h]),E=Object(s.useCallback)((e=>p(A.b.updateNetworkTable({networkType:d,tableType:h,updates:{activePage:e}}))),[p,d,h]),v=Object(s.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a={field:Ut(t[t.length-1]),direction:e.sort.direction};D()(a,b)||p(A.b.updateNetworkTable({networkType:d,tableType:h,updates:{sort:a}}))}}),[b,p,d,h]),k=Object(s.useMemo)((()=>("tls-table",[{field:"node",name:_t,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,issuers:t})=>Object(at.c)({rowItems:t,attrName:"tls.server.issuer",idPrefix:`tls-table-${e}-table-issuers`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:qt,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,subjects:t})=>Object(at.c)({rowItems:t,attrName:"tls.server.subject",idPrefix:`tls-table-${e}-table-subjects`,isAggregatable:!0,fieldType:"keyword"})},{field:"node._id",name:Nt,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>Object(at.b)({rowItem:e,attrName:"tls.server.hash.sha1",idPrefix:`tls-table-${e}-table-sha1`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:Lt,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,ja3:t})=>Object(at.c)({rowItems:t,attrName:"tls.server.ja3s",idPrefix:`tls-table-${e}-table-ja3`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:Bt,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,notAfter:t})=>Object(at.c)({rowItems:t,attrName:"tls.server.not_after",idPrefix:`tls-table-${e}-table-notAfter`,render:e=>r.a.createElement(At.a,{date:Dt()(new Date(e)).toDate()},r.a.createElement(Ft.c,{value:new Date(e)}))})}])),[]);return r.a.createElement(P.a,{activePage:g,columns:k,dataTestSubj:`table-${h}`,showMorePagesIndicator:c,headerCount:u,headerTitle:Rt,headerUnit:Pt(u),id:a,isInspect:n,itemsPerRow:zt,limit:f,loading:i,loadPage:o,onChange:v,pageOfItems:e,setQuerySkip:l,sorting:Vt(b),totalCount:t,updateActivePage:E,updateLimitPagination:y})};Ht.displayName="TlsTableComponent";const $t=r.a.memo(Ht),Vt=e=>({field:`node.${e.field}`,direction:e.direction}),Ut=e=>F.r._id,Qt=Object(de.a)($t),Wt=({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,ip:i="",setQuery:o,skip:l,startDate:c,type:d})=>{const p=`networkTlsQuery-${d}`,{toggleStatus:m}=Object(pe.a)(p),[g,f]=Object(s.useState)(l||!m);Object(s.useEffect)((()=>{f(l||!m)}),[l,m]);const[b,{id:h,inspect:y,isInspected:E,tls:v,totalCount:k,pageInfo:S,loadPage:x,refetch:w}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,indexNames:i,ip:r,skip:o,startDate:l,type:c})=>{const d=Object(s.useMemo)((()=>A.e.tlsSelector()),[]),{activePage:p,limit:m,sort:g}=Object(R.a)((e=>d(e,c))),[f,b]=Object(s.useState)(null),h=Object(s.useCallback)((e=>{b((t=>t?{...t,pagination:Object(le.a)(e,m)}:t))}),[m]),{loading:y,result:E,search:v,refetch:k,inspect:S}=Object(ue.a)({factoryQueryType:u.g.tls,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Ct,abort:o}),T=Object(s.useMemo)((()=>({endDate:e,tls:E.edges,id:n,inspect:S,isInspected:!1,loadPage:h,pageInfo:E.pageInfo,refetch:k,startDate:l,totalCount:E.totalCount})),[e,n,S,k,E.edges,E.pageInfo,E.totalCount,l,h]);return Object(s.useEffect)((()=>{b((n=>{const s={...null!=n?n:{},defaultIndex:i,factoryQueryType:u.g.tls,filterQuery:Object(oe.a)(t),flowTarget:a,ip:r,pagination:Object(le.a)(p,m),timerange:{interval:"12h",from:l,to:e},sort:g};return D()(n,s)?n:s}))}),[p,i,e,t,m,l,g,a,r,n]),Object(s.useEffect)((()=>{!o&&f&&v(f)}),[f,v,o]),[y,T]})({endDate:e,filterQuery:t,flowTarget:a,id:p,indexNames:n,ip:i,skip:g,startDate:c,type:d});return r.a.createElement(Qt,{data:v,id:h,inspect:y,isInspect:E,fakeTotalCount:Object(T.getOr)(50,"fakeTotalCount",S),loading:b,loadPage:x,showMorePagesIndicator:Object(T.getOr)(!1,"showMorePagesIndicator",S),refetch:w,setQuery:o,setQuerySkip:f,totalCount:k,type:d})};Wt.displayName="TlsQueryTabBodyComponent";const Gt=r.a.memo(Wt);var Kt=a(19);V.i18n.translate("xpack.securitySolution.networkUsers.errorSearchDescription",{defaultMessage:"An error has occurred on network users search"});const Jt=V.i18n.translate("xpack.securitySolution.networkUsers.failSearchDescription",{defaultMessage:"Failed to run search on network users"});var Yt=a(2);const Xt=V.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.usersTitle",{defaultMessage:"Users"}),Zt=e=>V.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),ea=V.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.userNameTitle",{defaultMessage:"User"}),ta=V.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.userIdTitle",{defaultMessage:"ID"}),aa=V.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.groupNameTitle",{defaultMessage:"Group name"}),na=V.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.groupIdTitle",{defaultMessage:"Group ID"}),ia=V.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.documentCountTitle",{defaultMessage:"Document count"}),sa=V.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),ra=V.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),oa=A.c.NetworkDetailsTableType.users,la=[{text:sa,numberOfRow:5},{text:ra,numberOfRow:10}],ca="users-table",ua=({data:e,fakeTotalCount:t,flowTarget:a,id:n,isInspect:i,loading:o,loadPage:l,setQuerySkip:c,showMorePagesIndicator:u,totalCount:d,type:p})=>{const m=Object(C.useDispatch)(),g=Object(s.useMemo)((()=>A.e.usersSelector()),[]),{activePage:f,sort:b,limit:h}=Object(R.a)(g),y=Object(s.useCallback)((e=>m(A.b.updateNetworkTable({networkType:p,tableType:oa,updates:{limit:e}}))),[m,p]),E=Object(s.useCallback)((e=>m(A.b.updateNetworkTable({networkType:p,tableType:oa,updates:{activePage:e}}))),[m,p]),v=Object(s.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a={field:ma(t[t.length-1]),direction:e.sort.direction};D()(a,b)||m(A.b.updateNetworkTable({networkType:p,tableType:oa,updates:{sort:a}}))}}),[m,b,p]),k=Object(s.useMemo)((()=>((e,t)=>[{field:"node.user.name",name:ea,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:a=>Object(at.b)({rowItem:a,attrName:"user.name",idPrefix:`${t}-table-${e}-user`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.id",name:ta,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object(at.c)({rowItems:a,attrName:"user.id",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.groupName",name:aa,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object(at.c)({rowItems:a,attrName:"user.group.name",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.groupId",name:na,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object(at.c)({rowItems:a,attrName:"user.group.id",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{align:"right",field:"node.user.count",name:ia,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>Object(z.a)(e)}])(a,ca)),[a,ca]);return r.a.createElement(P.a,{activePage:f,columns:k,dataTestSubj:`table-${oa}`,showMorePagesIndicator:u,headerCount:d,headerTitle:Xt,headerUnit:Zt(d),id:n,isInspect:i,itemsPerRow:la,limit:h,loading:o,loadPage:l,onChange:v,pageOfItems:e,setQuerySkip:c,sorting:pa(b),totalCount:t,updateActivePage:E,updateLimitPagination:y})};ua.displayName="UsersTableComponent";const da=r.a.memo(ua),pa=e=>{switch(e.field){case F.t.name:case F.t.count:return{field:`node.user.${e.field}`,direction:e.direction}}return Object(Yt.a)(e.field)},ma=e=>{switch(e){case F.t.name.valueOf():return F.t.name;case F.t.count.valueOf():return F.t.count;default:return F.t.name}},ga=Object(de.a)(da),fa=({endDate:e,filterQuery:t,flowTarget:a,ip:n,setQuery:i,skip:o,startDate:l,type:c})=>{const d=`networkUsersQuery-${c}`,{toggleStatus:p}=Object(pe.a)(d),[m,g]=Object(s.useState)(o||!p);Object(s.useEffect)((()=>{g(o||!p)}),[o,p]);const[f,{id:b,inspect:h,isInspected:E,networkUsers:v,totalCount:k,pageInfo:S,loadPage:x,refetch:w}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,ip:i,skip:r,startDate:o})=>{const l=Object(s.useMemo)((()=>A.e.usersSelector()),[]),{activePage:c,sort:d,limit:p}=Object(R.a)(l),{uiSettings:m}=Object(Kt.k)().services,g=m.get(y.Q),[f,b]=Object(s.useState)(null),h=Object(s.useCallback)((e=>{b((t=>t?{...t,pagination:Object(le.a)(e,p)}:t))}),[p]),{loading:E,result:v,search:k,refetch:S,inspect:T}=Object(ue.a)({factoryQueryType:u.g.users,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Jt,abort:r}),x=Object(s.useMemo)((()=>({endDate:e,networkUsers:v.edges,id:n,inspect:T,isInspected:!1,loadPage:h,pageInfo:v.pageInfo,refetch:S,startDate:o,totalCount:v.totalCount})),[e,n,T,S,v.edges,v.pageInfo,v.totalCount,o,h]);return Object(s.useEffect)((()=>{b((n=>{const s={...null!=n?n:{},ip:i,defaultIndex:g,factoryQueryType:u.g.users,filterQuery:Object(oe.a)(t),flowTarget:a,pagination:Object(le.a)(c,p),sort:d,timerange:{interval:"12h",from:o,to:e}};return D()(n,s)?n:s}))}),[c,g,e,t,p,o,d,i,a]),Object(s.useEffect)((()=>{!r&&f&&k(f)}),[f,k,r]),[E,x]})({endDate:e,filterQuery:t,flowTarget:a,id:d,ip:n,skip:m,startDate:l});return r.a.createElement(ga,{data:v,id:b,inspect:h,isInspect:E,flowTarget:a,fakeTotalCount:Object(T.getOr)(50,"fakeTotalCount",S),loading:f,loadPage:x,showMorePagesIndicator:Object(T.getOr)(!1,"showMorePagesIndicator",S),refetch:w,setQuery:i,setQuerySkip:g,totalCount:k,type:c})};fa.displayName="UsersQueryTable"},function(e,t,a){"use strict";a.d(t,"a",(function(){return St}));var n=a(4),i=a.n(n),s=a(47),r=a(17),o=a(175),l=a(62),c=a(205),u=a(353),d=a(24),p=a.n(d),m=a(246);function g(e,t,a){return t+(e>1?a*(e-1):0)}var f=a(178);function b(){return Object(n.useMemo)((()=>({copyableFieldBackground:f.euiThemeVars.euiColorLightShade,descriptionText:f.euiThemeVars.euiTextColor,full:f.euiThemeVars.euiColorFullShade,graphControls:f.euiThemeVars.euiColorDarkestShade,graphControlsBackground:f.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:f.euiThemeVars.euiColorLightShade,processBackingFill:`${f.euiThemeVars.euiColorPrimary}${f.darkMode?"1F":"0F"}`,resolverBackground:f.euiThemeVars.euiColorEmptyShade,resolverEdge:f.darkMode?f.euiThemeVars.euiColorLightShade:f.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:f.euiThemeVars.euiColorLightestShade,resolverEdgeText:f.darkMode?f.euiThemeVars.euiColorFullShade:f.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${f.euiThemeVars.euiColorDanger}${f.darkMode?"1F":"0F"}`,pillStroke:f.euiThemeVars.euiColorLightShade,linkColor:f.euiThemeVars.euiLinkColor})),[])}const h=p.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-6iesrv-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${g(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),y=p.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-6iesrv-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),E=i.a.memo((({className:e,edgeLineMetadata:t,startPosition:a,endPosition:n,projectionMatrix:s})=>{const r=Object(m.c)(a,s),l=Object(m.c)(n,s),[c]=s,u=b(),d=null==t?void 0:t.elapsedTime,p=Object(m.d)(r,l),f=g(c,10,7.5),E={left:`${r[0]}px`,top:`${r[1]}px`,width:`${p}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(m.b)(r,l)}rad)`};let v=50;return c<1&&(v+=1/c*(10*(1-c))),i.a.createElement(h,{className:e,style:E,resolverEdgeColor:u.resolverEdge,magFactorX:c,"data-test-subj":"resolver:graph:edgeline"},d&&i.a.createElement(y,{backgroundColor:u.resolverEdge,leftPct:v,scaledTypeSize:f,textColor:u.resolverEdgeText},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:d.duration,durationType:d.durationType}})))}));var v=a(6),k=a(637);const S={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:a.n(k).a,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},T=Object(n.createContext)(S),x=p()(r.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-254p1f-0"})(["&.euiDescriptionList.euiDescriptionList--column dt.euiDescriptionList__title.desc-title{max-width:10em;}"]),w=p()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-254p1f-1"})(["overflow-wrap:break-word;"]),O=p()(r.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-254p1f-2"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text)),j=p.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-254p1f-3"})(["align-items:center;display:flex;flex-direction:row;"]),I=p.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-254p1f-4"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),C=p.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-254p1f-5"})([""]),M=p.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-254p1f-6"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],I,C),D=p()(r.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-254p1f-7"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),A=p()("time").withConfig({displayName:"StyledTime",componentId:"sc-254p1f-8"})(["display:inline-block;text-align:start;"]);function F(){const e=Object(s.useSelector)(c.E);return Object(n.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function R(e,t){const a=F(),i=b(),s=Object(n.useMemo)((()=>({runningProcessCube:{backingFill:i.processBackingFill,cubeSymbol:`#${a.runningProcessCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:f.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:i.processBackingFill,cubeSymbol:`#${a.loadingCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:f.euiThemeVars.euiColorPrimary},errorCube:{backingFill:i.processBackingFill,cubeSymbol:`#${a.errorCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:f.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:i.triggerBackingFill,cubeSymbol:`#${a.runningTriggerCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:f.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:i.processBackingFill,cubeSymbol:`#${a.terminatedProcessCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:f.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:i.triggerBackingFill,cubeSymbol:`#${a.terminatedTriggerCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:f.euiThemeVars.euiColorDanger}})),[a,i]);return"terminated"===e?t?s.terminatedTriggerCube:s[P.processTerminated]:"running"===e?t?s[P.processCausedAlert]:s[P.processRan]:"error"===e?s[P.processError]:s[P.processLoading]}const P={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},_=Object(n.memo)((function({className:e,size:t="2.15em",state:a,isOrigin:n,"data-test-subj":s}){const{cubeSymbol:r,strokeColor:o}=R(a,!1),{processCubeActiveBacking:l}=F();return i.a.createElement(q,{className:e,width:t,height:t,viewBox:"0 0 34 34","data-test-subj":s,isOrigin:n,style:{verticalAlign:"middle"}},i.a.createElement("desc",null,v.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process}}",values:{state:a}})),n&&i.a.createElement("use",{xlinkHref:`#${l}`,fill:"transparent",x:0,y:-1,stroke:o,strokeDashoffset:0,width:"100%",height:"100%"}),i.a.createElement("use",{role:"presentation",xlinkHref:r,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),q=p.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-14ztjy8-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),N=i.a.memo((function({children:e}){return i.a.createElement(i.a.Fragment,null,i.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,i.a.createElement("wbr",null)]}),[])]}return e})))})),L=p()(r.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-1wdm067-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),B=p.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-1wdm067-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),z=p()(r.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-1wdm067-2"})(["text-transform:uppercase;max-width:25%;"]),H=p()(r.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-1wdm067-3"})(["min-width:75%;width:75%;"]),$=p()(r.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-1wdm067-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),V=p.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-1wdm067-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor)),U=i.a.memo((({className:e})=>{const t=Object(s.useDispatch)(),a=Object(s.useSelector)(c.H),{timestamp:o}=Object(n.useContext)(T),[l,u]=Object(n.useState)(null),d=b(),p=Object(n.useCallback)((e=>{u(e===l?null:e)}),[u,l]),m=Object(n.useCallback)((()=>u(null)),[]),g=Object(n.useCallback)((e=>{const a=parseFloat(e.target.value);!1===isNaN(a)&&t({type:"userSetZoomLevel",payload:a})}),[t]),f=Object(n.useCallback)((()=>{t({type:"userSetPositionOfCamera",payload:[0,0]})}),[t]),h=Object(n.useCallback)((()=>{t({type:"userClickedZoomOut"})}),[t]),y=Object(n.useCallback)((()=>{t({type:"userClickedZoomIn"})}),[t]),[E,k,S,x]=Object(n.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((e=>()=>{const a={type:"userNudgedCamera",payload:{direction:e,time:o()}};t(a)}))),[t,o]);return i.a.createElement(V,{className:e,$iconColor:d.graphControls,"data-test-subj":"resolver:graph-controls"},i.a.createElement(B,null,i.a.createElement(Q,{closePopover:m,isOpen:"schemaInfo"===l,setActivePopover:p}),i.a.createElement(W,{closePopover:m,isOpen:"nodeLegend"===l,setActivePopover:p})),i.a.createElement(B,null,i.a.createElement(r.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("div",{className:"panning-controls-top"},i.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:E},i.a.createElement(r.EuiIcon,{type:"arrowUp"}))),i.a.createElement("div",{className:"panning-controls-middle"},i.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:x},i.a.createElement(r.EuiIcon,{type:"arrowLeft"})),i.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:f},i.a.createElement(r.EuiIcon,{type:"bullseye"})),i.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:k},i.a.createElement(r.EuiIcon,{type:"arrowRight"}))),i.a.createElement("div",{className:"panning-controls-bottom"},i.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:S},i.a.createElement(r.EuiIcon,{type:"arrowDown"})))),i.a.createElement(r.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("button",{title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:y},i.a.createElement(r.EuiIcon,{type:"plusInCircle"})),i.a.createElement(L,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:a,onChange:g}),i.a.createElement("button",{title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:h},i.a.createElement(r.EuiIcon,{type:"minusInCircle"})))))})),Q=({closePopover:e,setActivePopover:t,isOpen:a})=>{var o,l,u;const d=b(),p=Object(s.useSelector)(c.G),m=Object(n.useCallback)((()=>t("schemaInfo")),[t]),g=v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),f=v.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return i.a.createElement(r.EuiPopover,{button:i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:g,"aria-label":g,onClick:m,iconType:"iInCircle",$backgroundColor:d.graphControlsBackground,$iconColor:d.graphControls,$borderColor:d.graphControlsBorderColor}),isOpen:a,closePopover:e,anchorPosition:"leftCenter"},i.a.createElement(r.EuiPopoverTitle,{style:{textTransform:"uppercase"}},v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),i.a.createElement(r.EuiIconTip,{content:v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),i.a.createElement("div",{style:{maxWidth:"268px"}},i.a.createElement(x,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),i.a.createElement(H,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},i.a.createElement(N,null,null!==(o=null==p?void 0:p.dataSource)&&void 0!==o?o:f)),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),i.a.createElement(H,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},i.a.createElement(N,null,null!==(l=null==p?void 0:p.schema.id)&&void 0!==l?l:f)),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),i.a.createElement(H,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},i.a.createElement(N,null,null!==(u=null==p?void 0:p.schema.parent)&&void 0!==u?u:f))))))},W=({closePopover:e,setActivePopover:t,isOpen:a})=>{const s=Object(n.useCallback)((()=>t("nodeLegend")),[t]),o=b(),l=v.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return i.a.createElement(r.EuiPopover,{button:i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:l,"aria-label":l,onClick:s,iconType:"node",$backgroundColor:o.graphControlsBackground,$iconColor:o.graphControls,$borderColor:o.graphControlsBorderColor}),isOpen:a,closePopover:e,anchorPosition:"leftCenter"},i.a.createElement(r.EuiPopoverTitle,{style:{textTransform:"uppercase"}},v.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),i.a.createElement("div",{style:{maxWidth:"212px"}},i.a.createElement(x,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(_,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),i.a.createElement(H,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(N,null,v.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(_,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),i.a.createElement(H,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(N,null,v.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(_,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),i.a.createElement(H,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(N,null,v.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(_,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),i.a.createElement(H,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(N,null,v.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))};function G(e){return function(e,t){const a=Object(l.useHistory)(),i=Object(n.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),a.push(e)))}),[a,t,e]);return{href:a.createHref(e),onClick:i}}({search:Object(s.useSelector)((t=>c.D(t)(e)))})}var K=a(297);const J=i.a.memo((({className:e,nodeID:t,nodeStats:a})=>{const s=Object(n.useMemo)((()=>void 0===a?[]:Object.entries(a.byCategory).map((([e,t])=>({prefix:i.a.createElement(K.a,{count:t||0}),category:e})))),[a]);return void 0===s?null:i.a.createElement("ul",{className:`${e} options`,"aria-describedby":t},s.sort(((e,t)=>e.category.localeCompare(t.category))).map((e=>i.a.createElement(Y,{pill:e,nodeID:t,key:e.category}))))})),Y=({pill:e,nodeID:t})=>{const a=G({panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:e.category}}),{pillStroke:r,resolverBackground:o}=b(),l=Object(n.useMemo)((()=>({border:`1.5px solid ${r}`,backgroundColor:o})),[r,o]),c=Object(s.useDispatch)(),{timestamp:u}=Object(n.useContext)(T),d=Object(n.useCallback)((e=>{a.onClick(e),c({type:"userSelectedResolverNode",payload:{nodeID:t,time:u()}})}),[u,a,c,t]);return i.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:l,key:e.category},i.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:d},e.prefix," ",e.category))},X=p()(J).withConfig({displayName:"NodeSubMenu",componentId:"sc-1p5k68h-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),Z=p.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-1p5k68h-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),ee=p()(r.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-1p5k68h-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),te=p.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-1p5k68h-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),ae=p()(r.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-1p5k68h-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]),ne=s.useDispatch;var ie=a(237),se=a(242),re=a(279);const oe=p.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-14u1iy3-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),le=p.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-14u1iy3-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),ce=p.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-14u1iy3-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),ue=p.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-14u1iy3-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),de=i.a.memo((({className:e,position:t,node:a,nodeID:l,projectionMatrix:u,timeAtRender:d})=>{const p=`resolver:${Object(s.useSelector)(c.E)}`,f=F(),{timestamp:h}=Object(n.useContext)(T),[y,E]=Object(m.c)(t,u),[k]=u,S=Object(s.useSelector)(c.a),x=Object(s.useSelector)(c.I),w=Object(s.useSelector)(c.y),O=Object(s.useSelector)((e=>c.x(e)(l))),j=Object(n.useCallback)((e=>Object(r.htmlIdGenerator)(p)(`${e}:node`)),[p]),I=Object(s.useSelector)((e=>c.c(e)(l))),C=Object(s.useSelector)((e=>c.b(e)(d)(l))),M=k>.8,D=k>=.55,A=(M?3.5:D?1:21)*k+5,P=360*(M?-.147413:-.147413-.08*(k-.5))*k,_=120*(M?-.53684:.2*-k*(1-k)/k-.53684)*k,q=Object(n.useMemo)((()=>({left:`${y+P}px`,top:`${E+_}px`,width:360*k+"px",height:120*k+"px"})),[y,k,P,_,E]),N=g(k,18.75,12.5),L=i.a.createRef(),B=b(),z=Object(s.useSelector)((e=>c.v(e)(l))),H="loading"===z,{backingFill:$,cubeSymbol:V,descriptionText:U,isLabelFilled:Q,labelButtonFill:W,strokeColor:K}=R(z,!1),J=Object(r.htmlIdGenerator)("resolver")(`${l}:label`),Y=l===S,Z=l===x,ee=l===w,te=ne(),ae=G({panelView:"nodeDetail",panelParameters:{nodeID:l}}),de=Object(n.useCallback)((()=>{te({type:"userFocusedOnResolverNode",payload:{nodeID:l,time:h()}})}),[te,l,h]),pe=Object(n.useCallback)((e=>{var t;null!==(t=L.current)&&void 0!==t&&t.beginElement&&L.current.beginElement(),"error"===z?te({type:"userReloadedResolverNode",payload:l}):(te({type:"userSelectedResolverNode",payload:{nodeID:l,time:h()}}),ae.onClick(e))}),[L,te,l,ae,z,h]),me=Object(s.useSelector)((e=>c.J(e)(a))),ge=ie.c(a),fe=Object(s.useSelector)((e=>re.a(c.u(e)(String(a.id))))),be=Object(n.useMemo)((()=>void 0!==fe?se.l(fe):ge),[fe,ge]);return i.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":l,className:`${e} kbn-resetFocusState`,role:"treeitem","aria-level":null===I?void 0:I,"aria-flowto":null===C?void 0:j(C),"aria-labelledby":J,"aria-haspopup":"true","aria-current":Y?"true":void 0,"aria-selected":Z?"true":void 0,style:q,id:j(l),tabIndex:-1},i.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{de(),pe(e)},role:"img","aria-labelledby":J,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},i.a.createElement(ue,{isNodeLoading:H},i.a.createElement("use",{xlinkHref:`#${f.processCubeActiveBacking}`,fill:$,x:-15.35,y:-15.35,stroke:K,width:22.5,height:22.5,className:"backing"}),ee&&i.a.createElement("use",{xlinkHref:`#${f.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:K,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),i.a.createElement("use",{role:"presentation",xlinkHref:V,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},i.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:L})))),i.a.createElement(oe,{color:B.full,fontSize:N,topPct:A},i.a.createElement(le,{backgroundColor:B.resolverBackground,color:B.descriptionText,isDisplaying:D,"data-test-subj":"resolver:node:description"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event · {descriptionText}} false {{descriptionText}}}",values:{isEventBeingAnalyzed:ee,descriptionText:U}})),i.a.createElement("div",{className:"euiButton euiButton--small",id:J,onClick:pe,onFocus:de,tabIndex:-1,style:{backgroundColor:B.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},i.a.createElement(r.EuiButton,{iconSide:H?"right":"left",isLoading:H,color:W,fill:Q,iconType:"error"===z?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*k,32)}px`,maxWidth:(M?400:210*k)+"px"},tabIndex:-1,title:be,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":l},i.a.createElement(ce,{isShowingIcon:"loading"===z||"error"===z},i.a.createElement("span",{className:"euiButton__text","data-test-subj":"euiButton__text"},v.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:z,nodeName:be}}))))),i.a.createElement(r.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:B.resolverBackground,display:M?"flex":"none",margin:"2px 0 0 0",padding:0}},i.a.createElement(r.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==me&&me>0&&i.a.createElement(X,{buttonFill:B.resolverBackground,nodeStats:O,nodeID:l})))))})),pe=p()(de).withConfig({displayName:"ProcessEventDot",componentId:"sc-14u1iy3-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var me=a(56);function ge(){const e=Object(s.useSelector)(c.E);return Object(n.useMemo)((()=>{const t=`${e}-symbols`;return{runningProcessCube:`${t}-psRunningProcessCube`,runningTriggerCube:`${t}-psRunningTriggerCube`,terminatedProcessCube:`${t}-psTerminatedProcessCube`,terminatedTriggerCube:`${t}-psTerminatedTriggerCube`,loadingCube:`${t}-psLoadingCube`,errorCube:`${t}-psErrorCube`}}),[e])}const fe=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),be=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),he=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),ye=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),Ee=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),ve=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),ke=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),Se=Object(n.memo)((({isDarkMode:e})=>{const t=ge();return i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:t.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#6D6D6D"}),i.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),i.a.createElement("linearGradient",{id:t.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),i.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),i.a.createElement("linearGradient",{id:t.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"})),e?i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:t.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),i.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),i.a.createElement("linearGradient",{id:t.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:t.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),i.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),i.a.createElement("linearGradient",{id:t.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#DD0A73"}),i.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),Te=Object(n.memo)((({isDarkMode:e})=>{const t=F(),a=ge();return i.a.createElement(i.a.Fragment,null,i.a.createElement("symbol",{id:t.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},i.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),i.a.createElement("symbol",{id:t.loadingCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,fe),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:e?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),i.a.createElement("symbol",{id:t.errorCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,be),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.errorCube})`}),i.a.createElement("g",{opacity:"0.6"},i.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${a.errorCube})`}),i.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:t.runningProcessCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,he),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.runningProcessCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{id:t.runningTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,ye),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.runningTriggerCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{viewBox:"0 0 88 100",id:t.terminatedProcessCube},i.a.createElement("title",null,Ee),i.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:e?"#010101":"#fff"}),i.a.createElement("g",{opacity:"0.7"},i.a.createElement("path",{opacity:e?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${a.terminatedProcessCube})`}),i.a.createElement("path",{opacity:e?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:e?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:t.terminatedTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,ve),e&&i.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("g",{opacity:"0.6"},!e&&i.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("path",{opacity:e?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${a.terminatedTriggerCube})`}),i.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{viewBox:"0 -3 88 106",id:t.processCubeActiveBacking},i.a.createElement("title",null,ke),i.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),xe=Object(n.memo)((()=>{const e=Object(me.useUiSetting)("theme:darkMode");return i.a.createElement(we,null,i.a.createElement("defs",null,i.a.createElement(Se,{isDarkMode:e}),i.a.createElement(Te,{isDarkMode:e})))})),we=p()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-1sziupc-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var Oe=a(53),je=a.n(Oe);const Ie=Object(n.memo)((function({breadcrumbs:e}){const t=Object(n.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:a,resolverEdgeText:s}=b();return i.a.createElement(i.a.Fragment,null,i.a.createElement(O,{background:a,text:s,breadcrumbs:t,truncate:!1}))})),Ce=p.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-1wo8ziw-0"})(["margin-right:5px;"]);function Me(){const e=v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),t=v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),a=G({panelView:"nodes"}),s=Object(n.useMemo)((()=>[{text:t,...a}]),[a,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ie,{breadcrumbs:s}),i.a.createElement(r.EuiSpacer,{size:"l"}),i.a.createElement(r.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},i.a.createElement(Ce,null,i.a.createElement(r.EuiLoadingSpinner,{size:"m"})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiText,{"data-test-subj":"resolver:panel:loading"},e))))}function De({event:e}){var t,a,n,s,r,l,c,u,d,p,m,g,f,b,h,y,E,v,k;return Object(se.i)(e)?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(se.l)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(p=e.network)||void 0===p?void 0:p.forwarded_ip),networkDirection:String(null===(m=e.network)||void 0===m?void 0:m.direction)}}):null!==(a=e.kibana)&&void 0!==a&&null!==(n=a.alert)&&void 0!==n&&null!==(s=n.rule)&&void 0!==s&&s.name?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.alertEventNameLabel",defaultMessage:"{ ruleName }",values:{ruleName:String(null===(g=e.kibana)||void 0===g||null===(f=g.alert)||void 0===f||null===(b=f.rule)||void 0===b?void 0:b.name)}}):null!==(r=e.file)&&void 0!==r&&r.path?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(h=e.file)||void 0===h?void 0:h.path)}}):null!==(l=e.registry)&&void 0!==l&&l.path?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(y=e.registry)||void 0===y?void 0:y.path)}}):null!==(c=e.registry)&&void 0!==c&&c.key?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(E=e.registry)||void 0===E?void 0:E.key)}}):null!==(u=e.dns)&&void 0!==u&&null!==(d=u.question)&&void 0!==d&&d.name?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(v=e.dns)||void 0===v||null===(k=v.question)||void 0===k?void 0:k.name)}}):i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(se.b)(e)}})}var Ae=a(69),Fe=a.n(Ae);const Re=v.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),Pe=new Intl.DateTimeFormat(v.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function _e(e){const t=Object(me.useUiSetting)("dateFormat"),a=Object(me.useUiSetting)("dateFormat:tz"),n="Browser"===a?Fe.a.tz.guess():a;if(!e)return;const i=new Date(e);return i&&Number.isFinite(i.getTime())?t?Fe.a.tz(i,n).format(t):Pe.format(i):Re}var qe=a(391);const Ne=Object(n.memo)((function({nodeID:e,eventCategory:t}){const a=Object(s.useSelector)((t=>c.g(t)(e))),n=Object(s.useSelector)(c.p),l=Object(s.useSelector)(c.h);return i.a.createElement(i.a.Fragment,null,n?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):i.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},l||!a?i.a.createElement(r.EuiCallOut,{title:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"alert","data-test-subj":"resolver:nodeEventsInCategory:error"},i.a.createElement("p",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(ze,{nodeName:a.name,eventCategory:t,nodeID:e}),i.a.createElement(r.EuiSpacer,{size:"l"}),i.a.createElement(Be,{eventCategory:t,nodeID:e}))))})),Le=Object(n.memo)((function({event:e,nodeID:t,eventCategory:a}){const n=Object(qe.a)(e),s=se.g(n),l=se.e(n),c=se.p(n),u=_e(s)||v.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),d=G({panelView:"eventDetail",panelParameters:{nodeID:t,eventCategory:a,eventID:l,eventTimestamp:String(s),winlogRecordID:String(c)}});return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiText,null,i.a.createElement(D,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:se.d(n).join(", "),eventType:se.h(n).join(", ")},defaultMessage:"{category} {eventType}"})),i.a.createElement(A,{dateTime:u},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:u},defaultMessage:"@ {date}"}))),i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(r.EuiButtonEmpty,je()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},d),i.a.createElement(De,{event:n})))})),Be=Object(n.memo)((function({eventCategory:e,nodeID:t}){const a=Object(s.useSelector)(c.w),l=ne(),u=Object(n.useCallback)((()=>{l({type:"userRequestedAdditionalRelatedEvents"})}),[l]),d=Object(s.useSelector)(c.o),p=Object(s.useSelector)(c.r);return i.a.createElement(i.a.Fragment,null,a.map(((s,o)=>i.a.createElement(n.Fragment,{key:o},i.a.createElement(Le,{nodeID:t,eventCategory:e,event:s}),o===a.length-1?null:i.a.createElement(r.EuiHorizontalRule,{margin:"m"})))),p&&i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{color:"primary",size:"s",fill:!0,onClick:u,isLoading:d,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),ze=Object(n.memo)((function({nodeName:e,eventCategory:t,nodeID:a}){const n=Object(s.useSelector)((e=>c.L(e)(a))),r=Object(s.useSelector)((e=>c.B(e)(a,t))),l=G({panelView:"nodes"}),u=G({panelView:"nodeDetail",panelParameters:{nodeID:a}}),d=G({panelView:"nodeEvents",panelParameters:{nodeID:a}});return i.a.createElement(Ie,{breadcrumbs:[{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...l},{text:e,...u},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:n},defaultMessage:"{totalCount} Events"}),...d},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:r,category:t},defaultMessage:"{count} {category}"})}]})}));function He({nodeID:e}){const t=Object(s.useSelector)((t=>re.a(c.u(t)(e)))),a=Object(s.useSelector)((t=>c.x(t)(e)));return void 0===t||void 0===a?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Ve,{nodeName:se.l(t),nodeID:e,totalEventCount:a.total}),i.a.createElement(r.EuiSpacer,{size:"l"}),i.a.createElement($e,{nodeID:e,relatedStats:a}))}const $e=Object(n.memo)((function({nodeID:e,relatedStats:t}){const a=Object(n.useMemo)((()=>Object.entries(t.byCategory).map((([e,t])=>({eventType:e,count:t})))),[t.byCategory]),s=Object(n.useMemo)((()=>[{field:"count",name:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"20%",sortable:!0},{field:"eventType",name:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"80%",sortable:!0,render:t=>i.a.createElement(Ue,{nodeID:e,eventType:t},t)}]),[e]);return i.a.createElement(r.EuiInMemoryTable,{items:a,columns:s,sorting:!0})})),Ve=Object(n.memo)((function({nodeID:e,nodeName:t,totalEventCount:a}){return i.a.createElement(Ie,{breadcrumbs:[{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...G({panelView:"nodes"})},{text:t,...G({panelView:"nodeDetail",panelParameters:{nodeID:e}})},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:a},defaultMessage:"{totalCount} Events"}),...G({panelView:"nodeEvents",panelParameters:{nodeID:e}})}]})})),Ue=Object(n.memo)((({nodeID:e,eventType:t,children:a})=>{const n=G({panelView:"nodeEventsInCategory",panelParameters:{nodeID:e,eventCategory:t}});return i.a.createElement(r.EuiButtonEmpty,je()({"data-test-subj":"resolver:panel:node-events:event-type-link"},n),a)})),Qe=p.a.div.withConfig({displayName:"StyledCopyableField",componentId:"sc-3rurpv-0"})(["border-radius:3px;padding:4px;transition:background 0.2s ease;",":hover &{background-color:",";&:hover{background-color:",";color:#fff;}}"],ee,(e=>e.backgroundColor),(e=>e.activeBackgroundColor)),We=Object(n.memo)((({textToCopy:e,content:t})=>{var a;const{linkColor:s,copyableFieldBackground:o}=b(),[l,c]=Object(n.useState)(!1),u=null===(a=Object(me.useKibana)().services.notifications)||void 0===a?void 0:a.toasts,d=()=>c(!0),p=()=>c(!1),m=Object(n.useMemo)((()=>i.a.createElement(Qe,{backgroundColor:o,"data-test-subj":"resolver:panel:copyable-field-hover-area",activeBackgroundColor:s,onMouseEnter:d},t)),[t,o,s]),{writeTextToClipboard:g}=Object(n.useContext)(T),f=Object(n.useCallback)((async()=>{try{await g(e)}catch(e){u&&u.addError(e,{title:v.i18n.translate("xpack.securitySolution.resolver.panel.copyFailureTitle",{defaultMessage:"Copy Failure"})})}}),[e,u,g]);return i.a.createElement("div",{onMouseLeave:p},i.a.createElement(r.EuiPopover,{anchorPosition:"downCenter",button:m,closePopover:p,hasArrow:!1,isOpen:l,panelPaddingSize:"s"},i.a.createElement(r.EuiToolTip,{content:v.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"})},i.a.createElement(r.EuiButtonIcon,{"aria-label":v.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"}),color:"text","data-test-subj":"resolver:panel:clipboard",iconType:"copyClipboard",onClick:f}))))}));var Ge=a(354);const Ke=Object(n.memo)((function({translatedErrorMessage:e}){const t=G({panelView:"nodes"}),a=Object(n.useMemo)((()=>[{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...t},{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ie,{breadcrumbs:a}),i.a.createElement(r.EuiSpacer,{size:"l"}),i.a.createElement(r.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},e),i.a.createElement(r.EuiSpacer,{size:"l"}),i.a.createElement(r.EuiButtonEmpty,t,v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),Je=p()(_).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-821tkc-0"})(["position:relative;"]),Ye=v.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),Xe=Object(n.memo)((function({nodeID:e}){const t=Object(s.useSelector)((t=>re.a(c.u(t)(e))));return"loading"===Object(s.useSelector)((t=>c.v(t)(e)))?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):t?i.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},i.a.createElement(Ze,{nodeID:e,processEvent:t})):i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Ke,{translatedErrorMessage:Ye}))})),Ze=Object(n.memo)((function({processEvent:e,nodeID:t}){const a=se.l(e),l=Object(s.useSelector)((e=>c.v(e)(t))),u=Object(s.useSelector)((e=>c.C(e)(t))),d=_e(se.g(e)),p=Object(n.useMemo)((()=>{const t={title:"@timestamp",description:d},a={title:"process.executable",description:Object(Ge.d)(e)},n={title:"process.pid",description:Object(Ge.c)(e)},s={title:"user.name",description:se.o(e)};return[t,a,n,{title:"process.entity_id",description:se.c(e)},s,{title:"user.domain",description:se.n(e)},{title:"process.parent.pid",description:se.k(e)},{title:"process.hash.md5",description:se.j(e)},{title:"process.args",description:se.a(e)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:i.a.createElement(We,{textToCopy:String(e.description),content:i.a.createElement(N,null,String(e.description))})})))}),[d,e]),m=G({panelView:"nodes"}),g=Object(n.useMemo)((()=>[{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...m},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:a},defaultMessage:"Details for: {processName}"})}]),[a,m]),{descriptionText:f}=R(l,!1),b=G({panelView:"nodeEvents",panelParameters:{nodeID:t}}),h=Object(n.useMemo)((()=>Object(r.htmlIdGenerator)("resolverTable")()),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ie,{breadcrumbs:g}),i.a.createElement(r.EuiSpacer,{size:"l"}),i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement(w,{"aria-describedby":h},i.a.createElement(Je,{"data-test-subj":"resolver:node-detail:title-icon",state:l}),i.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},i.a.createElement(N,null,a)))),i.a.createElement(r.EuiText,null,i.a.createElement(r.EuiTextColor,{color:"subdued"},i.a.createElement("span",{id:h},f))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiLink,je()({},b,{"data-test-subj":"resolver:node-detail:node-events-link"}),i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:u},defaultMessage:"{relatedEventTotal} Events"})),i.a.createElement(r.EuiSpacer,{size:"l"}),i.a.createElement(x,{"data-test-subj":"resolver:node-detail",type:"column",align:"left",titleProps:{"data-test-subj":"resolver:node-detail:entry-title",className:"desc-title"},descriptionProps:{"data-test-subj":"resolver:node-detail:entry-description"},compressed:!0,listItems:p}))})),et=i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),tt=i.a.memo((function({numberOfEntries:e}){return i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),at=i.a.memo((function({numberDisplayed:e}){return i.a.createElement(ae,{size:"s",title:i.a.createElement(tt,{numberOfEntries:e})},i.a.createElement("p",null,et))})),nt=Object(n.memo)((()=>{const e=Object(n.useMemo)((()=>[{field:"name",name:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(e,t)=>i.a.createElement(it,{name:e,nodeID:t.nodeID})},{field:"timestamp",name:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:e=>i.a.createElement(st,{eventDate:e})}]),[]),t=Object(s.useSelector)(Object(n.useCallback)((e=>{const{processNodePositions:t}=c.s(e),a=[];for(const e of t.keys()){const t=ie.c(e),n=ie.b(e);void 0!==n&&a.push({name:t,timestamp:ie.e(e),nodeID:n})}return a}),[])),a=t.length,o=Object(n.useMemo)((()=>[{text:v.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),l=Object(s.useSelector)(c.k),u=Object(s.useSelector)(c.j),d=Object(s.useSelector)(c.l),p=!0===l||!0===u||!0===d,m=Object(n.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Ie,{breadcrumbs:o}),p&&i.a.createElement(at,{numberDisplayed:a}),i.a.createElement(r.EuiSpacer,{size:"l"}),i.a.createElement(r.EuiInMemoryTable,{rowProps:m,"data-test-subj":"resolver:node-list",items:t,columns:e,sorting:!0}))}));function it({name:e,nodeID:t}){const a=Object(s.useSelector)((e=>c.y(e)===t)),o=Object(s.useSelector)((e=>c.v(e)(t))),{descriptionText:l}=b(),u=G({panelView:"nodeDetail",panelParameters:{nodeID:t}}),d=Object(s.useDispatch)(),{timestamp:p}=Object(n.useContext)(T),m=Object(n.useCallback)((e=>{u.onClick(e),d({type:"userSelectedResolverNode",payload:{nodeID:t,time:p()}})}),[p,u,d,t]);return i.a.createElement(r.EuiButtonEmpty,{onClick:m,href:u.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":t},void 0===e?i.a.createElement(r.EuiBadge,{color:"warning"},v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):i.a.createElement(j,null,i.a.createElement(_,{state:o,isOrigin:a,"data-test-subj":"resolver:node-list:node-link:icon"}),i.a.createElement(M,null,a&&i.a.createElement(I,{color:l,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},v.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),i.a.createElement(C,{"data-test-subj":"resolver:node-list:node-link:title"},e))))}const st=Object(n.memo)((({eventDate:e})=>{const t=_e(e);return t?i.a.createElement(We,{textToCopy:t,content:t}):i.a.createElement("span",null,"—")}));function rt(e){const t=[{path:[],value:e}],a=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:n,value:i}=e;Array.isArray(i)?t.push(...i.map((e=>({path:[...n],value:e})))):"object"==typeof i&&null!==i?t.push(...Object.keys(i).map((e=>({path:[...n,e],value:i[e]})))):null!=i&&a.push([n,i])}return a}const ot=v.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),lt=Object(n.memo)((function({nodeID:e,eventCategory:t}){const a=Object(s.useSelector)(c.n),n=Object(s.useSelector)(c.q),r=Object(s.useSelector)((t=>re.a(c.u(t)(e)))),o=Object(s.useSelector)((t=>c.v(t)(e))),l=a||n||"loading"===o,u=Object(s.useSelector)(c.d);return l?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):u?i.a.createElement(ct,{nodeID:e,event:u,processEvent:r,eventType:t}):i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Ke,{translatedErrorMessage:ot}))})),ct=Object(n.memo)((function({nodeID:e,event:t,eventType:a,processEvent:n}){const s=_e(se.m(t))||v.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),l=n?se.l(n):null;return i.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},i.a.createElement(dt,{nodeID:e,nodeName:l,event:t,breadcrumbEventCategory:a}),i.a.createElement(r.EuiSpacer,{size:"l"}),i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(D,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:a,eventType:String(se.h(t))},defaultMessage:"{category} {eventType}"})),i.a.createElement(A,{dateTime:s},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:s},defaultMessage:"@ {date}"}))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(mt,null,i.a.createElement(N,null,i.a.createElement(De,{event:t}))),i.a.createElement(r.EuiSpacer,{size:"l"}),i.a.createElement(ut,{event:t}))}));function ut({event:e}){const t=Object(n.useMemo)((()=>{const t=[],a=Object(qe.a)(e);for(const[e,n]of Object.entries(a)){if("agent"===e||"ecs"===e||"@timestamp"===e||!n)continue;const a={namespace:i.a.createElement(N,null,e),descriptions:rt(n).map((([t,a])=>{const n=[e,...t].join(".");return{title:i.a.createElement(N,null,n),description:i.a.createElement(We,{textToCopy:String(a),content:i.a.createElement(N,null,String(a))})}}))};t.push(a)}return t}),[e]);return i.a.createElement(i.a.Fragment,null,t.map((({namespace:e,descriptions:a},s)=>i.a.createElement(n.Fragment,{key:s},0===s?null:i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiTitle,{size:"xxxs"},i.a.createElement(r.EuiTextColor,{color:"subdued"},i.a.createElement(gt,null,e,i.a.createElement(ft,null)))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(pt,{type:"column",align:"left",titleProps:{className:"desc-title","data-test-subj":"resolver:panel:event-detail:event-field-title"},compressed:!0,listItems:a}),s===t.length-1?null:i.a.createElement(r.EuiSpacer,{size:"m"})))))}function dt({nodeID:e,nodeName:t,event:a,breadcrumbEventCategory:r}){const l=Object(s.useSelector)((t=>c.B(t)(e,r))),u=Object(s.useSelector)((t=>c.C(t)(e))),d=G({panelView:"nodes"}),p=G({panelView:"nodeDetail",panelParameters:{nodeID:e}}),m=G({panelView:"nodeEvents",panelParameters:{nodeID:e}}),g=G({panelView:"nodeEventsInCategory",panelParameters:{nodeID:e,eventCategory:r}}),f=Object(n.useMemo)((()=>{const e=[{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...d},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:u},defaultMessage:"{totalCount} Events"}),...m},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:l,category:r},defaultMessage:"{count} {category}"}),...g},{text:i.a.createElement(De,{event:a})}];return t&&e.splice(1,0,{text:t,...p}),e}),[r,l,a,p,m,t,u,d,g]);return i.a.createElement(Ie,{breadcrumbs:f})}const pt=Object(n.memo)(p()(r.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-wbnmrd-0"})(["&.euiDescriptionList.euiDescriptionList--column dt.euiDescriptionList__title.desc-title{max-width:8em;overflow-wrap:break-word;}&.euiDescriptionList.euiDescriptionList--column dd.euiDescriptionList__description{max-width:calc(100% - 8.5em);overflow-wrap:break-word;}"])),mt=Object(n.memo)(p()(r.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-wbnmrd-1"})(["padding-right:1em;overflow-wrap:break-word;"])),gt=Object(n.memo)(p()("h3").withConfig({displayName:"StyledFlexTitle",componentId:"sc-wbnmrd-2"})(["align-items:center;display:flex;flex-flow:row;font-size:1.2em;"])),ft=Object(n.memo)((()=>i.a.createElement(r.EuiHorizontalRule,{margin:"none",size:"half"}))),bt=Object(n.memo)((function(){const e=Object(s.useSelector)(c.z);return"nodeDetail"===e.panelView?i.a.createElement(Xe,{nodeID:e.panelParameters.nodeID}):"nodeEvents"===e.panelView?i.a.createElement(He,{nodeID:e.panelParameters.nodeID}):"nodeEventsInCategory"===e.panelView?i.a.createElement(Ne,{nodeID:e.panelParameters.nodeID,eventCategory:e.panelParameters.eventCategory}):"eventDetail"===e.panelView?i.a.createElement(lt,{nodeID:e.panelParameters.nodeID,eventCategory:e.panelParameters.eventCategory}):i.a.createElement(nt,null)}));var ht=a(364);const yt=p()(r.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-r4p8yj-0"})(["align-self:flex-start;display:inline-block;"]),Et=p()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-r4p8yj-1"})(["max-width:600px;margin:60px auto 0;"]),vt=()=>i.a.createElement(Et,{"data-test-subj":"resolver:no-process-events",direction:"column"},i.a.createElement(r.EuiTitle,null,i.a.createElement("h4",null,v.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiText,{size:"s"},v.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiText,{size:"s"},v.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiText,{size:"s"},v.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(yt,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"'));var kt=a(202);const St=i.a.memo(i.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:a,indices:d,shouldUpdate:p,filters:m},g){!function(){const e=Object(n.useRef)();e.current=Object(l.useLocation)().search;const t=Object(l.useHistory)(),a=Object(s.useSelector)(c.E),i=Object(u.a)(a);Object(n.useEffect)((()=>{const a=i;return()=>{const n=new URLSearchParams(e.current);n.delete(a);const i={search:n.toString()};t.replace(i)}}),[i,t])}(),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:a,filters:i,shouldUpdate:s}){const r=ne(),o=Object(l.useLocation)().search;Object(n.useLayoutEffect)((()=>{r({type:"appReceivedNewExternalProperties",payload:{databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:o,indices:a,shouldUpdate:s,filters:i}})}),[r,e,t,o,a,s,i])}({databaseDocumentID:t,resolverComponentInstanceID:a,indices:d,shouldUpdate:p,filters:m}),function(){const{addSuccess:e}=Object(kt.a)(),{from:t,to:a}=Object(s.useSelector)((e=>{const t=c.e(e);return{from:null!=t&&t.from?t.from:void 0,to:null!=t&&t.to?t.to:void 0}})),i=_e(t),r=_e(a),o=Object(n.useMemo)((()=>v.i18n.translate("xpack.securitySolution.resolver.unboundedRequest.toast",{defaultMessage:"No results found in the selected time, expanded to {from} - {to}.",values:{from:i,to:r}})),[i,r]);Object(n.useEffect)((()=>{(t||a)&&e(o)}),[e,o,t,a])}(),function(){const e=Object(s.useDispatch)(),t=Object(s.useSelector)(c.E),a=Object(l.useLocation)().search,i=Object(n.useContext)(T),r=Object(s.useSelector)(c.I),o=Object(s.useSelector)(c.g),u=Object(ht.a)({locationSearch:a,resolverComponentInstanceID:t});let d;"nodes"!==u.panelView&&(d=u.panelParameters.nodeID),Object(n.useEffect)((()=>{d&&o(d)&&d!==r&&e({type:"userSelectedResolverNode",payload:{nodeID:d,time:i.timestamp()}})}),[u.panelView,d,e,o,r,i])}();const{timestamp:f}=Object(n.useContext)(T),h=f(),{processNodePositions:y,connectingEdgeLineSegments:k}=Object(s.useSelector)((e=>c.P(e)(h))),{projectionMatrix:S,ref:x,onMouseDown:w}=function(){const e=ne(),t=Object(n.useContext)(T),[a,i]=Object(n.useState)(null),r=Object(s.useSelector)(c.A),o=Object(n.useRef)(),[l,u]=Object(n.useState)(r(t.timestamp())),d=Object(s.useSelector)(c.O),p=Object(s.useSelector)(c.m),[m,g]=function(){const{getBoundingClientRect:e}=Object(n.useContext)(T),[t,a]=Object(n.useState)(null),{ResizeObserver:i,requestAnimationFrame:s}=Object(n.useContext)(T),[r,o]=Object(n.useState)(null),l=Object(n.useCallback)((e=>{o(e)}),[]);return Object(n.useEffect)((()=>{null!==r&&a(e(r))}),[r,e]),Object(n.useEffect)((()=>{let t=window.scrollX,n=window.scrollY;const i=()=>{s((()=>{const i=window.scrollX,s=window.scrollY;null===r||t===i&&n===s||a(e(r)),t=i,n=s}))};return window.addEventListener("scroll",i,{passive:!0}),()=>{window.removeEventListener("scroll",i)}}),[r,s,e]),Object(n.useEffect)((()=>{if(null!==r){const t=new i((t=>{null!==r&&r===t[0].target&&a(e(r))}));return t.observe(r),()=>{t.disconnect()}}}),[i,r,e]),[t,l]}(),f=Object(n.useCallback)((e=>null===m?null:[e.clientX-m.x,e.clientY-m.y]),[m]),b=Object(n.useCallback)((a=>{const n=f(a);null!==n&&e({type:"userStartedPanning",payload:{screenCoordinates:n,time:t.timestamp()}})}),[e,f,t]),h=Object(n.useCallback)((a=>{const n=f(a);n&&e({type:"userMovedPointer",payload:{screenCoordinates:n,time:t.timestamp()}})}),[e,f,t]),y=Object(n.useCallback)((()=>{d&&e({type:"userStoppedPanning",payload:{time:t.timestamp()}})}),[e,t,d]),E=Object(n.useCallback)((a=>{null!==m&&a.ctrlKey&&0!==a.deltaY&&0===a.deltaMode&&(a.preventDefault(),e({type:"userZoomed",payload:{zoomChange:a.deltaY/-m.height,time:t.timestamp()}}))}),[m,e,t]),v=Object(n.useCallback)((e=>{i(e),g(e)}),[g]);return Object(n.useEffect)((()=>(window.addEventListener("mouseup",y,{passive:!0}),()=>{window.removeEventListener("mouseup",y)})),[y]),Object(n.useEffect)((()=>(window.addEventListener("mousemove",h,{passive:!0}),()=>{window.removeEventListener("mousemove",h)})),[h]),Object(n.useEffect)((()=>{if(null!==a)return a.addEventListener("wheel",E),()=>{a.removeEventListener("wheel",E)}}),[a,E]),Object(n.useLayoutEffect)((()=>{o.current=r}),[r]),Object(n.useLayoutEffect)((()=>{u(r(t.timestamp()))}),[r,t]),Object(n.useLayoutEffect)((()=>{const e=t.timestamp();if(p(e)){let e=null;const a=()=>{const n=t.timestamp();void 0!==o.current&&u(o.current(n)),e=p(n)?t.requestAnimationFrame(a):null};return e=t.requestAnimationFrame(a),()=>{null!==e&&t.cancelAnimationFrame(e)}}}),[p,t]),Object(n.useEffect)((()=>{null!==m&&e({type:"userSetRasterSize",payload:[m.width,m.height]})}),[e,m]),{ref:v,onMouseDown:b,projectionMatrix:l}}(),O=Object(n.useCallback)((e=>{x(e),"function"==typeof g?g(e):null!==g&&(g.current=e)}),[x,g]),j=Object(s.useSelector)(c.q),I=Object(s.useSelector)(c.i),C=Object(s.useSelector)(c.a),M=Object(s.useSelector)(c.F),D=b();return i.a.createElement(Z,{className:e,backgroundColor:D.resolverBackground},j?i.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"})):I?i.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},i.a.createElement("div",null," ",i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):M?i.a.createElement(i.a.Fragment,null,i.a.createElement(te,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:w,ref:O,role:"tree",tabIndex:0,"aria-activedescendant":C||void 0},k.map((({points:[e,t],metadata:a})=>i.a.createElement(E,{edgeLineMetadata:a,key:a.reactKey,startPosition:e,endPosition:t,projectionMatrix:S}))),[...y].map((([e,t])=>{const a=ie.b(e);if(void 0===a)throw new Error("Tried to render a node without an ID");return i.a.createElement(pe,{key:a,nodeID:a,position:t,projectionMatrix:S,node:e,timeAtRender:h})}))),i.a.createElement(bt,null)):i.a.createElement(vt,null),i.a.createElement(U,null),i.a.createElement(xe,null))})))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return It})),a.d(t,"b",(function(){return Dt}));var n=a(17),i=a(4),s=a.n(i),r=a(24),o=a.n(r),l=a(6),c=a(5),u=a(462),d=a.n(u),p=a(175),m=a(263),g=a(376),f=a(351),b=a(224),h=a(19),y=a(405),E=a(250),v=a(417),k=a(20),S=a(92),T=a.n(S),x=a(180),w=a(740),O=a(596),j=a(241),I=a(662),C=a(253),M=a(491),D=a(210);const A=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineModalTitle",{defaultMessage:"Import query from saved timeline"}),F=["duplicate","createFrom"],R=e=>{var t;return{filters:null!==(t=e.attributes.filters)&&void 0!==t?t:[],query:e.attributes.query,saved_id:e.id,title:e.attributes.title}},P=({defaultSavedQuery:e,browserFields:t,dataTestSubj:a,field:r,idAria:o,indexPattern:l,isLoading:c=!1,onCloseTimelineSearch:u,openTimelineSearch:d=!1,resizeParentContainer:p,onValidityChange:m,isDisabled:g,resetToSavedQuery:f,onSavedQueryError:b})=>{const{value:y,setValue:E}=r,[v,S]=Object(i.useState)(-1),[P,_]=Object(i.useState)(!1),[q,N]=Object(i.useState)(e),[L,B]=Object(i.useState)(!1),{isInvalid:z,errorMessage:H}=Object(D.i)(r),{uiSettings:$}=Object(h.k)().services,[V]=Object(i.useState)(new x.FilterManager($)),U=Object(M.a)();Object(i.useEffect)((()=>{null!=m&&m(!z)}),[z,m]),Object(i.useEffect)((()=>{let e=!0;const t=new k.Subscription;return V.setFilters([]),t.add(V.getUpdates$().subscribe({next:()=>{if(e){const e=V.getFilters(),{filters:t}=y;T()(t,e)||E({...y,filters:e})}}})),()=>{e=!1,t.unsubscribe()}}),[y,V,E]),Object(i.useEffect)((()=>{let e=!0;return async function(){const{filters:t,saved_id:a}=y;if(T()(t,V.getFilters())||V.setFilters(t),null!=a&&null!=q&&a!==q.id||null!=a&&null==q)try{const t=await U.getSavedQuery(a);e&&null!=t&&N(t),B(!1)}catch{N(void 0),B(!0)}else null==a&&null!=q&&N(void 0)}(),()=>{e=!1}}),[y,V,q,U,B,E]),Object(i.useEffect)((()=>{L&&(null==b||b())}),[b,L]),Object(i.useEffect)((()=>{if(f&&q){const e=R(q);E(e)}}),[f,q,E]);const Q=Object(i.useCallback)((e=>{const{query:t}=y;T()(t,e)||E({...y,query:e})}),[y,E]),W=Object(i.useCallback)((e=>{const{query:t}=y;if(!T()(t,e)){const t=L?null:y.saved_id;E({...y,query:e,saved_id:t})}}),[y,E,L]),G=Object(i.useCallback)((e=>{if(null!=e){const{saved_id:t}=y;if(B(!1),N(e),e.id!==t){const t=R(e);E(t)}else E({filters:[],query:{query:"",language:"kuery"},saved_id:null})}}),[y,E,B]),K=Object(i.useCallback)((()=>{_(!0),u()}),[u]),J=Object(i.useCallback)((e=>{var a,n,i,s,r,o,c;_(!1);const u={query:null!==(a=null===(n=e.kqlQuery.filterQuery)||void 0===n||null===(i=n.kuery)||void 0===i?void 0:i.expression)&&void 0!==a?a:"",language:null!==(s=null===(r=e.kqlQuery.filterQuery)||void 0===r||null===(o=r.kuery)||void 0===o?void 0:o.kind)&&void 0!==s?s:"kuery"},d=null!=e.dataProviders&&e.dataProviders.length>0?Object(C.b)(Object(j.g)(e.dataProviders,t),l):"",p=null!==(c=e.filters)&&void 0!==c?c:[];E({filters:""!==d?[...p,Object(I.b)(d)]:p,query:u,saved_id:null})}),[t,l,E]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiFormRow,{label:r.label,labelAppend:r.labelAppend,helpText:r.helpText,error:H,isInvalid:z,fullWidth:!0,"data-test-subj":a,describedByIds:o?[o]:void 0},s.a.createElement(n.EuiMutationObserver,{observerOptions:{subtree:!0,attributes:!0,childList:!0},onMutation:()=>{if(null!=p){const e=document.getElementById("kbnTypeahead__items");if(null!=e){const t=e.getBoundingClientRect(),a=document.getElementById("define-rule");if(null!=a){const e=a.getBoundingClientRect();(-1===v||e.height<v+t.height)&&p(v+t.height-100),-1===v&&S(e.height)}}else p(-1)}}},(e=>s.a.createElement("div",{ref:e},s.a.createElement(O.a,{indexPattern:l,isLoading:c||P,isRefreshPaused:!1,filterQuery:y.query,filterManager:V,filters:V.getFilters()||[],onChangedQuery:W,onSubmitQuery:Q,savedQuery:q,onSavedQuery:G,hideSavedQuery:!1,displayStyle:"inPage",isDisabled:g}))))),d?s.a.createElement(w.a,{hideActions:F,modalTitle:A,onClose:K,onOpen:J}):null)};var _=a(262);const q=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeTitle",{defaultMessage:"Event Correlation"}),N=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeDescription",{defaultMessage:"Use Event Query Language (EQL) to match events, generate sequences, and stack data"}),L=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeTitle",{defaultMessage:"Custom query"}),B=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeDescription",{defaultMessage:"Use KQL or Lucene to detect issues across indices."}),z=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeTitle",{defaultMessage:"Machine Learning"}),H=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDescription",{defaultMessage:"Select ML job to detect anomalous activity."}),$=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeTitle",{defaultMessage:"Threshold"}),V=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeDescription",{defaultMessage:"Aggregate query results to detect when number of matches exceeds threshold."}),U=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchTitle",{defaultMessage:"Indicator Match"}),Q=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchDescription",{defaultMessage:"Use indicators from intelligence sources to detect matching events and alerts."}),W=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.newTermsTitle",{defaultMessage:"New Terms"}),G=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.newTermsDescription",{defaultMessage:"Find documents with values appearing for the first time."}),K=o.a.span.withConfig({displayName:"SmallText",componentId:"sc-lss4m0-0"})(["font-size:",";"],(({theme:e})=>e.eui.euiFontSizeS)),J=({hasValidLicense:e=!1})=>s.a.createElement(K,null,e?H:s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDisabledDescription",defaultMessage:"Access to ML requires a {subscriptionsLink}.",values:{subscriptionsLink:s.a.createElement(n.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.components.stepDefineRule.ruleTypeField.subscriptionsLink",defaultMessage:"Platinum subscription"}))}}));J.displayName="MlCardDescriptionComponent";const Y=s.a.memo(J);Y.displayName="MlCardDescription";const X=({describedByIds:e=[],field:t,isUpdateView:a,hasValidLicense:r,isMlAdmin:o})=>{const l=t.value,c=Object(i.useCallback)((e=>{t.setValue(e)}),[t]),u=Object(i.useCallback)((()=>c("eql")),[c]),d=Object(i.useCallback)((()=>c("machine_learning")),[c]),p=Object(i.useCallback)((()=>c("query")),[c]),g=Object(i.useCallback)((()=>c("threshold")),[c]),f=Object(i.useCallback)((()=>c("threat_match")),[c]),b=Object(i.useCallback)((()=>c("new_terms")),[c]),h=Object(i.useMemo)((()=>({onClick:u,isSelected:Object(_.b)(l)})),[l,u]),y=Object(i.useMemo)((()=>({onClick:p,isSelected:Object(_.d)(l)})),[l,p]),E=Object(i.useMemo)((()=>({isDisabled:!r||!o,onClick:d,isSelected:Object(m.d)(l)})),[l,d,r,o]),v=Object(i.useMemo)((()=>({onClick:g,isSelected:Object(_.f)(l)})),[l,g]),k=Object(i.useMemo)((()=>({onClick:f,isSelected:Object(_.e)(l)})),[l,f]),S=Object(i.useMemo)((()=>({onClick:b,isSelected:Object(_.c)(l)})),[l,b]);return s.a.createElement(n.EuiFormRow,{fullWidth:!0,"data-test-subj":"selectRuleType",describedByIds:e,label:t.label},s.a.createElement(n.EuiFlexGrid,{columns:3},(!a||y.isSelected)&&s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiCard,{"data-test-subj":"customRuleType",title:L,titleSize:"xs",description:B,icon:s.a.createElement(n.EuiIcon,{size:"xl",type:"search"}),selectable:y,layout:"horizontal"})),(!a||E.isSelected)&&s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiCard,{"data-test-subj":"machineLearningRuleType",title:z,titleSize:"xs",description:s.a.createElement(Y,{hasValidLicense:r}),icon:s.a.createElement(n.EuiIcon,{size:"l",type:"machineLearningApp"}),isDisabled:E.isDisabled&&!E.isSelected,selectable:E,layout:"horizontal"})),(!a||v.isSelected)&&s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiCard,{"data-test-subj":"thresholdRuleType",title:$,titleSize:"xs",description:V,icon:s.a.createElement(n.EuiIcon,{size:"l",type:"indexFlush"}),selectable:v,layout:"horizontal"})),(!a||h.isSelected)&&s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiCard,{"data-test-subj":"eqlRuleType",title:q,titleSize:"xs",description:N,icon:s.a.createElement(n.EuiIcon,{size:"l",type:"eql"}),selectable:h,layout:"horizontal"})),(!a||k.isSelected)&&s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiCard,{"data-test-subj":"threatMatchRuleType",title:U,titleSize:"xs",description:Q,icon:s.a.createElement(n.EuiIcon,{size:"l",type:"list"}),selectable:k,layout:"horizontal"})),(!a||S.isSelected)&&s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiCard,{"data-test-subj":"newTermsRuleType",title:W,titleSize:"xs",description:G,icon:s.a.createElement(n.EuiIcon,{size:"l",type:"magnifyWithPlus"}),selectable:S,layout:"horizontal"}))))},Z=({describedByIds:e=[],field:t})=>{const a=t.value,r=Object(i.useCallback)((e=>{const a=Number(e.target.value);t.setValue(a)}),[t]);return s.a.createElement(n.EuiFormRow,{label:t.label,"data-test-subj":"anomalyThresholdSlider",describedByIds:e},s.a.createElement(n.EuiFlexGroup,null,s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiRange,{value:a,onChange:r,fullWidth:!0,showInput:!0,showRange:!0,showTicks:!0,tickInterval:25}))))};var ee=a(502);const te=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."}),ae=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.savedQueryFieldRequiredError",{defaultMessage:"Failed to load the saved query. Select a new one or add a custom query."}),ne=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlQueryFieldRequiredError",{defaultMessage:"An EQL query is required."}),ie=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"}),se=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."}),re=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"}),oe=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"}),le=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlJobSelectPlaceholderText",{defaultMessage:"Select a job"}),ce=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"}),ue=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"}),de=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.SavedQueryFormRowLabel",{defaultMessage:"Saved query"}),pe=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"}),me=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."}),ge=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."}),fe=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.source",{defaultMessage:"Source"}),be=(l.i18n.translate("xpack.securitySolution.detections.dataSource.popover.title",{defaultMessage:"Select a data source"}),l.i18n.translate("xpack.securitySolution.detections.dataSource.popover.subTitle",{defaultMessage:"Data sources"}),l.i18n.translate("xpack.securitySolution.detections.dataSource.popover.content",{defaultMessage:"Rules can now query index patterns or data views."}),l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.rulePreviewTitle",{defaultMessage:"Rule Preview"}),o.a.div.withConfig({displayName:"HelpTextWarningContainer",componentId:"sc-v7btd6-0"})(["margin-top:10px;"])),he=({href:e,notRunningJobIds:t})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdHelpText",defaultMessage:"We've provided a few common jobs to get you started. To add your own custom jobs, assign a group of 'security' to those jobs in the {machineLearning} application to make them appear here.",values:{machineLearning:s.a.createElement(n.EuiLink,{href:e,target:"_blank"},s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.components.mlJobSelect.machineLearningLink",defaultMessage:"Machine Learning"}))}}),t.length>0&&s.a.createElement(be,{"data-test-subj":"ml-warning-not-running-jobs"},s.a.createElement(n.EuiText,{size:"xs",color:"warning"},s.a.createElement(n.EuiIcon,{type:"alert"}),s.a.createElement("span",null,1===t.length?s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobSingle",defaultMessage:"The selected ML job, {jobName}, is not currently running. Please set {jobName} to run via 'ML job settings' before enabling this rule.",values:{jobName:t[0]}}):s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobMulti",defaultMessage:"The selected ML jobs, {jobNames}, are not currently running. Please set all of these jobs to run via 'ML job settings' before enabling this rule.",values:{jobNames:t.reduce(((e,t,a,n)=>e+(a<n.length-1?", ":", and ")+t))}}))))),ye=s.a.memo(he),Ee=o.a.div.withConfig({displayName:"JobDisplayContainer",componentId:"sc-1kiq2lp-0"})(["width:100%;height:100%;display:flex;flex-direction:column;"]),ve=o()(n.EuiFlexGroup).withConfig({displayName:"MlJobSelectEuiFlexGroup",componentId:"sc-1kiq2lp-1"})(["margin-bottom:5px;"]),ke=({id:e,description:t})=>s.a.createElement(Ee,null,s.a.createElement("strong",null,e),s.a.createElement(n.EuiToolTip,{content:t},s.a.createElement(n.EuiText,{size:"xs",color:"subdued"},s.a.createElement("p",null,t)))),Se=e=>s.a.createElement(ke,{id:e.value.id,description:e.value.description}),Te=({describedByIds:e=[],field:t})=>{const a=t.value,{isInvalid:r,errorMessage:o}=Object(D.i)(t),{loading:l,jobs:c}=Object(ee.a)(!1),u=Object(h.k)().services.application.getUrlForApp("ml"),d=Object(i.useCallback)((e=>{const a=e.map((e=>e.value.id));t.setValue(a)}),[t]),p=c.map((e=>({value:{id:e.id,description:e.description},label:e.id}))),g=p.filter((e=>a.includes(e.value.id))),f=Object(i.useMemo)((()=>c.filter((({id:e})=>a.includes(e))).reduce(((e,t)=>(Object(m.c)(t.jobState,t.datafeedState)||e.push(t.id),e)),[])),[c,a]);return s.a.createElement(ve,null,s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiFormRow,{label:t.label,helpText:s.a.createElement(ye,{href:u,notRunningJobIds:f}),isInvalid:r,error:o,"data-test-subj":"mlJobSelect",describedByIds:e},s.a.createElement(n.EuiFlexGroup,null,s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiComboBox,{isLoading:l,onChange:d,options:p,placeholder:le,renderOption:Se,rowHeight:50,selectedOptions:g}))))))};var xe=a(697),we=a(406),Oe=a(490);const je=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.thresholdField.thresholdFieldPlaceholderText",{defaultMessage:"All results"}),Ie=o()(n.EuiFlexItem).withConfig({displayName:"OperatorWrapper",componentId:"sc-10hzoxx-0"})(["align-self:center;"]),Ce=["detectionEngineStepDefineRuleThresholdField"],Me=["detectionEngineStepDefineRuleThresholdValue"],De=["detectionEngineStepDefineRuleThresholdCardinalityField"],Ae=["detectionEngineStepDefineRuleThresholdCardinalityValue"],Fe=({thresholdField:e,thresholdValue:t,browserFields:a,thresholdCardinalityField:r,thresholdCardinalityValue:o})=>{const l=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:a.map((e=>({label:e.name}))),placeholder:je,onCreateOption:void 0,style:{width:"410px"}})),[a]),c=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:a.map((e=>({label:e.name}))),placeholder:je,onCreateOption:void 0,style:{width:"410px"},singleSelection:{asPlainText:!0}})),[a]);return s.a.createElement(n.EuiFlexGroup,{direction:"column",style:{marginLeft:0}},s.a.createElement(n.EuiFlexGroup,null,s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(D.b,{field:e,idAria:Ce[0],"data-test-subj":Ce[0],describedByIds:Ce,type:e.type,euiFieldProps:l})),s.a.createElement(Ie,{grow:!1},">="),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(D.b,{field:t,idAria:Me[0],"data-test-subj":Me[0],describedByIds:Me,type:t.type}))),s.a.createElement(n.EuiFlexGroup,null,s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(D.b,{field:r,idAria:De[0],"data-test-subj":De[0],describedByIds:De,type:r.type,euiFieldProps:c})),s.a.createElement(Ie,{grow:!1},">="),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(D.b,{field:o,idAria:Ae[0],"data-test-subj":Ae[0],describedByIds:Ae,type:o.type}))))},Re=s.a.memo(Fe);var Pe=a(44),_e=a(50),qe=a.n(_e),Ne=a(223),Le=a(310);const Be=()=>Object(Ne.d)({field:"",type:"mapping",value:""});var ze=a(529);const He={index:{defaultValue:[],fieldsToValidateOnChange:["index","queryBar"],type:D.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:s.a.createElement(n.EuiText,{size:"xs"},se),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(!Object(m.d)(t.ruleType)&&t.dataSourceType===E.a.IndexPatterns)return D.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}}]},dataViewTitle:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.dataViewSelector",{defaultMessage:"Data View"}),validations:[]},dataViewId:{fieldsToValidateOnChange:["dataViewId"],validations:[{validator:(...e)=>{const[{path:t,formData:a}]=e,n=null!=a.dataViewId&&""!==a.dataViewId;if(!Object(m.d)(a.ruleType)&&!n&&a.dataSourceType===E.a.DataView)return{path:t,message:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.dataViewSelectorFieldRequired",{defaultMessage:"Please select an available Data View or Index Pattern."})}}}]},eqlOptions:{},queryBar:{validations:[{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e,{query:i,filters:s,saved_id:r}=t;if(!Object(m.d)(n.ruleType)&&Object(c.isEmpty)(i.query)&&Object(c.isEmpty)(s))return r?{code:"ERR_FIELD_MISSING",path:a,message:ae}:{code:"ERR_FIELD_MISSING",path:a,message:Object(_.b)(n.ruleType)?ne:te}}},{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e,{query:i}=t;if(!Object(m.d)(n.ruleType)&&!Object(c.isEmpty)(i.query)&&"kuery"===i.language)try{Object(Pe.e)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:ie}}}},{validator:Object(ze.a)(ze.b,300)}]},ruleType:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(m.d)(t.ruleType))return D.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...e)}}]},relatedIntegrations:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsLabel",{defaultMessage:"Related integrations"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsHelpText",{defaultMessage:"Integration related to this Rule."})},requiredFields:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsLabel",{defaultMessage:"Required fields"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsHelpText",{defaultMessage:"Fields required for this Rule to function."})},timeline:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:D.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Group by"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select fields to group by. Fields are joined together with 'AND'"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(_.f)(t.ruleType))return D.h.maxLengthField({length:3,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdFieldFieldData.arrayLengthGreaterThanMaxErrorMessage",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},value:{type:D.a.NUMBER,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(_.f)(t.ruleType))return D.h.numberGreaterThanField({than:1,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]},cardinality:{field:{defaultValue:[],fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:D.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityFieldLabel",{defaultMessage:"Count"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(_.f)(t.ruleType))return Object(c.isEmpty)(t["threshold.cardinality.field"])&&!Object(c.isEmpty)(t["threshold.cardinality.value"])?D.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityFieldFieldData.thresholdCardinalityFieldNotSuppliedMessage",{defaultMessage:"A Cardinality Field is required."}))(...e):void 0}}],helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdFieldCardinalityFieldHelpText",{defaultMessage:"Select a field to check cardinality"})},value:{fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:D.a.NUMBER,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityValueFieldLabel",{defaultMessage:"Unique values"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(_.f)(t.ruleType))return Object(c.isEmpty)(t["threshold.cardinality.field"])?void 0:D.h.numberGreaterThanField({than:1,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]}}},threatIndex:{type:D.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:s.a.createElement(n.EuiText,{size:"xs"},pe),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(_.e)(t.ruleType))return D.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}},{validator:(...e)=>{const[{formData:t,value:a}]=e;if(Object(_.e)(t.ruleType))return((e,t)=>{let a;if(a="string"==typeof e?e===t:!!Array.isArray(e)&&!!e.find((e=>e===t)),a)return{code:"ERR_FIELD_FORMAT",message:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchIndexForbiddenError",{defaultMessage:"The index pattern cannot be { forbiddenString }. Please choose a more specific index pattern.",values:{forbiddenString:t}})}})(a,"*")}}]},threatMapping:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...e)=>{const[{path:t,formData:a}]=e;var n;if(Object(_.e)(a.ruleType))return 1===(n=a.threatMapping).length&&1===n[0].entries.length&&""===n[0].entries[0].field&&""===n[0].entries[0].value?{code:"ERR_FIELD_MISSING",path:t,message:me}:(e=>e.some((e=>e.entries.some((e=>""===e.field||""===e.value)))))(a.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:ge}:void 0}}]},threatQueryBar:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e;if(!Object(_.e)(n.ruleType))return;const{query:i,filters:s}=t;return Object(c.isEmpty)(i.query)&&Object(c.isEmpty)(s)?{code:"ERR_FIELD_MISSING",path:a,message:te}:void 0}},{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e;if(!Object(_.e)(n.ruleType))return;const{query:i}=t;if(!Object(c.isEmpty)(i.query)&&"kuery"===i.language)try{Object(Pe.e)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:ie}}}}]},newTermsFields:{type:D.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsLabel",{defaultMessage:"Fields"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNewTermsFieldHelpText",{defaultMessage:"Select a field to check for new terms."}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(_.c)(t.ruleType))return D.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsMin",{defaultMessage:"Number of fields must be 1."}))(...e)}},{validator:(...e)=>{const[{formData:t}]=e;if(Object(_.c)(t.ruleType))return D.h.maxLengthField({length:1,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.newTermsFieldsMax",{defaultMessage:"Number of fields must be 1."})})(...e)}}]},historyWindowSize:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.historyWindowSizeLabel",{defaultMessage:"History Window Size"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.historyWindowSizeHelpText",{defaultMessage:"New terms rules only alert if terms don't appear in historical data."})},shouldLoadQueryDynamically:{type:D.a.CHECKBOX,defaultValue:!1}};var $e=a(679);const Ve=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.pickDataView",{defaultMessage:"Select a Data View"}),Ue=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewNotFoundLabel",{defaultMessage:"Selected data view not found"}),Qe=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewIncludesAlertsIndexLabel",{defaultMessage:"Default Security data view"}),We=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewIncludesAlertsIndexDescription",{defaultMessage:"The default Security data view includes the alerts index. This could result in redundant alerts being generated from existing alerts."}),Ge=({kibanaDataViews:e,field:t})=>{let a,r,o;if(null!=t){const e=Object(D.i)(t);a=e.isInvalid,r=e.errorMessage,o=t.value}const c=Object(i.useMemo)((()=>null!=e&&Object.keys(e).length>0),[e]),u=Object(i.useMemo)((()=>null!=o&&""!==o&&c&&!Object.hasOwn(e,o)),[c,o,e]),[d,p]=Object(i.useState)(u||null==o||""===o?[]:[{id:e[o].id,label:e[o].title}]),[m,g]=Object(i.useState)(!1);Object(i.useEffect)((()=>{if(!u&&o){const t=e[o].title,a=e[o].id;g("security-solution-default"===a),p([{id:a,label:t}])}else p([])}),[o,t,e,u,g]);const f=Object(i.useMemo)((()=>c?Object.values(e).map((e=>({label:e.title,id:e.id}))):[]),[c,e]);return s.a.createElement(s.a.Fragment,null,u&&null!=o&&s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiCallOut,{title:Ue,color:"warning",iconType:"help"},s.a.createElement("p",null,(b=o,l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewNotFoundDescription",{values:{dataView:b},defaultMessage:'Your data view of "id": "{dataView}" was not found. It could be that it has since been deleted.'})))),s.a.createElement(n.EuiSpacer,{size:"s"})),m&&s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiCallOut,{title:Qe,color:"warning",iconType:"help","data-test-subj":"defaultSecurityDataViewWarning"},s.a.createElement("p",null,We)),s.a.createElement(n.EuiSpacer,{size:"s"})),s.a.createElement(n.EuiFormRow,{label:null==t?void 0:t.label,helpText:null==t?void 0:t.helpText,error:r,isInvalid:a,"data-test-subj":"pick-rule-data-source"},s.a.createElement(n.EuiComboBox,{isClearable:!0,singleSelection:{asPlainText:!0},onChange:e=>{const a=e;if(p(null!=a?a:[]),null!=a&&a.length>0&&null!=a[0].id){const e=a[0].id;null==t||t.setValue(e)}else null==t||t.setValue(void 0)},options:f,selectedOptions:d,"aria-label":Ve,placeholder:Ve,"data-test-subj":"detectionsDataViewSelectorDropdown"})));var b};var Ke=a(360),Je=a(482);const Ye=o()(n.EuiFlexItem).withConfig({displayName:"FlexItemWithLabel",componentId:"sc-1i1appc-0"})(["padding-top:20px;text-align:center;"]),Xe=o()(n.EuiFlexItem).withConfig({displayName:"FlexItemWithoutLabel",componentId:"sc-1i1appc-1"})(["text-align:center;"]),Ze=({entry:e,indexPattern:t,threatIndexPatterns:a,showLabel:r,onChange:o})=>{const l=Object(i.useCallback)((([t])=>{const{updatedEntry:a,index:n}=((e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=t?t.name:"",type:"mapping",value:null!=e.value?e.value.name:""},index:a}})(e,t);o(a,n)}),[o,e]),c=Object(i.useCallback)((([t])=>{const{updatedEntry:a,index:n}=((e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=e.field?e.field.name:"",type:"mapping",value:null!=t?t.name:""},index:a}})(e,t);o(a,n)}),[o,e]),u=Object(i.useMemo)((()=>{const a=s.a.createElement(Ke.b,{placeholder:Je.c,indexPattern:t,selectedField:e.field,isClearable:!1,isLoading:!1,isDisabled:null==t,onChange:l,"data-test-subj":"entryField",fieldInputWidth:360});return r?s.a.createElement(n.EuiFormRow,{label:Je.b,"data-test-subj":"entryItemFieldInputFormRow"},a):s.a.createElement(n.EuiFormRow,{label:"","data-test-subj":"entryItemFieldInputFormRow"},a)}),[l,t,e,r]),d=Object(i.useMemo)((()=>{const t=s.a.createElement(Ke.b,{placeholder:Je.c,indexPattern:a,selectedField:e.value,isClearable:!1,isLoading:!1,isDisabled:null==a,onChange:c,"data-test-subj":"threatEntryField",fieldInputWidth:360});return r?s.a.createElement(n.EuiFormRow,{label:Je.f,"data-test-subj":"threatFieldInputFormRow"},t):s.a.createElement(n.EuiFormRow,{label:"","data-test-subj":"threatFieldInputFormRow"},t)}),[c,a,e,r]);return s.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center",justifyContent:"spaceAround","data-test-subj":"itemEntryContainer"},s.a.createElement(n.EuiFlexItem,{grow:!1},u),s.a.createElement(n.EuiFlexItem,{grow:!0},s.a.createElement(n.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center"},r?s.a.createElement(Ye,{grow:!0},Je.d):s.a.createElement(Xe,{grow:!0},Je.d))),s.a.createElement(n.EuiFlexItem,{grow:!1},d))};Ze.displayName="EntryItem";const et=o()(n.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-136w498-0"})(["padding-top:20px;"]),tt=s.a.memo((({entries:e,isOnlyItem:t,entryIndex:a,itemIndex:r,onDelete:o})=>{const l=t&&1===e.length&&0===r&&(null==e[0].field||""===e[0].field),c=Object(i.useCallback)((()=>{o(a)}),[o,a]),u=s.a.createElement(n.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:c,isDisabled:l,"aria-label":"entryDeleteButton",className:"itemEntryDeleteButton","data-test-subj":"itemEntryDeleteButton"});return 0===a&&0===r?s.a.createElement(et,{grow:!1,"data-test-subj":"firstRowDeleteButton"},u):s.a.createElement(n.EuiFlexItem,{grow:!1,"data-test-subj":"deleteButton"},u)}));tt.displayName="EntryDeleteButton";var at=a(426);const nt=o()(n.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-d6yaa8-0"})(["visibility:hidden;"]),it=o()(n.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-d6yaa8-1"})(["padding-top:20px;"]),st=s.a.memo((({entriesLength:e,entryItemIndex:t})=>{const a=s.a.createElement(at.a,{includeAntennas:!0,type:"and"});return e>1&&0===t?s.a.createElement(it,{grow:!1,"data-test-subj":"entryItemEntryFirstRowAndBadge"},a):e<=1?s.a.createElement(nt,{grow:!1,"data-test-subj":"entryItemEntryInvisibleAndBadge"},a):s.a.createElement(n.EuiFlexItem,{grow:!1,"data-test-subj":"entryItemEntryAndBadge"},a)}));st.displayName="AndBadge";const rt=o()(n.EuiFlexItem).withConfig({displayName:"MyOverflowContainer",componentId:"sc-o1uavm-0"})(["overflow:hidden;width:100%;"]),ot=s.a.memo((({listItem:e,listItemIndex:t,indexPattern:a,threatIndexPatterns:r,isOnlyItem:o,andLogicIncluded:l,onDeleteEntryItem:c,onChangeEntryItem:u})=>{const d=Object(i.useCallback)(((a,n)=>{const i=[...e.entries.slice(0,n),{...a},...e.entries.slice(n+1)],s={...e,entries:i};u(s,t)}),[u,e,t]),p=Object(i.useCallback)((a=>{const n=((e,t)=>({...e,entries:[...e.entries.slice(0,t),...e.entries.slice(t+1)]}))(e,a);c(n,t)}),[e,c,t]),m=Object(i.useMemo)((()=>null!=a&&e.entries.length>0?((e,t,a)=>a.reduce(((a,n,i)=>{const s=((e,t,a,n,i=qe.a.v4)=>{var s;const{fields:r}=e,{fields:o}=t,l=a.field,c=a.value,[u]=r.filter((({name:e})=>null!=l&&l===e)),[d]=o.filter((({name:e})=>null!=c&&c===e));return{id:null!==(s=a.id)&&void 0!==s?s:i(),field:u,type:"mapping",value:d,entryIndex:n}})(e,t,n,i);return[...a,s]}),[]))(a,r,e.entries):[]),[e.entries,a,r]);return s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiFlexGroup,{gutterSize:"s","data-test-subj":"entriesContainer"},l&&s.a.createElement(st,{entriesLength:e.entries.length,entryItemIndex:t}),s.a.createElement(rt,{grow:6},s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",direction:"column"},m.map(((i,l)=>s.a.createElement(n.EuiFlexItem,{key:i.id,grow:1},s.a.createElement(n.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",direction:"row"},s.a.createElement(rt,{grow:1},s.a.createElement(Ze,{entry:i,threatIndexPatterns:r,indexPattern:a,showLabel:0===t&&0===l,onChange:d})),s.a.createElement(tt,{entries:e.entries,isOnlyItem:o,entryIndex:i.entryIndex,itemIndex:t,onDelete:p})))))))))}));ot.displayName="ListItem";const lt=o()(n.EuiButton).withConfig({displayName:"MyEuiButton",componentId:"sc-1dsnlky-0"})(["min-width:95px;"]),ct=({isOrDisabled:e=!1,isAndDisabled:t=!1,onAndClicked:a,onOrClicked:i})=>s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(lt,{fill:!0,size:"s",iconType:"plusInCircle",onClick:a,"data-test-subj":"andButton",isDisabled:t},Je.a)),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(lt,{fill:!0,size:"s",iconType:"plusInCircle",onClick:i,isDisabled:e,"data-test-subj":"orButton"},Je.e))),ut=o()(n.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-ph2s87-0"})(["visibility:hidden;"]),dt=o()(at.a).withConfig({displayName:"MyAndBadge",componentId:"sc-ph2s87-1"})(["& > .euiFlexItem{margin:0;}"]),pt=o()(n.EuiFlexItem).withConfig({displayName:"MyButtonsContainer",componentId:"sc-ph2s87-2"})(["margin:16px 0;"]),mt={andLogicIncluded:!1,entries:[],entriesToDelete:[]},gt=({listItems:e,indexPatterns:t,threatIndexPatterns:a,onChange:r})=>{const[{entries:o,entriesToDelete:l,andLogicIncluded:c},u]=Object(i.useReducer)(((e,t)=>{switch(t.type){case"setEntries":{const a=t.entries.filter((({entries:e})=>e.length>1)).length>0;return{...e,andLogicIncluded:a,entries:t.entries}}case"setDefault":return{...e,...t.initialState,entries:[{...t.lastEntry,entries:[Be()]}]};default:return e}}),{...mt}),d=Object(i.useCallback)((e=>{u({type:"setEntries",entries:e})}),[u]),p=Object(i.useCallback)((e=>{u({type:"setDefault",initialState:mt,lastEntry:e})}),[u]),m=Object(i.useCallback)(((e,t)=>{const a=[...o.slice(0,t),{...e},...o.slice(t+1)];d(a)}),[d,o]),g=Object(i.useCallback)(((e,t)=>{0===e.entries.length?0===[...o.slice(0,t),...o.slice(t+1)].length?p(e):d([...o.slice(0,t),...o.slice(t+1)]):m(e,t)}),[m,d,o,p]),f=Object(i.useCallback)((()=>{const e=o[o.length-1],{entries:t}=e,a={...e,entries:[...t,Be()]};d([...o.slice(0,o.length-1),{...a}])}),[d,o]),b=Object(i.useCallback)((()=>{const e=Object(Ne.d)({entries:[Object(Ne.d)({field:"",type:"mapping",value:""})]});d([...o,{...e}])}),[d,o]),h=Object(i.useCallback)((()=>{f()}),[f]);return Object(i.useEffect)((()=>{var e;r({entryItems:(e=o,e.reduce(((e,t)=>{const a={...t,entries:t.entries};return Le.q.is(a)?[...e,a]:e}),[])),entriesToDelete:l})}),[r,l,o]),Object(i.useEffect)((()=>{(0===o.length||1===o.length&&null!=o[0].entries&&0===o[0].entries.length)&&b()}),[o,b]),Object(i.useEffect)((()=>{e.length>0&&d(e)}),[]),s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",direction:"column"},o.map(((e,i)=>{var r;const l=null!==(r=e.id)&&void 0!==r?r:`${i}`;return s.a.createElement(n.EuiFlexItem,{grow:1,key:l},s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",direction:"column"},0!==i&&(c?s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiFlexGroup,{gutterSize:"none",direction:"row"},s.a.createElement(ut,{grow:!1},s.a.createElement(dt,{includeAntennas:!0,type:"and"})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(dt,{type:"or"})))):s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(dt,{type:"or"}))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(ot,{key:l,listItem:e,indexPattern:t,threatIndexPatterns:a,listItemIndex:i,andLogicIncluded:c,isOnlyItem:1===o.length,onDeleteEntryItem:g,onChangeEntryItem:m}))))})),s.a.createElement(pt,{"data-test-subj":"andOrOperatorButtons"},s.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},c&&s.a.createElement(ut,{grow:!1},s.a.createElement(at.a,{includeAntennas:!0,type:"and"})),s.a.createElement(n.EuiFlexItem,{grow:1},s.a.createElement(ct,{isOrDisabled:!1,isAndDisabled:!1,onOrClicked:b,onAndClicked:h})))))};gt.displayName="ThreatMatch";const ft=Object(D.j)({component:D.b}),bt=({threatIndexModified:e,handleResetThreatIndices:t,threatMapping:a,indexPatterns:r,threatIndexPatterns:o,threatIndexPatternsLoading:l,threatBrowserFields:c,onValidityChange:u})=>{const{setValue:d,value:p}=a,{isInvalid:m,errorMessage:g}=Object(D.i)(a),[f,b]=Object(i.useState)(!1);Object(i.useEffect)((()=>{u&&u(!m&&f)}),[f,m,u]);const h=Object(i.useCallback)((({entryItems:e})=>{d(e)}),[d]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(n.EuiFlexGroup,{direction:"column"},s.a.createElement(n.EuiFlexItem,{grow:!0},s.a.createElement(ft,{path:"threatIndex",config:{...He.threatIndex,labelAppend:e?s.a.createElement(It,{onClick:t,iconType:"refresh"},re):null},componentProps:{idAria:"detectionEngineStepDefineRuleThreatMatchIndices","data-test-subj":"detectionEngineStepDefineRuleThreatMatchIndices",euiFieldProps:{fullWidth:!0,isDisabled:!1,placeholder:""}}})),s.a.createElement(n.EuiFlexItem,{grow:!0},s.a.createElement(D.e,{path:"threatQueryBar",config:{...He.threatQueryBar,labelAppend:null},component:P,componentProps:{browserFields:c,idAria:"detectionEngineStepDefineThreatRuleQueryBar",indexPattern:o,isDisabled:!1,isLoading:l,dataTestSubj:"detectionEngineStepDefineThreatRuleQueryBar",openTimelineSearch:!1,onValidityChange:b}}))),s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(n.EuiFormRow,{label:a.label,labelAppend:a.labelAppend,helpText:a.helpText,error:g,isInvalid:m,fullWidth:!0},s.a.createElement(gt,{listItems:p,indexPatterns:r,threatIndexPatterns:o,"data-test-subj":"threatmatch-builder","id-aria":"threatmatch-builder",onChange:h})),s.a.createElement(n.EuiSpacer,{size:"m"}))},ht=s.a.memo(bt);var yt=a(316);const Et=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsField.placeholderText",{defaultMessage:"Select a field"}),vt=({browserFields:e,field:t})=>{const a=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:e.map((e=>({label:e.name}))),placeholder:Et,onCreateOption:void 0,style:{width:"410px"}})),[e]);return s.a.createElement(D.b,{field:t,idAria:"detectionEngineStepDefineRuleNewTermsField",euiFieldProps:a})},kt=s.a.memo(vt);var St=a(535),Tt=a(624),xt=a(477),wt=a(663);const Ot=Object(D.j)({component:D.b}),jt=o.a.div.withConfig({displayName:"StyledVisibleContainer",componentId:"sc-f0vskm-0"})(["display:",";"],(e=>e.isVisible?"block":"none")),It=o()(n.EuiButtonEmpty).withConfig({displayName:"MyLabelButton",componentId:"sc-f0vskm-1"})(["height:18px;font-size:12px;.euiIcon{width:14px;height:14px;}"]);It.defaultProps={flush:"right"};const Ct=o()(n.EuiFormRow).attrs((({$isVisible:e})=>({style:{display:e?"flex":"none"}}))).withConfig({displayName:"RuleTypeEuiFormRow",componentId:"sc-f0vskm-2"})([""]),Mt=({addPadding:e=!1,defaultValues:t,descriptionColumns:a="singleSplit",isReadOnlyView:r,isLoading:u,isUpdateView:k=!1,onSubmit:S,setForm:T,kibanaDataViews:x,indicesConfig:w,threatIndicesConfig:O,onRuleDataChange:j,onPreviewDisabledStateChange:I,defaultSavedQuery:C})=>{const M=Object(b.a)(),[A,F]=Object(i.useState)(!1),[R,q]=Object(i.useState)(!1),[N,L]=Object(i.useState)(!1),[B,z]=Object(i.useState)(),{form:H}=Object(D.k)({defaultValue:t,options:{stripEmptyFields:!1},schema:He}),{getFields:$,getFormData:V,reset:U,submit:Q}=H,[W]=Object(D.m)({form:H,watch:["index","ruleType","queryBar","threshold","dataViewId","threshold.field","threshold.value","threshold.cardinality.field","threshold.cardinality.value","threatIndex","threatMapping","machineLearningJobId","anomalyThreshold","dataSourceType","newTermsFields","historyWindowSize","shouldLoadQueryDynamically"],onChange:e=>{j&&j({...e,eqlOptions:Ce})}}),{index:G,ruleType:K,queryBar:J,dataViewId:Y,threatIndex:ee,threatMapping:te,machineLearningJobId:ae,dataSourceType:ne,newTermsFields:ie,shouldLoadQueryDynamically:se}=W,[le,pe]=Object(i.useState)(!1),[me,ge]=Object(i.useState)(!1),be=G||t.index,he=Y||t.dataViewId,ye=ee||t.threatIndex,Ee=K||t.ruleType,ve=ne||t.dataSourceType,ke=null!=ae?ae:t.machineLearningJobId,[Se,je]=Object(i.useState)(!1);Object(i.useEffect)((()=>{I&&I(!Se)}),[Se,I]),Object(i.useEffect)((()=>{const e=Object(wt.b)({ruleType:Ee,isQueryBarValid:le,isThreatQueryBarValid:me,index:be,dataViewId:Y,dataSourceType:ve,threatIndex:ye,threatMapping:te,machineLearningJobId:ke,queryBar:null!=J?J:t.queryBar,newTermsFields:ie});je(!e)}),[ve,Y,ie,J,te,be,t.queryBar,le,me,ke,Ee,ye]);const Ie=d()(Ee),[Ce,Me]=Object(i.useState)(t.eqlOptions||{}),[De,{browserFields:Ae,indexPatterns:Fe}]=Object(yt.b)(be,!1),[Pe,_e]=Object(i.useState)(Fe),{data:qe}=Object(h.k)().services;Object(i.useEffect)((()=>{ve===E.a.IndexPatterns&&(De||_e(Fe)),ve===E.a.DataView&&(async()=>{if(null!=he){const e=await qe.dataViews.get(he);z(e.title),_e(e)}})()}),[ve,De,qe,he,Fe]);const Ne=Object(i.useCallback)((e=>{H.setFieldValue("dataSourceType",e),H.getFields().index.reset({resetValue:!1}),H.getFields().dataViewId.reset({resetValue:!1})}),[H]),[Le,Be]=Object(i.useState)([]);Object(i.useEffect)((()=>{const{fields:e}=Pe;Be(function(e){return e.filter((e=>!0===e.aggregatable))}(e))}),[Pe]);const[ze,{browserFields:Ve,indexPatterns:Ue}]=Object(yt.b)(ye);Object(i.useEffect)((()=>{U({resetValues:!1})}),[U,Ee]),Object(i.useEffect)((()=>{q(!Object(c.isEqual)(be,w))}),[be,w]),Object(i.useEffect)((()=>{L(!Object(c.isEqual)(ye,O))}),[ye,O]),Object(i.useEffect)((()=>{const{queryBar:e}=$();null!=e&&(Object(_.e)(Ee)&&!Object(_.e)(Ie)&&Object(c.isEqual)(e.value,xt.a.forNormalRules)?e.reset({defaultValue:xt.a.forThreatMatchRules}):!Object(_.e)(Ee)&&Object(_.e)(Ie)&&Object(c.isEqual)(e.value,xt.a.forThreatMatchRules)&&e.reset({defaultValue:xt.a.forNormalRules}))}),[Ee,Ie,$]);const Qe=Object(i.useCallback)((()=>{le||H.setFieldValue("shouldLoadQueryDynamically",!1)}),[le,H]),We=Object(i.useCallback)((()=>{S&&S()}),[S]),Ke=Object(i.useCallback)((async()=>{const e=await Q();return e.data={...e.data,eqlOptions:Ce},e.isValid?e:{isValid:!1,data:{...V(),eqlOptions:Ce}}}),[V,Ce,Q]);Object(i.useEffect)((()=>{let e=!1;return T&&!e&&T(E.b.defineRule,Ke),()=>{e=!0}}),[Ke,T]);const Je=Object(i.useCallback)((()=>{$().index.setValue(w)}),[$,w]),Ye=Object(i.useCallback)((()=>{$().threatIndex.setValue(O)}),[$,O]),Xe=Object(i.useCallback)((()=>{F(!0)}),[]),Ze=Object(i.useCallback)((()=>{F(!1)}),[]),et=Object(i.useCallback)((({thresholdField:e,thresholdValue:t,thresholdCardinalityField:a,thresholdCardinalityValue:n})=>s.a.createElement(Re,{browserFields:Le,thresholdField:e,thresholdValue:t,thresholdCardinalityField:a,thresholdCardinalityValue:n})),[Le]);o()(n.EuiFlexItem).withConfig({displayName:"SourcererFlex",componentId:"sc-f0vskm-3"})(["align-items:flex-end;"]).displayName="SourcererFlex";const tt=Object(i.useCallback)((({threatMapping:e})=>s.a.createElement(ht,{handleResetThreatIndices:Ye,indexPatterns:Pe,threatBrowserFields:Ve,threatIndexModified:N,threatIndexPatterns:Ue,threatIndexPatternsLoading:ze,threatMapping:e,onValidityChange:ge})),[Ye,Pe,Ve,N,Ue,ze]),at=Object(i.useMemo)((()=>[{id:E.a.IndexPatterns,label:l.i18n.translate("xpack.securitySolution.ruleDefine.indexTypeSelect.indexPattern",{defaultMessage:"Index Patterns"}),iconType:ve===E.a.IndexPatterns?"checkInCircleFilled":"empty","data-test-subj":`rule-index-toggle-${E.a.IndexPatterns}`},{id:E.a.DataView,label:l.i18n.translate("xpack.securitySolution.ruleDefine.indexTypeSelect.dataView",{defaultMessage:"Data View"}),iconType:ve===E.a.DataView?"checkInCircleFilled":"empty","data-test-subj":`rule-index-toggle-${E.a.DataView}`}]),[ve]),nt=Object(i.useMemo)((()=>s.a.createElement(D.e,{key:"DataViewSelector",path:"dataViewId",component:Ge,componentProps:{kibanaDataViews:x}})),[x]),it=Object(i.useMemo)((()=>s.a.createElement(Ct,{label:fe,$isVisible:!0,fullWidth:!0},s.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"s","data-test-subj":"dataViewIndexPatternButtonGroupFlexGroup"},s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText1",defaultMessage:"Use Kibana "}),s.a.createElement(Tt.a,{guidePath:"kibana",docPath:"data-views.html",linkText:"Data Views"}),s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText2",defaultMessage:" or specify individual "}),s.a.createElement(Tt.a,{guidePath:"kibana",docPath:"index-patterns-api-create.html",linkText:"index patterns"}),s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText3",defaultMessage:" as your rule's data source to be searched."}))),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(Ct,{$isVisible:!0},s.a.createElement(n.EuiButtonGroup,{isFullWidth:!0,legend:"Rule index pattern or data view selector","data-test-subj":"dataViewIndexPatternButtonGroup",idSelected:ve,onChange:Ne,options:at,color:"primary"}))),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(jt,{isVisible:ve===E.a.DataView},nt),s.a.createElement(jt,{isVisible:ve===E.a.IndexPatterns},s.a.createElement(Ot,{path:"index",config:{...Object(c.omit)(He.index,"label"),labelAppend:R?s.a.createElement(It,{onClick:Je,iconType:"refresh"},re):null},componentProps:{idAria:"detectionEngineStepDefineRuleIndices","data-test-subj":"detectionEngineStepDefineRuleIndices",euiFieldProps:{fullWidth:!0,placeholder:""}}})))))),[ve,Ne,at,nt,R,Je]),st=Object(i.useMemo)((()=>s.a.createElement(D.e,{key:"QueryBarDefineRule",path:"queryBar",config:{...He.queryBar,label:ce,labelAppend:s.a.createElement(It,{"data-test-subj":"importQueryFromSavedTimeline",onClick:Xe,disabled:se},oe)},component:P,componentProps:{browserFields:Ae,idAria:"detectionEngineStepDefineRuleQueryBar",indexPattern:Pe,isDisabled:u||se,resetToSavedQuery:se,isLoading:De,dataTestSubj:"detectionEngineStepDefineRuleQueryBar",openTimelineSearch:A,onValidityChange:pe,onCloseTimelineSearch:Ze,onSavedQueryError:Qe,defaultSavedQuery:C}})),[Ae,Ze,Xe,Pe,De,u,A,se,Qe,C]),rt=Object(i.useCallback)(((e,t)=>{Me((a=>({...a,[e]:t})))}),[]),ot=Object(i.useMemo)((()=>Object(c.isEmpty)(Pe.fields)?{keywordFields:[],dateFields:[],nonDateFields:[]}:{keywordFields:Pe.fields.filter((e=>{var t;return null===(t=e.esTypes)||void 0===t?void 0:t.includes("keyword")})).map((e=>({label:e.name}))),dateFields:Pe.fields.filter((e=>"date"===e.type)).map((e=>({label:e.name}))),nonDateFields:Pe.fields.filter((e=>"date"!==e.type)).map((e=>({label:e.name})))}),[Pe]),lt=Object(y.e)(t);return ve===E.a.DataView&&(lt.dataViewTitle=B),r?s.a.createElement(we.a,{"data-test-subj":"definitionRule",addPadding:e},s.a.createElement(v.a,{columns:a,indexPatterns:Pe,schema:Object(y.b)(He,Ee),data:Object(y.b)(lt,Ee)})):s.a.createElement(s.a.Fragment,null,s.a.createElement(we.a,{addPadding:!k},s.a.createElement(D.c,{form:H,"data-test-subj":"stepDefineRule"},s.a.createElement(jt,{isVisible:!1},s.a.createElement(D.e,{path:"dataSourceType",componentProps:{euiFieldProps:{fullWidth:!0,placeholder:""}}})),s.a.createElement(D.e,{path:"ruleType",component:X,componentProps:{describedByIds:["detectionEngineStepDefineRuleType"],isUpdateView:k,hasValidLicense:Object(f.a)(M),isMlAdmin:Object(g.a)(M)}}),s.a.createElement(Ct,{$isVisible:!Object(m.d)(Ee),fullWidth:!0},s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiSpacer,{size:"s"}),it,s.a.createElement(n.EuiSpacer,{size:"s"}),Object(_.b)(Ee)?s.a.createElement(D.e,{key:"EqlQueryBar",path:"queryBar",component:$e.a,componentProps:{optionsData:ot,optionsSelected:Ce,isSizeOptionDisabled:!0,onOptionsChange:rt,onValidityChange:pe,idAria:"detectionEngineStepDefineRuleEqlQueryBar",isDisabled:u,isLoading:De,indexPattern:Pe,showFilterBar:!0,dataTestSubj:"detectionEngineStepDefineRuleEqlQueryBar"},config:{...He.queryBar,label:ue}}):st)),Object(_.d)(Ee)&&s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(Ct,{label:de,$isVisible:Boolean((null==J?void 0:J.saved_id)&&(null==J?void 0:J.title)),fullWidth:!0},s.a.createElement(Ot,{path:"shouldLoadQueryDynamically",componentProps:{idAria:"detectionEngineStepDefineRuleShouldLoadQueryDynamically","data-test-subj":"detectionEngineStepDefineRuleShouldLoadQueryDynamically",euiFieldProps:{disabled:u,label:null!=J&&J.title?(ct=J.title,l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldShouldLoadQueryDynamicallyLabel",{defaultMessage:'Load saved query "{savedQueryName}" dynamically on each rule execution',values:{savedQueryName:ct}})):void 0}}}))),s.a.createElement(Ct,{$isVisible:Object(m.d)(Ee),fullWidth:!0},s.a.createElement(s.a.Fragment,null,s.a.createElement(D.e,{path:"machineLearningJobId",component:Te,componentProps:{describedByIds:["detectionEngineStepDefineRulemachineLearningJobId"]}}),s.a.createElement(D.e,{path:"anomalyThreshold",component:Z,componentProps:{describedByIds:["detectionEngineStepDefineRuleAnomalyThreshold"]}}))),s.a.createElement(Ct,{$isVisible:Object(_.f)(Ee),"data-test-subj":"thresholdInput",fullWidth:!0},s.a.createElement(s.a.Fragment,null,s.a.createElement(D.f,{fields:{thresholdField:{path:"threshold.field"},thresholdValue:{path:"threshold.value"},thresholdCardinalityField:{path:"threshold.cardinality.field"},thresholdCardinalityValue:{path:"threshold.cardinality.value"}}},et))),s.a.createElement(Ct,{$isVisible:Object(_.e)(Ee),"data-test-subj":"threatMatchInput",fullWidth:!0},s.a.createElement(s.a.Fragment,null,s.a.createElement(D.f,{fields:{threatMapping:{path:"threatMapping"}}},tt))),s.a.createElement(Ct,{$isVisible:Object(_.c)(Ee),"data-test-subj":"newTermsInput",fullWidth:!0},s.a.createElement(s.a.Fragment,null,s.a.createElement(D.e,{path:"newTermsFields",component:kt,componentProps:{browserFields:Le}}),s.a.createElement(D.e,{path:"historyWindowSize",component:St.a,componentProps:{idAria:"detectionEngineStepDefineRuleHistoryWindowSize",dataTestSubj:"detectionEngineStepDefineRuleHistoryWindowSize",timeTypes:["m","h","d"]}}))),s.a.createElement(D.e,{path:"timeline",component:xe.a,componentProps:{idAria:"detectionEngineStepDefineRuleTimeline",isDisabled:u,dataTestSubj:"detectionEngineStepDefineRuleTimeline"}}))),!k&&s.a.createElement(Oe.a,{dataTestSubj:"define-continue",onClick:We,isDisabled:u}));var ct},Dt=Object(i.memo)(Mt)},function(e,t,a){"use strict";a.d(t,"b",(function(){return H})),a.d(t,"a",(function(){return Q}));var n=a(53),i=a.n(n),s=a(17),r=a(3),o=a(4),l=a.n(o),c=a(175),u=a(183),d=a(262),p=a(238),m=a(5),g=a(6);const f=()=>l.a.createElement(l.a.Fragment,null,l.a.createElement(s.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1,"data-test-subj":"response-actions-header"},l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(s.EuiTitle,{size:"s"},l.a.createElement("h4",null,l.a.createElement(c.FormattedMessage,{defaultMessage:"Response Actions",id:"xpack.securitySolution.actionForm.responseActionSectionsDescription"})))),l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(s.EuiBetaBadge,{tooltipContent:g.i18n.translate("xpack.securitySolution.actionForm.experimentalTooltip",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),label:g.i18n.translate("xpack.securitySolution.rules.actionForm.experimentalTitle",{defaultMessage:"Technical preview"})}))),l.a.createElement(s.EuiSpacer,{size:"m"}),l.a.createElement(s.EuiFlexItem,null,l.a.createElement(c.FormattedMessage,{defaultMessage:"Response actions are run on each rule execution",id:"xpack.securitySolution.actionForm.responseActionSectionsTitle"})),l.a.createElement(s.EuiSpacer,{size:"m"}));var b=a(79),h=a(210);const y=({supportedResponseActionTypes:e,addActionType:t,updateActionTypeId:a})=>{const[n]=Object(h.m)(),[i,r]=Object(o.useState)(n.responseActions&&n.responseActions.length>0),u=Object(b.b)().isGoldPlus(),d=Object(o.useCallback)((e=>{r(!1),t(),a(e.id)}),[t,a]),p=Object(o.useMemo)((()=>l.a.createElement(s.EuiFlexGroup,null,l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(s.EuiSpacer,{size:"m"}),l.a.createElement(s.EuiButton,{size:"s","data-test-subj":"addAlertActionButton",onClick:()=>r(!1)},l.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.sections.actionForm.addResponseActionButtonLabel",defaultMessage:"Add response action"}))))),[]),m=Object(o.useMemo)((()=>(null==e?void 0:e.length)&&e.map((function(e,t){const a=l.a.createElement(s.EuiKeyPadMenuItem,{key:t,isDisabled:!u,"data-test-subj":`${e.id}-ResponseActionTypeSelectOption`,label:e.name,onClick:()=>d(e)},l.a.createElement(s.EuiIcon,{size:"xl",type:e.iconClass}));return l.a.createElement(s.EuiFlexItem,{grow:!1,key:`keypad-${e.id}`},a)}))),[d,u,e]);return null!=e&&e.length?l.a.createElement(l.a.Fragment,null,i?p:m):l.a.createElement(l.a.Fragment,null)};var E=a(456),v=a(19),k=a(739);const S=l.a.memo((e=>{const{osquery:t,application:a}=Object(v.k)().services,n=Object(o.useMemo)((()=>null==t?void 0:t.OsqueryResponseActionTypeForm),[null==t?void 0:t.OsqueryResponseActionTypeForm]);if(t){var i,r,u,d,p,m,g,f;const{disabled:o,permissionDenied:b}=null==t?void 0:t.fetchInstallationStatus(),h=!(null!=a&&null!==(i=a.capabilities)&&void 0!==i&&null!==(r=i.osquery)&&void 0!==r&&r.writeLiveQueries||null!=a&&null!==(u=a.capabilities)&&void 0!==u&&null!==(d=u.osquery)&&void 0!==d&&d.runSavedQueries&&(null!=a&&null!==(p=a.capabilities)&&void 0!==p&&null!==(m=p.osquery)&&void 0!==m&&m.readSavedQueries||null!=a&&null!==(g=a.capabilities)&&void 0!==g&&null!==(f=g.osquery)&&void 0!==f&&f.readPacks));if(b||h)return l.a.createElement(l.a.Fragment,null,l.a.createElement(s.EuiEmptyPrompt,{title:l.a.createElement("h2",null,k.b),titleSize:"xs",iconType:"logoOsquery",body:l.a.createElement("p",null,l.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.osquery.action.missingPrivilleges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:l.a.createElement(s.EuiCode,null,"osquery")}}))}));if(o)return l.a.createElement(s.EuiEmptyPrompt,{iconType:"logoOsquery",title:l.a.createElement("h2",null,k.c),titleSize:"xs",body:l.a.createElement("p",null,k.a)});if(n)return l.a.createElement(n,e)}return null}));S.displayName="OsqueryResponseAction";const T=l.a.memo((e=>{const{item:t,onDeleteAction:a,formRef:n}=e,[i,r]=Object(o.useState)(!0),[c]=Object(h.m)(),u=Object(m.get)(c,t.path),d=Object(o.useCallback)((()=>(null==u?void 0:u.actionTypeId)===E.a.OSQUERY?l.a.createElement(S,{item:t,formRef:n}):null),[null==u?void 0:u.actionTypeId,n,t]),p=Object(o.useCallback)((()=>{a(t.id)}),[t,a]),f=Object(o.useMemo)((()=>{const{logo:e,name:t}=(null==u||u.actionTypeId,E.a.OSQUERY,{logo:"logoOsquery",name:"Osquery"});return l.a.createElement(s.EuiFlexGroup,{gutterSize:"l",alignItems:"center"},l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(s.EuiIcon,{type:e,size:"m"})),l.a.createElement(s.EuiFlexItem,null,l.a.createElement(s.EuiText,null,l.a.createElement(s.EuiFlexGroup,{gutterSize:"s"},l.a.createElement(s.EuiFlexItem,{grow:!1},t)))))}),[null==u?void 0:u.actionTypeId]),b=Object(o.useMemo)((()=>l.a.createElement(s.EuiButtonIcon,{iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":g.i18n.translate("xpack.securitySolution.actionTypeForm.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),onClick:p})),[p]);return l.a.createElement(s.EuiAccordion,{initialIsOpen:!0,key:t.id,id:t.id.toString(),onToggle:r,paddingSize:"l",className:"actAccordionActionForm",buttonContentClassName:"actAccordionActionForm__button","data-test-subj":"alertActionAccordion",buttonContent:f,extraAction:b},d())}));T.displayName="ResponseActionTypeForm";const x=()=>l.a.createElement(l.a.Fragment,null),w=l.a.memo((({items:e,removeItem:t,supportedResponseActionTypes:a,addItem:n,formRef:i})=>{const r=Object(o.useRef)(null),c=Object(o.useCallback)((e=>{r.current=e}),[]),u=Object(h.l)(),d=Object(o.useMemo)((()=>l.a.createElement(y,{supportedResponseActionTypes:a,addActionType:n,updateActionTypeId:c})),[n,c,a]);return Object(o.useEffect)((()=>{if(r.current){const t=`responseActions[${e.length-1}].actionTypeId`;u.setFieldValue(t,r.current),r.current=null}}),[u,e.length]),l.a.createElement("div",{"data-test-subj":"response-actions-list"},e.map(((e,a)=>l.a.createElement("div",{key:e.id,"data-test-subj":`response-actions-list-item-${a}`},l.a.createElement(s.EuiSpacer,{size:"m"}),l.a.createElement(T,{item:e,onDeleteAction:t,formRef:i}),l.a.createElement(h.e,{path:`${e.path}.actionTypeId`,component:x})))),d)}));w.displayName="ResponseActionsList";const O=[{id:E.a.OSQUERY,name:"osquery",iconClass:"logoOsquery"}],j=({items:e,addItem:t,removeItem:a,saveClickRef:n})=>{const i=Object(o.useRef)({validation:{}}),r=(()=>{const[e,t]=Object(o.useState)(),a=(()=>{const{osquery:e}=Object(v.k)().services,t=null==e?void 0:e.fetchInstallationStatus();return!(null!=t&&t.loading||null!=t&&t.disabled||null!=t&&t.permissionDenied)})();return Object(o.useEffect)((()=>{const e=O.filter((e=>E.c.includes(e.id)));t(e)}),[a]),e})();Object(o.useEffect)((()=>{n&&n.current&&(n.current.onSaveClick=()=>c())}),[n]);const c=async()=>{var e;if(!Object(m.isEmpty)(null===(e=i.current)||void 0===e?void 0:e.validation)){var t;const e=await Promise.all(Object(m.map)(null===(t=i.current)||void 0===t?void 0:t.validation,(async e=>e())));return Object(m.some)(e,(e=>!e))}},u=Object(o.useMemo)((()=>null!=r&&r.length?l.a.createElement(w,{items:e,removeItem:a,supportedResponseActionTypes:r,addItem:t,formRef:i}):null),[t,i,e,a,r]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(s.EuiSpacer,{size:"xxl","data-test-subj":"response-actions-form"}),l.a.createElement(f,null),u)};var I=a(250),C=a(417),M=a(406),D=a(523),A=a(696),F=a(685);const R=g.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithoutEnablingTitle",{defaultMessage:"Create rule without enabling it"}),P=g.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithEnablingTitle",{defaultMessage:"Create & enable rule"}),_=g.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'}),q=g.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleHelpText",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true."}),N=g.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleHelpTextWhenQuery",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true. This frequency does not apply to Response Actions."});var L=a(1),B=a(31);const z="Cases",H={enabled:!0,actions:[],responseActions:[],kibanaSiemAppUrl:"",throttle:D.a.value},$=()=>l.a.createElement(l.a.Fragment,null),V=()=>l.a.createElement(l.a.Fragment,null,l.a.createElement(s.EuiTitle,{size:"s"},l.a.createElement("h4",null,l.a.createElement(c.FormattedMessage,{defaultMessage:"Actions",id:"xpack.securitySolution.detectionEngine.rule.editRule.actionSectionsTitle"}))),l.a.createElement(s.EuiSpacer,{size:"l"})),U=({addPadding:e=!1,defaultValues:t,isReadOnlyView:a,isLoading:n,isUpdateView:c=!1,onSubmit:m,setForm:f,actionMessageParams:b,ruleType:y})=>{const[E]=(()=>{const e=Object(o.useRef)(!0),[t,a]=Object(o.useState)(!0),[n,i]=Object(o.useState)(!1);return Object(o.useEffect)((()=>{const t=new AbortController;return e.current&&(e.current=!1,(async()=>{try{Object(v.c)(await v.b.get().http.fetch(Object(B.getAllConnectorsUrl)(),{method:"GET",signal:t.signal})).some((e=>".case"===e.connectorTypeId&&e.name===z))||await v.b.get().http.post(Object(B.getCreateConnectorUrl)(),{method:"POST",body:JSON.stringify({connector_type_id:".case",config:{},name:z,secrets:{}}),signal:t.signal}),a(!1)}catch{a(!1),i(!0)}})()),()=>{t.abort()}}),[]),[t,n]})(),{services:{application:k,triggersActionsUi:{actionTypeRegistry:S}}}=Object(v.k)(),T=Object(p.a)("responseActionsEnabled"),x=Object(o.useMemo)((()=>k.getUrlForApp(`${L.A}`,{absolute:!0})),[k]),w={...null!=t?t:H,kibanaSiemAppUrl:x},O=Object(o.useMemo)((()=>(({actionTypeRegistry:e})=>({actions:{validations:[{validator:Object(F.a)(e)}]},enabled:{},kibanaSiemAppUrl:{},throttle:{label:g.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleLabel",{defaultMessage:"Actions frequency"})}}))({actionTypeRegistry:S})),[S]),{form:U}=Object(h.k)({defaultValue:w,options:{stripEmptyFields:!1},schema:O}),{getFields:Q,getFormData:W,submit:G}=U,[{throttle:K}]=Object(h.m)({form:U,watch:["throttle"]}),J=K||w.throttle,Y=Object(o.useCallback)((e=>{Q().enabled.setValue(e),m&&m()}),[Q,m]),X=Object(o.useRef)({onSaveClick:()=>null}),Z=Object(o.useCallback)((async()=>{if(await X.current.onSaveClick())return{isValid:!1,data:W()};const e=await G();return null!=e&&e.isValid?e:{isValid:!1,data:W()}}),[W,G]);Object(o.useEffect)((()=>{let e=!1;return f&&!e&&f(I.b.ruleActions,Z),()=>{e=!0}}),[Z,f]);const ee=Object(o.useMemo)((()=>(e=>e&&Object(r.findIndex)(["value",e],D.c)<0?[...D.c,{value:e,text:e}]:D.c)(J)),[J]),te=Object(o.useMemo)((()=>({idAria:"detectionEngineStepRuleActionsThrottle",isDisabled:n,isLoading:E,dataTestSubj:"detectionEngineStepRuleActionsThrottle",hasNoInitialSelection:!1,helpText:Object(d.d)(y)?N:q,euiFieldProps:{options:ee}})),[n,E,y,ee]),ae=Object(o.useMemo)((()=>J!==H.throttle?l.a.createElement(l.a.Fragment,null,l.a.createElement(s.EuiSpacer,null),l.a.createElement(h.e,{path:"actions",component:A.a,componentProps:{messageVariables:b}})):l.a.createElement(h.e,{path:"actions",component:$})),[J,b]),ne=Object(o.useMemo)((()=>Object(d.d)(y)?l.a.createElement(u.UseArray,{path:"responseActions",initialNumberOfItems:0},(e=>l.a.createElement(j,i()({},e,{saveClickRef:X})))):null),[y]),ie=Object(o.useMemo)((()=>k.capabilities.actions.show?l.a.createElement(l.a.Fragment,null,l.a.createElement(V,null),l.a.createElement(h.e,{path:"throttle",component:D.d,componentProps:te}),ae,T&&ne,l.a.createElement(h.e,{path:"kibanaSiemAppUrl",component:$}),l.a.createElement(h.e,{path:"enabled",component:$})):l.a.createElement(l.a.Fragment,null,l.a.createElement(s.EuiText,null,_),l.a.createElement(h.e,{path:"throttle",componentProps:te,component:$}),l.a.createElement(h.e,{path:"actions",component:$}),l.a.createElement(h.e,{path:"kibanaSiemAppUrl",component:$}),l.a.createElement(h.e,{path:"enabled",component:$}))),[k.capabilities.actions.show,ae,ne,T,te]);return a?l.a.createElement(M.a,{addPadding:e},l.a.createElement(C.a,{schema:O,data:w,columns:"single"})):l.a.createElement(l.a.Fragment,null,l.a.createElement(M.a,{addPadding:!c},l.a.createElement(h.c,{form:U,"data-test-subj":"stepRuleActions"},l.a.createElement(s.EuiForm,null,ie))),!c&&l.a.createElement(l.a.Fragment,null,l.a.createElement(s.EuiHorizontalRule,{margin:"m"}),l.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(s.EuiButton,{fill:!1,isDisabled:n,isLoading:n,onClick:()=>Y(!1)},R)),l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(s.EuiButton,{fill:!0,isDisabled:n,isLoading:n,onClick:()=>Y(!0),"data-test-subj":"create-enable"},P)))))},Q=Object(o.memo)(U)},function(e,t,a){"use strict";a.d(t,"a",(function(){return ke}));var n=a(17),i=a(4),s=a.n(i),r=a(24),o=a.n(r),l=a(262),c=a(250),u=a(53),d=a.n(u),p=a(3),m=a(215),g=a(210);const f=o()(n.EuiFormRow).withConfig({displayName:"MyEuiFormRow",componentId:"sc-1urlknr-0"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),b=o()(n.EuiButtonEmpty).withConfig({displayName:"MyAddItemButton",componentId:"sc-1urlknr-1"})(["margin:4px 0px;&.euiButtonEmpty--small{font-size:12px;}.euiIcon{width:12px;height:12px;}"]);b.defaultProps={flush:"left",iconType:"plusInCircle",size:"s"};const h=({addText:e,dataTestSubj:t,field:a,idAria:r,isDisabled:o,validate:l})=>{const[c,u]=Object(i.useState)(!1),{isInvalid:h,errorMessage:y}=Object(g.i)(a),[E,v]=Object(i.useState)(-1),k=Object(i.useRef)([]),S=Object(i.useCallback)((e=>{const t=a.value,n=[...t.slice(0,e),...t.slice(e+1)];a.setValue(0===n.length?[""]:n),k.current=[...k.current.slice(0,e),...k.current.slice(e+1)],k.current=k.current.map(((t,a)=>(a>=e&&null!=k.current[e]&&(t.value="re-render"),t)))}),[a]),T=Object(i.useCallback)((()=>{const e=a.value;a.setValue([...e,""])}),[a]),x=Object(i.useCallback)(((e,t)=>{const n=a.value,i=e.target.value;a.setValue([...n.slice(0,t),i,...n.slice(t+1)])}),[a]),w=Object(i.useCallback)(((e,t)=>{null!=t&&(k.current=[...k.current.slice(0,e),t,...k.current.slice(e+1)])}),[k]);Object(i.useEffect)((()=>{-1===E||Object(p.isEmpty)(k.current)||null==k.current[E]||(k.current[E].focus(),v(-1))}),[E,k.current]);const O=a.value;return s.a.createElement(f,{label:a.label,labelAppend:a.labelAppend,error:c?y:null,isInvalid:c&&h,fullWidth:!0,"data-test-subj":t,describedByIds:r?[r]:void 0},s.a.createElement(s.a.Fragment,null,O.map(((e,t)=>{const a={disabled:o,...t===O.length-1?{inputRef:w.bind(null,t)}:{},value:e,isInvalid:null!=l&&c&&l(e)};return s.a.createElement("div",{key:t},s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(n.EuiFlexItem,{grow:!0},s.a.createElement(n.EuiFieldText,d()({onBlur:()=>u(!0),onChange:e=>x(e,t),fullWidth:!0},a))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:o||Object(p.isEmpty)(e)&&1===O.length,onClick:()=>S(t),"aria-label":m.tb}))),O.length-1!==t&&s.a.createElement(n.EuiSpacer,{size:"s"}))})),s.a.createElement(b,{onClick:T,isDisabled:o},e)))};var y=a(417),E=a(5),v=a(357),k=a(307);const S=[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}];Object(k.b)([]);var T=a(6);const x=T.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.threatsDescription",{defaultMessage:"threats"}),w=T.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticsDescription",{defaultMessage:"tactic"}),O=T.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquesDescription",{defaultMessage:"technique"}),j=T.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquesDescription",{defaultMessage:"subtechnique"}),I=T.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTacticTitle",{defaultMessage:"Add tactic"}),C=T.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTechniqueTitle",{defaultMessage:"Add technique"}),M=T.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addSubtechniqueTitle",{defaultMessage:"Add subtechnique"}),D=T.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticPlaceHolderDescription",{defaultMessage:"Select a tactic ..."}),A=T.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquePlaceHolderDescription",{defaultMessage:"Select a technique ..."}),F=T.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquePlaceHolderDescription",{defaultMessage:"Select a subtechnique ..."}),R=e=>v.a.some((t=>t.techniqueId===e.id)),P=o.a.div.withConfig({displayName:"SubtechniqueContainer",componentId:"sc-1cb5h5o-0"})(["margin-left:48px;"]),_=({field:e,idAria:t,isDisabled:a,threatIndex:r,techniqueIndex:o,onFieldChange:l})=>{const c=e.value,u=Object(i.useMemo)((()=>{var e;return[...null!==(e=c[r].technique)&&void 0!==e?e:[]]}),[c,r]),d=Object(i.useCallback)((t=>{var a;const n=[...e.value],i=null!==(a=u[o].subtechnique)&&void 0!==a?a:[];null!=i&&(i.splice(t,1),u[o]={...u[o],subtechnique:i},n[r].technique=u,l(n))}),[e,l,o,u,r]),g=Object(i.useCallback)((()=>{const t=[...e.value],a=u[o].subtechnique;u[o]=null!=a?{...u[o],subtechnique:[...a,{id:"none",name:"none",reference:"none"}]}:{...u[o],subtechnique:[{id:"none",name:"none",reference:"none"}]},t[r].technique=u,l(t)}),[e,l,o,u,r]),f=Object(i.useCallback)(((t,a)=>{const n=[...e.value],{id:i,reference:s,name:c}=v.a.find((e=>e.value===a))||{id:"",name:"",reference:""},d=u[o].subtechnique;null!=d&&l([...n.slice(0,r),{...n[r],technique:[...u.slice(0,o),{...u[o],subtechnique:[...d.slice(0,t),{id:i,reference:s,name:c},...d.slice(t+1)]},...u.slice(o+1)]},...n.slice(r+1)])}),[r,o,l,e,u]),h=Object(i.useCallback)(((t,a,i)=>{const r=v.a.filter((e=>e.techniqueId===u[o].id));return s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiSuperSelect,{id:"mitreAttackSubtechnique",options:[..."none"===i.name?[{inputDisplay:s.a.createElement(s.a.Fragment,null,F),value:"none",disabled:a}]:[],...r.map((e=>({inputDisplay:s.a.createElement(s.a.Fragment,null,e.label),value:e.value,disabled:a})))],prepend:`${e.label} ${j}`,"aria-label":"",onChange:f.bind(null,t),fullWidth:!0,valueOfSelected:Object(p.camelCase)(i.name),"data-test-subj":"mitreAttackSubtechnique",disabled:a,placeholder:F}))}),[e,f,u,o]),y=Object(i.useMemo)((()=>u[o].subtechnique),[u,o]);return s.a.createElement(P,null,null!=y&&y.map(((e,i)=>s.a.createElement("div",{key:i},s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(n.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${j}`]:void 0},s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(n.EuiFlexItem,{grow:!0},h(i,a,e)),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:a,onClick:()=>d(i),"aria-label":m.tb}))))))),s.a.createElement(b,{"data-test-subj":"addMitreAttackSubtechnique",onClick:g,isDisabled:a},M))},q=o.a.div.withConfig({displayName:"TechniqueContainer",componentId:"sc-1fugnao-0"})(["",""],(({theme:e})=>Object(r.css)(["margin-left:24px;padding-left:24px;border-left:2px solid ",";"],e.eui.euiColorLightestShade))),N=({field:e,idAria:t,isDisabled:a,threatIndex:r,onFieldChange:o})=>{var l;const c=e.value,u=Object(i.useCallback)((t=>{var a;const n=[...e.value],i=null!==(a=n[r].technique)&&void 0!==a?a:[];i.splice(t,1),n[r]={...n[r],technique:i},o(n)}),[e,r,o]),d=Object(i.useCallback)((()=>{var t;const a=[...e.value];a[r]={...a[r],technique:[...null!==(t=a[r].technique)&&void 0!==t?t:[],{id:"none",name:"none",reference:"none",subtechnique:[]}]},o(a)}),[e,r,o]),g=Object(i.useCallback)(((t,a)=>{var n;const i=[...e.value],{id:s,reference:l,name:c}=v.c.find((e=>e.value===a))||{id:"",name:"",reference:""},u=null!==(n=i[r].technique)&&void 0!==n?n:[];o([...i.slice(0,r),{...i[r],technique:[...u.slice(0,t),{id:s,reference:l,name:c,subtechnique:[]},...u.slice(t+1)]},...i.slice(r+1)])}),[r,o,e]),f=Object(i.useCallback)(((t,a,i,r)=>{const o=v.c.filter((e=>e.tactics.includes(Object(p.kebabCase)(t))));return s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiSuperSelect,{id:"mitreAttackTechnique",options:[..."none"===r.name?[{inputDisplay:s.a.createElement(s.a.Fragment,null,A),value:"none",disabled:i}]:[],...o.map((e=>({inputDisplay:s.a.createElement(s.a.Fragment,null,e.label),value:e.value,disabled:i})))],prepend:`${e.label} ${O}`,"aria-label":"",onChange:g.bind(null,a),fullWidth:!0,valueOfSelected:Object(p.camelCase)(r.name),"data-test-subj":"mitreAttackTechnique",disabled:i,placeholder:A}))}),[e,g]),h=null!==(l=c[r].technique)&&void 0!==l?l:[];return s.a.createElement(q,null,h.map(((i,l)=>s.a.createElement("div",{key:l},s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(n.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${O}`]:void 0},s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(n.EuiFlexItem,{grow:!0},f(c[r].tactic.name,l,a,i)),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:a,onClick:()=>u(l),"aria-label":m.tb})))),s.a.createElement(_,{field:e,idAria:t,isDisabled:a||"none"===i.name||!1===R(i),threatIndex:r,techniqueIndex:l,onFieldChange:o})))),s.a.createElement(b,{"data-test-subj":"addMitreAttackTechnique",onClick:d,isDisabled:a},C))},L=o.a.div.withConfig({displayName:"MitreAttackContainer",componentId:"sc-bsl0gv-0"})(["margin-top:16px;"]),B=o()(n.EuiFormRow).withConfig({displayName:"InitialMitreAttackFormRow",componentId:"sc-bsl0gv-1"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),z=Object(i.memo)((({field:e,idAria:t,isDisabled:a})=>{const r=Object(i.useCallback)((t=>{const a=[...e.value];a.splice(t,1),Object(p.isEmpty)(a)?e.setValue(S):e.setValue(a)}),[e]),o=Object(i.useCallback)((()=>{const t=[...e.value];Object(p.isEmpty)(t[t.length-1])?e.setValue([{tactic:{id:"none",name:"none",reference:"none"},technique:[]}]):e.setValue([...t,{tactic:{id:"none",name:"none",reference:"none"},technique:[]}])}),[e]),l=Object(i.useCallback)(((t,a)=>{const n=[...e.value],{id:i,reference:s,name:r}=v.b.find((e=>e.value===a))||{id:"",name:"",reference:""};n.splice(t,1,{...n[t],tactic:{id:i,reference:s,name:r},technique:[]}),e.setValue([...n])}),[e]),c=Object(i.useMemo)((()=>[...e.value]),[e]),u=Object(i.useCallback)(((t,i,o)=>{const u=t.tactic.name;return s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(n.EuiFlexItem,{grow:!0},s.a.createElement(n.EuiSuperSelect,{id:"mitreAttackTactic",options:[..."none"===u?[{inputDisplay:s.a.createElement(s.a.Fragment,null,D),value:"none",disabled:o}]:[],...v.b.map((e=>({inputDisplay:s.a.createElement(s.a.Fragment,null,e.text),value:e.value,disabled:o})))],prepend:`${e.label} ${w}`,"aria-label":"",onChange:l.bind(null,i),fullWidth:!0,valueOfSelected:Object(p.camelCase)(u),"data-test-subj":"mitreAttackTactic",placeholder:D})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:a||Object(E.isEqual)(c,S),onClick:()=>r(i),"aria-label":m.tb})))}),[e,a,r,l,c]),d=Object(i.useCallback)((t=>{e.setValue(t)}),[e]);return s.a.createElement(L,null,c.map(((i,r)=>s.a.createElement("div",{key:r},0===r?s.a.createElement(B,{fullWidth:!0,label:`${e.label} ${x}`,labelAppend:e.labelAppend,describedByIds:t?[`${t} ${w}`]:void 0},s.a.createElement(s.a.Fragment,null,u(i,r,a))):s.a.createElement(n.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${w}`]:void 0},u(i,r,a)),s.a.createElement(N,{field:e,threatIndex:r,isDisabled:a||"none"===i.tactic.name,idAria:t,onFieldChange:d})))),s.a.createElement(b,{"data-test-subj":"addMitreAttackTactic",onClick:o,isDisabled:a},I))}));var H=a(524),$=a(292),V=a(595),U=a(489);const{emptyField:Q}=g.h,W={author:{type:g.a.COMBO_BOX,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:V.a,validations:[{validator:Q(T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.authorFieldEmptyError",{defaultMessage:"An author must not be empty"})),type:g.g.ARRAY_ITEM,isBlocking:!1}]},name:{type:g.a.TEXT,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:Q(T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:g.a.TEXTAREA,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:Q(T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:g.a.CHECKBOX,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:V.a},isAssociatedToEndpointList:{type:g.a.CHECKBOX,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:V.a},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:V.a,validations:[{validator:(...e)=>{const[{value:t,path:a}]=e;let n=!1;return t.forEach((e=>{Object($.c)(e)&&(n=!0)})),n?{code:"ERR_FIELD_FORMAT",path:a,message:U.k}:void 0}}]},falsePositives:{label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:V.a},license:{type:g.a.TEXT,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:V.a},ruleNameOverride:{type:g.a.TEXT,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:V.a},threat:{label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),labelAppend:V.a},threatIndicatorPath:{type:g.a.TEXT,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),labelAppend:V.a},timestampOverride:{type:g.a.TEXT,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:V.a},timestampOverrideFallbackDisabled:{type:g.a.CHECKBOX,defaultValue:!1,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideFallbackDisabledLabel",{defaultMessage:"Do not use @timestamp as a fallback timestamp field"}),labelAppend:V.a},tags:{type:g.a.COMBO_BOX,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:V.a,validations:[{validator:Q(T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.tagFieldEmptyError",{defaultMessage:"A tag must not be empty"})),type:g.g.ARRAY_ITEM,isBlocking:!1}]},note:{type:g.a.TEXTAREA,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:V.a}},G={type:g.a.TEXT,label:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),validations:[{validator:Q(T.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.threatIndicatorPathFieldEmptyError",{defaultMessage:"Indicator prefix override must not be empty"})),type:g.g.FIELD}]};var K=a(406),J=a(490),Y=a(648),X=a(360),Z=a(580),ee=a(19);const te=o.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1o9f6e3-0"})(["margin-left:24px;"]),ae=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1o9f6e3-1"})(["max-width:376px;"]),ne=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1o9f6e3-2"})(["width:20px;"]),ie=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemSeverityColumn",componentId:"sc-1o9f6e3-3"})(["width:80px;"]),se=({dataTestSubj:e,field:t,idAria:a,indices:r,isDisabled:o,options:l})=>{const{services:c}=Object(ee.k)(),{value:u,isMappingChecked:d,mapping:m}=t.value,{setValue:g}=t,f=Object(i.useCallback)(((e,t)=>{g({value:u,isMappingChecked:d,mapping:[...m.slice(0,t),...e,...m.slice(t+1)]})}),[u,d,m,g]),b=Object(i.useCallback)(((e,t,[a])=>{var n;const i=[{...m[e],field:null!==(n=null==a?void 0:a.name)&&void 0!==n?n:"",value:null!=a?m[e].value:"",operator:"equals",severity:t}];f(i,e)}),[m,f]),h=Object(i.useCallback)((e=>{g({value:e,isMappingChecked:d,mapping:m})}),[d,m,g]),y=Object(i.useCallback)(((e,t,a)=>{const n=[{...m[e],field:m[e].field,value:null!=m[e].field&&""!==m[e].field?a:"",operator:"equals",severity:t}];f(n,e)}),[m,f]),E=Object(i.useCallback)((()=>{g({value:u,mapping:[...m],isMappingChecked:!d})}),[d,m,u,g]),v=Object(i.useMemo)((()=>s.a.createElement("div",null,s.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},s.a.createElement(n.EuiFlexItem,null,Z.b)),s.a.createElement(n.EuiSpacer,{size:"xs"}),s.a.createElement(n.EuiText,{size:"xs"},Z.c))),[]),k=Object(i.useMemo)((()=>s.a.createElement("div",null,s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:o?p.noop:E},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiCheckbox,{id:"severity-mapping-override",checked:d,disabled:o,onChange:E})),s.a.createElement(n.EuiFlexItem,null,Z.d)),s.a.createElement(n.EuiSpacer,{size:"xs"}),s.a.createElement(te,null,s.a.createElement(n.EuiText,{size:"xs"},Z.e)))),[E,o,d]);return s.a.createElement(n.EuiFlexGroup,{direction:"column"},s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiFormRow,{label:v,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":"detectionEngineStepAboutRuleSeverity",describedByIds:["detectionEngineStepAboutRuleSeverity"]},s.a.createElement(n.EuiSuperSelect,{fullWidth:!1,disabled:!1,valueOfSelected:u,onChange:h,options:l,"data-test-subj":"select"}))),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiFormRow,{label:k,labelAppend:t.labelAppend,helpText:d?s.a.createElement(te,null,Z.f):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-severityOverride`,describedByIds:a?[a]:void 0},s.a.createElement(te,null,s.a.createElement(n.EuiSpacer,{size:"s"}),d&&s.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"s"},s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(ae,null,s.a.createElement(n.EuiFormLabel,null,Z.g)),s.a.createElement(ae,null,s.a.createElement(n.EuiFormLabel,null,Z.h)),s.a.createElement(ne,{grow:!1}),s.a.createElement(ie,{grow:!1},s.a.createElement(n.EuiFormLabel,null,Z.a)))),m.map(((e,t)=>{var a;return s.a.createElement(n.EuiFlexItem,{key:`${e.severity}-${t}`},s.a.createElement(n.EuiFlexGroup,{"data-test-subj":"severityOverrideRow",alignItems:"center",gutterSize:"s"},s.a.createElement(ae,null,s.a.createElement(X.b,{placeholder:"",selectedField:re(e,r),isLoading:!1,isDisabled:o,isClearable:!1,indexPattern:r,onChange:b.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`})),s.a.createElement(ae,null,s.a.createElement(X.a,{autocompleteService:c.unifiedSearch.autocomplete,placeholder:"",selectedField:re(e,r),selectedValue:e.value,isClearable:!1,isDisabled:o,isLoading:!1,indexPattern:r,onChange:y.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`})),s.a.createElement(ne,{grow:!1},s.a.createElement(n.EuiIcon,{type:"sortRight"})),s.a.createElement(ie,{grow:!1},null===(a=l.find((t=>t.value===e.severity)))||void 0===a?void 0:a.inputDisplay)))})))))))},re=(e,t)=>{const{field:a}=e,[n]=t.fields.filter((({name:e})=>a===e));return null!=n?n:{name:a,type:"string"}};var oe=a(581);const le=o.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1k1nimg-0"})(["margin-left:24px;"]),ce=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1k1nimg-1"})(["max-width:376px;"]),ue=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1k1nimg-2"})(["width:20px;"]),de=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemRiskScoreColumn",componentId:"sc-1k1nimg-3"})(["width:160px;"]),pe=({dataTestSubj:e,field:t,idAria:a,indices:r,isDisabled:o,placeholder:l})=>{const{value:c,isMappingChecked:u,mapping:d}=t.value,{setValue:m}=t,g=Object(i.useMemo)((()=>["number"]),[]),f=Object(i.useMemo)((()=>me(d,r)),[d,r]),b=Object(i.useCallback)((e=>{const t=e.target.value;m({value:Number(t.trim()),isMappingChecked:u,mapping:d})}),[m,u,d]),h=Object(i.useCallback)((([e])=>{var t;m({value:c,isMappingChecked:u,mapping:[{field:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",operator:"equals",value:"",risk_score:void 0}]})}),[m,c,u]),y=Object(i.useCallback)((()=>{m({value:c,isMappingChecked:!u,mapping:[...d]})}),[m,c,u,d]),E=Object(i.useMemo)((()=>s.a.createElement("div",null,s.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},s.a.createElement(n.EuiFlexItem,null,oe.a)),s.a.createElement(n.EuiSpacer,{size:"xs"}),s.a.createElement(n.EuiText,{size:"xs"},oe.c))),[]),v=Object(i.useMemo)((()=>s.a.createElement("div",null,s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:o?p.noop:y},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiCheckbox,{id:"risk_score-mapping-override",checked:u,disabled:o,onChange:y})),s.a.createElement(n.EuiFlexItem,null,oe.e)),s.a.createElement(n.EuiSpacer,{size:"xs"}),s.a.createElement(le,null,s.a.createElement(n.EuiText,{size:"xs"},oe.f)))),[u,y,o]);return s.a.createElement(n.EuiFlexGroup,{direction:"column"},s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiFormRow,{label:E,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-defaultRisk`,describedByIds:a?[a]:void 0},s.a.createElement(n.EuiRange,{value:c,onChange:b,max:100,min:0,showRange:!0,showInput:!0,fullWidth:!1,showTicks:!0,tickInterval:25,"data-test-subj":`${e}-defaultRiskRange`}))),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiFormRow,{label:v,labelAppend:t.labelAppend,helpText:u?s.a.createElement(le,null,oe.g):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-riskOverride`,describedByIds:a?[a]:void 0},s.a.createElement(le,null,s.a.createElement(n.EuiSpacer,{size:"s"}),u&&s.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"s"},s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(ce,null,s.a.createElement(n.EuiFormLabel,null,oe.h)),s.a.createElement(ue,{grow:!1}),s.a.createElement(de,{grow:!1},s.a.createElement(n.EuiFormLabel,null,oe.a)))),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(ce,null,s.a.createElement(X.b,{placeholder:null!=l?l:"",indexPattern:r,selectedField:f,fieldTypeFilter:g,isLoading:!1,isClearable:!1,isDisabled:o,onChange:h,"data-test-subj":e,"aria-label":a})),s.a.createElement(ue,{grow:!1},s.a.createElement(n.EuiIcon,{type:"sortRight"})),s.a.createElement(de,{grow:!1},s.a.createElement(n.EuiText,{size:"s"},oe.d)))))))))},me=(e,t)=>{var a,n;const i=null!==(a=null==e||null===(n=e[0])||void 0===n?void 0:n.field)&&void 0!==a?a:"",[s]=t.fields.filter((({name:e})=>null!=i&&i===e));return null!=s?s:{name:i,type:"number"}},ge=({dataTestSubj:e,field:t,idAria:a,indices:r,isDisabled:o,fieldType:l,placeholder:c})=>{const u=Object(i.useCallback)((([e])=>{var a;t.setValue(null!==(a=null==e?void 0:e.name)&&void 0!==a?a:"")}),[t]),d=Object(i.useMemo)((()=>{var e;const a=null!==(e=t.value)&&void 0!==e?e:"",[n]=r.fields.filter((({name:e})=>null!=a&&a===e));return n}),[t.value,r]),p=Object(i.useMemo)((()=>[l]),[l]);return s.a.createElement(n.EuiFormRow,{"data-test-subj":e,describedByIds:a?[a]:void 0,fullWidth:!0,helpText:t.helpText,label:t.label,labelAppend:t.labelAppend},s.a.createElement(X.b,{placeholder:null!=c?c:"",indexPattern:r,selectedField:d,fieldTypeFilter:p,isLoading:!1,isDisabled:o,isClearable:!1,onChange:u,"data-test-subj":e,"aria-label":a,fieldInputWidth:500}))};var fe=a(316),be=a(1),he=a(617);const ye=Object(g.j)({component:g.b});o.a.div.withConfig({displayName:"ThreeQuartersContainer",componentId:"sc-1nsr0kk-0"})(["max-width:740px;"]).displayName="ThreeQuartersContainer";const Ee=o.a.div.withConfig({displayName:"TagContainer",componentId:"sc-1nsr0kk-1"})(["margin-top:16px;"]);Ee.displayName="TagContainer";const ve=({addPadding:e=!1,defaultValues:t,defineRuleData:a,descriptionColumns:r="singleSplit",isReadOnlyView:o,isUpdateView:u=!1,isLoading:d,onSubmit:p,setForm:m,onRuleDataChange:f})=>{const{data:b}=Object(ee.k)().services,E=Object(i.useMemo)((()=>Object(l.e)(null==a?void 0:a.ruleType)),[a]),v=Object(i.useMemo)((()=>E?{...W,threatIndicatorPath:G}:W),[E]),[k,S]=Object(i.useState)(t.severity.value),{ruleIndices:T}=Object(he.a)(null==a?void 0:a.machineLearningJobId,null==a?void 0:a.index),[x,{indexPatterns:w}]=Object(fe.b)(T),[O,j]=Object(i.useState)(w);Object(i.useEffect)((()=>{null==(null==a?void 0:a.index)||""!==(null==a?void 0:a.dataViewId)&&null!=(null==a?void 0:a.dataViewId)||j(w)}),[null==a?void 0:a.dataViewId,null==a?void 0:a.index,w]),Object(i.useEffect)((()=>{(async()=>{if(null!=(null==a?void 0:a.dataViewId)&&""!==(null==a?void 0:a.dataViewId)){const e=await b.dataViews.get(null==a?void 0:a.dataViewId);j(e)}})()}),[b.dataViews,a,w,j]);const{form:I}=Object(g.k)({defaultValue:t,options:{stripEmptyFields:!1},schema:v}),{getFields:C,getFormData:M,submit:D}=I,[{severity:A,timestampOverride:F}]=Object(g.m)({form:I,watch:["isAssociatedToEndpointList","isBuildingBlock","riskScore","ruleNameOverride","severity","timestampOverride","threat","timestampOverrideFallbackDisabled"],onChange:e=>{f&&f({threatIndicatorPath:void 0,timestampOverrideFallbackDisabled:void 0,...e})}});Object(i.useEffect)((()=>{const e=null==A?void 0:A.value;if(null!=e&&e!==k){S(e);const t=H.h[e];if(null!=t){const e=C().riskScore;e.setValue({...e.value,value:t})}}}),[null==A?void 0:A.value,C,k]);const R=Object(i.useCallback)((async()=>{const e=await D();return null!=e&&e.isValid?{isValid:!0,data:{threatIndicatorPath:void 0,timestampOverrideFallbackDisabled:void 0,...e.data}}:{isValid:!1,data:M()}}),[M,D]),P=Object(i.useCallback)((()=>{p&&p()}),[p]);return Object(i.useEffect)((()=>{let e=!1;return m&&!e&&m(c.b.aboutRule,R),()=>{e=!0}}),[R,m]),o?s.a.createElement(K.a,{"data-test-subj":"aboutStep",addPadding:e},s.a.createElement(y.a,{columns:r,schema:v,data:t})):s.a.createElement(s.a.Fragment,null,s.a.createElement(K.a,{addPadding:!u},s.a.createElement(g.c,{form:I},s.a.createElement(ye,{path:"name",componentProps:{idAria:"detectionEngineStepAboutRuleName","data-test-subj":"detectionEngineStepAboutRuleName",euiFieldProps:{fullWidth:!0,disabled:d}}}),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(ye,{path:"description",componentProps:{idAria:"detectionEngineStepAboutRuleDescription","data-test-subj":"detectionEngineStepAboutRuleDescription",euiFieldProps:{disabled:d,compressed:!0,fullWidth:!0}}}),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(g.e,{path:"severity",component:se,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleSeverityField",idAria:"detectionEngineStepAboutRuleSeverityField",isDisabled:d||x,options:H.i,indices:O}})),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(ye,{path:"riskScore",component:pe,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRiskScore",idAria:"detectionEngineStepAboutRuleRiskScore",isDisabled:d||x,indices:O}})),s.a.createElement(Ee,null,s.a.createElement(ye,{path:"tags",componentProps:{idAria:"detectionEngineStepAboutRuleTags","data-test-subj":"detectionEngineStepAboutRuleTags",euiFieldProps:{fullWidth:!0,isDisabled:d||x,placeholder:""}}})),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(n.EuiAccordion,{"data-test-subj":"advancedSettings",id:"advancedSettingsAccordion",buttonContent:U.d},s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(g.e,{path:"references",component:h,componentProps:{addText:U.b,idAria:"detectionEngineStepAboutRuleReferenceUrls",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleReferenceUrls",validate:$.c}}),s.a.createElement(g.e,{path:"falsePositives",component:h,componentProps:{addText:U.a,idAria:"detectionEngineStepAboutRuleFalsePositives",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleFalsePositives"}}),s.a.createElement(g.e,{path:"threat",component:z,componentProps:{idAria:"detectionEngineStepAboutRuleMitreThreat",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleMitreThreat"}}),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(g.e,{path:"note",component:Y.a,componentProps:{idAria:"detectionEngineStepAboutRuleNote",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleNote",placeholder:U.c}}),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(ye,{path:"author",componentProps:{idAria:"detectionEngineStepAboutRuleAuthor","data-test-subj":"detectionEngineStepAboutRuleAuthor",euiFieldProps:{fullWidth:!0,isDisabled:d,placeholder:""}}}),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(ye,{path:"license",componentProps:{idAria:"detectionEngineStepAboutRuleLicense","data-test-subj":"detectionEngineStepAboutRuleLicense",euiFieldProps:{fullWidth:!0,disabled:d,placeholder:""}}}),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(n.EuiFormRow,{label:U.g,fullWidth:!0},s.a.createElement(ye,{path:"isAssociatedToEndpointList",componentProps:{idAria:"detectionEngineStepAboutRuleAssociatedToEndpointList","data-test-subj":"detectionEngineStepAboutRuleAssociatedToEndpointList",euiFieldProps:{disabled:d}}})),s.a.createElement(n.EuiFormRow,{label:U.e,fullWidth:!0},s.a.createElement(ye,{path:"isBuildingBlock",componentProps:{idAria:"detectionEngineStepAboutRuleBuildingBlock","data-test-subj":"detectionEngineStepAboutRuleBuildingBlock",euiFieldProps:{disabled:d}}})),s.a.createElement(n.EuiSpacer,{size:"l"}),E&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ye,{path:"threatIndicatorPath",componentProps:{idAria:"detectionEngineStepAboutThreatIndicatorPath","data-test-subj":"detectionEngineStepAboutThreatIndicatorPath",euiFieldProps:{fullWidth:!0,disabled:d,placeholder:be.S}}})),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(g.e,{path:"ruleNameOverride",component:ge,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRuleNameOverride",fieldType:"string",idAria:"detectionEngineStepAboutRuleRuleNameOverride",indices:O,isDisabled:d||x,placeholder:""}}),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(g.e,{path:"timestampOverride",component:ge,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleTimestampOverride",fieldType:"date",idAria:"detectionEngineStepAboutRuleTimestampOverride",indices:O,isDisabled:d||x,placeholder:""}}),!!F&&"@timestamp"!==F&&s.a.createElement(s.a.Fragment,null,s.a.createElement(ye,{path:"timestampOverrideFallbackDisabled",componentProps:{idAria:"detectionTimestampOverrideFallbackDisabled","data-test-subj":"detectionTimestampOverrideFallbackDisabled",euiFieldProps:{disabled:d}}}))))),!u&&s.a.createElement(J.a,{dataTestSubj:"about-continue",onClick:P,isDisabled:d}))},ke=Object(i.memo)(ve)},function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var n=a(57),i=a(556),s=a(363),r=a(246);function o(e,t,a,n){const i=Object(s.f)(e)(t);return 0===Object(r.d)(a,i)?{...e,animation:void 0,panning:void 0}:{...e,panning:void 0,translationNotCountingCurrentPanning:a,animation:{startTime:t,targetTranslation:a,initialTranslation:i,duration:n}}}var l=a(205),c=a(305),u=a(442);const d=e=>{const t=c.a-c.b;return Math.pow((e-c.b)/t,1/c.f)};var p=a(445),m=a(454),g=a(443),f=a(279);const b={currentRelatedEvent:{loading:!1,data:null},resolverComponentInstanceID:void 0,indices:[],detectedBounds:void 0};var h=a(457);const y=Object(n.combineReducers)({camera:(e=function(){return{scalingFactor:d(1),rasterSize:[0,0],translationNotCountingCurrentPanning:[0,0],latestFocusedWorldCoordinates:null,animation:void 0,panning:void 0}}(),t)=>{if("userSetZoomLevel"===t.type)return{...e,scalingFactor:Object(u.a)(t.payload,0,1)};if("userClickedZoomIn"===t.type)return{...e,scalingFactor:Object(u.a)(e.scalingFactor+.1,0,1)};if("userClickedZoomOut"===t.type)return{...e,scalingFactor:Object(u.a)(e.scalingFactor-.1,0,1)};if("userZoomed"===t.type){const a={...e,scalingFactor:Object(u.a)(e.scalingFactor+t.payload.zoomChange,0,1)};if(null===e.latestFocusedWorldCoordinates||s.b(e)(t.payload.time))return a;{const n=r.c(e.latestFocusedWorldCoordinates,s.c(e)(t.payload.time)),i=r.c(n,s.a(a)(t.payload.time)),o=r.j(i,e.latestFocusedWorldCoordinates),l=r.j(a.translationNotCountingCurrentPanning,o);return{...a,translationNotCountingCurrentPanning:l}}}if("userSetPositionOfCamera"===t.type)return{...e,animation:void 0,translationNotCountingCurrentPanning:t.payload};if("userStartedPanning"===t.type)return s.b(e)(t.payload.time)?e:{...e,animation:void 0,panning:{origin:t.payload.screenCoordinates,currentOffset:t.payload.screenCoordinates}};if("userStoppedPanning"===t.type)return{...e,translationNotCountingCurrentPanning:s.f(e)(t.payload.time),panning:void 0};if("userNudgedCamera"===t.type){const{direction:a,time:n}=t.payload,i=r.h(r.e([c.e,c.e],s.d(e)(n)),a);return o(e,n,r.a(e.translationNotCountingCurrentPanning,i),c.c)}if("userSetRasterSize"===t.type)return{...e,rasterSize:t.payload};if("userMovedPointer"===t.type){let a=e;return e.panning&&(a={...e,panning:{origin:e.panning.origin,currentOffset:t.payload.screenCoordinates}}),{...a,latestFocusedWorldCoordinates:r.c(t.payload.screenCoordinates,s.a(a)(t.payload.time))}}return e},data:(e=b,t)=>{if("appReceivedNewExternalProperties"===t.type){const a={...e,tree:{...e.tree,currentParameters:{databaseDocumentID:t.payload.databaseDocumentID,indices:t.payload.indices,filters:t.payload.filters}},resolverComponentInstanceID:t.payload.resolverComponentInstanceID,locationSearch:t.payload.locationSearch,indices:t.payload.indices},n=m.x(a);return{...a,nodeEventsInCategory:a.nodeEventsInCategory&&g.a(a.nodeEventsInCategory,n)?a.nodeEventsInCategory:void 0}}if("appRequestedResolverData"===t.type)return{...e,tree:{...e.tree,pendingRequestParameters:{databaseDocumentID:t.payload.databaseDocumentID,indices:t.payload.indices,filters:t.payload.filters}}};var a,n,i;if("appAbortedResolverDataRequest"===t.type)return p.a(t.payload,null===(a=e.tree)||void 0===a?void 0:a.pendingRequestParameters)?{...e,tree:{...e.tree,pendingRequestParameters:void 0}}:e;if("serverReturnedResolverData"===t.type)return{...e,tree:{...e.tree,lastResponse:{result:t.payload.result,dataSource:t.payload.dataSource,schema:t.payload.schema,parameters:t.payload.parameters,successful:!0},pendingRequestParameters:void 0},detectedBounds:t.payload.detectedBounds};if("serverFailedToReturnResolverData"===t.type)return void 0!==(null===(n=e.tree)||void 0===n?void 0:n.pendingRequestParameters)?{...e,tree:{...e.tree,pendingRequestParameters:void 0,lastResponse:{parameters:e.tree.pendingRequestParameters,successful:!1}}}:e;if("serverReturnedNodeEventsInCategory"===t.type){if(g.a(t.payload,m.x(e))){if(e.nodeEventsInCategory){const a=g.b(e.nodeEventsInCategory,t.payload);if(a)return{...e,nodeEventsInCategory:{...a}};throw new Error("Could not handle related event data because of an internal error.")}return{...e,nodeEventsInCategory:t.payload}}return e}if("userRequestedAdditionalRelatedEvents"===t.type)return e.nodeEventsInCategory?{...e,nodeEventsInCategory:{...e.nodeEventsInCategory,lastCursorRequested:null===(i=e.nodeEventsInCategory)||void 0===i?void 0:i.cursor}}:e;if("serverFailedToReturnNodeEventsInCategory"===t.type)return e.nodeEventsInCategory?{...e,nodeEventsInCategory:{...e.nodeEventsInCategory,error:!0}}:e;if("serverReturnedNodeData"===t.type){const a=f.e({storedNodeInfo:e.nodeData,receivedEvents:t.payload.nodeData,requestedNodes:t.payload.requestedIDs,numberOfRequestedEvents:t.payload.numberOfRequestedEvents});return{...e,nodeData:a}}if("userReloadedResolverNode"===t.type){const a=f.c(e.nodeData,t.payload);return{...e,nodeData:a}}if("appRequestingNodeData"===t.type){const a=f.d(e.nodeData,t.payload.requestedIDs);return{...e,nodeData:a}}if("serverFailedToReturnNodeData"===t.type){const a=f.b(e.nodeData,t.payload.requestedIDs);return{...e,nodeData:a}}return"appRequestedCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!0,data:null}}:"serverReturnedCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!1,data:{...t.payload}}}:"serverFailedToReturnCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!1,data:null}}:e},ui:(e={ariaActiveDescendant:null,selectedNode:null},t)=>"serverReturnedResolverData"===t.type?{...e,ariaActiveDescendant:t.payload.result.originID,selectedNode:t.payload.result.originID}:"userFocusedOnResolverNode"===t.type?{...e,ariaActiveDescendant:t.payload.nodeID}:"userSelectedResolverNode"===t.type?{...e,selectedNode:t.payload.nodeID,ariaActiveDescendant:t.payload.nodeID}:"appReceivedNewExternalProperties"===t.type?{...e,locationSearch:t.payload.locationSearch,resolverComponentInstanceID:t.payload.resolverComponentInstanceID}:e}),E=(e,t)=>{const a=y(e,t);if("userSelectedResolverNode"===t.type||"userFocusedOnResolverNode"===t.type){const e=Object(h.b)(Object(l.s)(a),t.payload.nodeID);return e?{...a,camera:o(a.camera,t.payload.time,e,c.d)}:a}return a};var v=a(306),k=a(444),S=a(5);const T=e=>{const t=Object(i.composeWithDevTools)({name:"Resolver",actionsBlacklist:["userMovedPointer"]}),a=Object(n.applyMiddleware)((e=>t=>a=>{const n=function(e,t){let a;return async()=>{const n=t.getState(),i=l.M(n);if(l.N(n)&&a)a.abort();else if(null!==i){let s,r,o,c;a=new AbortController;const u=l.K(n);t.dispatch({type:"appRequestedResolverData",payload:i});try{const n=await e.entities({_id:i.databaseDocumentID,indices:i.indices,signal:a.signal});if(n.length<1)return void t.dispatch({type:"serverFailedToReturnResolverData",payload:i});({id:s,schema:o,name:r}=n[0]),c=await e.resolverTree({dataId:s,schema:o,timeRange:u,indices:i.indices,ancestors:Object(k.a)(o),descendants:Object(k.b)()});const l={originID:s,nodes:c};if(0===l.nodes.length){const a=await e.resolverTree({dataId:s,schema:o,indices:i.indices,ancestors:Object(k.a)(o),descendants:Object(k.b)()});if(a.length>0){const e=a.map((e=>Object(v.a)(e.data["@timestamp"]))).sort(),n=e[0],s=e.slice(-1);t.dispatch({type:"serverReturnedResolverData",payload:{result:{...l,nodes:a},dataSource:r,schema:o,parameters:i,detectedBounds:{from:String(n),to:String(s)}}})}else t.dispatch({type:"serverReturnedResolverData",payload:{result:l,dataSource:r,schema:o,parameters:i}})}else t.dispatch({type:"serverReturnedResolverData",payload:{result:l,dataSource:r,schema:o,parameters:i}})}catch(e){e instanceof DOMException&&"AbortError"===e.name?t.dispatch({type:"appAbortedResolverDataRequest",payload:i}):t.dispatch({type:"serverFailedToReturnResolverData",payload:i})}}}}(e,t),i=function(e,t){let a;return async()=>{const n=t.getState(),i=l.z(n),s=l.o(n),r=l.f(n),o=a,c=void 0!==l.e(n)?void 0:l.K(n);async function u({nodeID:a,eventCategory:n,cursor:i}){let s=null;try{s=i?await e.eventsWithEntityIDAndCategory({entityID:a,category:n,after:i,indexPatterns:r,timeRange:c}):await e.eventsWithEntityIDAndCategory({entityID:a,category:n,indexPatterns:r,timeRange:c})}catch(e){t.dispatch({type:"serverFailedToReturnNodeEventsInCategory",payload:{nodeID:a,eventCategory:n,cursor:i}})}s&&t.dispatch({type:"serverReturnedNodeEventsInCategory",payload:{events:s.events,eventCategory:n,cursor:s.nextEvent,nodeID:a}})}if(a=i,Object(S.isEqual)(i,o)){if(s){const e=n.data.nodeEventsInCategory;void 0!==e&&await u(e)}}else if("nodeEventsInCategory"===i.panelView){const e=i.panelParameters.nodeID;t.dispatch({type:"appRequestedNodeEventsInCategory",payload:{parameters:i}}),await u({nodeID:e,eventCategory:i.panelParameters.eventCategory,cursor:null})}}}(e,t),s=function(e,t){let a;return async()=>{const n=t.getState(),i=l.z(n),s=l.f(n),r=a;if(a=i,!Object(S.isEqual)(i,r)&&"eventDetail"===i.panelView){const a=i.panelParameters.eventID,r=i.panelParameters.nodeID,o=i.panelParameters.eventCategory,c=i.panelParameters.eventTimestamp,u=i.panelParameters.winlogRecordID;t.dispatch({type:"appRequestedCurrentRelatedEventData"});const d=void 0!==l.e(n)?void 0:l.K(n);let p=null;try{p=await e.event({nodeID:r,eventCategory:[o],eventTimestamp:c,eventID:a,winlogRecordID:u,indexPatterns:s,timeRange:d})}catch(e){t.dispatch({type:"serverFailedToReturnCurrentRelatedEventData"})}p?t.dispatch({type:"serverReturnedCurrentRelatedEventData",payload:p}):t.dispatch({type:"serverFailedToReturnCurrentRelatedEventData"})}}}(e,t),r=function(e,t){return async()=>{const a=t.getState(),n=l.t(a)(Number.POSITIVE_INFINITY),i=l.f(a);if(n.size<=0)return;let s;t.dispatch({type:"appRequestingNodeData",payload:{requestedIDs:n}});try{const t=void 0!==l.e(a)?void 0:l.K(a);s=await e.nodeData({ids:Array.from(n),timeRange:t,indexPatterns:i,limit:5e3})}catch(e){t.dispatch({type:"serverFailedToReturnNodeData",payload:{requestedIDs:n}})}s&&t.dispatch({type:"serverReturnedNodeData",payload:{nodeData:s,requestedIDs:n,numberOfRequestedEvents:5e3}})}}(e,t);return async e=>{a(e),n(),i(),r(),s()}})(e));return Object(n.createStore)(E,t(a))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(4),i=a.n(n),s=a(22),r=a(311),o=a(340),l=a(47),c=a(239),u=a(35),d=a(220),p=a(7),m=a(3),g=a(422);const f=e=>Object(m.isObject)(e)?JSON.stringify(e):e;var b=a(81);const h=[({data:e,pageSize:t})=>e&&e.length>0?function({rowIndex:a,columnId:l,Component:c}){const{timelines:u,filterManager:d}=Object(o.d)(),p=Object(s.getPageRowIndex)(a,t),m=Object(n.useMemo)((()=>({data:e[p],fieldName:l})),[p,l]),g=Object(r.c)(m),f=Object(n.useMemo)((()=>u.getHoverActions().getFilterForValueButton),[u]),b=Object(n.useMemo)((()=>({Component:c,field:l,filterManager:d,onFilterAdded:o.c,ownFocus:!1,showTooltip:!1,value:g})),[c,l,d,g]);return p>=e.length?i.a.createElement(i.a.Fragment,null,o.a):i.a.createElement(i.a.Fragment,null,f(b))}:o.a,({data:e,pageSize:t})=>e&&e.length>0?function({rowIndex:a,columnId:l,Component:c}){const{timelines:u,filterManager:d}=Object(o.d)(),p=Object(s.getPageRowIndex)(a,t),m=Object(n.useMemo)((()=>({data:e[p],fieldName:l})),[p,l]),g=Object(r.c)(m),f=Object(n.useMemo)((()=>u.getHoverActions().getFilterOutValueButton),[u]),b=Object(n.useMemo)((()=>({Component:c,field:l,filterManager:d,onFilterAdded:o.c,ownFocus:!1,showTooltip:!1,value:g})),[c,l,d,g]);return p>=e.length?i.a.createElement(i.a.Fragment,null,o.a):i.a.createElement(i.a.Fragment,null,f(b))}:o.a,({data:e,pageSize:t})=>e&&e.length>0?function({rowIndex:a,columnId:m,Component:g}){const f=Object(l.useDispatch)(),{timelines:b}=Object(o.d)(),h=Object(s.getPageRowIndex)(a,t),y=Object(n.useMemo)((()=>({data:e[h],fieldName:m})),[h,m]),E=Object(r.c)(y),v=Object(n.useMemo)((()=>b.getHoverActions().getAddToTimelineButton),[b]),k=Object(n.useMemo)((()=>{const e=`${Object(d.h)(m)}-row-${a}-col-${m}`;return E?E.map((t=>({and:[],enabled:!0,excluded:!1,kqlQuery:"",id:`${e}-val-${t}`,name:t,queryMatch:{field:m,value:t,operator:u.c}}))):[{and:[],enabled:!0,kqlQuery:"",id:`${e}`,name:"",excluded:!0,queryMatch:{field:m,value:"",operator:u.b}}]}),[m,a,E]),S=Object(n.useCallback)((()=>{f(Object(p.addProvider)({id:c.c.active,providers:k}))}),[k,f]),T=Object(n.useMemo)((()=>({Component:g,dataProvider:k,field:m,ownFocus:!1,showTooltip:!1,onClick:S})),[g,m,k,S]);return h>=e.length?i.a.createElement(i.a.Fragment,null,o.a):i.a.createElement(i.a.Fragment,null,v(T))}:o.a,({data:e,pageSize:t})=>e&&e.length>0?function({rowIndex:a,columnId:l,Component:c}){const{timelines:u}=Object(o.d)(),d=Object(s.getPageRowIndex)(a,t),p=Object(n.useMemo)((()=>u.getHoverActions().getCopyButton),[u]),m=Object(n.useMemo)((()=>({data:e[d],fieldName:l})),[d,l]),g=Object(r.c)(m),f=Object(n.useMemo)((()=>({Component:c,field:l,isHoverAction:!1,ownFocus:!1,showTooltip:!1,value:g})),[c,l,g]);return d>=e.length?i.a.createElement(i.a.Fragment,null,o.a):i.a.createElement(i.a.Fragment,null,p(f))}:o.a,({data:e,ecsData:t,header:a,timelineId:l,pageSize:c,closeCellPopover:u})=>void 0!==a?function({rowIndex:d,columnId:p,Component:h}){var y;const{pageRowIndex:E,link:v,eventId:k,value:S,values:T,title:x,fieldName:w,fieldFormat:O,fieldType:j,linkValue:I}=(({rowIndex:e,pageSize:t,ecsData:a,columnId:i,header:l,data:c})=>{const u=Object(s.getPageRowIndex)(e,t),d=a[u],p=Object(o.b)(i,null==l?void 0:l.type,null==l?void 0:l.linkField),g=null!=l&&l.linkField?null==l?void 0:l.linkField:null==p?void 0:p.linkField,h=l&&Object(m.getOr)([],null!=g?g:"",d),y=l&&Object(m.get)("_id",d)||"",E=Object(n.useMemo)((()=>({data:c[u],fieldName:i})),[u,i,c]),v=Object(r.c)(E),k=f(Object(m.head)(v)),S=v&&v.length>1?`${null==p?void 0:p.label}: ${k}`:null==p?void 0:p.label;if(void 0!==g&&0===h.length&&void 0!==v){const e=Object(b.a)(d,g),t=Object(b.b)(d,g),a=Object(b.b)(d,i),n=Object(o.b)(a,null==l?void 0:l.type,t);return{pageRowIndex:u,link:n,eventId:y,fieldFormat:(null==l?void 0:l.format)||"",fieldName:a,fieldType:(null==l?void 0:l.type)||"",value:f(Object(m.head)(a)),values:v,title:S,linkValue:Object(m.head)(e)}}return{pageRowIndex:u,link:p,eventId:y,fieldFormat:(null==l?void 0:l.format)||"",fieldName:i,fieldType:(null==l?void 0:l.type)||"",value:k,values:v,title:S,linkValue:Object(m.head)(h)}})({rowIndex:d,pageSize:c,ecsData:t,columnId:p,header:a,data:e});return!1===Object(n.useMemo)((()=>{const t=void 0!==v&&T&&!Object(m.isEmpty)(S);return E>=e.length||!0!==t}),[v,E,S,T])?i.a.createElement(g.a,{Component:h,contextId:`expanded-value-${p}-row-${E}-${l}`,eventId:k,fieldFormat:O,isAggregatable:null!==(y=a.aggregatable)&&void 0!==y&&y,fieldName:w,fieldType:j,isButton:!0,isDraggable:!1,value:S,truncate:!1,title:x,linkValue:I,onClick:u}):o.a}:o.a]},function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return g})),a.d(t,"a",(function(){return d}));var n=a(317),i=a(332),s=a(447),r=a(428);const o=e=>{const t={coreStart:e};return e=>a=>async o=>{a(o),(async({coreStart:e},{dispatch:t,getState:a},o)=>{const l=e.http,c=a();if("userChangedUrl"===o.type&&Object(i.i)(c)&&Object(i.g)(c)){const e=Object(i.m)(c);let a;try{a=(await Object(s.g)(l,e)).item,""===a.inputs[0].config.policy.value.windows.popup.malware.message&&(a.inputs[0].config.policy.value.windows.popup.malware.message=n.a,a.inputs[0].config.policy.value.mac.popup.malware.message=n.a,a.inputs[0].config.policy.value.linux.popup.malware.message=n.a),""===a.inputs[0].config.policy.value.windows.popup.ransomware.message&&(a.inputs[0].config.policy.value.windows.popup.ransomware.message=n.a),""===a.inputs[0].config.policy.value.windows.popup.memory_protection.message&&(a.inputs[0].config.policy.value.windows.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.mac.popup.memory_protection.message&&(a.inputs[0].config.policy.value.mac.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.linux.popup.memory_protection.message&&(a.inputs[0].config.policy.value.linux.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.windows.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.windows.popup.behavior_protection.message=n.b),""===a.inputs[0].config.policy.value.mac.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.mac.popup.behavior_protection.message=n.b),""===a.inputs[0].config.policy.value.linux.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.linux.popup.behavior_protection.message=n.b)}catch(e){return void t({type:"serverFailedToReturnPolicyDetailsData",payload:e.body||e})}if(t({type:"serverReturnedPolicyDetailsData",payload:{policyItem:a}}),a.policy_id){const{results:e}=await Object(s.e)(l,a.policy_id);t({type:"serverReturnedPolicyDetailsAgentSummaryData",payload:{agentStatusSummary:e}})}}else if("userClickedPolicyDetailsSaveButton"===o.type){const{id:e}=Object(i.k)(c),a=Object(i.l)(c);let n;try{n=await Object(s.h)(l,e,a).catch((t=>t.response&&409===t.response.status?Object(s.g)(l,e).then((t=>{const n=t.item;return n.inputs[0].config.policy=a.inputs[0].config.policy,Object(s.h)(l,e,Object(r.a)(n))})):Promise.reject(t)))}catch(e){return void t({type:"serverReturnedPolicyDetailsUpdateFailure",payload:{success:!1,error:e.body||e}})}t({type:"serverReturnedUpdatedPolicyDetailsData",payload:{policyItem:n.item,updateStatus:{success:!0}}})}})(t,e,o)}};var l=a(369),c=a(234),u=a(209);const d=()=>({policyItem:void 0,isLoading:!1,agentStatusSummary:{error:0,events:0,offline:0,online:0,total:0,other:0},artifacts:{location:{page:u.b,pageSize:u.c,show:void 0,filter:""}}}),p=(e,t)=>({...e,inputs:e.inputs.map((e=>({...e,config:e.config&&{...e.config,policy:{...e.config.policy,value:t}}})))}),m=(e=d(),t)=>{if("serverReturnedPolicyDetailsData"===t.type||"serverReturnedUpdatedPolicyDetailsData"===t.type)return{...e,...t.payload,isLoading:!1};if("serverFailedToReturnPolicyDetailsData"===t.type)return{...e,isLoading:!1,apiError:t.payload};if("serverReturnedPolicyDetailsAgentSummaryData"===t.type)return{...e,...t.payload};if("serverReturnedPolicyDetailsUpdateFailure"===t.type)return{...e,isLoading:!1,updateStatus:t.payload};if("userClickedPolicyDetailsSaveButton"===t.type)return{...e,isLoading:!0,updateApiError:void 0};if("licenseChanged"===t.type)return{...e,license:t.payload};if("userChangedUrl"===t.type){const a={...e,location:t.payload,artifacts:{...e.artifacts,location:Object(c.b)(Object(l.parse)(t.payload.search.slice(1)))}},n=Object(i.g)(a),s=Object(i.g)(e),r=Object(i.h)(a);return n?s?a:{...a,isLoading:!0}:{...d(),location:t.payload,license:r}}if("userChangedPolicyConfig"===t.type){if(!e.policyItem)return e;const a={...e,policyItem:{...e.policyItem}},n={...Object(i.c)(e)};return a.policyItem.inputs[0].config.policy.value=n,Object.entries(t.payload.policyConfig).forEach((([e,t])=>{n[e]={...n[e],...t}})),a}if("userChangedAntivirusRegistration"===t.type){if(e.policyItem){const a=Object(i.c)(e);return{...e,policyItem:p(e.policyItem,{...a,windows:{...a.windows,antivirus_registration:{enabled:t.payload.enabled}}})}}return e}if("userChangedCredentialHardening"===t.type){if(e.policyItem){const a=Object(i.c)(e);return{...e,policyItem:p(e.policyItem,{...a,windows:{...a.windows,attack_surface_reduction:{credential_hardening:{enabled:t.payload.enabled}}}})}}return e}return e},g=(e=d(),t)=>[m].reduce(((e,a)=>a(e,t)),e)},function(e,t,a){"use strict";a.d(t,"a",(function(){return P}));var n=a(4),i=a.n(n),s=a(17),r=a(185),o=a(1),l=a(438),c=a(371),u=a(208),d=a(297),p=a(216),m=a(322),g=a(227),f=a(313),b=a(204),h=a(645);const y=i.a.memo((({allItems:e,selectedItems:t,title:a,onSelectedItemsChange:r})=>{const[o,l]=Object(n.useState)(!1),c=Object(n.useCallback)((e=>r(E(e,t))),[t,r]),u=Object(n.useMemo)((()=>e.map(((e,a)=>i.a.createElement(s.EuiFilterSelectItem,{checked:t.includes(e)?"on":void 0,key:`${a}-${e}`,onClick:()=>c(e),title:e},e)))),[e,t,c]),d=Object(n.useCallback)((e=>{l((t=>e||!t))}),[l]);return i.a.createElement(s.EuiPopover,{ownFocus:!0,button:i.a.createElement(s.EuiFilterGroup,null,i.a.createElement(s.EuiFilterButton,{grow:!1,"data-test-subj":"multiselect-popover-button",iconType:"arrowDown",onClick:()=>d(),numFilters:e.length,isSelected:o,hasActiveFilters:t.length>0,numActiveFilters:t.length},a)),isOpen:o,closePopover:()=>d(!1),panelPaddingSize:"none"},u)}));y.displayName="MultiSelectPopover";const E=(e,t)=>{const a=t.indexOf(e),n=[...t];return a>=0?n.splice(a,1):n.push(e),n};var v=a(6);const k=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.status",{defaultMessage:"Status"}),S=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.alertsByRule",{defaultMessage:"Alerts by Rule"}),T=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.ruleName",{defaultMessage:"kibana.alert.rule.name"}),x=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.count",{defaultMessage:"count"}),w=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.tooltipTitle",{defaultMessage:"Rule name"}),O=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.noRuleAlerts",{defaultMessage:"No alerts to display"});var j=a(290),I=a(289),C=a(213),M=a(221);const D="alertsByRuleAggregation",A=({additionalFilters:e=[],from:t,to:a,field:n,value:i,statuses:s})=>({size:0,query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:a}}},{terms:{"kibana.alert.workflow_status":s}},{term:{[n]:i}}]}},aggs:{[D]:{terms:{field:"kibana.alert.rule.name",size:100},aggs:{ruleUuid:{top_hits:{_source:["kibana.alert.rule.uuid"],size:1}}}}}}),F=["open","acknowledged","closed"],R=Object(r.euiStyled)(s.EuiPanel)`
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
  max-height: 308px;
`,P=i.a.memo((({entityFilter:e,signalIndexName:t,additionalFilters:a})=>{const{field:r,value:o}=e,d=`alerts-by-status-by-rule-by-${r}`,{toggleStatus:b,setToggleStatus:E}=Object(u.a)(d),{openTimelineWithFilters:v}=Object(l.a)(),[T,x]=Object(h.a)({defaultValue:{[r]:["open"]},key:"alertCountByFieldNameWidgetSettings",isInvalidDefault:e=>!e}),w=Object(n.useMemo)((()=>_((t=>{const a=[];for(const n of T[r])a.push([e,{field:c.l,value:t},{field:c.m,value:n}]);v(a)}))),[e,r,v,T]),P=Object(n.useCallback)((e=>{x({...T,[r]:e})}),[r,T,x]),{items:q,isLoading:N,updatedAt:L}=(({additionalFilters:e,field:t,value:a,queryId:i,statuses:s,skip:r=!1,signalIndexName:o})=>{const[l,c]=Object(n.useState)(Date.now()),[u,d]=Object(n.useState)([]),{to:p,from:m,deleteQuery:g,setQuery:f}=Object(C.a)(),{loading:b,data:h,setQuery:y,response:E,request:v,refetch:k}=Object(I.a)({query:A({additionalFilters:e,from:m,to:p,field:t,value:a,statuses:s}),skip:r,queryName:j.a.ALERTS_COUNT_BY_STATUS,indexName:o});Object(n.useEffect)((()=>{y(A({additionalFilters:e,from:m,to:p,field:t,value:a,statuses:s}))}),[y,m,p,t,a,s,e]),Object(n.useEffect)((()=>{var e,t;d(h?(e=h.aggregations,(null!==(t=null==e?void 0:e[D].buckets)&&void 0!==t?t:[]).map((e=>{var t,a;const n=(null===(t=e.ruleUuid.hits)||void 0===t||null===(a=t.hits[0])||void 0===a?void 0:a._source["kibana.alert.rule.uuid"])||"";return{ruleName:e.key,count:e.doc_count,uuid:n}}))):[]),c(Date.now())}),[h]);const S=Object(n.useCallback)((()=>{!r&&k&&k()}),[r,k]);return Object(M.b)({deleteQuery:g,inspect:{dsl:[v],response:[E]},refetch:S,setQuery:f,queryId:i,loading:b}),{items:u,isLoading:b,updatedAt:l}})({additionalFilters:a,field:r,value:o,queryId:d,statuses:T[r],skip:!b,signalIndexName:t});return i.a.createElement(m.a,{show:!0,targetClassNames:[g.a]},i.a.createElement(R,{hasBorder:!0,"data-test-subj":"alertCountByRulePanel"},i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{id:d,title:S,titleSize:"m",toggleStatus:b,toggleQuery:E,subtitle:i.a.createElement(f.a,{updatedAt:L,isUpdating:N})},i.a.createElement(y,{title:k,allItems:F,selectedItems:T[r]||["open"],onSelectedItemsChange:e=>P(e)})),b&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiBasicTable,{className:"eui-yScroll","data-test-subj":"alertCountByRuleTable",columns:w,items:q,loading:N,noItemsMessage:i.a.createElement(s.EuiEmptyPrompt,{title:i.a.createElement("h3",null,O),titleSize:"xs"})})))))}));P.displayName="AlertCountByStatus";const _=e=>[{field:"ruleName",name:T,"data-test-subj":T,align:"left",width:"67%",sortable:!1,render:(e,{uuid:t})=>i.a.createElement(s.EuiToolTip,{"data-test-subj":`${e}-tooltip`,title:w,content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(b.k,{"data-test-subj":"severityRuleAlertsTable-name",deepLinkId:o.uc.rules,path:`id/${t}`},e))},{field:"count",name:x,width:"33%","data-test-subj":x,sortable:!0,align:"right",render:(t,{ruleName:a})=>i.a.createElement(s.EuiLink,{disabled:0===t,onClick:()=>e(a)},i.a.createElement(d.a,{count:t}))}]},function(e,t,a){"use strict";a.d(t,"a",(function(){return R}));var n=a(4),i=a.n(n),s=a(47),r=a(17),o=a(365),l=a(216),c=a(254),u=a(324);const d=["source.ip","destination.ip"],p=e=>null!=e&&d.includes(e);var m=a(387);const g=(e,t)=>!!p(e.entityName)&&(null==t||e.entityValue===t);var f=a(249),b=a(273),h=a(467),y=a(204),E=a(294),v=a(626);var k=a(224),S=a(553),T=a(77);const x=(e,t,a)=>e===E.NetworkType.details&&null!=t?a===T.f.source?[{fieldName:"source.ip",fieldValue:t}]:a===T.f.destination?[{fieldName:"destination.ip",fieldValue:t}]:[]:[];var w=a(348),O=a(208),j=a(286),I=a(76),C=a(554),M=a(214),D=a(555);const A={sort:{field:"anomaly.severity",direction:"desc"}},F=({startDate:e,endDate:t,skip:a,ip:d,type:T,flowTarget:F})=>{const R=Object(k.a)(),P=Object(s.useDispatch)(),{toggleStatus:_,setToggleStatus:q}=Object(O.a)(`AnomaliesNetwork-${F}`),[N,L]=Object(n.useState)(a||!_);Object(n.useEffect)((()=>{L(a||!_)}),[a,_]);const B=Object(n.useCallback)((e=>{q(e),L(!e)}),[L,q]),{jobIds:z,loading:H}=Object(j.b)(),$=Object(n.useMemo)((()=>M.e.networkAnomaliesJobIdFilterSelector()),[]),V=Object(I.a)((e=>$(e,T))),U=Object(n.useCallback)((e=>{P(M.b.updateNetworkAnomaliesJobIdFilter({jobIds:e,networkType:T}))}),[P,T]),Q=Object(n.useMemo)((()=>M.e.networkAnomaliesIntervalSelector()),[]),W=Object(I.a)((e=>Q(e,T))),G=Object(n.useCallback)((e=>{P(M.b.updateNetworkAnomaliesInterval({interval:e,networkType:T}))}),[P,T]),[K,J]=Object(o.a)({startDate:e,endDate:t,skip:N,criteriaFields:x(T,d,F),jobIds:V.length>0?V:z,aggregationInterval:W}),Y=((e,t)=>null==e?[]:e.anomalies.reduce(((e,a)=>{if(p(a.entityName)&&g(a,t))return[...e,{ip:a.entityValue,type:a.entityName,anomaly:a}];{const n=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(m.a)(e);return!!p(a)&&(null==t||n===t)}));if(null!=a){const[e]=Object(m.a)(a);return p(e)?{ip:Object.values(a)[0],type:e}:{ip:Object.values(a)[0],type:"destination.ip"}}return null})(a.influencers,t);return null!=n?[...e,{ip:n.ip,type:n.type,anomaly:a}]:e}}),[]))(J,d),X=((e,t,a,n)=>{const s=((e,t,a)=>[{name:u.m,field:"ip",sortable:!0,render:(e,t)=>Object(b.b)({rowItem:e,attrName:t.type,idPrefix:`anomalies-network-table-ip-${Object(h.a)(t.anomaly)}`,render:e=>i.a.createElement(y.h,{ip:e,flowTarget:a}),isAggregatable:!0,fieldType:"ip"})},...Object(v.a)(e,t)])(t,a,n);return e===E.NetworkType.details?s.filter((e=>e.name!==u.m)):s})(T,e,t,F),Z={initialPageIndex:0,initialPageSize:10,totalItemCount:Y.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(c.a)(R)?i.a.createElement(w.a,{loading:K||H},i.a.createElement(l.a,{subtitle:`${u.o}: ${Z.totalItemCount.toLocaleString()} ${u.r(Z.totalItemCount)}`,title:u.a,tooltip:u.q,toggleQuery:B,toggleStatus:_,isInspectDisabled:a,headerFilters:i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(r.EuiFlexItem,null,i.a.createElement(D.a,{interval:W,onChange:G})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(C.a,{title:u.l,onSelect:U,selectedJobIds:V,jobIds:z})))}),_&&i.a.createElement(S.a,{"data-test-subj":"network-anomalies-table",columns:X,items:Y,pagination:Z,sorting:A}),(K||H)&&i.a.createElement(f.a,{"data-test-subj":"anomalies-network-table-loading-panel",overlay:!0,size:"xl"})):null},R=i.a.memo(F)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var n=a(4),i=a.n(n),s=a(47),r=a(461),o=a(76),l=a(19),c=a(78),u=a(7),d=a(80),p=a(36),m=a(17),g=a(24),f=a.n(g),b=a(6);const h=b.i18n.translate("xpack.securitySolution.fieldBrowser.createFieldButton",{defaultMessage:"Create field"}),y=f()(m.EuiButton).withConfig({displayName:"StyledButton",componentId:"sc-pj2czg-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),E=b.i18n.translate("xpack.securitySolution.fieldBrowser.fieldName",{defaultMessage:"Name"}),v=b.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionLabel",{defaultMessage:"Description"}),k=b.i18n.translate("xpack.securitySolution.fieldBrowser.categoryLabel",{defaultMessage:"Category"}),S=b.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeLabel",{defaultMessage:"Runtime"}),T=b.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeTitle",{defaultMessage:"Runtime Field"}),x=b.i18n.translate("xpack.securitySolution.fieldBrowser.actionsLabel",{defaultMessage:"Actions"}),w=b.i18n.translate("xpack.securitySolution.fieldBrowser.editButton",{defaultMessage:"Edit"}),O=b.i18n.translate("xpack.securitySolution.fieldBrowser.removeButton",{defaultMessage:"Remove"}),j=b.i18n.translate("xpack.securitySolution.fieldBrowser.editButtonDescription",{defaultMessage:"Edit runtime field"}),I=b.i18n.translate("xpack.securitySolution.fieldBrowser.removeButtonDescription",{defaultMessage:"Delete runtime field"});var C=a(352),M=a(203),D=a(366);const A=f()(m.EuiIcon).withConfig({displayName:"TypeIcon",componentId:"sc-bemp51-0"})(["margin:0 4px;position:relative;top:-1px;"]);A.displayName="TypeIcon";const F=f.a.span.withConfig({displayName:"Description",componentId:"sc-bemp51-1"})(["user-select:text;width:",";"],(({width:e})=>e));F.displayName="Description";const R=i.a.memo((({fieldId:e,highlight:t=""})=>i.a.createElement(m.EuiText,{size:"xs"},i.a.createElement(m.EuiHighlight,{"data-test-subj":`field-${e}-name`,search:t},e))));R.displayName="FieldName";const P=({hasFieldEditPermission:e,openFieldEditor:t,openDeleteFieldModal:a})=>Object(n.useCallback)((({highlight:n,onHide:s})=>{const r=e?[{name:w,description:j,type:"icon",icon:"pencil",isPrimary:!0,onClick:({name:e})=>{t(e),s()},available:({isRuntime:e})=>e,"data-test-subj":"actionEditRuntimeField"},{name:O,description:I,type:"icon",icon:"trash",color:"danger",isPrimary:!0,onClick:({name:e})=>{a(e),s()},available:({isRuntime:e})=>e,"data-test-subj":"actionDeleteRuntimeField"}]:[];return[{field:"name",name:E,render:(e,{type:t})=>i.a.createElement(m.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(m.EuiFlexItem,{grow:!1},i.a.createElement(m.EuiToolTip,{content:t},i.a.createElement(A,{"data-test-subj":`field-${e}-icon`,type:Object(C.d)(null!=t?t:null)}))),i.a.createElement(m.EuiFlexItem,{grow:!1},i.a.createElement(R,{fieldId:e,highlight:n}))),sortable:!0,width:"225px"},{field:"description",name:v,render:(e,{name:t,example:a})=>{return i.a.createElement(m.EuiToolTip,{content:e},i.a.createElement(i.a.Fragment,null,i.a.createElement(m.EuiScreenReaderOnly,{"data-test-subj":"descriptionForScreenReaderOnly"},i.a.createElement("p",null,(n=t,b.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionForScreenReaderOnly",{values:{field:n},defaultMessage:"Description for field {field}:"})))),i.a.createElement(D.a,null,i.a.createElement(F,{width:r.length>0?"335px":"400px","data-test-subj":`field-${t}-description`},`${null!=e?e:Object(M.e)()} ${Object(C.c)(a)}`))));var n},sortable:!0,width:r.length>0?"335px":"400px"},{field:"isRuntime",name:S,render:e=>e?i.a.createElement(m.EuiHealth,{color:"success",title:T}):null,sortable:!0,width:"80px"},{field:"category",name:k,render:(e,{name:t})=>i.a.createElement(m.EuiBadge,{"data-test-subj":`field-${t}-category`},e),sortable:!0,width:"115px"},...r.length>0?[{name:x,actions:r,width:"80px"}]:[]]}),[e,t,a]);var _=a(258),q=a(267);const N=({sourcererScope:e,timelineId:t,editorActionsRef:a})=>{const m=Object(s.useDispatch)(),[g,f]=Object(n.useState)(null),{startTransaction:b}=Object(_.a)(),{indexFieldsSearch:E}=Object(r.b)(),{dataViewFieldEditor:v,data:{dataViews:k}}=Object(l.k)().services,S=Object(n.useMemo)((()=>c.g.scopeIdSelector()),[]),{missingPatterns:T,selectedDataViewId:x}=Object(o.a)((t=>S(t,e)));Object(n.useEffect)((()=>{null==x||T.length||k.get(x).then((e=>{f(e)}))}),[x,T,k]);const w=Object(n.useCallback)((e=>{if(g&&x){const n=v.openEditor({ctx:{dataView:g},fieldName:e,onSave:async n=>{b({name:q.c.FIELD_SAVED}),await E({dataViewId:x,cleanCache:!0});for(const a of n)e&&e!==a.name&&m(Object(u.removeColumn)({columnId:e,id:t})),m(Object(u.upsertColumn)({column:{columnHeaderType:d.a,id:a.name,initialWidth:p.a},id:t,index:0}));a&&(a.current=null)}});a&&(a.current={closeEditor:()=>{a.current=null,n()}})}}),[g,x,v,a,E,m,t,b]),O=Object(n.useCallback)((e=>{g&&x&&v.openDeleteModal({ctx:{dataView:g},fieldName:e,onDelete:async()=>{b({name:q.c.FIELD_DELETED}),await E({dataViewId:x}),m(Object(u.removeColumn)({columnId:e,id:t}))}})}),[g,x,v,E,m,t,b]),j=Object(n.useMemo)((()=>null==v?void 0:v.userPermissions.editIndexPattern()),[null==v?void 0:v.userPermissions]),I=(({isAllowed:e,loading:t,openFieldEditor:a})=>{const s=Object(n.useCallback)((({onHide:e})=>i.a.createElement(y,{iconType:t?"none":"plusInCircle","aria-label":h,"data-test-subj":"create-field",onClick:()=>{a(),e()},isLoading:t},h)),[t,a]);return e?s:void 0})({isAllowed:j&&!!x,loading:!g,openFieldEditor:w});return{createFieldButton:I,getFieldTableColumns:P({hasFieldEditPermission:j,openFieldEditor:w,openDeleteFieldModal:O})}}},,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return D})),a.d(t,"a",(function(){return A}));var n=a(4),i=a.n(n),s=a(17),r=a(47),o=a(24),l=a.n(o),c=a(91),u=a(19),d=a(15),p=a(94),m=a(76),g=a(207),f=a(84),b=a(418),h=a(13),y=a(497),E=a(1),v=a(372),k=a(575),S=a(96),T=a(7),x=a(659),w=a(6);const O=w.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeAnalyzerButton",{defaultMessage:"Close analyzer"}),j=w.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeSessionButton",{defaultMessage:"Close session viewer"}),I=l()(s.EuiButtonIcon).withConfig({displayName:"FullScreenButtonIcon",componentId:"sc-2qihun-0"})(["margin:4px 0 4px 0;"]),C=({fullScreen:e,globalFullScreen:t,onCloseOverlay:a,timelineId:n,timelineFullScreen:r,toggleFullScreen:o,graphEventId:l,activeTab:c})=>i.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButtonEmpty,{iconType:"cross",onClick:a,size:"xs"},n===d.i.active?c===d.l.graph?O:j:l?O:j)),n!==d.i.active&&i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiToolTip,{content:e?k.a:v.d},i.a.createElement(I,{"aria-label":Object(y.b)({globalFullScreen:t,timelineId:n,timelineFullScreen:r})?k.a:v.d,className:e?E.Ib:"",color:e?"ghost":"primary","data-test-subj":"full-screen",iconType:"fullScreen",onClick:o}))));C.displayName="NavigationComponent";const M=i.a.memo(C),D=({timelineId:e})=>{const t=Object(r.useDispatch)(),a=Object(n.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),{globalFullScreen:s,setGlobalFullScreen:o}=Object(S.a)(),{timelineFullScreen:l,setTimelineFullScreen:u}=Object(S.c)(),{graphEventId:g,sessionViewConfig:f,activeTab:b,prevActiveTab:h}=Object(m.a)((t=>{var n;return null!==(n=a(t,e))&&void 0!==n?n:p.a})),v=Object(n.useCallback)((()=>{null!==document.querySelector(".euiDataGrid--fullScreen")?e===d.i.active?document.body.classList.add("euiDataGrid__restrictBody"):document.body.classList.add(E.pc,"euiDataGrid__restrictBody"):e===d.i.active?u(!1):o(!1),e!==d.i.active?(t(Object(T.updateTimelineGraphEventId)({id:e,graphEventId:""})),t(Object(T.updateTimelineSessionViewConfig)({id:e,sessionViewConfig:null}))):b===d.l.graph?(t(Object(T.updateTimelineGraphEventId)({id:e,graphEventId:""})),h!==d.l.session||f||t(Object(T.setActiveTabTimeline)({id:e,activeTab:d.l.query}))):b===d.l.session&&(t(Object(T.updateTimelineSessionViewConfig)({id:e,sessionViewConfig:null})),h!==d.l.graph||g?t(Object(T.setActiveTabTimeline)({id:e,activeTab:h})):t(Object(T.setActiveTabTimeline)({id:e,activeTab:d.l.query})))}),[t,e,u,o,b,h,g,f]),k=Object(n.useMemo)((()=>Object(y.b)({globalFullScreen:s,timelineId:e,timelineFullScreen:l})),[s,e,l]),x=Object(n.useCallback)((()=>{e===d.i.active?u(!l):o(!s)}),[e,u,l,o,s]),w=Object(n.useMemo)((()=>i.a.createElement(M,{fullScreen:k,globalFullScreen:s,activeTab:b,onCloseOverlay:v,timelineId:e,timelineFullScreen:l,toggleFullScreen:x,graphEventId:g})),[k,s,b,g,v,l,e,x]);return{onCloseOverlay:v,Navigation:w}},A=({timelineId:e,entityType:t,height:a})=>{const{sessionView:s}=Object(u.k)().services,o=Object(n.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),{globalFullScreen:l}=Object(S.a)(),{timelineFullScreen:E}=Object(S.c)(),{sessionViewConfig:v,activeTab:k}=Object(m.a)((t=>{var a;return null!==(a=o(t,e))&&void 0!==a?a:p.a})),T=Object(n.useMemo)((()=>Object(y.b)({globalFullScreen:l,timelineId:e,timelineFullScreen:E})),[l,e,E]),w=Object(n.useMemo)((()=>e===d.i.active?h.SourcererScopeName.timeline:x.a.includes(e)?h.SourcererScopeName.detections:h.SourcererScopeName.default),[e]),{openDetailsPanel:O,shouldShowDetailsPanel:j,DetailsPanel:I}=(({entityType:e,isFlyoutView:t,sourcererScope:a,timelineId:s,tabType:o})=>{const{browserFields:l,selectedPatterns:u,runtimeMappings:h}=Object(g.d)(a),y=Object(n.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),E=Object(r.useDispatch)(),v=Object(m.a)((e=>{var t,a;return null===(t=null!==(a=y(e,s))&&void 0!==a?a:p.a)||void 0===t?void 0:t.expandedDetail})),k=Object(n.useRef)((()=>{})),S=Object(n.useMemo)((()=>{var e;return!!(o&&v&&v[o]&&null!==(e=v[o])&&void 0!==e&&e.panelView)}),[v,o]),T=Object(n.useCallback)((e=>{e&&E(c.a.toggleDetailPanel({panelView:"eventDetail",tabType:o,timelineId:s,params:{eventId:e,indexName:u.join(",")}}))}),[E,u,o,s]),x=Object(n.useCallback)(((e,t)=>{T(e),k.current=null!=t?t:()=>{}}),[T]),w=Object(n.useCallback)((()=>{var e;k.current&&k.current(),E(c.a.toggleDetailPanel({tabType:o,timelineId:s})),o&&null!==(e=v[o])&&void 0!==e&&e.panelView&&s===d.i.active&&S&&f.a.toggleExpandedDetail({})}),[E,s,v,o,S]),O=Object(n.useMemo)((()=>S?i.a.createElement(b.a,{browserFields:l,entityType:e,handleOnPanelClosed:w,isFlyoutView:t,runtimeMappings:h,tabType:o,timelineId:s}):null),[l,e,w,t,h,S,o,s]);return{openDetailsPanel:x,handleOnDetailsPanelClosed:w,shouldShowDetailsPanel:S,DetailsPanel:O}})({isFlyoutView:e!==d.i.active,entityType:t,sourcererScope:w,timelineId:e,tabType:e===d.i.active?k:d.l.query}),C=Object(n.useMemo)((()=>{const e=a?a-118:void 0;return null!==v?s.getSessionView({...v,loadAlertDetails:O,isFullScreen:T,height:e}):null}),[T,O,s,v,a]);return{openDetailsPanel:O,shouldShowDetailsPanel:j,SessionView:C,DetailsPanel:I}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(4),i=a.n(n),s=a(47),r=a(17),o=a(5),l=a(175),c=a(6),u=a(231),d=a(228);const p=[{key:"linux.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"linux.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.base_url",{defaultMessage:"Base URL from which to download global artifact manifests. Default: https://artifacts.security.elastic.co."})},{key:"linux.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"linux.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"linux.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"linux.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"linux.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"linux.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"linux.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"linux.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"linux.advanced.logging.file",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"linux.advanced.logging.syslog",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"linux.advanced.tty_io.max_kilobytes_per_process",first_supported_version:"8.5",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_kilobytes_per_process",{defaultMessage:"The maximum kilobytes of terminal output to record for a single process. Default: 512"})},{key:"linux.advanced.tty_io.max_kilobytes_per_event",first_supported_version:"8.5",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_kilobytes_per_event",{defaultMessage:"The maximum kilobytes of terminal output to record in a single event. Default: 512"})},{key:"linux.advanced.tty_io.max_event_interval_seconds",first_supported_version:"8.5",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_event_interval_seconds",{defaultMessage:"The maximum amount of time (seconds) to batch terminal output in a single event. Default: 30"})},{key:"mac.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"mac.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"mac.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"mac.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"mac.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"mac.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"mac.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"mac.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"mac.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"mac.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"mac.advanced.logging.file",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.logging.syslog",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.malware.quarantine",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"mac.advanced.malware.threshold",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"mac.advanced.kernel.connect",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"mac.advanced.kernel.process",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"mac.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"mac.advanced.kernel.network",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"mac.advanced.harden.self_protect",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.harden.self_protect",{defaultMessage:"Enables self-protection on macOS. Default: true."})},{key:"windows.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"windows.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"windows.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"windows.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"windows.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"windows.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"windows.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"windows.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"windows.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"windows.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"windows.advanced.logging.file",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.logging.debugview",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.debugview",{defaultMessage:"A supplied value will configure logging to Debugview (a Sysinternals tool). Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.malware.quarantine",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"windows.advanced.malware.threshold",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"windows.advanced.kernel.connect",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"windows.advanced.kernel.process",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"windows.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"windows.advanced.kernel.network",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"windows.advanced.kernel.fileopen",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.fileopen",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file open events. Default: true."})},{key:"windows.advanced.kernel.asyncimageload",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.asyncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel async image load events. Default: true."})},{key:"windows.advanced.kernel.syncimageload",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.syncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel sync image load events. Default: true."})},{key:"windows.advanced.kernel.registry",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.registry",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel registry events. Default: true."})},{key:"windows.advanced.kernel.fileaccess",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.fileaccess",{defaultMessage:"Report limited file access (read) events. Paths are not user-configurable. Default value is true."})},{key:"windows.advanced.kernel.registryaccess",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.registryaccess",{defaultMessage:"Report limited registry access (queryvalue, savekey) events. Paths are not user-configurable. Default value is true."})},{key:"windows.advanced.diagnostic.enabled",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"linux.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"mac.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"windows.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Windows alerts. Default: true."})},{key:"mac.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Mac alerts. Default: true."})},{key:"windows.advanced.ransomware.mbr",first_supported_version:"7.12",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.ransomware.mbr",{defaultMessage:"A value of 'false' disables Ransomware MBR protection. Default: true."})},{key:"windows.advanced.ransomware.canary",first_supported_version:"7.14",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.ransomware.canary",{defaultMessage:"A value of 'false' disables Ransomware canary protection. Default: true."})},{key:"windows.advanced.memory_protection.shellcode",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode",{defaultMessage:"Enable shellcode injection detection as a part of memory protection. Default: true."})},{key:"windows.advanced.memory_protection.memory_scan",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.malware.quarantine",first_supported_version:"7.14",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"windows.advanced.memory_protection.shellcode_collect_sample",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected shellcode regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"windows.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"windows.advanced.memory_protection.shellcode_enhanced_pe_parsing",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.memory_protection.shellcode_enhanced_pe_parsing",{defaultMessage:"Attempt to identify and extract PE metadata from injected shellcode, including Authenticode signatures and version resource information. Default: true."})},{key:"mac.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.16",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"mac.advanced.memory_protection.memory_scan",first_supported_version:"7.16",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.16",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"linux.advanced.memory_protection.memory_scan",first_supported_version:"7.16",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"windows.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"mac.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"windows.advanced.events.etw",first_supported_version:"8.1",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.etw",{defaultMessage:"Enable collection of ETW events. Default: true"})},{key:"windows.advanced.diagnostic.rollback_telemetry_enabled",first_supported_version:"8.1",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.diagnostic.rollback_telemetry_enabled",{defaultMessage:"Enable diagnostic rollback telemetry. Default: true"})},{key:"mac.advanced.kernel.network_extension.enable_content_filtering",first_supported_version:"8.1",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network_extension.enable_content_filtering",{defaultMessage:"Enable or disable the network content filter, this will enable/disable network eventing. Host isolation will fail if this option is disabled. Default: true"})},{key:"mac.advanced.kernel.network_extension.enable_packet_filtering",first_supported_version:"8.1",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network_extension.enable_packet_filtering",{defaultMessage:"Enable or disable the network packet filter. Host isolation will fail if this option is disabled. Default: true"})},{key:"windows.advanced.memory_protection.shellcode_trampoline_detection",first_supported_version:"8.1",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode_trampoline_detection",{defaultMessage:"Enable trampoline-based shellcode injection detection as a part of memory protection. Default: true"})},{key:"linux.advanced.kernel.capture_mode",first_supported_version:"8.2",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.kernel.capture_mode",{defaultMessage:"Allows users to control whether kprobes or ebpf are used to gather data. Options are kprobe, ebpf, or auto. Auto uses ebpf if possible, otherwise uses kprobe. Default: auto"})},{key:"linux.advanced.event_filter.default",first_supported_version:"8.3",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"mac.advanced.event_filter.default",first_supported_version:"8.3",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"windows.advanced.event_filter.default",first_supported_version:"8.3",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"windows.advanced.utilization_limits.cpu",first_supported_version:"8.3",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.utilization_limits.cpu",{defaultMessage:"The percentage of the aggregate system CPU to restrict Endpoint to. The range is 20-100%. Anything under 20 gets ignored and causes a policy warning.  Default: 100"})},{key:"linux.advanced.utilization_limits.cpu",first_supported_version:"8.3",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.utilization_limits.cpu",{defaultMessage:"The percentage of the aggregate system CPU to restrict Endpoint to. The range is 20-100%. Anything under 20 gets ignored and causes a policy warning.  Default: 50"})},{key:"windows.advanced.alerts.rollback.self_healing.enabled",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.rollback.self_healing.enabled",{defaultMessage:"Self-healing erases attack artifacts when prevention alerts are triggered. Warning: data loss can occur. Default: false"}),license:"platinum"},{key:"linux.advanced.fanotify.ignore_unknown_filesystems",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.ignore_unknown_filesystems",{defaultMessage:'Whether fanotify should ignore unknown filesystems. When true, only CI tested filesystems will be marked by default; additional filesystems can be added or removed with "monitored_filesystems" and "ignored_filesystems", respectively. When false, only an internally curated list of filesystems will be ignored, all others will be marked; additional filesystems can be ignored via "ignored_filesystems". "monitored_filesystems" is ignored when "ignore_unknown_filesystems" is false. Default: true'})},{key:"linux.advanced.fanotify.monitored_filesystems",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.monitored_filesystems",{defaultMessage:'Additional filesystems for fanotify to monitor. The format is a comma separated list of filesystem names as they appear in "/proc/filesystems", e.g. "jfs,ufs,ramfs". It is recommended to avoid network-backed filesystems. When "ignore_unknown_filesystems" is false, this option is ignored. When "ignore_unknown_filesystems" is true, parsed entries of this option are monitored by fanotify unless overridden by entries in "ignored_filesystems" or internally known bad filesystems.'})},{key:"linux.advanced.fanotify.ignored_filesystems",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.ignored_filesystems",{defaultMessage:'Additional filesystems for fanotify to ignore. The format is a comma separated list of filesystem names as they appear in "/proc/filesystems", e.g. "ext4,tmpfs". When "ignore_unknown_filesystems" is false, parsed entries of this option supplement internally known bad filesystems to be ignored. When "ignore_unknown_filesystems" is true, parsed entries of this option override entries in "monitored_filesystems" and internally CI tested filesystems.'})},{key:"windows.advanced.memory_protection.context_manipulation_detection",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.context_manipulation_detection",{defaultMessage:"Detect injection based on thread context manipulation (e.g. `SetThreadContext`) as a part of memory protection. Default: true"})},{key:"windows.advanced.kernel.image_and_process_file_timestamp",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.image_and_process_file_timestamp",{defaultMessage:"Collect executable/dll timestamps for process and async image load events. Default: true"})}],m=c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.calloutTitle",{defaultMessage:"Proceed with caution!"}),g=c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.warningMessage",{defaultMessage:"This section contains policy values that support advanced use cases. If not configured\n    properly, these values can cause unpredictable behavior. Please consult documentation\n    carefully or contact support before editing these values."}),f=i.a.memo((({isPlatinumPlus:e})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiCallOut,{title:m,color:"warning",iconType:"alert"},i.a.createElement("p",null,g)),i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiText,{size:"xs",color:"subdued"},i.a.createElement("h4",null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.advanced",defaultMessage:"Advanced settings"}))),i.a.createElement(r.EuiPanel,{"data-test-subj":"advancedPolicyPanel",paddingSize:"s"},p.map(((t,a)=>{const n=t.key.split(".");return!(!e&&"platinum"===t.license)&&i.a.createElement(b,{key:a,configPath:n,firstSupportedVersion:t.first_supported_version,lastSupportedVersion:t.last_supported_version,documentation:t.documentation})}))))));f.displayName="AdvancedPolicyForms";const b=i.a.memo((({configPath:e,firstSupportedVersion:t,lastSupportedVersion:a,documentation:l})=>{const c=Object(s.useDispatch)(),p=Object(d.c)(u.l),m=Object(n.useCallback)((t=>{if(p){const a=Object(o.cloneDeep)(p);!function(e,t,a){let n=e;for(let e=0;e<a.length-1;e++)n[a[e]]||(n[a[e]]={}),n=n[a[e]];if(n[a[a.length-1]]=t,""===t||void 0===t){n=e;for(let t=a.length;t>=0;t--){const i=a.slice(0,t);for(let e=0;e<i.length-1;e++)n=n[i[e]];if(void 0!==n[i[i.length-1]]&&""!==n[i[i.length-1]]&&0!==Object.keys(n[i[i.length-1]]).length)break;"advanced"===i[i.length-1]?n[i[i.length-1]]=void 0:delete n[i[i.length-1]],n=e}}}(a,t.target.value,e),c({type:"userChangedPolicyConfig",payload:{policyConfig:a}})}}),[c,p,e]),g=p&&function(e,t){let a=e;for(let e=0;e<t.length-1;e++){if(!a[t[e]])return;a=a[t[e]]}return a[t[t.length-1]]}(p,e);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFormRow,{fullWidth:!0,label:i.a.createElement(r.EuiFlexGroup,{responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!0},e.join(".")),l&&i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiIconTip,{content:l,position:"right"}))),labelAppend:i.a.createElement(r.EuiText,{size:"xs"},a?`${t}-${a}`:`${t}+`)},i.a.createElement(r.EuiFieldText,{"data-test-subj":e.join("."),fullWidth:!0,value:g,onChange:m})))}));b.displayName="PolicyAdvanced"},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(4),i=a(229),s=a(77),r=a(6);const o=r.i18n.translate("xpack.securitySolution.networkDetails.errorSearchDescription",{defaultMessage:"An error has occurred on network details search"});r.i18n.translate("xpack.securitySolution.networkDetails.failSearchDescription",{defaultMessage:"Failed to run search on network details"});var l=a(240);const c="networkDetailsQuery",u=({filterQuery:e,id:t=c,indexNames:a,ip:r,skip:u})=>{const{loading:d,result:p,search:m,refetch:g,inspect:f}=Object(l.a)({factoryQueryType:s.q.details,initialResult:{networkDetails:{}},errorMessage:o,abort:u}),b=Object(n.useMemo)((()=>({networkDetails:p.networkDetails,id:t,inspect:f,isInspected:!1,refetch:g})),[t,f,g,p.networkDetails]),h=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:s.q.details,filterQuery:Object(i.a)(e),ip:r})),[e,a,r]);return Object(n.useEffect)((()=>{!u&&h&&m(h)}),[h,m,u]),[d,b]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(24),i=a.n(n),s=a(4),r=a.n(s),o=a(250),l=a(417),c=a(535),u=a(210),d=a(406),p=a(490),m=a(6),g=a(595);const f={interval:{label:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),labelAppend:g.a,helpText:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}},b=i()(u.c).withConfig({displayName:"StyledForm",componentId:"sc-9ljx3m-0"})(["max-width:235px !important;"]),h=({addPadding:e=!1,defaultValues:t,descriptionColumns:a="singleSplit",isReadOnlyView:n,isLoading:i,isUpdateView:m=!1,onSubmit:g,setForm:h,onRuleDataChange:y})=>{const{form:E}=Object(u.k)({defaultValue:t,options:{stripEmptyFields:!1},schema:f}),{getFormData:v,submit:k}=E;Object(u.m)({form:E,watch:["from","interval"],onChange:e=>{y&&y(e)}});const S=Object(s.useCallback)((()=>{g&&g()}),[g]),T=Object(s.useCallback)((async()=>{const e=await k();return null!=e&&e.isValid?e:{isValid:!1,data:v()}}),[v,k]);return Object(s.useEffect)((()=>{let e=!1;return h&&!e&&h(o.b.scheduleRule,T),()=>{e=!0}}),[T,h]),n?r.a.createElement(d.a,{addPadding:e},r.a.createElement(l.a,{columns:a,schema:f,data:t})):r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{addPadding:!m},r.a.createElement(b,{form:E,"data-test-subj":"stepScheduleRule"},r.a.createElement(u.e,{path:"interval",component:c.a,componentProps:{idAria:"detectionEngineStepScheduleRuleInterval",isDisabled:i,dataTestSubj:"detectionEngineStepScheduleRuleInterval",minimumValue:1}}),r.a.createElement(u.e,{path:"from",component:c.a,componentProps:{idAria:"detectionEngineStepScheduleRuleFrom",isDisabled:i,dataTestSubj:"detectionEngineStepScheduleRuleFrom",minimumValue:1}}))),!m&&r.a.createElement(p.a,{dataTestSubj:"schedule-continue",onClick:S,isDisabled:i}))},y=Object(s.memo)(h)},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(4),i=a.n(n),s=a(17),r=a(420),o=a(277),l=a(6),c=a(175),u=a(503);const d={type:"primary",id:"need-admin-for-update-rules",title:l.i18n.translate("xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageTitle",{defaultMessage:"Administration permissions required for alert migration"}),description:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:i.a.createElement("p",null,i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.essenceDescription",defaultMessage:"You are currently missing the required permissions to auto migrate your alert data. Please have your administrator visit this page one time to auto migrate your alert data."})),docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(u.a,null)),i.a.createElement("li",null,i.a.createElement(u.c,null)))}})},p=()=>{const[{signalIndexMappingOutdated:e,hasIndexManage:t}]=Object(o.b)();return null!=e&&e&&null!=t&&!t?i.a.createElement(i.a.Fragment,null,i.a.createElement(r.b,{condition:!0,message:d}),i.a.createElement(s.EuiSpacer,{size:"l"})):null},m=Object(n.memo)(p)},function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(4),i=a.n(n),s=a(17),r=a(24),o=a.n(r),l=a(320),c=a(6);const u=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.header",{defaultMessage:"Elastic Security"}),d=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.title",{defaultMessage:"Security at the speed of Elastic"}),p=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.desc",{defaultMessage:"Elastic Security equips teams to prevent, detect, and respond to threats at cloud speed and scale — securing business operations with a unified, open platform."}),m=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.cta",{defaultMessage:"Add security integrations"}),g=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.endpoint.title",{defaultMessage:"Endpoint security at scale"}),f=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.endpoint.desc",{defaultMessage:"Prevent, collect, detect and respond — all with Elastic Agent."}),b=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siemCard.title",{defaultMessage:"SIEM for the modern SOC"}),h=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siemCard.desc",{defaultMessage:"Detect, investigate, and respond to evolving threats in your environment."}),y=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.cloudCard.title",{defaultMessage:"Cloud protection end-to-end"}),E=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.cloudCard.desc",{defaultMessage:"Assess your Cloud Posture and protect your workloads from attacks."}),v=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.unify.title",{defaultMessage:"Unify SIEM, endpoint security, and cloud security"}),k=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.unify.desc",{defaultMessage:"Elastic Security modernizes security operations — enabling analytics across years of data, automating key processes, and protecting every host."});var S=a(733),T=a.n(S),x=a(734),w=a.n(x),O=a(735),j=a.n(O),I=a(1),C=a(19);const M={cloud:w.a,siem:j.a,endpoint:T.a},D=o()(s.EuiCard).withConfig({displayName:"StyledEuiCard",componentId:"sc-1d1l7kb-0"})(["span.euiTitle{font-size:36px;line-height:100%;}"]),A=o()(s.EuiCard).withConfig({displayName:"StyledEuiCardTop",componentId:"sc-1d1l7kb-1"})(["span.euiTitle{font-size:36px;line-height:100%;}max-width:600px;display:block;margin:20px auto 0;"]),F=o()(s.EuiPageHeader).withConfig({displayName:"StyledEuiPageHeader",componentId:"sc-1d1l7kb-2"})(["h1{font-size:18px;}"]),R=o()(s.EuiCard).withConfig({displayName:"StyledImgEuiCard",componentId:"sc-1d1l7kb-3"})(["img{margin-top:20px;max-width:400px;}"]),P=o()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1d1l7kb-4"})(["background:",";padding:20px;margin:-12px !important;"],(({theme:e})=>e.eui.euiColorLightestShade)),_=Object(n.memo)((()=>{const{http:{basePath:{prepend:e}},cloudExperiments:t}=Object(C.k)().services,[a,r]=Object(n.useState)(I.a);Object(l.c)(t,"security-solutions.add-integrations-url",I.a,r);const o=Object(n.useMemo)((()=>e(a)),[e,a]);return i.a.createElement(s.EuiFlexGroup,{"data-test-subj":"siem-landing-page",direction:"column",gutterSize:"l"},i.a.createElement(s.EuiFlexItem,null,i.a.createElement(s.EuiFlexGroup,{gutterSize:"l"},i.a.createElement(s.EuiFlexItem,null,i.a.createElement(F,{pageTitle:u,iconType:"logoSecurity"}),i.a.createElement(D,{display:"plain",description:p,textAlign:"left",title:d,footer:i.a.createElement(s.EuiButton,{"data-test-subj":"add-integrations-header",href:o},m)})),i.a.createElement(s.EuiFlexItem,null,i.a.createElement("iframe",{allowFullScreen:!0,allowTransparency:!0,className:"vidyard_iframe",frameBorder:"0",height:"100%",referrerPolicy:"no-referrer",sandbox:"allow-scripts allow-same-origin",scrolling:"no",src:"//play.vidyard.com/K6kKDBbP9SpXife9s2tHNP.html?",title:u,width:"100%"})))),i.a.createElement(P,null,i.a.createElement(s.EuiFlexGroup,{gutterSize:"m"},i.a.createElement(s.EuiFlexItem,null,i.a.createElement(R,{hasBorder:!0,description:h,image:M.siem,textAlign:"center",title:b})),i.a.createElement(s.EuiFlexItem,null,i.a.createElement(R,{hasBorder:!0,description:f,image:M.endpoint,textAlign:"center",title:g})),i.a.createElement(s.EuiFlexItem,null,i.a.createElement(R,{hasBorder:!0,description:E,image:M.cloud,textAlign:"center",title:y})))),i.a.createElement(s.EuiFlexItem,null,i.a.createElement(A,{display:"plain",description:k,paddingSize:"l",textAlign:"center",title:v,footer:i.a.createElement(s.EuiButton,{"data-test-subj":"add-integrations-footer",href:o},m)})))}));_.displayName="LandingCards"},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),s=a(19),r=a(17);const o=({url:e,children:t,ariaLabel:a})=>t?i.a.createElement(r.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},i.a.createElement(r.EuiLink,{href:e,"aria-label":a,external:!0,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t)):null;var l=a(597);const c=({guidePath:e="security",docPath:t,linkText:a})=>{const{services:n}=Object(s.k)(),{ELASTIC_WEBSITE_URL:r,DOC_LINK_VERSION:c}=n.docLinks,u=`${r}guide/en/${e}/${c}/${t}`,d=`${a} - ${l.a}`;return i.a.createElement(o,{url:u,ariaLabel:d},a)},u=Object(n.memo)(c)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(4),i=a.n(n),s=a(17),r=a(256),o=a(35),l=a(265),c=a(220);const u=({idPrefix:e,entityName:t,entityValue:a})=>{const s=Object(c.h)(`entity-draggable-${e}-${t}-${a}`),u=Object(n.useMemo)((()=>({and:[],enabled:!0,id:s,name:a,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:a,operator:o.c}})),[t,a,s]),d=Object(n.useCallback)(((e,n,s)=>s.isDragging?i.a.createElement(r.a,null,i.a.createElement(l.a,{dataProvider:e})):i.a.createElement(i.a.Fragment,null,`${t}: "${a}"`)),[t,a]);return i.a.createElement(r.b,{key:s,dataProvider:u,render:d,isAggregatable:!0,fieldType:"keyword"})};u.displayName="EntityDraggableComponent";const d=i.a.memo(u);d.displayName="EntityDraggable";var p=a(467),m=a(324),g=a(387),f=a(550),b=a(552),h=a(211);const y=(e,t)=>[{name:m.b,field:"anomaly.jobId",sortable:!0,render:(a,n)=>i.a.createElement(b.a,{score:n.anomaly,startDate:e,endDate:t,linkName:a})},{name:m.n,field:"anomaly.severity",sortable:!0,render:(e,t)=>i.a.createElement(f.a,{id:Object(c.h)(`anomalies-table-severity-${Object(p.a)(t.anomaly)}`),score:t.anomaly})},{name:m.c,field:"anomaly.entityValue",sortable:!0,render:(e,t)=>i.a.createElement(d,{idPrefix:`anomalies-table-entityValue${Object(p.a)(t.anomaly)}-entity`,entityName:t.anomaly.entityName,entityValue:e})},{name:m.e,field:"anomaly.influencers",render:(e,t)=>i.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},e&&e.map((e=>{const[a,n]=Object(g.a)(e),r=null!=a?a:"",o=null!=n?n:"";return i.a.createElement(s.EuiFlexItem,{key:`${r}-${o}-${Object(p.a)(t.anomaly)}`,grow:!1},i.a.createElement(s.EuiFlexGroup,{gutterSize:"none",responsive:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(d,{idPrefix:`anomalies-table-influencers-${r}-${o}-${Object(p.a)(t.anomaly)}`,entityName:r,entityValue:o}))))})))},{name:m.p,field:"anomaly.time",sortable:!0,render:e=>i.a.createElement(h.b,{value:e})}]},,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(17),i=a(4),s=a.n(i),r=a(181),o=a(24),l=a.n(o),c=a(436),u=a(625),d=a(512);const p={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},m=l()(n.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-1oomqeq-0"})(["top:34%;width:100%;max-width:77px;position:absolute;z-index:1;"]),g=l()(n.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1oomqeq-1"})(["position:relative;align-items:center;"]),f=({data:e,fillColor:t,height:a=90,label:o,legendItems:l,title:f,totalCount:b})=>{const h=Object(c.h)(),{euiTheme:y}=Object(n.useEuiTheme)(),E=Object(i.useMemo)((()=>({color:y.colors.disabled})),[y.colors.disabled]);return s.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},s.a.createElement(g,{grow:!1},s.a.createElement(m,{direction:"column",gutterSize:"none",alignItems:"center",justifyContent:"center"},s.a.createElement(n.EuiFlexItem,null,f),s.a.createElement(n.EuiFlexItem,{className:"eui-textTruncate"},s.a.createElement(n.EuiToolTip,{content:o},s.a.createElement(n.EuiText,{className:"eui-textTruncate",size:"s",style:e?void 0:E},o)))),null==e||null==b||0===b?s.a.createElement(d.a,{size:a}):s.a.createElement(r.Chart,{size:a},s.a.createElement(r.Settings,{theme:p,baseTheme:h}),s.a.createElement(r.Partition,{id:"donut-chart",data:e,layout:r.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(r.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]}))),l&&(null==l?void 0:l.length)>0&&s.a.createElement(n.EuiFlexItem,null,s.a.createElement(u.a,{legendItems:l,height:a})))}},,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),s=a(24),r=a.n(s),o=a(297);const l=r.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-u1bwbv-0"})(["padding:",";"],(e=>e.theme.eui.euiSizeS)),c=({count:e})=>null!=e?i.a.createElement("b",null,i.a.createElement(o.a,{count:e})):i.a.createElement(l,null);c.displayName="ChartLabelComponent";const u=i.a.memo(c)},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(323);const s=Object(i.c)(),r=()=>{const[e]=Object(n.useState)(s);return{globalKQLHeaderPortalNode:e}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(4),i=a.n(n),s=a(17),r=a(24),o=a.n(r),l=a(212),c=a(366);const u=o.a.h1.withConfig({displayName:"Header",componentId:"sc-1tun0gt-0"})(["display:grid;grid-gap:12px;grid-template-columns:auto auto;align-items:center;justify-items:start;justify-content:start;"]);u.displayName="Header";const d=o.a.span.withConfig({displayName:"TitleWrapper",componentId:"sc-1tun0gt-1"})(["min-width:0;max-width:100%;"]);d.displayName="TitleWrapper";const p=({draggableArguments:e,title:t,badgeOptions:a})=>i.a.createElement(s.EuiTitle,{size:"l"},i.a.createElement(u,{"data-test-subj":"header-page-title"},e?i.a.createElement(l.b,{"data-test-subj":"header-page-draggable",id:`header-page-draggable-${e.field}-${e.value}`,field:e.field,value:`${e.value}`}):i.a.createElement(d,null,i.a.createElement(c.b,{tooltipContent:t},t)),a&&i.a.createElement(i.a.Fragment,null,a.beta?i.a.createElement(s.EuiBetaBadge,{label:a.text,tooltipContent:a.tooltip,tooltipPosition:"bottom",size:a.size}):i.a.createElement(s.EuiBadge,{color:a.color||"hollow",title:""},a.text)))),m=i.a.memo(p)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(6).i18n.translate("xpack.securitySolution.components.ml.anomaly.errors.anomaliesTableFetchFailureTitle",{defaultMessage:"Anomalies table fetch failure"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(1),s=a(19);const r=({defaultValue:e,key:t,plugin:a=i.o,isInvalidDefault:r})=>{const{storage:o}=Object(s.k)().services,[l,c]=Object(n.useState)(!1),[u,d]=Object(n.useState)(e),p=Object(n.useCallback)((()=>{const n=o.get(`${a}.${t}`),i=typeof n!=typeof e,s=null!=r&&r(n);d(i||s?e:n)}),[e,r,t,a,o]),m=Object(n.useCallback)((e=>{o.set(`${a}.${t}`,e),d(e)}),[t,a,o]);return Object(n.useEffect)((()=>{l||(p(),c(!0))}),[l,p]),[u,m]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(14),i=a(115),s=a(103);const r=Object(n.createSelector)(Object(i.globalFiltersQuerySelector)(),Object(i.getTimelineSelector)(),Object(i.globalQuerySelector)(),Object(i.globalQuery)(),Object(i.timelineQueryByIdSelector)(),Object(s.getTimelineByIdSelector)(),((e,t,a,n,i,s)=>({filters:e,input:t,query:a,globalQueries:n,timelineQuery:i,timeline:s})))},,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>null==e?[]:null!=e.host&&null!=e.host.name?[{fieldName:"host.name",fieldValue:e.host.name[0]}]:[]},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return r}));var n=a(1),i=a(15);const s=[i.i.detectionsPage,i.i.detectionsRulesDetailsPage],r=(e,t,a=!1)=>null!=e&&s.some((t=>t===e))&&!t.some((e=>e.toLowerCase().startsWith(a?n.H:".siem-signals")))},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(17),i=a(3),s=a(4),r=a.n(s),o=a(15),l=a(373);const c=e=>e?"pinFilled":"pin",u=r.a.memo((({ariaLabel:e,allowUnpinning:t,isAlert:a,isDisabled:s,onClick:u=i.noop,pinned:d,timelineType:p})=>{const m=p===o.m.template,g=(({isAlert:e,isTemplate:t,isPinned:a})=>t?l.f(e):a?l.k(e):l.q(e))({isAlert:a,isTemplate:m,isPinned:d}),f=null!=e?e:g;return r.a.createElement(n.EuiButtonIcon,{"aria-label":f,"data-test-subj":"pin",iconType:c(d),onClick:u,isDisabled:s||m||!t,size:"s"})}));u.displayName="Pin"},function(e,t,a){const n=a(233),i=a(326),{re:s,t:r}=a(325);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let a=null;if((t=t||{}).rtl){let t;for(;(t=s[r.COERCERTL].exec(e))&&(!a||a.index+a[0].length!==e.length);)a&&t.index+t[0].length===a.index+a[0].length||(a=t),s[r.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;s[r.COERCERTL].lastIndex=-1}else a=e.match(s[r.COERCE]);return null===a?null:i(`${a[2]}.${a[3]||"0"}.${a[4]||"0"}`,t)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return k})),a.d(t,"b",(function(){return S}));var n=a(3),i=a(4),s=a.n(i),r=a(47),o=a(20),l=a(92),c=a.n(l),u=a(44),d=a(8),p=a(207),m=a(13),g=a(253),f=a(491),b=a(596),h=a(241),y=a(91);const E="timeline-filter-drop-area",v=(e=[])=>e.filter((e=>e.meta.controlledBy!==E)),k=Object(i.memo)((({dataProviders:e,filters:t,filterManager:a,filterQuery:n,from:l,fromStr:u,kqlMode:k,isRefreshPaused:T,savedQueryId:x,setFilters:w,setSavedQueryId:O,refreshInterval:j,timelineId:I,to:C,toStr:M,updateReduxTime:D})=>{const A=Object(r.useDispatch)(),[F,R]=Object(i.useState)(null!=u?u:new Date(l).toISOString()),[P,_]=Object(i.useState)(null!=M?M:new Date(C).toISOString()),{browserFields:q,indexPattern:N}=Object(p.d)(m.SourcererScopeName.timeline),[L,B]=Object(i.useState)(void 0),[z,H]=Object(i.useState)({query:null!=n?n.expression:"",language:null!=n?n.kind:"kuery"}),[$,V]=Object(i.useState)(v(t)),[U,Q]=Object(i.useState)(Object(g.b)(Object(h.g)(e,q),N)),W=Object(f.a)(),G=Object(i.useCallback)(((e,t)=>A(y.a.applyKqlFilterQuery({id:I,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(g.b)(e,N)}}))),[A,N,I]);Object(i.useEffect)((()=>{let e=!0;const n=new o.Subscription;return a.setFilters(t),n.add(a.getUpdates$().subscribe({next:()=>{if(e){const e=v(a.getFilters());w(e),V(e)}}})),()=>{e=!1,n.unsubscribe()}}),[]),Object(i.useEffect)((()=>{const e=v(a.getFilters());c()(t,e)||a.setFilters(t)}),[t]),Object(i.useEffect)((()=>{H({query:null!=n?n.expression:"",language:null!=n?n.kind:"kuery"})}),[n]),Object(i.useEffect)((()=>{Q(Object(g.b)(Object(h.g)(e,q),N))}),[e,q,N]),Object(i.useEffect)((()=>{null!=u&&null!=M?(R(u),_(M)):null!=l&&null!=C&&(R(new Date(l).toISOString()),_(new Date(C).toISOString()))}),[l,u,C,M]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=x&&null!=W)try{const a=await W.getSavedQuery(x);e&&null!=a&&B({...a,attributes:{...a.attributes,filters:v(t)}})}catch(e){B(void 0)}else e&&B(void 0)}(),()=>{e=!1}}),[x]);const K=Object(i.useCallback)(((e,t)=>{if((null==n||null!=n&&n.expression!==e.query||n.kind!==e.language)&&G(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");D({id:d.a.timeline,end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:I})}}),[n,I]),J=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==x&&O(e.id),null!=W&&""!==U){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===E)):-1;W.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),S(U),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,S(U)]:[]})}}else O(null)}),[U,x,W]);return s.a.createElement(b.a,{dateRangeFrom:F,dateRangeTo:P,hideSavedQuery:"search"===k,indexPattern:N,isRefreshPaused:T,filterQuery:z,filterManager:a,filters:$,onSubmitQuery:K,refreshInterval:j,savedQuery:L,onSavedQuery:J,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"})})),S=e=>{const t=JSON.parse(e),a=Object.keys(t);return{...t,meta:{alias:E,controlledBy:E,negate:!1,disabled:!1,type:"custom",key:Object(n.isEmpty)(a)?"bool":a[0],value:e},$state:{store:u.b.APP_STATE}}}},function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(5),i=a(181),s=a(411),r=a(320),o=a(250);const l=(e,t)=>e/Math.max((t.timeframeEnd.valueOf()-t.timeframeStart.valueOf())/36e5,1)>1,c=(e,t,a=!1)=>({series:{xScaleType:i.ScaleType.Time,yScaleType:i.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(r.a)([e,t]),yTickFormatter:e=>e.toLocaleString(),tickSize:8},yAxisTitle:s.i,settings:{legendPosition:i.Position.Right,showLegend:a,showLegendExtra:a,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200}),u=({ruleType:e,isQueryBarValid:t,isThreatQueryBarValid:a,index:i,dataViewId:s,dataSourceType:r,threatIndex:l,threatMapping:c,machineLearningJobId:u,queryBar:d,newTermsFields:p})=>{if(!t||r===o.a.DataView&&!s||r===o.a.IndexPatterns&&0===i.length)return!0;if("threat_match"===e){var m;if(!a||!l.length||!c)return!0;if(!(c.length&&null!==(m=c[0].entries)&&void 0!==m&&m.length&&c[0].entries[0].field&&c[0].entries[0].value))return!0}return"machine_learning"===e?0===u.length:"eql"===e||"query"===e||"threshold"===e?Object(n.isEmpty)(d.query.query)&&Object(n.isEmpty)(d.filters):"new_terms"===e&&0===p.length}},function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(17),i=a(5),s=a(4),r=a.n(s),o=a(24),l=a.n(o),c=a(269),u=a(202),d=a(267),p=a(258),m=a(308),g=a(492),f=a(378);const b=l()(n.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-12pilng-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);b.displayName="StaticSwitch";const h=({id:e,isDisabled:t,isLoading:a,enabled:o,onChange:l})=>{const[h,y]=Object(s.useState)(!1),E=Object(f.c)(),v=Object(m.c)(),k=Object(u.a)(),{startTransaction:S}=Object(p.a)(),T=Object(s.useCallback)((async t=>{y(!0),S({name:o?d.e.DISABLE:d.e.ENABLE});const a=await Object(g.c)({setLoadingRules:null==E?void 0:E.actions.setLoadingRules,toasts:k,onSuccess:E?void 0:i.noop,action:t.target.checked?c.a.enable:c.a.disable,search:{ids:[e]},visibleRuleIds:[]});null!=a&&a.attributes.results.updated.length&&(v(a.attributes.results.updated),null==l||l(a.attributes.results.updated[0].enabled)),y(!1)}),[o,e,l,E,S,k,v]),x=Object(s.useMemo)((()=>h!==a&&a||h),[h,a]);return r.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceAround"},r.a.createElement(n.EuiFlexItem,{grow:!1},x?r.a.createElement(n.EuiLoadingSpinner,{size:"m","data-test-subj":"ruleSwitchLoader"}):r.a.createElement(b,{"data-test-subj":"ruleSwitch",label:void 0,disabled:t,checked:o,onChange:T})))},y=r.a.memo(h);y.displayName="RuleSwitch"},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(17),i=a(4),s=a.n(i),r=a(24),o=a.n(r),l=a(216);const c=o()(n.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-177nzsv-0"})(["position:relative;"]);c.displayName="MyPanel";const u=({children:e,loading:t,title:a})=>s.a.createElement(c,{hasBorder:!0},t&&s.a.createElement(n.EuiProgress,{size:"xs",color:"accent",position:"absolute","data-test-subj":"stepPanelProgress"}),a&&s.a.createElement(l.a,{title:a}),e),d=Object(i.memo)(u)},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),s=a(17),r=a(215);const o=({columnName:e,children:t})=>{const[a,o]=Object(n.useState)(!1);return i.a.createElement(s.EuiPopover,{anchorPosition:"upCenter",isOpen:a,closePopover:()=>o(!1),button:i.a.createElement(s.EuiButtonIcon,{"aria-label":r.Xb(e),onClick:e=>{o(!a),e.stopPropagation()},size:"xs",color:"primary",iconType:"questionInCircle",style:{height:"auto"}})},t)},l=i.a.memo(o);l.displayName="PopoverTooltip"},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),s=a(17);const r=({title:e,tooltipContent:t,customTooltip:a})=>i.a.createElement(s.EuiFlexGrid,{gutterSize:"none"},i.a.createElement(s.EuiFlexItem,{style:{width:"calc(100% - 20px)"}},i.a.createElement("span",{className:"eui-textTruncate"},e)),null!=a?a:i.a.createElement(s.EuiToolTip,{content:t},i.a.createElement(s.EuiIcon,{"data-test-subj":"tableHeaderIcon",size:"m",color:"subdued",type:"questionInCircle",style:{marginLeft:4}}))),o=i.a.memo(r);o.displayName="TableHeaderTooltipCell"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a(218),s=a(491),r=a(202),o=a(215);const l=(e,{ruleType:t,onError:a})=>{var l;const c=Object(s.a)(),{addError:u}=Object(r.a)(),d=Object(i.useQuery)(["detectionEngine","rule","savedQuery",e],(async()=>e?c.getSavedQuery(e):null),{onError:null!=a?a:e=>{u(e,{title:o.Dc})},enabled:Boolean(e)&&"saved_query"===t,retry:!1}),p=Object(n.useMemo)((()=>{var e;return d.data?{saved_id:d.data.id,filters:null!==(e=d.data.attributes.filters)&&void 0!==e?e:[],query:d.data.attributes.query,title:d.data.attributes.title}:null}),[d.data]);return{isSavedQueryLoading:!!e&&d.isLoading,savedQueryBar:p,savedQuery:null!==(l=d.data)&&void 0!==l?l:void 0}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a(19);const s=()=>{const{storage:e}=Object(i.k)().services,t=Object(n.useCallback)((t=>{var a;return null!==(a=e.get(`${t}-messages`))&&void 0!==a?a:[]}),[e]),a=Object(n.useCallback)(((t,a)=>{var n;const i=null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[];e.set(`${t}-messages`,[...i,a])}),[e]),s=Object(n.useCallback)(((t,a)=>{var n;return(null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[]).filter((e=>e===a)).length>0}),[e]),r=Object(n.useCallback)(((t,a)=>{var n;const i=null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[];e.set(`${t}-messages`,[...i.filter((e=>e!==a))])}),[e]);return{getMessages:t,addMessage:a,clearAllMessages:Object(n.useCallback)((t=>e.remove(`${t}-messages`)),[e]),removeMessage:r,hasMessage:s}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return c}));var n=a(17),i=a(4),s=a.n(i),r=a(259);const o="open",l=({status:e=o,onFilterGroupChanged:t})=>{const a=[{id:"open",label:r.z,"data-test-subj":"openAlerts"},{id:"acknowledged",label:r.a,"data-test-subj":"acknowledgedAlerts"},{id:"closed",label:r.w,"data-test-subj":"closedAlerts"}],l=Object(i.useCallback)((e=>{t(e)}),[t]);return s.a.createElement(n.EuiButtonGroup,{legend:"filter status",color:"primary",options:a,idSelected:e,"data-test-subj":"alerts-table-filter-group",onChange:l})},c=s.a.memo(l)},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(3),i=a(291),s=a(230),r=a(507),o=a(449),l=a(9);const c=i.c.UsersType.details,u={[s.UsersTableType.allUsers]:o.a,[s.UsersTableType.authentications]:o.c,[s.UsersTableType.anomalies]:o.b,[s.UsersTableType.risk]:o.e,[s.UsersTableType.events]:o.d,[s.UsersTableType.risk]:o.e},d=(e,t)=>{let a=[];if(null!=e.detailName&&(a=[{text:e.detailName,href:t({path:Object(r.c)(e.detailName,""),deepLinkId:l.a.users})}]),null!=e.tabName){const t=Object(n.get)("tabName",e);if(!t)return a;a=[...a,{text:u[t],href:""}]}return a}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(4),i=a.n(n),s=a(17),r=a(24),o=a.n(r);const l=o()(s.EuiFlexGroup).withConfig({displayName:"PopoverItemsWrapper",componentId:"sc-3vrhxe-0"})(["width:100%;"]),c=o()(s.EuiBadgeGroup).withConfig({displayName:"PopoverWrapper",componentId:"sc-3vrhxe-1"})(["max-height:200px;max-width:600px;overflow:auto;line-height:",";"],(({theme:e})=>e.eui.euiLineHeight)),u=({items:e,renderItem:t,popoverTitle:a,popoverButtonTitle:r,popoverButtonIcon:o,numberOfItemsToDisplay:u=0,dataTestPrefix:d="items"})=>{const[p,m]=Object(n.useState)(!1),g=({items:e})=>i.a.createElement(i.a.Fragment,null,e.map(t));return e.length<=u?i.a.createElement(l,{"data-test-subj":d,alignItems:"center",gutterSize:"s"},i.a.createElement(g,{items:e})):i.a.createElement(l,{alignItems:"center",gutterSize:"s","data-test-subj":d},0!==u&&i.a.createElement(s.EuiFlexItem,{grow:1,className:"eui-textTruncate"},i.a.createElement(g,{items:e.slice(0,u)})),i.a.createElement(s.EuiPopover,{ownFocus:!0,"data-test-subj":`${d}DisplayPopover`,button:i.a.createElement(s.EuiBadge,{iconType:o,color:"hollow","data-test-subj":`${d}DisplayPopoverButton`,onClick:()=>m(!p),onClickAriaLabel:r},r),isOpen:p,closePopover:()=>m(!p),repositionOnScroll:!0},a?i.a.createElement(s.EuiPopoverTitle,{"data-test-subj":`${d}DisplayPopoverTitle`},a):null,i.a.createElement(c,{"data-test-subj":`${d}DisplayPopoverWrapper`},i.a.createElement(g,{items:e.slice(u)}))))},d=i.a.memo(u);d.displayName="PopoverItems";const p=d},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(4),i=a.n(n),s=a(17),r=a(699),o=a(415),l=a(19);let c;!function(e){e.overview="details",e.activityLog="activity_log"}(c||(c={}));const u=Object(n.memo)((({tab:e,isSelected:t})=>{const{getAppUrl:a}=Object(l.d)(),n=Object(o.a)(e.route);return i.a.createElement(s.EuiTab,{href:a({path:e.route}),onClick:n,isSelected:t,key:e.id,"data-test-subj":`endpoint-details-flyout-tab-${e.id}`},e.name)}));u.displayName="EndpointDetailsTab";const d=Object(n.memo)((({hostname:e,show:t,tabs:a})=>{const o=Object(n.useMemo)((()=>a.find((e=>e.id===t))),[a,t]),l=a.map((e=>i.a.createElement(u,{key:e.id,tab:e,isSelected:e.id===(null==o?void 0:o.id)})));return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.a,{hostname:e,hasBorder:!0},i.a.createElement(s.EuiTabs,{bottomBorder:!1,style:{marginBottom:"-25px"}},l)),i.a.createElement(s.EuiFlyoutBody,{"data-test-subj":`endpoint${"details"===(null==o?void 0:o.id)?"Details":"ActivityLog"}FlyoutBody`},null==o?void 0:o.content))}));d.displayName="EndpointDetailsFlyoutTabs"},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return je})),a.d(t,"a",(function(){return Me}));var n=a(4),i=a.n(n),s=a(47),r=a(62),o=a(17),l=a(177),c=a(44),u=a(532),d=a(345),p=a(8),m=a(76),g=a(77),f=a(213),b=a(299),h=a(266),y=a(455),E=a(365),v=a(548),k=a(350),S=a(221),T=a(24),x=a.n(T),w=a(460),O=a(6);const j=O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.sourceDropDownOptionLabel",{defaultMessage:"Source"}),I=O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.destinationDropDownOptionLabel",{defaultMessage:"Destination"}),C=O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.clientDropDownOptionLabel",{defaultMessage:"CLIENT"}),M=O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.serverDropDownOptionLabel",{defaultMessage:"SERVER"}),D=(O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowDirection.unidirectionalButtonLabel",{defaultMessage:"Unidirectional"}),O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowDirection.bidirectionalButtonLabel",{defaultMessage:"Bidirectional"}),(e,t)=>[{id:`${e}-select-flow-target-${g.f.source}`,value:g.f.source,inputDisplay:t[0]||j,directions:[g.e.uniDirectional,g.e.biDirectional]},{id:`${e}-select-flow-target-${g.f.destination}`,value:g.f.destination,inputDisplay:t[1]||I,directions:[g.e.uniDirectional,g.e.biDirectional]},{id:`${e}-select-flow-target-${g.f.client}`,value:g.f.client,inputDisplay:t[2]||C,directions:[g.e.biDirectional]},{id:`${e}-select-flow-target-${g.f.server}`,value:g.f.server,inputDisplay:t[3]||M,directions:[g.e.biDirectional]}]),A=({id:e,isLoading:t=!1,selectedDirection:a,selectedTarget:n,displayTextOverride:s=[],updateFlowTargetAction:r})=>i.a.createElement(o.EuiSuperSelect,{options:a?D(e,s).filter((e=>e.directions.includes(a))):D(e,s),valueOfSelected:n,onChange:r,isLoading:t}),F=i.a.memo(A);var R=a(337);const P=x()(o.EuiFlexItem).withConfig({displayName:"SelectTypeItem",componentId:"sc-12qgll-0"})(["min-width:180px;"]);P.displayName="SelectTypeItem";const _=({flowTarget:e})=>{const t=Object(r.useHistory)(),a=Object(r.useLocation)(),s=Object(n.useCallback)((n=>{const i=((e,t,a)=>`${e.pathname.replace(t,a)}${e.search}`)(a,e,n);t.push(i)}),[t,a,e]);return i.a.createElement(P,{grow:!1,"data-test-subj":`${R.b}-select-flow-target`},i.a.createElement(F,{id:R.b,isLoading:!e,selectedDirection:g.e.uniDirectional,selectedTarget:e,displayTextOverride:[w.b,w.a],updateFlowTargetAction:s}))},q=i.a.memo(_);var N=a(549),L=a(298),B=a(95),z=a(620),H=a(19),$=a(432),V=a(78),U=a(23),Q=a(389),W=a(236),G=a(214),K=a(9),J=a(207),Y=a(296),X=a(304),Z=a(379),ee=a(321),te=a(254),ae=a(611),ne=a(224),ie=a(344),se=a(1),re=a(441),oe=a(384);const le=(e,t,a)=>`${se.Sb}/ip/${e}/${a}/${t}`,ce=(e,t,a)=>{const n={[oe.a.flows]:{id:oe.a.flows,name:re.d,href:le(e,oe.a.flows,a),disabled:!1},[oe.a.users]:{id:oe.a.users,name:re.g,href:le(e,oe.a.users,a),disabled:!1},[oe.a.http]:{id:oe.a.http,name:re.e,href:le(e,oe.a.http,a),disabled:!1},[oe.a.tls]:{id:oe.a.tls,name:re.f,href:le(e,oe.a.tls,a),disabled:!1},[oe.a.anomalies]:{id:oe.a.anomalies,name:re.a,href:le(e,oe.a.anomalies,a),disabled:!1},[oe.a.events]:{id:oe.a.events,name:re.c,href:le(e,oe.a.events,a),disabled:!1}};return t||delete n.anomalies,n};var ue=a(53),de=a.n(ue),pe=a(56),me=a(34),ge=a(612),fe=a(99),be=a(500),he=a(425),ye=a(521),Ee=a(602),ve=a(577);const ke=i.a.memo((({indexPattern:e,flowTarget:t,...a})=>{const s=G.c.NetworkType.details,l={...a,type:s},c={...l,indexPattern:e},u={...l,flowTarget:t},d=Object(n.useMemo)((()=>Object(ee.d)(a.ip)),[a.ip]);return i.a.createElement(r.Switch,null,i.a.createElement(pe.Route,{path:`${ye.b}/:flowTarget/:tabName(${oe.a.flows})`},i.a.createElement(i.a.Fragment,null,i.a.createElement(ve.a,{direction:"column"},i.a.createElement(o.EuiFlexItem,null,i.a.createElement(Ee.d,de()({},c,{flowTarget:fe.b.source}))),i.a.createElement(o.EuiFlexItem,null,i.a.createElement(Ee.d,de()({},c,{flowTarget:fe.b.destination})))),i.a.createElement(o.EuiSpacer,null),i.a.createElement(ve.a,{direction:"column"},i.a.createElement(o.EuiFlexItem,null,i.a.createElement(Ee.a,de()({},c,{flowTarget:fe.b.source}))),i.a.createElement(o.EuiFlexItem,null,i.a.createElement(Ee.a,de()({},c,{flowTarget:fe.b.destination})))))),i.a.createElement(pe.Route,{path:`${ye.b}/:flowTarget/:tabName(${oe.a.users})`},i.a.createElement(Ee.h,u)),i.a.createElement(pe.Route,{path:`${ye.b}/:flowTarget/:tabName(${oe.a.http})`},i.a.createElement(Ee.c,l)),i.a.createElement(pe.Route,{path:`${ye.b}/:flowTarget/:tabName(${oe.a.tls})`},i.a.createElement(Ee.g,u)),i.a.createElement(pe.Route,{path:`${ye.b}/:flowTarget/:tabName(${oe.a.anomalies})`},i.a.createElement(he.a,de()({},u,{hideHistogramIfEmpty:!0,AnomaliesTableComponent:ge.a}))),i.a.createElement(pe.Route,{path:`${ye.b}/:flowTarget/:tabName(${oe.a.events})`},i.a.createElement(be.a,de()({pageFilters:d,timelineId:me.TimelineId.networkPageEvents},l))))}));ke.displayName="UsersDetailsTabs";var Se=a(286),Te=a(3),xe=a(539),we=a(347);G.c.NetworkType.details;const Oe={[oe.a.events]:re.c,[oe.a.anomalies]:re.a,[oe.a.flows]:re.d,[oe.a.users]:re.g,[oe.a.http]:re.e,[oe.a.tls]:re.f,[we.a.dns]:re.b},je=(e,t)=>{let a=[];null!=e.detailName&&(a=[{text:Object($.c)(e.detailName),href:t({deepLinkId:K.a.network,path:Object(xe.a)(e.detailName,e.flowTarget,"")})}]);const n=Object(Te.get)("tabName",e);return n?(a=[...a,{text:Oe[n],href:""}],a):a},Ie=Object(S.a)(N.a),Ce=()=>{const e=Object(s.useDispatch)(),t=Object(ne.a)(),{to:a,from:S,setQuery:T,isInitializing:x}=Object(f.a)(),{detailName:w,flowTarget:O}=Object(r.useParams)(),j=Object(n.useMemo)((()=>V.f.globalQuerySelector()),[]),I=Object(n.useMemo)((()=>V.f.globalFiltersQuerySelector()),[]),{signalIndexName:C}=Object(d.a)(),{hasKibanaREAD:M,hasIndexRead:D}=Object(ie.a)(),A=M&&D,F=Object(m.a)(j),R=Object(m.a)(I),P=G.c.NetworkType.details,_=Object(n.useCallback)(((t,a)=>{const n=Object(k.a)(t,a);e(Object(U.setAbsoluteRangeDatePicker)({id:p.a.global,from:n.from,to:n.to}))}),[e]),{services:{uiSettings:N}}=Object(H.k)();Object(n.useEffect)((()=>{e(Object(Q.setNetworkDetailsTablesActivePageToZero)())}),[w,e]);const{indicesExist:se,indexPattern:re,selectedPatterns:oe}=Object(J.d)(),le=Object($.c)(w),[ue,de]=Object(n.useMemo)((()=>{try{return[Object(c.c)(re,[F],[...Object(ee.d)(le),...R],Object(l.getEsQueryConfig)(N))]}catch(e){return[void 0,e]}}),[R,re,le,F,N]),pe=JSON.stringify(ue);Object(Y.a)({id:z.a,filterQuery:pe,kqlError:de,query:F,startDate:S,endDate:a});const[me,{id:ge,inspect:fe,networkDetails:be,refetch:he}]=Object(z.b)({skip:x,filterQuery:pe,indexNames:oe,ip:le}),{jobIds:ye}=Object(Se.b)(),[Ee,ve]=Object(E.a)({criteriaFields:Object(v.a)(w,O),startDate:S,endDate:a,skip:x,jobIds:ye,aggregationInterval:"auto"}),Te=Object(n.useMemo)((()=>({field:`${O}.ip`,value:le})),[O,le]),xe=Object(n.useMemo)((()=>x||void 0===ue),[x,ue]),we=Object(n.useMemo)((()=>({field:`${O}.ip`,value:w})),[w,O]);return i.a.createElement("div",{"data-test-subj":"network-details-page"},se?i.a.createElement(i.a.Fragment,null,i.a.createElement(b.a,null,i.a.createElement(L.a,{indexPattern:re,id:p.a.global})),i.a.createElement(B.a,null,i.a.createElement(h.a,{border:!0,"data-test-subj":"network-details-headline",draggableArguments:Te,subtitle:i.a.createElement(y.a,{indexKey:g.k.ipDetails,indexNames:oe,ip:le}),title:le},i.a.createElement(q,{flowTarget:O})),i.a.createElement(Ie,{id:ge,inspect:fe,ip:le,isInDetailsSidePanel:!1,data:be,anomaliesData:ve,loading:me,isLoadingAnomaliesData:Ee,type:P,flowTarget:O,refetch:he,setQuery:T,startDate:S,endDate:a,narrowDateRange:_,indexPatterns:oe}),i.a.createElement(o.EuiHorizontalRule,null),i.a.createElement(o.EuiSpacer,null),A&&i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiFlexGroup,null,i.a.createElement(o.EuiFlexItem,null,i.a.createElement(u.a,{signalIndexName:C,entityFilter:we,additionalFilters:ue?[ue]:[]})),i.a.createElement(o.EuiFlexItem,null,i.a.createElement(ae.a,{entityFilter:we,signalIndexName:C,additionalFilters:ue?[ue]:[]}))),i.a.createElement(o.EuiSpacer,null)),i.a.createElement(Z.a,{navTabs:ce(le,Object(te.a)(t),O)}),i.a.createElement(o.EuiSpacer,null),i.a.createElement(ke,{ip:le,endDate:a,startDate:S,filterQuery:pe,indexNames:oe,skip:xe,setQuery:T,indexPattern:re,flowTarget:O}))):i.a.createElement(X.a,null),i.a.createElement(W.a,{pageName:K.a.network}))};Ce.displayName="NetworkDetailsComponent";const Me=i.a.memo(Ce)},function(e,t,a){"use strict";a.d(t,"a",(function(){return M}));var n=a(4),i=a.n(n),s=a(20),r=a(24),o=a.n(r),l=a(92),c=a.n(l),u=a(17),d=a(180),p=a(188);const m=Object(n.memo)((({indexPattern:e,isLoading:t=!1,isRefreshPaused:a,filterQuery:s,filterManager:r,filters:o,refreshInterval:l,dataTestSubj:c,displayStyle:u})=>{const d=Object(n.useCallback)((e=>{r.setFilters(e)}),[r]),m=Object(n.useMemo)((()=>[e]),[e]);return i.a.createElement(p.SearchBar,{showSubmitButton:!1,filters:o,indexPatterns:m,isLoading:t,isRefreshPaused:a,query:s,onFiltersUpdated:d,refreshInterval:l,showAutoRefreshOnly:!1,showFilterBar:!0,showDatePicker:!1,showQueryBar:!1,showQueryInput:!1,showSaveQuery:!1,dataTestSubj:c,displayStyle:u})}));m.displayName="FilterBar";var g=a(202),f=a(359),b=a(5);const h=({ariaLabel:e,errors:t})=>{const[a,s]=Object(n.useState)(!1),r=Object(n.useCallback)((()=>{s(!a)}),[a]),o=Object(n.useCallback)((()=>{s(!1)}),[]);return i.a.createElement(u.EuiPopover,{"data-test-subj":"eql-validation-errors-popover",button:i.a.createElement(u.EuiButtonEmpty,{"data-test-subj":"eql-validation-errors-popover-button",iconType:"crossInACircleFilled",size:"s",color:"danger","aria-label":e,onClick:r},t.length),isOpen:a,closePopover:o,anchorPosition:"downCenter"},i.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},i.a.createElement(u.EuiPopoverTitle,null,f.k),t.map(((e,t)=>i.a.createElement(u.EuiText,{key:t},e)))))};var y=a(19);const E=o()(u.EuiText).withConfig({displayName:"InlineText",componentId:"sc-i91hzt-0"})(["display:inline-block;"]),v=()=>{const e=Object(y.k)().services.docLinks.links.query.eql;return i.a.createElement(u.EuiLink,{external:!0,href:e,target:"_blank"},i.a.createElement(E,{size:"xs"},f.i))},k=o()(u.EuiPanel).withConfig({displayName:"Container",componentId:"sc-10yczbx-0"})(["border-radius:0;background:",";padding:"," ",";"],(({theme:e})=>e.eui.euiPageBackgroundColor),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeS)),S=o()(u.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-10yczbx-1"})(["min-height:",";"],(({theme:e})=>e.eui.euiSizeXL)),T=o()(u.EuiFlexItem).withConfig({displayName:"FlexItemLeftBorder",componentId:"sc-10yczbx-2"})(["border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),x=o()(u.EuiFlexItem).withConfig({displayName:"FlexItemWithMarginRight",componentId:"sc-10yczbx-3"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),w=o()(u.EuiLoadingSpinner).withConfig({displayName:"Spinner",componentId:"sc-10yczbx-4"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeS)),O={asPlainText:!0},j=({errors:e,isLoading:t,isSizeOptionDisabled:a,optionsData:s,optionsSelected:r,onOptionsChange:o})=>{var l;const[c,d]=Object(n.useState)(!1),[p,m]=Object(n.useState)(null!==(l=null==r?void 0:r.size)&&void 0!==l?l:100),g=Object(n.useRef)(),y=Object(n.useCallback)((()=>{d(!0)}),[]),E=Object(n.useCallback)((()=>{d(!1)}),[]),j=Object(n.useCallback)((e=>{o&&(e.length>0?o("eventCategoryField",e[0].label):o("eventCategoryField",void 0))}),[o]),I=Object(n.useCallback)((e=>{o&&(e.length>0?o("tiebreakerField",e[0].label):o("tiebreakerField",void 0))}),[o]),C=Object(n.useCallback)((e=>{o&&(e.length>0?o("timestampField",e[0].label):o("timestampField",void 0))}),[o]),M=Object(n.useCallback)((e=>{var t,a,n,i;o&&(m(null==e||null===(t=e.target)||void 0===t?void 0:t.value),null!==(a=g.current)&&void 0!==a&&a.cancel&&(null===(i=g.current)||void 0===i||i.cancel()),g.current=Object(b.debounce)((e=>o("size",e)),800),g.current(null==e||null===(n=e.target)||void 0===n?void 0:n.value))}),[o]),D=Object(n.useMemo)((()=>null!=(null==r?void 0:r.eventCategoryField)?[{label:null==r?void 0:r.eventCategoryField}]:void 0),[null==r?void 0:r.eventCategoryField]),A=Object(n.useMemo)((()=>null!=(null==r?void 0:r.tiebreakerField)?[{label:null==r?void 0:r.tiebreakerField}]:void 0),[null==r?void 0:r.tiebreakerField]),F=Object(n.useMemo)((()=>null!=(null==r?void 0:r.timestampField)?[{label:null==r?void 0:r.timestampField}]:void 0),[null==r?void 0:r.timestampField]);return i.a.createElement(k,null,i.a.createElement(S,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none"},i.a.createElement(u.EuiFlexItem,null,e.length>0&&i.a.createElement(h,{ariaLabel:f.l,errors:e}),t&&i.a.createElement(w,{"data-test-subj":"eql-validation-loading",size:"m"})),!o&&i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(v,null)),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(x,{grow:!1},i.a.createElement(v,null)),i.a.createElement(T,{grow:!1},i.a.createElement(u.EuiPopover,{button:i.a.createElement(u.EuiButtonIcon,{onClick:y,iconType:"controlsVertical",isDisabled:c,"aria-label":"eql settings","data-test-subj":"eql-settings-trigger"}),isOpen:c,closePopover:E,anchorPosition:"downCenter",ownFocus:!1},i.a.createElement(u.EuiPopoverTitle,null,f.j),i.a.createElement("div",{style:{width:"300px"}},!a&&i.a.createElement(u.EuiFormRow,{label:f.h,helpText:f.g},i.a.createElement(u.EuiFieldNumber,{value:p,onChange:M,min:1,max:1e4})),i.a.createElement(u.EuiFormRow,{label:f.b,helpText:f.a},i.a.createElement(u.EuiComboBox,{options:null==s?void 0:s.keywordFields,selectedOptions:D,singleSelection:O,onChange:j})),i.a.createElement(u.EuiFormRow,{label:f.d,helpText:f.c},i.a.createElement(u.EuiComboBox,{options:null==s?void 0:s.nonDateFields,selectedOptions:A,singleSelection:O,onChange:I})),i.a.createElement(u.EuiFormRow,{label:f.f,helpText:f.e},i.a.createElement(u.EuiComboBox,{options:null==s?void 0:s.dateFields,selectedOptions:F,singleSelection:O,onChange:C}))))))))};var I=a(529);const C=o()(u.EuiTextArea).withConfig({displayName:"TextArea",componentId:"sc-4u43ce-0"})(["display:block;border:",";border-bottom:0;box-shadow:none;min-height:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiFormControlHeight)),M=({dataTestSubj:e,field:t,isLoading:a=!1,indexPattern:r,showFilterBar:o,idAria:l,optionsData:p,optionsSelected:b,isSizeOptionDisabled:h,onOptionsChange:E,onValidityChange:v,onValiditingChange:k})=>{const{addError:S}=Object(g.a)(),[T,x]=Object(n.useState)([]),{isValidating:w,value:O,setValue:M}=t,{isValid:D,message:A,messages:F,error:R}=Object(I.c)(t),{uiSettings:P}=Object(y.k)().services,_=Object(n.useRef)(new d.FilterManager(P));Object(n.useEffect)((()=>{null!=v&&v(D)}),[D,v]),Object(n.useEffect)((()=>{x(null!=F?F:[])}),[F]),Object(n.useEffect)((()=>{R&&S(R,{title:f.m})}),[R,S]),Object(n.useEffect)((()=>{k&&k(w)}),[w,k]),Object(n.useEffect)((()=>{let e=!0;const t=new s.Subscription;return _.current.setFilters([]),t.add(_.current.getUpdates$().subscribe({next:()=>{if(e){const e=_.current.getFilters(),{filters:t}=O;c()(t,e)||M({...O,filters:e})}}})),()=>{e=!1,t.unsubscribe()}}),[O,_,M]),Object(n.useEffect)((()=>{const{filters:e}=O;c()(e,_.current.getFilters())||_.current.setFilters(e)}),[O,_]);const q=Object(n.useCallback)((e=>{const t=e.target.value;k&&k(!0),x([]),M({filters:O.filters,query:{query:t,language:"eql"},saved_id:null})}),[O,M,k]);return i.a.createElement(u.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:A,isInvalid:!D&&!w,fullWidth:!0,"data-test-subj":e,describedByIds:l?[l]:void 0},i.a.createElement(i.a.Fragment,null,i.a.createElement(C,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:!0,isInvalid:!D&&!w,value:O.query.query,onChange:q}),i.a.createElement(j,{errors:T,isLoading:w,isSizeOptionDisabled:h,optionsData:p,optionsSelected:b,onOptionsChange:E}),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(u.EuiSpacer,{size:"s"}),i.a.createElement(m,{"data-test-subj":"eqlFilterBar",indexPattern:r,isLoading:a,isRefreshPaused:!1,filterQuery:O.query,filterManager:_.current,filters:_.current.getFilters()||[],displayStyle:"inPage"}))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(3),i=a(47),s=a(546),r=a(678),o=a(477),l=a(671),c=a(9),u=a(260),d=a(91),p=a(15),m=a(1),g=a(276),f=a(58),b=a(380);const h=()=>{const e=Object(i.useDispatch)(),t=Object(u.m)(),a=Object(b.b)();return(n,i,s)=>{const r=y(n,t,a);r&&i.setBreadcrumbs(r.map((t=>({...t,...t.href&&!t.onClick?{onClick:a=>{a.preventDefault(),e(d.a.showTimeline({id:p.i.active,show:!1})),s(t.href)}}:{}}))))}},y=(e,t,a)=>{const i=Object(n.omit)("navTabs",e);if(!i||!e.navTabs||!i.pageName||T(i)||O(i))return null;const s=((e,t,a,n)=>{const i=t({deepLinkId:c.a.landing});var s;return[{text:m.r,href:(s=i,`${s}${Object(g.a)(undefined)}`)},...Object(f.a)(e).map((({title:e,id:i})=>{const s=e,r=a[i]?a[i].name:e;return{text:n?s:r,href:t({deepLinkId:i})}}))]})(i.pageName,t,e.navTabs,a),r=s[s.length-1],o=s[0];return j([...a?s:[o,r],...E(i,t)])},E=(e,t)=>k(e)?Object(s.a)(e,t):v(e)?Object(r.b)(e,t):S(e)?Object(l.a)(e,t):w(e)?Object(o.c)(e,t):x(e)?((e,t)=>{let a=[];return null!=e.detailName&&(a=[{text:e.detailName,href:t({path:Object(u.e)(e.detailName,""),deepLinkId:c.a.kubernetes})}]),a})(e,t):[],v=e=>e.pageName===c.a.network,k=e=>e.pageName===c.a.hosts,S=e=>e.pageName===c.a.users,T=e=>e.pageName===c.a.case,x=e=>e.pageName===c.a.kubernetes,w=e=>e.pageName===c.a.rules||e.pageName===c.a.rulesCreate,O=e=>e.pageName===c.a.cloudSecurityPostureRules,j=e=>{const t=e.slice(0,-1),a=Object(n.last)(e);return a?[...t,{...a,href:""}]:e}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return ae}));var n=a(17),i=a(178),s=a(3),r=a(4),o=a.n(r),l=a(24),c=a.n(l),u=a(213),d=a(77),p=a(1),m=a(19),g=a(203),f=a(337),b=a(499),h=a(227),y=a(249),E=a(204),v=a(254),k=a(224),S=a(498),T=a(98),x=a(6);const w=x.i18n.translate("xpack.securitySolution.host.details.overview.hostIdTitle",{defaultMessage:"Host ID"}),O=x.i18n.translate("xpack.securitySolution.host.details.firstSeenTitle",{defaultMessage:"First seen"}),j=x.i18n.translate("xpack.securitySolution.host.details.lastSeenTitle",{defaultMessage:"Last seen"}),I=x.i18n.translate("xpack.securitySolution.host.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),C=x.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskScoreTitle",{defaultMessage:"Host risk score"}),M=x.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskClassification",{defaultMessage:"Host risk classification"}),D=x.i18n.translate("xpack.securitySolution.host.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),A=x.i18n.translate("xpack.securitySolution.host.details.overview.macAddressesTitle",{defaultMessage:"MAC addresses"}),F=x.i18n.translate("xpack.securitySolution.host.details.overview.platformTitle",{defaultMessage:"Platform"}),R=x.i18n.translate("xpack.securitySolution.host.details.overview.osTitle",{defaultMessage:"Operating system"}),P=x.i18n.translate("xpack.securitySolution.host.details.overview.familyTitle",{defaultMessage:"Family"}),_=x.i18n.translate("xpack.securitySolution.host.details.versionLabel",{defaultMessage:"Version"}),q=x.i18n.translate("xpack.securitySolution.host.details.architectureLabel",{defaultMessage:"Architecture"}),N=x.i18n.translate("xpack.securitySolution.host.details.overview.cloudProviderTitle",{defaultMessage:"Cloud provider"}),L=x.i18n.translate("xpack.securitySolution.host.details.overview.regionTitle",{defaultMessage:"Region"}),B=x.i18n.translate("xpack.securitySolution.host.details.overview.instanceIdTitle",{defaultMessage:"Instance ID"}),z=x.i18n.translate("xpack.securitySolution.host.details.overview.machineTypeTitle",{defaultMessage:"Machine type"}),H=x.i18n.translate("xpack.securitySolution.host.details.overview.inspectTitle",{defaultMessage:"Host overview"});var $=a(388);const V=x.i18n.translate("xpack.securitySolution.host.details.endpoint.endpointPolicy",{defaultMessage:"Endpoint integration policy"}),U=x.i18n.translate("xpack.securitySolution.host.details.endpoint.policyStatus",{defaultMessage:"Policy Status"}),Q=x.i18n.translate("xpack.securitySolution.host.details.endpoint.sensorversion",{defaultMessage:"Endpoint version"}),W=x.i18n.translate("xpack.securitySolution.host.details.endpoint.fleetAgentStatus",{defaultMessage:"Agent status"});var G=a(107),K=a(561),J=a(362);const Y=o.a.memo((({contextID:e,data:t})=>{const a=Object(r.useCallback)(((t,a,n)=>o.a.createElement(f.a,{rowItems:[Object(s.getOr)("",t,a)],attrName:n,idPrefix:e?`endpoint-overview-${e}`:"endpoint-overview"})),[e]),i=Object(r.useMemo)((()=>{var e,i,s,r,l,c,u,d,p,m;return[[{title:V,description:null!=t&&null!=t.endpointPolicy?t.endpointPolicy:Object(g.d)()}],[{title:U,description:null!=t&&null!=t.policyStatus?o.a.createElement(n.EuiHealth,{"aria-label":t.policyStatus,color:t.policyStatus===G.a.failure?"danger":t.policyStatus},t.policyStatus):Object(g.d)()}],[{title:Q,description:null!=t&&null!=t.sensorVersion?a("sensorVersion",t,"agent.version"):Object(g.d)()}],[{title:W,description:null!=t&&t.elasticAgentStatus?o.a.createElement(o.a.Fragment,null,o.a.createElement(K.a,{hostStatus:t.elasticAgentStatus}),o.a.createElement(J.b,{isIsolated:Boolean(t.isolation),pendingActions:{pendingIsolate:null!==(e=null===(i=t.pendingActions)||void 0===i?void 0:i.isolate)&&void 0!==e?e:0,pendingUnIsolate:null!==(s=null===(r=t.pendingActions)||void 0===r?void 0:r.unisolate)&&void 0!==s?s:0,pendingKillProcess:null!==(l=null===(c=t.pendingActions)||void 0===c?void 0:c["kill-process"])&&void 0!==l?l:0,pendingSuspendProcess:null!==(u=null===(d=t.pendingActions)||void 0===d?void 0:d["suspend-process"])&&void 0!==u?u:0,pendingRunningProcesses:null!==(p=null===(m=t.pendingActions)||void 0===m?void 0:m["running-processes"])&&void 0!==p?p:0}})):Object(g.d)()}]]}),[t,a]);return o.a.createElement(o.a.Fragment,null,i.map(((e,t)=>o.a.createElement($.a,{dataTestSubj:"endpoint-overview",descriptionList:e,key:t}))))}));Y.displayName="EndpointOverview";var X=a(342),Z=a(275),ee=a(338);const te=c()(n.EuiFlexGroup).withConfig({displayName:"HostRiskOverviewWrapper",componentId:"sc-16e3omv-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),ae=o.a.memo((({anomaliesData:e,contextID:t,data:a,endDate:l,id:c,isDraggable:x=!1,isInDetailsSidePanel:V=!1,isLoadingAnomaliesData:U,indexNames:Q,loading:W,narrowDateRange:G,startDate:K,hostName:J})=>{const ae=Object(k.a)(),ne=Object(v.a)(ae),[ie]=Object(m.q)(p.M),se=Object(r.useMemo)((()=>J?Object(d.B)([J]):void 0),[J]),{from:re,to:oe}=Object(u.a)(),le=Object(r.useMemo)((()=>({from:re,to:oe})),[re,oe]),[ce,{data:ue,isLicenseValid:de}]=Object(X.c)({filterQuery:se,skip:null==J,timerange:le}),pe=Object(r.useCallback)(((e,a)=>o.a.createElement(f.a,{rowItems:Object(s.getOr)([],e,a),attrName:e,idPrefix:t?`host-overview-${t}`:"host-overview",isDraggable:x})),[t,x]),[me,ge]=Object(r.useMemo)((()=>{const e=ue&&ue.length>0?ue[0]:void 0;return[{title:o.a.createElement(ee.a,{title:C,riskScoreEntity:d.v.host}),description:o.a.createElement(o.a.Fragment,null,e?Math.round(e.host.risk.calculated_score_norm):Object(g.d)())},{title:o.a.createElement(ee.a,{title:M,riskScoreEntity:d.v.host}),description:o.a.createElement(o.a.Fragment,null,e?o.a.createElement(Z.b,{severity:e.host.risk.calculated_level,hideBackgroundColor:!0}):Object(g.d)())}]}),[ue]),fe=Object(r.useMemo)((()=>[{title:w,description:a&&a.host?Object(f.e)({host:a.host,isDraggable:x,noLink:!0}):Object(g.d)()},{title:O,description:o.a.createElement(b.a,{indexPatterns:Q,field:"host.name",value:J,type:b.b.FIRST_SEEN})},{title:j,description:o.a.createElement(b.a,{indexPatterns:Q,field:"host.name",value:J,type:b.b.LAST_SEEN})}]),[a,Q,J,x]),be=Object(r.useMemo)((()=>ne?[...fe,{title:I,description:o.a.createElement(S.a,{anomalies:e,startDate:K,endDate:l,isLoading:U,narrowDateRange:G})}]:fe),[e,fe,l,U,G,K,ne]),he=Object(r.useMemo)((()=>[be,[{title:D,description:o.a.createElement(f.a,{rowItems:Object(s.getOr)([],"host.ip",a),attrName:"host.ip",idPrefix:t?`host-overview-${t}`:"host-overview",isDraggable:x,render:e=>null!=e?o.a.createElement(E.h,{ip:e}):Object(g.d)()})},{title:A,description:pe("host.mac",a)},{title:F,description:pe("host.os.platform",a)}],[{title:R,description:pe("host.os.name",a)},{title:P,description:pe("host.os.family",a)},{title:_,description:pe("host.os.version",a)},{title:q,description:pe("host.architecture",a)}],[{title:N,description:pe("cloud.provider",a)},{title:L,description:pe("cloud.region",a)},{title:B,description:pe("cloud.instance.id",a)},{title:z,description:pe("cloud.machine.type",a)}]]),[t,a,be,pe,x]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.c,null,o.a.createElement(T.g,{direction:V?"column":"row","data-test-subj":"host-overview"},!V&&o.a.createElement(h.b,{queryId:c,title:H,inspectIndex:0}),he.map(((e,t)=>o.a.createElement($.a,{descriptionList:e,key:t}))),W&&o.a.createElement(y.a,{overlay:!0,overlayBackground:ie?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))),de&&o.a.createElement(te,{gutterSize:V?"m":"none",direction:V?"column":"row","data-test-subj":"host-risk-overview",$width:V?"100%":"50%"},o.a.createElement(n.EuiFlexItem,null,o.a.createElement(T.d,{listItems:[me]})),o.a.createElement(n.EuiFlexItem,null,o.a.createElement(T.d,{listItems:[ge]}))),a&&null!=a.endpoint?o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiHorizontalRule,null),o.a.createElement(T.g,{direction:V?"column":"row"},o.a.createElement(Y,{contextID:t,data:a.endpoint}),W&&o.a.createElement(y.a,{overlay:!0,overlayBackground:ie?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))):null)}));ae.displayName="HostOverview"},,function(e,t,a){"use strict";a.d(t,"a",(function(){return k})),a.d(t,"b",(function(){return T}));var n=a(4),i=a.n(n),s=a(24),r=a.n(s),o=a(689),l=a(17),c=a(19);const u=({integration:e})=>{const t=Object(c.e)(),a=e.integrationTitle,n=`${t}/${e.targetUrl}`;return i.a.createElement(l.EuiLink,{href:n,target:"_blank","data-test-subj":"integrationLink"},a)},d=i.a.memo(u);d.displayName="IntegrationLink";var p=a(522);const m=r()(l.EuiBadge).withConfig({displayName:"PaddedBadge",componentId:"sc-q84pbl-0"})(["margin-left:5px;"]),g=({integration:e})=>{const{installationStatus:t}=e;if(!t.isKnown)return null;const{isInstalled:a,isEnabled:n}=t,s=a?"success":"#E0E5EE",r=a?n?p.c:p.e:p.j,o=a?n?p.b:p.d:p.i;return i.a.createElement(l.EuiToolTip,{content:r},i.a.createElement(m,{color:s,"data-test-subj":"statusBadge"},o))},f=i.a.memo(g);f.displayName="IntegrationStatusBadge";const b=r.a.span.withConfig({displayName:"VersionWarningIconContainer",componentId:"sc-1qsec7-0"})(["margin-left:5px;"]),h=({integration:e})=>{const{installationStatus:t}=e;return t.isKnown&&t.isInstalled&&t.isVersionMismatch?i.a.createElement(b,null,i.a.createElement(l.EuiIconTip,{type:"alert",color:"warning",content:p.f(t.installedVersion,e.requiredVersion)})):null},y=i.a.memo(h);y.displayName="IntegrationVersionMismatchIcon";const E=r.a.div.withConfig({displayName:"Wrapper",componentId:"sc-ea1y1-0"})(["overflow:hidden;"]),v=({integration:e})=>i.a.createElement(E,null,i.a.createElement(d,{integration:e})," ",i.a.createElement(f,{integration:e}),i.a.createElement(y,{integration:e})),k=i.a.memo(v),S=({relatedIntegrations:e})=>{const{integrations:t}=Object(o.a)(e);return i.a.createElement(i.a.Fragment,null,t.map(((e,t)=>i.a.createElement(k,{key:`${e.packageName}-${t}`,integration:e}))))},T=(e,t)=>null==t||0===t.length?[]:[{title:e,description:i.a.createElement(S,{relatedIntegrations:t})}]},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(854),i=a.n(n),s=a(3),r=a(6);const o=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(s.startCase)(t):""},l=e=>{const t=[];return Object.entries(e).forEach((([e,a])=>{if(Object(s.isString)(a))try{i.a.render(a,{})}catch(a){t.push((e=>r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(s.startCase)(e)}}))(e))}})),t},c=async(e,t)=>{const a=await(async(e,t)=>{var a;const n=await(null===(a=t.get(e.actionTypeId))||void 0===a?void 0:a.validateParams(e.params));if(n){const e=Object.values(n.errors);if(e.length){const t=e.filter((e=>Object(s.isString)(e)||Object(s.isArray)(e))),a=Object(s.uniq)(Object(s.flattenDeep)(t));if(a.length)return a}}return[]})(e,t);return[...a,...l(e.params)]},u=e=>async(...t)=>{const[{value:a,path:n}]=t,i=[];for(const t of a){const a=await c(t,e);if(a.length){const e=o(t.actionTypeId),n=a.map((e=>`*   ${e}\n`));i.push(`\n**${e}:**\n${n.join("")}`)}}if(i.length)return{code:"ERR_FIELD_FORMAT",path:n,message:`${i.join("\n")}`}}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return A}));var n=a(4),i=a.n(n),s=a(17),r=a(178),o=a(47),l=a(24),c=a.n(l),u=a(8),d=a(96),p=a(76),m=a(15),g=a(91),f=a(94),b=a(497),h=a(82),y=a(56),E=a(608);function v(e){return e?{timeRange:{from:e.from,to:e.to}}:[]}var k=a(603);const S=i.a.memo((e=>{const t=Object(y.useKibana)(),a=Object(n.useMemo)((()=>function(e){return{relatedEvents:async({entityID:t,timeRange:a,indexPatterns:n})=>({...await e.services.http.post("/api/endpoint/resolver/events",{query:{},body:JSON.stringify({indexPatterns:n,...v(a),filter:JSON.stringify({bool:{filter:[{term:{"process.entity_id":t}},{bool:{must_not:{term:{"event.category":"process"}}}}]}})})}),entityID:t}),eventsWithEntityIDAndCategory({entityID:t,category:a,after:n,timeRange:i,indexPatterns:s}){const r={query:{afterEvent:n,limit:25},body:{...v(i),indexPatterns:s}};return"alert"===a?e.services.http.post("/api/endpoint/resolver/events",{query:r.query,body:JSON.stringify({...r.body,entityType:"alerts",eventID:t})}):e.services.http.post("/api/endpoint/resolver/events",{query:r.query,body:JSON.stringify({...r.body,filter:JSON.stringify({bool:{filter:[{term:{"process.entity_id":t}},{term:{"event.category":a}}]}})})})},async nodeData({ids:t,timeRange:a,indexPatterns:n,limit:i}){const s={query:{limit:i},body:JSON.stringify({indexPatterns:n,...v(a),filter:JSON.stringify({bool:{filter:[{terms:{"process.entity_id":t}},{term:{"event.category":"process"}}]}})})};return(await e.services.http.post("/api/endpoint/resolver/events",s)).events},async event({nodeID:t,eventID:a,eventCategory:n,eventTimestamp:i,winlogRecordID:s,timeRange:r,indexPatterns:o}){const l=void 0===a?{bool:{filter:[{terms:{"event.category":n}},{term:{"process.entity_id":t}},{term:{"@timestamp":i}},{term:{"winlog.record_id":s}}]}}:{bool:{filter:[{term:{"event.id":a}}]}};if(!1===n.includes("alert")){const t=await e.services.http.post("/api/endpoint/resolver/events",{query:{limit:1},body:JSON.stringify({indexPatterns:o,...v(r),filter:JSON.stringify(l)})}),[a]=t.events;return null!=a?a:null}{const t=await e.services.http.post("/api/endpoint/resolver/events",{query:{limit:1},body:JSON.stringify({indexPatterns:o,...v(r),entityType:"alertDetail",eventID:a})}),[n]=t.events;return null!=n?n:null}},resolverTree:async({dataId:t,schema:a,timeRange:n,indices:i,ancestors:s,descendants:r})=>e.services.http.post("/api/endpoint/resolver/tree",{body:JSON.stringify({ancestors:s,descendants:r,timeRange:n,schema:a,nodes:[t],indexPatterns:i})}),entities:async({_id:t,indices:a,signal:n})=>e.services.http.get("/api/endpoint/resolver/entity",{signal:n,query:{_id:t,indices:a}})}}(t)),[t]),s=Object(n.useMemo)((()=>Object(E.a)(a)),[a]),[r,l]=Object(n.useState)(s);return Object(n.useEffect)((()=>{e.shouldUpdate&&l(Object(E.a)(a))}),[a,e.shouldUpdate]),i.a.createElement(o.Provider,{store:r},i.a.createElement(k.a,e))}));var T=a(738);const x="sessionViewFullScreen",w=Object(l.css)(["display:flex;flex-direction:column;flex:1;width:100%;"]),O=c.a.div.withConfig({displayName:"OverlayContainer",componentId:"sc-g96n2a-0"})(["",""],w),j=Object(l.css)(["position:fixed;top:0;bottom:2em;left:0;right:0;z-index:",";"],r.euiThemeVars.euiZLevel3),I=c.a.div.withConfig({displayName:"FullScreenOverlayContainer",componentId:"sc-g96n2a-1"})(["",""],j),C=c()(S).withConfig({displayName:"StyledResolver",componentId:"sc-g96n2a-2"})(["height:100%;"]),M=c()(s.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-g96n2a-3"})([""," overflow:hidden;width:100%;&.","{","}"],(({theme:e})=>`background-color: ${e.eui.euiColorEmptyShade};`),x,(({theme:e})=>`padding: 0 ${e.eui.euiSizeM}`)),D=({timelineId:e,SessionView:t,Navigation:a})=>{const r=Object(o.useDispatch)(),{globalFullScreen:l}=Object(d.a)(),{timelineFullScreen:c}=Object(d.c)(),y=Object(n.useMemo)((()=>g.b.getTimelineByIdSelector()),[]),{graphEventId:E,sessionViewConfig:v}=Object(p.a)((t=>{var a;return null!==(a=y(t,e))&&void 0!==a?a:f.a})),k=Object(n.useMemo)((()=>Object(b.b)({globalFullScreen:l,timelineId:e,timelineFullScreen:c})),[l,e,c]),S=e===m.i.active;Object(n.useEffect)((()=>()=>{r(g.a.updateTimelineGraphEventId({id:e,graphEventId:""})),e===m.i.active?r(h.b.setFullScreen({id:u.a.timeline,fullScreen:!1})):r(h.b.setFullScreen({id:u.a.global,fullScreen:!1}))}),[r,e]);const{from:D,to:A,shouldUpdate:F,selectedPatterns:R}=Object(T.a)(e),P=Object(n.useRef)(null);return Object(n.useLayoutEffect)((()=>{k&&P.current?P.current.setAttribute("style",j.join("")):P.current&&P.current.setAttribute("style",w.join(""))}),[k]),S||null===v?k&&!S?i.a.createElement(I,{"data-test-subj":"overlayContainer"},i.a.createElement(s.EuiHorizontalRule,{margin:"none"}),i.a.createElement(s.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(s.EuiFlexItem,{grow:!1},a)),i.a.createElement(s.EuiHorizontalRule,{margin:"none"}),void 0!==E?i.a.createElement(C,{databaseDocumentID:E,resolverComponentInstanceID:e,indices:R,shouldUpdate:F,filters:{from:D,to:A}}):i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",style:{height:"100%"}},i.a.createElement(s.EuiLoadingSpinner,{size:"xl"}))):i.a.createElement(O,{"data-test-subj":"overlayContainer"},i.a.createElement(s.EuiHorizontalRule,{margin:"none"}),i.a.createElement(s.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(s.EuiFlexItem,{grow:!1},a)),i.a.createElement(s.EuiHorizontalRule,{margin:"none"}),void 0!==E?i.a.createElement(C,{databaseDocumentID:E,resolverComponentInstanceID:e,indices:R,shouldUpdate:F,filters:{from:D,to:A}}):i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",style:{height:"100%"}},i.a.createElement(s.EuiLoadingSpinner,{size:"xl"}))):i.a.createElement(O,{"data-test-subj":"overlayContainer",ref:P},i.a.createElement(s.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",direction:"column"},i.a.createElement(s.EuiHorizontalRule,{margin:"none"}),i.a.createElement(s.EuiFlexItem,{grow:!1},a),i.a.createElement(s.EuiHorizontalRule,{margin:"none"}),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(M,{grow:2,className:k?x:""},t)))},A=i.a.memo(D)},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(4),i=a(5),s=a(764),r=a.n(s);const o=(e,t)=>null==t?`${Object(i.capitalize)(e)}`:`${Object(i.capitalize)(e)} ${Object(i.capitalize)(t)}`,l=e=>{var t;return null!==(t=r.a.valid(r.a.coerce(e)))&&void 0!==t?t:""},c=(e,t,a)=>`app/integrations/detail/${a?`${e}-${a}`:e}/overview${t?`?integration=${t}`:""}`;var u=a(218),d=a(244);const p=e=>{const{data:t}=(({packages:e})=>Object(u.useQuery)(["installedIntegrations",{packages:e}],(async({signal:t})=>{var a;return null!==(a=(await Object(d.c)({packages:e,signal:t})).installed_integrations)&&void 0!==a?a:[]}),{keepPreviousData:!0,staleTime:3e5,onError:e=>{}}))({packages:[]});return Object(n.useMemo)((()=>{const a=((e,t)=>((e,t)=>e.map((e=>{if(null==t)return{related:e,installed:null,isLoaded:!1};{const a=t.find((t=>t.package_name===e.package&&(null==t?void 0:t.integration_name)===(null==e?void 0:e.integration)));return{related:e,installed:null!=a?a:null,isLoaded:!0}}})))(e,t).map((e=>(e=>{var t;const{related:a,installed:n,isLoaded:i}=e,s=a.package,u=null!==(t=a.integration)&&void 0!==t?t:null,d=a.version;if(!i){const e=o(s,u),t=l(d);return{packageName:s,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:t,targetUrl:c(s,u,t),installationStatus:{isKnown:!1}}}if(null==n){const e=o(s,u),t=l(d);return{packageName:s,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:t,targetUrl:c(s,u,t),installationStatus:{isKnown:!0,isInstalled:!1,isEnabled:!1,isVersionMismatch:!1,installedVersion:""}}}{var p;const e=null!==(p=n.integration_title)&&void 0!==p?p:n.package_title,t=n.package_version,a=r.a.satisfies(t,d),i=a?t:l(d);return{packageName:s,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:i,targetUrl:c(s,u,i),installationStatus:{isKnown:!0,isInstalled:!0,isEnabled:n.is_enabled,isVersionMismatch:!a,installedVersion:t}}}})(e))).sort(((e,t)=>e.integrationTitle.localeCompare(t.integrationTitle))))(e,t);return{integrations:a,isLoaded:null!=t}}),[e,t])}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return q}));var n=a(3),i=a(4),s=a.n(i),r=a(47),o=a(177),l=a(534),c=a(207),u=a(238),d=a(296),p=a(609),m=a(19),g=a(78),f=a(13),b=a(36),h=a(423),y=a(377),E=a(253),v=a(91),k=a(94),S=a(855),T=a(17),x=a(24),w=a.n(x),O=a(419),j=a(758);const I=w()(T.EuiFlexGroup).withConfig({displayName:"UtilityBarFlexGroup",componentId:"sc-srl83m-0"})(["min-width:175px;"]),C=w()(T.EuiFlexItem).withConfig({displayName:"AdditionalFiltersItem",componentId:"sc-srl83m-1"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),M=w()(C).withConfig({displayName:"BuildingBlockContainer",componentId:"sc-srl83m-2"})(["background:",";"],(({theme:e})=>e.eui.euiColorHighlight)),D=({areEventsLoading:e,onShowBuildingBlockAlertsChanged:t,showBuildingBlockAlerts:a,onShowOnlyThreatIndicatorAlertsChanged:n,showOnlyThreatIndicatorAlerts:r})=>{const o=Object(i.useCallback)((e=>s.a.createElement(I,{direction:"column",gutterSize:"none"},s.a.createElement(M,null,s.a.createElement(T.EuiCheckbox,{id:"showBuildingBlockAlertsCheckbox","aria-label":"showBuildingBlockAlerts",onChange:a=>{e(),t(a.target.checked)},checked:a,color:"text","data-test-subj":"showBuildingBlockAlertsCheckbox",label:j.b})),s.a.createElement(C,null,s.a.createElement(T.EuiCheckbox,{id:"showOnlyThreatIndicatorAlertsCheckbox","aria-label":"showOnlyThreatIndicatorAlerts",onChange:t=>{e(),n(t.target.checked)},checked:r,color:"text","data-test-subj":"showOnlyThreatIndicatorAlertsCheckbox",label:j.c})))),[t,n,a,r]);return s.a.createElement(O.b,{dataTestSubj:"additionalFilters",disabled:e,iconType:"arrowDown",iconSide:"right",ownFocus:!0,popoverContent:o},j.a)};var A=a(349),F=a(760),R=a(259),P=a(79);const _=({defaultFilters:e,from:t,globalFilters:a,globalQuery:g,hasIndexMaintenance:k,hasIndexWrite:T,isSelectAllChecked:x,loading:w,loadingEventIds:O,onRuleChange:j,onShowBuildingBlockAlertsChanged:I,onShowOnlyThreatIndicatorAlertsChanged:C,showBuildingBlockAlerts:M,showOnlyThreatIndicatorAlerts:_,timelineId:q,to:N,filterGroup:L="open"})=>{var B,z;const H=Object(r.useDispatch)(),{browserFields:$,indexPattern:V,selectedPatterns:U}=Object(c.d)(f.SourcererScopeName.detections),Q=Object(m.k)(),W=Object(P.b)(),G=Object(P.b)().isEnterprise()?5:4,K=Object(i.useCallback)((n=>null!=$&&null!=V?Object(E.a)({config:Object(o.getEsQueryConfig)(Q.services.uiSettings),dataProviders:[],indexPattern:V,browserFields:$,filters:[...null!=e?e:[],...a,...n,...Object(F.a)(t,N)],kqlQuery:g,kqlMode:g.language}):null),[$,e,a,g,V,Q,N,t]);Object(d.a)({id:q,filterQuery:null===(B=K([]))||void 0===B?void 0:B.filterQuery,kqlError:null===(z=K([]))||void 0===z?void 0:z.kqlError,query:g,startDate:t,endDate:N}),Object(i.useEffect)((()=>{x&&H(v.a.setTGridSelectAll({id:q,selectAll:!1}))}),[H,x,q]);const J=Object(i.useMemo)((()=>s.a.createElement(D,{areEventsLoading:O.length>0,onShowBuildingBlockAlertsChanged:I,showBuildingBlockAlerts:M,onShowOnlyThreatIndicatorAlertsChanged:C,showOnlyThreatIndicatorAlerts:_})),[O.length,I,C,M,_]),Y=Object(i.useMemo)((()=>{const t=Object(A.a)(L);return Object(n.isEmpty)(e)?t:null==e||Object(n.isEmpty)(e)?void 0:[...e,...t]}),[e,L]),{filterManager:X}=Object(m.k)().services.data.query,Z=Object(u.a)("tGridEnabled");Object(i.useEffect)((()=>{H(v.a.initializeTGridSettings({defaultColumns:Object(S.b)(W).map((e=>Z||null!=e.initialWidth?e:{...e,initialWidth:b.a})),documentType:R.k,excludedRowRendererIds:Object(A.f)(W).excludedRowRendererIds,filterManager:X,footerText:R.B,id:q,loadingText:R.x,selectAll:!1,queryFields:A.h,title:"",showCheckboxes:!0}))}),[H,X,Z,q,W]);const ee=Object(i.useMemo)((()=>Object(h.a)(G)),[G]);return w||Object(n.isEmpty)(U)?null:s.a.createElement(l.a,{additionalFilters:J,currentFilter:L,defaultCellActions:p.a,defaultModel:Object(A.f)(W),end:N,entityType:"events",hasAlertsCrud:T&&k,id:q,leadingControlColumns:ee,onRuleChange:j,pageFilters:Y,renderCellValue:S.a,rowRenderers:y.b,scopeId:f.SourcererScopeName.detections,start:t})},q=Object(r.connect)((()=>{const e=v.b.getTimelineByIdSelector(),t=g.f.globalSelector();return(a,n)=>{var i;const{timelineId:s}=n,r=null!==(i=e(a,s))&&void 0!==i?i:k.a,{deletedEventIds:o,isSelectAllChecked:l,loadingEventIds:c,selectedEventIds:u}=r,d=t(a),{query:p,filters:m}=d;return{globalQuery:p,globalFilters:m,deletedEventIds:o,isSelectAllChecked:l,loadingEventIds:c,selectedEventIds:u}}}))(s.a.memo(_))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(4),i=a(107),s=a(6);s.i18n.translate("xpack.securitySolution.overviewHost.errorSearchDescription",{defaultMessage:"An error has occurred on host overview search"});const r=s.i18n.translate("xpack.securitySolution.overviewHost.failSearchDescription",{defaultMessage:"Failed to run search on host overview"});var o=a(240);const l="hostsDetailsQuery",c=({endDate:e,hostName:t,indexNames:a,id:s=l,skip:c=!1,startDate:u})=>{const{loading:d,result:p,search:m,refetch:g,inspect:f}=Object(o.a)({factoryQueryType:i.d.details,initialResult:{hostDetails:{}},errorMessage:r,abort:c}),b=Object(n.useMemo)((()=>({endDate:e,hostDetails:p.hostDetails,id:s,inspect:f,isInspected:!1,refetch:g,startDate:u})),[e,p.hostDetails,s,f,g,u]),h=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:i.d.details,hostName:t,timerange:{interval:"12h",from:u,to:e}})),[e,t,a,u]);return Object(n.useEffect)((()=>{c||m(h)}),[h,m,c]),[d,b]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return z}));var n=a(17),i=a(178),s=a(3),r=a(4),o=a.n(r),l=a(24),c=a.n(l),u=a(213),d=a(77),p=a(1),m=a(19),g=a(203),f=a(337),b=a(499),h=a(227),y=a(249),E=a(204),v=a(254),k=a(224),S=a(498),T=a(98),x=a(6);const w=x.i18n.translate("xpack.securitySolution.user.details.overview.userIdTitle",{defaultMessage:"User ID"}),O=x.i18n.translate("xpack.securitySolution.user.details.overview.userDomainTitle",{defaultMessage:"Domain"}),j=x.i18n.translate("xpack.securitySolution.user.details.overview.familyTitle",{defaultMessage:"Family"}),I=x.i18n.translate("xpack.securitySolution.user.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),C=x.i18n.translate("xpack.securitySolution.user.details.overview.osTitle",{defaultMessage:"Operating system"}),M=x.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),D=x.i18n.translate("xpack.securitySolution.user.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),A=x.i18n.translate("xpack.securitySolution.user.details.overview.inspectTitle",{defaultMessage:"User overview"}),F=x.i18n.translate("xpack.securitySolution.user.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),R=x.i18n.translate("xpack.securitySolution.user.details.overview.userRiskScoreTitle",{defaultMessage:"User risk score"}),P=x.i18n.translate("xpack.securitySolution.user.details.overview.userRiskClassification",{defaultMessage:"User risk classification"});var _=a(388),q=a(342),N=a(275),L=a(338);const B=c()(n.EuiFlexGroup).withConfig({displayName:"UserRiskOverviewWrapper",componentId:"sc-enfgw9-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),z=o.a.memo((({anomaliesData:e,contextID:t,data:a,id:l,isDraggable:c=!1,isInDetailsSidePanel:x=!1,isLoadingAnomaliesData:z,loading:H,narrowDateRange:$,startDate:V,endDate:U,userName:Q,indexPatterns:W})=>{const G=Object(k.a)(),K=Object(v.a)(G),[J]=Object(m.q)(p.M),Y=Object(r.useMemo)((()=>Q?Object(d.C)([Q]):void 0),[Q]),{from:X,to:Z}=Object(u.a)(),ee=Object(r.useMemo)((()=>({from:X,to:Z})),[X,Z]),[te,{data:ae,isLicenseValid:ne}]=Object(q.e)({filterQuery:Y,skip:null==Q,timerange:ee}),ie=Object(r.useCallback)(((e,a)=>o.a.createElement(f.a,{rowItems:Object(s.getOr)([],e,a),attrName:e,idPrefix:t?`user-overview-${t}`:"user-overview",isDraggable:c})),[t,c]),[se,re]=Object(r.useMemo)((()=>{const e=ae&&ae.length>0?ae[0]:void 0;return[{title:o.a.createElement(L.a,{title:R,riskScoreEntity:d.v.user}),description:o.a.createElement(o.a.Fragment,null,e?Math.round(e.user.risk.calculated_score_norm):Object(g.d)())},{title:o.a.createElement(L.a,{title:P,riskScoreEntity:d.v.host}),description:o.a.createElement(o.a.Fragment,null,e?o.a.createElement(N.b,{severity:e.user.risk.calculated_level,hideBackgroundColor:!0}):Object(g.d)())}]}),[ae]),oe=Object(r.useMemo)((()=>[{title:w,description:a&&a.user?ie("user.id",a):Object(g.d)()},{title:O,description:a&&a.user?ie("user.domain",a):Object(g.d)()}]),[a,ie]),le=Object(r.useMemo)((()=>K?[...oe,{title:F,description:o.a.createElement(S.a,{anomalies:e,startDate:V,endDate:U,isLoading:z,narrowDateRange:$})}]:oe),[e,oe,U,z,$,V,K]),ce=Object(r.useMemo)((()=>[le,[{title:M,description:o.a.createElement(b.a,{indexPatterns:W,field:"user.name",value:Q,type:b.b.FIRST_SEEN})},{title:D,description:o.a.createElement(b.a,{indexPatterns:W,field:"user.name",value:Q,type:b.b.LAST_SEEN})}],[{title:C,description:ie("host.os.name",a)},{title:j,description:ie("host.os.family",a)},{title:I,description:o.a.createElement(f.a,{rowItems:Object(s.getOr)([],"host.ip",a),attrName:"host.ip",idPrefix:t?`user-overview-${t}`:"user-overview",isDraggable:c,render:e=>null!=e?o.a.createElement(E.h,{ip:e}):Object(g.d)()})}]]),[a,W,ie,t,c,Q,le]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.c,null,o.a.createElement(T.g,{direction:x?"column":"row","data-test-subj":"user-overview"},!x&&o.a.createElement(h.b,{queryId:l,title:A,inspectIndex:0}),ce.map(((e,t)=>o.a.createElement(_.a,{descriptionList:e,key:t}))),H&&o.a.createElement(y.a,{overlay:!0,overlayBackground:J?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))),ne&&o.a.createElement(B,{gutterSize:x?"m":"none",direction:x?"column":"row","data-test-subj":"user-risk-overview",$width:x?"100%":"66.6%"},o.a.createElement(n.EuiFlexItem,null,o.a.createElement(T.d,{listItems:[se]})),o.a.createElement(n.EuiFlexItem,null,o.a.createElement(T.d,{listItems:[re]}))))}));z.displayName="UserOverview"},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4);const i=a(6).i18n.translate("xpack.securitySolution.userDetails.failSearchDescription",{defaultMessage:"Failed to run search on user details"});var s=a(109),r=a(240);const o=({endDate:e,userName:t,indexNames:a,id:o="usersDetailsQuery",skip:l=!1,startDate:c})=>{const{loading:u,result:d,search:p,refetch:m,inspect:g}=Object(r.a)({factoryQueryType:s.b.details,initialResult:{userDetails:{}},errorMessage:i,abort:l}),f=Object(n.useMemo)((()=>({endDate:e,userDetails:d.userDetails,id:o,inspect:g,isInspected:!1,refetch:m,startDate:c})),[e,o,g,m,d.userDetails,c]),b=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:s.b.details,userName:t,timerange:{interval:"12h",from:c,to:e}})),[e,a,c,t]);return Object(n.useEffect)((()=>{l||p(b)}),[b,p,l]),[u,f]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(3),i=a(17),s=a(4),r=a.n(s),o=a(385),l=a.n(o),c=a(792),u=a.n(c),d=a(24),p=a.n(d),m=a(195),g=a(210),f=a(19);const b=a(6).i18n.translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"}),h=p.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-1brsijn-0"})(["p{margin-bottom:0;}"]),y=p.a.div.attrs((({className:e="",$caseIndexes:t=[]})=>({className:e}))).withConfig({displayName:"ContainerActions",componentId:"sc-1brsijn-1"})(["",""],(({$caseIndexes:e})=>e.map((e=>`\n        div[id="${e}"].euiAccordion__childWrapper .euiAccordion__padding--l {\n          padding: 0px;\n          .euiFlexGroup {\n            display: none;\n          }\n          .euiSpacer.euiSpacer--xl {\n            height: 0px;\n          }\n        }\n      `)))),E=({field:e,messageVariables:t})=>{const[a,o]=Object(s.useState)(null),c=Object(g.l)(),{isSubmitted:d,isSubmitting:p,isValid:E}=c,{triggersActionsUi:{getActionForm:v}}=Object(f.k)().services,k=Object(s.useMemo)((()=>Object(n.isEmpty)(e.value)?[]:e.value),[e.value]),S=Object(s.useMemo)((()=>k.reduce(((e,t,a)=>".case"===t.actionTypeId?[...e,`${a}`]:e),[])),[k]),T=Object(s.useCallback)(((t,a)=>{const n=[...k];n[a]=l()(n[a],{id:t}),e.setValue(n)}),[e,k]),x=Object(s.useCallback)((t=>e.setValue(t)),[e]),w=Object(s.useCallback)(((t,a,n)=>{setTimeout((()=>e.setValue((e=>{const i=[...e];return i[n]={...i[n],params:{...i[n].params,[t]:a}},i}))),0)}),[e]),O=Object(s.useMemo)((()=>v({actions:k,messageVariables:t,defaultActionGroupId:"default",setActionIdByIndex:T,setActions:x,setActionParamsProperty:w,featureId:m.SecurityConnectorFeatureId,defaultActionMessage:"Rule {{context.rule.name}} generated {{state.signals_count}} alerts",hideActionHeader:!0})),[k,v,t,T,w,x]);return Object(s.useEffect)((()=>{if(p||!e.errors.length)return o(null);if(d&&!p&&!1===E&&e.errors.length){const t=e.errors.map((({message:e})=>e)).join("\n");return o(t)}}),[d,p,e.isChangingValue,E,e.errors,o]),r.a.createElement(y,{$caseIndexes:S},a?r.a.createElement(r.a.Fragment,null,r.a.createElement(h,null,r.a.createElement(i.EuiCallOut,{title:b,color:"danger",iconType:"alert"},r.a.createElement(u.a,null,a))),r.a.createElement(i.EuiSpacer,null)):null,O)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(17),i=a(4),s=a.n(i),r=a(24),o=a.n(r),l=a(742),c=a(370),u=a(15);const d=o()(n.EuiFieldText).withConfig({displayName:"StyledEuiFieldText",componentId:"sc-oqcycb-0"})(["padding-left:12px;padding-right:40px;&[readonly]{cursor:pointer;background-size:0 100%;background-repeat:no-repeat;&:focus{background-color:",";background-image:linear-gradient( to top,",","," 2px,transparent 2px,transparent 100% );background-size:100% 100%;}}& + .euiFormControlLayoutIcons{left:unset;right:12px;}"],(({theme:e})=>e.eui.euiFormBackgroundColor),(({theme:e})=>e.eui.euiFocusRingColor),(({theme:e})=>e.eui.euiFocusRingColor)),p=e=>[{description:c.a,favorite:[],label:c.b,id:void 0,title:c.b,checked:"-1"===e?"on":void 0}],m=({isDisabled:e,hideUntitled:t=!1,timelineId:a,timelineTitle:r,timelineType:o=u.m.template,onTimelineChange:m,placeholder:g})=>{const[f,b]=Object(i.useState)(!1),h=Object(i.useCallback)((()=>{b(!1)}),[]),y=Object(i.useCallback)((()=>{b(!0)}),[]),E=Object(i.useMemo)((()=>s.a.createElement(d,{readOnly:!0,disabled:e,onFocus:y,onClick:y,value:null!=r?r:c.b,icon:"arrowDown"})),[y,e,r]),v=Object(i.useCallback)((({timelines:e,onlyFavorites:n,searchTimelineValue:i})=>[...n||""!==i?[]:p(null==a?"-1":a),...e.filter((e=>!t||""!==e.title)).map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:o===u.m.template?e.templateTimelineId:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:[e.savedObjectId,e.templateTimelineId].includes(a)?"on":void 0})))]),[t,a,o]);return s.a.createElement(n.EuiInputPopover,{id:"searchTimelinePopover",input:E,isOpen:f,closePopover:h},s.a.createElement(l.a,{hideUntitled:t,getSelectableOptions:v,onClosePopover:h,onTimelineChange:m,timelineType:o,placeholder:g}))},g=Object(i.memo)(m);var f=a(210);const b=({dataTestSubj:e,field:t,idAria:a,isDisabled:r=!1,placeholder:o})=>{const[l,c]=Object(i.useState)(null),[u,d]=Object(i.useState)(null),{isInvalid:p,errorMessage:m}=Object(f.i)(t);Object(i.useEffect)((()=>{const{id:e,title:a}=t.value;l!==e&&(c(e),d(a))}),[t.value,l]);const b=Object(i.useCallback)(((e,a)=>{null===a?t.setValue({id:a,title:null}):l!==a&&t.setValue({id:a,title:e})}),[t,l]);return s.a.createElement(n.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:m,isInvalid:p,"data-test-subj":e,describedByIds:a?[a]:void 0},s.a.createElement(g,{isDisabled:r,hideUntitled:!0,timelineId:l,timelineTitle:u,onTimelineChange:b,placeholder:o}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(17),i=a(4),s=a.n(i),r=a(24),o=a.n(r),l=a(509),c=a(292);const u=o.a.span.withConfig({displayName:"LegendText",componentId:"sc-11u62u-0"})(["font-size:10.5px;"]),d=s.a.memo((({value:e})=>Object(c.a)(e)?s.a.createElement(u,null,e):s.a.createElement(u,{"data-test-subj":"value-wrapper-empty"},l.c)));d.displayName="ValueWrapper";const p=({legendItem:e})=>{const{color:t,value:a}=e;return s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=t&&s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiHealth,{"data-test-subj":"legend-color",color:t})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(d,{value:a}))))};p.displayName="LegendItemComponent";const m=s.a.memo(p),g=({legendItems:e})=>0===e.length?null:s.a.createElement(n.EuiText,{size:"xs","data-test-subj":"legend"},s.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"none"},e.map(((e,t)=>s.a.createElement(n.EuiFlexItem,{key:`legend-item-${t}`,grow:!1},s.a.createElement(m,{legendItem:e}),s.a.createElement(n.EuiSpacer,{"data-test-subj":"legend-spacer",size:"s"}))))));g.displayName="LegendComponent";const f=s.a.memo(g)},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(4),i=a.n(n),s=a(17),r=a(312),o=a(270),l=a(6),c=a(234),u=a(415),d=a(100);const p=Object(n.memo)((({endpointId:e})=>{var t;const{getAppUrl:a}=Object(d.b)(),{show:p,...m}=Object(r.b)(o.uiQueryParams),g=Object(n.useMemo)((()=>Object(c.d)({name:"endpointDetails",...m,selected_endpoint:e})),[m,e]),f=Object(u.a)(g),b=Object(n.useMemo)((()=>({title:l.i18n.translate("xpack.securitySolution.endpoint.policyResponse.backLinkTitle",{defaultMessage:"Endpoint details"}),href:a({path:g}),onClick:f})),[f,a,g]);return i.a.createElement("div",null,i.a.createElement(s.EuiButtonEmpty,{flush:"both","data-test-subj":"flyoutSubHeaderBackButton",iconType:"arrowLeft",size:"xs",href:null!==(t=null==b?void 0:b.href)&&void 0!==t?t:"",onClick:null==b?void 0:b.onClick},null==b?void 0:b.title))}));p.displayName="BackToEndpointDetailsFlyoutSubHeader";const m=Object(n.memo)((({endpointId:e,hasBorder:t=!1,hostname:a,children:n})=>{const l=Object(r.b)(o.detailsLoading);return i.a.createElement(s.EuiFlyoutHeader,{hasBorder:t},e&&i.a.createElement(p,{endpointId:e}),l?i.a.createElement(s.EuiLoadingContent,{lines:1}):i.a.createElement(s.EuiToolTip,{content:a,anchorClassName:"eui-textTruncate"},i.a.createElement(s.EuiTitle,{size:"s"},i.a.createElement("h2",{style:{overflow:"hidden",textOverflow:"ellipsis"},"data-test-subj":"endpointDetailsFlyoutTitle"},a))),n)}));m.displayName="EndpointDetailsFlyoutHeader"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"ed6ae68d913c232ecd384fa643fb5d97.svg"},function(e,t,a){e.exports=a.p+"9084b765fae17c788e62c5caa2fd0c56.svg"},function(e,t,a){e.exports=a.p+"b3f78a837df74b5c68f457351e9f23e3.svg"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=a(4),s=(n=a(737))&&"object"==typeof n&&"default"in n?n.default:n,r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},r(e,t)},o=function(){return o=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},l={top:{width:"100%",height:"10px",top:"-5px",left:"0px",cursor:"row-resize"},right:{width:"10px",height:"100%",top:"0px",right:"-5px",cursor:"col-resize"},bottom:{width:"100%",height:"10px",bottom:"-5px",left:"0px",cursor:"row-resize"},left:{width:"10px",height:"100%",top:"0px",left:"-5px",cursor:"col-resize"},topRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",top:"-10px",cursor:"ne-resize"},bottomRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",bottom:"-10px",cursor:"se-resize"},bottomLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",bottom:"-10px",cursor:"sw-resize"},topLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",top:"-10px",cursor:"nw-resize"}};function c(e){return i.createElement("div",{className:e.className||"",style:o({position:"absolute",userSelect:"none"},l[e.direction],e.replaceStyles||{}),onMouseDown:function(t){e.onResizeStart(t,e.direction)},onTouchStart:function(t){e.onResizeStart(t,e.direction)}},e.children)}var u={width:"auto",height:"auto"},d=s((function(e,t,a){return Math.max(Math.min(e,a),t)})),p=s((function(e,t){return Math.round(e/t)*t})),m=s((function(e,t){return new RegExp(e,"i").test(t)})),g=s((function(e,t,a){void 0===a&&(a=0);var n=t.reduce((function(a,n,i){return Math.abs(n-e)<Math.abs(t[a]-e)?i:a}),0),i=Math.abs(t[n]-e);return 0===a||i<a?t[n]:e})),f=s((function(e,t){return e.substr(e.length-t.length,t.length)===t})),b=s((function(e){return"auto"===(e=e.toString())||f(e,"px")||f(e,"%")||f(e,"vh")||f(e,"vw")||f(e,"vmax")||f(e,"vmin")?e:e+"px"})),h=function(e,t){if(e&&"string"==typeof e){if(f(e,"%"))return t*(Number(e.replace("%",""))/100);if(f(e,"vw")){var a=Number(e.replace("vw",""))/100;return window.innerWidth*a}if(f(e,"vh"))return a=Number(e.replace("vh",""))/100,window.innerHeight*a}return e},y=s((function(e,t,a,n,i){return t=h(t,e.width),a=h(a,e.height),n=h(n,e.width),i=h(i,e.height),{maxWidth:void 0===t?void 0:Number(t),maxHeight:void 0===a?void 0:Number(a),minWidth:void 0===n?void 0:Number(n),minHeight:void 0===i?void 0:Number(i)}})),E=["style","className","grid","snap","bounds","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],v="__resizable_base__",k=function(e){function t(t){var a=e.call(this,t)||this;return a.ratio=1,a.resizable=null,a.parentLeft=0,a.parentTop=0,a.resizableLeft=0,a.resizableTop=0,a.targetLeft=0,a.targetTop=0,a.state={isResizing:!1,resizeCursor:"auto",width:void 0===(a.propsSize&&a.propsSize.width)?"auto":a.propsSize&&a.propsSize.width,height:void 0===(a.propsSize&&a.propsSize.height)?"auto":a.propsSize&&a.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0}},a.onResizeStart=a.onResizeStart.bind(a),a.onMouseMove=a.onMouseMove.bind(a),a.onMouseUp=a.onMouseUp.bind(a),a}return function(e,t){function a(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||u},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"base",{get:function(){var e=this.parentNode;if(e)for(var t=0,a=[].slice.call(e.children);t<a.length;t++){var n=a[t];if(n instanceof HTMLElement&&n.classList.contains(v))return n}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if("undefined"!=typeof window&&this.resizable){var a=this.resizable.offsetWidth,n=this.resizable.offsetHeight,i=this.resizable.style.position;"relative"!==i&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:a,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:n,this.resizable.style.position=i}return{width:e,height:t}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,a=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&f(e.propsSize[t].toString(),"%")){if(f(e.state[t].toString(),"%"))return e.state[t].toString();var a=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/a[t]*100+"%"}return b(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?b(t.width):a("width"),height:t&&void 0!==t.height&&!this.state.isResizing?b(t.height):a("height")}},enumerable:!0,configurable:!0}),t.prototype.getParentSize=function(){if(!this.base||!this.parentNode)return{width:window.innerWidth,height:window.innerHeight};var e=!1,t=this.parentNode.style.flexWrap,a=this.base.style.minWidth;"wrap"!==t&&(e=!0,this.parentNode.style.flexWrap="wrap"),this.base.style.position="relative",this.base.style.minWidth="100%";var n={width:this.base.offsetWidth,height:this.base.offsetHeight};return this.base.style.position="absolute",e&&(this.parentNode.style.flexWrap=t),this.base.style.minWidth=a,n},t.prototype.bindEvents=function(){"undefined"!=typeof window&&(window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseleave",this.onMouseUp),window.addEventListener("touchmove",this.onMouseMove),window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){"undefined"!=typeof window&&(window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseleave",this.onMouseUp),window.removeEventListener("touchmove",this.onMouseMove),window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height});var e=this.parentNode;if(e instanceof HTMLElement&&!this.base){var t=document.createElement("div");t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.transform="scale(0, 0)",t.style.left="0",t.style.flex="0",t.classList?t.classList.add(v):t.className+=v,e.appendChild(t)}},t.prototype.componentWillUnmount=function(){if("undefined"!=typeof window){this.unbindEvents();var e=this.parentNode;if(!this.base||!e)return;if(!(e instanceof HTMLElement&&this.base instanceof Node))return;e.removeChild(this.base)}},t.prototype.createSizeForCssProperty=function(e,t){var a=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==a&&"auto"!==a?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){if("parent"===this.props.bounds){var a=this.parentNode;if(a instanceof HTMLElement){var n=a.offsetWidth+(this.parentLeft-this.resizableLeft),i=a.offsetHeight+(this.parentTop-this.resizableTop);e=e&&e<n?e:n,t=t&&t<i?t:i}}else"window"===this.props.bounds?"undefined"!=typeof window&&(n=window.innerWidth-this.resizableLeft,i=window.innerHeight-this.resizableTop,e=e&&e<n?e:n,t=t&&t<i?t:i):this.props.bounds instanceof HTMLElement&&(n=this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),i=this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop),e=e&&e<n?e:n,t=t&&t<i?t:i);return{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var a=this.props.scale||1,n=this.props.resizeRatio||1,i=this.state,s=i.direction,r=i.original,o=this.props,l=o.lockAspectRatio,c=o.lockAspectRatioExtraHeight,u=o.lockAspectRatioExtraWidth,d=r.width,p=r.height,g=c||0,f=u||0;return m("right",s)&&(d=r.width+(e-r.x)*n/a,l&&(p=(d-f)/this.ratio+g)),m("left",s)&&(d=r.width-(e-r.x)*n/a,l&&(p=(d-f)/this.ratio+g)),m("bottom",s)&&(p=r.height+(t-r.y)*n/a,l&&(d=(p-g)*this.ratio+f)),m("top",s)&&(p=r.height-(t-r.y)*n/a,l&&(d=(p-g)*this.ratio+f)),{newWidth:d,newHeight:p}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,a,n){var i=this.props,s=i.lockAspectRatio,r=i.lockAspectRatioExtraHeight,o=i.lockAspectRatioExtraWidth,l=void 0===n.width?10:n.width,c=void 0===a.width||a.width<0?e:a.width,u=void 0===n.height?10:n.height,p=void 0===a.height||a.height<0?t:a.height,m=r||0,g=o||0;if(s){var f=(u-m)*this.ratio+g,b=(p-m)*this.ratio+g,h=(l-g)/this.ratio+m,y=(c-g)/this.ratio+m,E=Math.max(l,f),v=Math.min(c,b),k=Math.max(u,h),S=Math.min(p,y);e=d(e,E,v),t=d(t,k,S)}else e=d(e,l,c),t=d(t,u,p);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e instanceof HTMLElement){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds instanceof HTMLElement){var a=this.props.bounds.getBoundingClientRect();this.targetLeft=a.left,this.targetTop=a.top}if(this.resizable){var n=this.resizable.getBoundingClientRect(),i=n.left,s=n.top;this.resizableLeft=i,this.resizableTop=s}},t.prototype.onResizeStart=function(e,t){var a=0,n=0;if(e.nativeEvent instanceof MouseEvent){if(a=e.nativeEvent.clientX,n=e.nativeEvent.clientY,3===e.nativeEvent.which)return}else e.nativeEvent instanceof TouchEvent&&(a=e.nativeEvent.touches[0].clientX,n=e.nativeEvent.touches[0].clientY);this.props.onResizeStart&&this.resizable&&!1===this.props.onResizeStart(e,t,this.resizable)||(this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height,this.setBoundingClientRect(),this.bindEvents(),this.setState({original:{x:a,y:n,width:this.size.width,height:this.size.height},isResizing:!0,resizeCursor:window.getComputedStyle(e.target).cursor||"auto",direction:t}))},t.prototype.onMouseMove=function(e){if(this.state.isResizing&&this.resizable){var t=this.props,a=t.maxWidth,n=t.maxHeight,i=t.minWidth,s=t.minHeight,r=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,o=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,l=this.state,c=l.direction,u=l.original,d=l.width,m=l.height,b=this.getParentSize(),h=y(b,a,n,i,s);a=h.maxWidth,n=h.maxHeight,i=h.minWidth,s=h.minHeight;var E=this.calculateNewSizeFromDirection(r,o),v=E.newHeight,k=E.newWidth,S=this.calculateNewMaxFromBoundary(a,n),T=this.calculateNewSizeFromAspectRatio(k,v,{width:S.maxWidth,height:S.maxHeight},{width:i,height:s});if(k=T.newWidth,v=T.newHeight,this.props.grid){var x=p(k,this.props.grid[0]),w=p(v,this.props.grid[1]),O=this.props.snapGap||0;k=0===O||Math.abs(x-k)<=O?x:k,v=0===O||Math.abs(w-v)<=O?w:v}this.props.snap&&this.props.snap.x&&(k=g(k,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(v=g(v,this.props.snap.y,this.props.snapGap));var j={width:k-u.width,height:v-u.height};d&&"string"==typeof d&&(f(d,"%")?k=k/b.width*100+"%":f(d,"vw")?k=k/window.innerWidth*100+"vw":f(d,"vh")&&(k=k/window.innerHeight*100+"vh")),m&&"string"==typeof m&&(f(m,"%")?v=v/b.height*100+"%":f(m,"vw")?v=v/window.innerWidth*100+"vw":f(m,"vh")&&(v=v/window.innerHeight*100+"vh")),this.setState({width:this.createSizeForCssProperty(k,"width"),height:this.createSizeForCssProperty(v,"height")}),this.props.onResize&&this.props.onResize(e,c,this.resizable,j)}},t.prototype.onMouseUp=function(e){var t=this.state,a=t.isResizing,n=t.direction,i=t.original;if(a&&this.resizable){var s={width:this.size.width-i.width,height:this.size.height-i.height};this.props.onResizeStop&&this.props.onResizeStop(e,n,this.resizable,s),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,resizeCursor:"auto"})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,a=t.enable,n=t.handleStyles,s=t.handleClasses,r=t.handleWrapperStyle,o=t.handleWrapperClass,l=t.handleComponent;if(!a)return null;var u=Object.keys(a).map((function(t){return!1!==a[t]?i.createElement(c,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:n&&n[t],className:s&&s[t]},l&&l[t]?l[t]:null):null}));return i.createElement("span",{className:o,style:r},u)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,a){return-1!==E.indexOf(a)||(t[a]=e.props[a]),t}),{});return i.createElement("div",o({ref:function(t){t&&(e.resizable=t)},style:o({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style,this.sizeStyle,{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0}),className:this.props.className},t),this.state.isResizing&&i.createElement("div",{style:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:""+(this.state.resizeCursor||"auto"),opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"}}),this.props.children,this.renderResizer())},t.defaultProps={onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(i.PureComponent);t.Resizable=k},function(e,t){function a(e,t,a,n){var i,s=null==(i=n)||"number"==typeof i||"boolean"==typeof i?n:a(n),r=t.get(s);return void 0===r&&(r=e.call(this,n),t.set(s,r)),r}function n(e,t,a){var n=Array.prototype.slice.call(arguments,3),i=a(n),s=t.get(i);return void 0===s&&(s=e.apply(this,n),t.set(i,s)),s}function i(e,t,a,n,i){return a.bind(t,e,n,i)}function s(e,t){return i(e,this,1===e.length?a:n,t.cache.create(),t.serializer)}function r(){return JSON.stringify(arguments)}function o(){this.cache=Object.create(null)}o.prototype.has=function(e){return e in this.cache},o.prototype.get=function(e){return this.cache[e]},o.prototype.set=function(e,t){this.cache[e]=t};var l={create:function(){return new o}};e.exports=function(e,t){var a=t&&t.cache?t.cache:l,n=t&&t.serializer?t.serializer:r;return(t&&t.strategy?t.strategy:s)(e,{cache:a,serializer:n})},e.exports.strategies={variadic:function(e,t){return i(e,this,n,t.cache.create(),t.serializer)},monadic:function(e,t){return i(e,this,a,t.cache.create(),t.serializer)}}},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){const n=a(325);e.exports={re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:a(398).SEMVER_SPEC_VERSION,SemVer:a(233),compareIdentifiers:a(474).compareIdentifiers,rcompareIdentifiers:a(474).rcompareIdentifiers,parse:a(326),valid:a(765),clean:a(766),inc:a(767),diff:a(768),major:a(769),minor:a(770),patch:a(771),prerelease:a(772),compare:a(248),rcompare:a(773),compareLoose:a(774),compareBuild:a(479),sort:a(775),rsort:a(776),gt:a(402),lt:a(480),eq:a(478),neq:a(578),gte:a(375),lte:a(396),cmp:a(579),coerce:a(661),Comparator:a(403),Range:a(251),satisfies:a(404),toComparators:a(780),maxSatisfying:a(781),minSatisfying:a(782),minVersion:a(783),validRange:a(784),outside:a(481),gtr:a(785),ltr:a(786),intersects:a(787),simplifyRange:a(788),subset:a(789)}},function(e,t,a){const n=a(326);e.exports=(e,t)=>{const a=n(e,t);return a?a.version:null}},function(e,t,a){const n=a(326);e.exports=(e,t)=>{const a=n(e.trim().replace(/^[=v]+/,""),t);return a?a.version:null}},function(e,t,a){const n=a(233);e.exports=(e,t,a,i)=>{"string"==typeof a&&(i=a,a=void 0);try{return new n(e instanceof n?e.version:e,a).inc(t,i).version}catch(e){return null}}},function(e,t,a){const n=a(326),i=a(478);e.exports=(e,t)=>{if(i(e,t))return null;{const a=n(e),i=n(t),s=a.prerelease.length||i.prerelease.length,r=s?"pre":"",o=s?"prerelease":"";for(const e in a)if(("major"===e||"minor"===e||"patch"===e)&&a[e]!==i[e])return r+e;return o}}},function(e,t,a){const n=a(233);e.exports=(e,t)=>new n(e,t).major},function(e,t,a){const n=a(233);e.exports=(e,t)=>new n(e,t).minor},function(e,t,a){const n=a(233);e.exports=(e,t)=>new n(e,t).patch},function(e,t,a){const n=a(326);e.exports=(e,t)=>{const a=n(e,t);return a&&a.prerelease.length?a.prerelease:null}},function(e,t,a){const n=a(248);e.exports=(e,t,a)=>n(t,e,a)},function(e,t,a){const n=a(248);e.exports=(e,t)=>n(e,t,!0)},function(e,t,a){const n=a(479);e.exports=(e,t)=>e.sort(((e,a)=>n(e,a,t)))},function(e,t,a){const n=a(479);e.exports=(e,t)=>e.sort(((e,a)=>n(a,e,t)))},function(e,t,a){"use strict";const n=a(778),i=Symbol("max"),s=Symbol("length"),r=Symbol("lengthCalculator"),o=Symbol("allowStale"),l=Symbol("maxAge"),c=Symbol("dispose"),u=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),m=Symbol("updateAgeOnGet"),g=()=>1,f=(e,t,a)=>{const n=e[p].get(t);if(n){const t=n.value;if(b(e,t)){if(y(e,n),!e[o])return}else a&&(e[m]&&(n.value.now=Date.now()),e[d].unshiftNode(n));return t.value}},b=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const a=Date.now()-t.now;return t.maxAge?a>t.maxAge:e[l]&&a>e[l]},h=e=>{if(e[s]>e[i])for(let t=e[d].tail;e[s]>e[i]&&null!==t;){const a=t.prev;y(e,t),t=a}},y=(e,t)=>{if(t){const a=t.value;e[c]&&e[c](a.key,a.value),e[s]-=a.length,e[p].delete(a.key),e[d].removeNode(t)}};class Entry{constructor(e,t,a,n,i){this.key=e,this.value=t,this.length=a,this.now=n,this.maxAge=i||0}}const E=(e,t,a,n)=>{let i=a.value;b(e,i)&&(y(e,a),e[o]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};e.exports=class LRUCache{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||g;if(this[r]="function"!=typeof t?g:t,this[o]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[c]=e.dispose,this[u]=e.noDisposeOnSet||!1,this[m]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,h(this)}get max(){return this[i]}set allowStale(e){this[o]=!!e}get allowStale(){return this[o]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,h(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=g),e!==this[r]&&(this[r]=e,this[s]=0,this[d].forEach((e=>{e.length=this[r](e.value,e.key),this[s]+=e.length}))),h(this)}get lengthCalculator(){return this[r]}get length(){return this[s]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let a=this[d].tail;null!==a;){const n=a.prev;E(this,e,a,t),a=n}}forEach(e,t){t=t||this;for(let a=this[d].head;null!==a;){const n=a.next;E(this,e,a,t),a=n}}keys(){return this[d].toArray().map((e=>e.key))}values(){return this[d].toArray().map((e=>e.value))}reset(){this[c]&&this[d]&&this[d].length&&this[d].forEach((e=>this[c](e.key,e.value))),this[p]=new Map,this[d]=new n,this[s]=0}dump(){return this[d].map((e=>!b(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[d]}set(e,t,a){if((a=a||this[l])&&"number"!=typeof a)throw new TypeError("maxAge must be a number");const n=a?Date.now():0,o=this[r](t,e);if(this[p].has(e)){if(o>this[i])return y(this,this[p].get(e)),!1;const r=this[p].get(e).value;return this[c]&&(this[u]||this[c](e,r.value)),r.now=n,r.maxAge=a,r.value=t,this[s]+=o-r.length,r.length=o,this.get(e),h(this),!0}const m=new Entry(e,t,o,n,a);return m.length>this[i]?(this[c]&&this[c](e,t),!1):(this[s]+=m.length,this[d].unshift(m),this[p].set(e,this[d].head),h(this),!0)}has(e){if(!this[p].has(e))return!1;const t=this[p].get(e).value;return!b(this,t)}get(e){return f(this,e,!0)}peek(e){return f(this,e,!1)}pop(){const e=this[d].tail;return e?(y(this,e),e.value):null}del(e){y(this,this[p].get(e))}load(e){this.reset();const t=Date.now();for(let a=e.length-1;a>=0;a--){const n=e[a],i=n.e||0;if(0===i)this.set(n.k,n.v);else{const e=i-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[p].forEach(((e,t)=>f(this,t,!1)))}}},function(e,t,a){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var a=0,i=arguments.length;a<i;a++)t.push(arguments[a]);return t}function i(e,t,a){var n=t===e.head?new o(a,null,t,e):new o(a,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function s(e,t){e.tail=new o(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function r(e,t){e.head=new o(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function o(e,t,a,n){if(!(this instanceof o))return new o(e,t,a,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,a?(a.prev=this,this.next=a):this.next=null}e.exports=n,n.Node=o,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,a=e.prev;return t&&(t.prev=a),a&&(a.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=a),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)s(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)r(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var a=this.head,n=0;null!==a;n++)e.call(t,a.value,n,this),a=a.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var a=this.tail,n=this.length-1;null!==a;n--)e.call(t,a.value,n,this),a=a.prev},n.prototype.get=function(e){for(var t=0,a=this.head;null!==a&&t<e;t++)a=a.next;if(t===e&&null!==a)return a.value},n.prototype.getReverse=function(e){for(var t=0,a=this.tail;null!==a&&t<e;t++)a=a.prev;if(t===e&&null!==a)return a.value},n.prototype.map=function(e,t){t=t||this;for(var a=new n,i=this.head;null!==i;)a.push(e.call(t,i.value,this)),i=i.next;return a},n.prototype.mapReverse=function(e,t){t=t||this;for(var a=new n,i=this.tail;null!==i;)a.push(e.call(t,i.value,this)),i=i.prev;return a},n.prototype.reduce=function(e,t){var a,n=this.head;if(arguments.length>1)a=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,a=this.head.value}for(var i=0;null!==n;i++)a=e(a,n.value,i),n=n.next;return a},n.prototype.reduceReverse=function(e,t){var a,n=this.tail;if(arguments.length>1)a=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,a=this.tail.value}for(var i=this.length-1;null!==n;i--)a=e(a,n.value,i),n=n.prev;return a},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,a=this.head;null!==a;t++)e[t]=a.value,a=a.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,a=this.tail;null!==a;t++)e[t]=a.value,a=a.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var a=new n;if(t<e||t<0)return a;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,s=this.head;null!==s&&i<e;i++)s=s.next;for(;null!==s&&i<t;i++,s=s.next)a.push(s.value);return a},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var a=new n;if(t<e||t<0)return a;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,s=this.tail;null!==s&&i>t;i--)s=s.prev;for(;null!==s&&i>e;i--,s=s.prev)a.push(s.value);return a},n.prototype.splice=function(e,t,...a){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,s=this.head;null!==s&&n<e;n++)s=s.next;var r=[];for(n=0;s&&n<t;n++)r.push(s.value),s=this.removeNode(s);for(null===s&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev),n=0;n<a.length;n++)s=i(this,s,a[n]);return r},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,a=e;null!==a;a=a.prev){var n=a.prev;a.prev=a.next,a.next=n}return this.head=t,this.tail=e,this};try{a(779)(n)}catch(e){}},function(e,t,a){"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},function(e,t,a){const n=a(251);e.exports=(e,t)=>new n(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},function(e,t,a){const n=a(233),i=a(251);e.exports=(e,t,a)=>{let s=null,r=null,o=null;try{o=new i(t,a)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(s&&-1!==r.compare(e)||(s=e,r=new n(s,a)))})),s}},function(e,t,a){const n=a(233),i=a(251);e.exports=(e,t,a)=>{let s=null,r=null,o=null;try{o=new i(t,a)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(s&&1!==r.compare(e)||(s=e,r=new n(s,a)))})),s}},function(e,t,a){const n=a(233),i=a(251),s=a(402);e.exports=(e,t)=>{e=new i(e,t);let a=new n("0.0.0");if(e.test(a))return a;if(a=new n("0.0.0-0"),e.test(a))return a;a=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let r=null;i.forEach((e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!s(t,r)||(r=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!r||a&&!s(a,r)||(a=r)}return a&&e.test(a)?a:null}},function(e,t,a){const n=a(251);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},function(e,t,a){const n=a(481);e.exports=(e,t,a)=>n(e,t,">",a)},function(e,t,a){const n=a(481);e.exports=(e,t,a)=>n(e,t,"<",a)},function(e,t,a){const n=a(251);e.exports=(e,t,a)=>(e=new n(e,a),t=new n(t,a),e.intersects(t))},function(e,t,a){const n=a(404),i=a(248);e.exports=(e,t,a)=>{const s=[];let r=null,o=null;const l=e.sort(((e,t)=>i(e,t,a)));for(const e of l)n(e,t,a)?(o=e,r||(r=e)):(o&&s.push([r,o]),o=null,r=null);r&&s.push([r,null]);const c=[];for(const[e,t]of s)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},function(e,t,a){const n=a(251),i=a(403),{ANY:s}=i,r=a(404),o=a(248),l=(e,t,a)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===s){if(1===t.length&&t[0].semver===s)return!0;e=a.includePrerelease?[new i(">=0.0.0-0")]:[new i(">=0.0.0")]}if(1===t.length&&t[0].semver===s){if(a.includePrerelease)return!0;t=[new i(">=0.0.0")]}const n=new Set;let l,d,p,m,g,f,b;for(const t of e)">"===t.operator||">="===t.operator?l=c(l,t,a):"<"===t.operator||"<="===t.operator?d=u(d,t,a):n.add(t.semver);if(n.size>1)return null;if(l&&d){if(p=o(l.semver,d.semver,a),p>0)return null;if(0===p&&(">="!==l.operator||"<="!==d.operator))return null}for(const e of n){if(l&&!r(e,String(l),a))return null;if(d&&!r(e,String(d),a))return null;for(const n of t)if(!r(e,String(n),a))return!1;return!0}let h=!(!d||a.includePrerelease||!d.semver.prerelease.length)&&d.semver,y=!(!l||a.includePrerelease||!l.semver.prerelease.length)&&l.semver;h&&1===h.prerelease.length&&"<"===d.operator&&0===h.prerelease[0]&&(h=!1);for(const e of t){if(b=b||">"===e.operator||">="===e.operator,f=f||"<"===e.operator||"<="===e.operator,l)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),">"===e.operator||">="===e.operator){if(m=c(l,e,a),m===e&&m!==l)return!1}else if(">="===l.operator&&!r(l.semver,String(e),a))return!1;if(d)if(h&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===h.major&&e.semver.minor===h.minor&&e.semver.patch===h.patch&&(h=!1),"<"===e.operator||"<="===e.operator){if(g=u(d,e,a),g===e&&g!==d)return!1}else if("<="===d.operator&&!r(d.semver,String(e),a))return!1;if(!e.operator&&(d||l)&&0!==p)return!1}return!(l&&f&&!d&&0!==p||d&&b&&!l&&0!==p||y||h)},c=(e,t,a)=>{if(!e)return t;const n=o(e.semver,t.semver,a);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},u=(e,t,a)=>{if(!e)return t;const n=o(e.semver,t.semver,a);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,a={})=>{if(e===t)return!0;e=new n(e,a),t=new n(t,a);let i=!1;e:for(const n of e.set){for(const e of t.set){const t=l(n,e,a);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},function(e,t,a){e.exports=a(25)(1754)},function(e,t,a){"use strict";const n=a(4),i=a(793),s=a(794),r=a(795),o=a(842),l=a(148),c=a(843),u=a(844),d=a(846),p=a(847).hastChildrenToReact;e.exports=f;const m={}.hasOwnProperty,g={renderers:{to:"components",id:"change-renderers-to-components"},astPlugins:{id:"remove-buggy-html-in-markdown-parser"},allowDangerousHtml:{id:"remove-buggy-html-in-markdown-parser"},escapeHtml:{id:"remove-buggy-html-in-markdown-parser"},source:{to:"children",id:"change-source-to-children"},allowNode:{to:"allowElement",id:"replace-allownode-allowedtypes-and-disallowedtypes"},allowedTypes:{to:"allowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},disallowedTypes:{to:"disallowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},includeNodeIndex:{to:"includeElementIndex",id:"change-includenodeindex-to-includeelementindex"}};function f(e){for(const t in g)if(m.call(g,t)&&m.call(e,t)){const e=g[t];console.warn(`[react-markdown] Warning: please ${e.to?`use \`${e.to}\` instead of`:"remove"} \`${t}\` (see <https://github.com/remarkjs/react-markdown/blob/main/changelog.md#${e.id}> for more info)`),delete g[t]}const t=s().use(r).use(e.remarkPlugins||e.plugins||[]).use(o,{allowDangerousHtml:!0}).use(e.rehypePlugins||[]).use(u,e);let a;"string"==typeof e.children?a=i(e.children):(void 0!==e.children&&null!==e.children&&console.warn(`[react-markdown] Warning: please pass a string as \`children\` (not: \`${e.children}\`)`),a=i());const l=t.runSync(t.parse(a),a);if("root"!==l.type)throw new TypeError("Expected a `root` node");let d=n.createElement(n.Fragment,{},p({options:e,schema:c,listDepth:0},l));return e.className&&(d=n.createElement("div",{className:e.className},d)),d}f.defaultProps={transformLinkUri:d},f.propTypes={children:l.string,className:l.string,allowElement:l.func,allowedElements:l.arrayOf(l.string),disallowedElements:l.arrayOf(l.string),unwrapDisallowed:l.bool,remarkPlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),rehypePlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),sourcePos:l.bool,rawSourcePos:l.bool,skipHtml:l.bool,includeElementIndex:l.bool,transformLinkUri:l.oneOfType([l.func,l.bool]),linkTarget:l.oneOfType([l.func,l.string]),transformImageUri:l.func,components:l.object},f.uriTransformer=d},function(e,t,a){e.exports=a(25)(3392)},function(e,t,a){e.exports=a(25)(972)},function(e,t,a){"use strict";e.exports=function(e){var t=this;this.Parser=function(a){return n(a,Object.assign({},t.data("settings"),e,{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}};var n=a(796)},function(e,t,a){"use strict";e.exports=a(797)},function(e,t,a){"use strict";e.exports=function(e,t,a){return"string"!=typeof t&&(a=t,t=void 0),function(e){var t=e||{},a=function(e,t){for(var a=-1;++a<t.length;)m(e,t[a]);return e}({canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:b(M),autolinkProtocol:S,autolinkEmail:S,atxHeading:b(j),blockQuote:b((function(){return{type:"blockquote",children:[]}})),characterEscape:S,characterReference:S,codeFenced:b(O),codeFencedFenceInfo:h,codeFencedFenceMeta:h,codeIndented:b(O,h),codeText:b((function(){return{type:"inlineCode",value:""}}),h),codeTextData:S,data:S,codeFlowValue:S,definition:b((function(){return{type:"definition",identifier:"",label:null,title:null,url:""}})),definitionDestinationString:h,definitionLabelString:h,definitionTitleString:h,emphasis:b((function(){return{type:"emphasis",children:[]}})),hardBreakEscape:b(I),hardBreakTrailing:b(I),htmlFlow:b(C,h),htmlFlowData:S,htmlText:b(C,h),htmlTextData:S,image:b((function(){return{type:"image",title:null,url:"",alt:null}})),label:h,link:b(M),listItem:b((function(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}})),listItemValue:function(e){g("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=parseInt(this.sliceSerialize(e),10),u("expectingFirstListItemValue"))},listOrdered:b(D,(function(){u("expectingFirstListItemValue",!0)})),listUnordered:b(D),paragraph:b((function(){return{type:"paragraph",children:[]}})),reference:function(){u("referenceType","collapsed")},referenceString:h,resourceDestinationString:h,resourceTitleString:h,setextHeading:b(j),strong:b((function(){return{type:"strong",children:[]}})),thematicBreak:b((function(){return{type:"thematicBreak"}}))},exit:{atxHeading:E(),atxHeadingSequence:function(e){this.stack[this.stack.length-1].depth||(this.stack[this.stack.length-1].depth=this.sliceSerialize(e).length)},autolink:E(),autolinkEmail:function(e){T.call(this,e),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)},autolinkProtocol:function(e){T.call(this,e),this.stack[this.stack.length-1].url=this.sliceSerialize(e)},blockQuote:E(),characterEscapeValue:T,characterReferenceMarkerHexadecimal:w,characterReferenceMarkerNumeric:w,characterReferenceValue:function(e){var t,a,n=this.sliceSerialize(e),i=g("characterReferenceType");i?(t=o(n,"characterReferenceMarkerNumeric"===i?10:16),u("characterReferenceType")):t=d(n),(a=this.stack.pop()).value+=t,a.position.end=f(e.end)},codeFenced:E((function(){var e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),u("flowCodeInside")})),codeFencedFence:function(){g("flowCodeInside")||(this.buffer(),u("flowCodeInside",!0))},codeFencedFenceInfo:function(){var e=this.resume();this.stack[this.stack.length-1].lang=e},codeFencedFenceMeta:function(){var e=this.resume();this.stack[this.stack.length-1].meta=e},codeFlowValue:T,codeIndented:E((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeText:E((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeTextData:T,data:T,definition:E(),definitionDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},definitionLabelString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=r(this.sliceSerialize(e)).toLowerCase()},definitionTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},emphasis:E(),hardBreakEscape:E(x),hardBreakTrailing:E(x),htmlFlow:E((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlFlowData:T,htmlText:E((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlTextData:T,image:E((function(){var e=this.stack[this.stack.length-1];g("inReference")?(e.type+="Reference",e.referenceType=g("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),label:function(){var e=this.stack[this.stack.length-1],t=this.resume();this.stack[this.stack.length-1].label=t,u("inReference",!0),"link"===this.stack[this.stack.length-1].type?this.stack[this.stack.length-1].children=e.children:this.stack[this.stack.length-1].alt=t},labelText:function(e){this.stack[this.stack.length-2].identifier=r(this.sliceSerialize(e)).toLowerCase()},lineEnding:function(e){var t=this.stack[this.stack.length-1];if(g("atHardBreak"))return t.children[t.children.length-1].position.end=f(e.end),void u("atHardBreak");!g("setextHeadingSlurpLineEnding")&&a.canContainEols.indexOf(t.type)>-1&&(S.call(this,e),T.call(this,e))},link:E((function(){var e=this.stack[this.stack.length-1];g("inReference")?(e.type+="Reference",e.referenceType=g("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),listItem:E(),listOrdered:E(),listUnordered:E(),paragraph:E(),referenceString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=r(this.sliceSerialize(e)).toLowerCase(),u("referenceType","full")},resourceDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},resourceTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},resource:function(){u("inReference")},setextHeading:E((function(){u("setextHeadingSlurpLineEnding")})),setextHeadingLineSequence:function(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).charCodeAt(0)?1:2},setextHeadingText:function(){u("setextHeadingSlurpLineEnding",!0)},strong:E(),thematicBreak:E()}},t.mdastExtensions||[]),l={};return function(e){for(var t,n=[{type:"root",children:[]}],r=[],o=[],l=-1,d={stack:n,tokenStack:r,config:a,enter:y,exit:v,buffer:h,resume:k,setData:u,getData:g};++l<e.length;)"listOrdered"!==e[l][1].type&&"listUnordered"!==e[l][1].type||("enter"===e[l][0]?o.push(l):l=c(e,o.pop(l),l));for(l=-1;++l<e.length;)t=a[e[l][0]],s.call(t,e[l][1].type)&&t[e[l][1].type].call(i({sliceSerialize:e[l][2].sliceSerialize},d),e[l][1]);if(r.length)throw new Error("Cannot close document, a token (`"+r[r.length-1].type+"`, "+p({start:r[r.length-1].start,end:r[r.length-1].end})+") is still open");return n[0].position={start:f(e.length?e[0][1].start:{line:1,column:1,offset:0}),end:f(e.length?e[e.length-2][1].end:{line:1,column:1,offset:0})},n[0]};function c(e,t,a){for(var n,i,s,r,o,l,c,u=t-1,d=-1,p=!1;++u<=a;)if("listUnordered"===(o=e[u])[1].type||"listOrdered"===o[1].type||"blockQuote"===o[1].type?("enter"===o[0]?d++:d--,c=void 0):"lineEndingBlank"===o[1].type?"enter"===o[0]&&(!n||c||d||l||(l=u),c=void 0):"linePrefix"===o[1].type||"listItemValue"===o[1].type||"listItemMarker"===o[1].type||"listItemPrefix"===o[1].type||"listItemPrefixWhitespace"===o[1].type||(c=void 0),!d&&"enter"===o[0]&&"listItemPrefix"===o[1].type||-1===d&&"exit"===o[0]&&("listUnordered"===o[1].type||"listOrdered"===o[1].type)){if(n){for(i=u,s=void 0;i--;)if("lineEnding"===(r=e[i])[1].type||"lineEndingBlank"===r[1].type){if("exit"===r[0])continue;s&&(e[s][1].type="lineEndingBlank",p=!0),r[1].type="lineEnding",s=i}else if("linePrefix"!==r[1].type&&"blockQuotePrefix"!==r[1].type&&"blockQuotePrefixWhitespace"!==r[1].type&&"blockQuoteMarker"!==r[1].type&&"listItemIndent"!==r[1].type)break;l&&(!s||l<s)&&(n._spread=!0),n.end=f(s?e[s][1].start:o[1].end),e.splice(s||u,0,["exit",n,o[2]]),u++,a++}"listItemPrefix"===o[1].type&&(n={type:"listItem",_spread:!1,start:f(o[1].start)},e.splice(u,0,["enter",n,o[2]]),u++,a++,l=void 0,c=!0)}return e[t][1]._spread=p,a}function u(e,t){l[e]=t}function g(e){return l[e]}function f(e){return{line:e.line,column:e.column,offset:e.offset}}function b(e,t){return function(a){y.call(this,e(a),a),t&&t.call(this,a)}}function h(){this.stack.push({type:"fragment",children:[]})}function y(e,t){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push(t),e.position={start:f(t.start)},e}function E(e){return function(t){e&&e.call(this,t),v.call(this,t)}}function v(e){var t=this.stack.pop(),a=this.tokenStack.pop();if(!a)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): it’s not open");if(a.type!==e.type)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): a different token (`"+a.type+"`, "+p({start:a.start,end:a.end})+") is open");return t.position.end=f(e.end),t}function k(){return n(this.stack.pop())}function S(e){var t=this.stack[this.stack.length-1].children,a=t[t.length-1];a&&"text"===a.type||((a={type:"text",value:""}).position={start:f(e.start)},this.stack[this.stack.length-1].children.push(a)),this.stack.push(a)}function T(e){var t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=f(e.end)}function x(){u("atHardBreak",!0)}function w(e){u("characterReferenceType",e.type)}function O(){return{type:"code",lang:null,meta:null,value:""}}function j(){return{type:"heading",depth:void 0,children:[]}}function I(){return{type:"break"}}function C(){return{type:"html",value:""}}function M(){return{type:"link",title:null,url:"",children:[]}}function D(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}}(a)(u(l(a).document().write(c()(e,t,!0))))};var n=a(798),i=a(358),s=a(583),r=a(483),o=a(799),l=a(800),c=a(839),u=a(840),d=a(588),p=a(841);function m(e,t){var a,n;for(a in t)n=s.call(e,a)?e[a]:e[a]={},"canContainEols"===a?e[a]=[].concat(n,t[a]):Object.assign(n,t[a])}},function(e,t,a){"use strict";function n(e){return e&&(e.value||e.alt||e.title||"children"in e&&i(e.children)||"length"in e&&i(e))||""}function i(e){for(var t=[],a=-1;++a<e.length;)t[a]=n(e[a]);return t.join("")}e.exports=n},function(e,t,a){"use strict";var n=a(407);e.exports=function(e,t){var a=parseInt(e,t);return a<9||11===a||a>13&&a<32||a>126&&a<160||a>55295&&a<57344||a>64975&&a<65008||65535==(65535&a)||65534==(65535&a)||a>1114111?"�":n(a)}},function(e,t,a){"use strict";var n=a(801),i=a(802),s=a(803),r=a(586),o=a(806),l=a(807),c=a(484),u=a(810);e.exports=function(e){var t={defined:[],constructs:o([u].concat(c((e||{}).extensions))),content:a(n),document:a(i),flow:a(s),string:a(r.string),text:a(r.text)};return t;function a(e){return function(a){return l(t,e,a)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(222),i=a(225);t.tokenize=function(e){var t,a=e.attempt(this.parser.constructs.contentInitial,(function(t){if(null!==t)return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,a,"linePrefix");e.consume(t)}),(function(t){return e.enter("paragraph"),s(t)}));return a;function s(a){var n=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=n),t=n,r(a)}function r(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):n(t)?(e.consume(t),e.exit("chunkText"),s):(e.consume(t),r)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(222),i=a(225),s=a(408),r={tokenize:function(e,t,a){return i(e,e.attempt(this.parser.constructs.document,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},o={tokenize:function(e,t,a){return i(e,e.lazy(this.parser.constructs.flow,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}};t.tokenize=function(e){var t,a,i,l=this,c=[],u=0,d={tokenize:function(e,n){var i=0;return t={},u;function u(n){return i<c.length?(l.containerState=c[i][1],e.attempt(c[i][0].continuation,d,p)(n)):a.currentConstruct&&a.currentConstruct.concrete?(t.flowContinue=!0,f(n)):(l.interrupt=a.currentConstruct&&a.currentConstruct.interruptible,l.containerState={},e.attempt(r,g,f)(n))}function d(e){return i++,l.containerState._closeFlow?g(e):u(e)}function p(t){return a.currentConstruct&&a.currentConstruct.lazy?(l.containerState={},e.attempt(r,g,e.attempt(o,g,e.check(s,g,m)))(t)):g(t)}function m(e){return i=c.length,t.lazy=!0,t.flowContinue=!0,f(e)}function g(e){return t.flowEnd=!0,f(e)}function f(e){return t.continued=i,l.interrupt=l.containerState=void 0,n(e)}},partial:!0};return p;function p(t){return u<c.length?(l.containerState=c[u][1],e.attempt(c[u][0].continuation,m,g)(t)):g(t)}function m(e){return u++,p(e)}function g(n){return t&&t.flowContinue?b(n):(l.interrupt=a&&a.currentConstruct&&a.currentConstruct.interruptible,l.containerState={},e.attempt(r,f,b)(n))}function f(e){return c.push([l.currentConstruct,l.containerState]),l.containerState=void 0,g(e)}function b(t){return null===t?(v(0,!0),void e.consume(t)):(a=a||l.parser.flow(l.now()),e.enter("chunkFlow",{contentType:"flow",previous:i,_tokenizer:a}),h(t))}function h(t){return null===t?(E(e.exit("chunkFlow")),b(t)):n(t)?(e.consume(t),E(e.exit("chunkFlow")),e.check(d,y)):(e.consume(t),h)}function y(e){return v(t.continued,t&&t.flowEnd),u=0,p(e)}function E(e){i&&(i.next=e),i=e,a.lazy=t&&t.lazy,a.defineSkip(e.start),a.write(l.sliceStream(e))}function v(t,n){var s=c.length;for(a&&n&&(a.write([null]),i=a=void 0);s-- >t;)l.containerState=c[s][1],c[s][0].exit.call(l,e);c.length=t}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(804),i=a(225),s=a(408);t.tokenize=function(e){var t=this,a=e.attempt(s,(function(n){if(null!==n)return e.enter("lineEndingBlank"),e.consume(n),e.exit("lineEndingBlank"),t.currentConstruct=void 0,a;e.consume(n)}),e.attempt(this.parser.constructs.flowInitial,r,i(e,e.attempt(this.parser.constructs.flow,r,e.attempt(n,r)),"linePrefix")));return a;function r(n){if(null!==n)return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),t.currentConstruct=void 0,a;e.consume(n)}}},function(e,t,a){"use strict";var n=a(222),i=a(409),s=a(585),r=a(225),o={tokenize:function(e,t){var a;return function(t){return e.enter("content"),a=e.enter("chunkContent",{contentType:"content"}),i(t)};function i(t){return null===t?s(t):n(t)?e.check(l,r,s)(t):(e.consume(t),i)}function s(a){return e.exit("chunkContent"),e.exit("content"),t(a)}function r(t){return e.consume(t),e.exit("chunkContent"),a=a.next=e.enter("chunkContent",{contentType:"content",previous:a}),i}},resolve:function(e){return s(e),e},interruptible:!0,lazy:!0},l={tokenize:function(e,t,a){var s=this;return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),r(e,o,"linePrefix")};function o(r){return null===r||n(r)?a(r):s.parser.constructs.disable.null.indexOf("codeIndented")>-1||i(s.events,"linePrefix")<4?e.interrupt(s.parser.constructs.flow,a,t)(r):t(r)}},partial:!0};e.exports=o},function(e,t,a){"use strict";var n=[].splice;e.exports=n},function(e,t,a){"use strict";var n=a(583),i=a(282),s=a(484);function r(e,t){var a,i,r,l;for(a in t)for(l in i=n.call(e,a)?e[a]:e[a]={},r=t[a])i[l]=o(s(r[l]),n.call(i,l)?i[l]:[])}function o(e,t){for(var a=-1,n=[];++a<e.length;)("after"===e[a].add?t:n).push(e[a]);return i(t,0,0,n),t}e.exports=function(e){for(var t={},a=-1;++a<e.length;)r(t,e[a]);return t}},function(e,t,a){"use strict";var n=a(358),i=a(222),s=a(485),r=a(282),o=a(484),l=a(486),c=a(808),u=a(327),d=a(809);e.exports=function(e,t,a){var p=a?u(a):{line:1,column:1,offset:0},m={},g=[],f=[],b=[],h={consume:function(e){i(e)?(p.line++,p.column=1,p.offset+=-3===e?2:1,O()):-1!==e&&(p.column++,p.offset++),p._bufferIndex<0?p._index++:(p._bufferIndex++,p._bufferIndex===f[p._index].length&&(p._bufferIndex=-1,p._index++)),y.previous=e},enter:function(e,t){var a=t||{};return a.type=e,a.start=k(),y.events.push(["enter",a,y]),b.push(a),a},exit:function(e){var t=b.pop();return t.end=k(),y.events.push(["exit",t,y]),t},attempt:x((function(e,t){w(e,t.from)})),check:x(T),interrupt:x(T,{interrupt:!0}),lazy:x(T,{lazy:!0})},y={previous:null,events:[],parser:e,sliceStream:v,sliceSerialize:function(e){return c(v(e))},now:k,defineSkip:function(e){m[e.line]=e.column,O()},write:function(e){return f=s(f,e),function(){for(var e,t;p._index<f.length;)if("string"==typeof(t=f[p._index]))for(e=p._index,p._bufferIndex<0&&(p._bufferIndex=0);p._index===e&&p._bufferIndex<t.length;)S(t.charCodeAt(p._bufferIndex));else S(t)}(),null!==f[f.length-1]?[]:(w(t,0),y.events=l(g,y.events,y),y.events)}},E=t.tokenize.call(y,h);return t.resolveAll&&g.push(t),p._index=0,p._bufferIndex=-1,y;function v(e){return d(f,e)}function k(){return u(p)}function S(e){E=E(e)}function T(e,t){t.restore()}function x(e,t){return function(a,i,s){var r,l,c,u;return a.tokenize||"length"in a?d(o(a)):function(e){return e in a||null in a?d(a.null?o(a[e]).concat(o(a.null)):a[e])(e):s(e)};function d(e){return r=e,m(e[l=0])}function m(e){return function(a){var i,s,r,o,l;return i=k(),s=y.previous,r=y.currentConstruct,o=y.events.length,l=Array.from(b),u={restore:function(){p=i,y.previous=s,y.currentConstruct=r,y.events.length=o,b=l,O()},from:o},c=e,e.partial||(y.currentConstruct=e),e.name&&y.parser.constructs.disable.null.indexOf(e.name)>-1?f():e.tokenize.call(t?n({},y,t):y,h,g,f)(a)}}function g(t){return e(c,u),i}function f(e){return u.restore(),++l<r.length?m(r[l]):s}}}function w(e,t){e.resolveAll&&g.indexOf(e)<0&&g.push(e),e.resolve&&r(y.events,t,y.events.length-t,e.resolve(y.events.slice(t),y)),e.resolveTo&&(y.events=e.resolveTo(y.events,y))}function O(){p.line in m&&p.column<2&&(p.column=m[p.line],p.offset+=m[p.line]-1)}}},function(e,t,a){"use strict";var n=a(407);e.exports=function(e){for(var t,a,i,s=-1,r=[];++s<e.length;){if("string"==typeof(t=e[s]))a=t;else if(-5===t)a="\r";else if(-4===t)a="\n";else if(-3===t)a="\r\n";else if(-2===t)a="\t";else if(-1===t){if(i)continue;a=" "}else a=n(t);i=-2===t,r.push(a)}return r.join("")}},function(e,t,a){"use strict";e.exports=function(e,t){var a,n=t.start._index,i=t.start._bufferIndex,s=t.end._index,r=t.end._bufferIndex;return n===s?a=[e[n].slice(i,r)]:(a=e.slice(n,s),i>-1&&(a[0]=a[0].slice(i)),r>0&&a.push(e[s].slice(0,r))),a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(586),i=a(811),s=a(817),r=a(819),o=a(820),l=a(822),c=a(824),u=a(825),d=a(826),p=a(827),m=a(828),g=a(829),f=a(830),b=a(833),h=a(488),y=a(834),E=a(835),v=a(836),k=a(837),S=a(838),T=a(594),x={42:k,43:k,45:k,48:k,49:k,50:k,51:k,52:k,53:k,54:k,55:k,56:k,57:k,62:r},w={91:p},O={"-2":u,"-1":u,32:u},j={35:g,42:T,45:[S,T],60:f,61:S,95:T,96:c,126:c},I={38:l,92:o},C={"-5":v,"-4":v,"-3":v,33:y,38:l,42:i,60:[s,b],91:E,92:[m,o],93:h,95:i,96:d},M={null:[i,n.resolver]};t.contentInitial=w,t.disable={null:[]},t.document=x,t.flow=j,t.flowInitial=O,t.insideSpan=M,t.string=I,t.text=C},function(e,t,a){"use strict";var n=a(485),i=a(282),s=a(812),r=a(816),o=a(486),l=a(327),c={name:"attention",tokenize:function(e,t){var a,n=s(this.previous);return function(t){return e.enter("attentionSequence"),a=t,i(t)};function i(r){var o,l,c,u;return r===a?(e.consume(r),i):(o=e.exit("attentionSequence"),c=!(l=s(r))||2===l&&n,u=!n||2===n&&l,o._open=42===a?c:c&&(n||!u),o._close=42===a?u:u&&(l||!c),t(r))}},resolveAll:function(e,t){for(var a,s,c,u,d,p,m,g,f=-1;++f<e.length;)if("enter"===e[f][0]&&"attentionSequence"===e[f][1].type&&e[f][1]._close)for(a=f;a--;)if("exit"===e[a][0]&&"attentionSequence"===e[a][1].type&&e[a][1]._open&&t.sliceSerialize(e[a][1]).charCodeAt(0)===t.sliceSerialize(e[f][1]).charCodeAt(0)){if((e[a][1]._close||e[f][1]._open)&&(e[f][1].end.offset-e[f][1].start.offset)%3&&!((e[a][1].end.offset-e[a][1].start.offset+e[f][1].end.offset-e[f][1].start.offset)%3))continue;u={type:(p=e[a][1].end.offset-e[a][1].start.offset>1&&e[f][1].end.offset-e[f][1].start.offset>1?2:1)>1?"strongSequence":"emphasisSequence",start:r(l(e[a][1].end),-p),end:l(e[a][1].end)},d={type:p>1?"strongSequence":"emphasisSequence",start:l(e[f][1].start),end:r(l(e[f][1].start),p)},c={type:p>1?"strongText":"emphasisText",start:l(e[a][1].end),end:l(e[f][1].start)},s={type:p>1?"strong":"emphasis",start:l(u.start),end:l(d.end)},e[a][1].end=l(u.start),e[f][1].start=l(d.end),m=[],e[a][1].end.offset-e[a][1].start.offset&&(m=n(m,[["enter",e[a][1],t],["exit",e[a][1],t]])),m=n(m,[["enter",s,t],["enter",u,t],["exit",u,t],["enter",c,t]]),m=n(m,o(t.parser.constructs.insideSpan.null,e.slice(a+1,f),t)),m=n(m,[["exit",c,t],["enter",d,t],["exit",d,t],["exit",s,t]]),e[f][1].end.offset-e[f][1].start.offset?(g=2,m=n(m,[["enter",e[f][1],t],["exit",e[f][1],t]])):g=0,i(e,a-1,f-a+3,m),f=a+m.length-g-2;break}for(f=-1;++f<e.length;)"attentionSequence"===e[f][1].type&&(e[f][1].type="data");return e}};e.exports=c},function(e,t,a){"use strict";var n=a(283),i=a(813),s=a(815);e.exports=function(e){return null===e||n(e)||s(e)?1:i(e)?2:void 0}},function(e,t,a){"use strict";var n=a(814),i=a(284)(n);e.exports=i},function(e,t,a){"use strict";e.exports=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/},function(e,t,a){"use strict";var n=a(284)(/\s/);e.exports=n},function(e,t,a){"use strict";e.exports=function(e,t){return e.column+=t,e.offset+=t,e._bufferIndex+=t,e}},function(e,t,a){"use strict";var n=a(487),i=a(410),s=a(818),r=a(587),o={name:"autolink",tokenize:function(e,t,a){var o=1;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l};function l(t){return n(t)?(e.consume(t),c):s(t)?p(t):a(t)}function c(e){return 43===e||45===e||46===e||i(e)?u(e):p(e)}function u(t){return 58===t?(e.consume(t),d):(43===t||45===t||46===t||i(t))&&o++<32?(e.consume(t),u):p(t)}function d(t){return 62===t?(e.exit("autolinkProtocol"),b(t)):32===t||60===t||r(t)?a(t):(e.consume(t),d)}function p(t){return 64===t?(e.consume(t),o=0,m):s(t)?(e.consume(t),p):a(t)}function m(e){return i(e)?g(e):a(e)}function g(t){return 46===t?(e.consume(t),o=0,m):62===t?(e.exit("autolinkProtocol").type="autolinkEmail",b(t)):f(t)}function f(t){return(45===t||i(t))&&o++<63?(e.consume(t),45===t?f:g):a(t)}function b(a){return e.enter("autolinkMarker"),e.consume(a),e.exit("autolinkMarker"),e.exit("autolink"),t}}};e.exports=o},function(e,t,a){"use strict";var n=a(284)(/[#-'*+\--9=?A-Z^-~]/);e.exports=n},function(e,t,a){"use strict";var n=a(268),i=a(225),s={name:"blockQuote",tokenize:function(e,t,a){var i=this;return function(t){return 62===t?(i.containerState.open||(e.enter("blockQuote",{_container:!0}),i.containerState.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),s):a(t)};function s(a){return n(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}},continuation:{tokenize:function(e,t,a){return i(e,e.attempt(s,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},exit:function(e){e.exit("blockQuote")}};e.exports=s},function(e,t,a){"use strict";var n=a(821),i={name:"characterEscape",tokenize:function(e,t,a){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),i};function i(i){return n(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):a(i)}}};e.exports=i},function(e,t,a){"use strict";var n=a(284)(/[!-/:-@[-`{-~]/);e.exports=n},function(e,t,a){"use strict";var n=a(588),i=a(410),s=a(589),r=a(823);function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=o(n),c={name:"characterReference",tokenize:function(e,t,a){var n,o,c=this,u=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),d};function d(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),p):(e.enter("characterReferenceValue"),n=31,o=i,m(t))}function p(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),n=6,o=r,m):(e.enter("characterReferenceValue"),n=7,o=s,m(t))}function m(s){var r;return 59===s&&u?(r=e.exit("characterReferenceValue"),o!==i||l.default(c.sliceSerialize(r))?(e.enter("characterReferenceMarker"),e.consume(s),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):a(s)):o(s)&&u++<n?(e.consume(s),m):a(s)}}};e.exports=c},function(e,t,a){"use strict";var n=a(284)(/[\dA-Fa-f]/);e.exports=n},function(e,t,a){"use strict";var n=a(222),i=a(283),s=a(409),r=a(225),o={name:"codeFenced",tokenize:function(e,t,a){var o,l=this,c={tokenize:function(e,t,a){var i=0;return r(e,(function(t){return e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),s(t)}),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4);function s(t){return t===o?(e.consume(t),i++,s):i<d?a(t):(e.exit("codeFencedFenceSequence"),r(e,l,"whitespace")(t))}function l(i){return null===i||n(i)?(e.exit("codeFencedFence"),t(i)):a(i)}},partial:!0},u=s(this.events,"linePrefix"),d=0;return function(t){return e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),o=t,p(t)};function p(t){return t===o?(e.consume(t),d++,p):(e.exit("codeFencedFenceSequence"),d<3?a(t):r(e,m,"whitespace")(t))}function m(t){return null===t||n(t)?h(t):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),g(t))}function g(t){return null===t||i(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),r(e,f,"whitespace")(t)):96===t&&t===o?a(t):(e.consume(t),g)}function f(t){return null===t||n(t)?h(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),b(t))}function b(t){return null===t||n(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),h(t)):96===t&&t===o?a(t):(e.consume(t),b)}function h(a){return e.exit("codeFencedFence"),l.interrupt?t(a):y(a)}function y(t){return null===t?v(t):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),e.attempt(c,v,u?r(e,y,"linePrefix",u+1):y)):(e.enter("codeFlowValue"),E(t))}function E(t){return null===t||n(t)?(e.exit("codeFlowValue"),y(t)):(e.consume(t),E)}function v(a){return e.exit("codeFenced"),t(a)}},concrete:!0};e.exports=o},function(e,t,a){"use strict";var n=a(222),i=a(282),s=a(409),r=a(225),o={name:"codeIndented",tokenize:function(e,t,a){return e.attempt(l,i,a);function i(a){return null===a?t(a):n(a)?e.attempt(l,i,t)(a):(e.enter("codeFlowValue"),s(a))}function s(t){return null===t||n(t)?(e.exit("codeFlowValue"),i(t)):(e.consume(t),s)}},resolve:function(e,t){var a={type:"codeIndented",start:e[0][1].start,end:e[e.length-1][1].end};return i(e,0,0,[["enter",a,t]]),i(e,e.length,0,[["exit",a,t]]),e}},l={tokenize:function(e,t,a){var i=this;return r(e,(function o(l){return n(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),r(e,o,"linePrefix",5)):s(i.events,"linePrefix")<4?a(l):t(l)}),"linePrefix",5)},partial:!0};e.exports=o},function(e,t,a){"use strict";var n=a(222),i={name:"codeText",tokenize:function(e,t,a){var i,s,r=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),o(t)};function o(t){return 96===t?(e.consume(t),r++,o):(e.exit("codeTextSequence"),l(t))}function l(t){return null===t?a(t):96===t?(s=e.enter("codeTextSequence"),i=0,u(t)):32===t?(e.enter("space"),e.consume(t),e.exit("space"),l):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l):(e.enter("codeTextData"),c(t))}function c(t){return null===t||32===t||96===t||n(t)?(e.exit("codeTextData"),l(t)):(e.consume(t),c)}function u(a){return 96===a?(e.consume(a),i++,u):i===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(a)):(s.type="codeTextData",c(a))}},resolve:function(e){var t,a,n=e.length-4,i=3;if(!("lineEnding"!==e[i][1].type&&"space"!==e[i][1].type||"lineEnding"!==e[n][1].type&&"space"!==e[n][1].type))for(t=i;++t<n;)if("codeTextData"===e[t][1].type){e[n][1].type=e[i][1].type="codeTextPadding",i+=2,n-=2;break}for(t=i-1,n++;++t<=n;)void 0===a?t!==n&&"lineEnding"!==e[t][1].type&&(a=t):t!==n&&"lineEnding"!==e[t][1].type||(e[a][1].type="codeTextData",t!==a+2&&(e[a][1].end=e[t-1][1].end,e.splice(a+2,t-a-2),n-=t-a-2,t=a+2),a=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}};e.exports=i},function(e,t,a){"use strict";var n=a(222),i=a(283),s=a(483),r=a(590),o=a(591),l=a(225),c=a(592),u=a(593),d={name:"definition",tokenize:function(e,t,a){var i,u=this;return function(t){return e.enter("definition"),o.call(u,e,d,a,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)};function d(t){return i=s(u.sliceSerialize(u.events[u.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),c(e,r(e,e.attempt(p,l(e,m,"whitespace"),l(e,m,"whitespace")),a,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):a(t)}function m(s){return null===s||n(s)?(e.exit("definition"),u.parser.defined.indexOf(i)<0&&u.parser.defined.push(i),t(s)):a(s)}}},p={tokenize:function(e,t,a){return function(t){return i(t)?c(e,s)(t):a(t)};function s(t){return 34===t||39===t||40===t?u(e,l(e,r,"whitespace"),a,"definitionTitle","definitionTitleMarker","definitionTitleString")(t):a(t)}function r(e){return null===e||n(e)?t(e):a(e)}},partial:!0};e.exports=d},function(e,t,a){"use strict";var n=a(222),i={name:"hardBreakEscape",tokenize:function(e,t,a){return function(t){return e.enter("hardBreakEscape"),e.enter("escapeMarker"),e.consume(t),i};function i(i){return n(i)?(e.exit("escapeMarker"),e.exit("hardBreakEscape"),t(i)):a(i)}}};e.exports=i},function(e,t,a){"use strict";var n=a(222),i=a(283),s=a(268),r=a(282),o=a(225),l={name:"headingAtx",tokenize:function(e,t,a){var r=this,l=0;return function(t){return e.enter("atxHeading"),e.enter("atxHeadingSequence"),c(t)};function c(n){return 35===n&&l++<6?(e.consume(n),c):null===n||i(n)?(e.exit("atxHeadingSequence"),r.interrupt?t(n):u(n)):a(n)}function u(a){return 35===a?(e.enter("atxHeadingSequence"),d(a)):null===a||n(a)?(e.exit("atxHeading"),t(a)):s(a)?o(e,u,"whitespace")(a):(e.enter("atxHeadingText"),p(a))}function d(t){return 35===t?(e.consume(t),d):(e.exit("atxHeadingSequence"),u(t))}function p(t){return null===t||35===t||i(t)?(e.exit("atxHeadingText"),u(t)):(e.consume(t),p)}},resolve:function(e,t){var a,n,i=e.length-2,s=3;return"whitespace"===e[s][1].type&&(s+=2),i-2>s&&"whitespace"===e[i][1].type&&(i-=2),"atxHeadingSequence"===e[i][1].type&&(s===i-1||i-4>s&&"whitespace"===e[i-2][1].type)&&(i-=s+1===i?2:4),i>s&&(a={type:"atxHeadingText",start:e[s][1].start,end:e[i][1].end},n={type:"chunkText",start:e[s][1].start,end:e[i][1].end,contentType:"text"},r(e,s,i-s+1,[["enter",a,t],["enter",n,t],["exit",n,t],["exit",a,t]])),e}};e.exports=l},function(e,t,a){"use strict";var n=a(487),i=a(410),s=a(222),r=a(283),o=a(268),l=a(407),c=a(831),u=a(832),d=a(408),p={name:"htmlFlow",tokenize:function(e,t,a){var d,p,g,f,b,h=this;return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),y};function y(i){return 33===i?(e.consume(i),E):47===i?(e.consume(i),S):63===i?(e.consume(i),d=3,h.interrupt?t:H):n(i)?(e.consume(i),g=l(i),p=!0,T):a(i)}function E(i){return 45===i?(e.consume(i),d=2,v):91===i?(e.consume(i),d=5,g="CDATA[",f=0,k):n(i)?(e.consume(i),d=4,h.interrupt?t:H):a(i)}function v(n){return 45===n?(e.consume(n),h.interrupt?t:H):a(n)}function k(n){return n===g.charCodeAt(f++)?(e.consume(n),f===g.length?h.interrupt?t:P:k):a(n)}function S(t){return n(t)?(e.consume(t),g=l(t),T):a(t)}function T(n){return null===n||47===n||62===n||r(n)?47!==n&&p&&u.indexOf(g.toLowerCase())>-1?(d=1,h.interrupt?t(n):P(n)):c.indexOf(g.toLowerCase())>-1?(d=6,47===n?(e.consume(n),x):h.interrupt?t(n):P(n)):(d=7,h.interrupt?a(n):p?O(n):w(n)):45===n||i(n)?(e.consume(n),g+=l(n),T):a(n)}function x(n){return 62===n?(e.consume(n),h.interrupt?t:P):a(n)}function w(t){return o(t)?(e.consume(t),w):F(t)}function O(t){return 47===t?(e.consume(t),F):58===t||95===t||n(t)?(e.consume(t),j):o(t)?(e.consume(t),O):F(t)}function j(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),j):I(t)}function I(t){return 61===t?(e.consume(t),C):o(t)?(e.consume(t),I):O(t)}function C(t){return null===t||60===t||61===t||62===t||96===t?a(t):34===t||39===t?(e.consume(t),b=t,M):o(t)?(e.consume(t),C):(b=void 0,D(t))}function M(t){return t===b?(e.consume(t),A):null===t||s(t)?a(t):(e.consume(t),M)}function D(t){return null===t||34===t||39===t||60===t||61===t||62===t||96===t||r(t)?I(t):(e.consume(t),D)}function A(e){return 47===e||62===e||o(e)?O(e):a(e)}function F(t){return 62===t?(e.consume(t),R):a(t)}function R(t){return o(t)?(e.consume(t),R):null===t||s(t)?P(t):a(t)}function P(t){return 45===t&&2===d?(e.consume(t),N):60===t&&1===d?(e.consume(t),L):62===t&&4===d?(e.consume(t),$):63===t&&3===d?(e.consume(t),H):93===t&&5===d?(e.consume(t),z):!s(t)||6!==d&&7!==d?null===t||s(t)?_(t):(e.consume(t),P):e.check(m,$,_)(t)}function _(t){return e.exit("htmlFlowData"),q(t)}function q(t){return null===t?V(t):s(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),q):(e.enter("htmlFlowData"),P(t))}function N(t){return 45===t?(e.consume(t),H):P(t)}function L(t){return 47===t?(e.consume(t),g="",B):P(t)}function B(t){return 62===t&&u.indexOf(g.toLowerCase())>-1?(e.consume(t),$):n(t)&&g.length<8?(e.consume(t),g+=l(t),B):P(t)}function z(t){return 93===t?(e.consume(t),H):P(t)}function H(t){return 62===t?(e.consume(t),$):P(t)}function $(t){return null===t||s(t)?(e.exit("htmlFlowData"),V(t)):(e.consume(t),$)}function V(a){return e.exit("htmlFlow"),t(a)}},resolveTo:function(e){for(var t=e.length;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););return t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e},concrete:!0},m={tokenize:function(e,t,a){return function(n){return e.exit("htmlFlowData"),e.enter("lineEndingBlank"),e.consume(n),e.exit("lineEndingBlank"),e.attempt(d,t,a)}},partial:!0};e.exports=p},function(e,t,a){"use strict";e.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},function(e,t,a){"use strict";e.exports=["pre","script","style","textarea"]},function(e,t,a){"use strict";var n=a(487),i=a(410),s=a(222),r=a(283),o=a(268),l=a(225),c={name:"htmlText",tokenize:function(e,t,a){var c,u,d,p,m=this;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),g};function g(t){return 33===t?(e.consume(t),f):47===t?(e.consume(t),I):63===t?(e.consume(t),O):n(t)?(e.consume(t),D):a(t)}function f(t){return 45===t?(e.consume(t),b):91===t?(e.consume(t),u="CDATA[",d=0,k):n(t)?(e.consume(t),w):a(t)}function b(t){return 45===t?(e.consume(t),h):a(t)}function h(t){return null===t||62===t?a(t):45===t?(e.consume(t),y):E(t)}function y(e){return null===e||62===e?a(e):E(e)}function E(t){return null===t?a(t):45===t?(e.consume(t),v):s(t)?(p=E,L(t)):(e.consume(t),E)}function v(t){return 45===t?(e.consume(t),z):E(t)}function k(t){return t===u.charCodeAt(d++)?(e.consume(t),d===u.length?S:k):a(t)}function S(t){return null===t?a(t):93===t?(e.consume(t),T):s(t)?(p=S,L(t)):(e.consume(t),S)}function T(t){return 93===t?(e.consume(t),x):S(t)}function x(t){return 62===t?z(t):93===t?(e.consume(t),x):S(t)}function w(t){return null===t||62===t?z(t):s(t)?(p=w,L(t)):(e.consume(t),w)}function O(t){return null===t?a(t):63===t?(e.consume(t),j):s(t)?(p=O,L(t)):(e.consume(t),O)}function j(e){return 62===e?z(e):O(e)}function I(t){return n(t)?(e.consume(t),C):a(t)}function C(t){return 45===t||i(t)?(e.consume(t),C):M(t)}function M(t){return s(t)?(p=M,L(t)):o(t)?(e.consume(t),M):z(t)}function D(t){return 45===t||i(t)?(e.consume(t),D):47===t||62===t||r(t)?A(t):a(t)}function A(t){return 47===t?(e.consume(t),z):58===t||95===t||n(t)?(e.consume(t),F):s(t)?(p=A,L(t)):o(t)?(e.consume(t),A):z(t)}function F(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),F):R(t)}function R(t){return 61===t?(e.consume(t),P):s(t)?(p=R,L(t)):o(t)?(e.consume(t),R):A(t)}function P(t){return null===t||60===t||61===t||62===t||96===t?a(t):34===t||39===t?(e.consume(t),c=t,_):s(t)?(p=P,L(t)):o(t)?(e.consume(t),P):(e.consume(t),c=void 0,N)}function _(t){return t===c?(e.consume(t),q):null===t?a(t):s(t)?(p=_,L(t)):(e.consume(t),_)}function q(e){return 62===e||47===e||r(e)?A(e):a(e)}function N(t){return null===t||34===t||39===t||60===t||61===t||96===t?a(t):62===t||r(t)?A(t):(e.consume(t),N)}function L(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l(e,B,"linePrefix",m.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function B(t){return e.enter("htmlTextData"),p(t)}function z(n){return 62===n?(e.consume(n),e.exit("htmlTextData"),e.exit("htmlText"),t):a(n)}}};e.exports=c},function(e,t,a){"use strict";var n={name:"labelStartImage",tokenize:function(e,t,a){var n=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),i};function i(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),s):a(t)}function s(e){return 94===e&&"_hiddenFootnoteSupport"in n.parser.constructs?a(e):t(e)}},resolveAll:a(488).resolveAll};e.exports=n},function(e,t,a){"use strict";var n={name:"labelStartLink",tokenize:function(e,t,a){var n=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),i};function i(e){return 94===e&&"_hiddenFootnoteSupport"in n.parser.constructs?a(e):t(e)}},resolveAll:a(488).resolveAll};e.exports=n},function(e,t,a){"use strict";var n=a(225),i={name:"lineEnding",tokenize:function(e,t){return function(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n(e,t,"linePrefix")}}};e.exports=i},function(e,t,a){"use strict";var n=a(589),i=a(268),s=a(409),r=a(584),o=a(225),l=a(408),c=a(594),u={name:"list",tokenize:function(e,t,a){var o=this,u=s(o.events,"linePrefix"),p=0;return function(t){var i=o.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===i?!o.containerState.marker||t===o.containerState.marker:n(t)){if(o.containerState.type||(o.containerState.type=i,e.enter(i,{_container:!0})),"listUnordered"===i)return e.enter("listItemPrefix"),42===t||45===t?e.check(c,a,g)(t):g(t);if(!o.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),m(t)}return a(t)};function m(t){return n(t)&&++p<10?(e.consume(t),m):(!o.interrupt||p<2)&&(o.containerState.marker?t===o.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),g(t)):a(t)}function g(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),o.containerState.marker=o.containerState.marker||t,e.check(l,o.interrupt?a:f,e.attempt(d,h,b))}function f(e){return o.containerState.initialBlankLine=!0,u++,h(e)}function b(t){return i(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),h):a(t)}function h(a){return o.containerState.size=u+r(o.sliceStream(e.exit("listItemPrefix"))),t(a)}},continuation:{tokenize:function(e,t,a){var n=this;return n.containerState._closeFlow=void 0,e.check(l,(function(a){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,o(e,t,"listItemIndent",n.containerState.size+1)(a)}),(function(a){return n.containerState.furtherBlankLines||!i(a)?(n.containerState.furtherBlankLines=n.containerState.initialBlankLine=void 0,s(a)):(n.containerState.furtherBlankLines=n.containerState.initialBlankLine=void 0,e.attempt(p,t,s)(a))}));function s(i){return n.containerState._closeFlow=!0,n.interrupt=void 0,o(e,e.attempt(u,t,a),"linePrefix",n.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)(i)}}},exit:function(e){e.exit(this.containerState.type)}},d={tokenize:function(e,t,a){var n=this;return o(e,(function(e){return i(e)||!s(n.events,"listItemPrefixWhitespace")?a(e):t(e)}),"listItemPrefixWhitespace",n.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:5)},partial:!0},p={tokenize:function(e,t,a){var n=this;return o(e,(function(e){return s(n.events,"listItemIndent")===n.containerState.size?t(e):a(e)}),"listItemIndent",n.containerState.size+1)},partial:!0};e.exports=u},function(e,t,a){"use strict";var n=a(222),i=a(327),s=a(225),r={name:"setextUnderline",tokenize:function(e,t,a){for(var i,r,o=this,l=o.events.length;l--;)if("lineEnding"!==o.events[l][1].type&&"linePrefix"!==o.events[l][1].type&&"content"!==o.events[l][1].type){r="paragraph"===o.events[l][1].type;break}return function(t){return o.lazy||!o.interrupt&&!r?a(t):(e.enter("setextHeadingLine"),e.enter("setextHeadingLineSequence"),i=t,c(t))};function c(t){return t===i?(e.consume(t),c):(e.exit("setextHeadingLineSequence"),s(e,u,"lineSuffix")(t))}function u(i){return null===i||n(i)?(e.exit("setextHeadingLine"),t(i)):a(i)}},resolveTo:function(e,t){for(var a,n,s,r,o=e.length;o--;)if("enter"===e[o][0]){if("content"===e[o][1].type){a=o;break}"paragraph"===e[o][1].type&&(n=o)}else"content"===e[o][1].type&&e.splice(o,1),s||"definition"!==e[o][1].type||(s=o);return r={type:"setextHeading",start:i(e[n][1].start),end:i(e[e.length-1][1].end)},e[n][1].type="setextHeadingText",s?(e.splice(n,0,["enter",r,t]),e.splice(s+1,0,["exit",e[a][1],t]),e[a][1].end=i(e[s][1].end)):e[a][1]=r,e.push(["exit",r,t]),e}};e.exports=r},function(e,t,a){"use strict";var n=/[\0\t\n\r]/g;e.exports=function(){var e,t=!0,a=1,i="";return function(s,r,o){var l,c,u,d,p,m=[];for(s=i+s.toString(r),u=0,i="",t&&(65279===s.charCodeAt(0)&&u++,t=void 0);u<s.length;){if(n.lastIndex=u,d=(l=n.exec(s))?l.index:s.length,p=s.charCodeAt(d),!l){i=s.slice(u);break}if(10===p&&u===d&&e)m.push(-3),e=void 0;else if(e&&(m.push(-5),e=void 0),u<d&&(m.push(s.slice(u,d)),a+=d-u),0===p)m.push(65533),a++;else if(9===p)for(c=4*Math.ceil(a/4),m.push(-2);a++<c;)m.push(-1);else 10===p?(m.push(-4),a=1):(e=!0,a=1);u=d+1}return o&&(e&&m.push(-5),i&&m.push(i),m.push(null)),m}}},function(e,t,a){"use strict";var n=a(585);e.exports=function(e){for(;!n(e););return e}},function(e,t,a){e.exports=a(25)(3394)},function(e,t,a){e.exports=a(25)(1830)},function(e,t,a){e.exports=a(25)(1473)},function(e,t,a){const n=a(845);e.exports=function(e){if(e.allowedElements&&e.disallowedElements)throw new TypeError("Only one of `allowedElements` and `disallowedElements` should be defined");if(e.allowedElements||e.disallowedElements||e.allowElement)return e=>{n(e,"element",t)};function t(t,a,n){const i=t,s=n;let r;if(e.allowedElements?r=!e.allowedElements.includes(i.tagName):e.disallowedElements&&(r=e.disallowedElements.includes(i.tagName)),!r&&e.allowElement&&"number"==typeof a&&(r=!e.allowElement(i,a,s)),r&&"number"==typeof a)return e.unwrapDisallowed&&i.children?s.children.splice(a,1,...i.children):s.children.splice(a,1),a}}},function(e,t,a){e.exports=a(25)(321)},function(e,t){const a=["http","https","mailto","tel"];e.exports=function(e){const t=(e||"").trim(),n=t.charAt(0);if("#"===n||"/"===n)return t;const i=t.indexOf(":");if(-1===i)return t;let s=-1;for(;++s<a.length;){const e=a[s];if(i===e.length&&t.slice(0,e.length).toLowerCase()===e)return t}return s=t.indexOf("?"),-1!==s&&i>s?t:(s=t.indexOf("#"),-1!==s&&i>s?t:"javascript:void(0)")}},function(e,t,a){"use strict";const n=a(4),i=a(149),s=a(848),r=a(849),o=a(850),l=a(851),c=a(852),u=a(853);t.hastToReact=g,t.hastChildrenToReact=m;const d={}.hasOwnProperty,p=new Set(["table","thead","tbody","tfoot","tr"]);function m(e,t){const a=[];let n,i=-1;for(;++i<t.children.length;)n=t.children[i],"element"===n.type?a.push(g(e,n,i,t)):"text"===n.type?"element"===t.type&&p.has(t.tagName)&&"\n"===n.value||a.push(n.value):"raw"!==n.type||e.options.skipHtml||a.push(n.value);return a}function g(e,t,a,r){const o=e.options,l=e.schema,c=t.tagName,u={};let p,g=l;if("html"===l.space&&"svg"===c&&(g=s,e.schema=g),t.properties)for(p in t.properties)d.call(t.properties,p)&&b(u,p,t.properties[p],e);"ol"!==c&&"ul"!==c||e.listDepth++;const h=m(e,t);"ol"!==c&&"ul"!==c||e.listDepth--,e.schema=l;const y=t.position||{start:{line:null,column:null,offset:null},end:{line:null,column:null,offset:null}},E=o.components&&d.call(o.components,c)?o.components[c]:c,v="string"==typeof E||E===n.Fragment;if(!i.isValidElementType(E))throw new TypeError(`Component for name \`${c}\` not defined or is not renderable`);if(u.key=[c,y.start.line,y.start.column,a].join("-"),"a"===c&&o.linkTarget&&(u.target="function"==typeof o.linkTarget?o.linkTarget(u.href,t.children,u.title):o.linkTarget),"a"===c&&o.transformLinkUri&&(u.href=o.transformLinkUri(u.href,t.children,u.title)),v||"code"!==c||"element"!==r.type||"pre"===r.tagName||(u.inline=!0),v||"h1"!==c&&"h2"!==c&&"h3"!==c&&"h4"!==c&&"h5"!==c&&"h6"!==c||(u.level=parseInt(c.charAt(1),10)),"img"===c&&o.transformImageUri&&(u.src=o.transformImageUri(u.src,u.alt,u.title)),!v&&"li"===c&&"element"===r.type){const e=function(e){let t=-1;for(;++t<e.children.length;){const a=e.children[t];if("element"===a.type&&"input"===a.tagName)return a}return null}(t);u.checked=e&&e.properties?Boolean(e.properties.checked):null,u.index=f(r,t),u.ordered="ol"===r.tagName}var k;return v||"ol"!==c&&"ul"!==c||(u.ordered="ol"===c,u.depth=e.listDepth),"td"!==c&&"th"!==c||(u.align&&(u.style||(u.style={}),u.style.textAlign=u.align,delete u.align),v||(u.isHeader="th"===c)),v||"tr"!==c||"element"!==r.type||(u.isHeader=Boolean("thead"===r.tagName)),o.sourcePos&&(u["data-sourcepos"]=[(k=y).start.line,":",k.start.column,"-",k.end.line,":",k.end.column].map((e=>String(e))).join("")),!v&&o.rawSourcePos&&(u.sourcePosition=t.position),!v&&o.includeElementIndex&&(u.index=f(r,t),u.siblingCount=f(r)),v||(u.node=t),h.length>0?n.createElement(E,u,h):n.createElement(E,u)}function f(e,t){let a=-1,n=0;for(;++a<e.children.length&&e.children[a]!==t;)"element"===e.children[a].type&&n++;return n}function b(e,t,a,n){const i=r(n.schema,t);let s=a;null!=s&&s==s&&(s&&"object"==typeof s&&"length"in s&&(s=(i.commaSeparated?c:l).stringify(s)),"style"===i.property&&"string"==typeof s&&(s=function(e){const t={};try{u(e,(function(e,a){const n="-ms-"===e.slice(0,4)?`ms-${e.slice(4)}`:e;t[n.replace(/-([a-z])/g,h)]=a}))}catch(e){}return t}(s)),i.space&&i.property?e[d.call(o,i.property)?o[i.property]:i.property]=s:i.attribute&&(e[i.attribute]=s))}function h(e,t){return t.toUpperCase()}},function(e,t,a){e.exports=a(25)(3456)},function(e,t,a){e.exports=a(25)(1484)},function(e,t,a){e.exports=a(25)(3458)},function(e,t,a){e.exports=a(25)(1485)},function(e,t,a){e.exports=a(25)(1486)},function(e,t,a){e.exports=a(25)(3459)},function(e,t,a){var n,i,s,r;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */r=function(e){var t=Object.prototype.toString,a=Array.isArray||function(e){return"[object Array]"===t.call(e)};function n(e){return"function"==typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function s(e,t){return null!=e&&"object"==typeof e&&t in e}var r=RegExp.prototype.test,o=/\S/;var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},c=/\s*/,u=/\s+/,d=/\s*=/,p=/\s*\}/,m=/#|\^|\/|>|\{|&|=|!/;function g(e){this.string=e,this.tail=e,this.pos=0}function f(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function b(){this.cache={}}g.prototype.eos=function(){return""===this.tail},g.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var a=t[0];return this.tail=this.tail.substring(a.length),this.pos+=a.length,a},g.prototype.scanUntil=function(e){var t,a=this.tail.search(e);switch(a){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,a),this.tail=this.tail.substring(a)}return this.pos+=t.length,t},f.prototype.push=function(e){return new f(e,this)},f.prototype.lookup=function(e){var t,a=this.cache;if(a.hasOwnProperty(e))t=a[e];else{for(var i,r,o=this,l=!1;o;){if(e.indexOf(".")>0)for(t=o.view,i=e.split("."),r=0;null!=t&&r<i.length;)r===i.length-1&&(l=s(t,i[r])),t=t[i[r++]];else t=o.view[e],l=s(o.view,e);if(l)break;o=o.parent}a[e]=t}return n(t)&&(t=t.call(this.view)),t},b.prototype.clearCache=function(){this.cache={}},b.prototype.parse=function(t,n){var s=this.cache,l=s[t];return null==l&&(l=s[t]=function(t,n){if(!t)return[];var s,l,f,b,h=[],y=[],E=[],v=!1,k=!1;function S(){if(v&&!k)for(;E.length;)delete y[E.pop()];else E=[];v=!1,k=!1}function T(e){if("string"==typeof e&&(e=e.split(u,2)),!a(e)||2!==e.length)throw new Error("Invalid tags: "+e);s=new RegExp(i(e[0])+"\\s*"),l=new RegExp("\\s*"+i(e[1])),f=new RegExp("\\s*"+i("}"+e[1]))}T(n||e.tags);for(var x,w,O,j,I,C,M=new g(t);!M.eos();){if(x=M.pos,O=M.scanUntil(s))for(var D=0,A=O.length;D<A;++D)b=j=O.charAt(D),function(e,t){return r.call(e,t)}(o,b)?k=!0:E.push(y.length),y.push(["text",j,x,x+1]),x+=1,"\n"===j&&S();if(!M.scan(s))break;if(v=!0,w=M.scan(m)||"name",M.scan(c),"="===w?(O=M.scanUntil(d),M.scan(d),M.scanUntil(l)):"{"===w?(O=M.scanUntil(f),M.scan(p),M.scanUntil(l),w="&"):O=M.scanUntil(l),!M.scan(l))throw new Error("Unclosed tag at "+M.pos);if(I=[w,O,x,M.pos],y.push(I),"#"===w||"^"===w)h.push(I);else if("/"===w){if(!(C=h.pop()))throw new Error('Unopened section "'+O+'" at '+x);if(C[1]!==O)throw new Error('Unclosed section "'+C[1]+'" at '+x)}else"name"===w||"{"===w||"&"===w?k=!0:"="===w&&T(O)}if(C=h.pop())throw new Error('Unclosed section "'+C[1]+'" at '+M.pos);return function(e){for(var t,a=[],n=a,i=[],s=0,r=e.length;s<r;++s)switch((t=e[s])[0]){case"#":case"^":n.push(t),i.push(t),n=t[4]=[];break;case"/":i.pop()[5]=t[2],n=i.length>0?i[i.length-1][4]:a;break;default:n.push(t)}return a}(function(e){for(var t,a,n=[],i=0,s=e.length;i<s;++i)(t=e[i])&&("text"===t[0]&&a&&"text"===a[0]?(a[1]+=t[1],a[3]=t[3]):(n.push(t),a=t));return n}(y))}(t,n)),l},b.prototype.render=function(e,t,a){var n=this.parse(e),i=t instanceof f?t:new f(t);return this.renderTokens(n,i,a,e)},b.prototype.renderTokens=function(e,t,a,n){for(var i,s,r,o="",l=0,c=e.length;l<c;++l)r=void 0,"#"===(s=(i=e[l])[0])?r=this.renderSection(i,t,a,n):"^"===s?r=this.renderInverted(i,t,a,n):">"===s?r=this.renderPartial(i,t,a,n):"&"===s?r=this.unescapedValue(i,t):"name"===s?r=this.escapedValue(i,t):"text"===s&&(r=this.rawValue(i)),void 0!==r&&(o+=r);return o},b.prototype.renderSection=function(e,t,i,s){var r=this,o="",l=t.lookup(e[1]);if(l){if(a(l))for(var c=0,u=l.length;c<u;++c)o+=this.renderTokens(e[4],t.push(l[c]),i,s);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)o+=this.renderTokens(e[4],t.push(l),i,s);else if(n(l)){if("string"!=typeof s)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(t.view,s.slice(e[3],e[5]),(function(e){return r.render(e,t,i)})))&&(o+=l)}else o+=this.renderTokens(e[4],t,i,s);return o}},b.prototype.renderInverted=function(e,t,n,i){var s=t.lookup(e[1]);if(!s||a(s)&&0===s.length)return this.renderTokens(e[4],t,n,i)},b.prototype.renderPartial=function(e,t,a){if(a){var i=n(a)?a(e[1]):a[e[1]];return null!=i?this.renderTokens(this.parse(i),t,a,i):void 0}},b.prototype.unescapedValue=function(e,t){var a=t.lookup(e[1]);if(null!=a)return a},b.prototype.escapedValue=function(t,a){var n=a.lookup(t[1]);if(null!=n)return e.escape(n)},b.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.2",e.tags=["{{","}}"];var h=new b;return e.clearCache=function(){return h.clearCache()},e.parse=function(e,t){return h.parse(e,t)},e.render=function(e,t,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(a(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return h.render(e,t,n)},e.to_html=function(t,a,i,s){var r=e.render(t,a,i);if(!n(s))return r;s(r)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return l[e]}))},e.Scanner=g,e.Context=f,e.Writer=b,e},t&&"string"!=typeof t.nodeName?r(t):(i=[t],void 0===(s="function"==typeof(n=r)?n.apply(t,i):n)||(e.exports=s))},,,function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(858);case"v8light":return a(860)}},function(e,t,a){var n=a(300),i=a(859);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(301)(!1)).push([e.i,".kbnOverlayMountWrapper{display:flex;flex-direction:column;height:100%}",""]),e.exports=t},function(e,t,a){var n=a(300),i=a(861);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(301)(!1)).push([e.i,".kbnOverlayMountWrapper{display:flex;flex-direction:column;height:100%}",""]),e.exports=t},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(147),i=a(4);t.default=function(e){void 0===e&&(e={});var t=i.useState(e),a=t[0],s=t[1],r=i.useMemo((function(){return{set:function(e,t){s((function(a){var i;return n.__assign(n.__assign({},a),((i={})[e]=t,i))}))},setAll:function(e){s(e)},remove:function(e){s((function(t){var a=t,i=e;return a[i],n.__rest(a,["symbol"==typeof i?i:i+""])}))},reset:function(){return s(e)}}}),[s]),o=n.__assign({get:i.useCallback((function(e){return a[e]}),[a])},r);return[a,o]}},function(e,t,a){e.exports=function e(t,a,n){function i(r,o){if(!a[r]){if(!t[r]){if(s)return s(r,!0);throw new Error("Cannot find module '"+r+"'")}var l=a[r]={exports:{}};t[r][0].call(l.exports,(function(e){return i(t[r][1][e]||e)}),l,l.exports,e,t,a,n)}return a[r].exports}for(var s=!1,r=0;r<n.length;r++)i(n[r]);return i}({1:[function(e,t,a){(function(n,i,s,r,o,l,c,u,d){"use strict";function p(e,t){return function(e,t){var a;if(void 0===(a="passthrough"!==t.algorithm?h.createHash(t.algorithm):new b).write&&(a.write=a.update,a.end=a.update),f(t,a).dispatch(e),a.update||a.end(""),a.digest)return a.digest("buffer"===t.encoding?void 0:t.encoding);var n=a.read();return"buffer"===t.encoding?n:n.toString(t.encoding)}(e,t=m(e,t))}function m(e,t){if((t=t||{}).algorithm=t.algorithm||"sha1",t.encoding=t.encoding||"hex",t.excludeValues=!!t.excludeValues,t.algorithm=t.algorithm.toLowerCase(),t.encoding=t.encoding.toLowerCase(),t.ignoreUnknown=!0===t.ignoreUnknown,t.respectType=!1!==t.respectType,t.respectFunctionNames=!1!==t.respectFunctionNames,t.respectFunctionProperties=!1!==t.respectFunctionProperties,t.unorderedArrays=!0===t.unorderedArrays,t.unorderedSets=!1!==t.unorderedSets,t.unorderedObjects=!1!==t.unorderedObjects,t.replacer=t.replacer||void 0,t.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var a=0;a<y.length;++a)y[a].toLowerCase()===t.algorithm.toLowerCase()&&(t.algorithm=y[a]);if(-1===y.indexOf(t.algorithm))throw new Error('Algorithm "'+t.algorithm+'"  not supported. supported values: '+y.join(", "));if(-1===E.indexOf(t.encoding)&&"passthrough"!==t.algorithm)throw new Error('Encoding "'+t.encoding+'"  not supported. supported values: '+E.join(", "));return t}function g(e){return"function"==typeof e&&null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function f(e,t,a){a=a||[];var n=function(e){return t.update?t.update(e,"utf8"):t.write(e,"utf8")};return{dispatch:function(t){e.replacer&&(t=e.replacer(t));var a=typeof t;return null===t&&(a="null"),this["_"+a](t)},_object:function(t){var i=Object.prototype.toString.call(t),r=/\[object (.*)\]/i.exec(i);r=(r=r?r[1]:"unknown:["+i+"]").toLowerCase();var o;if((o=a.indexOf(t))>=0)return this.dispatch("[CIRCULAR:"+o+"]");if(a.push(t),void 0!==s&&s.isBuffer&&s.isBuffer(t))return n("buffer:"),n(t);if("object"===r||"function"===r){var l=Object.keys(t);e.unorderedObjects&&(l=l.sort()),!1===e.respectType||g(t)||l.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(l=l.filter((function(t){return!e.excludeKeys(t)}))),n("object:"+l.length+":");var c=this;return l.forEach((function(a){c.dispatch(a),n(":"),e.excludeValues||c.dispatch(t[a]),n(",")}))}if(!this["_"+r]){if(e.ignoreUnknown)return n("["+r+"]");throw new Error('Unknown object type "'+r+'"')}this["_"+r](t)},_array:function(t,i){i=void 0!==i?i:!1!==e.unorderedArrays;var s=this;if(n("array:"+t.length+":"),!i||t.length<=1)return t.forEach((function(e){return s.dispatch(e)}));var r=[],o=t.map((function(t){var n=new b,i=a.slice();return f(e,n,i).dispatch(t),r=r.concat(i.slice(a.length)),n.read().toString()}));return a=a.concat(r),o.sort(),this._array(o,!1)},_date:function(e){return n("date:"+e.toJSON())},_symbol:function(e){return n("symbol:"+e.toString())},_error:function(e){return n("error:"+e.toString())},_boolean:function(e){return n("bool:"+e.toString())},_string:function(e){n("string:"+e.length+":"),n(e.toString())},_function:function(t){n("fn:"),g(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this._object(t)},_number:function(e){return n("number:"+e.toString())},_xml:function(e){return n("xml:"+e.toString())},_null:function(){return n("Null")},_undefined:function(){return n("Undefined")},_regexp:function(e){return n("regex:"+e.toString())},_uint8array:function(e){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return n("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return n("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return n("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return n("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return n("url:"+e.toString())},_map:function(t){n("map:");var a=Array.from(t);return this._array(a,!1!==e.unorderedSets)},_set:function(t){n("set:");var a=Array.from(t);return this._array(a,!1!==e.unorderedSets)},_blob:function(){if(e.ignoreUnknown)return n("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return n("domwindow")},_process:function(){return n("process")},_timer:function(){return n("timer")},_pipe:function(){return n("pipe")},_tcp:function(){return n("tcp")},_udp:function(){return n("udp")},_tty:function(){return n("tty")},_statwatcher:function(){return n("statwatcher")},_securecontext:function(){return n("securecontext")},_connection:function(){return n("connection")},_zlib:function(){return n("zlib")},_context:function(){return n("context")},_nodescript:function(){return n("nodescript")},_httpparser:function(){return n("httpparser")},_dataview:function(){return n("dataview")},_signal:function(){return n("signal")},_fsevent:function(){return n("fsevent")},_tlswrap:function(){return n("tlswrap")}}}function b(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}var h=e("crypto");(a=t.exports=p).sha1=function(e){return p(e)},a.keys=function(e){return p(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},a.MD5=function(e){return p(e,{algorithm:"md5",encoding:"hex"})},a.keysMD5=function(e){return p(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var y=h.getHashes?h.getHashes().slice():["sha1","md5"];y.push("passthrough");var E=["buffer","hex","binary","base64"];a.writeToStream=function(e,t,a){return void 0===a&&(a=t,t={}),f(t=m(e,t),a).dispatch(e)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_e8180ef5.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(e,t,a){(function(e,t,n,i,s,r,o,l,c){!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===n||t===l?62:t===i||t===c?63:t<s?-1:t<s+10?t-s+26+26:t<o+26?t-o:t<r+26?t-r+26:void 0}var a="undefined"!=typeof Uint8Array?Uint8Array:Array,n="+".charCodeAt(0),i="/".charCodeAt(0),s="0".charCodeAt(0),r="a".charCodeAt(0),o="A".charCodeAt(0),l="-".charCodeAt(0),c="_".charCodeAt(0);e.toByteArray=function(e){function n(e){c[d++]=e}var i,s,r,o,l,c;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=e.length;l="="===e.charAt(u-2)?2:"="===e.charAt(u-1)?1:0,c=new a(3*e.length/4-l),r=l>0?e.length-4:e.length;var d=0;for(i=0,s=0;i<r;i+=4,s+=3)n((16711680&(o=t(e.charAt(i))<<18|t(e.charAt(i+1))<<12|t(e.charAt(i+2))<<6|t(e.charAt(i+3))))>>16),n((65280&o)>>8),n(255&o);return 2===l?n(255&(o=t(e.charAt(i))<<2|t(e.charAt(i+1))>>4)):1===l&&(n((o=t(e.charAt(i))<<10|t(e.charAt(i+1))<<4|t(e.charAt(i+2))>>2)>>8&255),n(255&o)),c},e.fromByteArray=function(e){function t(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}function a(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var n,i,s,r=e.length%3,o="";for(n=0,s=e.length-r;n<s;n+=3)o+=a(i=(e[n]<<16)+(e[n+1]<<8)+e[n+2]);switch(r){case 1:o+=t((i=e[e.length-1])>>2),o+=t(i<<4&63),o+="==";break;case 2:o+=t((i=(e[e.length-2]<<8)+e[e.length-1])>>10),o+=t(i>>4&63),o+=t(i<<2&63),o+="="}return o}}(void 0===a?this.base64js={}:a)}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(e,t,a){(function(t,n,i,s,r,o,l,c,u){function i(e,t,a){if(!(this instanceof i))return new i(e,t,a);var n,s,r,o=typeof e;if("base64"===t&&"string"===o)for(e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e);e.length%4!=0;)e+="=";if("number"===o)n=M(e);else if("string"===o)n=i.byteLength(e,t);else{if("object"!==o)throw new Error("First argument needs to be a number, array or string.");n=M(e.length)}if(i._useTypedArrays?s=i._augment(new Uint8Array(n)):((s=this).length=n,s._isBuffer=!0),i._useTypedArrays&&"number"==typeof e.byteLength)s._set(e);else if(function(e){return D(e)||i.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}(e))for(r=0;r<n;r++)i.isBuffer(e)?s[r]=e.readUInt8(r):s[r]=e[r];else if("string"===o)s.write(e,0,t);else if("number"===o&&!i._useTypedArrays&&!a)for(r=0;r<n;r++)s[r]=0;return s}function d(e,t,a,n){a=Number(a)||0;var s=e.length-a;n?(n=Number(n))>s&&(n=s):n=s;var r=t.length;B(r%2==0,"Invalid hex string"),n>r/2&&(n=r/2);for(var o=0;o<n;o++){var l=parseInt(t.substr(2*o,2),16);B(!isNaN(l),"Invalid hex string"),e[a+o]=l}return i._charsWritten=2*o,o}function p(e,t,a,n){return i._charsWritten=P(F(t),e,a,n)}function m(e,t,a,n){return i._charsWritten=P(function(e){for(var t=[],a=0;a<e.length;a++)t.push(255&e.charCodeAt(a));return t}(t),e,a,n)}function g(e,t,a,n){return i._charsWritten=P(R(t),e,a,n)}function f(e,t,a,n){return i._charsWritten=P(function(e){for(var t,a,n,i=[],s=0;s<e.length;s++)a=(t=e.charCodeAt(s))>>8,n=t%256,i.push(n),i.push(a);return i}(t),e,a,n)}function b(e,t,a){var n="";a=Math.min(e.length,a);for(var i=t;i<a;i++)n+=String.fromCharCode(e[i]);return n}function h(e,t,a,n){n||(B("boolean"==typeof a,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+1<e.length,"Trying to read beyond buffer length"));var i,s=e.length;if(!(t>=s))return a?(i=e[t],t+1<s&&(i|=e[t+1]<<8)):(i=e[t]<<8,t+1<s&&(i|=e[t+1])),i}function y(e,t,a,n){n||(B("boolean"==typeof a,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+3<e.length,"Trying to read beyond buffer length"));var i,s=e.length;if(!(t>=s))return a?(t+2<s&&(i=e[t+2]<<16),t+1<s&&(i|=e[t+1]<<8),i|=e[t],t+3<s&&(i+=e[t+3]<<24>>>0)):(t+1<s&&(i=e[t+1]<<16),t+2<s&&(i|=e[t+2]<<8),t+3<s&&(i|=e[t+3]),i+=e[t]<<24>>>0),i}function E(e,t,a,n){if(n||(B("boolean"==typeof a,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+1<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=h(e,t,a,!0);return 32768&i?-1*(65535-i+1):i}}function v(e,t,a,n){if(n||(B("boolean"==typeof a,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+3<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=y(e,t,a,!0);return 2147483648&i?-1*(4294967295-i+1):i}}function k(e,t,a,n){return n||(B("boolean"==typeof a,"missing or invalid endian"),B(t+3<e.length,"Trying to read beyond buffer length")),H.read(e,t,a,23,4)}function S(e,t,a,n){return n||(B("boolean"==typeof a,"missing or invalid endian"),B(t+7<e.length,"Trying to read beyond buffer length")),H.read(e,t,a,52,8)}function T(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+1<e.length,"trying to write beyond buffer length"),q(t,65535));var s=e.length;if(!(a>=s))for(var r=0,o=Math.min(s-a,2);r<o;r++)e[a+r]=(t&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function x(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+3<e.length,"trying to write beyond buffer length"),q(t,4294967295));var s=e.length;if(!(a>=s))for(var r=0,o=Math.min(s-a,4);r<o;r++)e[a+r]=t>>>8*(n?r:3-r)&255}function w(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+1<e.length,"Trying to write beyond buffer length"),N(t,32767,-32768)),a>=e.length||T(e,t>=0?t:65535+t+1,a,n,i)}function O(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+3<e.length,"Trying to write beyond buffer length"),N(t,2147483647,-2147483648)),a>=e.length||x(e,t>=0?t:4294967295+t+1,a,n,i)}function j(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+3<e.length,"Trying to write beyond buffer length"),L(t,34028234663852886e22,-34028234663852886e22)),a>=e.length||H.write(e,t,a,n,23,4)}function I(e,t,a,n,i){i||(B(null!=t,"missing value"),B("boolean"==typeof n,"missing or invalid endian"),B(null!=a,"missing offset"),B(a+7<e.length,"Trying to write beyond buffer length"),L(t,17976931348623157e292,-17976931348623157e292)),a>=e.length||H.write(e,t,a,n,52,8)}function C(e,t,a){return"number"!=typeof e?a:(e=~~e)>=t?t:e>=0||(e+=t)>=0?e:0}function M(e){return(e=~~Math.ceil(+e))<0?0:e}function D(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function A(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e){for(var t=[],a=0;a<e.length;a++){var n=e.charCodeAt(a);if(n<=127)t.push(e.charCodeAt(a));else{var i=a;n>=55296&&n<=57343&&a++;for(var s=encodeURIComponent(e.slice(i,a+1)).substr(1).split("%"),r=0;r<s.length;r++)t.push(parseInt(s[r],16))}}return t}function R(e){return z.toByteArray(e)}function P(e,t,a,n){for(var i=0;i<n&&!(i+a>=t.length||i>=e.length);i++)t[i+a]=e[i];return i}function _(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function q(e,t){B("number"==typeof e,"cannot write a non-number as a number"),B(e>=0,"specified a negative value for writing an unsigned value"),B(e<=t,"value is larger than maximum value for type"),B(Math.floor(e)===e,"value has a fractional component")}function N(e,t,a){B("number"==typeof e,"cannot write a non-number as a number"),B(e<=t,"value larger than maximum allowed value"),B(e>=a,"value smaller than minimum allowed value"),B(Math.floor(e)===e,"value has a fractional component")}function L(e,t,a){B("number"==typeof e,"cannot write a non-number as a number"),B(e<=t,"value larger than maximum allowed value"),B(e>=a,"value smaller than minimum allowed value")}function B(e,t){if(!e)throw new Error(t||"Failed assertion")}var z=e("base64-js"),H=e("ieee754");a.Buffer=i,a.SlowBuffer=i,a.INSPECT_MAX_BYTES=50,i.poolSize=8192,i._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.byteLength=function(e,t){var a;switch(e+="",t||"utf8"){case"hex":a=e.length/2;break;case"utf8":case"utf-8":a=F(e).length;break;case"ascii":case"binary":case"raw":a=e.length;break;case"base64":a=R(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=2*e.length;break;default:throw new Error("Unknown encoding")}return a},i.concat=function(e,t){if(B(D(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new i(0);if(1===e.length)return e[0];var a;if("number"!=typeof t)for(t=0,a=0;a<e.length;a++)t+=e[a].length;var n=new i(t),s=0;for(a=0;a<e.length;a++){var r=e[a];r.copy(n,s),s+=r.length}return n},i.prototype.write=function(e,t,a,n){if(isFinite(t))isFinite(a)||(n=a,a=void 0);else{var i=n;n=t,t=a,a=i}t=Number(t)||0;var s,r=this.length-t;switch(a?(a=Number(a))>r&&(a=r):a=r,n=String(n||"utf8").toLowerCase()){case"hex":s=d(this,e,t,a);break;case"utf8":case"utf-8":s=p(this,e,t,a);break;case"ascii":s=m(this,e,t,a);break;case"binary":s=function(e,t,a,n){return m(e,t,a,n)}(this,e,t,a);break;case"base64":s=g(this,e,t,a);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":s=f(this,e,t,a);break;default:throw new Error("Unknown encoding")}return s},i.prototype.toString=function(e,t,a){var n,i=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(a=void 0!==a?Number(a):a=i.length)===t)return"";switch(e){case"hex":n=function(e,t,a){var n=e.length;(!t||t<0)&&(t=0),(!a||a<0||a>n)&&(a=n);for(var i="",s=t;s<a;s++)i+=A(e[s]);return i}(i,t,a);break;case"utf8":case"utf-8":n=function(e,t,a){var n="",i="";a=Math.min(e.length,a);for(var s=t;s<a;s++)e[s]<=127?(n+=_(i)+String.fromCharCode(e[s]),i=""):i+="%"+e[s].toString(16);return n+_(i)}(i,t,a);break;case"ascii":n=b(i,t,a);break;case"binary":n=function(e,t,a){return b(e,t,a)}(i,t,a);break;case"base64":n=function(e,t,a){return 0===t&&a===e.length?z.fromByteArray(e):z.fromByteArray(e.slice(t,a))}(i,t,a);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=function(e,t,a){for(var n=e.slice(t,a),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}(i,t,a);break;default:throw new Error("Unknown encoding")}return n},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},i.prototype.copy=function(e,t,a,n){var s=this;if(a||(a=0),n||0===n||(n=this.length),t||(t=0),n!==a&&0!==e.length&&0!==s.length){B(n>=a,"sourceEnd < sourceStart"),B(t>=0&&t<e.length,"targetStart out of bounds"),B(a>=0&&a<s.length,"sourceStart out of bounds"),B(n>=0&&n<=s.length,"sourceEnd out of bounds"),n>this.length&&(n=this.length),e.length-t<n-a&&(n=e.length-t+a);var r=n-a;if(r<100||!i._useTypedArrays)for(var o=0;o<r;o++)e[o+t]=this[o+a];else e._set(this.subarray(a,a+r),t)}},i.prototype.slice=function(e,t){var a=this.length;if(e=C(e,a,0),t=C(t,a,a),i._useTypedArrays)return i._augment(this.subarray(e,t));for(var n=t-e,s=new i(n,void 0,!0),r=0;r<n;r++)s[r]=this[r+e];return s},i.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},i.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},i.prototype.readUInt8=function(e,t){if(t||(B(null!=e,"missing offset"),B(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},i.prototype.readUInt16LE=function(e,t){return h(this,e,!0,t)},i.prototype.readUInt16BE=function(e,t){return h(this,e,!1,t)},i.prototype.readUInt32LE=function(e,t){return y(this,e,!0,t)},i.prototype.readUInt32BE=function(e,t){return y(this,e,!1,t)},i.prototype.readInt8=function(e,t){if(t||(B(null!=e,"missing offset"),B(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){return E(this,e,!0,t)},i.prototype.readInt16BE=function(e,t){return E(this,e,!1,t)},i.prototype.readInt32LE=function(e,t){return v(this,e,!0,t)},i.prototype.readInt32BE=function(e,t){return v(this,e,!1,t)},i.prototype.readFloatLE=function(e,t){return k(this,e,!0,t)},i.prototype.readFloatBE=function(e,t){return k(this,e,!1,t)},i.prototype.readDoubleLE=function(e,t){return S(this,e,!0,t)},i.prototype.readDoubleBE=function(e,t){return S(this,e,!1,t)},i.prototype.writeUInt8=function(e,t,a){a||(B(null!=e,"missing value"),B(null!=t,"missing offset"),B(t<this.length,"trying to write beyond buffer length"),q(e,255)),t>=this.length||(this[t]=e)},i.prototype.writeUInt16LE=function(e,t,a){T(this,e,t,!0,a)},i.prototype.writeUInt16BE=function(e,t,a){T(this,e,t,!1,a)},i.prototype.writeUInt32LE=function(e,t,a){x(this,e,t,!0,a)},i.prototype.writeUInt32BE=function(e,t,a){x(this,e,t,!1,a)},i.prototype.writeInt8=function(e,t,a){a||(B(null!=e,"missing value"),B(null!=t,"missing offset"),B(t<this.length,"Trying to write beyond buffer length"),N(e,127,-128)),t>=this.length||(e>=0?this.writeUInt8(e,t,a):this.writeUInt8(255+e+1,t,a))},i.prototype.writeInt16LE=function(e,t,a){w(this,e,t,!0,a)},i.prototype.writeInt16BE=function(e,t,a){w(this,e,t,!1,a)},i.prototype.writeInt32LE=function(e,t,a){O(this,e,t,!0,a)},i.prototype.writeInt32BE=function(e,t,a){O(this,e,t,!1,a)},i.prototype.writeFloatLE=function(e,t,a){j(this,e,t,!0,a)},i.prototype.writeFloatBE=function(e,t,a){j(this,e,t,!1,a)},i.prototype.writeDoubleLE=function(e,t,a){I(this,e,t,!0,a)},i.prototype.writeDoubleBE=function(e,t,a){I(this,e,t,!1,a)},i.prototype.fill=function(e,t,a){if(e||(e=0),t||(t=0),a||(a=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),B("number"==typeof e&&!isNaN(e),"value is not a number"),B(a>=t,"end < start"),a!==t&&0!==this.length){B(t>=0&&t<this.length,"start out of bounds"),B(a>=0&&a<=this.length,"end out of bounds");for(var n=t;n<a;n++)this[n]=e}},i.prototype.inspect=function(){for(var e=[],t=this.length,n=0;n<t;n++)if(e[n]=A(this[n]),n===a.INSPECT_MAX_BYTES){e[n+1]="...";break}return"<Buffer "+e.join(" ")+">"},i.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(i._useTypedArrays)return new i(this).buffer;for(var e=new Uint8Array(this.length),t=0,a=e.length;t<a;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var $=i.prototype;i._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=$.get,e.set=$.set,e.write=$.write,e.toString=$.toString,e.toLocaleString=$.toString,e.toJSON=$.toJSON,e.copy=$.copy,e.slice=$.slice,e.readUInt8=$.readUInt8,e.readUInt16LE=$.readUInt16LE,e.readUInt16BE=$.readUInt16BE,e.readUInt32LE=$.readUInt32LE,e.readUInt32BE=$.readUInt32BE,e.readInt8=$.readInt8,e.readInt16LE=$.readInt16LE,e.readInt16BE=$.readInt16BE,e.readInt32LE=$.readInt32LE,e.readInt32BE=$.readInt32BE,e.readFloatLE=$.readFloatLE,e.readFloatBE=$.readFloatBE,e.readDoubleLE=$.readDoubleLE,e.readDoubleBE=$.readDoubleBE,e.writeUInt8=$.writeUInt8,e.writeUInt16LE=$.writeUInt16LE,e.writeUInt16BE=$.writeUInt16BE,e.writeUInt32LE=$.writeUInt32LE,e.writeUInt32BE=$.writeUInt32BE,e.writeInt8=$.writeInt8,e.writeInt16LE=$.writeInt16LE,e.writeInt16BE=$.writeInt16BE,e.writeInt32LE=$.writeInt32LE,e.writeInt32BE=$.writeInt32BE,e.writeFloatLE=$.writeFloatLE,e.writeFloatBE=$.writeFloatBE,e.writeDoubleLE=$.writeDoubleLE,e.writeDoubleBE=$.writeDoubleBE,e.fill=$.fill,e.inspect=$.inspect,e.toArrayBuffer=$.toArrayBuffer,e}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(e,t,a){(function(a,n,i,s,r,o,l,c,u){i=e("buffer").Buffer;var d=4,p=new i(d);p.fill(0);var m=8;t.exports={hash:function(e,t,a,n){return i.isBuffer(e)||(e=new i(e)),function(e,t,a){for(var n=new i(t),s=a?n.writeInt32BE:n.writeInt32LE,r=0;r<e.length;r++)s.call(n,e[r],4*r,!0);return n}(t(function(e,t){if(e.length%d!=0){var a=e.length+(d-e.length%d);e=i.concat([e,p],a)}for(var n=[],s=t?e.readInt32BE:e.readInt32LE,r=0;r<e.length;r+=d)n.push(s.call(e,r));return n}(e,n),e.length*m),a,n)}}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(e,t,a){(function(t,n,i,s,r,o,l,c,u){function d(e,t){var a=b[e=e||"sha1"],n=[];return a||p("algorithm:",e,"is not yet supported"),{update:function(e){return i.isBuffer(e)||(e=new i(e)),n.push(e),e.length,this},digest:function(e){var s=i.concat(n),r=t?function(e,t,a){i.isBuffer(t)||(t=new i(t)),i.isBuffer(a)||(a=new i(a)),t.length>h?t=e(t):t.length<h&&(t=i.concat([t,y],h));for(var n=new i(h),s=new i(h),r=0;r<h;r++)n[r]=54^t[r],s[r]=92^t[r];var o=e(i.concat([n,a]));return e(i.concat([s,o]))}(a,t,s):a(s);return n=null,e?r.toString(e):r}}}function p(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}i=e("buffer").Buffer;var m=e("./sha"),g=e("./sha256"),f=e("./rng"),b={sha1:m,sha256:g,md5:e("./md5")},h=64,y=new i(h);y.fill(0),a.createHash=function(e){return d(e)},a.createHmac=function(e,t){return d(e,t)},a.randomBytes=function(e,t){if(!t||!t.call)return new i(f(e));try{t.call(this,void 0,new i(f(e)))}catch(e){t(e)}},function(e,t){for(var a in e)t(e[a],a)}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],(function(e){a[e]=function(){p("sorry,",e,"is not implemented yet")}}))}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(e,t,a){(function(a,n,i,s,r,o,l,c,u){function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var a=1732584193,n=-271733879,i=-1732584194,s=271733878,r=0;r<e.length;r+=16){var o=a,l=n,c=i,u=s;a=m(a,n,i,s,e[r+0],7,-680876936),s=m(s,a,n,i,e[r+1],12,-389564586),i=m(i,s,a,n,e[r+2],17,606105819),n=m(n,i,s,a,e[r+3],22,-1044525330),a=m(a,n,i,s,e[r+4],7,-176418897),s=m(s,a,n,i,e[r+5],12,1200080426),i=m(i,s,a,n,e[r+6],17,-1473231341),n=m(n,i,s,a,e[r+7],22,-45705983),a=m(a,n,i,s,e[r+8],7,1770035416),s=m(s,a,n,i,e[r+9],12,-1958414417),i=m(i,s,a,n,e[r+10],17,-42063),n=m(n,i,s,a,e[r+11],22,-1990404162),a=m(a,n,i,s,e[r+12],7,1804603682),s=m(s,a,n,i,e[r+13],12,-40341101),i=m(i,s,a,n,e[r+14],17,-1502002290),a=g(a,n=m(n,i,s,a,e[r+15],22,1236535329),i,s,e[r+1],5,-165796510),s=g(s,a,n,i,e[r+6],9,-1069501632),i=g(i,s,a,n,e[r+11],14,643717713),n=g(n,i,s,a,e[r+0],20,-373897302),a=g(a,n,i,s,e[r+5],5,-701558691),s=g(s,a,n,i,e[r+10],9,38016083),i=g(i,s,a,n,e[r+15],14,-660478335),n=g(n,i,s,a,e[r+4],20,-405537848),a=g(a,n,i,s,e[r+9],5,568446438),s=g(s,a,n,i,e[r+14],9,-1019803690),i=g(i,s,a,n,e[r+3],14,-187363961),n=g(n,i,s,a,e[r+8],20,1163531501),a=g(a,n,i,s,e[r+13],5,-1444681467),s=g(s,a,n,i,e[r+2],9,-51403784),i=g(i,s,a,n,e[r+7],14,1735328473),a=f(a,n=g(n,i,s,a,e[r+12],20,-1926607734),i,s,e[r+5],4,-378558),s=f(s,a,n,i,e[r+8],11,-2022574463),i=f(i,s,a,n,e[r+11],16,1839030562),n=f(n,i,s,a,e[r+14],23,-35309556),a=f(a,n,i,s,e[r+1],4,-1530992060),s=f(s,a,n,i,e[r+4],11,1272893353),i=f(i,s,a,n,e[r+7],16,-155497632),n=f(n,i,s,a,e[r+10],23,-1094730640),a=f(a,n,i,s,e[r+13],4,681279174),s=f(s,a,n,i,e[r+0],11,-358537222),i=f(i,s,a,n,e[r+3],16,-722521979),n=f(n,i,s,a,e[r+6],23,76029189),a=f(a,n,i,s,e[r+9],4,-640364487),s=f(s,a,n,i,e[r+12],11,-421815835),i=f(i,s,a,n,e[r+15],16,530742520),a=b(a,n=f(n,i,s,a,e[r+2],23,-995338651),i,s,e[r+0],6,-198630844),s=b(s,a,n,i,e[r+7],10,1126891415),i=b(i,s,a,n,e[r+14],15,-1416354905),n=b(n,i,s,a,e[r+5],21,-57434055),a=b(a,n,i,s,e[r+12],6,1700485571),s=b(s,a,n,i,e[r+3],10,-1894986606),i=b(i,s,a,n,e[r+10],15,-1051523),n=b(n,i,s,a,e[r+1],21,-2054922799),a=b(a,n,i,s,e[r+8],6,1873313359),s=b(s,a,n,i,e[r+15],10,-30611744),i=b(i,s,a,n,e[r+6],15,-1560198380),n=b(n,i,s,a,e[r+13],21,1309151649),a=b(a,n,i,s,e[r+4],6,-145523070),s=b(s,a,n,i,e[r+11],10,-1120210379),i=b(i,s,a,n,e[r+2],15,718787259),n=b(n,i,s,a,e[r+9],21,-343485551),a=h(a,o),n=h(n,l),i=h(i,c),s=h(s,u)}return Array(a,n,i,s)}function p(e,t,a,n,i,s){return h(function(e,t){return e<<t|e>>>32-t}(h(h(t,e),h(n,s)),i),a)}function m(e,t,a,n,i,s,r){return p(t&a|~t&n,e,t,i,s,r)}function g(e,t,a,n,i,s,r){return p(t&n|a&~n,e,t,i,s,r)}function f(e,t,a,n,i,s,r){return p(t^a^n,e,t,i,s,r)}function b(e,t,a,n,i,s,r){return p(a^(t|~n),e,t,i,s,r)}function h(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}var y=e("./helpers");t.exports=function(e){return y.hash(e,d,16)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(e,t,a){(function(e,a,n,i,s,r,o,l,c){!function(){var e,a;e=function(e){for(var t,a=new Array(e),n=0;n<e;n++)0==(3&n)&&(t=4294967296*Math.random()),a[n]=t>>>((3&n)<<3)&255;return a},this.crypto&&crypto.getRandomValues&&(a=function(e){var t=new Uint8Array(e);return crypto.getRandomValues(t),t}),t.exports=a||e}()}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(e,t,a){(function(a,n,i,s,r,o,l,c,u){function d(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var a=Array(80),n=1732584193,i=-271733879,s=-1732584194,r=271733878,o=-1009589776,l=0;l<e.length;l+=16){for(var c=n,u=i,d=s,b=r,h=o,y=0;y<80;y++){a[y]=y<16?e[l+y]:f(a[y-3]^a[y-8]^a[y-14]^a[y-16],1);var E=g(g(f(n,5),p(y,i,s,r)),g(g(o,a[y]),m(y)));o=r,r=s,s=f(i,30),i=n,n=E}n=g(n,c),i=g(i,u),s=g(s,d),r=g(r,b),o=g(o,h)}return Array(n,i,s,r,o)}function p(e,t,a,n){return e<20?t&a|~t&n:e<40?t^a^n:e<60?t&a|t&n|a&n:t^a^n}function m(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function g(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function f(e,t){return e<<t|e>>>32-t}var b=e("./helpers");t.exports=function(e){return b.hash(e,d,20,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(e,t,a){(function(a,n,i,s,r,o,l,c,u){var d=e("./helpers"),p=function(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a},m=function(e,t){return e>>>t|e<<32-t},g=function(e,t){return e>>>t},f=function(e,t,a){return e&t^~e&a},b=function(e,t,a){return e&t^e&a^t&a},h=function(e){return m(e,2)^m(e,13)^m(e,22)},y=function(e){return m(e,6)^m(e,11)^m(e,25)},E=function(e){return m(e,7)^m(e,18)^g(e,3)},v=function(e){return m(e,17)^m(e,19)^g(e,10)},k=function(e,t){var a,n,i,s,r,o,l,c,u,d,m=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),g=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),k=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var S=0;S<e.length;S+=16){a=g[0],n=g[1],i=g[2],s=g[3],r=g[4],o=g[5],l=g[6],c=g[7];for(var T=0;T<64;T++)k[T]=T<16?e[T+S]:p(p(p(v(k[T-2]),k[T-7]),E(k[T-15])),k[T-16]),u=p(p(p(p(c,y(r)),f(r,o,l)),m[T]),k[T]),d=p(h(a),b(a,n,i)),c=l,l=o,o=r,r=p(s,u),s=i,i=n,n=a,a=p(u,d);g[0]=p(a,g[0]),g[1]=p(n,g[1]),g[2]=p(i,g[2]),g[3]=p(s,g[3]),g[4]=p(r,g[4]),g[5]=p(o,g[5]),g[6]=p(l,g[6]),g[7]=p(c,g[7])}return g};t.exports=function(e){return d.hash(e,k,32,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(e,t,a){(function(e,a,n,i,s,r,o,l,c){function u(){}(e=t.exports={}).nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var a=[];return window.addEventListener("message",(function(e){var t=e.source;(t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),a.length>0)&&a.shift()()}),!0),function(e){a.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=u,e.addListener=u,e.once=u,e.off=u,e.removeListener=u,e.removeAllListeners=u,e.emit=u,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(e,t,a){(function(e,t,n,i,s,r,o,l,c){a.read=function(e,t,a,n,i){var s,r,o=8*i-n-1,l=(1<<o)-1,c=l>>1,u=-7,d=a?i-1:0,p=a?-1:1,m=e[t+d];for(d+=p,s=m&(1<<-u)-1,m>>=-u,u+=o;u>0;s=256*s+e[t+d],d+=p,u-=8);for(r=s&(1<<-u)-1,s>>=-u,u+=n;u>0;r=256*r+e[t+d],d+=p,u-=8);if(0===s)s=1-c;else{if(s===l)return r?NaN:1/0*(m?-1:1);r+=Math.pow(2,n),s-=c}return(m?-1:1)*r*Math.pow(2,s-n)},a.write=function(e,t,a,n,i,s){var r,o,l,c=8*s-i-1,u=(1<<c)-1,d=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:s-1,g=n?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,r=u):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),(t+=r+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(r++,l/=2),r+d>=u?(o=0,r=u):r+d>=1?(o=(t*l-1)*Math.pow(2,i),r+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,i),r=0));i>=8;e[a+m]=255&o,m+=g,o/=256,i-=8);for(r=r<<i|o,c+=i;c>0;e[a+m]=255&r,m+=g,r/=256,c-=8);e[a+m-g]|=128*f}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)},function(e,t,a){e.exports=a.p+"94cccf20036d014924e63d4d595e88e1.svg"},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t,a)=>{const n=t.indexOf(e),i=[...t];n>=0?i.splice(n,1):i.push(e),a(i)}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),s=a(47),r=a(79);const o=Object(n.memo)((({children:e})=>{const t=Object(s.useDispatch)();return Object(n.useEffect)((()=>{var e;const a=null===(e=r.a.getLicenseInformation$())||void 0===e?void 0:e.subscribe((e=>{t({type:"licenseChanged",payload:e})}));return()=>null==a?void 0:a.unsubscribe()}),[t]),i.a.createElement(i.a.Fragment,null,e)}));o.displayName="CurrentLicense"},,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return ne}));var n=a(17),i=a(4),s=a.n(i),r=a(175),o=a(6),l=a(223),c=a(47),u=a(5),d=a(1),p=a(9),m=a(226),g=a(24),f=a.n(g),b=a(401);const h={type:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailType",{defaultMessage:"Type"}),os:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailOS",{defaultMessage:"Operating system"})},y=Object(i.memo)((({children:e})=>s.a.createElement(n.EuiTitle,{size:"xxs"},s.a.createElement("h5",null,e))));y.displayName="ConfigFormHeading";const E=Object(i.memo)((({type:e,supportedOss:t,osRestriction:a,dataTestSubj:o,rightCorner:l,children:c})=>{const u=Object(i.useContext)(g.ThemeContext).eui.euiPanelPaddingModifiers.paddingMedium;return s.a.createElement(n.EuiPanel,{"data-test-subj":o,hasBorder:!0,hasShadow:!1,paddingSize:"none"},s.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center",style:{padding:`${u} ${u} 0 ${u}`}},s.a.createElement(n.EuiFlexItem,{grow:1},s.a.createElement(y,null,h.type),s.a.createElement(n.EuiText,{size:"s"},e)),s.a.createElement(n.EuiFlexItem,{grow:2},s.a.createElement(y,null,h.os),s.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiText,{size:"s"},t.map((e=>b.a[e])).join(", ")," ")),a&&s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"xs"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiTextColor,{color:"subdued"},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.antivirusRegistration.osRestriction",defaultMessage:"Restrictions"}))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiIconTip,{type:"iInCircle",color:"subdued",content:a})))))),s.a.createElement(n.EuiShowFor,{sizes:["m","l","xl"]},s.a.createElement(n.EuiFlexItem,{grow:3},s.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"none",justifyContent:"flexEnd"},s.a.createElement(n.EuiFlexItem,{grow:!1},l)))),s.a.createElement(n.EuiShowFor,{sizes:l?["s","xs"]:[]},s.a.createElement(n.EuiFlexItem,null,l))),s.a.createElement(n.EuiHorizontalRule,{margin:"m"}),s.a.createElement("div",{style:{padding:`0 ${u} ${u} ${u}`}},c))}));E.displayName="ConfigForm";var v=a(339),k=a(79),S=a(228),T=a(231);const x=s.a.memo((({protection:e,protectionMode:t,osList:a,label:r})=>{const o=Object(S.c)(T.l),l=Object(c.useDispatch)(),d=Object(i.useMemo)((()=>Object(n.htmlIdGenerator)()()),[]),p=o&&o.windows[e].mode,g=Object(k.b)().isPlatinumPlus(),f=Object(i.useCallback)((()=>{if(o){const n=Object(u.cloneDeep)(o);for(const i of a)("windows"===i||"mac"===i||"linux"===i)&&(n[i][e].mode=t),g&&("windows"===i||"mac"===i||"linux"===i)&&(t===m.e.prevent?n[i].popup[e].enabled=!0:n[i].popup[e].enabled=!1);l({type:"userChangedPolicyConfig",payload:{policyConfig:n}})}}),[l,t,o,g,a,e]);return s.a.createElement(n.EuiRadio,{className:"policyDetailsProtectionRadio",label:r,id:d,checked:p===t,onChange:f,disabled:p===m.e.off})}));x.displayName="ProtectionRadio";const w=f()(n.EuiFlexGroup).withConfig({displayName:"RadioFlexGroup",componentId:"sc-5bp4yp-0"})([".no-right-margin-radio{margin-right:0;}.no-horizontal-margin-radio{margin:"," 0;}"],(e=>e.theme.eui.euiSizeM)),O=s.a.memo((({protection:e,osList:t})=>{const a=Object(i.useMemo)((()=>[{id:m.e.detect,label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.detect",{defaultMessage:"Detect"})},{id:m.e.prevent,label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.prevent",{defaultMessage:"Prevent"})}]),[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(y,null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.protectionLevel",defaultMessage:"Protection level"})),s.a.createElement(n.EuiSpacer,{size:"xs"}),s.a.createElement(w,null,s.a.createElement(n.EuiFlexItem,{className:"no-right-margin-radio",grow:1},s.a.createElement(x,{protection:e,protectionMode:a[0].id,osList:t,key:{protection:e}+a[0].id,label:a[0].label})),s.a.createElement(n.EuiFlexItem,{className:"no-horizontal-margin-radio",grow:5},s.a.createElement(x,{protection:e,protectionMode:a[1].id,osList:t,key:{protection:e}+a[1].id,label:a[1].label}))))}));O.displayName="RadioButtons";const j=new Map([["malware","7.11+"],["ransomware","7.12+"],["memory_protection","7.15+"],["behavior_protection","7.15+"]]),I=({optionName:e})=>{const t=j.get(e);return t?s.a.createElement(n.EuiText,{color:"subdued",size:"xs","data-test-subj":"policySupportedVersions"},s.a.createElement("i",null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetails.supportedVersion",defaultMessage:"Agent version {version}",values:{version:t}}))):null},C=s.a.memo((({protection:e,osList:t})=>{const a=Object(S.c)(T.l),l=Object(c.useDispatch)(),d=a&&a.windows[e].mode,p=a&&a.windows.popup[e].enabled,g=a&&a.windows.popup[e].message,f=Object(i.useCallback)((n=>{if(a){const i=Object(u.cloneDeep)(a);for(const a of t)("windows"===a||"mac"===a||"linux"===a)&&(i[a].popup[e].enabled=n.target.checked);l({type:"userChangedPolicyConfig",payload:{policyConfig:i}})}}),[a,l,e,t]),b=Object(i.useCallback)((n=>{if(a){const i=Object(u.cloneDeep)(a);for(const a of t)("windows"===a||"mac"===a||"linux"===a)&&(i[a].popup[e].message=n.target.value);l({type:"userChangedPolicyConfig",payload:{policyConfig:i}})}}),[a,l,e,t]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(y,null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.userNotification",defaultMessage:"User notification"})),s.a.createElement(I,{optionName:e}),s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(n.EuiCheckbox,{"data-test-subj":`${e}UserNotificationCheckbox`,id:`${e}UserNotificationCheckbox}`,onChange:f,checked:p,disabled:d===m.e.off,label:o.i18n.translate("xpack.securitySolution.endpoint.policyDetail.notifyUser",{defaultMessage:"Notify user"})}),p&&s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(n.EuiFlexGroup,{gutterSize:"xs"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiText,{size:"s"},s.a.createElement("h4",null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.customizeUserNotification",defaultMessage:"Customize notification message"})))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiIconTip,{position:"right","data-test-subj":`${e}Tooltip`,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.notifyUserTooltip.a",defaultMessage:"Selecting the user notification option will display a notification to the host user when { protectionName } is prevented or detected.",values:{protectionName:(h=e,"memory_protection"===h?o.i18n.translate("xpack.securitySolution.endpoint.policyDetail.memoryProtectionTooltip",{defaultMessage:"memory threat"}):"behavior_protection"===h?o.i18n.translate("xpack.securitySolution.endpoint.policyDetail.behaviorProtectionTooltip",{defaultMessage:"malicious behavior"}):h)}}),s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.notifyUserTooltip.c",defaultMessage:" The user notification can be customized in the text box below. Bracketed tags can be used to dynamically populate the applicable action (such as prevented or detected) and the { bracketText }.",values:{bracketText:(t=>"memory_protection"===t||"behavior_protection"===e?o.i18n.translate("xpack.securitySolution.endpoint.policyDetail.rule",{defaultMessage:"rule"}):o.i18n.translate("xpack.securitySolution.endpoint.policyDetail.filename",{defaultMessage:"filename"}))(e)}}))}))),s.a.createElement(n.EuiSpacer,{size:"xs"}),s.a.createElement(n.EuiTextArea,{placeholder:o.i18n.translate("xpack.securitySolution.endpoint.policyDetails.userNotification.placeholder",{defaultMessage:"Input your custom notification message"}),value:g,onChange:b,fullWidth:!0,"data-test-subj":`${e}UserNotificationCustomMessage`})));var h}));C.displayName="UserNotification";const M=s.a.memo((({protection:e,protectionLabel:t,osList:a,additionalOnSwitchChange:r})=>{const l=Object(S.c)(T.l),d=Object(k.b)().isPlatinumPlus(),p=Object(c.useDispatch)(),g=l&&l.windows[e].mode,f=Object(i.useCallback)((t=>{if(l){const n=Object(u.cloneDeep)(l);if(!1===t.target.checked)for(const i of a)("windows"===i||"mac"===i||"linux"===i)&&(n[i][e].mode=m.e.off),d&&("windows"===i||"mac"===i||"linux"===i)&&(n[i].popup[e].enabled=t.target.checked);else for(const i of a)("windows"===i||"mac"===i||"linux"===i)&&(n[i][e].mode=m.e.prevent),d&&("windows"===i||"mac"===i||"linux"===i)&&(n[i].popup[e].enabled=t.target.checked);p(r?{type:"userChangedPolicyConfig",payload:{policyConfig:r({value:t.target.checked,policyConfigData:n,protectionOsList:a})}}:{type:"userChangedPolicyConfig",payload:{policyConfig:n}})}}),[p,l,d,e,a,r]);return s.a.createElement(n.EuiSwitch,{label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.protectionsEnabled",{defaultMessage:"{protectionLabel} {mode, select, true {enabled} false {disabled}}",values:{protectionLabel:t,mode:g!==m.e.off}}),checked:g!==m.e.off,onChange:f})}));M.displayName="ProtectionSwitch";const D=s.a.memo((()=>{const e=Object(i.useMemo)((()=>[m.d.windows,m.d.mac,m.d.linux]),[]),t="malware",a=o.i18n.translate("xpack.securitySolution.endpoint.policy.protections.malware",{defaultMessage:"Malware protections"}),g=o.i18n.translate("xpack.securitySolution.endpoint.policy.protections.blocklist",{defaultMessage:"Blocklist enabled"}),f=Object(k.b)().isPlatinumPlus(),b=Object(c.useDispatch)(),h=Object(S.c)(T.l),y=({value:e,policyConfigData:t,protectionOsList:a})=>{const n=Object(u.cloneDeep)(t);for(const t of a)n[t].malware.blocklist=e;return n},x=Object(i.useCallback)((t=>{if(h){const a=y({value:t.target.checked,policyConfigData:Object(u.cloneDeep)(h),protectionOsList:e});b({type:"userChangedPolicyConfig",payload:{policyConfig:a}})}}),[b,e,h]);return s.a.createElement(E,{type:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.malware",{defaultMessage:"Malware"}),supportedOss:[l.c.WINDOWS,l.c.MAC,l.c.LINUX],dataTestSubj:"malwareProtectionsForm",rightCorner:s.a.createElement(M,{protection:t,protectionLabel:a,osList:e,additionalOnSwitchChange:y})},s.a.createElement(O,{protection:t,osList:e}),s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(n.EuiFlexGroup,{gutterSize:"xs"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiSwitch,{label:g,checked:h.windows.malware.blocklist,onChange:x,disabled:"off"===h.windows.malware.mode})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiIconTip,{position:"right",content:s.a.createElement(s.a.Fragment,null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.blocklistTooltip",defaultMessage:"Enables or disables the blocklist associated with this policy. The blocklist is a collection hashes, paths, or signers which extends the list of processes the endpoint considers malicious. See the blocklist tab for entry details."}))}))),f&&s.a.createElement(C,{protection:t,osList:e}),s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(n.EuiCallOut,{iconType:"iInCircle"},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged “Elastic” on the Detection Rules page.",values:{detectionRulesLink:s.a.createElement(v.a,{appId:d.A,deepLinkId:p.a.rules},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))}));D.displayName="MalwareProtections";const A=s.a.memo((()=>{const e=[m.d.windows,m.d.mac,m.d.linux],t="memory_protection",a=o.i18n.translate("xpack.securitySolution.endpoint.policy.protections.memory",{defaultMessage:"Memory threat protections"});return s.a.createElement(E,{type:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.memory_protection",{defaultMessage:"Memory threat"}),supportedOss:[l.c.WINDOWS,l.c.MAC,l.c.LINUX],dataTestSubj:"memoryProtectionsForm",rightCorner:s.a.createElement(M,{protection:t,protectionLabel:a,osList:e})},s.a.createElement(O,{protection:t,osList:e}),s.a.createElement(C,{protection:t,osList:e}),s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(n.EuiCallOut,{iconType:"iInCircle"},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged “Elastic” on the Detection Rules page.",values:{detectionRulesLink:s.a.createElement(v.a,{appId:d.A,deepLinkId:p.a.rules},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))}));A.displayName="MemoryProtection";const F=s.a.memo((()=>{const e=[m.d.windows,m.d.mac,m.d.linux],t="behavior_protection",a=o.i18n.translate("xpack.securitySolution.endpoint.policy.protections.behavior",{defaultMessage:"Malicious behavior protections"});return s.a.createElement(E,{type:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.behavior_protection",{defaultMessage:"Malicious behavior"}),supportedOss:[l.c.WINDOWS,l.c.MAC,l.c.LINUX],dataTestSubj:"behaviorProtectionsForm",rightCorner:s.a.createElement(M,{protection:t,protectionLabel:a,osList:e})},s.a.createElement(O,{protection:t,osList:e}),s.a.createElement(C,{protection:t,osList:e}),s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(n.EuiCallOut,{iconType:"iInCircle"},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged “Elastic” on the Detection Rules page.",values:{detectionRulesLink:s.a.createElement(v.a,{appId:d.A,deepLinkId:p.a.rules},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))}));F.displayName="BehaviorProtection";const R=e=>t=>a=>n=>i=>{const s=Object(u.cloneDeep)(e);return s[t][a][n]=i,s},P={[l.c.WINDOWS]:"Windows",[l.c.LINUX]:"Linux",[l.c.MAC]:"Mac"},_=({os:e,options:t,selection:a,onValueSelection:r,supplementalOptions:l})=>{const c=Object(S.c)(T.l),u=Object(i.useContext)(g.ThemeContext),d=Object(i.useCallback)((()=>{const e=l?l.map((e=>e.protectionField)):[];return Object.entries(a).filter((([t,a])=>!e.includes(t)&&a)).length}),[a,l]);return s.a.createElement(E,{type:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.eventCollection",{defaultMessage:"Event collection"}),supportedOss:[e],rightCorner:s.a.createElement(n.EuiText,{size:"s",color:"subdued"},o.i18n.translate("xpack.securitySolution.endpoint.policy.details.eventCollectionsEnabled",{defaultMessage:"{selected} / {total} event collections enabled",values:{selected:d(),total:t.length}}))},s.a.createElement(y,null,o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.eventingEvents",{defaultMessage:"Events"})),s.a.createElement(n.EuiSpacer,{size:"s"}),t.map((({name:t,protectionField:i})=>s.a.createElement(n.EuiCheckbox,{key:String(i),id:Object(n.htmlIdGenerator)()(),label:t,"data-test-subj":`policy${P[e]}Event_${i}`,checked:a[i],onChange:e=>r(i,e.target.checked)}))),l&&l.map((({title:t,description:i,name:o,protectionField:l,tooltipText:d,beta:p,indented:m,isDisabled:g})=>s.a.createElement("div",{key:String(l),style:m?{paddingLeft:u.eui.euiSizeL}:{}},t&&s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(y,null,t)),i&&s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(n.EuiText,{size:"xs",color:"subdued"},i)),s.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(n.EuiCheckbox,{id:Object(n.htmlIdGenerator)()(),label:o,"data-test-subj":`policy${P[e]}Event_${l}`,checked:a[l],onChange:e=>r(l,e.target.checked),disabled:!!g&&g(c)})),d&&s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiIconTip,{position:"right",content:d})),p&&s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiBetaBadge,{label:"beta",size:"s"})))))))};_.displayName="EventsForm";const q=s.a.memo(_),N=[{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dllDriverLoad",{defaultMessage:"DLL and Driver Load"}),protectionField:"dll_and_driver_load"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dns",{defaultMessage:"DNS"}),protectionField:"dns"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.network",{defaultMessage:"Network"}),protectionField:"network"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.registry",{defaultMessage:"Registry"}),protectionField:"registry"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.security",{defaultMessage:"Security"}),protectionField:"security"}],L=Object(i.memo)((()=>{const e=Object(S.c)(T.l),t=Object(c.useDispatch)();return s.a.createElement(q,{os:l.c.WINDOWS,selection:e.windows.events,options:N,onValueSelection:(a,n)=>t({type:"userChangedPolicyConfig",payload:{policyConfig:R(e)("windows")("events")(a)(n)}})})}));L.displayName="WindowsEvents";const B=[{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.network",{defaultMessage:"Network"}),protectionField:"network"}],z=Object(i.memo)((()=>{const e=Object(S.c)(T.l),t=Object(c.useDispatch)();return s.a.createElement(q,{os:l.c.MAC,selection:e.mac.events,options:B,onValueSelection:(a,n)=>t({type:"userChangedPolicyConfig",payload:{policyConfig:R(e)("mac")("events")(a)(n)}})})}));z.displayName="MacEvents";const H=[{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.network",{defaultMessage:"Network"}),protectionField:"network"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.process",{defaultMessage:"Process"}),protectionField:"process"}],$=[{title:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_data.title",{defaultMessage:"Session data"}),description:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_data.description",{defaultMessage:"Turn this on to capture the extended process data required for Session View. Session View provides you a visual representation of session and process execution data. Session View data is organized according to the Linux process model to help you investigate process, user, and service activity on your Linux infrastructure."}),name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_data",{defaultMessage:"Collect session data"}),protectionField:"session_data",isDisabled:e=>!e.linux.events.process},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.tty_io",{defaultMessage:"Capture terminal output"}),protectionField:"tty_io",tooltipText:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.tty_io.tooltip",{defaultMessage:"Turn this on to collect terminal (tty) output. Terminal output appears in Session View, and you can view it separately to see what commands were executed and how they were typed, provided the terminal is in echo mode. Only works on hosts that support ebpf."}),indented:!0,isDisabled:e=>!e.linux.events.session_data,beta:!0}],V=Object(i.memo)((()=>{const e=Object(S.c)(T.l),t=Object(c.useDispatch)();return s.a.createElement(q,{os:l.c.LINUX,selection:e.linux.events,options:H,supplementalOptions:$,onValueSelection:(a,n)=>{let i=R(e)("linux")("events")(a)(n);"session_data"!==a||n||(i=R(i)("linux")("events")("tty_io")(!1)),t({type:"userChangedPolicyConfig",payload:{policyConfig:i}})}})}));V.displayName="LinuxEvents";var U=a(619);const Q={title:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.type",{defaultMessage:"Register as antivirus"}),description:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.explanation",{defaultMessage:"Toggle on to register Elastic as an official Antivirus solution for Windows OS. This will also disable Windows Defender."}),label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.toggle",{defaultMessage:"Register as antivirus"})},W=Object(i.memo)((()=>{const e=Object(S.c)(T.d),t=Object(c.useDispatch)(),a=Object(i.useCallback)((e=>t({type:"userChangedAntivirusRegistration",payload:{enabled:e.target.checked}})),[t]);return s.a.createElement(E,{type:Q.title,supportedOss:[l.c.WINDOWS],osRestriction:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.av.windowsServerNotSupported",{defaultMessage:"Windows Server operating systems unsupported"})},s.a.createElement(n.EuiText,{size:"s"},Q.description),s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(n.EuiSwitch,{label:Q.label,checked:e,onChange:a}))}));W.displayName="AntivirusRegistrationForm";const G={title:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.attackSurfaceReduction.type",{defaultMessage:"Attack surface reduction"}),label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.credentialHardening.toggle",{defaultMessage:"Credential hardening"})},K=Object(i.memo)((()=>{const e=Object(S.c)(T.e),t=Object(c.useDispatch)(),a=Object(i.useCallback)((e=>t({type:"userChangedCredentialHardening",payload:{enabled:e.target.checked}})),[t]);return s.a.createElement(E,{type:G.title,supportedOss:[l.c.WINDOWS]},s.a.createElement(n.EuiSwitch,{label:G.label,checked:e,onChange:a}))}));K.displayName="AttackSurfaceReductionForm";const J=s.a.memo((()=>{const e=[m.d.windows],t="ransomware",a=o.i18n.translate("xpack.securitySolution.endpoint.policy.protections.ransomware",{defaultMessage:"Ransomware protections"});return s.a.createElement(E,{type:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.ransomware",{defaultMessage:"Ransomware"}),supportedOss:[l.c.WINDOWS],dataTestSubj:"ransomwareProtectionsForm",rightCorner:s.a.createElement(M,{protectionLabel:a,protection:t,osList:e})},s.a.createElement(O,{protection:t,osList:e}),s.a.createElement(C,{protection:t,osList:e}),s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(n.EuiCallOut,{iconType:"iInCircle"},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged “Elastic” on the Detection Rules page.",values:{detectionRulesLink:s.a.createElement(v.a,{appId:d.A,deepLinkId:p.a.rules},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))}));J.displayName="RansomwareProtections";const Y=f.a.div.withConfig({displayName:"LockedPolicyDiv",componentId:"sc-pvk7p4-0"})([".euiCard__betaBadgeWrapper{.euiCard__betaBadge{width:auto;}}.lockedCardDescription{padding:0 ",";}"],(e=>e.theme.eui.fractions.thirds.percentage)),X=Object(i.memo)((({title:e})=>s.a.createElement(Y,null,s.a.createElement(n.EuiCard,{"data-test-subj":"lockedPolicyCard",betaBadgeProps:{label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.platinum",{defaultMessage:"Platinum"})},isDisabled:!0,icon:s.a.createElement(n.EuiIcon,{size:"xl",type:"lock"}),title:s.a.createElement("h3",null,s.a.createElement("strong",null,e)),description:!1},s.a.createElement(n.EuiFlexGroup,{className:"lockedCardDescription",direction:"column",gutterSize:"none"},s.a.createElement(n.EuiText,null,s.a.createElement(n.EuiFlexItem,null,s.a.createElement("h4",null,s.a.createElement(n.EuiTextColor,{color:"subdued"},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.upgradeToPlatinum",defaultMessage:"Upgrade to Elastic Platinum"})))),s.a.createElement(n.EuiFlexItem,null,s.a.createElement("p",null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.lockedCardUpgradeMessage",defaultMessage:"To turn on this protection, you must upgrade your license to Platinum, start a free 30-day trial, or spin up a {cloudDeploymentLink} on AWS, GCP, or Azure.",values:{cloudDeploymentLink:s.a.createElement(n.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank"},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.cloudDeploymentLInk",defaultMessage:"cloud deployment"}))}})))))))));X.displayName="LockedPolicyCard";const Z=o.i18n.translate("xpack.securitySolution.endpoint.policy.details.ransomware",{defaultMessage:"Ransomware"}),ee=o.i18n.translate("xpack.securitySolution.endpoint.policy.details.memory",{defaultMessage:"Memory Threat"}),te=o.i18n.translate("xpack.securitySolution.endpoint.policy.details.behavior",{defaultMessage:"Malicious Behavior"}),ae=o.i18n.translate("xpack.securitySolution.endpoint.policy.details.attack_surface_reduction",{defaultMessage:"Attack Surface Reduction"}),ne=Object(i.memo)((()=>{const[e,t]=Object(i.useState)(!1),a=Object(i.useCallback)((()=>{t(!e)}),[e]),o=Object(k.b)().isPlatinumPlus();return s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiText,{size:"xs",color:"subdued"},s.a.createElement("h4",null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.protections",defaultMessage:"Protections"}))),s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(D,null),s.a.createElement(n.EuiSpacer,{size:"l"}),o?s.a.createElement(J,null):s.a.createElement(X,{title:Z}),s.a.createElement(n.EuiSpacer,{size:"l"}),o?s.a.createElement(A,null):s.a.createElement(X,{title:ee}),s.a.createElement(n.EuiSpacer,{size:"l"}),o?s.a.createElement(F,null):s.a.createElement(X,{title:te}),s.a.createElement(n.EuiSpacer,{size:"l"}),o?s.a.createElement(K,null):s.a.createElement(X,{title:ae}),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(n.EuiText,{size:"xs",color:"subdued"},s.a.createElement("h4",null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.settings",defaultMessage:"Settings"}))),s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(L,null),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(z,null),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(V,null),s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(W,null),s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(n.EuiButtonEmpty,{"data-test-subj":"advancedPolicyButton",onClick:a},s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.advanced.show",defaultMessage:"{action} advanced settings",values:{action:e?"Hide":"Show"}})),s.a.createElement(n.EuiSpacer,{size:"l"}),e&&s.a.createElement(U.a,{isPlatinumPlus:o}))}));ne.displayName="PolicyDetailsForm"},,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return D}));var n=a(4),i=a.n(n),s=a(17),r=a(175),o=a(19),l=a(211),c=a(218),u=a(288),d=a(24),p=a.n(d),m=a(226),g=a(11),f=a.n(g),b=a(6);const h=Object.freeze(new Map([["logging",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.logging",{defaultMessage:"Logging"})],["streaming",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.streaming",{defaultMessage:"Streaming"})],["malware",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.malware",{defaultMessage:"Malware"})],["events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.events",{defaultMessage:"Events"})],["memory_protection",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.memory_protection",{defaultMessage:"Memory Threat"})],["behavior_protection",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.behavior_protection",{defaultMessage:"Malicious Behavior"})]])),y=Object.freeze(new Map([["configure_dns_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_dns_events",{defaultMessage:"Configure DNS Events"})],["configure_elasticsearch_connection",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_elasticsearch_connection",{defaultMessage:"Configure Elasticsearch Connection"})],["configure_file_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_file_events",{defaultMessage:"Configure File Events"})],["configure_imageload_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_imageload_events",{defaultMessage:"Configure Image Load Events"})],["configure_kernel",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_kernel",{defaultMessage:"Configure Kernel"})],["configure_logging",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_logging",{defaultMessage:"Configure Logging"})],["configure_malware",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_malware",{defaultMessage:"Configure Malware"})],["configure_network_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_network_events",{defaultMessage:"Configure Network Events"})],["configure_process_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_process_events",{defaultMessage:"Configure Process Events"})],["configure_registry_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_registry_events",{defaultMessage:"Configure Registry Events"})],["configure_security_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_security_events",{defaultMessage:"Configure Security Events"})],["connect_kernel",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.connect_kernel",{defaultMessage:"Connect Kernel"})],["detect_async_image_load_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_async_image_load_events",{defaultMessage:"Detect Async Image Load Events"})],["detect_file_open_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_file_open_events",{defaultMessage:"Detect File Open Events"})],["detect_file_write_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_file_write_events",{defaultMessage:"Detect File Write Events"})],["detect_network_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_network_events",{defaultMessage:"Detect Network Events"})],["detect_process_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_process_events",{defaultMessage:"Detect Process Events"})],["detect_registry_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_registry_events",{defaultMessage:"Detect Registry Events"})],["detect_sync_image_load_events",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_sync_image_load_events",{defaultMessage:"Detect Sync Image Load Events"})],["download_global_artifacts",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.download_global_artifacts",{defaultMessage:"Download Global Artifacts"})],["download_user_artifacts",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.download_user_artifacts",{defaultMessage:"Download User Artifacts"})],["load_config",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.load_config",{defaultMessage:"Load Config"})],["load_malware_model",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.load_malware_model",{defaultMessage:"Load Malware Model"})],["read_elasticsearch_config",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_elasticsearch_config",{defaultMessage:"Read Elasticsearch Config"})],["read_events_config",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_events_config",{defaultMessage:"Read Events Config"})],["read_kernel_config",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_kernel_config",{defaultMessage:"Read Kernel Config"})],["read_logging_config",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_logging_config",{defaultMessage:"Read Logging Config"})],["read_malware_config",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_malware_config",{defaultMessage:"Read Malware Config"})],["workflow",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.workflow",{defaultMessage:"Workflow"})],["full_disk_access",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.full_disk_access",{defaultMessage:"Full Disk Access"})],["macos_system_ext",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.macos_system_ext",{defaultMessage:"Permissions required"})],["linux_deadlock",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.linux_deadlock",{defaultMessage:"Disabled to avoid potential system deadlock"})]])),E=Object.freeze(new Map([[m.a.success,b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.success",{defaultMessage:"Success"})],[m.a.warning,b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.warning",{defaultMessage:"Warning"})],[m.a.failure,b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.failed",{defaultMessage:"Failed"})],[m.a.unsupported,b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.unsupported",{defaultMessage:"Unsupported"})]])),v=Object.freeze(new Map([["full_disk_access",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.description.full_disk_access",{defaultMessage:"You must enable full disk access for Elastic Endpoint on your machine."})],["macos_system_ext",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.description.macos_system_ext",{defaultMessage:"You must enable the Mac system extension for Elastic Endpoint on your machine."})],["linux_deadlock",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.description.linux_deadlock",{defaultMessage:"Malware protection was disabled to avoid a potential system deadlock. To resolve this issue, the file systems causing this need to be identified in integration policy advanced settings (linux.advanced.fanotify.ignored_filesystems). Learn more in our"})]])),k=Object.freeze(new Map([["full_disk_access",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.link.text.full_disk_access",{defaultMessage:" Learn more."})],["macos_system_ext",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.link.text.macos_system_ext",{defaultMessage:" Learn more."})],["linux_deadlock",b.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.link.text.linux_deadlock",{defaultMessage:" troubleshooting docs."})]])),S=new Set(["load_malware_model","configure_malware"]);function T(e,t){return"macos"===e&&"connect_kernel"===t.name&&t.status===m.a.failure}function x(e,t){return"linux"===e&&S.has(t.name)&&"Disabled due to potential system deadlock"===t.message}class policy_response_friendly_names_PolicyResponseActionFormatter{constructor(e,t,a=""){var n;f()(this,"key",void 0),f()(this,"title",void 0),f()(this,"description",void 0),f()(this,"hasError",void 0),f()(this,"errorTitle",void 0),f()(this,"errorDescription",void 0),f()(this,"status",void 0),f()(this,"linkText",void 0),this.policyResponseAppliedAction=e,this.docLinks=t,this.os=a,this.key=e.name,this.title=null!==(n=y.get(this.errorKey||this.key))&&void 0!==n?n:this.key.replace(/_/g," ").replace(/\b(\w)/g,(e=>e.toUpperCase())),this.hasError=e.status===m.a.failure||e.status===m.a.warning,this.description=v.get(this.key)||e.message,this.errorDescription=v.get(this.errorKey||this.key)||this.policyResponseAppliedAction.message,this.errorTitle=this.errorDescription?this.title:e.name,this.status=E.get(e.status),this.linkText=k.get(this.errorKey||this.key)}get linkUrl(){return this.docLinks[this.errorKey]}get isGeneric(){return e=this.os,t=this.policyResponseAppliedAction,!!("macos"===e&&"full_disk_access"===t.name||T(this.os,this.policyResponseAppliedAction)||x(this.os,this.policyResponseAppliedAction));var e,t}get errorKey(){return T(this.os,this.policyResponseAppliedAction)?"macos_system_ext":x(this.os,this.policyResponseAppliedAction)?"linux_deadlock":this.policyResponseAppliedAction.name}}const w=p()(s.EuiCallOut).withConfig({displayName:"StyledEuiCallout",componentId:"sc-15759fc-0"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),O=p()(s.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-15759fc-1"})(["white-space:break-spaces;text-align:left;line-height:inherit;"]),j=Object(n.memo)((({policyResponseActionFormatter:e})=>e.hasError?i.a.createElement(w,{title:e.errorTitle,color:"danger",iconType:"alert","data-test-subj":"endpointPolicyResponseErrorCallOut"},i.a.createElement(O,{size:"s","data-test-subj":"endpointPolicyResponseMessage"},e.errorDescription,e.linkText&&e.linkUrl&&i.a.createElement(s.EuiLink,{target:"_blank",href:e.linkUrl,"data-test-subj":"endpointPolicyResponseErrorCallOutLink"},e.linkText))):i.a.createElement(O,{size:"xs","data-test-subj":"endpointPolicyResponseMessage"},e.description||e.title)));j.displayName="PolicyResponseActionItem";const I=p()(s.EuiTreeView).withConfig({displayName:"StyledEuiTreeView",componentId:"sc-a7dddx-0"})([".policy-response-action-item-expanded{height:auto;padding-top:",";padding-bottom:",";.euiTreeView__nodeLabel{width:100%;}}.policyResponseStatusHealth{padding-top:5px;}.euiTreeView__node--expanded{max-height:none !important;.policy-response-action-expanded + div{.euiTreeView__node{max-height:none !important;}}}.euiTreeView__node{max-height:none !important;.euiNotificationBadge{margin-right:5px;}.euiTreeView__nodeLabel{.euiText{font-size:",";}}}"],(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiFontSize)),C=Object(n.memo)((({hostOs:e,policyResponseConfig:t,policyResponseActions:a,policyResponseAttentionCount:l})=>{const{docLinks:c}=Object(o.k)().services,u=Object(n.useCallback)(((e,t)=>e===m.a.success?i.a.createElement(s.EuiHealth,{color:"success","data-test-subj":"endpointPolicyResponseStatusSuccessHealth",className:"policyResponseStatusHealth"}):e===m.a.unsupported?i.a.createElement(s.EuiHealth,{color:"subdued","data-test-subj":"endpointPolicyResponseStatusSuccessHealth",className:"policyResponseStatusHealth"}):i.a.createElement(s.EuiNotificationBadge,{"data-test-subj":"endpointPolicyResponseStatusAttentionHealth"},t)),[]),d=Object(n.useCallback)((t=>t.map((t=>{const n=a.find((e=>e.name===t)),r=new policy_response_friendly_names_PolicyResponseActionFormatter(n||{},c.links.securitySolution.policyResponseTroubleshooting,e);return{label:i.a.createElement(s.EuiText,{color:n.status!==m.a.success&&n.status!==m.a.unsupported?"danger":"default","data-test-subj":"endpointPolicyResponseAction"},r.title),id:t,className:n.status!==m.a.success&&n.status!==m.a.unsupported?"policy-response-action-expanded":"",icon:u(n.status,n.status!==m.a.success?1:0),children:[{label:i.a.createElement(j,{policyResponseActionFormatter:r}),id:`action_message_${t}`,isExpanded:!0,className:"policy-response-action-item-expanded"}]}}))),[c.links.securitySolution.policyResponseTroubleshooting,u,a,e]),p=Object(n.useCallback)((()=>Object.entries(t).map((([e,t])=>{const a=l.get(e);return{label:i.a.createElement(s.EuiText,{color:a?"danger":"default",size:"s","data-test-subj":"endpointPolicyResponseConfig"},(n=e,h.has(n)||h.set(n,n.replace(/_/g," ").replace(/\b(\w)/g,(e=>e.toUpperCase()))),h.get(n))),id:e,icon:a?i.a.createElement(s.EuiNotificationBadge,{"data-test-subj":"endpointPolicyResponseStatusAttentionHealth"},a):i.a.createElement(s.EuiHealth,{color:"success","data-test-subj":"endpointPolicyResponseStatusSuccessHealth",className:"policyResponseStatusHealth"}),children:d(t.concerned_actions)};var n}))),[d,l,t]),g=Object(n.useCallback)((()=>{let e=0;for(const t of l.values())e+=t;return[{label:i.a.createElement(s.EuiText,{color:e?"danger":"default",size:"s","data-test-subj":"endpointPolicyResponseTitle"},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyResponse.title",defaultMessage:"Policy Response"})),id:"policyResponse",icon:e?i.a.createElement(s.EuiNotificationBadge,{"data-test-subj":"endpointPolicyResponseStatusHealth"},e):void 0,children:p()}]}),[p,l])();return i.a.createElement(I,{items:g,showExpansionArrows:!0,"aria-label":"policyResponseTreeView","aria-labelledby":"policyResponseTreeView"})}));C.displayName="PolicyResponse";var M=a(526);const D=Object(n.memo)((({endpointId:e,showRevisionMessage:t=!0,onShowNeedsAttentionBadge:a})=>{var d,p,g;const{data:f,isLoading:b,isFetching:h,isError:y}=function(e,t){const a=Object(o.j)();return Object(c.useQuery)(["getEndpointPolicyResponse",e],(()=>a.get(u.c,{query:{agentId:e}})),void 0)}(e),{data:E}=Object(M.b)(e),{docLinks:v}=Object(o.k)().services,[k,S]=Object(n.useState)(),[T,x]=Object(n.useState)(),[w,O]=Object(n.useState)(new Map);Object(n.useEffect)((()=>{!f||b||h||y||(S(f.policy_response.Endpoint.policy.applied.response.configurations),x(f.policy_response.Endpoint.policy.applied.actions),O((e=>{var t;const a=new Map;return void 0!==(null==e||null===(t=e.response)||void 0===t?void 0:t.configurations)&&void 0!==(null==e?void 0:e.actions)&&Object.entries(e.response.configurations).map((([t,n])=>{let i=0;for(const t of n.concerned_actions){var s;const a=null===(s=e.actions.find((e=>e.name===t)))||void 0===s?void 0:s.status;a!==m.a.failure&&a!==m.a.warning||(i+=1)}return a.set(t,i)})),a})(f.policy_response.Endpoint.policy.applied)))}),[f,b,h,y]),Object(n.useEffect)((()=>{if(a)for(const e of w.values())if(e)return void a(!0)}),[w,a]);const I=Object(n.useMemo)((()=>k||T?null==T?void 0:T.reduce(((e,t)=>{const a=new policy_response_friendly_names_PolicyResponseActionFormatter(t,v.links.securitySolution.policyResponseTroubleshooting,null==E?void 0:E.metadata.host.os.name.toLowerCase());return a.isGeneric&&a.hasError&&e.push(a),e}),[]):[]),[v.links.securitySolution.policyResponseTroubleshooting,T,k,null==E?void 0:E.metadata.host.os.name]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiText,{size:"xs",color:"subdued","data-test-subj":"endpointPolicyResponseTimestamp"},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyResponse.appliedOn",defaultMessage:"Revision {rev} applied on {date}",values:{rev:null!==(d=null==f?void 0:f.policy_response.Endpoint.policy.applied.endpoint_policy_version)&&void 0!==d?d:"",date:i.a.createElement(l.d,{value:null!==(p=null==f?void 0:f.policy_response["@timestamp"])&&void 0!==p?p:""})}})),i.a.createElement(s.EuiSpacer,{size:"s"})),y&&i.a.createElement(s.EuiEmptyPrompt,{title:i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.noPolicyResponse",defaultMessage:"No policy response available"})}),b&&i.a.createElement(s.EuiLoadingSpinner,{size:"m"}),void 0!==k&&void 0!==T&&i.a.createElement(i.a.Fragment,null,i.a.createElement(C,{hostOs:null!==(g=null==E?void 0:E.metadata.host.os.name.toLowerCase())&&void 0!==g?g:"",policyResponseConfig:k,policyResponseActions:T,policyResponseAttentionCount:w}),i.a.createElement(s.EuiSpacer,{size:"m"}),null==I?void 0:I.map((e=>i.a.createElement(i.a.Fragment,{key:e.key},i.a.createElement(j,{policyResponseActionFormatter:e}),i.a.createElement(s.EuiSpacer,{size:"m"}))))))}));D.displayName="PolicyResponse"},,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(57),i=a(610),s=a(209),r=a(270),o=a(427);const l=()=>({hosts:[],pageSize:10,pageIndex:0,total:0,loading:!1,error:void 0,endpointDetails:{hostDetails:{details:void 0,detailsLoading:!1,detailsError:void 0}},policyResponse:void 0,policyResponseLoading:!1,policyResponseError:void 0,location:void 0,policyItems:[],selectedPolicyId:void 0,policyItemsLoading:!1,endpointPackageInfo:Object(o.e)(),nonExistingPolicies:{},agentPolicies:{},endpointsExist:!0,patterns:[],patternsError:void 0,isAutoRefreshEnabled:!0,autoRefreshInterval:s.a,agentsWithEndpointsTotal:0,agentsWithEndpointsTotalError:void 0,endpointsTotal:0,endpointsTotalError:void 0,policyVersionInfo:void 0,hostStatus:void 0,isolationRequestState:Object(o.e)(),endpointPendingActions:Object(o.c)(new Map),metadataTransformStats:Object(o.e)()}),c=n.combineReducers,u=(s.v,Object(i.a)(),s.t,l(),c({[s.v]:i.c,[s.t]:(e=l(),t)=>{if("serverReturnedEndpointList"===t.type){const{data:a,total:n,page:i,pageSize:s}=t.payload;return{...e,hosts:a,total:n,pageIndex:i,pageSize:s,loading:!1,error:void 0}}if("serverFailedToReturnEndpointList"===t.type)return{...e,error:t.payload,loading:!1};if("serverReturnedEndpointNonExistingPolicies"===t.type)return{...e,nonExistingPolicies:{...e.nonExistingPolicies,...t.payload}};if("serverReturnedEndpointAgentPolicies"===t.type)return{...e,agentPolicies:{...e.agentPolicies,...t.payload}};if("serverReturnedMetadataPatterns"===t.type)return{...e,patterns:t.payload,patternsError:void 0};if("serverFailedToReturnMetadataPatterns"===t.type)return{...e,patternsError:t.payload};if("serverReturnedEndpointDetails"===t.type)return{...e,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,details:t.payload.metadata,detailsLoading:!1,detailsError:void 0}},policyVersionInfo:t.payload.policy_info,hostStatus:t.payload.host_status};if("serverFailedToReturnEndpointDetails"===t.type)return{...e,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsError:t.payload,detailsLoading:!1}}};if("endpointPendingActionsStateChanged"===t.type)return((e,t)=>Object(r.isOnEndpointPage)(e)?{...e,endpointPendingActions:t.payload}:e)(e,t);if("serverReturnedPoliciesForOnboarding"===t.type)return{...e,policyItems:t.payload.policyItems,policyItemsLoading:!1};if("serverFailedToReturnPoliciesForOnboarding"===t.type)return{...e,error:t.payload,policyItemsLoading:!1};if("serverReturnedEndpointPolicyResponse"===t.type)return{...e,policyResponse:t.payload.policy_response,policyResponseLoading:!1,policyResponseError:void 0};if("serverFailedToReturnEndpointPolicyResponse"===t.type)return{...e,policyResponseError:t.payload,policyResponseLoading:!1};if("userSelectedEndpointPolicy"===t.type)return{...e,selectedPolicyId:t.payload.selectedPolicyId,policyResponseLoading:!1};if("serverCancelledEndpointListLoading"===t.type)return{...e,loading:!1};if("serverCancelledPolicyItemsLoading"===t.type)return{...e,policyItemsLoading:!1};if("endpointPackageInfoStateChanged"===t.type)return((e,t)=>({...e,endpointPackageInfo:t.payload}))(e,t);if("serverReturnedEndpointExistValue"===t.type)return{...e,endpointsExist:t.payload};if("serverReturnedAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotal:t.payload,agentsWithEndpointsTotalError:void 0};if("serverFailedToReturnAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotalError:t.payload};if("serverReturnedEndpointsTotal"===t.type)return{...e,endpointsTotal:t.payload,endpointsTotalError:void 0};if("serverFailedToReturnEndpointsTotal"===t.type)return{...e,endpointsTotalError:t.payload};var a,n;if("userUpdatedEndpointListRefreshOptions"===t.type)return{...e,isAutoRefreshEnabled:null!==(a=t.payload.isAutoRefreshEnabled)&&void 0!==a?a:e.isAutoRefreshEnabled,autoRefreshInterval:null!==(n=t.payload.autoRefreshInterval)&&void 0!==n?n:e.autoRefreshInterval};if("endpointIsolationRequestStateChange"===t.type)return((e,t)=>({...e,isolationRequestState:t.payload}))(e,t);if("userChangedUrl"===t.type){const a={...e,location:t.payload},n=Object(r.isOnEndpointPage)(a)&&!Object(r.hasSelectedEndpoint)(a),i=Object(r.isOnEndpointPage)(e)&&!Object(r.hasSelectedEndpoint)(e),s=Object(r.isOnEndpointPage)(a)&&Object(r.hasSelectedEndpoint)(a),l=Object(r.isOnEndpointPage)(e)&&Object(r.hasSelectedEndpoint)(e),c=Object(r.isOnEndpointPage)(e)&&Object(r.hasSelectedEndpoint)(e)&&Object(r.getIsOnEndpointDetailsActivityLog)(e),u=Object(r.isOnEndpointPage)(a)&&Object(r.hasSelectedEndpoint)(a)&&Object(r.getIsOnEndpointDetailsActivityLog)(a)||c&&Object(r.uiQueryParams)(e).selected_endpoint===Object(r.uiQueryParams)(a).selected_endpoint,d={location:t.payload,error:void 0,policyResponseError:void 0};if("isolate"===Object(r.uiQueryParams)(a).show||Object(o.i)(Object(r.getCurrentIsolationRequestState)(a))||(d.isolationRequestState=Object(o.e)()),n){if(!i)return{...e,...d,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsError:void 0}},loading:!0,policyItemsLoading:!0}}else if(s)return l||i?{...e,...d,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsLoading:!u,detailsError:void 0}},detailsLoading:!0,policyResponseLoading:!0}:{...e,...d,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsLoading:!0,detailsError:void 0}},loading:!0,policyResponseLoading:!0,policyItemsLoading:!0};return{...e,...d,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsError:void 0}},endpointsExist:!0}}return"metadataTransformStatsChanged"===t.type?((e,t)=>({...e,metadataTransformStats:t.payload}))(e,t):e}}))},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a(78),i=a(209),s=a(610),r=a(375),o=a.n(r),l=a(288),c=a(537),u=a(690),d=a(538),p=a(656),m=a(427),g=a(447),f=a(270);const b=console.error,h=(e,t)=>{async function a(e){var a;const n=null!==(a=Object(f.endpointPackageVersion)(e))&&void 0!==a?a:"",i=n.includes("-")?n.substring(0,n.indexOf("-")):n,s=o()(i,"1.2.0")?l.k:l.o,{indexPatterns:r}=t.data;return[{title:s,fields:await r.getFieldsForWildcard({pattern:s})}]}return t=>n=>async i=>{n(i);const{getState:s,dispatch:r}=t;if(await async function(e,t,a){if(Object(f.getIsEndpointPackageInfoUninitialized)(e)){t({type:"endpointPackageInfoStateChanged",payload:Object(m.d)(Object(m.a)(Object(f.endpointPackageInfo)(e)))});try{const e=await Object(g.d)(a.http);t({type:"endpointPackageInfoStateChanged",payload:Object(m.c)(e)})}catch(e){b(e),t({type:"endpointPackageInfoStateChanged",payload:Object(m.b)(e)})}}}(s(),r,e),"userChangedUrl"!==i.type&&"appRequestedEndpointList"!==i.type||!Object(f.isOnEndpointPage)(s())||Object(f.hasSelectedEndpoint)(s())||await async function({store:e,coreStart:t,fetchIndexPatterns:a}){const{getState:n,dispatch:i}=e,{page_index:s,page_size:r}=Object(f.uiQueryParams)(n());let o;try{const a=Object(f.searchBarQuery)(n());o=await t.http.get(l.g,{query:{page:s,pageSize:r,kuery:a.query}}),i({type:"serverReturnedEndpointList",payload:o}),k(e);try{i({type:"serverReturnedEndpointsTotal",payload:await E(t.http)})}catch(e){i({type:"serverFailedToReturnEndpointsTotal",payload:e})}try{i({type:"serverReturnedAgenstWithEndpointsTotal",payload:(await Object(g.f)(t.http)).total})}catch(e){i({type:"serverFailedToReturnAgenstWithEndpointsTotal",payload:e})}T({http:t.http,hosts:o.data,store:e})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}if(0===Object(f.patterns)(n()).length)try{const e=await a(n());void 0!==e&&i({type:"serverReturnedMetadataPatterns",payload:e})}catch(e){i({type:"serverFailedToReturnMetadataPatterns",payload:e})}if(o&&0===o.data.length){const e=t.http;if(await(async e=>{try{return await E(e)>0}catch(e){b("error while trying to check if endpoints exist"),b(e)}return!1})(e))return;i({type:"serverReturnedEndpointExistValue",payload:!1});try{i({type:"serverReturnedPoliciesForOnboarding",payload:{policyItems:(await Object(p.a)(e,{query:{perPage:50,page:1}})).items}})}catch(e){var c;i({type:"serverFailedToReturnPoliciesForOnboarding",payload:null!==(c=e.body)&&void 0!==c?c:e})}}else i({type:"serverCancelledPolicyItemsLoading"}),i({type:"serverReturnedEndpointExistValue",payload:!0})}({coreStart:e,store:t,fetchIndexPatterns:a}),"userChangedUrl"===i.type&&Object(f.hasSelectedEndpoint)(s())){const{selected_endpoint:a}=Object(f.uiQueryParams)(s());await async function({coreStart:e,selectedEndpoint:t,store:a}){const{getState:n,dispatch:i}=a;if(i({type:"serverCancelledPolicyItemsLoading"}),0===Object(f.listData)(n()).length){const{page_index:t,page_size:s}=Object(f.uiQueryParams)(n());try{const n=await e.http.get(l.g,{query:{page:t,pageSize:s}});i({type:"serverReturnedEndpointList",payload:n}),T({http:e.http,hosts:n.data,store:a})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}}else i({type:"serverCancelledEndpointListLoading"});void 0!==t&&await S({store:a,coreStart:e,selectedEndpoint:t})}({store:t,coreStart:e,selectedEndpoint:a})}return"endpointDetailsLoad"===i.type&&await S({store:t,coreStart:e,selectedEndpoint:i.payload.endpointId}),"endpointIsolationRequest"===i.type?v(t,i):"loadMetadataTransformStats"===i.type?async function(e,t){const{getState:a,dispatch:n}=t;if(!e||!a||!n)return;const i=a();if(!Object(f.isMetadataTransformStatsLoading)(i)){n({type:"metadataTransformStatsChanged",payload:Object(m.d)(Object(m.a)(Object(f.getMetadataTransformStats)(i)))});try{const t=await e.get(l.j);n({type:"metadataTransformStatsChanged",payload:Object(m.c)(t.transforms)})}catch(e){n({type:"metadataTransformStatsChanged",payload:Object(m.b)(e)})}}}(e.http,t):void 0}},y=async(e,t,a)=>{if(0===t.length)return;const n=[...new Set(t.reduce(((e,t)=>{const n=t.metadata.Endpoint.policy.applied.id;return a[n]||e.push(n),e}),[]))];if(0===n.length)return;const i=(await Object(g.c)(e,n)).items.reduce(((e,t)=>(e.packagePolicy[t.id]=!0,e.agentPolicy[t.id]=t.policy_id,e)),{packagePolicy:{},agentPolicy:{}}),s=n.reduce(((e,t)=>i.packagePolicy[t]?(e.agentPolicy[t]=i.agentPolicy[t],e):(e.packagePolicy[t]=!0,e)),{packagePolicy:{},agentPolicy:{}});return 0!==Object.keys(s.packagePolicy).length||0!==Object.keys(s.agentPolicy).length?s:void 0},E=async e=>{try{return(await e.get(l.g,{query:{page:0,pageSize:1}})).total}catch(e){b("error while trying to check for total endpoints"),b(e)}return 0},v=async({getState:e,dispatch:t},a)=>{const n=e();if(!Object(f.getIsIsolationRequestPending)(n)){t({type:"endpointIsolationRequestStateChange",payload:Object(m.d)(Object(m.a)(Object(f.getCurrentIsolationRequestState)(n)))});try{let e;e="unisolate"===a.payload.type?await Object(c.b)(a.payload.data):await Object(c.a)(a.payload.data),t({type:"endpointIsolationRequestStateChange",payload:Object(m.c)(e)})}catch(e){var i;t({type:"endpointIsolationRequestStateChange",payload:Object(m.b)(null!==(i=e.body)&&void 0!==i?i:e)})}}},k=async({getState:e,dispatch:t})=>{const a=e(),n=Object(f.detailsData)(a),i=Object(f.listData)(a),s=new Set;n&&s.add(n.elastic.agent.id);for(const e of i)s.add(e.metadata.elastic.agent.id);if(0!==s.size)try{const{data:e}=await Object(u.a)(Array.from(s)),a=new Map;for(const t of e)a.set(t.agent_id,t.pending_actions);t({type:"endpointPendingActionsStateChanged",payload:Object(m.c)(a)})}catch(e){b(e)}};async function S({selectedEndpoint:e,store:t,coreStart:a}){const{getState:n,dispatch:i}=t;try{const t=await a.http.get(Object(d.a)(l.f,{id:e}));i({type:"serverReturnedEndpointDetails",payload:t});try{const e=await y(a.http,[t],Object(f.nonExistingPolicies)(n()));void 0!==e&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){b(e)}}catch(e){i({type:"serverFailedToReturnEndpointDetails",payload:e})}k(t);try{i({type:"serverReturnedEndpointPolicyResponse",payload:await a.http.get(l.c,{query:{agentId:e}})})}catch(e){i({type:"serverFailedToReturnEndpointPolicyResponse",payload:e})}}async function T({store:e,hosts:t,http:a}){const{getState:n,dispatch:i}=e;try{const e=await y(a,t,Object(f.nonExistingPolicies)(n()));void 0!==(null==e?void 0:e.packagePolicy)&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){b(e)}}const x=e=>t=>t[i.u][e],w=(e,t)=>[Object(n.h)(x(i.v),Object(s.b)(e,t)),Object(n.h)(x(i.t),h(e,t))]},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),s=a(17),r=a(175);const o=Object(n.memo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiEmptyPrompt,{iconType:"alert",iconColor:"danger",titleSize:"l","data-test-subj":"noIngestPermissions",title:i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpointManagemnet.noPermissionsText",defaultMessage:"You do not have the required Kibana permissions to use Elastic Security Administration"}),body:i.a.createElement(s.EuiText,{color:"subdued"},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.endpointManagement.noPermissionsSubText",defaultMessage:"You must have the superuser role to use this feature. If you do not have the superuser role and do not have permissions to edit user roles, contact your Kibana administrator."}))}))));o.displayName="NoPermissions"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=p,p.Minimatch=m;var n=function(){try{return a(1189)}catch(e){}}()||{sep:"/"};p.sep=n.sep;var i=p.GLOBSTAR=m.GLOBSTAR={},s=a(1190),r={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},o="[^/]",l="[^/]*?",c="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{}),u=/\/+/;function d(e,t){t=t||{};var a={};return Object.keys(e).forEach((function(t){a[t]=e[t]})),Object.keys(t).forEach((function(e){a[e]=t[e]})),a}function p(e,t,a){return f(t),a||(a={}),!(!a.nocomment&&"#"===t.charAt(0))&&new m(t,a).match(e)}function m(e,t){if(!(this instanceof m))return new m(e,t);f(e),t||(t={}),e=e.trim(),t.allowWindowsEscape||"/"===n.sep||(e=e.split(n.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}function g(e,t){return t||(t=this instanceof m?this.options:{}),e=void 0===e?this.pattern:e,f(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:s(e)}p.filter=function(e,t){return t=t||{},function(a,n,i){return p(a,e,t)}},p.defaults=function(e){if(!e||"object"!=typeof e||!Object.keys(e).length)return p;var t=p,a=function(a,n,i){return t(a,n,d(e,i))};return(a.Minimatch=function(a,n){return new t.Minimatch(a,d(e,n))}).defaults=function(a){return t.defaults(d(e,a)).Minimatch},a.filter=function(a,n){return t.filter(a,d(e,n))},a.defaults=function(a){return t.defaults(d(e,a))},a.makeRe=function(a,n){return t.makeRe(a,d(e,n))},a.braceExpand=function(a,n){return t.braceExpand(a,d(e,n))},a.match=function(a,n,i){return t.match(a,n,d(e,i))},a},m.defaults=function(e){return p.defaults(e).Minimatch},m.prototype.debug=function(){},m.prototype.make=function(){var e=this.pattern,t=this.options;if(t.nocomment||"#"!==e.charAt(0))if(e){this.parseNegate();var a=this.globSet=this.braceExpand();t.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,a),a=this.globParts=a.map((function(e){return e.split(u)})),this.debug(this.pattern,a),a=a.map((function(e,t,a){return e.map(this.parse,this)}),this),this.debug(this.pattern,a),a=a.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,a),this.set=a}else this.empty=!0;else this.comment=!0},m.prototype.parseNegate=function(){var e=this.pattern,t=!1,a=0;if(!this.options.nonegate){for(var n=0,i=e.length;n<i&&"!"===e.charAt(n);n++)t=!t,a++;a&&(this.pattern=e.substr(a)),this.negate=t}},p.braceExpand=function(e,t){return g(e,t)},m.prototype.braceExpand=g;var f=function(e){if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")};m.prototype.parse=function(e,t){f(e);var a=this.options;if("**"===e){if(!a.noglobstar)return i;e="*"}if(""===e)return"";var n,s="",u=!!a.nocase,d=!1,p=[],m=[],g=!1,h=-1,y=-1,E="."===e.charAt(0)?"":a.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",v=this;function k(){if(n){switch(n){case"*":s+=l,u=!0;break;case"?":s+=o,u=!0;break;default:s+="\\"+n}v.debug("clearStateChar %j %j",n,s),n=!1}}for(var S,T=0,x=e.length;T<x&&(S=e.charAt(T));T++)if(this.debug("%s\t%s %s %j",e,T,s,S),d&&c[S])s+="\\"+S,d=!1;else switch(S){case"/":return!1;case"\\":k(),d=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,T,s,S),g){this.debug("  in class"),"!"===S&&T===y+1&&(S="^"),s+=S;continue}v.debug("call clearStateChar %j",n),k(),n=S,a.noext&&k();continue;case"(":if(g){s+="(";continue}if(!n){s+="\\(";continue}p.push({type:n,start:T-1,reStart:s.length,open:r[n].open,close:r[n].close}),s+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,s),n=!1;continue;case")":if(g||!p.length){s+="\\)";continue}k(),u=!0;var w=p.pop();s+=w.close,"!"===w.type&&m.push(w),w.reEnd=s.length;continue;case"|":if(g||!p.length||d){s+="\\|",d=!1;continue}k(),s+="|";continue;case"[":if(k(),g){s+="\\"+S;continue}g=!0,y=T,h=s.length,s+=S;continue;case"]":if(T===y+1||!g){s+="\\"+S,d=!1;continue}var O=e.substring(y+1,T);try{RegExp("["+O+"]")}catch(e){var j=this.parse(O,b);s=s.substr(0,h)+"\\["+j[0]+"\\]",u=u||j[1],g=!1;continue}u=!0,g=!1,s+=S;continue;default:k(),d?d=!1:!c[S]||"^"===S&&g||(s+="\\"),s+=S}for(g&&(O=e.substr(y+1),j=this.parse(O,b),s=s.substr(0,h)+"\\["+j[0],u=u||j[1]),w=p.pop();w;w=p.pop()){var I=s.slice(w.reStart+w.open.length);this.debug("setting tail",s,w),I=I.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,a){return a||(a="\\"),t+t+a+"|"})),this.debug("tail=%j\n   %s",I,I,w,s);var C="*"===w.type?l:"?"===w.type?o:"\\"+w.type;u=!0,s=s.slice(0,w.reStart)+C+"\\("+I}k(),d&&(s+="\\\\");var M=!1;switch(s.charAt(0)){case"[":case".":case"(":M=!0}for(var D=m.length-1;D>-1;D--){var A=m[D],F=s.slice(0,A.reStart),R=s.slice(A.reStart,A.reEnd-8),P=s.slice(A.reEnd-8,A.reEnd),_=s.slice(A.reEnd);P+=_;var q=F.split("(").length-1,N=_;for(T=0;T<q;T++)N=N.replace(/\)[+*?]?/,"");var L="";""===(_=N)&&t!==b&&(L="$"),s=F+R+_+L+P}if(""!==s&&u&&(s="(?=.)"+s),M&&(s=E+s),t===b)return[s,u];if(!u)return e.replace(/\\(.)/g,"$1");var B=a.nocase?"i":"";try{var z=new RegExp("^"+s+"$",B)}catch(e){return new RegExp("$.")}return z._glob=e,z._src=s,z};var b={};p.makeRe=function(e,t){return new m(e,t||{}).makeRe()},m.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,a=t.noglobstar?l:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=t.nocase?"i":"",s=e.map((function(e){return e.map((function(e){return e===i?a:"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e._src})).join("\\/")})).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,n)}catch(e){this.regexp=!1}return this.regexp},p.match=function(e,t,a){var n=new m(t,a=a||{});return e=e.filter((function(e){return n.match(e)})),n.options.nonull&&!e.length&&e.push(t),e},m.prototype.match=function(e,t){if(void 0===t&&(t=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var a=this.options;"/"!==n.sep&&(e=e.split(n.sep).join("/")),e=e.split(u),this.debug(this.pattern,"split",e);var i,s,r=this.set;for(this.debug(this.pattern,"set",r),s=e.length-1;s>=0&&!(i=e[s]);s--);for(s=0;s<r.length;s++){var o=r[s],l=e;if(a.matchBase&&1===o.length&&(l=[i]),this.matchOne(l,o,t))return!!a.flipNegate||!this.negate}return!a.flipNegate&&this.negate},m.prototype.matchOne=function(e,t,a){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var s=0,r=0,o=e.length,l=t.length;s<o&&r<l;s++,r++){this.debug("matchOne loop");var c,u=t[r],d=e[s];if(this.debug(t,u,d),!1===u)return!1;if(u===i){this.debug("GLOBSTAR",[t,u,d]);var p=s,m=r+1;if(m===l){for(this.debug("** at the end");s<o;s++)if("."===e[s]||".."===e[s]||!n.dot&&"."===e[s].charAt(0))return!1;return!0}for(;p<o;){var g=e[p];if(this.debug("\nglobstar while",e,p,t,m,g),this.matchOne(e.slice(p),t.slice(m),a))return this.debug("globstar found match!",p,o,g),!0;if("."===g||".."===g||!n.dot&&"."===g.charAt(0)){this.debug("dot detected!",e,p,t,m);break}this.debug("globstar swallow a segment, and continue"),p++}return!(!a||(this.debug("\n>>> no match, partial?",e,p,t,m),p!==o))}if("string"==typeof u?(c=d===u,this.debug("string match",u,d,c)):(c=d.match(u),this.debug("pattern match",u,d,c)),!c)return!1}if(s===o&&r===l)return!0;if(s===o)return a;if(r===l)return s===o-1&&""===e[s];throw new Error("wtf?")}},function(e,t,a){e.exports=a(25)(1581)},function(e,t,a){var n=a(1191),i=a(1192);e.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),h(function(e){return e.split("\\\\").join(s).split("\\{").join(r).split("\\}").join(o).split("\\,").join(l).split("\\.").join(c)}(e),!0).map(d)):[]};var s="\0SLASH"+Math.random()+"\0",r="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",l="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function d(e){return e.split(s).join("\\").split(r).join("{").split(o).join("}").split(l).join(",").split(c).join(".")}function p(e){if(!e)return[""];var t=[],a=i("{","}",e);if(!a)return e.split(",");var n=a.pre,s=a.body,r=a.post,o=n.split(",");o[o.length-1]+="{"+s+"}";var l=p(r);return r.length&&(o[o.length-1]+=l.shift(),o.push.apply(o,l)),t.push.apply(t,o),t}function m(e){return"{"+e+"}"}function g(e){return/^-?0\d/.test(e)}function f(e,t){return e<=t}function b(e,t){return e>=t}function h(e,t){var a=[],s=i("{","}",e);if(!s||/\$$/.test(s.pre))return[e];var r,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body),c=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body),d=l||c,y=s.body.indexOf(",")>=0;if(!d&&!y)return s.post.match(/,.*\}/)?h(e=s.pre+"{"+s.body+o+s.post):[e];if(d)r=s.body.split(/\.\./);else if(1===(r=p(s.body)).length&&1===(r=h(r[0],!1).map(m)).length)return(k=s.post.length?h(s.post,!1):[""]).map((function(e){return s.pre+r[0]+e}));var E,v=s.pre,k=s.post.length?h(s.post,!1):[""];if(d){var S=u(r[0]),T=u(r[1]),x=Math.max(r[0].length,r[1].length),w=3==r.length?Math.abs(u(r[2])):1,O=f;T<S&&(w*=-1,O=b);var j=r.some(g);E=[];for(var I=S;O(I,T);I+=w){var C;if(c)"\\"===(C=String.fromCharCode(I))&&(C="");else if(C=String(I),j){var M=x-C.length;if(M>0){var D=new Array(M+1).join("0");C=I<0?"-"+D+C.slice(1):D+C}}E.push(C)}}else E=n(r,(function(e){return h(e,!1)}));for(var A=0;A<E.length;A++)for(var F=0;F<k.length;F++){var R=v+E[A]+k[F];(!t||d||R)&&a.push(R)}return a}},function(e,t){e.exports=function(e,t){for(var n=[],i=0;i<e.length;i++){var s=t(e[i],i);a(s)?n.push.apply(n,s):n.push(s)}return n};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,a){"use strict";function n(e,t,a){e instanceof RegExp&&(e=i(e,a)),t instanceof RegExp&&(t=i(t,a));var n=s(e,t,a);return n&&{start:n[0],end:n[1],pre:a.slice(0,n[0]),body:a.slice(n[0]+e.length,n[1]),post:a.slice(n[1]+t.length)}}function i(e,t){var a=t.match(e);return a?a[0]:null}function s(e,t,a){var n,i,s,r,o,l=a.indexOf(e),c=a.indexOf(t,l+1),u=l;if(l>=0&&c>0){if(e===t)return[l,c];for(n=[],s=a.length;u>=0&&!o;)u==l?(n.push(u),l=a.indexOf(e,u+1)):1==n.length?o=[n.pop(),c]:((i=n.pop())<s&&(s=i,r=c),c=a.indexOf(t,u+1)),u=l<c&&l>=0?l:c;n.length&&(o=[s,r])}return o}e.exports=n,n.range=s},function(e,t,a){"use strict";const n=a(1194);e.exports=(e,t={})=>{if(!Number.isFinite(e))throw new TypeError("Expected a finite number");t.colonNotation&&(t.compact=!1,t.formatSubMilliseconds=!1,t.separateMilliseconds=!1,t.verbose=!1),t.compact&&(t.secondsDecimalDigits=0,t.millisecondsDecimalDigits=0);const a=[],i=(e,n,i,s)=>{if(!(0!==a.length&&t.colonNotation||0!==e||t.colonNotation&&"m"===i))return;let r,o;if(s=(s||e||"0").toString(),t.colonNotation){r=a.length>0?":":"",o="";const e=s.includes(".")?s.split(".")[0].length:s.length,t=a.length>0?2:1;s="0".repeat(Math.max(0,t-e))+s}else r="",o=t.verbose?" "+(l=n,1===e?l:`${l}s`):i;var l;a.push(r+s+o)};if(("number"==typeof t.secondsDecimalDigits?t.secondsDecimalDigits:1)<1){const t=1e3-e%1e3;t<500&&(e+=t)}if(e>=59950&&!t.separateMilliseconds&&!t.formatSubMilliseconds){const t=60-e%60;t<=50&&(e+=t)}const s=n(e);if(i(Math.trunc(s.days/365),"year","y"),i(s.days%365,"day","d"),i(s.hours,"hour","h"),i(s.minutes,"minute","m"),t.separateMilliseconds||t.formatSubMilliseconds||e<1e3)if(i(s.seconds,"second","s"),t.formatSubMilliseconds)i(s.milliseconds,"millisecond","ms"),i(s.microseconds,"microsecond","µs"),i(s.nanoseconds,"nanosecond","ns");else{const e=s.milliseconds+s.microseconds/1e3+s.nanoseconds/1e6,a="number"==typeof t.millisecondsDecimalDigits?t.millisecondsDecimalDigits:0,n=e>=1?Math.round(e):Math.ceil(e),r=a?e.toFixed(a):n;i(parseFloat(r,10),"millisecond","ms",r)}else{const a=e/1e3%60,n="number"==typeof t.secondsDecimalDigits?t.secondsDecimalDigits:1,s=a.toFixed(n),r=t.keepDecimalsOnWholeSeconds?s:s.replace(/\.0+$/,"");i(parseFloat(r,10),"second","s",r)}return 0===a.length?"0"+(t.verbose?" milliseconds":"ms"):t.compact?a[0]:"number"==typeof t.unitCount?a.slice(0,Math.max(t.unitCount,1)).join(" "):t.colonNotation?a.join(""):a.join(" ")}},function(e,t,a){"use strict";e.exports=e=>{if("number"!=typeof e)throw new TypeError("Expected a number");const t=e>0?Math.floor:Math.ceil;return{days:t(e/864e5),hours:t(e/36e5)%24,minutes:t(e/6e4)%60,seconds:t(e/1e3)%60,milliseconds:t(e)%1e3,microseconds:t(1e3*e)%1e3,nanoseconds:t(1e6*e)%1e3}}},function(e,t,a){e.exports=a.p+"593328a61facc1e96ac261fcede5db93.png"},function(e,t,a){e.exports=a.p+"ae37f7e28b2ba3954b127510d84d3ac5.svg"},function(e,t,a){!function(t){"use strict";const a="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp(`^${a}\\.${a}\\.${a}\\.${a}$`,"i"),threeOctet:new RegExp(`^${a}\\.${a}\\.${a}$`,"i"),twoOctet:new RegExp(`^${a}\\.${a}$`,"i"),longValue:new RegExp(`^${a}$`,"i")},i=new RegExp("^0[0-7]+$","i"),s=new RegExp("^0x[a-f0-9]+$","i"),r="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",l={zoneIndex:new RegExp(r,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${r})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${a}\\.${a}\\.${a}\\.${a}(${r})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${a}\\.${a}\\.${a}\\.${a}(${r})?$`,"i")};function c(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let a,n,i=0,s=-1,r=(e.match(l.zoneIndex)||[])[0];for(r&&(r=r.substring(1),e=e.replace(/%.+$/,""));(s=e.indexOf(":",s+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(n=t-i,a=":";n--;)a+="0:";return":"===(e=e.replace("::",a))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),a=[];for(let e=0;e<t.length;e++)a.push(parseInt(t[e],16));return a}(),zoneId:r}}function u(e,t,a,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,s=0;for(;n>0;){if(i=a-n,i<0&&(i=0),e[s]>>i!=t[s]>>i)return!1;n-=a,s+=1}return!0}function d(e){if(s.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function p(e,t){for(;e.length<t;)e=`0${e}`;return e}const m={};m.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,a;for(t=0;t<e.length;t++)if(a=e[t],!(0<=a&&a<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let a;if(void 0===t&&(a=e,e=a[0],t=a[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const a={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,i,s;for(n=3;n>=0;n-=1){if(i=this.octets[n],!(i in a))return null;if(s=a[i],t&&0!==s)return null;8!==s&&(t=!0),e+=s}return 32-e},e.prototype.range=function(){return m.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return m.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),m.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),a=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let s=0;for(;s<4;)i.push(parseInt(a[s],10)|255^parseInt(n[s],10)),s++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},m.IPv4.isIPv4=function(e){return null!==this.parser(e)},m.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},m.IPv4.isValidFourPartDecimal=function(e){return!(!m.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},m.IPv4.networkAddressFromCIDR=function(e){let t,a,n,i,s;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],a=0;a<4;)i.push(parseInt(n[a],10)&parseInt(s[a],10)),a++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},m.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},m.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const a=[this.parse(t[1]),e];return Object.defineProperty(a,"toString",{value:function(){return this.join("/")}}),a}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},m.IPv4.parser=function(e){let t,a,i;if(t=e.match(n.fourOctet))return function(){const e=t.slice(1,6),n=[];for(let t=0;t<e.length;t++)a=e[t],n.push(d(a));return n}();if(t=e.match(n.longValue)){if(i=d(t[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(n.twoOctet))?function(){const e=t.slice(1,4),a=[];if(i=d(e[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return a.push(d(e[0])),a.push(i>>16&255),a.push(i>>8&255),a.push(255&i),a}():(t=e.match(n.threeOctet))?function(){const e=t.slice(1,5),a=[];if(i=d(e[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return a.push(d(e[0])),a.push(d(e[1])),a.push(i>>8&255),a.push(255&i),a}():null},m.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let a=0;const n=Math.floor(e/8);for(;a<n;)t[a]=255,a++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},m.IPv6=function(){function e(e,t){let a,n;if(16===e.length)for(this.parts=[],a=0;a<=14;a+=2)this.parts.push(e[a]<<8|e[a+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(a=0;a<this.parts.length;a++)if(n=this.parts[a],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let a;if(void 0===t&&(a=e,e=a[0],t=a[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const a={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,i;for(let s=7;s>=0;s-=1){if(n=this.parts[s],!(n in a))return null;if(i=a[n],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return m.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],a=this.parts;for(let n=0;n<a.length;n++)e=a[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(p(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],a=e[1];return new m.IPv4([t>>8,255&t,a>>8,255&a])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let a,n=0,i=-1;for(;a=e.exec(t);)a[0].length>i&&(n=a.index,i=a[0].length);return i<0?t:`${t.substring(0,n)}::${t.substring(n+i)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),m.IPv6.isIPv6=function(e){return null!==this.parser(e)},m.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},m.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},m.IPv6.parseCIDR=function(e){let t,a,n;if((a=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(a[2]),t>=0&&t<=128))return n=[this.parse(a[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},m.IPv6.parser=function(e){let t,a,n,i,s,r;if(n=e.match(l.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(l.native.test(e))return c(e,8);if((n=e.match(l.transitional))&&(r=n[6]||"",t=c(n[1].slice(0,-1)+r,6),t.parts)){for(s=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],a=0;a<s.length;a++)if(i=s[a],!(0<=i&&i<=255))return null;return t.parts.push(s[0]<<8|s[1]),t.parts.push(s[2]<<8|s[3]),{parts:t.parts,zoneId:t.zoneId}}return null},m.fromByteArray=function(e){const t=e.length;if(4===t)return new m.IPv4(e);if(16===t)return new m.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},m.isValid=function(e){return m.IPv6.isValid(e)||m.IPv4.isValid(e)},m.parse=function(e){if(m.IPv6.isValid(e))return m.IPv6.parse(e);if(m.IPv4.isValid(e))return m.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},m.parseCIDR=function(e){try{return m.IPv6.parseCIDR(e)}catch(t){try{return m.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},m.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},m.subnetMatch=function(e,t,a){let n,i,s,r;for(i in null==a&&(a="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(s=t[i],!s[0]||s[0]instanceof Array||(s=[s]),n=0;n<s.length;n++)if(r=s[n],e.kind()===r[0].kind()&&e.match.apply(e,r))return i;return a},e.exports?e.exports=m:t.ipaddr=m}(this)},,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"subPluginClasses",(function(){return LM}));var n=a(4),i=a.n(n),s=a(184),r=a(1),o=a(47),l=a(15),c=a(260),u=a(19),d=a(91),p=a(207),m=a(13),g=a(974),f=a(95),b=a(234),h=a(236),y=a(3),E=a(76),v=a(9),k=a(7);const S=(e,t)=>{const a=Object(o.useDispatch)(),{formatUrl:i}=Object(c.l)(v.a.timelines),s=Object(E.b)(d.b.selectInsertTimeline),r=Object(n.useCallback)(((a,n,s)=>{let r=`[${a}](${i(Object(c.k)(null!=n?n:"",s),{absolute:!0,skipSearch:!0})})`;Object(y.isEmpty)(e)||(r=`${e} ${r}`),t(r)}),[e,t,i]);return Object(n.useEffect)((()=>{null!=s&&null!=e&&(a(d.a.showTimeline({id:s.timelineId,show:!1})),r(s.timelineTitle,s.timelineSavedObjectId,s.graphEventId),a(Object(k.setInsertTimeline)(null)))}),[s,a,r,e]),{handleOnTimelineChange:r}};var T=a(993),x=a(418),w=a(289),O=a(290),j=a(977);const I=e=>{const{selectedPatterns:t}=Object(p.d)(m.SourcererScopeName.detections),a=Object(n.useMemo)((()=>Object(j.a)(e)),[e]),{loading:i,data:s}=Object(w.a)({query:a,indexName:t[0],queryName:O.a.CASES});return[i,Object(n.useMemo)((()=>{var e;return null!==(e=null==s?void 0:s.hits.hits.reduce(((e,{_id:t,_index:a,_source:n})=>({...e,[t]:{...Object(j.b)(n),_id:t,_index:a,timestamp:n["@timestamp"]}})),{}))&&void 0!==e?e:{}}),[null==s?void 0:s.hits.hits])]},C=()=>{const{browserFields:e,runtimeMappings:t}=Object(p.d)(m.SourcererScopeName.detections);return i.a.createElement(x.a,{browserFields:e,entityType:"events",isFlyoutView:!0,runtimeMappings:t,timelineId:l.i.casePage})},M=()=>{const{cases:e}=Object(u.k)().services,{getAppUrl:t,navigateTo:a}=Object(u.m)(),s=Object(u.i)(),p=Object(o.useDispatch)(),{formatUrl:m,search:y}=Object(c.l)(r.uc.rules),E=Object(n.useCallback)((e=>m(Object(c.h)(null!=e?e:"",y))),[m,y]),v=Object(n.useCallback)(((e,t)=>{p(d.a.toggleDetailPanel({panelView:"eventDetail",timelineId:l.i.casePage,params:{eventId:e,indexName:t}}))}),[p]),k=Object(n.useCallback)((()=>{p(d.a.createTimeline({id:l.i.casePage,columns:[],dataViewId:null,indexNames:[],expandedDetail:{},show:!1}))}),[p]),x=Object(n.useRef)(null);return i.a.createElement(f.a,{noPadding:!0},i.a.createElement(g.a.Provider,{value:x},e.ui.getCases({basePath:r.F,owner:[r.o],features:{metrics:["alerts.count","alerts.users","alerts.hosts","connectors","lifespan"],alerts:{isExperimental:!0}},refreshRef:x,onComponentInitialized:k,actionsNavigation:{href:e=>t({path:Object(b.d)({name:"endpointActivityLog",selected_endpoint:e})}),onClick:(e,t)=>(t&&t.preventDefault(),a({path:Object(b.d)({name:"endpointActivityLog",selected_endpoint:e})}))},ruleDetailsNavigation:{href:E,onClick:async(e,t)=>(t&&t.preventDefault(),a({deepLinkId:r.uc.rules,path:Object(c.h)(null!=e?e:"")}))},showAlertDetails:v,timelineIntegration:{editor_plugins:{parsingPlugin:T.a,processingPluginRenderer:T.c,uiPlugin:T.b},hooks:{useInsertTimeline:S},ui:{renderTimelineDetailsPanel:C}},useFetchAlertData:I,permissions:s})),i.a.createElement(h.a,{pageName:r.uc.case}))},D=i.a.memo(M),A=({children:e,...t})=>{const{services:{securityLayout:{getPluginWrapper:a}}}=Object(u.k)(),n=a();return i.a.createElement(n,t,e)},F=[{path:r.F,component:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:"case"},i.a.createElement(D,null)))}];var R=a(106),P=a(62),_=a(56),q=a(309),N=a(6);const L=N.i18n.translate("xpack.securitySolution.alerts.badge.readOnly.tooltip",{defaultMessage:"Unable to update alerts"});var B=a(17),z=a(24),H=a.n(z),$=a(22),V=a(8),U=a(213),Q=a(299),W=a(252),G=a(298),K=a(29),J=a(23),Y=a(691);const X=N.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutTitle",{defaultMessage:"API integration key required"}),Z=N.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutMsg",{defaultMessage:"A new encryption key is generated for saved objects each time you start Kibana. Without a persistent key, you cannot delete or modify rules after Kibana restarts. To set a persistent key, add the xpack.encryptedSavedObjects.encryptionKey setting with any text value of 32 or more characters to the kibana.yml file."}),ee=N.i18n.translate("xpack.securitySolution.detectionEngine.dismissNoApiIntegrationKeyButton",{defaultMessage:"Dismiss"}),te=()=>{const[e,t]=Object(n.useState)(!0),a=Object(n.useCallback)((()=>t(!1)),[t]);return e?i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiCallOut,{title:X,color:"danger",iconType:"alert"},i.a.createElement("p",null,Z),i.a.createElement(B.EuiButton,{color:"danger",onClick:a},ee)),i.a.createElement(B.EuiSpacer,{size:"l"})):null},ae=Object(n.memo)(te);var ne=a(277),ie=a(112),se=a(414);const re=({needsListsIndex:e,needsSignalsIndex:t})=>{const a=Object(u.k)().services.docLinks,s=Object(n.useMemo)((()=>({detections:{icon:"documents",label:se.e,url:`${a.links.siem.detectionsReq}`,target:"_blank"}})),[a]),r=((e,t)=>t&&e?se.h(se.j):t?se.h(se.k):e?se.h(se.i):se.h(""))(e,t);return i.a.createElement(ie.a,{actions:s,"data-test-subj":"no_index",message:r,title:se.l})},oe=i.a.memo(re);var le=a(453);const ce=i.a.memo((()=>{const e=Object(u.k)().services.docLinks,t=Object(n.useMemo)((()=>({detectionUnauthenticated:{icon:"documents",label:se.e,url:`${e.links.siem.detectionsReq}`,target:"_blank"}})),[e]);return i.a.createElement(ie.a,{actions:t,message:se.n,"data-test-subj":"no_index",title:se.o})}));ce.displayName="DetectionEngineUserUnauthenticated";var ue=a(204),de=a(96),pe=a(493),me=a(241),ge=a(94),fe=a(349),be=a(645);const he=({category:e,page:t,setting:a})=>`${t}.${e}.${a}`,ye=e=>"string"!=typeof e||Object(y.isEmpty)(e.trim()),Ee="alerts",ve="table",ke="treemap",Se="stack-by-0",Te="stack-by-1";var xe=a(638);const we=N.i18n.translate("xpack.securitySolution.components.chartSelect.selectAChartAriaLabel",{defaultMessage:"Select a chart"}),Oe=N.i18n.translate("xpack.securitySolution.components.chartSelect.tableOption",{defaultMessage:"Table"}),je=N.i18n.translate("xpack.securitySolution.components.chartSelect.trendOption",{defaultMessage:"Trend"}),Ie=N.i18n.translate("xpack.securitySolution.components.chartSelect.treemapOption",{defaultMessage:"Treemap"}),Ce="trend",Me=e=>{const t={"data-test-subj":e,icon:"visTable",name:Oe};switch(e){case"table":return t;case Ce:return{"data-test-subj":e,icon:"visBarVerticalStacked",name:je};case"treemap":return{"data-test-subj":e,icon:"grid",name:Ie};default:return t}};var De=a(227);const Ae=N.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.ariaLabel",{defaultMessage:"Chart settings"}),Fe=({initialPanelId:e,isPopoverOpen:t,panels:a,setIsPopoverOpen:s})=>{const r=Object(n.useCallback)((()=>s((e=>!e))),[s]),o=Object(n.useCallback)((()=>s(!1)),[s]),l=Object(n.useMemo)((()=>i.a.createElement(B.EuiButtonIcon,{"aria-label":Ae,color:"text",iconType:"boxesHorizontal",onClick:r,size:"xs"})),[r]);return i.a.createElement(B.EuiPopover,{anchorPosition:"downCenter",button:l,className:De.a,closePopover:o,isOpen:t,panelPaddingSize:"none"},i.a.createElement(B.EuiContextMenu,{initialPanelId:e,panels:a}))};Fe.displayName="ChartSettingsPopoverComponent";const Re=i.a.memo(Fe);var Pe=a(727);const _e=N.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.inspectTitle",{defaultMessage:"Inspect"}),qe=N.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.resetGroupByFieldsMenuItem",{defaultMessage:"Reset group by fields"}),Ne="default-initial-panel",Le=({defaultStackByField:e,defaultStackByField1:t,onReset:a=y.noop,queryId:s,setStackBy:r,setStackByField1:o})=>{const l=Object(n.useCallback)((()=>{a(),r(e),null!=o&&o(t)}),[e,t,a,r,o]),{defaultInitialPanelId:c,defaultMenuItems:u,isPopoverOpen:d,setIsPopoverOpen:p}=(({onResetStackByFields:e,queryId:t})=>{const[a,i]=Object(n.useState)(!1),{handleClick:s}=Object(Pe.a)({queryId:t}),r=Object(n.useMemo)((()=>[{id:Ne,items:[{icon:"inspect",name:_e,onClick:()=>{i(!1),s()}},{name:qe,onClick:()=>{i(!1),e()}}]}]),[s,e]);return{defaultInitialPanelId:Ne,defaultMenuItems:r,isPopoverOpen:a,setIsPopoverOpen:i}})({onResetStackByFields:l,queryId:s});return i.a.createElement(Re,{initialPanelId:c,isPopoverOpen:d,panels:u,setIsPopoverOpen:p})};Le.displayName="ChartContextMenuComponent";const Be=i.a.memo(Le),ze=H()(B.EuiIcon).withConfig({displayName:"ChartTypeIcon",componentId:"sc-o4fq00-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),He=({alertViewSelection:e,setAlertViewSelection:t})=>{const[a,s]=Object(n.useState)(!1),r=Object(n.useCallback)((()=>s(!1)),[]),o=Object(n.useCallback)((()=>s((e=>!e))),[]),l=Object(n.useMemo)((()=>{const t=Me(e);return i.a.createElement(B.EuiButton,{"aria-label":we,className:"kbnToolbarButton",color:"text","data-test-subj":"chartSelect",iconSide:"right",iconType:"arrowDown",onClick:o},i.a.createElement(ze,{type:t.icon}),i.a.createElement("span",null,t.name))}),[e,o]),c=Object(n.useMemo)((()=>(({alertViewSelection:e,closePopover:t,setAlertViewSelection:a})=>[{id:0,items:[{...Me("table"),onClick:()=>{t(),a("table")}},{...Me("trend"),onClick:()=>{t(),a("trend")}},{...Me("treemap"),onClick:()=>{t(),a("treemap")}}]}])({alertViewSelection:e,closePopover:r,setAlertViewSelection:t})),[e,r,t]);return i.a.createElement(B.EuiPopover,{anchorPosition:"downLeft",button:l,closePopover:r,isOpen:a,panelPaddingSize:"none"},i.a.createElement(B.EuiContextMenu,{initialPanelId:0,panels:c}))};He.displayName="ChartSelectComponent";const $e=i.a.memo(He);var Ve=a(44),Ue=a(50),Qe=a.n(Ue),We=a(181),Ge=a(436),Ke=a(625),Je=a(524);const Ye=({riskScore:e,colorPalette:t})=>{const a=Math.min(100,t.length);return t[Object(y.clamp)(0,a,e)]},Xe=({buckets:e,maxRiskSubAggregations:t,stackByField0:a})=>e.flatMap((e=>(({bucket:e,maxRiskSubAggregations:t})=>{var a,n,i;return null!==(a=null===(n=e.stackByField1)||void 0===n||null===(i=n.buckets)||void 0===i?void 0:i.map((t=>{var a,n;return{doc_count:e.doc_count,key:null!==(a=e.key_as_string)&&void 0!==a?a:e.key,maxRiskSubAggregation:e.maxRiskSubAggregation,stackByField1Key:null!==(n=t.key_as_string)&&void 0!==n?n:t.key,stackByField1DocCount:t.doc_count}})))&&void 0!==a?a:[]})({bucket:e,maxRiskSubAggregations:t})));var Ze=a(220);const et=N.i18n.translate("xpack.securitySolution.components.alertsTreemap.noDataLabel",{defaultMessage:"No data to display"}),tt=e=>N.i18n.translate("xpack.securitySolution.components.alertsTreemap.noDataReasonLabel",{values:{stackByField1:e},defaultMessage:"The {stackByField1} field was not present in any groups"}),at=({baseLabel:e,riskScore:t})=>null!=t?`${e} ${(e=>N.i18n.translate("xpack.securitySolution.components.alertsTreemap.riskLabel",{values:{riskScore:e},defaultMessage:"(Risk {riskScore})"}))(t)}`:e,nt=({bucket:e,colorPalette:t,maxRiskSubAggregations:a,showColor:n,stackByField0:i})=>{var s,r;return{color:n?Ye({riskScore:null!==(s=a[e.key])&&void 0!==s?s:0,colorPalette:t}):void 0,count:e.doc_count,dataProviderId:Object(Ze.h)(`draggable-legend-item-treemap-${i}-${e.key}-${Qe.a.v4()}`),render:()=>{var t,a;return at({baseLabel:null!==(t=e.key_as_string)&&void 0!==t?t:e.key,riskScore:null===(a=e.maxRiskSubAggregation)||void 0===a?void 0:a.value})},field:i,value:null!==(r=e.key_as_string)&&void 0!==r?r:e.key}},it=({colorPalette:e,flattenedBucket:{key:t,stackByField1Key:a,stackByField1DocCount:n},maxRiskSubAggregations:i,stackByField0:s,stackByField1:r})=>{var o;return{color:Ye({riskScore:null!==(o=i[t])&&void 0!==o?o:0,colorPalette:e}),count:n,dataProviderId:Object(Ze.h)(`draggable-legend-item-treemap-${t}-${a}-${Qe.a.v4()}`),render:()=>`${a}`,field:`${r}`,value:`${a}`}},st=({buckets:e,maxItems:t})=>{var a;return null!==(a=null==e?void 0:e.slice(0,t))&&void 0!==a?a:[]},rt=e=>e.reduce(((e,t)=>{var a,n;return{...e,[t.key]:null!==(a=null===(n=t.maxRiskSubAggregation)||void 0===n?void 0:n.value)&&void 0!==a?a:void 0}}),{}),ot=e=>null!=e&&""!==e.trim(),lt=e=>`${e}`,ct=e=>e.key,ut=H()(B.EuiText).withConfig({displayName:"NoDataLabel",componentId:"sc-t58uod-0"})(["text-align:center;"]),dt=({reason:e})=>i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(B.EuiFlexItem,{grow:!0},i.a.createElement(ut,{color:"subdued","data-test-subj":"noDataLabel",size:"xs"},et),null!=e&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,{size:"s"}),i.a.createElement(ut,{color:"subdued","data-test-subj":"reasonLabel",size:"xs"},e))));dt.displayName="NoDataComponent";const pt=i.a.memo(dt),mt=H.a.div.withConfig({displayName:"LegendContainer",componentId:"sc-m8zedo-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),gt=H()(B.EuiFlexItem).withConfig({displayName:"ChartFlexItem",componentId:"sc-m8zedo-1"})(["min-height:",";"],(({$minChartHeight:e})=>`${e}px`)),ft=({addFilter:e,data:t,maxBuckets:a,minChartHeight:s=370,stackByField0:r,stackByField1:o})=>{var l,c;const u=Object(Ge.h)(),d=Object(n.useMemo)((()=>u.background.color),[u.background.color]),p=Object(n.useMemo)((()=>[{partition:{fillLabel:{valueFont:{fontWeight:700}},idealFontSizeJump:1.15,maxFontSize:16,minFontSize:4,sectorLineStroke:d,sectorLineWidth:1.5}}]),[d]),m=Object(n.useMemo)((()=>{var e,n;return st({buckets:null===(e=t.aggregations)||void 0===e||null===(n=e.stackByField0)||void 0===n?void 0:n.buckets,maxItems:a})}),[null===(l=t.aggregations)||void 0===l||null===(c=l.stackByField0)||void 0===c?void 0:c.buckets,a]),g=Object(n.useMemo)((()=>rt(m)),[m]),f=Object(n.useMemo)((()=>Xe({buckets:m,maxRiskSubAggregations:g,stackByField0:r})),[m,g,r]),b=Object(n.useMemo)((()=>Array(101).fill(0).map(((e,t)=>t>=Je.e?Je.a:t>=Je.f?Je.b:t>=Je.g?Je.d:Je.c))),[]),h=Object(n.useMemo)((()=>0===f.length?(({buckets:e,colorPalette:t,maxRiskSubAggregations:a,stackByField0:n})=>e.map((e=>nt({bucket:e,colorPalette:t,maxRiskSubAggregations:a,showColor:!0,stackByField0:n}))))({buckets:m,colorPalette:b,maxRiskSubAggregations:g,stackByField0:r}):(({buckets:e,colorPalette:t,flattenedBuckets:a,maxRiskSubAggregations:n,stackByField0:i,stackByField1:s})=>{const r=(({buckets:e,colorPalette:t,maxRiskSubAggregations:a,stackByField0:n})=>e.reduce(((e,i)=>({...e,[i.key]:[nt({bucket:i,colorPalette:t,maxRiskSubAggregations:a,showColor:!1,stackByField0:n})]})),{}))({buckets:e,colorPalette:t,maxRiskSubAggregations:n,stackByField0:i}),o=a.reduce(((e,a)=>{var r;return{...e,[a.key]:[...null!==(r=e[a.key])&&void 0!==r?r:[],it({colorPalette:t,flattenedBucket:a,maxRiskSubAggregations:n,stackByField0:i,stackByField1:s})]}}),r);return e.reduce(((e,t)=>[...e,...o[t.key]]),[])})({buckets:m,colorPalette:b,flattenedBuckets:f,maxRiskSubAggregations:g,stackByField0:r,stackByField1:o})),[m,b,f,g,r,o]),E=Object(n.useCallback)((t=>{const{groupByField0:a,groupByField1:n}=(e=>{const t=e.flat(2);return{groupByField0:t.length>0&&"groupByRollup"in t[0]&&null!=t[0].groupByRollup?`${t[0].groupByRollup}`:"",groupByField1:t.length>1&&"groupByRollup"in t[1]&&null!=t[1].groupByRollup?`${t[1].groupByRollup}`:""}})(t);null==e||Object(y.isEmpty)(a.trim())||e({field:r,value:a}),null==e||Object(y.isEmpty)(null==o?void 0:o.trim())||Object(y.isEmpty)(n.trim())||e({field:`${o}`,value:n})}),[e,r,o]),v=Object(n.useMemo)((()=>ot(o)?(({colorPalette:e,layer0FillColor:t,maxRiskSubAggregations:a})=>[{fillLabel:{valueFormatter:lt},groupByRollup:ct,nodeLabel:e=>at({baseLabel:e,riskScore:a[e]}),shape:{fillColor:t}},{fillLabel:{valueFormatter:lt},groupByRollup:e=>e.stackByField1Key,nodeLabel:e=>`${e}`,shape:{fillColor:t=>{var n,i;const s=null!==(n=(e=>{var t,a;const n=(null!==(t=null===(a=e.path)||void 0===a?void 0:a.length)&&void 0!==t?t:0)-2;return Array.isArray(e.path)&&n>0?e.path[n].value:void 0})(t))&&void 0!==n?n:"";return Ye({riskScore:null!==(i=a[s])&&void 0!==i?i:0,colorPalette:e})}}}])({colorPalette:b,layer0FillColor:d,maxRiskSubAggregations:g}):(({colorPalette:e,maxRiskSubAggregations:t})=>[{fillLabel:{valueFormatter:lt},groupByRollup:ct,nodeLabel:e=>at({baseLabel:e,riskScore:t[e]}),shape:{fillColor:a=>{var n;return Ye({riskScore:null!==(n=t[a.dataName])&&void 0!==n?n:0,colorPalette:e})}}}])({colorPalette:b,maxRiskSubAggregations:g})),[b,d,g,o]),k=Object(n.useMemo)((()=>ot(o)?e=>e.stackByField1DocCount:e=>e.doc_count),[o]),S=ot(o)?f:m;return 0===m.length?i.a.createElement(pt,null):i.a.createElement("div",{"data-test-subj":"treemap"},i.a.createElement(B.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(gt,{grow:!0,$minChartHeight:s},null==o||Object(y.isEmpty)(o)||0!==S.length?i.a.createElement(We.Chart,null,i.a.createElement(We.Settings,{baseTheme:u,showLegend:!1,theme:p,onElementClick:E}),i.a.createElement(We.Partition,{data:S,id:"spec_1",layers:v,layout:We.PartitionLayout.treemap,valueAccessor:k})):i.a.createElement(pt,{reason:tt(o)})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(mt,null,h.length>0&&i.a.createElement(Ke.a,{className:"eui-yScroll",height:s,legendItems:h,minWidth:300})))))},bt=i.a.memo(ft);var ht=a(639),yt=a(640),Et=a(510);const vt=H()(B.EuiFlexItem).withConfig({displayName:"ChartOptionsFlexItem",componentId:"sc-ltb99n-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),kt=({chartOptionsContextMenu:e,setStackByField0:t,setStackByField0ComboboxInputRef:a,setStackByField1:n,setStackByField1ComboboxInputRef:s,stackByField0:r,stackByField0ComboboxRef:o,stackByField1:l,stackByField1ComboboxRef:c,stackByWidth:u,uniqueQueryId:d})=>i.a.createElement(B.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"fieldSelection",gutterSize:"none"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(ht.b,{"aria-label":Et.a,ref:o,"data-test-subj":"groupBy",onSelect:t,prepend:Et.a,selected:r,inputRef:a,width:u}),i.a.createElement(B.EuiSpacer,{size:"s"}),i.a.createElement(ht.b,{"aria-label":Et.b,ref:c,"data-test-subj":"groupByTop",onSelect:n,prepend:Et.b,selected:null!=l?l:"",inputRef:s,width:u})),i.a.createElement(B.EuiFlexItem,{grow:!1},null!=e&&i.a.createElement(vt,{grow:!1},e(d))));kt.displayName="FieldSelectionComponent";const St=i.a.memo(kt);var Tt=a(216);const xt=({stackByField1:e,stackByField1Size:t})=>null==e||Object(y.isEmpty)(e.trim())?{}:{stackByField1:{terms:{field:e,order:{_count:"desc"},size:t}}},wt=({additionalFilters:e=[],from:t,runtimeMappings:a,stackByField0:n,stackByField0Size:i=1e3,stackByField1:s,stackByField1Size:r=1e3,riskSubAggregationField:o,to:l})=>({size:0,aggs:{stackByField0:{terms:{field:n,order:{_count:"desc"},size:i},aggs:{...xt({stackByField1:s,stackByField1Size:r}),maxRiskSubAggregation:{max:{field:o}}}}},query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:l}}}]}},runtime_mappings:a}),Ot=({addFilter:e,alignHeader:t,chartOptionsContextMenu:a,inspectTitle:s,isPanelExpanded:r,filters:o,height:l=504,query:c,riskSubAggregationField:u,runtimeMappings:d,setIsPanelExpanded:p,setStackByField0:m,setStackByField0ComboboxInputRef:g,setStackByField1:f,setStackByField1ComboboxInputRef:b,signalIndexName:h,stackByField0:y,stackByField0ComboboxRef:E,stackByField1:v,stackByField1ComboboxRef:k,stackByWidth:S,title:T})=>{const{to:x,from:j,deleteQuery:I,setQuery:C}=Object(U.a)(!1),M=Object(n.useMemo)((()=>`alerts-treemap-${Qe.a.v4()}`),[]),D=Object(n.useMemo)((()=>{try{var e;return[Object(Ve.c)(void 0,null!=c?[c]:[],null!==(e=null==o?void 0:o.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[])]}catch(e){return[]}}),[c,o]),{data:A,loading:F,refetch:R,request:P,response:_,setQuery:q}=Object(w.a)({query:wt({additionalFilters:D,from:j,riskSubAggregationField:u,runtimeMappings:d,stackByField0:y,stackByField1:v,to:x}),skip:!r,indexName:h,queryName:O.a.TREE_MAP});return Object(n.useEffect)((()=>{q(wt({additionalFilters:D,from:j,riskSubAggregationField:u,runtimeMappings:d,stackByField0:y,stackByField1:v,to:x}))}),[D,j,u,d,q,y,v,x]),Object(yt.a)({deleteQuery:I,loading:F,response:_,setQuery:C,refetch:R,request:P,uniqueQueryId:M}),i.a.createElement(De.c,null,i.a.createElement(ht.a,{className:"eui-yScroll","data-test-subj":"treemapPanel",hasBorder:!0,height:r?l:64,$overflowY:r?"auto":"hidden",$toggleStatus:!0},i.a.createElement(Tt.a,{alignHeader:t,hideSubtitle:!0,id:M,inspectTitle:s,outerDirection:"row",showInspectButton:null==a,title:T,titleSize:"s",toggleQuery:p,toggleStatus:r},r&&i.a.createElement(St,{chartOptionsContextMenu:a,setStackByField0:m,setStackByField0ComboboxInputRef:g,setStackByField1:f,setStackByField1ComboboxInputRef:b,stackByField0:y,stackByField0ComboboxRef:E,stackByField1:v,stackByField1ComboboxRef:k,stackByWidth:S,uniqueQueryId:M})),F&&r?i.a.createElement(B.EuiProgress,{color:"accent","data-test-subj":"progress",position:"absolute",size:"xs"}):i.a.createElement(i.a.Fragment,null,null!=A&&r&&i.a.createElement(bt,{addFilter:e,data:A,maxBuckets:1e3,stackByField0:y,stackByField1:v}))))};Ot.displayName="AlertsTreemapPanelComponent";const jt=i.a.memo(Ot),It=()=>{const e=Object(n.useRef)(null),[t,a]=Object(n.useState)(null),i=Object(n.useCallback)((()=>{var a;null===(a=e.current)||void 0===a||a.clearSearchValue(),null!=t&&(t.value="")}),[t]);return{comboboxRef:e,onReset:i,setComboboxInputRef:a}};var Ct=a(681);const Mt=1e3,Dt=({additionalFilters:e=[],from:t,runtimeMappings:a,stackByField0:n,stackByField1:i,to:s})=>({size:0,aggs:{stackByField0:{terms:{field:n,order:{_count:"desc"},size:Mt},aggs:{...xt({stackByField1:i,stackByField1Size:1e3})}}},query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:s}}}]}},runtime_mappings:a}),At=N.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.countTableColumnTitle",{defaultMessage:"Count of records"}),Ft=N.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.countTableTitle",{defaultMessage:"Count"}),Rt=({fieldName:e,topN:t})=>N.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.columnLabel",{values:{fieldName:e,topN:t},defaultMessage:"Top {topN} values of {fieldName}"});var Pt=a(179),_t=a.n(Pt),qt=a(212);const Nt=H.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1p6ej67-0"})(["margin-top:-",";"],(({theme:e})=>e.eui.euiSizeS)),Lt=({data:e,loading:t,stackByField0:a,stackByField1:s})=>{var o,l;const[c]=Object(u.q)(r.Y),d=Object(n.useMemo)((()=>Object(y.isEmpty)(null==s?void 0:s.trim())?(({defaultNumberFormat:e,stackByField0:t})=>[{"data-test-subj":"stackByField0Key",field:"key",name:t,render:function(e){return i.a.createElement(qt.b,{isDraggable:!1,field:t,hideTopN:!0,id:`alert-count-draggable-stackByField0-${t}-${e}`,value:e,tooltipContent:null})},truncateText:!1},{"data-test-subj":"doc_count",dataType:"number",field:"doc_count",name:At,render:t=>_t()(t).format(e),sortable:!0,textOnly:!0}])({defaultNumberFormat:c,stackByField0:a}):(({defaultNumberFormat:e,stackByField0:t,stackByField1:a})=>[{"data-test-subj":"stackByField0Key",field:"key",name:Rt({fieldName:t,topN:Mt}),render:function(e){return i.a.createElement(qt.b,{isDraggable:!1,field:t,hideTopN:!0,id:`alert-count-draggable-stackByField0-${t}-${a}-${e}`,value:e,tooltipContent:null})},truncateText:!1},{"data-test-subj":"stackByField1Key",field:"stackByField1Key",name:Rt({fieldName:null!=a?a:"",topN:1e3}),render:function(e){return i.a.createElement(qt.b,{isDraggable:!1,field:null!=a?a:"",hideTopN:!0,id:`alert-count-draggable-stackByField1-${t}-${a}-${e}`,value:e,tooltipContent:null})},truncateText:!1},{"data-test-subj":"stackByField1DocCount",dataType:"number",field:"stackByField1DocCount",name:At,render:t=>_t()(t).format(e),sortable:!0,textOnly:!0}])({defaultNumberFormat:c,stackByField0:a,stackByField1:s})),[c,a,s]),p=Object(n.useMemo)((()=>{var t,a;return st({buckets:null===(t=e.aggregations)||void 0===t||null===(a=t.stackByField0)||void 0===a?void 0:a.buckets,maxItems:Mt})}),[null===(o=e.aggregations)||void 0===o||null===(l=o.stackByField0)||void 0===l?void 0:l.buckets]),m=Object(n.useMemo)((()=>rt(p)),[p]),g=Object(n.useMemo)((()=>Object(y.isEmpty)(null==s?void 0:s.trim())?p:Xe({buckets:p,maxRiskSubAggregations:m,stackByField0:a})),[p,m,a,s]);return i.a.createElement(Nt,{"data-test-subj":"alertsCountTable",className:"eui-yScroll"},i.a.createElement(B.EuiInMemoryTable,{isSelectable:!1,columns:d,items:g,loading:t,sorting:!0}))};Lt.displayName="AlertsCountComponent";const Bt=i.a.memo(Lt);var zt=a(208);const Ht=Object(n.memo)((({alignHeader:e,chartOptionsContextMenu:t,filters:a,inspectTitle:s,panelHeight:r,query:o,runtimeMappings:l,setStackByField0:c,setStackByField0ComboboxInputRef:u,setStackByField1:d,setStackByField1ComboboxInputRef:p,signalIndexName:m,stackByField0:g,stackByField0ComboboxRef:f,stackByField1:b,stackByField1ComboboxRef:h,stackByWidth:y,title:E=Ft})=>{const{to:v,from:k,deleteQuery:S,setQuery:T}=Object(U.a)(!1),x=Object(n.useMemo)((()=>`detections-alerts-count-${Qe.a.v4()}`),[]),j=Object(n.useMemo)((()=>{try{var e;return[Object(Ve.c)(void 0,null!=o?[o]:[],null!==(e=null==a?void 0:a.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[])]}catch(e){return[]}}),[o,a]),{toggleStatus:I,setToggleStatus:C}=Object(zt.a)("detections-alerts-count"),[M,D]=Object(n.useState)(!I);Object(n.useEffect)((()=>{D(!I)}),[I]);const A=Object(n.useCallback)((e=>{C(e),D(!e)}),[D,C]),{loading:F,data:R,setQuery:P,response:_,request:q,refetch:N}=Object(w.a)({query:Dt({stackByField0:g,stackByField1:b,from:k,to:v,additionalFilters:j,runtimeMappings:l}),indexName:m,skip:M,queryName:O.a.COUNT});return Object(n.useEffect)((()=>{P(Dt({additionalFilters:j,from:k,runtimeMappings:l,stackByField0:g,stackByField1:b,to:v}))}),[j,k,l,P,g,b,v]),Object(yt.a)({setQuery:T,response:_,request:q,refetch:N,uniqueQueryId:x,deleteQuery:S,loading:F}),i.a.createElement(De.c,{show:I},i.a.createElement(ht.a,{$toggleStatus:I,"data-test-subj":"alertsCountPanel",hasBorder:!0,height:r},i.a.createElement(Tt.a,{alignHeader:e,id:x,inspectTitle:s,outerDirection:"row",title:E,titleSize:"s",hideSubtitle:!0,showInspectButton:null==t,toggleStatus:I,toggleQuery:A},i.a.createElement(St,{chartOptionsContextMenu:t,setStackByField0:c,setStackByField0ComboboxInputRef:u,setStackByField1:d,setStackByField1ComboboxInputRef:p,stackByField0:g,stackByField0ComboboxRef:f,stackByField1:b,stackByField1ComboboxRef:h,stackByWidth:y,uniqueQueryId:x})),I&&null!=R&&i.a.createElement(Bt,{data:R,loading:F,stackByField0:g,stackByField1:b})))}));Ht.displayName="AlertsCountPanel";const $t=H()(B.EuiFlexItem).withConfig({displayName:"FullHeightFlexItem",componentId:"sc-p2i2qk-0"})(["height:100%;"]),Vt=H.a.div.withConfig({displayName:"ChartSelectContainer",componentId:"sc-p2i2qk-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),Ut=({addFilter:e,alertsHistogramDefaultFilters:t,isLoadingIndexPattern:a,query:s,runtimeMappings:r,signalIndexName:o,updateDateRangeCallback:l})=>{const{alertViewSelection:c,countTableStackBy0:u,countTableStackBy1:d,isTreemapPanelExpanded:p,riskChartStackBy0:m,riskChartStackBy1:g,setAlertViewSelection:f,setCountTableStackBy0:b,setCountTableStackBy1:h,setIsTreemapPanelExpanded:y,setRiskChartStackBy0:E,setRiskChartStackBy1:v,setTrendChartStackBy:k,trendChartStackBy:S}=(()=>{const[e,t]=Object(be.a)({defaultValue:Ce,key:he({category:"view",page:Ee,setting:"alert-view-selection"}),isInvalidDefault:ye}),[a,n]=Object(be.a)({defaultValue:!0,key:he({category:ke,page:Ee,setting:"expand"})}),[i,s]=Object(be.a)({defaultValue:xe.a,key:he({category:ke,page:Ee,setting:Se}),isInvalidDefault:ye}),[r,o]=Object(be.a)({defaultValue:xe.b,key:he({category:ke,page:Ee,setting:Te})}),[l,c]=Object(be.a)({defaultValue:xe.a,key:he({category:ve,page:Ee,setting:Se}),isInvalidDefault:ye}),[u,d]=Object(be.a)({defaultValue:xe.b,key:he({category:ve,page:Ee,setting:Te})}),[p,m]=Object(be.a)({defaultValue:xe.a,key:he({category:"trend",page:Ee,setting:"stack-by"}),isInvalidDefault:ye});return{alertViewSelection:e,countTableStackBy0:l,countTableStackBy1:u,isTreemapPanelExpanded:a,riskChartStackBy0:i,riskChartStackBy1:r,setAlertViewSelection:t,setCountTableStackBy0:c,setCountTableStackBy1:d,setIsTreemapPanelExpanded:n,setRiskChartStackBy0:s,setRiskChartStackBy1:o,setTrendChartStackBy:m,trendChartStackBy:p}})(),T=Object(n.useCallback)((e=>{k(e),b(e),E(e)}),[b,E,k]),x=Object(n.useCallback)((e=>{h(e),v(e)}),[h,v]),{comboboxRef:w,onReset:O,setComboboxInputRef:j}=It(),{comboboxRef:I,onReset:C,setComboboxInputRef:M}=It(),D=Object(n.useCallback)((()=>{O(),C()}),[O,C]),A=Object(n.useCallback)((e=>i.a.createElement(Be,{defaultStackByField:xe.a,defaultStackByField1:xe.b,onReset:D,queryId:e,setStackBy:T,setStackByField1:x})),[D,T,x]),F=Object(n.useMemo)((()=>i.a.createElement(Vt,null,i.a.createElement($e,{alertViewSelection:c,setAlertViewSelection:f}))),[c,f]);return i.a.createElement("div",{"data-test-subj":"chartPanels"},"trend"===c&&i.a.createElement($t,{grow:2},a?i.a.createElement(B.EuiLoadingSpinner,{"data-test-subj":"trendLoadingSpinner",size:"xl"}):i.a.createElement(Ct.a,{alignHeader:"flexStart",chartHeight:127,chartOptionsContextMenu:A,comboboxRef:w,defaultStackByOption:S,filters:t,inspectTitle:je,setComboboxInputRef:j,onFieldSelected:T,panelHeight:256,query:s,showCountsInLegend:!0,showGroupByPlaceholder:!0,showTotalAlertsCount:!1,stackByLabel:Et.a,title:F,titleSize:"s",signalIndexName:o,updateDateRange:l,runtimeMappings:r})),"table"===c&&i.a.createElement($t,{grow:1},a?i.a.createElement(B.EuiLoadingSpinner,{"data-test-subj":"tableLoadingSpinner",size:"xl"}):i.a.createElement(Ht,{alignHeader:"flexStart",chartOptionsContextMenu:A,filters:t,inspectTitle:Oe,panelHeight:330,query:s,runtimeMappings:r,setStackByField0:T,setStackByField0ComboboxInputRef:j,stackByField0ComboboxRef:w,setStackByField1:x,setStackByField1ComboboxInputRef:M,stackByField1ComboboxRef:I,signalIndexName:o,stackByField0:u,stackByField1:d,title:F})),"treemap"===c&&i.a.createElement($t,{grow:1},a?i.a.createElement(B.EuiLoadingSpinner,{"data-test-subj":"treemapLoadingSpinner",size:"xl"}):i.a.createElement(jt,{addFilter:e,alignHeader:"flexStart",chartOptionsContextMenu:A,inspectTitle:Ie,isPanelExpanded:p,filters:t,query:s,setIsPanelExpanded:y,setStackByField0:T,setStackByField0ComboboxInputRef:j,stackByField0ComboboxRef:w,setStackByField1:x,setStackByField1ComboboxInputRef:M,stackByField1ComboboxRef:I,signalIndexName:o,stackByField0:m,stackByField1:g,title:F,riskSubAggregationField:"kibana.alert.risk_score",runtimeMappings:r})))},Qt=i.a.memo(Ut);var Wt=a(525),Gt=a(622),Kt=a(530),Jt=a(670),Yt=a(266),Xt=a(304);const Zt=H.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-7rr6ls-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),ea=({clearEventsDeleted:e,clearEventsLoading:t,clearSelected:a})=>{const s=Object(o.useDispatch)(),r=Object(n.useRef)(null),g=Object(n.useMemo)((()=>d.b.getTimelineByIdSelector()),[]),b=Object(E.b)((e=>{var t;return(null!==(t=g(e,l.i.detectionsPage))&&void 0!==t?t:ge.a).graphEventId})),h=Object(E.b)((e=>{var t;return(null!==(t=g(e,l.i.detectionsPage))&&void 0!==t?t:ge.a).updated})),k=Object(E.b)((e=>{var t;return(null!==(t=g(e,l.i.detectionsPage))&&void 0!==t?t:ge.a).isLoading})),S=Object(n.useMemo)((()=>K.d.globalFiltersQuerySelector()),[]),T=Object(n.useMemo)((()=>K.d.globalQuerySelector()),[]),x=Object(E.a)(T),w=Object(E.a)(S),{to:O,from:j}=Object(U.a)(),{globalFullScreen:I}=Object(de.a)(),[{loading:C,isAuthenticated:M,hasEncryptionKey:D,signalIndexName:A,hasIndexWrite:F=!1,hasIndexMaintenance:R=!1,canUserREAD:P,hasIndexRead:_}]=Object(ne.b)(),{loading:q,needsConfiguration:N}=Object(le.a)(),{indexPattern:L,runtimeMappings:z,loading:H}=Object(p.d)(m.SourcererScopeName.detections),{formatUrl:X}=Object(c.l)(v.a.rules),[Z,ee]=Object(n.useState)(!1),[te,re]=Object(n.useState)(!1),be=C||q,{application:{navigateToUrl:he},timelines:ye,data:Ee,docLinks:ve}=Object(u.k)().services,[ke,Se]=Object(n.useState)(Jt.b),{filterManager:Te}=Ee.query,xe=Object(n.useCallback)((({field:e,value:t})=>{Te.addFilters([{meta:{alias:null,disabled:!1,negate:!1},query:{match_phrase:{[e]:t}}}])}),[Te]),we=Object(n.useMemo)((()=>k||be),[k,be]),Oe=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;s(Object(J.setAbsoluteRangeDatePicker)({id:V.a.global,from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[s]),je=Object(n.useCallback)((e=>{e.preventDefault(),he(X(Object(W.e)()))}),[X,he]),Ie=Object(n.useCallback)((a=>{const n=l.i.detectionsPage;t({id:n}),e({id:n}),Se(a)}),[t,e,Se]),Ce=Object(n.useMemo)((()=>[...w,...Object(fe.d)(Z),...Object(fe.a)(ke),...Object(fe.e)(te)]),[w,Z,te,ke]),Me=Object(n.useMemo)((()=>[...Object(fe.d)(Z),...Object(fe.e)(te)]),[Z,te]),De=Object(n.useCallback)((e=>{ee(e)}),[ee]),Ae=Object(n.useCallback)((e=>{re(e)}),[re]),{signalIndexNeedsInit:Fe,pollForSignalIndex:Re}=Object(Wt.a)(),Pe=Object(n.useCallback)((()=>{Object(me.j)(r.current)}),[r]),_e=Object(n.useCallback)((()=>{Object(me.l)()}),[]),qe=Object(n.useCallback)((e=>{Object($.isTab)(e)&&Object(me.k)({containerElement:r.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:Pe,onSkipFocusAfterEventsTable:_e})}),[r,Pe,_e]),Ne=Object(n.useMemo)((()=>({feature:{icon:"documents",label:se.e,url:`${ve.links.siem.privileges}`,target:"_blank"}})),[ve]);return be?i.a.createElement(f.a,null,i.a.createElement(Yt.a,{border:!0,title:se.m,isLoading:be}),i.a.createElement(B.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},i.a.createElement(B.EuiLoadingSpinner,{size:"xl"}))):null==M||M||be?!be&&Fe||N?i.a.createElement(f.a,null,i.a.createElement(Yt.a,{border:!0,title:se.m}),i.a.createElement(oe,{needsSignalsIndex:Fe,needsListsIndex:N})):i.a.createElement(i.a.Fragment,null,null!=D&&!D&&i.a.createElement(ae,null),i.a.createElement(Gt.a,null),i.a.createElement(Kt.a,null),Fe||!1!==_&&!1!==P?!Fe&&_&&P?i.a.createElement(Zt,{onKeyDown:qe,ref:r},i.a.createElement(B.EuiWindowEvent,{event:"resize",handler:y.noop}),i.a.createElement(Q.a,{show:Object(me.m)({globalFullScreen:I,graphEventId:b})},i.a.createElement(G.a,{id:V.a.global,pollForSignalIndex:Re,indexPattern:L})),i.a.createElement(f.a,{noPadding:I,"data-test-subj":"detectionsAlertsPage"},i.a.createElement(pe.a,{show:!I},i.a.createElement(Yt.a,{title:se.m},i.a.createElement(ue.l,{onClick:je,deepLinkId:v.a.rules,"data-test-subj":"manage-alert-detection-rules",fill:!0},se.c)),i.a.createElement(B.EuiHorizontalRule,{margin:"m"}),i.a.createElement(B.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(Jt.a,{status:ke,onFilterGroupChanged:Ie})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(B.EuiFlexItem,{grow:!1},h&&ye.getLastUpdated({updatedAt:h||Date.now(),showUpdating:we}))))),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(Qt,{addFilter:xe,alertsHistogramDefaultFilters:Ce,isLoadingIndexPattern:H,query:x,runtimeMappings:z,signalIndexName:A,updateDateRangeCallback:Oe}),i.a.createElement(B.EuiSpacer,{size:"l"})),i.a.createElement(Y.a,{timelineId:l.i.detectionsPage,loading:be,hasIndexWrite:null!=F&&F,hasIndexMaintenance:null!=R&&R,from:j,defaultFilters:Me,showBuildingBlockAlerts:Z,onShowBuildingBlockAlertsChanged:De,showOnlyThreatIndicatorAlerts:te,onShowOnlyThreatIndicatorAlertsChanged:Ae,to:O,filterGroup:ke}))):i.a.createElement(Xt.a,null):i.a.createElement(ie.a,{actions:Ne,message:se.b,"data-test-subj":"no_feature_permissions-alerts",title:se.d})):i.a.createElement(f.a,null,i.a.createElement(Yt.a,{border:!0,title:se.m}),i.a.createElement(ce,null))},ta=Object(o.connect)(null,(e=>({clearSelected:({id:t})=>e(d.a.clearSelected({id:t})),clearEventsLoading:({id:t})=>e(d.a.clearEventsLoading({id:t})),clearEventsDeleted:({id:t})=>e(d.a.clearEventsDeleted({id:t}))})))(i.a.memo(ea)),aa=N.i18n.translate("xpack.securitySolution.badge.readOnly.text",{defaultMessage:"Read only"});var na=a(344);function ia(e){const{hasKibanaREAD:t,hasKibanaCRUD:a}=Object(na.a)(),i=Object(u.k)().services.chrome;Object(n.useEffect)((()=>(t&&!a&&i.setBadge({text:aa,tooltip:e,iconType:"glasses"}),()=>{i.setBadge()})),[i,t,a,e])}const sa=()=>i.a.createElement(s.TrackApplicationView,{viewId:r.uc.alerts},i.a.createElement(ta,null),i.a.createElement(h.a,{pageName:r.uc.alerts})),ra=()=>(ia(L),i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:r.c,exact:!0,component:sa}),i.a.createElement(_.Route,{component:q.a}))),oa=i.a.memo(ra),la=[{path:r.hb,render:({location:e})=>e.pathname===r.hb?i.a.createElement(P.Redirect,{to:{...e,pathname:r.c}}):i.a.createElement(P.Redirect,{to:{...e,pathname:e.pathname.replace(r.hb,"")}})},{path:r.c,component:()=>i.a.createElement(A,null,i.a.createElement(oa,null))}],ca=[l.i.detectionsRulesDetailsPage,l.i.detectionsPage],ua=N.i18n.translate("xpack.securitySolution.exceptions.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete exceptions"});var da=a(341),pa=a(328),ma=a(202);const ga=H.a.a.withConfig({displayName:"InvisibleAnchor",componentId:"sc-bxvucm-0"})(["display:none;"]),fa=({blob:e,name:t,onDownload:a})=>{const s=Object(n.useRef)(null);return Object(n.useEffect)((()=>{if(e&&null!=s&&s.current){if("function"==typeof window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(e);else{const a=window.URL.createObjectURL(e);s.current.href=a,s.current.download=null!=t?t:"download.txt",s.current.click(),window.URL.revokeObjectURL(a)}a&&a()}}),[e,t,a]),i.a.createElement(ga,{ref:s})};var ba=a(249);const ha=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.idTitle",{defaultMessage:"List ID"}),ya=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.listName",{defaultMessage:"Name"}),Ea=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.actionsTitle",{defaultMessage:"Actions"}),va=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesAssignedTitle",{defaultMessage:"Rules assigned to"}),ka=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateCreatedTitle",{defaultMessage:"Date created"}),Sa=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateUpdatedTitle",{defaultMessage:"Last edited"}),Ta=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.errorFetching",{defaultMessage:"Error fetching exception lists"}),xa=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.filters.noExceptionsTitle",{defaultMessage:"No exception lists found"}),wa=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.search.placeholder",{defaultMessage:"Search exception lists"}),Oa=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitle",{defaultMessage:"Exception lists"}),ja=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.filters.noListsBody",{defaultMessage:"We weren't able to find any exception lists."}),Ia=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportSuccess",{defaultMessage:"Exception list export success"}),Ca=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportError",{defaultMessage:"Exception list export error"}),Ma=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.deleteError",{defaultMessage:"Error occurred deleting exception list"}),Da=e=>N.i18n.translate("xpack.securitySolution.exceptions.referenceModalSuccessDescription",{defaultMessage:"Exception list - {listId} - deleted successfully.",values:{listId:e}}),Aa=N.i18n.translate("xpack.securitySolution.exceptions.referenceModalTitle",{defaultMessage:"Remove exception list"}),Fa=N.i18n.translate("xpack.securitySolution.exceptions.referenceModalCancelButton",{defaultMessage:"Cancel"}),Ra=N.i18n.translate("xpack.securitySolution.exceptions.referenceModalDeleteButton",{defaultMessage:"Remove exception list"}),Pa=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.searchPlaceholder",{defaultMessage:"Search by name or list id"}),_a=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.refresh",{defaultMessage:"Refresh"});var qa=a(419);const Na=({onRefresh:e,totalExceptionLists:t})=>{return i.a.createElement(qa.a,{border:!0},i.a.createElement(qa.d,null,i.a.createElement(qa.c,null,i.a.createElement(qa.e,{dataTestSubj:"showingExceptionLists"},(a=t,N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.showingExceptionLists",{values:{totalLists:a},defaultMessage:"Showing {totalLists} {totalLists, plural, =1 {list} other {lists}}"})))),i.a.createElement(qa.c,null,i.a.createElement(qa.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:e},_a))));var a};Na.displayName="ExceptionsTableUtilityBar";var La=a(674),Ba=a(211),za=a(244),Ha=a(346);const $a=H.a.div.withConfig({displayName:"MarkdownContainer",componentId:"sc-1038msv-0"})(["max-height:200px;overflow-y:auto;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(Ha.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),Va=({cancelText:e,confirmText:t,contentText:a,onClose:n,onCancel:s,onConfirm:r,references:o=[],showModal:l,titleText:c})=>l?i.a.createElement(B.EuiConfirmModal,{maxWidth:460,title:c,onCancel:s,onConfirm:r,cancelButtonText:e,confirmButtonText:t,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"referenceErrorModal"},i.a.createElement("p",null,a),i.a.createElement($a,null,i.a.createElement(B.EuiListGroup,{gutterSize:"none",showToolTips:!0},o.map(((e,t)=>i.a.createElement(B.EuiListGroupItem,{key:`${t}-${e}`,label:e})))))):null;Va.displayName="ReferenceErrorModalComponent";const Ua=i.a.memo(Va);Ua.displayName="ReferenceErrorModal";const Qa={strict:!0,fields:{created_by:{type:"string"},name:{type:"string"},type:{type:"string"},list_id:{type:"string"},tags:{type:"string"}}},Wa=i.a.memo((({onSearch:e})=>i.a.createElement(B.EuiSearchBar,{"data-test-subj":"exceptionsHeaderSearch","aria-label":wa,onChange:e,box:{"data-test-subj":"exceptionsHeaderSearchInput",placeholder:Pa,incremental:!1,schema:Qa}})));Wa.displayName="ExceptionsSearchBar";var Ga=a(448),Ka=a(333);const Ja={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},Ya=i.a.memo((()=>{const{formatUrl:e}=Object(c.l)(r.uc.rules),[{loading:t,canUserCRUD:a,canUserREAD:s}]=Object(ne.b)(),o=Object(pa.c)(a),{loading:l}=Object(le.a)(),d=t||l,{services:{http:p,notifications:m,timelines:g,application:f}}=Object(u.k)(),{exportExceptionList:b,deleteExceptionList:h}=Object(da.c)(p),[y,E]=Object(n.useState)(!1),[v,k]=Object(n.useState)(Ja),[S,T]=Object(n.useState)(void 0),[x,w,O,j,I]=Object(da.g)({errorMessage:Ta,filterOptions:S,http:p,namespaceTypes:["single","agnostic"],notifications:m,hideLists:Ka.a}),[C,M,D]=(({exceptionLists:e})=>{const[t,a]=Object(n.useState)(!0),[i,s]=Object(n.useState)([]),[r,o]=Object(n.useState)({}),l=Object(n.useCallback)((t=>{const a=e.reduce(((e,{id:t,...a})=>(e[t]={...a,id:t,rules:[]},e)),{});return t.reduce(((e,t)=>{const a=t.exceptions_list;return null!=a&&a.length>0&&a.forEach((a=>{const n=e[a.id];null!=n&&(e[a.id]={...n,rules:[...n.rules,t]})})),e}),a)}),[e]);return Object(n.useEffect)((()=>{let t=!0;const n=new AbortController;return(async()=>{if(0===e.length&&t)return a(!1),s([]),void o({});try{a(!0);const{data:e}=await Object(za.e)({pagination:{page:1,perPage:1e4},signal:n.signal}),i=l(e),r=Object.keys(i).map((e=>i[e]));s(r),o(i),t&&a(!1)}catch(e){t&&a(!1)}})(),()=>{t=!1,n.abort()}}),[e.length,l]),[t,i,r]})({exceptionLists:null!=w?w:[]}),[A,F]=Object(n.useState)(!0),[R,P]=Object(n.useState)(Date.now()),[_,q]=Object(n.useState)([]),[L,z]=Object(n.useState)([]),[H,$]=Object(n.useState)({}),{navigateToUrl:V}=f,{addError:U,addSuccess:Q}=Object(ma.a)(),G=Object(n.useCallback)((e=>()=>{m.toasts.addSuccess({title:Da(null!=e?e:v.listId)})}),[m.toasts,v.listId]),K=Object(n.useCallback)((e=>{U(e,{title:Ma})}),[U]),J=Object(n.useCallback)((({id:e,listId:t,namespaceType:a})=>async()=>{try{q((t=>[...t,e])),null!=I&&I(),null!=D[e]&&0===D[e].rules.length?(await h({id:e,namespaceType:a,onError:K,onSuccess:G(t)}),null!=I&&I()):(k({contentText:(n=D[e].rules.length,N.i18n.translate("xpack.securitySolution.exceptions.referenceModalDescription",{defaultMessage:"This exception list is associated with ({referenceCount}) {referenceCount, plural, =1 {rule} other {rules}}. Removing this exception list will also remove its reference from the associated rules.",values:{referenceCount:n}})),rulesReferences:D[e].rules.map((({name:e})=>e)),isLoading:!0,listId:e,listNamespaceType:a}),E(!0))}catch(e){K(e)}finally{q((t=>t.filter((t=>t!==e))))}var n}),[h,D,K,G,I]),Y=Object(n.useCallback)((e=>t=>{Q(Ia),$({name:e,blob:t})}),[Q]),X=Object(n.useCallback)((e=>{U(e,{title:Ca})}),[U]),Z=Object(n.useCallback)((({id:e,listId:t,namespaceType:a})=>async()=>{z((t=>[...t,e])),await b({id:e,listId:t,namespaceType:a,onError:X,onSuccess:Y(t)})}),[b,X,Y]),ee=Object(n.useMemo)((()=>{var t;const n=null===(t=s&&!a)||void 0===t||t;return((e,t,a,n,s)=>[{align:"left",field:"list_id",name:ha,truncateText:!0,dataType:"string",width:"20%",render:e=>i.a.createElement(B.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement("span",{"data-test-subj":"exceptionsTableListId"},e))},{align:"left",field:"name",name:ya,truncateText:!0,dataType:"string",width:"20%",render:e=>i.a.createElement(B.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement("span",{"data-test-subj":"exceptionsTableName"},e))},{field:"rules",name:va,dataType:"string",width:"30%",render:e=>{return i.a.createElement(La.a,{items:e,numberOfItemsToDisplay:1,popoverTitle:va,popoverButtonTitle:(t=e.length-1,N.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesPopoverButton",{defaultMessage:"+{rulesCount} {rulesCount, plural, =1 {Rule} other {Rules}}",values:{rulesCount:t}})),renderItem:({id:e,name:t},s,r)=>{const o=a(Object(W.d)(e)),l=s!==r.length-1;return i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},i.a.createElement(i.a.Fragment,null,i.a.createElement(ue.f,{key:e,"data-test-subj":"ruleNameLink",onClick:e=>{e.preventDefault(),n(o)},href:o},t,l&&","))),l&&" ")},dataTestPrefix:"rules"});var t}},{align:"left",field:"created_at",name:ka,truncateText:!0,dataType:"date",width:"15%",render:e=>i.a.createElement(Ba.b,{relativeThresholdInHrs:r.ab,value:e,tooltipFieldName:ka,tooltipAnchorClassName:"eui-textTruncate"})},{align:"left",field:"updated_at",name:Sa,truncateText:!0,width:"15%",render:e=>i.a.createElement(Ba.b,{relativeThresholdInHrs:r.ab,value:e,tooltipFieldName:Sa,tooltipAnchorClassName:"eui-textTruncate"})},{align:"left",width:"76px",name:Ea,actions:[{render:({id:t,list_id:a,namespace_type:n})=>i.a.createElement(B.EuiButtonIcon,{onClick:e({id:t,listId:a,namespaceType:n}),"aria-label":"Export exception list",iconType:"exportAction","data-test-subj":"exceptionsTableExportButton"})},{render:({id:e,list_id:a,namespace_type:n})=>"endpoint_list"===a||s?i.a.createElement(i.a.Fragment,null):i.a.createElement(B.EuiButtonIcon,{color:"danger",onClick:t({id:e,listId:a,namespaceType:n}),"aria-label":"Delete exception list",iconType:"trash","data-test-subj":"exceptionsTableDeleteButton"})}]}])(Z,J,e,V,n)}),[Z,J,e,V,s,a]),te=Object(n.useCallback)((()=>{null!=I&&(P(Date.now()),I())}),[I]);Object(n.useEffect)((()=>{!A||d||x||C||F(!1)}),[A,d,x,C]);const ae=Object(n.useMemo)((()=>i.a.createElement(B.EuiEmptyPrompt,{title:i.a.createElement("h3",null,xa),titleSize:"xs",body:ja})),[]),ie=Object(n.useCallback)((async({query:e,queryText:t})=>{const a=Object(Ga.d)({defaultSearchTerm:"name",filterOptions:{name:null,list_id:null,created_by:null,type:null,tags:null},query:e,searchValue:t});T(a)}),[]),se=Object(n.useCallback)((()=>{q([]),E(!1),k({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})}),[]),re=Object(n.useCallback)((async()=>{const e=v.listId,t=v.listNamespaceType,a=D[e].rules;try{await Promise.all(a.map((t=>{var a;const n=new AbortController,i=(null!==(a=t.exceptions_list)&&void 0!==a?a:[]).filter((({id:t})=>t!==e));return Object(za.j)({ruleProperties:{rule_id:t.rule_id,exceptions_list:i},signal:n.signal})}))),await h({id:e,namespaceType:t,onError:K,onSuccess:G()})}catch(e){K(e)}finally{k(Ja),q([]),E(!1),null!=I&&I()}}),[v.listId,v.listNamespaceType,D,h,K,G,I]),oe=Object(n.useMemo)((()=>({pageIndex:O.page-1,pageSize:O.perPage,totalItemCount:O.total||0,pageSizeOptions:[5,10,20,50,100,200,300]})),[O]),ce=Object(n.useCallback)((()=>{$({})}),[]),de=Object(n.useMemo)((()=>(null!=M?M:[]).map((e=>({...e,isDeleting:_.includes(e.id),isExporting:L.includes(e.id)})))),[_,M,L]),pe=Object(n.useCallback)((e=>{const{index:t,size:a}=e.page;j((e=>({...e,perPage:a,page:t+1})))}),[j]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Kt.a,null),i.a.createElement(B.EuiPageHeader,{pageTitle:Oa,description:i.a.createElement("p",null,g.getLastUpdated({showUpdating:d,updatedAt:R}))}),i.a.createElement(B.EuiHorizontalRule,null),i.a.createElement("div",{"data-test-subj":"allExceptionListsPanel"},C&&i.a.createElement(B.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),!A&&i.a.createElement(Wa,{onSearch:ie}),i.a.createElement(B.EuiSpacer,{size:"m"}),C&&!A&&!y&&i.a.createElement(ba.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),A?i.a.createElement(B.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}):i.a.createElement(i.a.Fragment,null,i.a.createElement(Na,{totalExceptionLists:M.length,onRefresh:te}),i.a.createElement(B.EuiBasicTable,{"data-test-subj":"exceptions-table",columns:ee,isSelectable:o,itemId:"id",items:de,noItemsMessage:ae,onChange:pe,pagination:oe})),i.a.createElement(fa,{blob:H.blob,name:`${H.name}.ndjson`,onDownload:ce}),i.a.createElement(Ua,{cancelText:Fa,confirmText:Ra,contentText:v.contentText,onCancel:se,onClose:se,onConfirm:re,references:v.rulesReferences,showModal:y,titleText:Aa})))}));Ya.displayName="ExceptionListsTable";const Xa=()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:r.uc.exceptions},i.a.createElement(Ya,null),i.a.createElement(h.a,{pageName:r.uc.exceptions}))),Za=()=>(ia(ua),i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:r.Eb,exact:!0,component:Xa}),i.a.createElement(_.Route,{component:q.a}))),en=i.a.memo(Za),tn=[{path:r.Eb,render:()=>i.a.createElement(en,null)}];var an=a(177),nn=a(532),sn=a(345),rn=a(77),on=a(455),ln=a(475),cn=a(658),un=a(254),dn=a(224),pn=a(350),mn=a(379),gn=a(682),fn=a(78),bn=a(435),hn=a(53),yn=a.n(hn),En=a(232),vn=a(425),kn=a(365),Sn=a(324),Tn=a(273),xn=a(467),wn=a(626);var On=a(387);const jn=(e,t)=>"host.name"===e.entityName&&(null==t||e.entityValue===t);var In=a(553);const Cn=(e,t)=>e===En.HostsType.details&&null!=t?[{fieldName:"host.name",fieldValue:t}]:[];var Mn=a(348),Dn=a(286),An=a(554),Fn=a(555),Rn=a(272);const Pn={sort:{field:"anomaly.severity",direction:"desc"}},_n=({startDate:e,endDate:t,hostName:a,skip:s,type:r})=>{const l=Object(o.useDispatch)(),c=Object(dn.a)(),{toggleStatus:u,setToggleStatus:d}=Object(zt.a)("AnomaliesHostTable"),[p,m]=Object(n.useState)(s||!u);Object(n.useEffect)((()=>{m(s||!u)}),[s,u]);const g=Object(n.useCallback)((e=>{d(e),m(!e)}),[m,d]),{jobIds:f,loading:b}=Object(Dn.b)(),h=Object(n.useMemo)((()=>Rn.d.hostsAnomaliesJobIdFilterSelector()),[]),y=Object(E.a)((e=>h(e,r))),v=Object(n.useCallback)((e=>{l(Rn.a.updateHostsAnomaliesJobIdFilter({jobIds:e,hostsType:r}))}),[l,r]),k=Object(n.useMemo)((()=>Rn.d.hostsAnomaliesIntervalSelector()),[]),S=Object(E.a)((e=>k(e,r))),T=Object(n.useCallback)((e=>{l(Rn.a.updateHostsAnomaliesInterval({interval:e,hostsType:r}))}),[l,r]),[x,w]=Object(kn.a)({startDate:e,endDate:t,skip:p,criteriaFields:Cn(r,a),filterQuery:{exists:{field:"host.name"}},jobIds:y.length>0?y:f,aggregationInterval:S}),O=((e,t)=>null==e?[]:e.anomalies.reduce(((e,a)=>{if(jn(a,t))return[...e,{hostName:a.entityValue,anomaly:a}];{const n=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(On.a)(e);return"host.name"===a&&(null==t||n===t)}));return null!=a?Object.values(a)[0]:null})(a.influencers,t);return null!=n?[...e,{hostName:n,anomaly:a}]:e}}),[]))(w,a),j=((e,t,a)=>{const n=((e,t)=>[{name:Sn.d,field:"hostName",sortable:!0,render:(e,t)=>Object(Tn.b)({rowItem:e,attrName:"host.name",idPrefix:`anomalies-host-table-hostName-${Object(xn.a)(t.anomaly)}-hostName`,render:e=>i.a.createElement(ue.d,{hostName:e}),isAggregatable:!0,fieldType:"keyword"})},...Object(wn.a)(e,t)])(t,a);return e===En.HostsType.details?n.filter((e=>e.name!==Sn.d)):n})(r,e,t),I={initialPageIndex:0,initialPageSize:10,totalItemCount:O.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(un.a)(c)?i.a.createElement(Mn.a,{loading:x||b},i.a.createElement(Tt.a,{subtitle:`${Sn.o}: ${I.totalItemCount.toLocaleString()} ${Sn.r(I.totalItemCount)}`,title:Sn.a,toggleQuery:g,toggleStatus:u,tooltip:Sn.q,isInspectDisabled:s,headerFilters:i.a.createElement(B.EuiFlexGroup,null,i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Fn.a,{interval:S,onChange:T})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(An.a,{title:Sn.l,onSelect:v,selectedJobIds:y,jobIds:f})))}),u&&i.a.createElement(In.a,{"data-test-subj":"host-anomalies-table",columns:j,items:O,pagination:I,sorting:Pn}),(x||b)&&i.a.createElement(ba.a,{"data-test-subj":"anomalies-host-table-loading-panel",overlay:!0,size:"xl"})):null},qn=i.a.memo(_n);var Nn=a(476),Ln=a(321),Bn=a(546),zn=a(429),Hn=a(264);const $n=N.i18n.translate("xpack.securitySolution.authenticationsTable.authentications",{defaultMessage:"Authentications"}),Vn=e=>N.i18n.translate("xpack.securitySolution.authenticationsTable.usersUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),Un=e=>N.i18n.translate("xpack.securitySolution.authenticationsTable.hostsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {host} other {hosts}}"}),Qn=N.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulSource",{defaultMessage:"Last successful source"}),Wn=N.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulDestination",{defaultMessage:"Last successful destination"}),Gn=N.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulTime",{defaultMessage:"Last success"}),Kn=N.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedSource",{defaultMessage:"Last failed source"}),Jn=N.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedDestination",{defaultMessage:"Last failed destination"}),Yn=N.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedTime",{defaultMessage:"Last failure"}),Xn=N.i18n.translate("xpack.securitySolution.authenticationsTable.successes",{defaultMessage:"Successes"}),Zn=N.i18n.translate("xpack.securitySolution.authenticationsTable.failures",{defaultMessage:"Failures"}),ei=N.i18n.translate("xpack.securitySolution.authenticationsTable.user",{defaultMessage:"User"}),ti=N.i18n.translate("xpack.securitySolution.authenticationsTable.host",{defaultMessage:"Host"}),ai=N.i18n.translate("xpack.securitySolution.authenticationsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),ni=N.i18n.translate("xpack.securitySolution.authenticationsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),ii=N.i18n.translate("xpack.securitySolution.hosts.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),si=N.i18n.translate("xpack.securitySolution.hosts.navigaton.matrixHistogram.errorFetchingAuthenticationsData",{defaultMessage:"Failed to query authentications data"});var ri=a(203),oi=a(295);const li={title:"Authentication",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"3fd0c5d5-f762-4a27-8c56-14eee0223e13",accessors:["5417777d-d9d9-4268-9cdc-eb29b873bd65"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"b41a2958-650b-470a-84c4-c6fd8f0c6d37",yConfig:[{forAccessor:"5417777d-d9d9-4268-9cdc-eb29b873bd65",color:"#54b399"}]},{layerId:"bef502be-e5ff-442f-9e3e-229f86ca2afa",seriesType:"bar_stacked",accessors:["a3bf9dc1-c8d2-42d6-9e60-31892a4c509e"],layerType:"data",xAccessor:"cded27f7-8ef8-458c-8d9b-70db48ae340d",yConfig:[{forAccessor:"a3bf9dc1-c8d2-42d6-9e60-31892a4c509e",color:"#da8b45"}]}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0}},query:{query:"",language:"kuery"},filters:[{meta:{index:"6f4dbdc7-35b6-4e20-ac53-1272167e3919",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"must":[{"term":{"event.category":"authentication"}}]}}'},$state:{store:"appState"},query:{bool:{must:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{indexpattern:{layers:{"3fd0c5d5-f762-4a27-8c56-14eee0223e13":{columns:{"b41a2958-650b-470a-84c4-c6fd8f0c6d37":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"5417777d-d9d9-4268-9cdc-eb29b873bd65":{label:oi.e,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",filter:{query:'event.outcome : "success"',language:"kuery"},customLabel:!0}},columnOrder:["b41a2958-650b-470a-84c4-c6fd8f0c6d37","5417777d-d9d9-4268-9cdc-eb29b873bd65"],incompleteColumns:{}},"bef502be-e5ff-442f-9e3e-229f86ca2afa":{columns:{"cded27f7-8ef8-458c-8d9b-70db48ae340d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"a3bf9dc1-c8d2-42d6-9e60-31892a4c509e":{label:oi.d,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",filter:{query:'event.outcome : "failure"',language:"kuery"},customLabel:!0}},columnOrder:["cded27f7-8ef8-458c-8d9b-70db48ae340d","a3bf9dc1-c8d2-42d6-9e60-31892a4c509e"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-3fd0c5d5-f762-4a27-8c56-14eee0223e13"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-bef502be-e5ff-442f-9e3e-229f86ca2afa"},{type:"index-pattern",name:"6f4dbdc7-35b6-4e20-ac53-1272167e3919",id:"{dataViewId}"}]};var ci;const ui=()=>[Ei,ki,pi,mi,gi,fi,bi,hi,yi],di=[{text:ai,numberOfRow:5},{text:ni,numberOfRow:10}],pi={name:Zn,field:"node.failures",truncateText:!1,mobileOptions:{show:!0},width:"8%"},mi={name:Gn,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(y.has)("lastSuccess.timestamp",e)&&null!=(null===(t=e.lastSuccess)||void 0===t?void 0:t.timestamp)?i.a.createElement(Ba.b,{value:null===(a=e.lastSuccess)||void 0===a?void 0:a.timestamp}):Object(ri.d)()}},gi={name:Qn,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(Tn.c)({rowItems:(null===(t=e.lastSuccess)||void 0===t||null===(a=t.source)||void 0===a?void 0:a.ip)||null,isAggregatable:!0,fieldType:"ip",attrName:"source.ip",idPrefix:`authentications-table-${e._id}-lastSuccessSource`,render:e=>i.a.createElement(ue.h,{ip:e})})}},fi={name:Wn,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a,n;return Object(Tn.c)({rowItems:null!==(t=null===(a=e.lastSuccess)||void 0===a||null===(n=a.host)||void 0===n?void 0:n.name)&&void 0!==t?t:null,isAggregatable:!0,fieldType:"keyword",attrName:"host.name",idPrefix:`authentications-table-${e._id}-lastSuccessfulDestination`,render:e=>i.a.createElement(ue.d,{hostName:e})})}},bi={name:Yn,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(y.has)("lastFailure.timestamp",e)&&null!=(null===(t=e.lastFailure)||void 0===t?void 0:t.timestamp)?i.a.createElement(Ba.b,{value:null===(a=e.lastFailure)||void 0===a?void 0:a.timestamp}):Object(ri.d)()}},hi={name:Kn,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(Tn.c)({rowItems:(null===(t=e.lastFailure)||void 0===t||null===(a=t.source)||void 0===a?void 0:a.ip)||null,isAggregatable:!0,fieldType:"ip",attrName:"source.ip",idPrefix:`authentications-table-${e._id}-lastFailureSource`,render:e=>i.a.createElement(ue.h,{ip:e})})}},yi={name:Jn,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(Tn.c)({rowItems:(null===(t=e.lastFailure)||void 0===t||null===(a=t.host)||void 0===a?void 0:a.name)||null,attrName:"host.name",idPrefix:`authentications-table-${e._id}-lastFailureDestination`,render:e=>i.a.createElement(ue.d,{hostName:e}),isAggregatable:!0,fieldType:"ip"})}},Ei={name:ei,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(Tn.c)({rowItems:e.stackedValue,attrName:"user.name",isAggregatable:!0,fieldType:"keyword",idPrefix:`authentications-table-${e._id}-userName`,render:e=>i.a.createElement(ue.m,{userName:e})})},vi={name:ti,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(Tn.c)({rowItems:e.stackedValue,attrName:"host.name",isAggregatable:!0,fieldType:"keyword",idPrefix:`authentications-table-${e._id}-hostName`,render:e=>i.a.createElement(ue.d,{hostName:e})})},ki={name:Xn,field:"node.successes",truncateText:!1,mobileOptions:{show:!0},width:"8%"},Si=[{text:"event.outcome",value:"event.outcome"}];var Ti;let xi;!function(e){e.authenticationsSuccess="success",e.authenticationsFailure="failure"}(Ti||(Ti={})),function(e){e.authenticationsSuccess="#54B399",e.authenticationsFailure="#E7664C"}(xi||(xi={}));const wi={[Ti.authenticationsSuccess]:{key:Ti.authenticationsSuccess,value:null,color:xi.authenticationsSuccess},[Ti.authenticationsFailure]:{key:Ti.authenticationsFailure,value:null,color:xi.authenticationsFailure}},Oi={defaultStackByOption:null!==(ci=Si.find((e=>"event.outcome"===e.text)))&&void 0!==ci?ci:Si[0],errorMessage:si,histogramType:rn.l.authentications,mapping:wi,stackByOptions:Si,title:ii,lensAttributes:li};var ji=a(92),Ii=a.n(ji),Ci=a(104),Mi=a(229),Di=a(281);const Ai=N.i18n.translate("xpack.securitySolution.authentications.failSearchDescription",{defaultMessage:"Failed to run search on authentications"});var Fi=a(240);const Ri=({activePage:e,endDate:t,filterQuery:a,indexNames:i,limit:s,skip:r,stackByField:o,startDate:l})=>{const[c,u]=Object(n.useState)(null),d=Object(n.useCallback)((e=>{u((t=>t?{...t,pagination:Object(Di.a)(e,s)}:t))}),[s]),{loading:p,result:m,search:g,refetch:f,inspect:b}=Object(Fi.a)({factoryQueryType:Ci.y.authentications,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Ai,abort:r}),h=Object(n.useMemo)((()=>({endDate:t,authentications:m.edges,inspect:b,isInspected:!1,loadPage:d,pageInfo:m.pageInfo,refetch:f,startDate:l,totalCount:m.totalCount})),[t,b,f,m.edges,m.pageInfo,m.totalCount,l,d]);return Object(n.useEffect)((()=>{u((n=>{const r={...null!=n?n:{},defaultIndex:i,factoryQueryType:Ci.y.authentications,filterQuery:Object(Mi.a)(a),stackByField:o,pagination:Object(Di.a)(e,s),timerange:{interval:"12h",from:l,to:t},sort:{}};return Ii()(n,r)?n:r}))}),[e,t,a,i,o,s,l]),Object(n.useEffect)((()=>{!r&&c&&g(c)}),[c,g,r]),[p,h]};var Pi=a(221);const _i="authenticationsHostsTableQuery",qi=Rn.b.HostsTableType.authentications,Ni=({endDate:e,filterQuery:t,indexNames:a,skip:s,startDate:r,type:l,setQuery:c,deleteQuery:u})=>{const d=Object(o.useDispatch)(),{toggleStatus:p}=Object(zt.a)(_i),[m,g]=Object(n.useState)(s||!p);Object(n.useEffect)((()=>{g(s||!p)}),[s,p]);const f=Rn.d.authenticationsSelector(),{activePage:b,limit:h}=Object(E.a)((e=>f(e,l))),[v,{authentications:k,totalCount:S,pageInfo:T,loadPage:x,inspect:w,isInspected:O,refetch:j}]=Ri({endDate:e,filterQuery:t,indexNames:a,skip:m,startDate:r,stackByField:rn.a.userName,activePage:b,limit:h}),I=l===Rn.b.HostsType.details?[Ei,ki,pi,mi,gi,bi,hi]:ui(),C=Object(n.useCallback)((e=>d(Rn.a.updateTableLimit({hostsType:l,limit:e,tableType:qi}))),[l,d]),M=Object(n.useCallback)((e=>d(Rn.a.updateTableActivePage({activePage:e,hostsType:l,tableType:qi}))),[l,d]);return Object(Pi.b)({queryId:_i,loading:v,refetch:j,setQuery:c,deleteQuery:u,inspect:w}),i.a.createElement(Hn.a,{activePage:b,columns:I,dataTestSubj:"authentications-host-table",headerCount:S,headerTitle:$n,headerUnit:Vn(S),id:_i,isInspect:O,itemsPerRow:di,limit:h,loading:v,loadPage:x,pageOfItems:k,setQuerySkip:g,showMorePagesIndicator:Object(y.getOr)(!1,"showMorePagesIndicator",T),totalCount:Object(y.getOr)(50,"fakeTotalCount",T),updateLimitPagination:C,updateActivePage:M})};Ni.displayName="AuthenticationsHostTableComponent";const Li=i.a.memo(Ni),Bi=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:n,skip:s,setQuery:r,startDate:o,type:l})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(zn.a,yn()({endDate:t,filterQuery:a,id:"authenticationsHistogramQuery",indexNames:n,setQuery:r,startDate:o},Oi)),i.a.createElement(Li,{endDate:t,filterQuery:a,indexNames:n,setQuery:r,deleteQuery:e,startDate:o,type:l,skip:s}));Bi.displayName="AuthenticationsQueryTabBodyComponent";const zi=i.a.memo(Bi);zi.displayName="AuthenticationsQueryTabBody";const Hi=N.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),$i="hostsAllQuery";var Vi=a(256),Ui=a(35),Qi=a(265);const Wi=N.i18n.translate("xpack.securitySolution.hostsTable.hostsTitle",{defaultMessage:"All hosts"}),Gi=e=>N.i18n.translate("xpack.securitySolution.hostsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {host} other {hosts}}"}),Ki=(N.i18n.translate("xpack.securitySolution.hostsRiskTable.tableTitle",{defaultMessage:"Host risk"}),N.i18n.translate("xpack.securitySolution.hostsTable.nameTitle",{defaultMessage:"Host name"})),Ji=N.i18n.translate("xpack.securitySolution.hostsTable.lastSeenTitle",{defaultMessage:"Last seen"}),Yi=N.i18n.translate("xpack.securitySolution.hostsTable.firstLastSeenToolTip",{defaultMessage:"Relative to the selected date range"}),Xi=N.i18n.translate("xpack.securitySolution.hostsTable.hostRiskToolTip",{defaultMessage:"Host risk classification is determined by host risk score. Hosts classified as Critical or High are indicated as risky."}),Zi=N.i18n.translate("xpack.securitySolution.hostsTable.osLastSeenToolTip",{defaultMessage:"Last observed operating system"}),es=N.i18n.translate("xpack.securitySolution.hostsTable.osTitle",{defaultMessage:"Operating system"}),ts=N.i18n.translate("xpack.securitySolution.hostsTable.versionTitle",{defaultMessage:"Version"}),as=N.i18n.translate("xpack.securitySolution.hostsTable.hostRiskTitle",{defaultMessage:"Host risk classification"}),ns=N.i18n.translate("xpack.securitySolution.hostsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),is=N.i18n.translate("xpack.securitySolution.hostsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),ss=N.i18n.translate("xpack.securitySolution.hostsRiskTable.hostNameTitle",{defaultMessage:"Host Name"}),rs=N.i18n.translate("xpack.securitySolution.hostsRiskTable.hostRiskScoreTitle",{defaultMessage:"Host risk score"}),os=N.i18n.translate("xpack.securitySolution.hostsRiskTable.riskTitle",{defaultMessage:"Host risk classification"}),ls=N.i18n.translate("xpack.securitySolution.hostsRiskTable.hostRiskToolTip",{defaultMessage:"Host risk classification is determined by host risk score. Hosts classified as Critical or High are indicated as risky."}),cs=N.i18n.translate("xpack.securitySolution.hostsRiskTable.hostRiskTitle",{defaultMessage:"Host risk"}),us=N.i18n.translate("xpack.securitySolution.hostsRiskTable.hostsTableTooltip",{defaultMessage:"The host risk table is not affected by the KQL time range. This table shows the latest recorded risk score for each host."}),ds=e=>N.i18n.translate("xpack.securitySolution.hostsRiskTable.filteredHostsTitle",{values:{severity:e},defaultMessage:"View {severity} risk hosts"});var ps=a(275),ms=a(107),gs=a(100);const fs=Rn.b.HostsTableType.hosts,bs=[{text:ns,numberOfRow:5},{text:is,numberOfRow:10}],hs=({data:e,fakeTotalCount:t,id:a,isInspect:s,loading:l,loadPage:c,setQuerySkip:u,showMorePagesIndicator:d,totalCount:p,type:m})=>{const g=Object(o.useDispatch)(),{navigateTo:f}=Object(gs.i)(),b=Object(n.useMemo)((()=>Rn.d.hostsSelector()),[]),{activePage:h,direction:y,limit:v,sortField:k}=Object(E.a)((e=>b(e,m))),S=Object(n.useCallback)((e=>g(Rn.a.updateTableLimit({hostsType:m,limit:e,tableType:fs}))),[m,g]),T=Object(n.useCallback)((e=>g(Rn.a.updateTableActivePage({activePage:e,hostsType:m,tableType:fs}))),[m,g]),x=Object(n.useCallback)((e=>{if(null!=e.sort){const t={field:ys(e.sort.field),direction:e.sort.direction};t.direction===y&&t.field===k||g(Rn.a.updateHostsSort({sort:t,hostsType:m}))}}),[y,k,m,g]),w=Object(dn.a)().isPlatinumOrTrialLicense,O=Object(n.useCallback)((e=>{g(Rn.a.updateHostRiskScoreSeverityFilter({severitySelection:[e],hostsType:m})),f({deepLinkId:r.uc.hosts,path:En.HostsTableType.risk})}),[g,f,m]),j=Object(n.useMemo)((()=>((e,t)=>{const a=[{field:"node.host.name",name:Ki,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e&&e.length>0){const t=Object(Ze.h)(`hosts-table-hostName-${e[0]}`);return i.a.createElement(Vi.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e[0],kqlQuery:"",queryMatch:{field:"host.name",value:e[0],operator:Ui.c}},isAggregatable:!0,fieldType:"keyword",render:(t,a,n)=>n.isDragging?i.a.createElement(Vi.a,null,i.a.createElement(Qi.a,{dataProvider:t})):i.a.createElement(ue.d,{hostName:e[0]})})}return Object(ri.d)()},width:"35%"},{field:"node.lastSeen",name:i.a.createElement(B.EuiToolTip,{content:Yi},i.a.createElement(i.a.Fragment,null,Ji," ",i.a.createElement(B.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e&&e.length>0?i.a.createElement(Ba.b,{value:Array.isArray(e)?e[0]:e}):Object(ri.d)()},{field:"node.host.os.name",name:i.a.createElement(B.EuiToolTip,{content:Zi},i.a.createElement(i.a.Fragment,null,es," ",i.a.createElement(B.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(qt.b,{id:`host-page-draggable-host.os.name-${e[0]}`,field:"host.os.name",value:e[0],isDraggable:!1,hideTopN:!0,tooltipContent:null}):Object(ri.d)()},{field:"node.host.os.version",name:ts,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(qt.b,{id:`host-page-draggable-host.os.version-${e[0]}`,field:"host.os.version",value:e[0],isDraggable:!1,hideTopN:!0,tooltipContent:null}):Object(ri.d)()}];return e&&a.push({field:"node.risk",name:i.a.createElement(B.EuiToolTip,{content:Xi},i.a.createElement(i.a.Fragment,null,as," ",i.a.createElement(B.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(ps.b,{toolTipContent:i.a.createElement(B.EuiLink,{onClick:()=>t(e)},i.a.createElement(B.EuiText,{size:"xs"},ds(e.toLowerCase()))),severity:e}):Object(ri.d)()}),a})(w,O)),[O,w]),I=Object(n.useMemo)((()=>((e,t)=>({field:Es(e),direction:t}))(k,y)),[k,y]);return i.a.createElement(Hn.a,{activePage:h,columns:j,dataTestSubj:`table-${fs}`,headerCount:p,headerTitle:Wi,headerUnit:Gi(p),id:a,isInspect:s,itemsPerRow:bs,limit:v,loading:l,loadPage:c,onChange:x,pageOfItems:e,setQuerySkip:u,showMorePagesIndicator:d,sorting:I,totalCount:t,updateLimitPagination:S,updateActivePage:T})};hs.displayName="HostsTableComponent";const ys=e=>"node.host.name"===e?ms.b.hostName:ms.b.lastSeen,Es=e=>{switch(e){case ms.b.hostName:return"node.host.name";case ms.b.lastSeen:return"node.lastSeen"}},vs=i.a.memo(hs);vs.displayName="HostsTable";const ks=Object(Pi.a)(vs),Ss=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:s,skip:r,setQuery:o,startDate:l,type:c})=>{const{toggleStatus:u}=Object(zt.a)($i),[d,p]=Object(n.useState)(r||!u);Object(n.useEffect)((()=>{p(r||!u)}),[r,u]);const[m,{hosts:g,totalCount:f,pageInfo:b,loadPage:h,id:v,inspect:k,isInspected:S,refetch:T}]=(({endDate:e,filterQuery:t,indexNames:a,skip:i=!1,startDate:s,type:r})=>{const o=Object(n.useMemo)((()=>Rn.d.hostsSelector()),[]),{activePage:l,direction:c,limit:u,sortField:d}=Object(E.a)((e=>o(e,r))),[p,m]=Object(n.useState)(null),g=Object(n.useCallback)((e=>{m((t=>t?{...t,pagination:Object(Di.a)(e,u)}:t))}),[u]),{loading:f,result:b,search:h,refetch:y,inspect:v}=Object(Fi.a)({factoryQueryType:rn.j.hosts,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Hi,abort:i}),k=Object(n.useMemo)((()=>({endDate:e,hosts:b.edges,id:$i,inspect:v,isInspected:!1,loadPage:g,pageInfo:b.pageInfo,refetch:y,startDate:s,totalCount:b.totalCount})),[e,v,y,b.edges,b.pageInfo,b.totalCount,s,g]);return Object(n.useEffect)((()=>{m((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rn.j.hosts,filterQuery:Object(Mi.a)(t),pagination:Object(Di.a)(l,u),timerange:{interval:"12h",from:s,to:e},sort:{direction:c,field:d}};return Ii()(n,i)?n:i}))}),[l,c,e,t,a,u,s,d]),Object(n.useEffect)((()=>{!i&&p&&h(p)}),[p,h,i]),[f,k]})({endDate:t,filterQuery:a,indexNames:s,skip:d,startDate:l,type:c});return i.a.createElement(ks,{deleteQuery:e,data:g,fakeTotalCount:Object(y.getOr)(50,"fakeTotalCount",b),id:v,inspect:k,isInspect:S,loading:m,loadPage:h,refetch:T,setQuery:o,setQuerySkip:p,showMorePagesIndicator:Object(y.getOr)(!1,"showMorePagesIndicator",b),totalCount:f,type:c})};Ss.displayName="HostsQueryTabBody";const Ts=N.i18n.translate("xpack.securitySolution.uncommonProcesses.failSearchDescription",{defaultMessage:"Failed to run search on uncommon processes"}),xs="hostsUncommonProcessesQuery",ws=N.i18n.translate("xpack.securitySolution.authenticationsTable.uncommonProcessTable",{defaultMessage:"Uncommon processes"}),Os=e=>N.i18n.translate("xpack.securitySolution.uncommonProcessTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {process} other {processes}}"}),js=N.i18n.translate("xpack.securitySolution.uncommonProcessTable.hostsTitle",{defaultMessage:"Host names"}),Is=N.i18n.translate("xpack.securitySolution.uncommonProcessTable.numberOfHostsTitle",{defaultMessage:"Hosts"}),Cs=N.i18n.translate("xpack.securitySolution.uncommonProcessTable.numberOfInstances",{defaultMessage:"Instances"}),Ms=N.i18n.translate("xpack.securitySolution.uncommonProcessTable.lastCommandTitle",{defaultMessage:"Last command"}),Ds=N.i18n.translate("xpack.securitySolution.uncommonProcessTable.lastUserTitle",{defaultMessage:"Last user"}),As=N.i18n.translate("xpack.securitySolution.uncommonProcessTable.nameTitle",{defaultMessage:"Process name"}),Fs=N.i18n.translate("xpack.securitySolution.uncommonProcessTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Rs=N.i18n.translate("xpack.securitySolution.uncommonProcessTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Ps=Rn.b.HostsTableType.uncommonProcesses,_s=[{text:Fs,numberOfRow:5},{text:Rs,numberOfRow:10}],qs=i.a.memo((({data:e,fakeTotalCount:t,id:a,isInspect:s,loading:r,loadPage:l,totalCount:c,setQuerySkip:u,showMorePagesIndicator:d,type:p})=>{const m=Object(o.useDispatch)(),g=Object(n.useMemo)((()=>Rn.d.uncommonProcessesSelector()),[]),{activePage:f,limit:b}=Object(E.a)((e=>g(e,p))),h=Object(n.useCallback)((e=>m(Rn.a.updateTableLimit({hostsType:p,limit:e,tableType:Ps}))),[p,m]),y=Object(n.useCallback)((e=>m(Rn.a.updateTableActivePage({activePage:e,hostsType:p,tableType:Ps}))),[p,m]),v=Object(n.useMemo)((()=>Ls(p)),[p]);return i.a.createElement(Hn.a,{activePage:f,columns:v,dataTestSubj:`table-${Ps}`,headerCount:c,headerTitle:ws,headerUnit:Os(c),id:a,isInspect:s,itemsPerRow:_s,limit:b,loading:r,loadPage:l,pageOfItems:e,setQuerySkip:u,showMorePagesIndicator:d,totalCount:t,updateLimitPagination:h,updateActivePage:y})}));qs.displayName="UncommonProcessTableComponent";const Ns=i.a.memo(qs);Ns.displayName="UncommonProcessTable";const Ls=e=>{const t=[{name:As,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(Tn.c)({rowItems:e.process.name,attrName:"process.name",idPrefix:`uncommon-process-table-${e._id}-processName`,isAggregatable:!0,fieldType:"keyword"}),width:"20%"},{align:"right",name:Is,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>i.a.createElement(i.a.Fragment,null,null!=e.hosts?e.hosts.length:Object(ri.e)()),width:"8%"},{align:"right",name:Cs,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(ri.a)(e.instances),width:"8%"},{name:js,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{return Object(Tn.c)({rowItems:(t=e.hosts,null!=t?t.filter((e=>null!=e.name&&null!=e.name[0])).map((e=>null!=e.name&&null!=e.name[0]?e.name[0]:"")):[]),attrName:"host.name",idPrefix:`uncommon-process-table-${e._id}-processHost`,render:e=>i.a.createElement(ue.d,{hostName:e}),isAggregatable:!0,fieldType:"keyword"});var t},width:"25%"},{name:Ms,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(Tn.c)({rowItems:null!=e.process?e.process.args:null,attrName:"process.args",idPrefix:`uncommon-process-table-${e._id}-processArgs`,displayCount:1,isAggregatable:!0,fieldType:"keyword"}),width:"25%"},{name:Ds,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(Tn.c)({rowItems:null!=e.user?e.user.name:null,attrName:"user.name",idPrefix:`uncommon-process-table-${e._id}-processUser`,isAggregatable:!0,fieldType:"keyword"})}];return e===En.HostsType.details?[js,Is].reduce(((e,t)=>(e.splice(e.findIndex((e=>e.name===t)),1),e)),t):t},Bs=Object(Pi.a)(Ns),zs=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:s,skip:r,setQuery:o,startDate:l,type:c})=>{const{toggleStatus:u}=Object(zt.a)(xs),[d,p]=Object(n.useState)(r||!u);Object(n.useEffect)((()=>{p(r||!u)}),[r,u]);const[m,{uncommonProcesses:g,totalCount:f,pageInfo:b,loadPage:h,id:v,inspect:k,isInspected:S,refetch:T}]=(({endDate:e,filterQuery:t,indexNames:a,skip:i=!1,startDate:s,type:r})=>{const o=Object(n.useMemo)((()=>Rn.d.uncommonProcessesSelector()),[]),{activePage:l,limit:c}=Object(E.a)((e=>o(e,r))),[u,d]=Object(n.useState)(null),p=Object(n.useCallback)((e=>{d((t=>t?{...t,pagination:Object(Di.a)(e,c)}:t))}),[c]),{loading:m,result:g,search:f,refetch:b,inspect:h}=Object(Fi.a)({factoryQueryType:rn.j.uncommonProcesses,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Ts,abort:i}),y=Object(n.useMemo)((()=>({id:xs,inspect:h,isInspected:!1,loadPage:p,pageInfo:g.pageInfo,refetch:b,totalCount:g.totalCount,uncommonProcesses:g.edges})),[h,b,g.edges,g.pageInfo,g.totalCount,p]);return Object(n.useEffect)((()=>{d((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rn.j.uncommonProcesses,filterQuery:Object(Mi.a)(t),pagination:Object(Di.a)(l,c),timerange:{interval:"12h",from:s,to:e},sort:{}};return Ii()(n,i)?n:i}))}),[l,a,e,t,c,s]),Object(n.useEffect)((()=>{!i&&u&&f(u)}),[f,i,u]),[m,y]})({endDate:t,filterQuery:a,indexNames:s,skip:d,startDate:l,type:c});return i.a.createElement(Bs,{deleteQuery:e,data:g,fakeTotalCount:Object(y.getOr)(50,"fakeTotalCount",b),id:v,inspect:k,isInspect:S,loading:m,loadPage:h,refetch:T,setQuery:o,setQuerySkip:p,showMorePagesIndicator:Object(y.getOr)(!1,"showMorePagesIndicator",b),totalCount:f,type:c})};zs.dispalyName="UncommonProcessQueryTabBody";var Hs=a(175),$s=a(394);const Vs=(e,t="default")=>`ml_${e}riskscore_pivot_transform_${t}`,Us=(e,t="default")=>`ml_${e}riskscore_latest_transform_${t}`,Qs=(e,t="default")=>`ml_${e}riskscore_ingest_pipeline_${t}`,Ws=(e,t="default")=>`ml_${e}_risk_score_${t}`,Gs=(e,t="default")=>`ml_${e}_risk_score_latest_${t}`,Ks=(e="default")=>`${r.H}-${e}`,Js=(e,t="default")=>`ml_${e}riskscore_levels_script_${t}`,Ys=(e,t="default")=>`ml_${e}riskscore_init_script_${t}`,Xs=(e,t="default")=>`ml_${e}riskscore_map_script_${t}`,Zs=(e,t="default")=>`ml_${e}riskscore_reduce_script_${t}`,er=e=>`ml_${e}riskscore_ingest_pipeline`,tr=e=>`ml_${e}riskscore_levels_script`,ar=e=>`ml_${e}riskscore_init_script`,nr=e=>`ml_${e}riskscore_map_script`,ir=e=>`ml_${e}riskscore_reduce_script`,sr=(e="default",t)=>{const a="double risk_score = (def)ctx.getByPath(params.risk_score);\nif (risk_score < 20) {\n    ctx['host']['risk']['calculated_level'] = 'Unknown'\n}\nelse if (risk_score >= 20 && risk_score < 40) {\n    ctx['host']['risk']['calculated_level'] = 'Low'\n}\nelse if (risk_score >= 40 && risk_score < 70) {\n    ctx['host']['risk']['calculated_level'] = 'Moderate'\n}\nelse if (risk_score >= 70 && risk_score < 90) {\n    ctx['host']['risk']['calculated_level'] = 'High'\n}\nelse if (risk_score >= 90) {\n    ctx['host']['risk']['calculated_level'] = 'Critical'\n}";return{id:Js(rn.v.host,e),script:{lang:"painless",source:t?JSON.stringify(a):a}}},rr=(e="default",t)=>{const a="state.rule_risk_stats = new HashMap();\nstate.host_variant_set = false;\nstate.host_variant = new String();\nstate.tactic_ids = new HashSet();";return{id:Ys(rn.v.host,e),script:{lang:"painless",source:t?JSON.stringify(a):a}}},or=(e="default",t)=>{const a='// Get the host variant\nif (state.host_variant_set == false) {\n    if (doc.containsKey("host.os.full") && doc["host.os.full"].size() != 0) {\n        state.host_variant = doc["host.os.full"].value;\n        state.host_variant_set = true;\n    }\n}\n// Aggregate all the tactics seen on the host\nif (doc.containsKey("signal.rule.threat.tactic.id") && doc["signal.rule.threat.tactic.id"].size() != 0) {\n    state.tactic_ids.add(doc["signal.rule.threat.tactic.id"].value);\n}\n// Get running sum of time-decayed risk score per rule name per shard\nString rule_name = doc["signal.rule.name"].value;\ndef stats = state.rule_risk_stats.getOrDefault(rule_name, [0.0,"",false]);\nint time_diff = (int)((System.currentTimeMillis() - doc["@timestamp"].value.toInstant().toEpochMilli()) / (1000.0 * 60.0 * 60.0));\ndouble risk_derate = Math.min(1, Math.exp((params.lookback_time - time_diff) / params.time_decay_constant));\nstats[0] = Math.max(stats[0], doc["signal.rule.risk_score"].value * risk_derate);\nif (stats[2] == false) {\n    stats[1] = doc["kibana.alert.rule.uuid"].value;\n    stats[2] = true;\n}\nstate.rule_risk_stats.put(rule_name, stats);';return{id:Xs(rn.v.host,e),script:{lang:"painless",source:t?JSON.stringify(a):a}}},lr=(e="default",t)=>{const a='// Consolidating time decayed risks and tactics from across all shards\nMap total_risk_stats = new HashMap();\nString host_variant = new String();\ndef tactic_ids = new HashSet();\nfor (state in states) {\n    for (key in state.rule_risk_stats.keySet()) {\n        def rule_stats = state.rule_risk_stats.get(key);\n        def stats = total_risk_stats.getOrDefault(key, [0.0,"",false]);\n        stats[0] = Math.max(stats[0], rule_stats[0]);\n        if (stats[2] == false) {\n            stats[1] = rule_stats[1];\n            stats[2] = true;\n        } \n        total_risk_stats.put(key, stats);\n    }\n    if (host_variant.length() == 0) {\n        host_variant = state.host_variant;\n    }\n    tactic_ids.addAll(state.tactic_ids);\n}\n// Consolidating individual rule risks and arranging them in decreasing order\nList risks = new ArrayList();\nfor (key in total_risk_stats.keySet()) {\n    risks.add(total_risk_stats[key][0])\n}\nCollections.sort(risks, Collections.reverseOrder());\n// Calculating total host risk score\ndouble total_risk = 0.0;\ndouble risk_cap = params.max_risk * params.zeta_constant;\nfor (int i=0;i<risks.length;i++) {\n    total_risk += risks[i] / Math.pow((1+i), params.p);\n}\n// Normalizing the host risk score\ndouble total_norm_risk = 100 * total_risk / risk_cap;\nif (total_norm_risk < 40) {\n    total_norm_risk =  2.125 * total_norm_risk;\n}\nelse if (total_norm_risk >= 40 && total_norm_risk < 50) {\n    total_norm_risk = 85 + (total_norm_risk - 40);\n}\nelse {\n    total_norm_risk = 95 + (total_norm_risk - 50) / 10;\n}\n// Calculating multipliers to the host risk score\ndouble risk_multiplier = 1.0;\nList multipliers = new ArrayList();\n// Add a multiplier if host is a server\nif (host_variant.toLowerCase().contains("server")) {\n    risk_multiplier *= params.server_multiplier;\n    multipliers.add("Host is a server");\n}\n// Add multipliers based on number and diversity of tactics seen on the host\nfor (String tactic : tactic_ids) {\n    multipliers.add("Tactic "+tactic);\n    risk_multiplier *= 1 + params.tactic_base_multiplier * params.tactic_weights.getOrDefault(tactic, 0);\n}\n// Calculating final risk\ndouble final_risk = total_norm_risk;\nif (risk_multiplier > 1.0) {\n    double prior_odds = (total_norm_risk) / (100 - total_norm_risk);\n    double updated_odds = prior_odds * risk_multiplier; \n    final_risk = 100 * updated_odds / (1 + updated_odds);\n}\n// Adding additional metadata\nList rule_stats = new ArrayList();\nfor (key in total_risk_stats.keySet()) {\n    Map temp = new HashMap();\n    temp["rule_name"] = key;\n    temp["rule_risk"] = total_risk_stats[key][0];\n    temp["rule_id"] = total_risk_stats[key][1];\n    rule_stats.add(temp);\n}\n\nreturn ["calculated_score_norm": final_risk, "rule_risks": rule_stats, "multipliers": multipliers];';return{id:Zs(rn.v.host,e),script:{lang:"painless",source:t?JSON.stringify(a):a}}},cr=(e="default",t)=>{const a="double risk_score = (def)ctx.getByPath(params.risk_score);\nif (risk_score < 20) {\n  ctx['user']['risk']['calculated_level'] = 'Unknown'\n}\nelse if (risk_score >= 20 && risk_score < 40) {\n  ctx['user']['risk']['calculated_level'] = 'Low'\n}\nelse if (risk_score >= 40 && risk_score < 70) {\n  ctx['user']['risk']['calculated_level'] = 'Moderate'\n}\nelse if (risk_score >= 70 && risk_score < 90) {\n  ctx['user']['risk']['calculated_level'] = 'High'\n}\nelse if (risk_score >= 90) {\n  ctx['user']['risk']['calculated_level'] = 'Critical'\n}";return{id:Js(rn.v.user,e),script:{lang:"painless",source:t?JSON.stringify(a):a}}},ur=(e="default",t)=>{const a='// Get running sum of risk score per rule name per shard\\\\\nString rule_name = doc["signal.rule.name"].value;\ndef stats = state.rule_risk_stats.getOrDefault(rule_name, 0.0);\nstats = doc["signal.rule.risk_score"].value;\nstate.rule_risk_stats.put(rule_name, stats);';return{id:Xs(rn.v.user,e),script:{lang:"painless",source:t?JSON.stringify(a):a}}},dr=(e="default",t)=>{const a='// Consolidating time decayed risks from across all shards\nMap total_risk_stats = new HashMap();\nfor (state in states) {\n    for (key in state.rule_risk_stats.keySet()) {\n    def rule_stats = state.rule_risk_stats.get(key);\n    def stats = total_risk_stats.getOrDefault(key, 0.0);\n    stats = rule_stats;\n    total_risk_stats.put(key, stats);\n    }\n}\n// Consolidating individual rule risks and arranging them in decreasing order\nList risks = new ArrayList();\nfor (key in total_risk_stats.keySet()) {\n    risks.add(total_risk_stats[key])\n}\nCollections.sort(risks, Collections.reverseOrder());\n// Calculating total risk and normalizing it to a range\ndouble total_risk = 0.0;\ndouble risk_cap = params.max_risk * params.zeta_constant;\nfor (int i=0;i<risks.length;i++) {\n    total_risk += risks[i] / Math.pow((1+i), params.p);\n}\ndouble total_norm_risk = 100 * total_risk / risk_cap;\nif (total_norm_risk < 40) {\n    total_norm_risk =  2.125 * total_norm_risk;\n}\nelse if (total_norm_risk >= 40 && total_norm_risk < 50) {\n    total_norm_risk = 85 + (total_norm_risk - 40);\n}\nelse {\n    total_norm_risk = 95 + (total_norm_risk - 50) / 10;\n}\n\nList rule_stats = new ArrayList();\nfor (key in total_risk_stats.keySet()) {\n    Map temp = new HashMap();\n    temp["rule_name"] = key;\n    temp["rule_risk"] = total_risk_stats[key];\n    rule_stats.add(temp);\n}\n\nreturn ["calculated_score_norm": total_norm_risk, "rule_risks": rule_stats];';return{id:Zs(rn.v.user,e),script:{lang:"painless",source:t?JSON.stringify(a):a}}},pr=(e,t="default",a)=>{const n=[{set:{field:"ingest_timestamp",value:"{{_ingest.timestamp}}"}},{fingerprint:{fields:["@timestamp","_id"],method:"SHA-256",target_field:"_id"}},{script:{id:Js(e,t),params:{risk_score:`${e}.risk.calculated_score_norm`}}}];return{name:Qs(e,t),processors:a?JSON.stringify(n):n}},mr=({spaceId:e="default",riskScoreEntity:t,stringifyScript:a})=>{const n={properties:{[t]:{properties:{name:{type:"keyword"},risk:{properties:{calculated_score_norm:{type:"float"},calculated_level:{type:"keyword"},multipliers:{type:"keyword"},rule_risks:{properties:{rule_name:{type:"text",fields:{keyword:{type:"keyword"}}},rule_risk:{type:"float"},rule_id:{type:"keyword"}}}}}}},ingest_timestamp:{type:"date"},"@timestamp":{type:"date"}}};return{index:Ws(t,e),mappings:a?JSON.stringify(n):n}},gr=({spaceId:e="default",riskScoreEntity:t,stringifyScript:a})=>{const n={properties:{[t]:{properties:{name:{type:"keyword"},risk:{properties:{calculated_score_norm:{type:"float"},calculated_level:{type:"keyword"},multipliers:{type:"keyword"},rule_risks:{properties:{rule_name:{type:"text",fields:{keyword:{type:"keyword"}}},rule_risk:{type:"float"},rule_id:{type:"keyword"}}}}}}},ingest_timestamp:{type:"date"},"@timestamp":{type:"date"}}};return{index:Gs(t,e),mappings:a?JSON.stringify(n):n}},fr=({spaceId:e="default",stringifyScript:t})=>{const a={dest:{index:Ws(rn.v.host,e),pipeline:Qs(rn.v.host,e)},frequency:"1h",pivot:{aggregations:{"@timestamp":{max:{field:"@timestamp"}},"host.risk":{scripted_metric:{combine_script:"return state",init_script:{id:Ys(rn.v.host,e)},map_script:{id:Xs(rn.v.host,e)},params:{lookback_time:72,max_risk:100,p:1.5,server_multiplier:1.5,tactic_base_multiplier:.25,tactic_weights:{TA0001:1,TA0002:2,TA0003:3,TA0004:4,TA0005:4,TA0006:4,TA0007:4,TA0008:5,TA0009:6,TA0010:7,TA0011:6,TA0040:8,TA0042:1,TA0043:1},time_decay_constant:6,zeta_constant:2.612},reduce_script:{id:Zs(rn.v.host,e)}}}},group_by:{[rn.w.hostName]:{terms:{field:rn.w.hostName}}}},source:{index:[Ks(e)],query:{bool:{filter:[{range:{"@timestamp":{gte:"now-5d"}}}]}}},sync:{time:{delay:"120s",field:"@timestamp"}}};return t?JSON.stringify(a):a},br=({spaceId:e="default",stringifyScript:t})=>{const a={dest:{index:Ws(rn.v.user,e),pipeline:Qs(rn.v.user,e)},frequency:"1h",pivot:{aggregations:{"@timestamp":{max:{field:"@timestamp"}},"user.risk":{scripted_metric:{combine_script:"return state",init_script:"state.rule_risk_stats = new HashMap();",map_script:{id:Xs(rn.v.user,e)},params:{max_risk:100,p:1.5,zeta_constant:2.612},reduce_script:{id:Zs(rn.v.user,e)}}}},group_by:{"user.name":{terms:{field:"user.name"}}}},source:{index:[Ks(e)],query:{bool:{filter:[{range:{"@timestamp":{gte:"now-90d"}}},{match:{"signal.status":"open"}}]}}},sync:{time:{delay:"120s",field:"@timestamp"}}};return t?JSON.stringify(a):a},hr=({spaceId:e="default",riskScoreEntity:t,stringifyScript:a})=>{const n={dest:{index:Gs(t,e)},frequency:"1h",latest:{sort:"@timestamp",unique_key:[`${t}.name`]},source:{index:[Ws(t,e)]},sync:{time:{delay:"2s",field:"ingest_timestamp"}}};return a?JSON.stringify(n):n},yr=N.i18n.translate("xpack.securitySolution.riskScore.api.ingestPipeline.create.errorMessageTitle",{defaultMessage:"Failed to create Ingest pipeline"}),Er=e=>N.i18n.translate("xpack.securitySolution.riskScore.api.ingestPipeline.delete.errorMessageTitle",{values:{totalCount:e},defaultMessage:"Failed to delete Ingest {totalCount, plural, =1 {pipeline} other {pipelines}}"}),vr=N.i18n.translate("xpack.securitySolution.riskScore.api.indices.create.errorMessageTitle",{defaultMessage:"Failed to create index"}),kr=N.i18n.translate("xpack.securitySolution.riskScore.api.storedScript.create.errorMessageTitle",{defaultMessage:"Failed to create stored script"}),Sr=N.i18n.translate("xpack.securitySolution.riskScore.api.storedScript.delete.errorMessageTitle",{defaultMessage:"Failed to delete stored script"}),Tr=N.i18n.translate("xpack.securitySolution.riskScore.api.transforms.create.errorMessageTitle",{defaultMessage:"Failed to create Transform"}),xr=e=>N.i18n.translate("xpack.securitySolution.riskScore.api.transforms.delete.errorMessageTitle",{values:{totalCount:e},defaultMessage:"Failed to delete {totalCount, plural, =1 {Transform} other {Transforms}}"}),wr=N.i18n.translate("xpack.securitySolution.riskScore.api.transforms.getState.errorMessageTitle",{defaultMessage:"Failed to get Transform state"}),Or=N.i18n.translate("xpack.securitySolution.riskScore.api.transforms.getState.notFoundMessageTitle",{defaultMessage:"Transform not found"}),jr=e=>N.i18n.translate("xpack.securitySolution.riskScore.api.transforms.start.errorMessageTitle",{values:{totalCount:e},defaultMessage:"Failed to start {totalCount, plural, =1 {Transform} other {Transforms}}"}),Ir=e=>N.i18n.translate("xpack.securitySolution.riskScore.api.transforms.stop.errorMessageTitle",{values:{totalCount:e},defaultMessage:"Failed to stop {totalCount, plural, =1 {Transform} other {Transforms}}"}),Cr=N.i18n.translate("xpack.securitySolution.riskScore.install.errorMessageTitle",{defaultMessage:"Installation error"}),Mr=N.i18n.translate("xpack.securitySolution.riskScore.uninstall.errorMessageTitle",{defaultMessage:"Uninstallation error"}),Dr=N.i18n.translate("xpack.securitySolution.riskScore.savedObjects.bulkCreateFailureTitle",{defaultMessage:"Failed to import saved objects"}),Ar=N.i18n.translate("xpack.securitySolution.riskScore.savedObjects.bulkDeleteFailureTitle",{defaultMessage:"Failed to delete saved objects"});async function Fr({errorMessage:e,http:t,notifications:a,options:n,renderDocLink:i,signal:s,theme:o}){return await t.put(r.gc,{body:JSON.stringify(n),signal:s}).catch((t=>{var n,s,r,l;null==a||null===(n=a.toasts)||void 0===n||n.addDanger({title:null!=e?e:vr,text:Object(_.toMountPoint)(i&&null!=(null==t||null===(s=t.body)||void 0===s?void 0:s.message)?i(null==t||null===(r=t.body)||void 0===r?void 0:r.message):null==t||null===(l=t.body)||void 0===l?void 0:l.message,{theme$:null==o?void 0:o.theme$})})}))}async function Rr({errorMessage:e,http:t,notifications:a,options:n,renderDocLink:i,signal:s,theme:r}){return await t.post("/api/ingest_pipelines",{body:JSON.stringify(n),signal:s}).catch((t=>{var n,s,o;null==a||null===(n=a.toasts)||void 0===n||n.addDanger({title:null!=e?e:yr,text:Object(_.toMountPoint)(i?i(null==t||null===(s=t.body)||void 0===s?void 0:s.message):null==t||null===(o=t.body)||void 0===o?void 0:o.message,{theme$:null==r?void 0:r.theme$})})}))}const Pr=6e5,_r=({messageBody:e,renderDocLink:t})=>t?t(e):e;async function qr({errorMessage:e,http:t,notifications:a,options:n,renderDocLink:i,signal:s,transformId:r}){return await t.put(`/api/transform/transforms/${r}`,{body:JSON.stringify(n),signal:s}).then((t=>{const{errors:n}=t,s=null!=e?e:Tr;if(n&&n.length>0){var r;const e=null==n?void 0:n.map((({id:e,error:t})=>{var a,n,i,s;return null!=t&&null!==(a=t.output)&&void 0!==a&&null!==(n=a.payload)&&void 0!==n&&n.cause?`${e}: ${null==t||null===(i=t.output)||void 0===i||null===(s=i.payload)||void 0===s?void 0:s.cause}`:e}),[]);null==a||null===(r=a.toasts)||void 0===r||r.addError(new Error(s),{title:s,toastMessage:_r({messageBody:e.join(", "),renderDocLink:i}),toastLifeTimeMs:Pr})}return t})).catch((t=>{var n,s;null==a||null===(n=a.toasts)||void 0===n||n.addError(t,{title:null!=e?e:Tr,toastMessage:_r({messageBody:null==t||null===(s=t.body)||void 0===s?void 0:s.message,renderDocLink:i}),toastLifeTimeMs:Pr})}))}async function Nr({http:e,notifications:t,renderDocLink:a,signal:n,errorMessage:i,transformIds:s}){return await e.post("/api/transform/start_transforms",{body:JSON.stringify(s.map((e=>({id:e})))),signal:n}).then((e=>{const n=Object.entries(e).reduce(((e,[t,a])=>{var n,i;return a.success?e:[...e,null!=a&&null!==(n=a.error)&&void 0!==n&&n.reason?`${t}: ${null==a||null===(i=a.error)||void 0===i?void 0:i.reason}`:t]}),[]),s=null!=i?i:jr(n.length);var r;return n.length>0&&(null==t||null===(r=t.toasts)||void 0===r||r.addError(new Error(s),{title:s,toastMessage:_r({messageBody:n.join(", "),renderDocLink:a}),toastLifeTimeMs:Pr})),e})).catch((e=>{var n,r;null==t||null===(n=t.toasts)||void 0===n||n.addError(e,{title:null!=i?i:jr(s.length),toastMessage:_r({messageBody:null==e||null===(r=e.body)||void 0===r?void 0:r.message,renderDocLink:a}),toastLifeTimeMs:Pr})}))}async function Lr({http:e,notifications:t,signal:a,errorMessage:n,transformIds:i,renderDocLink:s}){const r=await async function({http:e,notifications:t,signal:a,errorMessage:n,transformIds:i}){const s=await Promise.all(i.map((i=>{const s=async function({http:e,notifications:t,renderDocLink:a,signal:n,errorMessage:i=wr,transformId:s}){return await e.get(`/api/transform/transforms/${s}/_stats`,{signal:n}).then((e=>{var n;return 0===e.count&&(null==t||null===(n=t.toasts)||void 0===n||n.addError(new Error(i),{title:i,toastMessage:_r({messageBody:`${Or}: ${s}`,renderDocLink:a}),toastLifeTimeMs:Pr})),e})).catch((e=>{var n,s;null==t||null===(n=t.toasts)||void 0===n||n.addError(e,{title:i,toastMessage:_r({messageBody:null==e||null===(s=e.body)||void 0===s?void 0:s.message,renderDocLink:a}),toastLifeTimeMs:Pr})}))}({http:e,notifications:t,signal:a,errorMessage:n,transformId:i});return s})));return s}({http:e,signal:a,transformIds:i});return await e.post("/api/transform/stop_transforms",{body:JSON.stringify(r.reduce(((e,t)=>null!=t&&t.transforms.length>0?[...e,{id:t.transforms[0].id,state:t.transforms[0].state}]:e),[])),signal:a}).then((e=>{const a=Object.entries(e).reduce(((e,[t,a])=>{var n,i;return a.success?e:[...e,null!=a&&null!==(n=a.error)&&void 0!==n&&n.reason?`${t}: ${null==a||null===(i=a.error)||void 0===i?void 0:i.reason}`:t]}),[]),i=null!=n?n:Ir(a.length);var r;return a.length>0&&(null==t||null===(r=t.toasts)||void 0===r||r.addError(new Error(i),{title:i,toastMessage:_r({messageBody:a.join(", "),renderDocLink:s}),toastLifeTimeMs:Pr})),e})).catch((e=>{var a,r;null==t||null===(a=t.toasts)||void 0===a||a.addError(e,{title:null!=n?n:Ir(i.length),toastMessage:_r({messageBody:null==e||null===(r=e.body)||void 0===r?void 0:r.message,renderDocLink:s}),toastLifeTimeMs:Pr})}))}async function Br({errorMessage:e,http:t,notifications:a,options:n,renderDocLink:i,signal:s,theme:o}){return await t.put(r.hc,{body:JSON.stringify(n),signal:s}).catch((t=>{var n,s,r;null==a||null===(n=a.toasts)||void 0===n||n.addDanger({title:null!=e?e:kr,text:Object(_.toMountPoint)(i?i(null==t||null===(s=t.body)||void 0===s?void 0:s.message):null==t||null===(r=t.body)||void 0===r?void 0:r.message,{theme$:null==o?void 0:o.theme$})})}))}const zr="Current Risk Score for Hosts",Hr=6e5,$r=async({dashboard:e,to:t,errorMessage:a,http:n,notifications:i,options:s,renderDashboardLink:o,renderDocLink:l,from:c,theme:u})=>await n.post(Object(r.Hc)(s.templateName)).then((n=>{const r=n.saved_objects.reduce(((e,t)=>null!=t.error?[...e,`${t.id}: ${t.error.message}`]:e),[]);if(r.length>0){var d;null==i||null===(d=i.toasts)||void 0===d||d.addError(new Error(null!=a?a:Dr),{title:null!=a?a:Dr,toastMessage:l?l(r.join(", ")):r.join(", "),toastLifeTimeMs:Hr})}else{var p;const a=s.templateName===`${rn.v.user}RiskScoreDashboards`?"Current Risk Score for Users":zr,r=n.saved_objects.find((e=>{var t;return"dashboard"===e.type&&(null==e||null===(t=e.attributes)||void 0===t?void 0:t.title)===a}));let l;var m;null!=r&&r.id&&(l=null==e||null===(m=e.locator)||void 0===m?void 0:m.getRedirectUrl({dashboardId:null==r?void 0:r.id,timeRange:{to:t,from:c}}));const d=n.saved_objects.map((e=>{var t,a,n;return null!==(t=null==e||null===(a=e.attributes)||void 0===a?void 0:a.title)&&void 0!==t?t:null==e||null===(n=e.attributes)||void 0===n?void 0:n.name})).join(", ");null==i||null===(p=i.toasts)||void 0===p||p.addSuccess({title:(g=n.saved_objects.length,N.i18n.translate("xpack.securitySolution.riskScore.savedObjects.bulkCreateSuccessTitle",{values:{totalCount:g},defaultMessage:"{totalCount} {totalCount, plural, =1 {saved object} other {saved objects}} imported successfully"})),text:Object(_.toMountPoint)(o&&l?o(d,l):d,{theme$:null==u?void 0:u.theme$})})}var g})).catch((e=>{var t,n,s;null==i||null===(t=i.toasts)||void 0===t||t.addError(new Error(null!=a?a:Dr),{title:null!=a?a:Dr,toastMessage:l?l(null==e||null===(n=e.body)||void 0===n?void 0:n.message):null==e||null===(s=e.body)||void 0===s?void 0:s.message,toastLifeTimeMs:Hr})})),Vr=async e=>{e.riskScoreEntity===rn.v.user?await(async({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:s,spaceId:r="default",theme:o,timerange:l})=>{await Br({http:t,theme:o,renderDocLink:s,notifications:a,options:cr(r)}),await Br({http:t,theme:o,renderDocLink:s,notifications:a,options:ur(r)}),await Br({http:t,theme:o,renderDocLink:s,notifications:a,options:dr(r)}),await Rr({http:t,theme:o,renderDocLink:s,notifications:a,options:pr(rn.v.user,r)}),await Fr({http:t,theme:o,renderDocLink:s,notifications:a,options:mr({spaceId:r,riskScoreEntity:rn.v.user})}),await qr({http:t,theme:o,renderDocLink:s,notifications:a,errorMessage:`${Cr} - ${Tr}`,transformId:Vs(rn.v.user,r),options:br({spaceId:r})}),await Fr({http:t,theme:o,renderDocLink:s,notifications:a,options:gr({spaceId:r,riskScoreEntity:rn.v.user})}),await qr({http:t,theme:o,renderDocLink:s,notifications:a,errorMessage:`${Cr} - ${Tr}`,transformId:Us(rn.v.user,r),options:hr({spaceId:r,riskScoreEntity:rn.v.user})});const c=[Vs(rn.v.user,r),Us(rn.v.user,r)];await Nr({errorMessage:`${Cr} - ${jr(c.length)}`,http:t,notifications:a,renderDocLink:s,theme:o,transformIds:c}),await Gr({http:t,notifications:a,refetch:n,renderDocLink:s,riskScoreEntity:rn.v.user,spaceId:r,theme:o}),await $r({dashboard:e,http:t,notifications:a,options:{templateName:`${rn.v.user}RiskScoreDashboards`},renderDashboardLink:i,renderDocLink:s,...l,theme:o}),n&&n()})(e):await(async({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:s,spaceId:r="default",theme:o,timerange:l})=>{await Br({http:t,theme:o,renderDocLink:s,notifications:a,options:sr(r)}),await Br({http:t,theme:o,renderDocLink:s,notifications:a,options:rr(r)}),await Br({http:t,theme:o,renderDocLink:s,notifications:a,options:or(r)}),await Br({http:t,theme:o,renderDocLink:s,notifications:a,options:lr(r)}),await Rr({http:t,theme:o,renderDocLink:s,notifications:a,options:pr(rn.v.host,r)}),await Fr({http:t,theme:o,renderDocLink:s,notifications:a,options:mr({spaceId:r,riskScoreEntity:rn.v.host})}),await qr({http:t,theme:o,renderDocLink:s,notifications:a,errorMessage:`${Cr} - ${Tr}`,transformId:Vs(rn.v.host,r),options:fr({spaceId:r})}),await Fr({http:t,theme:o,renderDocLink:s,notifications:a,options:gr({spaceId:r,riskScoreEntity:rn.v.host})}),await qr({http:t,theme:o,renderDocLink:s,notifications:a,errorMessage:`${Cr} - ${Tr}`,transformId:Us(rn.v.host,r),options:hr({spaceId:r,riskScoreEntity:rn.v.host})});const c=[Vs(rn.v.host,r),Us(rn.v.host,r)];await Nr({http:t,theme:o,renderDocLink:s,notifications:a,errorMessage:`${Cr} - ${jr(c.length)}`,transformIds:c}),await Gr({http:t,notifications:a,refetch:n,renderDocLink:s,riskScoreEntity:rn.v.host,spaceId:r,theme:o}),await $r({http:t,theme:o,dashboard:e,renderDashboardLink:i,renderDocLink:s,...l,notifications:a,options:{templateName:`${rn.v.host}RiskScoreDashboards`}}),n&&n()})(e)},Ur=async({http:e,notifications:t,refetch:a,renderDocLink:n,riskScoreEntity:i,spaceId:s="default",theme:o})=>{const l=[Vs(i,s),Us(i,s)],c=[tr(rn.v.host),ar(rn.v.host),nr(rn.v.host),ir(rn.v.host)],u=[tr(rn.v.user),nr(rn.v.user),ir(rn.v.user)],d=[er(i)];await(async({http:e,notifications:t,errorMessage:a,options:n})=>await e.post(Object(r.Ic)(n.templateName)).catch((e=>{var n,i;null==t||null===(n=t.toasts)||void 0===n||n.addDanger({title:null!=a?a:Ar,text:null==e||null===(i=e.body)||void 0===i?void 0:i.message})})))({http:e,options:{templateName:`${i}RiskScoreDashboards`}}),await async function({http:e,notifications:t,signal:a,errorMessage:n,transformIds:i,options:s,renderDocLink:r}){return await Lr({http:e,signal:a,transformIds:i}),await e.post("/api/transform/delete_transforms",{body:JSON.stringify({transformsInfo:i.map((e=>({id:e,state:"stopped"}))),...s||{}}),signal:a}).then((e=>{const a=Object.entries(e).reduce(((e,[t,a])=>{var n,i,s,r;return a.transformDeleted.success?e:[...e,null!=a&&null!==(n=a.transformDeleted)&&void 0!==n&&null!==(i=n.error)&&void 0!==i&&i.reason?`${t}: ${null==a||null===(s=a.transformDeleted)||void 0===s||null===(r=s.error)||void 0===r?void 0:r.reason}`:t]}),[]),i=null!=n?n:xr(a.length);var s;return a.length>0&&(null==t||null===(s=t.toasts)||void 0===s||s.addError(new Error(i),{title:i,toastMessage:_r({messageBody:a.join(", "),renderDocLink:r}),toastLifeTimeMs:Pr})),e})).catch((e=>{var a,s;null==t||null===(a=t.toasts)||void 0===a||a.addError(e,{title:null!=n?n:xr(i.length),toastMessage:_r({messageBody:null==e||null===(s=e.body)||void 0===s?void 0:s.message,renderDocLink:r}),toastLifeTimeMs:Pr})}))}({http:e,theme:o,renderDocLink:n,notifications:t,errorMessage:`${Mr} - ${xr(l.length)}`,transformIds:l,options:{deleteDestIndex:!0,deleteDestDataView:!0,forceDelete:!1}}),await async function({errorMessage:e,http:t,names:a,notifications:n,renderDocLink:i,signal:s,theme:r}){const o=a.split(",").length;return await t.delete(`/api/ingest_pipelines/${a}`,{signal:s}).catch((t=>{var a,s,l;null==n||null===(a=n.toasts)||void 0===a||a.addDanger({title:null!=e?e:Er(o),text:Object(_.toMountPoint)(i?i(null==t||null===(s=t.body)||void 0===s?void 0:s.message):null==t||null===(l=t.body)||void 0===l?void 0:l.message,{theme$:null==r?void 0:r.theme$})})}))}({http:e,errorMessage:`${Mr} - ${Er(d.length)}`,names:d.join(",")}),await async function({http:e,notifications:t,signal:a,errorMessage:n,ids:i}){const s=await Promise.all(i.map((i=>async function({errorMessage:e,http:t,notifications:a,options:n,renderDocLink:i,signal:s,theme:o}){return await t.delete(r.jc,{body:JSON.stringify(n),signal:s}).catch((t=>{var n,s,r;null==a||null===(n=a.toasts)||void 0===n||n.addDanger({title:null!=e?e:Sr,text:Object(_.toMountPoint)(i?i(null==t||null===(s=t.body)||void 0===s?void 0:s.message):null==t||null===(r=t.body)||void 0===r?void 0:r.message,{theme$:null==o?void 0:o.theme$})})}))}({http:e,notifications:t,signal:a,errorMessage:n,options:{id:i}}))));return s}({http:e,ids:i===rn.v.user?u:c}),a&&a()},Qr=async({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:s,spaceId:r="default",theme:o,timerange:l})=>{await Ur({http:t,notifications:a,renderDocLink:s,riskScoreEntity:rn.v.host,spaceId:r,theme:o}),await Vr({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:s,riskScoreEntity:rn.v.host,spaceId:r,theme:o,timerange:l})},Wr=async({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:s,spaceId:r="default",theme:o,timerange:l})=>{await Ur({http:t,notifications:a,renderDocLink:s,riskScoreEntity:rn.v.user,spaceId:r,theme:o}),await Vr({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:s,riskScoreEntity:rn.v.user,spaceId:r,theme:o,timerange:l})},Gr=async({http:e,notifications:t,refetch:a,renderDocLink:n,riskScoreEntity:i,spaceId:s,theme:r})=>{const o=[Vs(i,s),Us(i,s)];await Lr({http:e,notifications:t,renderDocLink:n,theme:r,transformIds:o});const l=await Nr({http:e,notifications:t,renderDocLink:n,theme:r,transformIds:o});return a&&a(),l};var Kr=a(374);const Jr=H()(B.EuiButton).withConfig({displayName:"StyledButton",componentId:"sc-1vo8mdz-0"})(["float:right;"]),Yr=e=>{const t=Object(n.useCallback)((t=>i.a.createElement(i.a.Fragment,null,t," ",i.a.createElement(Kr.a,{riskScoreEntity:e}))),[e]),a=Object(n.useCallback)(((e,t)=>i.a.createElement(i.a.Fragment,null,e,i.a.createElement(B.EuiSpacer,{size:"s"}),i.a.createElement(Jr,{href:t,target:"_blank"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.risk_score.toast.viewDashboard",defaultMessage:"View dashboard"})))),[]);return Object(n.useMemo)((()=>({renderDocLink:t,renderDashboardLink:a})),[a,t])};var Xr=a(501);const Zr=({disabled:e,refetch:t,riskScoreEntity:a,timerange:s,title:r})=>{const o=Object($s.a)(),{http:l,notifications:c,theme:d,dashboard:p}=Object(u.k)().services,{renderDocLink:m,renderDashboardLink:g}=Yr(a),{fetch:f,isLoading:b}=Object(Xr.b)(Xr.a.UPGRADE_RISK_SCORE,a===rn.v.user?Wr:Qr),[h,y]=Object(n.useState)(!1),E=Object(n.useCallback)((()=>y(!1)),[]),v=Object(n.useCallback)((()=>y(!0)),[]),k=Object(n.useCallback)((async()=>{E(),f({http:l,notifications:c,spaceId:o,timerange:s,refetch:t,renderDashboardLink:g,renderDocLink:m,riskScoreEntity:a,theme:d,dashboard:p})}),[E,f,l,c,o,s,t,g,m,a,d,p]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiButton,{color:"primary","data-test-subj":`${a}-risk-score-upgrade`,disabled:e,fill:!0,isLoading:b,onClick:v},r),h&&i.a.createElement(B.EuiConfirmModal,{"data-test-subj":`${a}-risk-score-upgrade-confirmation-modal`,title:r,onCancel:E,onConfirm:k,cancelButtonText:i.a.createElement(Kr.a,{riskScoreEntity:a,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.riskScore.upgradeConfirmation.cancel",defaultMessage:"Preserve data"})}),confirmButtonText:i.a.createElement(Hs.FormattedMessage,{"data-test-subj":`${a}-risk-score-upgrade-confirmation-button`,id:"xpack.securitySolution.riskScore.upgradeConfirmation.confirm",defaultMessage:"Erase data and Upgrade"}),buttonColor:"danger",defaultFocusedButton:"confirm"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.riskScore.upgradeConfirmation.content",defaultMessage:"The upgrade will delete existing risk scores from your environment. You may preserve existing risk data before upgrading the Risk Score package. Do you wish to upgrade?"})))},eo=i.a.memo(Zr);eo.displayName="RiskScoreUpgradeButton";var to=a(93),ao=a(367),no=a(542);const io=()=>{const[e,t]=Object(n.useState)(!0),[a,i]=Object(n.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null}),{addError:s}=Object(ma.a)(),{hasIndexRead:r}=Object(na.a)();return Object(n.useEffect)((()=>{let e=!0;const a=new AbortController;return r?(async()=>{try{t(!0);const n=await Object(ao.a)({signal:a.signal});e&&null!=n&&i({signalIndexExists:null==n?void 0:n.indexExists,signalIndexName:n.name,signalIndexMappingOutdated:n.index_mapping_outdated})}catch(t){e&&(i({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null}),Object(to.t)(t)&&404!==t.body.status_code&&s(t,{title:no.c}))}e&&t(!1)})():t(!1),()=>{e=!1,a.abort()}}),[s,r]),{loading:e,...a}},so=N.i18n.translate("xpack.securitySolution.riskDeprecated.hosts.upgradeHostRiskScore",{defaultMessage:"Upgrade Host Risk Score"}),ro=N.i18n.translate("xpack.securitySolution.riskDeprecated.users.upgradeUserRiskScore",{defaultMessage:"Upgrade User Risk Score"}),oo=N.i18n.translate("xpack.securitySolution.riskDeprecated.entity.upgradeHostRiskScoreDescription",{defaultMessage:"Current data is no longer supported. Please migrate your data and upgrade the module. The data might need an hour to be generated after enabling the module."}),lo=N.i18n.translate("xpack.securitySolution.riskDeprecated.entity.enableRiskScorePopoverTitle",{defaultMessage:"Alerts need to be available before upgrading module."});var co=a(517),uo=a(338);const po=({entityType:e,refetch:t,timerange:a})=>{const{signalIndexExists:s}=io(),r=Object(n.useMemo)((()=>({body:oo,signal:s?null:lo,...e===rn.v.host?{cta:so}:{cta:ro}})),[e,s]);return i.a.createElement(B.EuiPanel,{hasBorder:!0},i.a.createElement(Tt.a,{title:i.a.createElement(uo.a,{riskScoreEntity:e}),titleSize:"s",tooltip:e===rn.v.user?co.d:co.a}),i.a.createElement(B.EuiEmptyPrompt,{title:i.a.createElement("h2",null,r.cta),body:r.body,actions:i.a.createElement(B.EuiToolTip,{content:r.signal},i.a.createElement(eo,{refetch:t,riskScoreEntity:e,disabled:!s,timerange:a,"data-test-subj":`upgrade_${e}_risk_score`,title:r.cta}))}))};var mo=a(465);N.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.informationAriaLabel",{defaultMessage:"Information"});const go=N.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.classificationHeader",{defaultMessage:"Classification"}),fo=N.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.riskHeader",{defaultMessage:"Host risk score range"}),bo=N.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.unknownRiskDescription",{defaultMessage:"Less than 20"}),ho=N.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.criticalRiskDescription",{defaultMessage:"90 and above"}),yo=N.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.title",{defaultMessage:"How is host risk calculated?"}),Eo=N.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.introduction",{defaultMessage:"The Host Risk Score capability surfaces risky hosts from within your environment."}),vo=N.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.explanation",{defaultMessage:'This feature utilizes a transform, with a scripted metric aggregation to calculate host risk scores based on detection rule alerts with an "open" status, within a 5 day time window. The transform runs hourly to keep the score updated as new detection rule alerts stream in.'}),ko=N.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.closeBtn",{defaultMessage:"Close"}),So=N.i18n.translate("xpack.securitySolution.hosts.hostRiskInformation.buttonLabel",{defaultMessage:"How is risk score calculated?"}),To=()=>{const[e,t]=Object(n.useState)(!1),a=Object(n.useCallback)((()=>{t(!1)}),[]);return[e,Object(n.useCallback)((()=>{t(!0)}),[]),a]},xo=[{field:"classification",name:go,render:e=>{if(null!=e)return i.a.createElement(ps.b,{severity:e,hideBackgroundColor:!0})}},{field:"range",name:fo}],wo=[{classification:rn.x.critical,range:ho},{classification:rn.x.high,range:"70 - 90 "},{classification:rn.x.moderate,range:"40 - 70"},{classification:rn.x.low,range:"20 - 40"},{classification:rn.x.unknown,range:bo}],Oo=()=>{const[e,t,a]=To();return i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiButtonEmpty,{onClick:t,"data-test-subj":"open-risk-information-flyout-trigger"},So),e&&i.a.createElement(jo,{handleOnClose:a}))},jo=({handleOnClose:e})=>{const t=Object(B.useGeneratedHtmlId)({prefix:"HostRiskInformation"});return i.a.createElement(B.EuiFlyout,{ownFocus:!0,onClose:e,"aria-labelledby":t,size:450,"data-test-subj":"open-risk-information-flyout"},i.a.createElement(B.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(B.EuiTitle,{size:"m"},i.a.createElement("h2",{id:t},yo))),i.a.createElement(B.EuiFlyoutBody,null,i.a.createElement(B.EuiText,{size:"s"},i.a.createElement("p",null,Eo),i.a.createElement("p",null,vo)),i.a.createElement(B.EuiSpacer,null),i.a.createElement(B.EuiBasicTable,{columns:xo,items:wo,"data-test-subj":"risk-information-table"}),i.a.createElement(B.EuiSpacer,{size:"l"}),i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.hosts.hostRiskInformation.learnMore",defaultMessage:"You can learn more about host risk {HostRiskScoreDocumentationLink}",values:{HostRiskScoreDocumentationLink:i.a.createElement(Kr.a,{riskScoreEntity:rn.v.host,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.hosts.hostRiskInformation.link",defaultMessage:"here"})})}})),i.a.createElement(B.EuiFlyoutFooter,null,i.a.createElement(B.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{onClick:e},ko)))))};var Io=a(342),Co=a(178),Mo=a(320);const Do=N.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskyThresholdHeader",{defaultMessage:"Risky threshold"}),Ao=N.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskyLabel",{defaultMessage:"Risky"}),Fo=N.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskScore",{defaultMessage:"Risk score"}),Ro=H()(B.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-qe1azf-0"})(["font-size:9px;font-weight:",";margin-right:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiSizeXS)),Po=H()(B.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-qe1azf-1"})(["display:block;text-align:center;"]),_o=e=>Math.round(e).toString(),qo=({from:e,to:t,riskScore:a,loading:s,queryId:r,title:o,toggleStatus:l,toggleQuery:c})=>{const d=Object(u.n)(),p=Object(n.useMemo)((()=>Object(Mo.a)([e,t])),[e,t]),m=Object(n.useCallback)((e=>i.a.createElement(Ba.c,{value:e.value})),[]),g=Object(Ge.h)(),f=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.map((e=>({x:e["@timestamp"],y:(Object(rn.F)(e)?e.user:e.host).risk.calculated_score_norm}))).reverse())&&void 0!==e?e:[]}),[a]);return i.a.createElement(De.c,null,i.a.createElement(B.EuiPanel,{hasBorder:!0,"data-test-subj":"RiskScoreOverTime"},i.a.createElement(B.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(Tt.a,{title:o,hideSubtitle:!0,toggleQuery:c,toggleStatus:l})),l&&i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(De.b,{queryId:r,title:o}))),l&&i.a.createElement(B.EuiFlexGroup,{gutterSize:"none",direction:"column"},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement("div",{style:{height:250}},s?i.a.createElement(Po,{size:"l","data-test-subj":"RiskScoreOverTime-loading"}):i.a.createElement(We.Chart,null,i.a.createElement(We.Settings,yn()({},Ge.d,{theme:g,tooltip:{headerFormatter:m}})),i.a.createElement(We.Axis,{id:"bottom",position:We.Position.Bottom,tickFormat:p,showGridLines:!0,gridLine:{strokeWidth:1,opacity:1,dash:[3,5]}}),i.a.createElement(We.Axis,{domain:{min:0,max:100},id:"left",position:We.Position.Left,ticks:3,style:{tickLine:{visible:!1},tickLabel:{padding:10}}}),i.a.createElement(We.LineSeries,{id:"RiskOverTime",name:Fo,xScaleType:We.ScaleType.Time,yScaleType:We.ScaleType.Linear,xAccessor:"x",yAccessors:["y"],timeZone:d,data:f,tickFormat:_o}),i.a.createElement(We.LineAnnotation,{id:"RiskOverTime_annotation",domainType:We.AnnotationDomainType.YDomain,dataValues:[{dataValue:70,details:"70",header:Do}],markerPosition:"left",style:{line:{strokeWidth:1,stroke:Co.euiThemeVars.euiColorDanger,opacity:1}},marker:i.a.createElement(Ro,{color:Co.euiThemeVars.euiColorDarkestShade},Ao)})))))))};qo.displayName="RiskScoreOverTimeComponent";const No=i.a.memo(qo);No.displayName="RiskScoreOverTime";const Lo=N.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.title",{defaultMessage:"Top risk score contributors"}),Bo=N.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.rankColumnTitle",{defaultMessage:"Rank"}),zo=N.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.ruleNameColumnTitle",{defaultMessage:"Rule name"});var Ho=a(26),$o=a.n(Ho),Vo=a(684),Uo=a(689),Qo=a(522);const Wo=H()(B.EuiFlexGroup).withConfig({displayName:"IntegrationsPopoverWrapper",componentId:"sc-1rv38wr-0"})(["width:100%;"]),Go=H()(B.EuiPopoverTitle).withConfig({displayName:"PopoverTitleWrapper",componentId:"sc-1rv38wr-1"})(["max-width:390px;"]),Ko=H()("div").withConfig({displayName:"PopoverContentWrapper",componentId:"sc-1rv38wr-2"})(["max-height:400px;max-width:390px;overflow:auto;line-height:",";"],(({theme:e})=>e.eui.euiLineHeight)),Jo=H()("li").withConfig({displayName:"IntegrationListItem",componentId:"sc-1rv38wr-3"})(["list-style-type:disc;margin-left:25px;margin-bottom:5px;"]),Yo=({relatedIntegrations:e})=>{const[t,a]=Object(n.useState)(!1),{integrations:s,isLoaded:r}=Object(Uo.a)(e),o=Object(n.useMemo)((()=>s.filter((e=>e.installationStatus.isKnown&&e.installationStatus.isEnabled))),[s]),l=s.length,c=o.length,u=Object(n.useMemo)((()=>r?`${c}/${l} ${Qo.a}`:`${l} ${Qo.a}`),[r,l,c]);return i.a.createElement(Wo,{alignItems:"center",gutterSize:"s","data-test-subj":"IntegrationsWrapper"},i.a.createElement(B.EuiPopover,{ownFocus:!0,"data-test-subj":"IntegrationsDisplayPopover",button:i.a.createElement(B.EuiBadge,{iconType:"package",color:"hollow","data-test-subj":"IntegrationsDisplayPopoverButton",onClick:()=>a(!t),onClickAriaLabel:u},u),isOpen:t,closePopover:()=>a(!t),repositionOnScroll:!0},i.a.createElement(Go,{"data-test-subj":"IntegrationsPopoverTitle"},Qo.h(l)),i.a.createElement(Ko,{"data-test-subj":"IntegrationsPopoverContentWrapper"},i.a.createElement(B.EuiText,{size:"s"},Qo.g(l)),i.a.createElement(B.EuiSpacer,{size:"s"}),i.a.createElement("ul",null,s.map(((e,t)=>i.a.createElement(Jo,{key:`${e.packageName}-${t}`},i.a.createElement(Vo.a,{integration:e}))))))))},Xo=i.a.memo(Yo);Xo.displayName="IntegrationsPopover";const Zo=Xo;var el=a(263),tl=a(664),al=a(563),nl=a(378),il=a(215),sl=a(666),rl=a(667);const ol=()=>{const{services:{application:{capabilities:{actions:e}}}}=Object(u.k)();return!Object(pa.d)(e.show)||e.show};var ll=a(376),cl=a(351);const ul=()=>{const e=Object(dn.a)();return Object(cl.a)(e)&&Object(ll.a)(e)};var dl=a(269),pl=a(492),ml=a(267);const gl=({toasts:e,navigateToApp:t,invalidateRules:a,invalidatePrePackagedRulesStatus:n,actionsPrivileges:s,setLoadingRules:r,startTransaction:o})=>[{type:"icon","data-test-subj":"editRuleAction",description:il.Bb,name:s?il.Bb:i.a.createElement(B.EuiToolTip,{position:"left",content:il.Ob},i.a.createElement(i.a.Fragment,null,il.Bb)),icon:"controlsHorizontal",onClick:e=>Object(pl.d)(e.id,t),enabled:e=>Object(pa.a)(e,s)},{type:"icon","data-test-subj":"duplicateRuleAction",description:il.zb,icon:"copy",name:s?il.zb:i.a.createElement(B.EuiToolTip,{position:"left",content:il.Ob},i.a.createElement(i.a.Fragment,null,il.zb)),enabled:e=>Object(pa.a)(e,s),onClick:async i=>{o({name:ml.e.DUPLICATE});const s=await Object(pl.c)({action:dl.a.duplicate,setLoadingRules:r,visibleRuleIds:[i.id],toasts:e,search:{ids:[i.id]}});a(),n();const l=null==s?void 0:s.attributes.results.created;null!=l&&l.length&&Object(pl.d)(l[0].id,t)}},{type:"icon","data-test-subj":"exportRuleAction",description:il.Hb,icon:"exportAction",name:il.Hb,onClick:async t=>{o({name:ml.e.EXPORT}),await Object(pl.a)({action:dl.a.export,setLoadingRules:r,visibleRuleIds:[t.id],toasts:e,search:{ids:[t.id]}})},enabled:e=>!e.immutable},{type:"icon","data-test-subj":"deleteRuleAction",description:il.yb,icon:"trash",name:il.yb,onClick:async t=>{o({name:ml.e.DELETE}),await Object(pl.c)({action:dl.a.delete,setLoadingRules:r,visibleRuleIds:[t.id],toasts:e,search:{ids:[t.id]}}),a(),n()}}];var fl=a(528),bl=a(258),hl=a(308),yl=a(412),El=a(601);const vl=({hasCRUDPermissions:e})=>{const t=ul(),a=ol(),{loadingRulesAction:s,loadingRuleIds:r}=Object(nl.b)().state,o=Object(n.useMemo)((()=>["disable","enable","edit"].includes(null!=s?s:"")?r:[]),[r,s]);return Object(n.useMemo)((()=>({field:"enabled",name:il.ab,render:(n,s)=>i.a.createElement(B.EuiToolTip,{position:"top",content:Object(pa.b)(s,t,a,e)},i.a.createElement(tl.a,{id:s.id,enabled:s.enabled,isDisabled:!Object(pa.a)(s,a)||!e||Object(el.d)(s.type)&&!t,isLoading:o.includes(s.id)})),width:"95px",sortable:!0})),[a,t,e,o])},kl=({name:e,id:t})=>i.a.createElement(B.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(ue.k,{"data-test-subj":"ruleName",deepLinkId:r.uc.rules,path:Object(W.c)(t,El.b.alerts)},e)),Sl=()=>Object(n.useMemo)((()=>({field:"name",name:il.lb,render:(e,t)=>i.a.createElement(kl,{id:t.id,name:e}),sortable:!0,truncateText:!0,width:"38%"})),[]),Tl={field:"tags",name:null,align:"center",render:e=>0===e.length?null:i.a.createElement(La.a,{items:e,popoverTitle:il.nb,popoverButtonTitle:e.length.toString(),popoverButtonIcon:"tag",dataTestPrefix:"tags",renderItem:(e,t)=>i.a.createElement(B.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"tag"},e)}),width:"65px",truncateText:!0},xl={field:"related_integrations",name:null,align:"center",render:e=>null==e||0===e.length?null:i.a.createElement(Zo,{relatedIntegrations:e}),width:"143px",truncateText:!0},wl=()=>{const{navigateToApp:e}=Object(u.k)().services.application,t=ol(),a=Object(ma.a)(),{setLoadingRules:i}=Object(nl.b)().actions,{startTransaction:s}=Object(bl.a)(),r=Object(hl.b)(),o=Object(yl.a)();return Object(n.useMemo)((()=>({actions:gl({toasts:a,navigateToApp:e,invalidateRules:r,invalidatePrePackagedRulesStatus:o,actionsPrivileges:t,setLoadingRules:i,startTransaction:s}),width:"40px"})),[t,o,r,e,i,s,a])},Ol=[{name:Bo,field:"rank",width:"45px",align:"right"},{name:zo,field:"name",sortable:!0,truncateText:!0,render:(e,{id:t})=>t?i.a.createElement(kl,{id:t,name:e}):e}],jl=({rules:e=[],loading:t,queryId:a,toggleStatus:s,toggleQuery:r})=>{const o=Object(n.useMemo)((()=>null==e?void 0:e.sort(((e,t)=>t.rule_risk-e.rule_risk)).map((({rule_name:e,rule_id:t},a)=>({rank:a+1,name:e,id:t})))),[e]),l=Object(n.useMemo)((()=>({showPerPageOptions:!1,pageSize:5,totalItemCount:o.length})),[o.length]);return i.a.createElement(De.c,null,i.a.createElement(B.EuiPanel,{hasBorder:!0,"data-test-subj":"topRiskScoreContributors"},i.a.createElement(B.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(Tt.a,{title:Lo,hideSubtitle:!0,toggleQuery:r,toggleStatus:s})),s&&i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(De.b,{queryId:a,title:Lo}))),s&&i.a.createElement(B.EuiFlexGroup,{"data-test-subj":"topRiskScoreContributors-table",gutterSize:"none",direction:"column"},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(B.EuiInMemoryTable,{items:o,columns:Ol,pagination:l,loading:t})))))},Il=i.a.memo(jl);Il.displayName="TopRiskScoreContributors";const Cl=({to:e,from:t,title:a})=>{const{dashboard:i,savedObjects:{client:s}}=Object(u.k)().services,[r,o]=Object(n.useState)();return Object(n.useEffect)((()=>{null!=i&&i.locator&&s&&s.find((e=>({type:"dashboard",search:`"${e}"`,fields:["title"]}))(a)).then((async a=>{var n;if(null!=a&&null!==(n=a.savedObjects)&&void 0!==n&&n.length&&e&&t){var s;const n=await(null==i||null===(s=i.locator)||void 0===s?void 0:s.getUrl({dashboardId:a.savedObjects[0].id,timeRange:{to:e,from:t}}));o(n)}}))}),[i,t,s,e,a]),{buttonHref:r}},Ml=({refetch:e,riskScoreEntity:t,disabled:a=!1,timerange:s})=>{const r=Object($s.a)(),{http:o,notifications:l,theme:c,dashboard:d}=Object(u.k)().services,{renderDocLink:p,renderDashboardLink:m}=Yr(t),{fetch:g,isLoading:f}=Object(Xr.b)(Xr.a.ENABLE_RISK_SCORE,Vr),b=Object(n.useCallback)((()=>{g({dashboard:d,http:o,notifications:l,refetch:e,renderDashboardLink:m,renderDocLink:p,riskScoreEntity:t,spaceId:r,theme:c,timerange:s})}),[d,g,o,l,e,m,p,t,r,c,s]);return i.a.createElement(B.EuiButton,{color:"primary",fill:!0,onClick:b,isLoading:f,"data-test-subj":`enable_${t}_risk_score`,disabled:a},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.riskScore.enableButtonTitle",defaultMessage:"Enable"}))},Dl=i.a.memo(Ml);Dl.displayName="RiskScoreEnableButton",N.i18n.translate("xpack.securitySolution.riskScoreDisabled.hostsRiskDashboard.title",{defaultMessage:"Host Risk Scores"});const Al=N.i18n.translate("xpack.securitySolution.riskScoreDisabled.hostsRiskDashboard.enableHostRiskScore",{defaultMessage:"Enable Host Risk Score"}),Fl=N.i18n.translate("xpack.securitySolution.riskScoreDisabled.hostsRiskDashboard.enableHostRiskScoreDescription",{defaultMessage:"Once you have enabled this feature you can get quick access to the host risk scores in this section. The data might need an hour to be generated after enabling the module."}),Rl=N.i18n.translate("xpack.securitySolution.riskScoreDisabled.hostsRiskDashboard.enableRiskScorePopoverTitle",{defaultMessage:"Alerts need to be available before enabling module"}),Pl=(N.i18n.translate("xpack.securitySolution.riskScoreDisabled.usersRiskDashboard.title",{defaultMessage:"User Risk Scores"}),N.i18n.translate("xpack.securitySolution.riskScoreDisabled.usersRiskDashboard.enableUserRiskScore",{defaultMessage:"Enable User Risk Score"})),_l=N.i18n.translate("xpack.securitySolution.riskScoreDisabled.usersRiskDashboard.enableUserRiskScoreDescription",{defaultMessage:"Once you have enabled this feature you can get quick access to the user risk scores in this section. The data might need an hour to be generated after enabling the module."}),ql=({refetch:e,timerange:t})=>{const{signalIndexExists:a}=io();return i.a.createElement(B.EuiPanel,{hasBorder:!0},i.a.createElement(Tt.a,{title:i.a.createElement(uo.a,{riskScoreEntity:rn.v.host}),titleSize:"s"}),i.a.createElement(B.EuiEmptyPrompt,{title:i.a.createElement("h2",null,Al),body:i.a.createElement(i.a.Fragment,null,Fl," ",i.a.createElement(Kr.a,{riskScoreEntity:rn.v.host})),actions:i.a.createElement(B.EuiToolTip,{content:a?null:Rl},i.a.createElement(Dl,{refetch:e,riskScoreEntity:rn.v.host,disabled:!a,timerange:t}))}))},Nl=i.a.memo(ql);Nl.displayName="EntityAnalyticsHostRiskScoreDisable";var Ll=a(966);const Bl=({refetch:e,riskScoreEntity:t})=>{const{fetch:a,isLoading:s}=Object(Xr.b)(Xr.a.REFRESH_RISK_SCORE,Gr),r=Object($s.a)(),{renderDocLink:o}=Yr(t),{http:l,notifications:c,theme:d}=Object(u.k)().services,p=Object(n.useCallback)((async()=>{a({http:l,notifications:c,refetch:e,renderDocLink:o,riskScoreEntity:t,spaceId:r,theme:d})}),[a,l,c,e,o,t,r,d]);return i.a.createElement(B.EuiButton,{color:"primary",fill:!0,onClick:p,isLoading:s,"data-test-subj":`restart_${t}_risk_score`},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.riskScore.restartButtonTitle",defaultMessage:"Restart"}))},zl=i.a.memo(Bl);zl.displayName="RiskScoreRestartButton";const Hl=({entityType:e,refetch:t})=>{const a=Object(n.useMemo)((()=>({title:e===rn.v.user?Ll.f:Ll.b,body:e===rn.v.user?Ll.e:Ll.a})),[e]);return i.a.createElement(B.EuiPanel,{"data-test-subj":`${e}-risk-score-no-data-detected`,hasBorder:!0},i.a.createElement(Tt.a,{title:i.a.createElement(uo.a,{riskScoreEntity:e}),titleSize:"s",tooltip:e===rn.v.user?co.d:co.a}),i.a.createElement(B.EuiEmptyPrompt,{title:i.a.createElement("h2",null,a.title),body:a.body,actions:i.a.createElement(B.EuiToolTip,{content:Ll.c},i.a.createElement(zl,{refetch:t,riskScoreEntity:e}))}))},$l=i.a.memo(Hl);$l.displayName="RiskScoresNoDataDetected";const Vl=H()(B.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-846lzt-0"})(["margin-top:",";"],(({theme:e})=>e.eui.euiSizeL)),Ul=Io.a.HOST_DETAILS_RISK_SCORE,Ql=({hostName:e,startDate:t,endDate:a,setQuery:s,deleteQuery:r})=>{const o=Object(n.useMemo)((()=>Rn.d.hostRiskScoreSeverityFilterSelector()),[]),l=Object(E.a)((e=>o(e,Rn.b.HostsType.details))),{buttonHref:c}=Cl({from:t,to:a,title:zr}),u=Object(n.useMemo)((()=>({from:t,to:a})),[t,a]),d=Object(n.useMemo)((()=>e?Object(rn.B)([e]):void 0),[e]),{toggleStatus:p,setToggleStatus:m}=Object(zt.a)(`${Ul} overTime`),{toggleStatus:g,setToggleStatus:f}=Object(zt.a)(`${Ul} contributors`),[b,{data:h,refetch:v,inspect:k,isDeprecated:S,isModuleEnabled:T}]=Object(Io.c)({filterQuery:d,onlyLatest:!1,skip:!p&&!g,timerange:u});Object(Pi.b)({queryId:Ul,loading:b,refetch:v,setQuery:s,deleteQuery:r,inspect:k});const x=Object(n.useCallback)((e=>{f(e)}),[f]),w=Object(n.useCallback)((e=>{m(e)}),[m]),O=Object(y.last)(h);return T||b?S&&!b?i.a.createElement(po,{entityType:rn.v.host,refetch:v,timerange:u}):T&&0===l.length&&h&&0===h.length?i.a.createElement($l,{entityType:rn.v.host,refetch:v}):i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiFlexGroup,{direction:"row"},i.a.createElement(B.EuiFlexItem,{grow:2},i.a.createElement(No,{from:t,to:a,loading:b,riskScore:h,queryId:Ul,title:mo.a,toggleStatus:p,toggleQuery:w})),i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(Il,{loading:b,queryId:Ul,toggleStatus:g,toggleQuery:x,rules:O?O.host.risk.rule_risks:[]}))),i.a.createElement(Vl,{gutterSize:"s"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{href:c,isDisabled:!c,"data-test-subj":"risky-hosts-view-dashboard-button",target:"_blank"},mo.j)),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(Oo,null)))):i.a.createElement(Nl,{refetch:v,timerange:u})};Ql.displayName="HostRiskTabBodyComponent";const Wl=i.a.memo(Ql);Wl.displayName="HostRiskTabBody";const Gl=i.a.memo((({severityCount:e})=>i.a.createElement(B.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"m","data-test-subj":"risk-score-severity-badges"},i.a.createElement(B.EuiFlexItem,{grow:!1}),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiFlexGroup,{gutterSize:"m"},Object.keys(ps.a).map((t=>i.a.createElement(B.EuiFlexItem,{key:t,grow:!1},i.a.createElement(Kl,{status:t,count:e[t]||0})))))))));Gl.displayName="SeverityBadges";const Kl=i.a.memo((({status:e,count:t})=>i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(ps.b,{severity:e})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiNotificationBadge,{size:"s",color:"subdued"},t)))));Kl.displayName="SeverityBadge";const Jl=H()(B.EuiColorPaletteDisplay).withConfig({displayName:"StyledEuiColorPaletteDisplay",componentId:"sc-s3n26r-0"})(["&.risk-score-severity-bar{border:none;border-radius:0;&:after{border:none;}}"]),Yl=({severityCount:e})=>{const t=Object(n.useMemo)((()=>Object.keys(ps.a).reduce(((t,a)=>{const n={stop:(t.length>0?t[t.length-1].stop:0)+(e[a]||0),color:ps.a[a]};return t.push(n),t}),[])),[e]);return i.a.createElement(Jl,{className:"risk-score-severity-bar","data-test-subj":"risk-score-severity-bar",size:"s",palette:t})},Xl=({severityCount:e,selectedSeverities:t,onSelect:a,title:s})=>{const[r,o]=Object(n.useState)(!1),l=Object(n.useCallback)((()=>{o(!r)}),[r]),c=Object(n.useCallback)((()=>{o(!1)}),[]),u=Object(B.useGeneratedHtmlId)({prefix:"filterGroupPopover"}),d=Object(n.useMemo)((()=>rn.y.map((a=>({risk:a,count:e[a],checked:t.includes(a)?"on":void 0})))),[e,t]),p=Object(n.useCallback)((e=>{const n=null!=t?t:[],i=n.includes(e)?n.filter((t=>t!==e)):[...n,e];a(i)}),[t,a]),m=Object(n.useMemo)((()=>d.reduce(((e,t)=>"on"===t.checked?e+t.count:e),0)),[d]),g=Object(n.useMemo)((()=>i.a.createElement(B.EuiFilterButton,{"data-test-subj":"risk-filter-button",hasActiveFilters:!!d.find((e=>"on"===e.checked)),iconType:"arrowDown",isSelected:r,numActiveFilters:m,onClick:l},s)),[r,d,l,m,s]);return i.a.createElement(B.EuiFilterGroup,null,i.a.createElement(B.EuiPopover,{id:u,button:g,isOpen:r,closePopover:c,panelPaddingSize:"none"},i.a.createElement("div",{className:"euiFilterSelect__items"},d.map(((e,t)=>i.a.createElement(B.EuiFilterSelectItem,{"data-test-subj":`risk-filter-item-${e.risk}`,checked:e.checked,key:t+e.risk,onClick:()=>p(e.risk)},i.a.createElement(ps.b,{severity:e.risk})))))))},Zl=[{text:ns,numberOfRow:5},{text:is,numberOfRow:10}],ec=Rn.b.HostsTableType.risk,tc=({data:e,id:t,isInspect:a,loading:s,loadPage:r,setQuerySkip:l,severityCount:c,totalCount:u,type:d})=>{const p=Object(o.useDispatch)(),m=Object(n.useMemo)((()=>Rn.d.hostRiskScoreSelector()),[]),{activePage:g,limit:f,sort:b}=Object(E.a)((e=>m(e,Rn.b.HostsType.page))),h=Object(n.useCallback)((e=>p(Rn.a.updateTableLimit({hostsType:d,limit:e,tableType:ec}))),[d,p]),y=Object(n.useCallback)((e=>p(Rn.a.updateTableActivePage({activePage:e,hostsType:d,tableType:ec}))),[d,p]),v=Object(n.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===b.direction&&t.field===b.field||p(Rn.a.updateHostRiskScoreSort({sort:t,hostsType:d}))}}),[p,b,d]),k=Object(n.useCallback)((e=>{p(Rn.a.updateHostRiskScoreSeverityFilter({severitySelection:[e],hostsType:d}))}),[p,d]),S=Object(n.useMemo)((()=>(({dispatchSeverityUpdate:e})=>[{field:"host.name",name:ss,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e&&e.length>0){const t=Object(Ze.h)(`host-risk-score-table-hostName-${e}`);return i.a.createElement(Vi.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e,kqlQuery:"",queryMatch:{field:"host.name",value:e,operator:Ui.c}},isAggregatable:!0,fieldType:"keyword",render:(t,a,n)=>n.isDragging?i.a.createElement(Vi.a,null,i.a.createElement(Qi.a,{dataProvider:t})):i.a.createElement(ue.d,{hostName:e,hostTab:En.HostsTableType.risk})})}return Object(ri.d)()}},{field:rn.w.hostRiskScore,name:rs,truncateText:!0,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e?i.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},e.toFixed(2)):Object(ri.d)()},{field:rn.w.hostRisk,name:i.a.createElement(B.EuiToolTip,{content:ls},i.a.createElement(i.a.Fragment,null,os," ",i.a.createElement(B.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:t=>null!=t?i.a.createElement(ps.b,{toolTipContent:i.a.createElement(B.EuiLink,{onClick:()=>e(t)},i.a.createElement(B.EuiText,{size:"xs"},ds(t.toLowerCase()))),severity:t}):Object(ri.d)()}])({dispatchSeverityUpdate:k})),[k]),T=i.a.createElement(B.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Gl,{severityCount:c})),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Yl,{severityCount:c}))),x=Object(n.useMemo)((()=>Rn.d.hostRiskScoreSeverityFilterSelector()),[]),w=Object(E.a)((e=>x(e,d))),O=Object(n.useCallback)((e=>{p(Rn.a.updateHostRiskScoreSeverityFilter({severitySelection:e,hostsType:d}))}),[p,d]);return i.a.createElement(Hn.a,{activePage:g,columns:S,dataTestSubj:`table-${ec}`,headerCount:u,headerFilters:i.a.createElement(Xl,{selectedSeverities:w,severityCount:c,title:as,onSelect:O}),headerSupplement:T,headerTitle:cs,headerUnit:Gi(u),headerTooltip:us,id:t,isInspect:a,itemsPerRow:Zl,limit:f,loading:s,loadPage:r,onChange:v,pageOfItems:e,setQuerySkip:l,showMorePagesIndicator:!1,sorting:b,split:!0,stackHeader:!0,totalCount:u,updateLimitPagination:h,updateActivePage:y})};tc.displayName="HostRiskScoreTableComponent";const ac=i.a.memo(tc);ac.displayName="HostRiskScoreTable";const nc=Object(Pi.a)(ac),ic=({deleteQuery:e,filterQuery:t,skip:a,setQuery:s,type:r})=>{const o=Object(n.useMemo)((()=>Rn.d.hostRiskScoreSelector()),[]),{activePage:l,limit:c,sort:u}=Object(E.a)((e=>o(e,Rn.b.HostsType.page))),d=Object(n.useMemo)((()=>Rn.d.hostRiskScoreSeverityFilterSelector()),[]),p=Object(E.a)((e=>d(e,Rn.b.HostsType.page))),m=Object(n.useMemo)((()=>({cursorStart:l*c,querySize:c})),[l,c]),{toggleStatus:g}=Object(zt.a)(Io.a.HOSTS_BY_RISK),[f,b]=Object(n.useState)(a||!g);Object(n.useEffect)((()=>{b(!g)}),[g]);const{from:h,to:v}=Object(U.a)(),k=Object(n.useMemo)((()=>({from:h,to:v})),[h,v]),[S,{data:T,totalCount:x,inspect:w,isInspected:O,isDeprecated:j,refetch:I,isModuleEnabled:C}]=Object(Io.c)({filterQuery:t,skip:f,pagination:m,sort:u,timerange:k}),{severityCount:M,loading:D}=Object(Io.d)({filterQuery:t,skip:f});return C||S?j&&!S?i.a.createElement(po,{refetch:I,timerange:k,entityType:rn.v.host}):!S&&C&&0===p.length&&T&&0===T.length?i.a.createElement($l,{entityType:rn.v.host,refetch:I}):i.a.createElement(nc,{deleteQuery:e,data:null!=T?T:[],id:Io.a.HOSTS_BY_RISK,inspect:w,isInspect:O,loading:S||D,loadPage:y.noop,refetch:I,setQuery:s,setQuerySkip:b,severityCount:null!=M?M:rn.c,totalCount:x,type:r}):i.a.createElement(Nl,{refetch:I,timerange:k})};ic.displayName="HostRiskScoreQueryTabBody";var sc=a(534),rc=a(80),oc=a(36);const lc=N.i18n.translate("xpack.securitySolution.sessionsView.totalCountOfSessions",{defaultMessage:"sessions"}),cc=N.i18n.translate("xpack.securitySolution.sessionsView.singleCountOfSessions",{defaultMessage:"session"}),uc=N.i18n.translate("xpack.securitySolution.sessionsView.columnSessionStart",{defaultMessage:"Started"}),dc=N.i18n.translate("xpack.securitySolution.sessionsView.columnExecutable",{defaultMessage:"Executable"}),pc=N.i18n.translate("xpack.securitySolution.sessionsView.columnEntryUser",{defaultMessage:"User"}),mc=N.i18n.translate("xpack.securitySolution.sessionsView.columnInteractive",{defaultMessage:"Interactive"}),gc=N.i18n.translate("xpack.securitySolution.sessionsView.columnHostName",{defaultMessage:"Hostname"}),fc=N.i18n.translate("xpack.securitySolution.sessionsView.columnEntryType",{defaultMessage:"Type"}),bc=N.i18n.translate("xpack.securitySolution.sessionsView.columnEntrySourceIp",{defaultMessage:"Source IP"}),hc=[{columnHeaderType:rc.a,id:"process.entry_leader.start",initialWidth:oc.b,display:uc},{columnHeaderType:rc.a,id:"process.entry_leader.executable",display:dc},{columnHeaderType:rc.a,id:"process.entry_leader.user.name",display:pc},{columnHeaderType:rc.a,id:"process.entry_leader.interactive",display:mc},{columnHeaderType:rc.a,id:"host.hostname",display:gc},{columnHeaderType:rc.a,id:"process.entry_leader.entry_meta.type",display:fc},{id:"process.entry_leader.entry_meta.source.ip",columnHeaderType:rc.a,display:bc}],yc=(e,t)=>({...ge.a,columns:e,defaultColumns:t,excludedRowRendererIds:Object.values(l.d),sort:[{columnId:"process.entry_leader.start",columnType:"date",sortDirection:"desc"}]});var Ec=a(377),vc=a(576),kc=a(423),Sc=a(79);const Tc={query:{bool:{filter:[{exists:{field:"process.entry_leader.entity_id"}}]}},meta:{alias:null,disabled:!1,key:"process.entry_leader.entity_id",negate:!1,params:{},type:"string"}},xc=({timelineId:e,endDate:t,entityType:a="sessions",pageFilters:s,startDate:r,filterQuery:o,columns:c=hc,defaultColumns:u=hc})=>{const d=Object(n.useMemo)((()=>o&&""!==o?JSON.parse(o):{}),[o]),p=Object(n.useMemo)((()=>[{...Tc,query:{...Tc.query,bool:{...Tc.query.bool,filter:Tc.query.bool.filter.concat(d)}}},...s]),[s,d]),g=Object(Sc.b)().isEnterprise()||e===l.i.kubernetesPageSessions?5:4,f=Object(n.useMemo)((()=>Object(kc.a)(g)),[g]);return i.a.createElement("div",{"data-test-subj":"security_solution:sessions_viewer:sessions_view"},i.a.createElement(sc.a,{pageFilters:p,defaultModel:yc(c,u),end:t,entityType:a,id:e,leadingControlColumns:f,renderCellValue:vc.a,rowRenderers:Ec.b,scopeId:m.SourcererScopeName.default,start:r,unit:e=>e>1?lc:cc}))};xc.displayName="SessionsViewComponent";const wc=i.a.memo(xc),Oc=i.a.memo((e=>{const{pageFilters:t,filterQuery:a,...s}=e,r=Object(n.useMemo)((()=>null!=t?[...Ln.e,...t]:Ln.e),[t]);return Object(Sc.b)().isEnterprise()?i.a.createElement(wc,yn()({entityType:"sessions",timelineId:l.i.hostsPageSessions},s,{pageFilters:r,filterQuery:a})):null}));Oc.displayName="SessionsTabBody";var jc=a(239);const Ic=i.a.memo((({detailName:e,filterQuery:t,indexNames:a,indexPattern:s,pageFilters:r=[],hostDetailsPagePath:o})=>{const{from:l,to:c,isInitializing:u,deleteQuery:d,setQuery:p}=Object(U.a)(),m={deleteQuery:d,endDate:c,filterQuery:t,skip:u||void 0===t,setQuery:p,startDate:l,type:Bn.b,indexPattern:s,indexNames:a,hostName:e},g=Object(n.useMemo)((()=>[...Ln.e,...r]),[r]);return i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:`${o}/:tabName(${En.HostsTableType.authentications})`},i.a.createElement(zi,m)),i.a.createElement(_.Route,{path:`${o}/:tabName(${En.HostsTableType.uncommonProcesses})`},i.a.createElement(zs,m)),i.a.createElement(_.Route,{path:`${o}/:tabName(${En.HostsTableType.anomalies})`},i.a.createElement(vn.a,yn()({},m,{AnomaliesTableComponent:qn}))),i.a.createElement(_.Route,{path:`${o}/:tabName(${En.HostsTableType.events})`},i.a.createElement(Nn.a,yn()({},m,{pageFilters:r,timelineId:jc.c.hostsPageEvents,externalAlertPageFilters:g}))),i.a.createElement(_.Route,{path:`${o}/:tabName(${En.HostsTableType.risk})`},i.a.createElement(Wl,m)),i.a.createElement(_.Route,{path:`${o}/:tabName(${En.HostsTableType.sessions})`},i.a.createElement(Oc,m)))}));Ic.displayName="HostDetailsTabs";var Cc=a(335);const Mc=(e,t)=>`${r.Jb}/name/${e}/${t}`,Dc=({hasMlUserPermissions:e,isRiskyHostsEnabled:t,hostName:a,isEnterprise:n})=>{const i=[],s={[En.HostsTableType.authentications]:{id:En.HostsTableType.authentications,name:mo.d,href:Mc(a,En.HostsTableType.authentications),disabled:!1},[En.HostsTableType.uncommonProcesses]:{id:En.HostsTableType.uncommonProcesses,name:mo.h,href:Mc(a,En.HostsTableType.uncommonProcesses),disabled:!1},[En.HostsTableType.anomalies]:{id:En.HostsTableType.anomalies,name:mo.c,href:Mc(a,En.HostsTableType.anomalies),disabled:!1},[En.HostsTableType.events]:{id:En.HostsTableType.events,name:mo.e,href:Mc(a,En.HostsTableType.events),disabled:!1},[En.HostsTableType.risk]:{id:En.HostsTableType.risk,name:mo.f,href:Mc(a,En.HostsTableType.risk),disabled:!1,isBeta:!0,betaOptions:{text:Cc.i}},[En.HostsTableType.sessions]:{id:En.HostsTableType.sessions,name:mo.g,href:Mc(a,En.HostsTableType.sessions),disabled:!1,isBeta:!1}};return e||i.push(En.HostsTableType.anomalies),t||i.push(En.HostsTableType.risk),n||i.push(En.HostsTableType.sessions),Object(y.omit)(i,s)};var Ac=a(253),Fc=a(693),Rc=a(296),Pc=a(611);const _c=Object(Pi.a)(gn.a),qc=({detailName:e,hostDetailsPagePath:t})=>{const a=Object(o.useDispatch)(),s=Object(n.useMemo)((()=>d.b.getTimelineByIdSelector()),[]),r=Object(E.b)((e=>{var t;return(null!==(t=s(e,l.i.hostsPageEvents))&&void 0!==t?t:ge.a).graphEventId})),c=Object(n.useMemo)((()=>fn.f.globalFiltersQuerySelector()),[]),m=Object(n.useMemo)((()=>fn.f.globalQuerySelector()),[]),g=Object(E.a)(m),b=Object(E.a)(c),{to:k,from:S,deleteQuery:T,setQuery:x,isInitializing:w}=Object(U.a)(),{globalFullScreen:O}=Object(de.a)(),{signalIndexName:j}=Object(sn.a)(),I=Object(dn.a)(),{services:{uiSettings:C}}=Object(u.k)(),M=Object(n.useMemo)((()=>{return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"host.name",value:t=e,params:{query:t}},query:{match:{"host.name":{query:t,type:"phrase"}}}}];var t}),[e]),D=Object(Sc.b)().isEnterprise(),A=Object(n.useCallback)(((e,t)=>{const n=Object(pn.a)(e,t);a(Object(J.setAbsoluteRangeDatePicker)({id:V.a.global,from:n.from,to:n.to}))}),[a]),{indexPattern:F,indicesExist:R,selectedPatterns:P}=Object(p.d)(),[_,{inspect:q,hostDetails:N,id:L,refetch:z}]=Object(Fc.b)({endDate:k,startDate:S,hostName:e,indexNames:P,skip:0===P.length}),[H,$]=Object(n.useMemo)((()=>{try{return[Object(Ve.c)(F,[g],[...M,...b],Object(an.getEsQueryConfig)(C))]}catch(e){return[void 0,e]}}),[b,F,g,C,M]),W=JSON.stringify(H);Object(Rc.a)({id:Fc.a,filterQuery:W,kqlError:$,query:g,startDate:S,endDate:k}),Object(n.useEffect)((()=>{a(Object(bn.setHostDetailsTablesActivePageToZero)())}),[a,e]);const K=Object(dn.a)().isPlatinumOrTrialLicense,{hasKibanaREAD:Y,hasIndexRead:X}=Object(na.a)(),Z=Y&&X,ee=Object(n.useMemo)((()=>({field:"host.hostname",value:e})),[e]);return i.a.createElement(i.a.Fragment,null,R?i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiWindowEvent,{event:"resize",handler:y.noop}),i.a.createElement(Q.a,{show:Object(me.m)({globalFullScreen:O,graphEventId:r})},i.a.createElement(G.a,{indexPattern:F,id:V.a.global})),i.a.createElement(f.a,{noPadding:O,"data-test-subj":"hostDetailsPage"},i.a.createElement(pe.a,{show:!O},i.a.createElement(Yt.a,{border:!0,subtitle:i.a.createElement(on.a,{indexKey:rn.k.hostDetails,hostName:e,indexNames:P}),title:e}),i.a.createElement(ln.a,{criteriaFields:Object(cn.a)(N),startDate:S,endDate:k,skip:w},(({isLoadingAnomaliesData:t,anomaliesData:a})=>i.a.createElement(_c,{id:L,isInDetailsSidePanel:!1,data:N,anomaliesData:a,isLoadingAnomaliesData:t,loading:_,startDate:S,endDate:k,narrowDateRange:A,setQuery:x,refetch:z,inspect:q,hostName:e,indexNames:P}))),i.a.createElement(B.EuiHorizontalRule,null),i.a.createElement(B.EuiSpacer,null),Z&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiFlexGroup,null,i.a.createElement(B.EuiFlexItem,null,i.a.createElement(nn.a,{signalIndexName:j,entityFilter:ee,additionalFilters:H?[H]:[]})),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Pc.a,{entityFilter:ee,signalIndexName:j,additionalFilters:H?[H]:[]}))),i.a.createElement(B.EuiSpacer,null)),i.a.createElement(mn.a,{navTabs:Dc({hasMlUserPermissions:Object(un.a)(I),isRiskyHostsEnabled:K,hostName:e,isEnterprise:D})}),i.a.createElement(B.EuiSpacer,null)),i.a.createElement(Ic,{indexNames:P,isInitializing:w,deleteQuery:T,pageFilters:M,to:k,from:S,detailName:e,type:Bn.b,setQuery:x,filterQuery:W,hostDetailsPagePath:t,indexPattern:F}))):i.a.createElement(Xt.a,null),i.a.createElement(h.a,{pageName:v.a.hosts}))};qc.displayName="HostDetailsComponent";const Nc=i.a.memo(qc);var Lc=a(431),Bc=a(105),zc=a(182);const Hc=e=>{try{return Object(zc.decode)(e)}catch(e){return null}},$c=e=>Object(y.isObject)(e),Vc=e=>Object(y.isString)(e),Uc=(e,t)=>t.reduce(((t,a,n)=>{const i=((e,t)=>1===e.length?`${e[0]}: "${t}"`:e.reduce(((e,a,n,i)=>0===n?`(${a}: "${t}"`:n===i.length-1?`${e} or ${a}: "${t}")`:`${e} or ${a}: "${t}"`),""))(e,a);return 0===n?i:`${t} or ${i}`}),""),Qc=(e,t,a)=>{const n=Hc(a);if($c(n)){const a=n;if($c(a)&&Vc(a.query)){const i=Uc(e,t);return""!==a.query&&""!==i?a.query=`(${i}) and (${a.query})`:""===a.query&&""!==i&&(a.query=`(${i})`),Object(zc.encode)(n)}}else if(null==n){const a=Uc(e,t);return Object(zc.encode)({query:`(${a})`,language:"kuery"})}return a},Wc=(e,t,a)=>`(${a.split(",").reduce(((e,a,n)=>0===n?`${t}: "${a}"`:`${e} or ${t}: "${a}"`),"")})`,Gc=e=>{const t=Hc(e);if($c(t)){const e=t;if($c(e)&&Vc(e.query))return e.query=e.query.replace(/([\w\.\-\[\]]+)\s*:\s*"(([\w\.\-\(\)\[\]]+,[\w\.\-\(\)\[\]]+){1,})"/g,Wc),Object(zc.encode)(t)}return e},Kc=["and","or","not"],Jc=(e,...t)=>{if(null==t)return"";const a=t.reduce(((e,t)=>null!=t&&Kc.includes(t)?[...e,t]:e),[]);return a.length>1?` ${a[a.length-1].trim()} `:""},Yc=e=>{const t=Hc(e);if($c(t)){const e=t;if($c(e)&&Vc(e.query))return e.query=e.query.replace(/(\s+)*(and|or|not){0,1}(\s+)*([\w\.\-\[\]]+)\s*:\s*"(\$[\w\.\-\(\)\[\]]+\$)"(\s+)*(and|or|not){0,1}(\s+)*/g,Jc),Object(zc.encode)(t)}return e},Xc=e=>Object(y.flow)(Gc,Yc)(e),Zc=e=>""===e.trim()||e.startsWith("$")&&e.endsWith("$"),eu=e=>e.split(",").length>1,tu=e=>e.split(","),au=i.a.memo((()=>{const{path:e}=Object(P.useRouteMatch)();return i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{strict:!0,exact:!0,path:e,render:({location:e})=>{const t=Object(Lc.parse)(e.search.substring(1),{sort:!1});null!=t.query&&(t.query=Xc(t.query));const a=Object(Lc.stringify)(Bc.url.encodeQuery(t),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${r.Jb}?${a}`})}}),i.a.createElement(_.Route,{path:`${e}/:hostName`,render:({location:e,match:{params:{hostName:t}}})=>{const a=Object(Lc.parse)(e.search.substring(1),{sort:!1});if(null!=a.query&&(a.query=Xc(a.query)),Zc(t)){const e=Object(Lc.stringify)(Bc.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${r.Jb}/${En.HostsTableType.anomalies}?${e}`})}if(eu(t)){const e=tu(t);a.query=Qc(["host.name"],e,a.query||"");const n=Object(Lc.stringify)(Bc.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${r.Jb}/${En.HostsTableType.anomalies}?${n}`})}{const e=Object(Lc.stringify)(Bc.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${r.Jb}/name/${t}/${En.HostsTableType.anomalies}?${e}`})}}}),i.a.createElement(_.Route,{path:`${r.Jb}/ml-hosts/`,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{from:`${r.Jb}/ml-hosts/`,to:`${r.Jb}/ml-hosts${e}`})}))}));au.displayName="MlHostConditionalContainer";const nu={description:"",state:{datasourceStates:{indexpattern:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["5eea817b-67b7-4268-8ecb-7688d1094721","b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"5eea817b-67b7-4268-8ecb-7688d1094721":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:Object(oi.o)("host.name"),operationType:"unique_count",scale:"ratio",sourceField:"host.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data",seriesType:"area",xAccessor:"5eea817b-67b7-4268-8ecb-7688d1094721"}],legend:{isVisible:!0,position:"right"},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Hosts - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]};var iu=a(20);const su=N.i18n.translate("xpack.securitySolution.hostsKpiHosts.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi hosts search"}),ru=N.i18n.translate("xpack.securitySolution.hostsKpiHosts.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi hosts"});var ou=a(81);const lu="hostsKpiHostsQuery";var cu=a(950),uu=a(683),du=a(322);const pu=e=>!!Object(y.get)("value.length",e)&&Object(y.get)("value",e).every((({x:e,y:t})=>!Object(y.isNull)(e)&&Object(y.isNumber)(t)&&t>0)),mu={tickLine:{visible:!1},tickLabel:{padding:3}},gu=({data:e,...t})=>{const a=Object(Ge.h)(),n=Object(u.n)(),s=Object(y.get)("configs.axis.xTickFormatter",t),r=Object(y.get)("configs.axis.yTickFormatter",t),o=`group-${e[0].key}-x`,l=`group-${e[0].key}-y`,c={...Ge.d,theme:a,...Object(y.get)("configs.settings",t)};return t.width&&t.height?i.a.createElement("div",{style:{height:t.height,width:t.width,position:"relative"}},i.a.createElement(We.Chart,null,i.a.createElement(We.Settings,c),e.map((e=>{const a=e.key;return pu(e)?i.a.createElement(We.AreaSeries,{id:a,key:a,name:e.key.replace("Histogram",""),data:e.value||[],xScaleType:Object(y.getOr)(We.ScaleType.Linear,"configs.series.xScaleType",t),yScaleType:Object(y.getOr)(We.ScaleType.Linear,"configs.series.yScaleType",t),timeZone:n,xAccessor:"x",yAccessors:["y"],areaSeriesStyle:{area:{opacity:.04,visible:!0},line:{strokeWidth:1,visible:!0},point:{visible:!1,radius:.2,strokeWidth:1,opacity:1}},color:e.color?e.color:void 0}):null})),i.a.createElement(We.Axis,{id:o,position:We.Position.Bottom,showOverlappingTicks:!1,tickFormat:s,style:mu}),i.a.createElement(We.Axis,{id:l,position:We.Position.Left,style:mu,tickFormat:r}))):null};gu.displayName="AreaChartBaseComponent";const fu=i.a.memo(gu);fu.displayName="AreaChartBase";const bu=({areaChart:e,configs:t,visualizationActionsOptions:a})=>{const{ref:s,width:r,height:o}=Object(Mo.b)(),l=Object(y.get)("customHeight",t),c=Object(y.get)("customWidth",t),u=Object(Ge.f)(l,o),d=Object(Ge.g)(c,r),p=Object(n.useMemo)((()=>{return t=e,Array.isArray(t)&&t.some(pu);var t}),[e]);return i.a.createElement(Ge.c,null,i.a.createElement(du.a,{targetClassNames:[uu.a]},p&&e&&i.a.createElement(Ge.a,{gutterSize:"none"},i.a.createElement(B.EuiFlexItem,{grow:!0},i.a.createElement(Ge.b,{ref:s,height:u},i.a.createElement(fu,{data:e,height:u,width:d,configs:t})))),!p&&i.a.createElement(cu.a,{height:u,width:d,data:e}),null!=a&&i.a.createElement(uu.b,yn()({},a,{className:"viz-actions"}))))},hu=i.a.memo(bu);var yu=a(636),Eu=a(953);const vu=H()(B.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1rm4ik7-0"})([".no-margin{margin-top:0 !important;margin-bottom:0 !important;}"]),ku=H()(B.EuiFlexItem).withConfig({displayName:"FlexItem",componentId:"sc-1rm4ik7-1"})(["min-width:0;position:relative;"]);ku.displayName="FlexItem";const Su=H()(B.EuiTitle).withConfig({displayName:"StatValue",componentId:"sc-1rm4ik7-2"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]);Su.displayName="StatValue";const Tu=e=>e.toLocaleString(),xu=e=>({series:{xScaleType:We.ScaleType.Time,yScaleType:We.ScaleType.Linear},axis:{xTickFormatter:Object(y.get)("xTickFormatter",e),yTickFormatter:Tu},settings:{onBrushEnd:Object(y.getOr)((()=>{}),"onBrushEnd",e)},customHeight:74}),wu=(e,t)=>e.map((e=>({...e,value:Object(y.get)(e.key,t)}))),Ou=(e,t)=>e.filter((e=>null!=Object(y.get)(`${e.key}Histogram`,t))).map((({lensAttributes:e,...a})=>({...a,value:Object(y.get)(`${a.key}Histogram`,t),key:`${a.key}Histogram`}))),ju=(e,t)=>0===e.length?[]:e.reduce(((a,n,i)=>{const{key:s,color:r}=n,o=Object(y.getOr)(null,s,t);return[...a,{key:s,color:r,value:[{x:Object(y.get)(`${i}.name`,e)||Object(y.getOr)("",`${i}.description`,e),y:o,g:s,y0:0}]}]}),[]),Iu=H.a.h6.withConfig({displayName:"StyledTitle",componentId:"sc-1rm4ik7-3"})(["line-height:200%;"]),Cu=i.a.memo((({areaChart:e,barChart:t,description:a,enableAreaChart:s,enableBarChart:r,fields:o,from:l,grow:c,id:u,loading:d=!1,showInspectButton:p=!0,index:m,updateDateRange:g,statKey:f="item",to:b,barChartLensAttributes:h,areaChartLensAttributes:E,setQuerySkip:v})=>{const k=t&&t.length&&t.every((e=>null!=e.value&&e.value.length>0)),S=e&&e.length&&e.every((e=>null!=e.value&&e.value.length>0)),T=Object(n.useMemo)((()=>({from:l,to:b})),[l,b]),{toggleStatus:x,setToggleStatus:w}=Object(zt.a)(u),O=Object(n.useCallback)((e=>{w(e),v(!e)}),[v,w]),j=Object(n.useCallback)((()=>O(!x)),[O,x]);return i.a.createElement(ku,{grow:c,"data-test-subj":`stat-${f}`},i.a.createElement(B.EuiPanel,{hasBorder:!0},i.a.createElement(vu,{gutterSize:"none"},i.a.createElement(B.EuiFlexItem,{className:x?"":"no-margin"},i.a.createElement(B.EuiFlexGroup,{gutterSize:"none",responsive:!1},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButtonIcon,{"aria-label":Eu.a(x),"data-test-subj":"query-toggle-stat",color:"text",display:"empty",iconType:x?"arrowDown":"arrowRight",onClick:j,size:"xs",title:Eu.a(x)})),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiTitle,{size:"xxxs"},i.a.createElement(Iu,null,a))))),p&&x&&!d&&i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(De.b,{queryId:u,title:a,inspectIndex:m}))),d&&i.a.createElement(B.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiLoadingSpinner,{size:"l"}))),x&&!d&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiFlexGroup,null,o.map((e=>i.a.createElement(ku,{key:`stat-items-field-${e.key}`},i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},(S||k)&&e.icon&&i.a.createElement(ku,{grow:!1},i.a.createElement(B.EuiIcon,{type:e.icon,color:e.color,size:"l","data-test-subj":"stat-icon"})),i.a.createElement(ku,null,i.a.createElement(du.a,{targetClassNames:[uu.a]},i.a.createElement(Su,null,i.a.createElement("p",{"data-test-subj":"stat-title"},null!=e.value?e.value.toLocaleString():Object(ri.d)()," ",e.description)),e.lensAttributes&&T&&i.a.createElement(uu.b,{lensAttributes:e.lensAttributes,queryId:u,inspectIndex:m,timerange:T,title:a,className:"viz-actions"})))))))),(s||r)&&i.a.createElement(B.EuiHorizontalRule,null),i.a.createElement(B.EuiFlexGroup,null,r&&i.a.createElement(ku,null,i.a.createElement(yu.a,{barChart:t,configs:{series:{xScaleType:We.ScaleType.Ordinal,yScaleType:We.ScaleType.Linear,stackAccessors:["y0"]},axis:{xTickFormatter:Tu},settings:{onElementClick:Object(y.getOr)((()=>{}),"onElementClick",undefined),rotation:90},customHeight:74},visualizationActionsOptions:{lensAttributes:h,queryId:u,inspectIndex:m,timerange:T,title:a}})),s&&null!=l&&null!=b&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ku,null,i.a.createElement(hu,{areaChart:e,configs:xu({xTickFormatter:Object(Mo.a)([l,b]),onBrushEnd:g}),visualizationActionsOptions:{lensAttributes:E,queryId:u,inspectIndex:m,timerange:T,title:a}})))))))}),((e,t)=>e.description===t.description&&e.enableAreaChart===t.enableAreaChart&&e.enableBarChart===t.enableBarChart&&e.from===t.from&&e.grow===t.grow&&e.loading===t.loading&&e.setQuerySkip===t.setQuerySkip&&e.id===t.id&&e.index===t.index&&e.updateDateRange===t.updateDateRange&&e.statKey===t.statKey&&e.to===t.to&&Ii()(e.areaChart,t.areaChart)&&Ii()(e.barChart,t.barChart)&&Ii()(e.fields,t.fields)));Cu.displayName="StatItemsComponent",H()(B.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-17i7jd7-0"})(["min-height:","px;"],247).displayName="FlexGroup";const Mu=i.a.memo((({fieldsMapping:e,data:t,id:a,loading:n=!1,from:s,to:r,updateDateRange:o,setQuerySkip:l})=>{const c=((e,t,a,n,i,s,r,o)=>e.map((e=>({...e,areaChart:e.enableAreaChart?Ou(e.fields,t):void 0,barChart:e.enableBarChart?ju(e.fields,t):void 0,fields:wu(e.fields,t),id:a,key:`kpi-summary-${e.key}`,statKey:`${e.key}`,from:n,to:i,updateDateRange:s,setQuerySkip:r,loading:o}))))(e,t,a,s,r,o,l,n);return i.a.createElement(B.EuiFlexGroup,{wrap:!0},c.map((e=>i.a.createElement(Cu,yn()({},e,{showInspectButton:!1})))))}),((e,t)=>e.fieldsMapping===t.fieldsMapping&&e.id===t.id&&e.loading===t.loading&&e.from===t.from&&e.to===t.to&&e.updateDateRange===t.updateDateRange&&Ii()(e.data,t.data)));Mu.displayName="KpiBaseComponent";const Du=Object(Pi.a)(Mu);let Au;!function(e){e.uniqueSourceIps="#D36086",e.uniqueDestinationIps="#9170B8",e.hosts="#6092C0"}(Au||(Au={}));const Fu=N.i18n.translate("xpack.securitySolution.kpiHosts.hosts.title",{defaultMessage:"Hosts"}),Ru=[{key:"hosts",fields:[{key:"hosts",value:null,color:Au.hosts,icon:"storage",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"host.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"b00c65ea-32be-4163-bfc8-f795b1ef9d06",layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data"}},title:"[Host] Hosts - metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]}}],enableAreaChart:!0,description:Fu,areaChartLensAttributes:nu}],Pu=({filterQuery:e,from:t,indexNames:a,to:s,updateDateRange:r,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(zt.a)(lu),[d,p]=Object(n.useState)(l||!c);Object(n.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:s})=>{const{data:r}=Object(u.k)().services,o=Object(n.useRef)(y.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new iu.Subscription),[d,p]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[f,b]=Object(n.useState)({hosts:0,hostsHistogram:[],id:lu,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:E}=Object(ma.a)(),v=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=r.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(p(!1),E(su),c.current.unsubscribe()):(p(!1),b((t=>({...t,hosts:e.hosts,hostsHistogram:e.hostsHistogram,inspect:Object(ou.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:ru}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[r.search,h,E,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rn.i.kpiHosts,filterQuery:Object(Mi.a)(e),timerange:{interval:"12h",from:s,to:t}};return Ii()(n,i)?n:i}))}),[a,t,e,s]),Object(n.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(n.useEffect)((()=>{i&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[d,f]})({filterQuery:e,endDate:s,indexNames:a,startDate:t,skip:d});return i.a.createElement(Du,{data:h,id:f,inspect:b,loading:m,fieldsMapping:Ru,from:t,to:s,updateDateRange:r,refetch:g,setQuery:o,setQuerySkip:p})},_u=i.a.memo(Pu),qu={description:"",state:{datasourceStates:{indexpattern:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["a0cb6400-f708-46c3-ad96-24788f12dae4","d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"a0cb6400-f708-46c3-ad96-24788f12dae4":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:oi.l,operationType:"unique_count",scale:"ratio",sourceField:"source.ip"}},incompleteColumns:{}},"ca05ecdb-0fa4-49a8-9305-b23d91012a46":{columnOrder:["f95e74e6-99dd-4b11-8faf-439b4d959df9","e7052671-fb9e-481f-8df3-7724c98cfc6f"],columns:{"e7052671-fb9e-481f-8df3-7724c98cfc6f":{customLabel:!0,dataType:"number",isBucketed:!1,label:oi.g,operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"},"f95e74e6-99dd-4b11-8faf-439b4d959df9":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data",seriesType:"area",xAccessor:"a0cb6400-f708-46c3-ad96-24788f12dae4",yConfig:[{color:"#d36186",forAccessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"}]},{accessors:["e7052671-fb9e-481f-8df3-7724c98cfc6f"],layerId:"ca05ecdb-0fa4-49a8-9305-b23d91012a46",layerType:"data",seriesType:"area",xAccessor:"f95e74e6-99dd-4b11-8faf-439b4d959df9",yConfig:[{color:"#9170b8",forAccessor:"e7052671-fb9e-481f-8df3-7724c98cfc6f"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Unique IPs - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-ca05ecdb-0fa4-49a8-9305-b23d91012a46",type:"index-pattern"}],type:"lens",updated_at:"2022-02-09T17:44:03.359Z",version:"WzI5MTI5OSwzXQ=="},Nu={description:"",state:{datasourceStates:{indexpattern:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["f8bfa719-5c1c-4bf2-896e-c318d77fc08e","32f66676-f4e1-48fd-b7f8-d4de38318601"],columns:{"32f66676-f4e1-48fd-b7f8-d4de38318601":{dataType:"number",isBucketed:!1,label:Object(oi.o)("source.ip"),operationType:"unique_count",scale:"ratio",sourceField:"source.ip"},"f8bfa719-5c1c-4bf2-896e-c318d77fc08e":{dataType:"string",isBucketed:!0,label:"Filters",operationType:"filters",params:{filters:[{input:{language:"kuery",query:""},label:oi.l}]},scale:"ordinal"}},incompleteColumns:{}},"ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e":{columnOrder:["c72aad6a-fc9c-43dc-9194-e13ca3ee8aff","b7e59b08-96e6-40d1-84fd-e97b977d1c47"],columns:{"b7e59b08-96e6-40d1-84fd-e97b977d1c47":{dataType:"number",isBucketed:!1,label:Object(oi.o)("destination.ip"),operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"},"c72aad6a-fc9c-43dc-9194-e13ca3ee8aff":{customLabel:!0,dataType:"string",isBucketed:!0,label:oi.g,operationType:"filters",params:{filters:[{input:{language:"kuery",query:""},label:"Dest."}]},scale:"ordinal"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["32f66676-f4e1-48fd-b7f8-d4de38318601"],layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"f8bfa719-5c1c-4bf2-896e-c318d77fc08e",yConfig:[{color:"#d36186",forAccessor:"32f66676-f4e1-48fd-b7f8-d4de38318601"}]},{accessors:["b7e59b08-96e6-40d1-84fd-e97b977d1c47"],layerId:"ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"c72aad6a-fc9c-43dc-9194-e13ca3ee8aff",yConfig:[{color:"#9170b8",forAccessor:"b7e59b08-96e6-40d1-84fd-e97b977d1c47"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"bar_horizontal_stacked",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Unique IPs - bar",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e",type:"index-pattern"}]},Lu=N.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi unique ips search"}),Bu=N.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi unique ips"}),zu="hostsKpiUniqueIpsQuery",Hu=N.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.title",{defaultMessage:"Unique IPs"}),$u=N.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceUnitLabel",{defaultMessage:"source"}),Vu=N.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationUnitLabel",{defaultMessage:"destination"}),Uu=N.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),Qu=N.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),Wu=[{key:"uniqueIps",fields:[{key:"uniqueSourceIps",name:Uu,description:$u,value:null,color:Au.uniqueSourceIps,icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"source.ip"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe",layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data"}},title:"[Host] Unique IPs - source metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"}]}},{key:"uniqueDestinationIps",name:Qu,description:Vu,value:null,color:Au.uniqueDestinationIps,icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe",layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data"}},title:"[Host] Unique IPs - destination metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"}]}}],enableAreaChart:!0,enableBarChart:!0,description:Hu,areaChartLensAttributes:qu,barChartLensAttributes:Nu}],Gu=({filterQuery:e,from:t,indexNames:a,to:s,updateDateRange:r,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(zt.a)(zu),[d,p]=Object(n.useState)(l||!c);Object(n.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:s})=>{const{data:r}=Object(u.k)().services,o=Object(n.useRef)(y.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new iu.Subscription),[d,p]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[f,b]=Object(n.useState)({uniqueSourceIps:0,uniqueSourceIpsHistogram:[],uniqueDestinationIps:0,uniqueDestinationIpsHistogram:[],id:zu,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:E}=Object(ma.a)(),v=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=r.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(p(!1),E(Lu),c.current.unsubscribe()):(p(!1),b((t=>({...t,uniqueSourceIps:e.uniqueSourceIps,uniqueSourceIpsHistogram:e.uniqueSourceIpsHistogram,uniqueDestinationIps:e.uniqueDestinationIps,uniqueDestinationIpsHistogram:e.uniqueDestinationIpsHistogram,inspect:Object(ou.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:Bu}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[r.search,h,E,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rn.i.kpiUniqueIps,filterQuery:Object(Mi.a)(e),timerange:{interval:"12h",from:s,to:t}};return Ii()(n,i)?n:i}))}),[a,t,e,i,s]),Object(n.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(n.useEffect)((()=>{i&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[d,f]})({filterQuery:e,endDate:s,indexNames:a,startDate:t,skip:d});return i.a.createElement(Du,{data:h,id:f,inspect:b,loading:m,fieldsMapping:Wu,from:t,to:s,updateDateRange:r,refetch:g,setQuery:o,setQuerySkip:p})},Ku=i.a.memo(Gu);var Ju=a(420);const Yu=N.i18n.translate("xpack.securitySolution.kpiHost.learnMore",{defaultMessage:"Learn more about"}),Xu=N.i18n.translate("xpack.securitySolution.kpiHost.hostRiskData",{defaultMessage:"host risk data"}),Zu=N.i18n.translate("xpack.securitySolution.kpiHost.enableHostRiskText",{defaultMessage:"Enable host risk module to see more data"});var ed=a(896);const td=i.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:s,skip:r,updateDateRange:o})=>{const l=Object($s.a)(),c=l?Object(rn.D)(l):void 0,{isEnabled:u,isLicenseValid:d,isLoading:p}=Object(ed.a)(rn.u.hostsRiskScore,c);return i.a.createElement(i.a.Fragment,null,d&&!u&&!p&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Ju.c,{namespace:"hosts",condition:!0,message:{type:"primary",id:"hostRiskModule",title:Zu,description:i.a.createElement(i.a.Fragment,null,Yu," ",i.a.createElement(Kr.a,{riskScoreEntity:rn.v.host,title:Xu}),i.a.createElement(B.EuiSpacer,null))}}),i.a.createElement(B.EuiSpacer,{size:"l"})),i.a.createElement(B.EuiFlexGroup,{wrap:!0},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(_u,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:s,skip:r})),i.a.createElement(B.EuiFlexItem,{grow:2},i.a.createElement(Ku,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:s,skip:r}))))}));td.displayName="HostsKpiComponent",i.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:s,skip:r,updateDateRange:o})=>i.a.createElement(B.EuiFlexGroup,{wrap:!0},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(Ku,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:s,skip:r}))))).displayName="HostsDetailsKpiComponent";const ad=Object(n.memo)((({deleteQuery:e,filterQuery:t,pageFilters:a=[],from:s,indexNames:o,isInitializing:l,setQuery:c,to:u,type:d})=>{const p={deleteQuery:e,endDate:u,filterQuery:t,indexNames:o,skip:l||void 0===t,setQuery:c,startDate:s,type:d},m=Object(n.useMemo)((()=>[...Ln.e,...a]),[a]);return i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:`${r.Jb}/:tabName(${En.HostsTableType.hosts})`},i.a.createElement(Ss,p)),i.a.createElement(_.Route,{path:`${r.Jb}/:tabName(${En.HostsTableType.risk})`},i.a.createElement(ic,p)),i.a.createElement(_.Route,{path:`${r.Jb}/:tabName(${En.HostsTableType.uncommonProcesses})`},i.a.createElement(zs,p)),i.a.createElement(_.Route,{path:`${r.Jb}/:tabName(${En.HostsTableType.anomalies})`},i.a.createElement(vn.a,yn()({},p,{AnomaliesTableComponent:qn}))),i.a.createElement(_.Route,{path:`${r.Jb}/:tabName(${En.HostsTableType.events})`},i.a.createElement(Nn.a,yn()({},p,{pageFilters:a,timelineId:jc.c.hostsPageEvents,externalAlertPageFilters:m}))),i.a.createElement(_.Route,{path:`${r.Jb}/:tabName(${En.HostsTableType.sessions})`},i.a.createElement(Oc,p)))}));ad.displayName="HostsTabs";const nd=e=>`${r.Jb}/${e}`,id=({hasMlUserPermissions:e,isRiskyHostsEnabled:t,isEnterprise:a})=>{const n=[],i={[En.HostsTableType.hosts]:{id:En.HostsTableType.hosts,name:mo.b,href:nd(En.HostsTableType.hosts),disabled:!1},[En.HostsTableType.uncommonProcesses]:{id:En.HostsTableType.uncommonProcesses,name:mo.h,href:nd(En.HostsTableType.uncommonProcesses),disabled:!1},[En.HostsTableType.anomalies]:{id:En.HostsTableType.anomalies,name:mo.c,href:nd(En.HostsTableType.anomalies),disabled:!1},[En.HostsTableType.events]:{id:En.HostsTableType.events,name:mo.e,href:nd(En.HostsTableType.events),disabled:!1},[En.HostsTableType.risk]:{id:En.HostsTableType.risk,name:mo.f,href:nd(En.HostsTableType.risk),disabled:!1,isBeta:!0,betaOptions:{text:Cc.i}},[En.HostsTableType.sessions]:{id:En.HostsTableType.sessions,name:mo.g,href:nd(En.HostsTableType.sessions),disabled:!1,isBeta:!1}};return e||n.push(En.HostsTableType.anomalies),t||n.push(En.HostsTableType.risk),a||n.push(En.HostsTableType.sessions),Object(y.omit)(n,i)};var sd=a(464);const rd=H.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-13ka402-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),od=()=>{const e=Object(o.useDispatch)(),t=Object(n.useRef)(null),a=Object(n.useMemo)((()=>d.b.getTimelineByIdSelector()),[]),s=Object(E.b)((e=>{var t;return(null!==(t=a(e,l.i.hostsPageEvents))&&void 0!==t?t:ge.a).graphEventId})),r=Object(n.useMemo)((()=>fn.f.globalFiltersQuerySelector()),[]),c=Object(n.useMemo)((()=>fn.f.globalQuerySelector()),[]),m=Object(E.a)(c),g=Object(E.a)(r),b=Object(n.useMemo)((()=>Rn.d.hostRiskScoreSeverityFilterSelector()),[]),k=Object(E.a)((e=>b(e,Rn.b.HostsType.page))),{to:S,from:T,deleteQuery:x,setQuery:w,isInitializing:O}=Object(U.a)(),{globalFullScreen:j}=Object(de.a)(),I=Object(dn.a)(),{uiSettings:C}=Object(u.k)().services,{tabName:M}=Object(P.useParams)(),D=i.a.useMemo((()=>M===En.HostsTableType.events?g.length>0?[...g,...Ln.e]:Ln.e:M===En.HostsTableType.risk?[...Object(sd.a)(k,rn.v.host),...Ln.e,...g]:g),[k,M,g]),A=Object(n.useCallback)((({x:t})=>{if(!t)return;const[a,n]=t;e(Object(J.setAbsoluteRangeDatePicker)({id:V.a.global,from:new Date(a).toISOString(),to:new Date(n).toISOString()}))}),[e]),{indicesExist:F,indexPattern:R,selectedPatterns:_}=Object(p.d)(),[q,N]=Object(n.useMemo)((()=>Object(Ac.c)({config:Object(an.getEsQueryConfig)(C),indexPattern:R,queries:[m],filters:g})),[g,R,C,m]),[L]=Object(n.useMemo)((()=>Object(Ac.c)({config:Object(an.getEsQueryConfig)(C),indexPattern:R,queries:[m],filters:D})),[R,m,D,C]);Object(Rc.a)({id:$i,filterQuery:q,kqlError:N,query:m,startDate:T,endDate:S});const z=Object(Sc.b)().isEnterprise(),H=Object(n.useCallback)((()=>{var e,a;null===(e=t.current)||void 0===e||null===(a=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===a||a.focus()}),[t]),W=Object(n.useCallback)((()=>{Object(me.l)()}),[]),K=Object(n.useCallback)((e=>{Object($.isTab)(e)&&Object(me.k)({containerElement:t.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:H,onSkipFocusAfterEventsTable:W})}),[t,H,W]);return i.a.createElement(i.a.Fragment,null,F?i.a.createElement(rd,{onKeyDown:K,ref:t},i.a.createElement(B.EuiWindowEvent,{event:"resize",handler:y.noop}),i.a.createElement(Q.a,{show:Object(me.m)({globalFullScreen:j,graphEventId:s})},i.a.createElement(G.a,{indexPattern:R,id:V.a.global})),i.a.createElement(f.a,{noPadding:j},i.a.createElement(pe.a,{show:!j},i.a.createElement(Yt.a,{subtitle:i.a.createElement(on.a,{indexKey:rn.k.hosts,indexNames:_}),title:mo.i,border:!0}),i.a.createElement(td,{filterQuery:q,indexNames:_,from:T,setQuery:w,to:S,skip:O||!q,updateDateRange:A}),i.a.createElement(B.EuiSpacer,null),i.a.createElement(mn.a,{navTabs:id({hasMlUserPermissions:Object(un.a)(I),isRiskyHostsEnabled:I.isPlatinumOrTrialLicense,isEnterprise:z})}),i.a.createElement(B.EuiSpacer,null)),i.a.createElement(ad,{deleteQuery:x,to:S,filterQuery:L||"",isInitializing:O,indexNames:_,setQuery:w,from:T,type:Rn.b.HostsType.page,pageFilters:D}))):i.a.createElement(Xt.a,null),i.a.createElement(h.a,{pageName:v.a.hosts}))};od.displayName="HostsComponent";const ld=i.a.memo(od),cd=`${r.Jb}/name/:detailName`,ud=i.a.memo((()=>i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:`${r.Jb}/ml-hosts`},i.a.createElement(au,null)),i.a.createElement(_.Route,{path:`${r.Jb}/:tabName(${En.HostsTableType.hosts}|${En.HostsTableType.uncommonProcesses}|${En.HostsTableType.anomalies}|${En.HostsTableType.events}|${En.HostsTableType.risk}|${En.HostsTableType.sessions})`},i.a.createElement(ld,null)),i.a.createElement(_.Route,{path:`${cd}/:tabName(${En.HostsTableType.authentications}|${En.HostsTableType.uncommonProcesses}|${En.HostsTableType.anomalies}|${En.HostsTableType.events}|${En.HostsTableType.risk}|${En.HostsTableType.sessions})`,render:({match:{params:{detailName:e}}})=>i.a.createElement(Nc,{hostDetailsPagePath:cd,detailName:decodeURIComponent(e)})}),i.a.createElement(_.Route,{path:cd,render:({match:{params:{detailName:e}},location:{search:t=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${r.Jb}/name/${e}/${En.HostsTableType.authentications}`,search:t}})}),i.a.createElement(_.Route,{path:`${r.Jb}/:detailName/:tabName?`,render:({match:{params:{detailName:e,tabName:t=En.HostsTableType.authentications}},location:{search:a=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${r.Jb}/name/${e}/${t}`,search:a}})}),i.a.createElement(_.Route,{path:r.Jb,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${r.Jb}/${En.HostsTableType.hosts}`,search:e}})}))));ud.displayName="HostsContainer";const dd=[{path:r.Jb,component:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:v.a.hosts},i.a.createElement(ud,null)))}],pd=[l.i.hostsPageEvents,l.i.hostsPageSessions];var md=a(230);const gd=N.i18n.translate("xpack.securitySolution.usersTable.title",{defaultMessage:"Users"}),fd=N.i18n.translate("xpack.securitySolution.usersTable.userNameTitle",{defaultMessage:"User name"}),bd=N.i18n.translate("xpack.securitySolution.usersTable.lastSeenTitle",{defaultMessage:"Last seen"}),hd=N.i18n.translate("xpack.securitySolution.usersTable.domainTitle",{defaultMessage:"Domain"}),yd=N.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Ed=N.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),vd=e=>N.i18n.translate("xpack.securitySolution.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"});var kd=a(291);const Sd=kd.c.UsersTableType.allUsers,Td=[{text:yd,numberOfRow:5},{text:Ed,numberOfRow:10}],xd=({users:e,totalCount:t,type:a,id:s,fakeTotalCount:r,loading:l,loadPage:c,showMorePagesIndicator:u,sort:d,setQuerySkip:p})=>{const m=Object(o.useDispatch)(),g=Object(n.useMemo)((()=>kd.e.allUsersSelector()),[]),{activePage:f,limit:b}=Object(E.a)((e=>g(e))),h=Object(n.useCallback)((e=>{m(kd.b.updateTableLimit({usersType:a,limit:e,tableType:Sd}))}),[a,m]),y=Object(n.useCallback)((e=>{m(kd.b.updateTableActivePage({activePage:e,usersType:a,tableType:Sd}))}),[a,m]),v=Object(n.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===d.direction&&t.field===d.field||m(kd.b.updateTableSorting({sort:t,tableType:Sd}))}}),[m,d]),k=Object(n.useMemo)((()=>[{field:"name",name:fd,truncateText:!1,sortable:!0,mobileOptions:{show:!0},render:e=>null!=e&&e.length>0?Object(Tn.c)({rowItems:[e],attrName:"user.name",idPrefix:`users-table-${e}-name`,render:e=>i.a.createElement(ue.m,{userName:e}),isAggregatable:!0,fieldType:"keyword"}):Object(ri.f)(e)},{field:"lastSeen",name:bd,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>i.a.createElement(Ba.b,{value:e})},{field:"domain",name:hd,sortable:!1,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e&&e.length>0?Object(Tn.c)({rowItems:[e],attrName:"user.domain",idPrefix:`users-table-${e}-domain`,isAggregatable:!0,fieldType:"keyword"}):Object(ri.f)(e)}]),[]);return i.a.createElement(Hn.a,{activePage:f,columns:k,dataTestSubj:`table-${Sd}`,headerCount:t,headerTitle:gd,headerUnit:vd(t),id:s,itemsPerRow:Td,limit:b,loading:l,loadPage:c,pageOfItems:e,showMorePagesIndicator:u,totalCount:r,updateLimitPagination:h,updateActivePage:y,sorting:d,onChange:v,setQuerySkip:p})};xd.displayName="UsersTableComponent";const wd=i.a.memo(xd);var Od=a(109);const jd=N.i18n.translate("xpack.securitySolution.userTab.errorFetchingsData",{defaultMessage:"Failed to query users data"}),Id=Object(Pi.a)(wd),Cd="UsersTable",Md=({endDate:e,filterQuery:t,indexNames:a,skip:s,setQuery:r,startDate:o,type:l,deleteQuery:c})=>{const{toggleStatus:u}=Object(zt.a)(Cd),[d,p]=Object(n.useState)(s||!u);Object(n.useEffect)((()=>{p(s||!u)}),[s,u]);const m=Object(n.useMemo)((()=>kd.e.allUsersSelector()),[]),{activePage:g,limit:f,sort:b}=Object(E.a)((e=>m(e))),{loading:h,result:{users:v,pageInfo:k,totalCount:S},search:T,refetch:x,inspect:w}=Object(Fi.a)({factoryQueryType:Od.b.users,initialResult:{users:[],totalCount:0,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:jd,abort:d});return Object(n.useEffect)((()=>{d||T({filterQuery:t,defaultIndex:a,timerange:{interval:"12h",from:o,to:e},pagination:Object(Di.a)(g,f),sort:b})}),[T,o,e,t,a,d,g,f,b]),i.a.createElement(Id,{users:v,deleteQuery:c,fakeTotalCount:Object(y.getOr)(50,"fakeTotalCount",k),id:Cd,inspect:w,loading:h,loadPage:y.noop,refetch:x,showMorePagesIndicator:Object(y.getOr)(!1,"showMorePagesIndicator",k),setQuery:r,totalCount:S,type:l,sort:b,setQuerySkip:p})};Md.displayName="AllUsersQueryTabBody";var Dd=a(123);const Ad="authenticationsUsersTableQuery",Fd=({endDate:e,filterQuery:t,indexNames:a,skip:s,startDate:r,type:l,setQuery:c,deleteQuery:u,userName:d})=>{const p=Object(o.useDispatch)(),{toggleStatus:m}=Object(zt.a)(Ad),[g,f]=Object(n.useState)(s||!m);Object(n.useEffect)((()=>{f(s||!m)}),[s,m]);const b=Object(n.useMemo)((()=>kd.e.authenticationsSelector()),[]),{activePage:h,limit:v}=Object(E.a)((e=>b(e))),[k,{authentications:S,totalCount:T,pageInfo:x,loadPage:w,inspect:O,isInspected:j,refetch:I}]=Ri({endDate:e,filterQuery:t,indexNames:a,skip:g,startDate:r,activePage:h,limit:v,stackByField:d?Dd.a.hostName:Dd.a.userName}),C=Object(n.useMemo)((()=>d?[vi,ki,pi,mi,gi,bi,hi]:ui()),[d]),M=Object(n.useCallback)((e=>p(kd.b.updateTableLimit({usersType:l,limit:e,tableType:kd.c.UsersTableType.authentications}))),[l,p]),D=Object(n.useCallback)((e=>p(kd.b.updateTableActivePage({activePage:e,usersType:l,tableType:kd.c.UsersTableType.authentications}))),[l,p]);return Object(Pi.b)({queryId:Ad,loading:k,refetch:I,setQuery:c,deleteQuery:u,inspect:O}),i.a.createElement(Hn.a,{activePage:h,columns:C,dataTestSubj:"table-users-authentications",headerCount:T,headerTitle:$n,headerUnit:d?Un(T):Vn(T),id:Ad,isInspect:j,itemsPerRow:di,limit:v,loading:k,loadPage:w,pageOfItems:S,setQuerySkip:f,showMorePagesIndicator:Object(y.getOr)(!1,"showMorePagesIndicator",x),totalCount:Object(y.getOr)(50,"fakeTotalCount",x),updateLimitPagination:M,updateActivePage:D})};Fd.displayName="AuthenticationsUserTableComponent";const Rd=i.a.memo(Fd),Pd=({endDate:e,filterQuery:t,indexNames:a,skip:n,setQuery:s,startDate:r,type:o,deleteQuery:l,userName:c})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(zn.a,yn()({endDate:e,filterQuery:t,id:"usersAuthenticationsHistogramQuery",indexNames:a,setQuery:s,startDate:r},Oi)),i.a.createElement(Rd,{endDate:e,filterQuery:t,indexNames:a,setQuery:s,deleteQuery:l,startDate:r,type:o,skip:n,userName:c}));Pd.displayName="AllUsersQueryTabBody";var _d=a(574);const qd=(e,t)=>"user.name"===e.entityName&&(null==t||e.entityValue===t),Nd={sort:{field:"anomaly.severity",direction:"desc"}},Ld=({startDate:e,endDate:t,userName:a,skip:s,type:r})=>{const l=Object(o.useDispatch)(),c=Object(dn.a)(),{toggleStatus:u,setToggleStatus:d}=Object(zt.a)("AnomaliesUserTable"),[p,m]=Object(n.useState)(s||!u);Object(n.useEffect)((()=>{m(s||!u)}),[s,u]);const g=Object(n.useCallback)((e=>{d(e),m(!e)}),[m,d]),{jobIds:f,loading:b}=Object(Dn.b)(),h=Object(n.useMemo)((()=>kd.e.usersAnomaliesJobIdFilterSelector()),[]),y=Object(E.a)((e=>h(e,r))),v=Object(n.useCallback)((e=>{l(kd.b.updateUsersAnomaliesJobIdFilter({jobIds:e,usersType:r}))}),[l,r]),k=Object(n.useMemo)((()=>kd.e.usersAnomaliesIntervalSelector()),[]),S=Object(E.a)((e=>k(e,r))),T=Object(n.useCallback)((e=>{l(kd.b.updateUsersAnomaliesInterval({interval:e,usersType:r}))}),[l,r]),[x,w]=Object(kn.a)({startDate:e,endDate:t,skip:p,criteriaFields:Object(_d.a)(r,a),filterQuery:{exists:{field:"user.name"}},jobIds:y.length>0?y:f,aggregationInterval:S}),O=((e,t)=>null==e?[]:e.anomalies.reduce(((e,a)=>{if(qd(a,t))return[...e,{userName:a.entityValue,anomaly:a}];{const n=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(On.a)(e);return"user.name"===a&&(null==t||n===t)}));return null!=a?Object.values(a)[0]:null})(a.influencers,t);return null!=n?[...e,{userName:n,anomaly:a}]:e}}),[]))(w,a),j=((e,t,a)=>{const n=((e,t)=>[{name:Sn.s,field:"userName",sortable:!0,render:(e,t)=>Object(Tn.b)({rowItem:e,attrName:"user.name",idPrefix:`anomalies-user-table-userName-${Object(xn.a)(t.anomaly)}-userName`,render:e=>i.a.createElement(ue.m,{userName:e}),isAggregatable:!0,fieldType:"keyword"})},...Object(wn.a)(e,t)])(t,a);return e===md.UsersType.details?n.filter((e=>e.name!==Sn.s)):n})(r,e,t),I={initialPageIndex:0,initialPageSize:10,totalItemCount:O.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(un.a)(c)?i.a.createElement(Mn.a,{loading:x||b,"data-test-subj":"user-anomalies-tab"},i.a.createElement(Tt.a,{subtitle:`${Sn.o}: ${I.totalItemCount.toLocaleString()} ${Sn.r(I.totalItemCount)}`,title:Sn.a,toggleQuery:g,toggleStatus:u,tooltip:Sn.q,isInspectDisabled:s,headerFilters:i.a.createElement(B.EuiFlexGroup,null,i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Fn.a,{interval:S,onChange:T})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(An.a,{title:Sn.l,onSelect:v,selectedJobIds:y,jobIds:f})))}),u&&i.a.createElement(In.a,{"data-test-subj":"user-anomalies-table",columns:j,items:O,pagination:I,sorting:Nd}),(x||b)&&i.a.createElement(ba.a,{"data-test-subj":"anomalies-user-table-loading-panel",overlay:!0,size:"xl"})):null},Bd=i.a.memo(Ld),zd=N.i18n.translate("xpack.securitySolution.usersRiskTable.userNameTitle",{defaultMessage:"User Name"}),Hd=N.i18n.translate("xpack.securitySolution.usersRiskTable.userRiskScoreTitle",{defaultMessage:"User risk score"}),$d=N.i18n.translate("xpack.securitySolution.usersRiskTable.userRiskToolTip",{defaultMessage:"User risk classification is determined by user risk score. Users classified as Critical or High are indicated as risky."}),Vd=N.i18n.translate("xpack.securitySolution.usersRiskTable.riskTitle",{defaultMessage:"User risk classification"}),Ud=e=>N.i18n.translate("xpack.securitySolution.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),Qd=N.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Wd=N.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Gd=N.i18n.translate("xpack.securitySolution.hostsRiskTable.usersTableTooltip",{defaultMessage:"The user risk table is not affected by the KQL time range. This table shows the latest recorded risk score for each user."});var Kd=a(449);const Jd=[{text:Qd,numberOfRow:5},{text:Wd,numberOfRow:10}],Yd=kd.c.UsersTableType.risk,Xd=({data:e,id:t,isInspect:a,loading:s,loadPage:r,setQuerySkip:l,severityCount:c,totalCount:u,type:d})=>{const p=Object(o.useDispatch)(),m=Object(n.useMemo)((()=>kd.e.userRiskScoreSelector()),[]),{activePage:g,limit:f,sort:b}=Object(E.a)((e=>m(e))),h=Object(n.useCallback)((e=>{p(kd.b.updateTableLimit({usersType:d,limit:e,tableType:Yd}))}),[d,p]),y=Object(n.useCallback)((e=>{p(kd.b.updateTableActivePage({activePage:e,usersType:d,tableType:Yd}))}),[d,p]),v=Object(n.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===b.direction&&t.field===b.field||p(kd.b.updateTableSorting({sort:t,tableType:Yd}))}}),[p,b]),k=Object(n.useCallback)((e=>{p(kd.b.updateUserRiskScoreSeverityFilter({severitySelection:[e]}))}),[p]),S=Object(n.useMemo)((()=>(({dispatchSeverityUpdate:e})=>[{field:"user.name",name:zd,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e&&e.length>0){const t=Object(Ze.h)(`user-risk-score-table-userName-${e}`);return i.a.createElement(Vi.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e,kqlQuery:"",queryMatch:{field:"user.name",value:e,operator:Ui.c}},render:(t,a,n)=>n.isDragging?i.a.createElement(Vi.a,null,i.a.createElement(Qi.a,{dataProvider:t})):i.a.createElement(ue.m,{userName:e,userTab:md.UsersTableType.risk}),isAggregatable:!0,fieldType:"keyword"})}return Object(ri.d)()}},{field:rn.w.userRiskScore,name:Hd,truncateText:!0,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e?i.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},e.toFixed(2)):Object(ri.d)()},{field:rn.w.userRisk,name:i.a.createElement(B.EuiToolTip,{content:$d},i.a.createElement(i.a.Fragment,null,Vd," ",i.a.createElement(B.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:t=>{return null!=t?i.a.createElement(ps.b,{toolTipContent:i.a.createElement(B.EuiLink,{onClick:()=>e(t)},i.a.createElement(B.EuiText,{size:"xs"},(a=t.toLowerCase(),N.i18n.translate("xpack.securitySolution.usersRiskTable.filteredUsersTitle",{values:{severity:a},defaultMessage:"View {severity} risk users"})))),severity:t}):Object(ri.d)();var a}}])({dispatchSeverityUpdate:k})),[k]),T=i.a.createElement(B.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Gl,{severityCount:c})),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Yl,{severityCount:c}))),x=Object(n.useMemo)((()=>kd.e.userRiskScoreSeverityFilterSelector()),[]),w=Object(E.a)((e=>x(e))),O=Object(n.useCallback)((e=>{p(kd.b.updateUserRiskScoreSeverityFilter({severitySelection:e}))}),[p]);return i.a.createElement(Hn.a,{activePage:g,columns:S,dataTestSubj:`table-${Yd}`,headerCount:u,headerFilters:i.a.createElement(Xl,{selectedSeverities:w,severityCount:c,title:Vd,onSelect:O}),headerSupplement:T,headerTitle:Kd.e,headerTooltip:Gd,headerUnit:Ud(u),id:t,isInspect:a,itemsPerRow:Jd,limit:f,loading:s,loadPage:r,onChange:v,pageOfItems:e,setQuerySkip:l,showMorePagesIndicator:!1,sorting:b,split:!0,stackHeader:!0,totalCount:u,updateLimitPagination:h,updateActivePage:y})};Xd.displayName="UserRiskScoreTableComponent";const Zd=i.a.memo(Xd);Zd.displayName="UserRiskScoreTable";const ep=({refetch:e,timerange:t})=>{const{signalIndexExists:a}=io();return i.a.createElement(B.EuiPanel,{hasBorder:!0},i.a.createElement(Tt.a,{title:i.a.createElement(uo.a,{riskScoreEntity:rn.v.user}),titleSize:"s"}),i.a.createElement(B.EuiEmptyPrompt,{title:i.a.createElement("h2",null,Pl),body:i.a.createElement(i.a.Fragment,null,_l," ",i.a.createElement(Kr.a,{riskScoreEntity:rn.v.user})),actions:i.a.createElement(B.EuiToolTip,{content:a?null:Rl},i.a.createElement(Dl,{disabled:!a,refetch:e,riskScoreEntity:rn.v.user,timerange:t}))}))},tp=i.a.memo(ep);tp.displayName="EntityAnalyticsUserRiskScoreDisable";const ap=Object(Pi.a)(Zd),np=({filterQuery:e,skip:t,setQuery:a,type:s,deleteQuery:r})=>{const o=Object(n.useMemo)((()=>kd.e.userRiskScoreSelector()),[]),{activePage:l,limit:c,sort:u}=Object(E.a)((e=>o(e))),d=Object(n.useMemo)((()=>kd.e.userRiskScoreSeverityFilterSelector()),[]),p=Object(E.a)((e=>d(e))),m=Object(n.useMemo)((()=>({cursorStart:l*c,querySize:c})),[l,c]),{from:g,to:f}=Object(U.a)(),{toggleStatus:b}=Object(zt.a)(Io.b.USERS_BY_RISK),[h,v]=Object(n.useState)(t||!b);Object(n.useEffect)((()=>{v(t||!b)}),[t,b]);const k=Object(n.useMemo)((()=>({from:g,to:f})),[g,f]),[S,{data:T,totalCount:x,inspect:w,isInspected:O,isDeprecated:j,refetch:I,isModuleEnabled:C}]=Object(Io.e)({filterQuery:e,skip:h,pagination:m,sort:u,timerange:k}),{severityCount:M,loading:D}=Object(Io.f)({filterQuery:e,skip:h});return C||S?j&&!S?i.a.createElement(po,{entityType:rn.v.user,refetch:I,timerange:k}):C&&0===p.length&&T&&0===T.length?i.a.createElement($l,{entityType:rn.v.user,refetch:I}):i.a.createElement(ap,{deleteQuery:r,data:null!=T?T:[],id:Io.b.USERS_BY_RISK,inspect:w,isInspect:O,loading:S||D,loadPage:y.noop,refetch:I,setQuery:a,setQuerySkip:v,severityCount:null!=M?M:rn.c,totalCount:x,type:s}):i.a.createElement(tp,{refetch:I,timerange:k})};np.displayName="UserRiskScoreQueryTabBody";const ip=Object(n.memo)((({deleteQuery:e,filterQuery:t,pageFilters:a,from:n,indexNames:s,isInitializing:o,setQuery:l,to:c,type:u})=>{const d={deleteQuery:e,endDate:c,filterQuery:t,indexNames:s,skip:o||void 0===t,setQuery:l,startDate:n,type:u};return i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:`${r.Fc}/:tabName(${md.UsersTableType.allUsers})`},i.a.createElement(Md,d)),i.a.createElement(_.Route,{path:`${r.Fc}/:tabName(${md.UsersTableType.authentications})`},i.a.createElement(Pd,d)),i.a.createElement(_.Route,{path:`${r.Fc}/:tabName(${md.UsersTableType.anomalies})`},i.a.createElement(vn.a,yn()({},d,{AnomaliesTableComponent:Bd}))),i.a.createElement(_.Route,{path:`${r.Fc}/:tabName(${md.UsersTableType.risk})`},i.a.createElement(np,d)),i.a.createElement(_.Route,{path:`${r.Fc}/:tabName(${md.UsersTableType.events})`},i.a.createElement(Nn.a,yn()({},d,{pageFilters:a,timelineId:jc.c.usersPageEvents}))))}));ip.displayName="UsersTabs";const sp=e=>`${r.Fc}/${e}`,rp={title:"[Host] User authentications - area ",description:"",visualizationType:"lnsXY",state:{visualization:{axisTitlesVisibilitySettings:{x:!0,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["0eb97c09-a351-4280-97da-944e4bd30dd7"],layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data",seriesType:"area",xAccessor:"49a42fe6-ebe8-4adb-8eed-1966a5297b7e",yConfig:[{color:"#54b399",forAccessor:"0eb97c09-a351-4280-97da-944e4bd30dd7"}]},{accessors:["2b27c80e-a20d-46f1-8fb2-79626ef4563c"],layerId:"31213ae3-905b-4e88-b987-0cccb1f3209f",layerType:"data",seriesType:"area",xAccessor:"33a6163d-0c0a-451d-aa38-8ca6010dd5bf",yConfig:[{color:"#e7664c",forAccessor:"2b27c80e-a20d-46f1-8fb2-79626ef4563c"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{indexpattern:{layers:{"31213ae3-905b-4e88-b987-0cccb1f3209f":{columnOrder:["33a6163d-0c0a-451d-aa38-8ca6010dd5bf","2b27c80e-a20d-46f1-8fb2-79626ef4563c"],columns:{"2b27c80e-a20d-46f1-8fb2-79626ef4563c":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome: "failure" '},isBucketed:!1,label:oi.h,operationType:"count",scale:"ratio",sourceField:"___records___"},"33a6163d-0c0a-451d-aa38-8ca6010dd5bf":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}},"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["49a42fe6-ebe8-4adb-8eed-1966a5297b7e","0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome : "success" '},isBucketed:!1,label:oi.m,operationType:"count",scale:"ratio",sourceField:"___records___"},"49a42fe6-ebe8-4adb-8eed-1966a5297b7e":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-31213ae3-905b-4e88-b987-0cccb1f3209f"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]},op={title:"[Host] User authentications - bar ",description:"",visualizationType:"lnsXY",state:{visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["938b445a-a291-4bbc-84fe-4f47b69c20e4"],layerId:"31213ae3-905b-4e88-b987-0cccb1f3209f",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"430e690c-9992-414f-9bce-00812d99a5e7",yConfig:[]},{accessors:["c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"],layerId:"b9acd453-f476-4467-ad38-203e37b73e55",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"e959c351-a3a2-4525-b244-9623f215a8fd",yConfig:[{color:"#e7664c",forAccessor:"c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"bar_horizontal_stacked",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{indexpattern:{layers:{"31213ae3-905b-4e88-b987-0cccb1f3209f":{columnOrder:["430e690c-9992-414f-9bce-00812d99a5e7","938b445a-a291-4bbc-84fe-4f47b69c20e4"],columns:{"430e690c-9992-414f-9bce-00812d99a5e7":{dataType:"string",isBucketed:!0,label:"Filters",operationType:"filters",params:{filters:[{input:{language:"kuery",query:'event.outcome : "success" '},label:oi.m}]},scale:"ordinal"},"938b445a-a291-4bbc-84fe-4f47b69c20e4":{dataType:"number",isBucketed:!1,label:oi.m,operationType:"count",scale:"ratio",sourceField:"___records___"}},incompleteColumns:{}},"b9acd453-f476-4467-ad38-203e37b73e55":{columnOrder:["e959c351-a3a2-4525-b244-9623f215a8fd","c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"],columns:{"c8165fc3-7180-4f1b-8c87-bc3ea04c6df7":{dataType:"number",isBucketed:!1,label:"Fail",operationType:"count",scale:"ratio",sourceField:"___records___"},"e959c351-a3a2-4525-b244-9623f215a8fd":{customLabel:!0,dataType:"string",isBucketed:!0,label:oi.h,operationType:"filters",params:{filters:[{input:{language:"kuery",query:'event.outcome:"failure" '},label:oi.h}]},scale:"ordinal"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-31213ae3-905b-4e88-b987-0cccb1f3209f"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-b9acd453-f476-4467-ad38-203e37b73e55"}]},lp=N.i18n.translate("xpack.securitySolution.usersKpiAuthentications.errorSearchDescription",{defaultMessage:"An error has occurred on users kpi authentications search"}),cp=N.i18n.translate("xpack.securitySolution.usersKpiAuthentications.failSearchDescription",{defaultMessage:"Failed to run search on users kpi authentications"}),up="usersKpiAuthenticationsQuery",dp=N.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.title",{defaultMessage:"User authentications"}),pp=N.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successUnitLabel",{defaultMessage:"success"}),mp=N.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failUnitLabel",{defaultMessage:"fail"}),gp=N.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),fp=N.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failChartLabel",{defaultMessage:"Fail"});var bp;!function(e){e.authenticationsSuccess="#54B399",e.authenticationsFailure="#E7664C"}(bp||(bp={}));const hp=[{key:"authentication",fields:[{key:"authenticationsSuccess",name:gp,description:pp,value:null,color:bp.authenticationsSuccess,icon:"check",lensAttributes:{title:"[Host] User authentications - metric success ",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{accessor:"0eb97c09-a351-4280-97da-944e4bd30dd7",layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data"},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{indexpattern:{layers:{"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome : "success" '},isBucketed:!1,label:" ",operationType:"count",scale:"ratio",sourceField:"___records___"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]}},{key:"authenticationsFailure",name:fp,description:mp,value:null,color:bp.authenticationsFailure,icon:"cross",lensAttributes:{title:"[Host] User authentications - metric failure ",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{accessor:"0eb97c09-a351-4280-97da-944e4bd30dd7",layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data"},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{indexpattern:{layers:{"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{dataType:"number",filter:{language:"kuery",query:'event.outcome : "failure" '},isBucketed:!1,label:"",operationType:"count",scale:"ratio",sourceField:"___records___"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]}}],enableAreaChart:!0,enableBarChart:!0,description:dp,areaChartLensAttributes:rp,barChartLensAttributes:op}],yp=({filterQuery:e,from:t,indexNames:a,to:s,updateDateRange:r,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(zt.a)(up),[d,p]=Object(n.useState)(l||!c);Object(n.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:s})=>{const{data:r}=Object(u.k)().services,o=Object(n.useRef)(y.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new iu.Subscription),[d,p]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[f,b]=Object(n.useState)({authenticationsSuccess:0,authenticationsSuccessHistogram:[],authenticationsFailure:0,authenticationsFailureHistogram:[],id:up,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:E}=Object(ma.a)(),v=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=r.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(p(!1),E(lp),c.current.unsubscribe()):(p(!1),b((t=>({...t,authenticationsSuccess:e.authenticationsSuccess,authenticationsSuccessHistogram:e.authenticationsSuccessHistogram,authenticationsFailure:e.authenticationsFailure,authenticationsFailureHistogram:e.authenticationsFailureHistogram,inspect:Object(ou.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:cp}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[r.search,h,E,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rn.A.kpiAuthentications,filterQuery:Object(Mi.a)(e),timerange:{interval:"12h",from:s,to:t}};return Ii()(n,i)?n:i}))}),[a,t,e,s]),Object(n.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(n.useEffect)((()=>{i&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[d,f]})({filterQuery:e,endDate:s,indexNames:a,startDate:t,skip:d});return i.a.createElement(Du,{data:h,id:f,inspect:b,loading:m,fieldsMapping:hp,from:t,to:s,updateDateRange:r,refetch:g,setQuery:o,setQuerySkip:p})};yp.displayName="UsersKpiAuthenticationsComponent";const Ep=i.a.memo(yp),vp={description:"",state:{datasourceStates:{indexpattern:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["5eea817b-67b7-4268-8ecb-7688d1094721","b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"5eea817b-67b7-4268-8ecb-7688d1094721":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:Object(oi.o)("user.name"),operationType:"unique_count",scale:"ratio",sourceField:"user.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data",seriesType:"area",xAccessor:"5eea817b-67b7-4268-8ecb-7688d1094721"}],legend:{isVisible:!0,position:"right"},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[User] Users - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]},kp=N.i18n.translate("xpack.securitySolution.kpiUsers.totalUsers.title",{defaultMessage:"Users"}),Sp=N.i18n.translate("xpack.securitySolution.kpiUsers.totalUsers.errorSearchDescription",{defaultMessage:"An error has occurred on total users kpi search"}),Tp=[{key:"users",fields:[{key:"users",value:null,color:Object(B.euiPaletteColorBlind)()[1],icon:"storage",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["3e51b035-872c-4b44-824b-fe069c222e91"],columns:{"3e51b035-872c-4b44-824b-fe069c222e91":{dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"user.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"3e51b035-872c-4b44-824b-fe069c222e91",layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data"}},title:"[User] Users - metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]}}],enableAreaChart:!0,description:kp,areaChartLensAttributes:vp}],xp="TotalUsersKpiQuery",wp=({filterQuery:e,from:t,indexNames:a,to:s,updateDateRange:r,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(zt.a)(xp),[u,d]=Object(n.useState)(l||!c);Object(n.useEffect)((()=>{d(l||!c)}),[l,c]);const{loading:p,result:m,search:g,refetch:f,inspect:b}=Object(Fi.a)({factoryQueryType:Od.b.kpiTotalUsers,initialResult:{users:0,usersHistogram:[]},errorMessage:Sp,abort:u});return Object(n.useEffect)((()=>{u||g({filterQuery:e,defaultIndex:a,timerange:{interval:"12h",from:t,to:s}})}),[g,t,s,e,a,u]),i.a.createElement(Du,{data:m,id:xp,inspect:b,loading:p,fieldsMapping:Tp,from:t,to:s,updateDateRange:r,refetch:f,setQuery:o,setQuerySkip:d})},Op=i.a.memo(wp),jp=N.i18n.translate("xpack.securitySolution.kpiUser.enableUserRiskText",{defaultMessage:"Enable user risk module to see more data"}),Ip=N.i18n.translate("xpack.securitySolution.kpiUser.learnMore",{defaultMessage:"Learn more about"}),Cp=N.i18n.translate("xpack.securitySolution.kpiUser.userRiskData",{defaultMessage:"user risk data"}),Mp=i.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:s,skip:r,updateDateRange:o})=>{const l=Object($s.a)(),c=l?Object(rn.E)(l):void 0,{isEnabled:u,isLicenseValid:d,isLoading:p}=Object(ed.a)(rn.u.usersRiskScore,c);return i.a.createElement(i.a.Fragment,null,d&&!u&&!p&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Ju.c,{namespace:"users",condition:!0,message:{type:"primary",id:"userRiskModule",title:jp,description:i.a.createElement(i.a.Fragment,null,Ip," ",i.a.createElement(Kr.a,{riskScoreEntity:rn.v.user,title:Cp}),i.a.createElement(B.EuiSpacer,null))}}),i.a.createElement(B.EuiSpacer,{size:"l"})),i.a.createElement(B.EuiFlexGroup,{wrap:!0},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(Op,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:s,skip:r})),i.a.createElement(B.EuiFlexItem,{grow:2},i.a.createElement(Ep,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:s,skip:r}))))}));Mp.displayName="UsersKpiComponent";const Dp=[{query:{bool:{filter:[{bool:{should:[{exists:{field:"user.name"}}],minimum_should_match:1}}]}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "user.name"}}],"minimum_should_match": 1}}]}}}'}}],Ap=H.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-1ndcmza-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),Fp=()=>{const e=Object(o.useDispatch)(),t=Object(n.useRef)(null),a=Object(n.useMemo)((()=>fn.f.globalFiltersQuerySelector()),[]),s=Object(n.useMemo)((()=>fn.f.globalQuerySelector()),[]),r=Object(E.a)(s),l=Object(E.a)(a),c=Object(n.useMemo)((()=>kd.e.userRiskScoreSeverityFilterSelector()),[]),d=Object(E.a)((e=>c(e))),{to:m,from:g,deleteQuery:b,setQuery:k,isInitializing:S}=Object(U.a)(),{globalFullScreen:T}=Object(de.a)(),{uiSettings:x}=Object(u.k)().services,{tabName:w}=Object(P.useParams)(),O=i.a.useMemo((()=>w===md.UsersTableType.events?l.length>0?[...l,...Dp]:Dp:w===md.UsersTableType.risk?[...Object(sd.a)(d,rn.v.user),...l]:l),[d,w,l]),{indicesExist:j,indexPattern:I,selectedPatterns:C}=Object(p.d)(),[M,D]=Object(n.useMemo)((()=>Object(Ac.c)({config:Object(an.getEsQueryConfig)(x),indexPattern:I,queries:[r],filters:l})),[l,I,x,r]),[A]=Object(n.useMemo)((()=>Object(Ac.c)({config:Object(an.getEsQueryConfig)(x),indexPattern:I,queries:[r],filters:O})),[I,r,O,x]);Object(Rc.a)({id:"UsersQueryId",filterQuery:M,kqlError:D,query:r,startDate:g,endDate:m});const F=Object(n.useCallback)((()=>{var e,a;null===(e=t.current)||void 0===e||null===(a=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===a||a.focus()}),[t]),R=Object(n.useCallback)((()=>{Object(me.l)()}),[]),_=Object(n.useCallback)((e=>{Object($.isTab)(e)&&Object(me.k)({containerElement:t.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:F,onSkipFocusAfterEventsTable:R})}),[t,F,R]),q=Object(n.useCallback)((({x:t})=>{if(!t)return;const[a,n]=t;e(Object(J.setAbsoluteRangeDatePicker)({id:V.a.global,from:new Date(a).toISOString(),to:new Date(n).toISOString()}))}),[e]),N=Object(dn.a)(),L=Object(dn.a)().isPlatinumOrTrialLicense,z=Object(n.useMemo)((()=>((e,t)=>{const a=[],n={[md.UsersTableType.allUsers]:{id:md.UsersTableType.allUsers,name:Kd.a,href:sp(md.UsersTableType.allUsers),disabled:!1},[md.UsersTableType.authentications]:{id:md.UsersTableType.authentications,name:Kd.c,href:sp(md.UsersTableType.authentications),disabled:!1},[md.UsersTableType.anomalies]:{id:md.UsersTableType.anomalies,name:Kd.b,href:sp(md.UsersTableType.anomalies),disabled:!1},[md.UsersTableType.events]:{id:md.UsersTableType.events,name:Kd.d,href:sp(md.UsersTableType.events),disabled:!1},[md.UsersTableType.risk]:{id:md.UsersTableType.risk,name:Kd.e,href:sp(md.UsersTableType.risk),disabled:!1,isBeta:!0,betaOptions:{text:Cc.i}}};return e||a.push(md.UsersTableType.anomalies),t||a.push(md.UsersTableType.risk),Object(y.omit)(a,n)})(Object(un.a)(N),L)),[N,L]);return i.a.createElement(i.a.Fragment,null,j?i.a.createElement(Ap,{onKeyDown:_,ref:t},i.a.createElement(B.EuiWindowEvent,{event:"resize",handler:y.noop}),i.a.createElement(Q.a,null,i.a.createElement(G.a,{indexPattern:I,id:V.a.global})),i.a.createElement(f.a,{noPadding:T},i.a.createElement(Yt.a,{subtitle:i.a.createElement(on.a,{indexKey:rn.k.users,indexNames:C}),border:!0,title:Kd.f}),i.a.createElement(Mp,{filterQuery:M,indexNames:C,from:g,setQuery:k,to:m,skip:S||!M,updateDateRange:q}),i.a.createElement(B.EuiSpacer,null),i.a.createElement(mn.a,{navTabs:z}),i.a.createElement(B.EuiSpacer,null),i.a.createElement(ip,{deleteQuery:b,filterQuery:A||"",from:g,indexNames:C,isInitializing:S,setQuery:k,to:m,type:kd.c.UsersType.page,pageFilters:O}))):i.a.createElement(Xt.a,null),i.a.createElement(h.a,{pageName:v.a.users}))};Fp.displayName="UsersComponent";const Rp=i.a.memo(Fp);var Pp=a(440);const _p=`${r.Fc}/name/:detailName`,qp=`${r.Fc}/:tabName(${md.UsersTableType.allUsers}|${md.UsersTableType.authentications}|${md.UsersTableType.anomalies}|${md.UsersTableType.risk}|${md.UsersTableType.events}|)`,Np=`${_p}/:tabName(${md.UsersTableType.authentications}|${md.UsersTableType.anomalies}|${md.UsersTableType.events}|${md.UsersTableType.risk})`,Lp=N.i18n.translate("xpack.securitySolution.users.userRiskInformation.classificationHeader",{defaultMessage:"Classification"}),Bp=N.i18n.translate("xpack.securitySolution.users.userRiskInformation.riskHeader",{defaultMessage:"User risk score range"}),zp=N.i18n.translate("xpack.securitySolution.users.userRiskInformation.unknownRiskDescription",{defaultMessage:"Less than 20"}),Hp=N.i18n.translate("xpack.securitySolution.users.userRiskInformation.criticalRiskDescription",{defaultMessage:"90 and above"}),$p=N.i18n.translate("xpack.securitySolution.users.userRiskInformation.title",{defaultMessage:"How is user risk calculated?"}),Vp=N.i18n.translate("xpack.securitySolution.users.userRiskInformation.introduction",{defaultMessage:"The User Risk Score capability surfaces risky users from within your environment."}),Up=N.i18n.translate("xpack.securitySolution.users.userRiskInformation.explanation",{defaultMessage:'This feature utilizes a transform, with a scripted metric aggregation to calculate user risk scores based on detection rule alerts with an "open" status, within a 5 day time window. The transform runs hourly to keep the score updated as new detection rule alerts stream in.'}),Qp=N.i18n.translate("xpack.securitySolution.users.userRiskInformation.closeBtn",{defaultMessage:"Close"}),Wp=N.i18n.translate("xpack.securitySolution.users.userRiskInformation.buttonLabel",{defaultMessage:"How is risk score calculated?"}),Gp=[{field:"classification",name:Lp,render:e=>{if(null!=e)return i.a.createElement(ps.b,{severity:e,hideBackgroundColor:!0})}},{field:"range",name:Bp}],Kp=[{classification:rn.x.critical,range:Hp},{classification:rn.x.high,range:"70 - 90 "},{classification:rn.x.moderate,range:"40 - 70"},{classification:rn.x.low,range:"20 - 40"},{classification:rn.x.unknown,range:zp}],Jp=()=>{const[e,t,a]=To();return i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiButtonEmpty,{onClick:t,"data-test-subj":"open-risk-information-flyout-trigger"},Wp),e&&i.a.createElement(Yp,{handleOnClose:a}))},Yp=({handleOnClose:e})=>{const t=Object(B.useGeneratedHtmlId)({prefix:"UserRiskInformation"});return i.a.createElement(B.EuiFlyout,{ownFocus:!0,onClose:e,"aria-labelledby":t,size:450,"data-test-subj":"open-risk-information-flyout"},i.a.createElement(B.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(B.EuiTitle,{size:"m"},i.a.createElement("h2",{id:t},$p))),i.a.createElement(B.EuiFlyoutBody,null,i.a.createElement(B.EuiText,{size:"s"},i.a.createElement("p",null,Vp),i.a.createElement("p",null,Up)),i.a.createElement(B.EuiSpacer,null),i.a.createElement(B.EuiBasicTable,{columns:Gp,items:Kp,"data-test-subj":"risk-information-table"}),i.a.createElement(B.EuiSpacer,{size:"l"}),i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.users.userRiskInformation.learnMore",defaultMessage:"You can learn more about user risk {UserRiskScoreDocumentationLink}",values:{UserRiskScoreDocumentationLink:i.a.createElement(Kr.a,{riskScoreEntity:rn.v.user,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.users.userRiskInformation.link",defaultMessage:"here"})})}})),i.a.createElement(B.EuiFlyoutFooter,null,i.a.createElement(B.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{onClick:e},Qp)))))},Xp=Io.b.USER_DETAILS_RISK_SCORE,Zp=H()(B.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-npiiwf-0"})(["margin-top:",";"],(({theme:e})=>e.eui.euiSizeL)),em=({userName:e,startDate:t,endDate:a,setQuery:s,deleteQuery:r})=>{const{buttonHref:o}=Cl({to:a,from:t,title:"Current Risk Score For Users"}),l=Object(n.useMemo)((()=>({from:t,to:a})),[t,a]),{toggleStatus:c,setToggleStatus:u}=Object(zt.a)(`${Xp} overTime`),{toggleStatus:d,setToggleStatus:p}=Object(zt.a)(`${Xp} contributors`),m=Object(n.useMemo)((()=>e?Object(rn.C)([e]):void 0),[e]),[g,{data:f,refetch:b,inspect:h,isDeprecated:y,isModuleEnabled:E}]=Object(Io.e)({filterQuery:m,onlyLatest:!1,skip:!c&&!d,timerange:l});Object(Pi.b)({queryId:Xp,loading:g,refetch:b,setQuery:s,deleteQuery:r,inspect:h});const v=Object(n.useCallback)((e=>{p(e)}),[p]),k=Object(n.useCallback)((e=>{u(e)}),[u]);if(!E&&!g)return i.a.createElement(tp,{refetch:b,timerange:l});if(y&&!g)return i.a.createElement(po,{entityType:rn.v.user,refetch:b,timerange:l});if(E&&f&&0===f.length)return i.a.createElement($l,{entityType:rn.v.user,refetch:b});const S=f&&f.length>0?f[f.length-1]:null,T=S?S.user.risk.rule_risks:[];return i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiFlexGroup,{direction:"row"},i.a.createElement(B.EuiFlexItem,{grow:2},i.a.createElement(No,{from:t,to:a,loading:g,riskScore:f,queryId:Xp,title:Kd.g,toggleStatus:c,toggleQuery:k})),i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(Il,{loading:g,queryId:Xp,toggleStatus:d,toggleQuery:v,rules:T}))),i.a.createElement(Zp,{gutterSize:"s"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{href:o,isDisabled:!o,"data-test-subj":"risky-users-view-dashboard-button",target:"_blank"},Kd.h)),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(Jp,null))))};em.displayName="UserRiskTabBodyComponent";const tm=i.a.memo(em);tm.displayName="UserRiskTabBody";const am=i.a.memo((({deleteQuery:e,filterQuery:t,from:a,indexNames:s,isInitializing:r,setQuery:o,to:l,type:c,detailName:u,pageFilters:d=[]})=>{const p={deleteQuery:e,endDate:l,filterQuery:t,indexNames:s,skip:r||void 0===t,setQuery:o,startDate:a,type:c,userName:u},m=Object(n.useMemo)((()=>[...Dp,...d]),[d]);return i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:`${_p}/:tabName(${md.UsersTableType.authentications})`},i.a.createElement(Pd,p)),i.a.createElement(_.Route,{path:`${_p}/:tabName(${md.UsersTableType.anomalies})`},i.a.createElement(vn.a,yn()({},p,{AnomaliesTableComponent:Bd}))),i.a.createElement(_.Route,{path:`${_p}/:tabName(${md.UsersTableType.events})`},i.a.createElement(Nn.a,yn()({},p,{pageFilters:d,timelineId:jc.c.usersPageEvents,externalAlertPageFilters:m}))),i.a.createElement(_.Route,{path:`${_p}/:tabName(${md.UsersTableType.risk})`},i.a.createElement(tm,p)))}));am.displayName="UsersDetailsTabs";const nm=(e,t)=>`${r.Fc}/name/${e}/${t}`,im=(e,t,a)=>{const n=[],i={[md.UsersTableType.authentications]:{id:md.UsersTableType.authentications,name:Kd.c,href:nm(e,md.UsersTableType.authentications),disabled:!1},[md.UsersTableType.anomalies]:{id:md.UsersTableType.anomalies,name:Kd.b,href:nm(e,md.UsersTableType.anomalies),disabled:!1},[md.UsersTableType.events]:{id:md.UsersTableType.events,name:Kd.d,href:nm(e,md.UsersTableType.events),disabled:!1},[md.UsersTableType.risk]:{id:md.UsersTableType.risk,name:Kd.e,href:nm(e,md.UsersTableType.risk),disabled:!1,isBeta:!0,betaOptions:{text:Cc.i}}};return t||n.push(md.UsersTableType.anomalies),a||n.push(md.UsersTableType.risk),Object(y.omit)(n,i)};var sm=a(671),rm=a(694),om=a(695);const lm="UsersDetailsQueryId",cm=({detailName:e,usersDetailsPagePath:t})=>{const a=Object(o.useDispatch)(),s=Object(dn.a)().isPlatinumOrTrialLicense,r=Object(n.useMemo)((()=>d.b.getTimelineByIdSelector()),[]),c=Object(E.b)((e=>{var t;return(null!==(t=r(e,l.i.hostsPageEvents))&&void 0!==t?t:ge.a).graphEventId})),m=Object(n.useMemo)((()=>fn.f.globalFiltersQuerySelector()),[]),g=Object(n.useMemo)((()=>fn.f.globalQuerySelector()),[]),b=Object(E.a)(g),k=Object(E.a)(m),{signalIndexName:S}=Object(sn.a)(),{hasKibanaREAD:T,hasIndexRead:x}=Object(na.a)(),w=T&&x,{to:O,from:j,deleteQuery:I,setQuery:C,isInitializing:M}=Object(U.a)(),{globalFullScreen:D}=Object(de.a)(),{services:{uiSettings:A}}=Object(u.k)(),F=Object(n.useMemo)((()=>{return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"user.name",value:t=e,params:{query:t}},query:{match:{"user.name":{query:t,type:"phrase"}}}}];var t}),[e]),{indicesExist:R,indexPattern:P,selectedPatterns:_}=Object(p.d)(),[q,N]=Object(n.useMemo)((()=>{try{return[Object(Ve.c)(P,[b],[...F,...k],Object(an.getEsQueryConfig)(A))]}catch(e){return[void 0,e]}}),[k,P,b,A,F]),L=JSON.stringify(q);Object(Rc.a)({id:lm,filterQuery:L,kqlError:N,query:b,startDate:j,endDate:O}),Object(n.useEffect)((()=>{a(Object(Pp.setUsersDetailsTablesActivePageToZero)())}),[a,e]);const[z,{inspect:H,userDetails:$,refetch:W}]=Object(om.a)({id:lm,endDate:O,startDate:j,userName:e,indexNames:_,skip:0===_.length}),K=Object(dn.a)();Object(Pi.b)({setQuery:C,deleteQuery:I,refetch:W,inspect:H,loading:z,queryId:lm});const Y=Object(n.useCallback)(((e,t)=>{const n=Object(pn.a)(e,t);a(Object(J.setAbsoluteRangeDatePicker)({id:V.a.global,from:n.from,to:n.to}))}),[a]),X=Object(n.useMemo)((()=>({field:"user.name",value:e})),[e]);return i.a.createElement(i.a.Fragment,null,R?i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiWindowEvent,{event:"resize",handler:y.noop}),i.a.createElement(Q.a,{show:Object(me.m)({globalFullScreen:D,graphEventId:c})},i.a.createElement(G.a,{indexPattern:P,id:V.a.global})),i.a.createElement(f.a,{noPadding:D},i.a.createElement(Yt.a,{subtitle:i.a.createElement(on.a,{indexKey:rn.k.userDetails,indexNames:_,userName:e}),title:e}),i.a.createElement(ln.a,{criteriaFields:Object(_d.a)(md.UsersType.details,e),startDate:j,endDate:O,skip:M},(({isLoadingAnomaliesData:t,anomaliesData:a})=>i.a.createElement(rm.a,{userName:e,id:lm,isInDetailsSidePanel:!1,data:$,anomaliesData:a,isLoadingAnomaliesData:t,loading:z,startDate:j,endDate:O,narrowDateRange:Y,indexPatterns:_}))),i.a.createElement(B.EuiHorizontalRule,null),i.a.createElement(B.EuiSpacer,null),w&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiFlexGroup,null,i.a.createElement(B.EuiFlexItem,null,i.a.createElement(nn.a,{signalIndexName:S,entityFilter:X,additionalFilters:q?[q]:[]})),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Pc.a,{entityFilter:X,signalIndexName:S,additionalFilters:q?[q]:[]}))),i.a.createElement(B.EuiSpacer,null)),i.a.createElement(mn.a,{navTabs:im(e,Object(un.a)(K),s)}),i.a.createElement(B.EuiSpacer,null),i.a.createElement(am,{deleteQuery:I,detailName:e,filterQuery:L,from:j,indexNames:_,indexPattern:P,isInitializing:M,pageFilters:F,setQuery:C,to:O,type:sm.b,usersDetailsPagePath:t}))):i.a.createElement(Xt.a,null),i.a.createElement(h.a,{pageName:v.a.users}))};cm.displayName="UsersDetailsComponent";const um=i.a.memo(cm),dm=i.a.memo((()=>i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:qp},i.a.createElement(Rp,null)),i.a.createElement(_.Route,{path:Np,render:({match:{params:{detailName:e}}})=>i.a.createElement(um,{usersDetailsPagePath:_p,detailName:decodeURIComponent(e)})}),i.a.createElement(_.Route,{path:_p,render:({match:{params:{detailName:e}},location:{search:t=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${r.Fc}/name/${e}/${md.UsersTableType.authentications}`,search:t}})}),i.a.createElement(_.Route,{path:`${r.Fc}/:detailName/:tabName?`,render:({match:{params:{detailName:e,tabName:t=md.UsersTableType.authentications}},location:{search:a=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${r.Fc}/name/${e}/${t}`,search:a}})}),i.a.createElement(_.Route,{path:r.Fc,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${r.Fc}/${md.UsersTableType.allUsers}`,search:e}})}))));dm.displayName="UsersContainer";const pm=[{path:r.Fc,component:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:v.a.users},i.a.createElement(dm,null)))}];var mm=a(678),gm=a(323),fm=a(196),bm=a(51);const hm=H()(B.EuiPanel).withConfig({displayName:"Panel",componentId:"sc-4inzan-0"})(["overflow:hidden;"]);hm.displayName="Panel";const ym=i.a.memo((({children:e})=>i.a.createElement("section",{className:"siemEmbeddable","data-test-subj":"siemEmbeddable"},i.a.createElement(hm,{paddingSize:"none",hasBorder:!0},e))));ym.displayName="Embeddable",a(1188);var Em=a(199),vm=a(200);const km=N.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderTitle",{defaultMessage:"Network map"}),Sm=N.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderHelp",{defaultMessage:"Map configuration help"}),Tm=N.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddablePanelTitle",{defaultMessage:"Source -> Destination Point-to-Point Map"}),xm=N.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.sourceLayerLabel",{defaultMessage:"Source Point"}),wm=N.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.destinationLayerLabel",{defaultMessage:"Destination Point"}),Om=N.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.clientLayerLabel",{defaultMessage:"Client Point"}),jm=N.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.serverLayerLabel",{defaultMessage:"Server Point"}),Im=N.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.lineLayerLabel",{defaultMessage:"Line"}),Cm=N.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.errorCreatingMapEmbeddableTitle",{defaultMessage:"Error creating Map Embeddable"}),Mm=N.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorTitle",{defaultMessage:"Required index patterns not configured"}),Dm=N.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorButtonLabel",{defaultMessage:"Configure index patterns"}),Am=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.errorTitle",{defaultMessage:"Error loading map features"}),Fm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.hostTitle",{defaultMessage:"Host"}),Rm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceIPTitle",{defaultMessage:"Source IP"}),Pm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationIPTitle",{defaultMessage:"Destination IP"}),_m=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientIPTitle",{defaultMessage:"Client IP"}),qm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverIPTitle",{defaultMessage:"Server IP"}),Nm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceDomainTitle",{defaultMessage:"Source domain"}),Lm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationDomainTitle",{defaultMessage:"Destination domain"}),Bm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientDomainTitle",{defaultMessage:"Client domain"}),zm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverDomainTitle",{defaultMessage:"Server domain"}),Hm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.locationTitle",{defaultMessage:"Location"}),$m=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.asnTitle",{defaultMessage:"ASN"}),Vm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.sourceLabel",{defaultMessage:"Source"}),Um=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.destinationLabel",{defaultMessage:"Destination"}),Qm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.clientLabel",{defaultMessage:"Client"}),Wm=N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.serverLabel",{defaultMessage:"Server"}),Gm=Object(B.euiPaletteColorBlind)(),Km={"host.name":Fm,"source.ip":Rm,"source.domain":Nm,"source.geo.country_iso_code":Hm,"source.as.organization.name":$m},Jm={"host.name":Fm,"destination.ip":Pm,"destination.domain":Lm,"destination.geo.country_iso_code":Hm,"destination.as.organization.name":$m},Ym={"host.name":Fm,"client.ip":_m,"client.domain":Bm,"client.geo.country_iso_code":Hm,"client.as.organization.name":$m},Xm={"host.name":Fm,"server.ip":qm,"server.domain":zm,"server.geo.country_iso_code":Hm,"server.as.organization.name":$m},Zm={...Km,...Jm,...Ym,...Xm},eg="sum_of_source.bytes",tg={source:{metricField:"client.bytes",geoField:"client.geo.location",tooltipProperties:Object.keys(Ym),label:Om},destination:{metricField:"server.bytes",geoField:"server.geo.location",tooltipProperties:Object.keys(Xm),label:jm}},ag={default:{source:{metricField:"source.bytes",geoField:"source.geo.location",tooltipProperties:Object.keys(Km),label:xm},destination:{metricField:"destination.bytes",geoField:"destination.geo.location",tooltipProperties:Object.keys(Jm),label:wm}},"apm-*":tg,"traces-apm*,logs-apm*,metrics-apm*,apm-*":tg},ng=e=>[{sourceDescriptor:{type:vm.SOURCE_TYPES.EMS_TMS,isAutoSelect:!0},id:Qe.a.v4(),label:null,minZoom:0,maxZoom:24,alpha:1,visible:!0,style:null,type:vm.LAYER_TYPE.EMS_VECTOR_TILE},...e.reduce(((e,{title:t,id:a})=>{var n,i,s,r,o;return[...e,rg(t,a,null!==(n=ag[t])&&void 0!==n?n:ag.default),sg(t,a,null!==(i=null===(s=ag[t])||void 0===s?void 0:s.destination)&&void 0!==i?i:ag.default.destination),ig(t,a,null!==(r=null===(o=ag[t])||void 0===o?void 0:o.source)&&void 0!==r?r:ag.default.source)]}),[])],ig=(e,t,a)=>({sourceDescriptor:{id:Qe.a.v4(),type:"ES_SEARCH",applyGlobalQuery:!0,geoField:a.geoField,filterByMapBounds:!1,tooltipProperties:a.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:t},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:Gm[1]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"home"}}}},id:Qe.a.v4(),label:`${e} | ${a.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:vm.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"},joins:[]}),sg=(e,t,a)=>({sourceDescriptor:{id:Qe.a.v4(),type:"ES_SEARCH",scalingType:vm.SCALING_TYPES.LIMIT,applyGlobalQuery:!0,geoField:a.geoField,filterByMapBounds:!0,tooltipProperties:a.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:t},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:Gm[2]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"marker"}}}},id:Qe.a.v4(),label:`${e} | ${a.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:vm.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"}}),rg=(e,t,a)=>({sourceDescriptor:{type:vm.SOURCE_TYPES.ES_PEW_PEW,applyGlobalQuery:!0,id:Qe.a.v4(),indexPatternId:t,sourceGeoField:a.source.geoField,destGeoField:a.destination.geoField,metrics:[{type:"sum",field:a.source.metricField,label:a.source.metricField},{type:"sum",field:a.destination.metricField,label:a.destination.metricField}]},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:"#1EA593"}},lineColor:{type:"STATIC",options:{color:Gm[1]}},lineWidth:{type:"DYNAMIC",options:{field:{label:"count",name:"doc_count",origin:"source"},minSize:1,maxSize:8,fieldMetaOptions:{isEnabled:!0,sigma:3}}},iconSize:{type:"STATIC",options:{size:10}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"airfield"}}}},id:Qe.a.v4(),label:`${e} | ${Im}`,minZoom:0,maxZoom:24,alpha:.5,visible:!0,type:vm.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"}}),og=()=>{const{docLinks:e}=Object(u.k)().services,t=`${Object(u.e)()}/app`;return i.a.createElement(B.EuiEmptyPrompt,{iconType:"gisApp",title:i.a.createElement("h2",null,Mm),titleSize:"xs",body:i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,i.a.createElement(Hs.FormattedMessage,{defaultMessage:"To display map data, you must define SIEM indices ({defaultIndex}) and Kibana index patterns with matching glob patterns. When using {beats}, you can run the {setup} command on your hosts to automatically create the index patterns. For example: {example}.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription1",values:{defaultIndex:i.a.createElement("a",{href:`${t}/management/kibana/settings`,rel:"noopener noreferrer",target:"_blank"},"securitySolution:defaultIndex"),beats:i.a.createElement("a",{href:`${e.links.libbeat.getStarted}`,rel:"noopener noreferrer",target:"_blank"},"beats"),setup:i.a.createElement(B.EuiCode,null,"setup"),example:i.a.createElement(B.EuiCode,null,"./packetbeat setup")}})),i.a.createElement("p",null,i.a.createElement(Hs.FormattedMessage,{defaultMessage:"You can also configure index patterns manually in Kibana.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription2"}))),actions:i.a.createElement(B.EuiButton,{href:`${t}/management/kibana/dataViews`,color:"primary",target:"_blank",fill:!0},Dm)})};og.displayName="IndexPatternsMissingPromptComponent";const lg=i.a.memo(og);lg.displayName="IndexPatternsMissingPrompt",H()(B.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-s0r863-0"})(["margin-right:",";"],Co.euiLightVars.euiSizeS).displayName="Icon";const cg=({featureIndex:e,totalFeatures:t,previousFeature:a,nextFeature:n})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiHorizontalRule,{margin:"s"}),i.a.createElement(B.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"xs"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiText,{size:"xs"},((e,t)=>N.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.footerLabel",{values:{currentFeature:e,totalFeatures:t},defaultMessage:"{currentFeature} of {totalFeatures} {totalFeatures, plural, =1 {feature} other {features}}"}))(e+1,t))),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement("span",null,i.a.createElement(B.EuiButtonIcon,{"data-test-subj":"previous-feature-button",color:"text",onClick:a,iconType:"arrowLeft","aria-label":"Next",isDisabled:e<=0}),i.a.createElement(B.EuiButtonIcon,{"data-test-subj":"next-feature-button",color:"text",onClick:n,iconType:"arrowRight","aria-label":"Next",isDisabled:e>=t-1})))));cg.displayName="ToolTipFooterComponent";const ug=i.a.memo(cg);ug.displayName="ToolTipFooter";var dg=a(687);const pg=H()(B.EuiBadge).withConfig({displayName:"FlowBadge",componentId:"sc-120vo88-0"})(["height:45px;min-width:85px;"]),mg=H()(B.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-120vo88-1"})(["margin:0 auto;"]),gg=({contextId:e,featureProps:t})=>{const a=t.reduce(((e,t)=>{var a;const n=null!==(a=t.getRawValue())&&void 0!==a?a:[];return{...e,[t.getPropertyKey()]:Array.isArray(n)?n:[n]}}),{}),n=Object.keys(a).includes(eg);return i.a.createElement(B.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(pg,{color:"hollow"},i.a.createElement(mg,{direction:"column"},i.a.createElement(B.EuiFlexItem,{grow:!1},n?Vm:Qm)))),i.a.createElement(dg.e,{contextId:e,destinationBytes:n?a["sum_of_destination.bytes"]:a["sum_of_server.bytes"],eventId:`map-line-tooltip-${e}`,sourceBytes:n?a[eg]:a["sum_of_client.bytes"]}),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(pg,{color:"hollow"},i.a.createElement(mg,null,i.a.createElement(B.EuiFlexItem,{grow:!1},n?Um:Wm)))))};gg.displayName="LineToolTipContentComponent";const fg=i.a.memo(gg);fg.displayName="LineToolTipContent";var bg=a(98),hg=a(337);const yg=({contextId:e,featureProps:t})=>{const a=Object(n.useMemo)((()=>t.map((t=>{var a;const n=t.getPropertyKey(),s=null!==(a=t.getRawValue())&&void 0!==a?a:[];return{title:Zm[n],description:i.a.createElement(i.a.Fragment,null,null!=s?i.a.createElement(hg.a,{rowItems:Array.isArray(s)?s:[s],attrName:n,idPrefix:`map-point-tooltip-${e}-${n}-${s}`,render:e=>vg(n,e)}):Object(ri.d)())}}))),[e,t]);return i.a.createElement(bg.d,{listItems:a})};yg.displayName="PointToolTipContentComponent";const Eg=i.a.memo(yg);Eg.displayName="PointToolTipContent";const vg=(e,t)=>{if(""===t)return Object(ri.f)(t);if(["host.name"].includes(e))return i.a.createElement(ue.d,{hostName:t});if(["source.ip","destination.ip"].includes(e)){const a=e.split(".")[0];return i.a.createElement(ue.h,{ip:t,flowTarget:a})}return i.a.createElement(i.a.Fragment,null,t)},kg=({closeTooltip:e,features:t=[],getLayerName:a,loadFeatureProperties:s,loadFeatureGeometry:r})=>{const[o,l]=Object(n.useState)(!0),[c,u]=Object(n.useState)(!1),[d,p]=Object(n.useState)(!1),[m,g]=Object(n.useState)(0),[f,b]=Object(n.useState)([]),[h,y]=Object(n.useState)(null),[,E]=Object(n.useState)(""),v=Object(n.useCallback)((()=>{null!=e&&(e(),g(0))}),[e]),k=Object(n.useCallback)((()=>{g((e=>e-1)),u(!0)}),[]),S=Object(n.useCallback)((()=>{g((e=>e+1)),u(!0)}),[]),T=Object(n.useMemo)((()=>d?i.a.createElement(B.EuiFlexGroup,{justifyContent:"spaceAround"},i.a.createElement(B.EuiFlexItem,{grow:!1},Am)):o&&!c?i.a.createElement(B.EuiFlexGroup,{justifyContent:"spaceAround"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiLoadingSpinner,{size:"m"}))):i.a.createElement("div",null,null!=h&&"LineString"===h.type?i.a.createElement(fg,{contextId:`${t[m].layerId}-${t[m].id}-${m}`,featureProps:f}):i.a.createElement(Eg,{contextId:`${t[m].layerId}-${t[m].id}-${m}`,featureProps:f}),t.length>1&&i.a.createElement(ug,{featureIndex:m,totalFeatures:t.length,previousFeature:k,nextFeature:S}),c&&i.a.createElement(ba.a,{"data-test-subj":"loading-panel",overlay:!0,size:"m"}))),[h,m,f,t,S,k,d,o,c]);return Object(n.useEffect)((()=>{0!==t.length&&null!=a&&null!=s&&null!=r&&(c||l(!0),p(!1),(async()=>{if(null!=t[m]){const e=t[m].layerId,n=t[m].id;try{const i=r({layerId:e,featureId:n}),[o,c]=await Promise.all([s({layerId:e,properties:t[m].mbProperties}),a(e)]);b(o),y(i),c&&E(c)}catch(e){p(!0)}finally{l(!1),u(!1)}}})())}),[m,t,a,c,r,s]),i.a.createElement(B.EuiOutsideClickDetector,{onOutsideClick:v},T)};kg.displayName="MapToolTipComponent";const Sg=i.a.memo(kg);Sg.displayName="MapToolTip";var Tg=a(33);const xg="network_map_visbile",wg=H.a.div.attrs((()=>({className:"siemEmbeddable__map"}))).withConfig({displayName:"EmbeddableMap",componentId:"sc-1t0ky4k-0"})([".embPanel{border:none;box-shadow:none;}.mapToolbarOverlay__button{display:none;}",""],(({maintainRatio:e})=>e&&Object(z.css)(["padding-top:calc(3 / 4 * 100%);position:relative;@media only screen and (min-width:","){padding-top:calc(9 / 32 * 100%);}@media only screen and (min-width:1441px) and (min-height:901px){padding-top:calc(9 / 21 * 100%);}.embPanel{bottom:0;left:0;position:absolute;right:0;top:0;}"],(({theme:e})=>e.eui.euiBreakpoints.m)))),Og=H()(B.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-1t0ky4k-1"})(["margin-right:16px;"]),jg=H()(B.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-1t0ky4k-2"})(["& .euiAccordion__triggerWrapper{padding:16px;}"]);wg.displayName="EmbeddableMap";const Ig=({endDate:e,filters:t,query:a,setQuery:s,startDate:r})=>{var o;const[l,c]=i.a.useState(void 0),{services:d}=Object(u.k)(),{storage:g}=d,[f,b]=Object(n.useState)(!1),[h,y]=Object(n.useState)(!1),[v,k]=Object(n.useState)(null===(o=g.get(xg))||void 0===o||o),[,S]=Object(bm.g)(),T=Object(n.useMemo)((()=>Tg.d.getSourcererDataViewsSelector()),[]),{kibanaDataViews:x}=Object(E.a)((e=>T(e))),{selectedPatterns:w}=Object(p.d)(m.SourcererScopeName.default),[O,j]=Object(n.useState)(x.filter((e=>w.includes(e.title)))),I=i.a.useMemo((()=>Object(gm.c)()),[]);Object(n.useEffect)((()=>{j((e=>{const t=x.filter((e=>w.includes(e.title)));return Ii()(t,e)?e:(0===t.length&&b(!0),t)}))}),[x,w]),Object(n.useEffect)((()=>{let n=!0;return null==l&&w.length>0&&async function(){try{const o=await(async(e,t,a,n,s,r,o,l)=>{const c=l.getEmbeddableFactory(Em.MAP_SAVED_OBJECT_TYPE);if(!c)throw new Error("Map embeddable factory undefined");const u={title:Tm,attributes:{title:""},id:Qe.a.v4(),filters:e,hidePanelTitles:!0,query:a,timeRange:{from:new Date(n).toISOString(),to:new Date(s).toISOString()},viewMode:fm.ViewMode.VIEW,isLayerTOCOpen:!1,openTOCDetails:[],hideFilterActions:!1,mapCenter:{lon:-1.05469,lat:15.96133,zoom:1},disabledActions:["CUSTOM_TIME_RANGE","CUSTOM_TIME_RANGE_BADGE"]},d=await c.create(u);if(!d)throw new Error("Map embeddable is undefined");return Object(fm.isErrorEmbeddable)(d)||(d.setRenderTooltipContent((({addFilters:e,closeTooltip:t,features:a,isLocked:n,getLayerName:s,loadFeatureProperties:r,loadFeatureGeometry:l})=>{const c={addFilters:e,closeTooltip:t,features:a,isLocked:n,getLayerName:s,loadFeatureProperties:r,loadFeatureGeometry:l};return i.a.createElement(gm.b,yn()({node:o},c))})),d.setLayerList(ng(t))),r({id:"embeddedMap",inspect:null,loading:!1,refetch:()=>d.reload()}),d})(t,O,a,r,e,s,I,d.embeddable);n&&(0===O.length?y(!0):(c(o),y(!1)))}catch(e){n&&(Object(bm.d)(Cm,[e.message],S),b(!0))}}(),()=>{n=!1}}),[S,e,l,t,O,a,I,d.embeddable,w,s,r]),Object(n.useEffect)((()=>{null==l||Object(fm.isErrorEmbeddable)(l)||(async()=>{null!=l&&(await l.setLayerList(ng(O)),l.reload())})()}),[l,O]),Object(n.useEffect)((()=>{null!=l&&l.updateInput({query:a})}),[l,a]),Object(n.useEffect)((()=>{null!=l&&l.updateInput({filters:t})}),[l,t]),Object(n.useEffect)((()=>{if(null!=l&&null!=r&&null!=e){const t={from:new Date(r).toISOString(),to:new Date(e).toISOString()};l.updateInput({timeRange:t})}}),[l,r,e]);const C=Object(n.useCallback)((e=>{g.set(xg,e),k(e)}),[g]),M=Object(n.useMemo)((()=>v?i.a.createElement(ym,null,i.a.createElement(gm.a,{node:I},i.a.createElement(Sg,null)),i.a.createElement(wg,{maintainRatio:!h},h?i.a.createElement(lg,{"data-test-subj":"missing-prompt"}):null!=l?i.a.createElement(d.embeddable.EmbeddablePanel,{embeddable:l}):i.a.createElement(ba.a,{"data-test-subj":"loading-panel",overlay:!0,size:"xl"}))):null),[l,h,I,d,v]);return f?null:i.a.createElement(jg,{onToggle:C,id:"network-map",arrowDisplay:"right",arrowProps:{color:"primary","data-test-subj":`${v}-toggle-network-map`},buttonContent:i.a.createElement("strong",null,km),extraAction:i.a.createElement(Og,{size:"xs"},i.a.createElement(B.EuiLink,{href:`${d.docLinks.links.siem.networkMap}`,target:"_blank"},Sm)),paddingSize:"none",initialIsOpen:v},M)};Ig.displayName="EmbeddedMapComponent";const Cg=i.a.memo(Ig);Cg.displayName="EmbeddedMap";const Mg=N.i18n.translate("xpack.securitySolution.networkKpiDns.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi dns search"}),Dg=N.i18n.translate("xpack.securitySolution.networkKpiDns.failSearchDescription",{defaultMessage:"Failed to run search on network kpi dns"}),Ag="networkKpiDnsQuery",Fg=[{key:"dnsQueries",fields:[{key:"dnsQueries",value:null,lensAttributes:{title:"[Network] DNS metric",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",accessor:"0374e520-eae0-4ac1-bcfe-37565e7fc9e3",layerType:"data",colorMode:"None"},query:{query:"",language:"kuery"},filters:[{meta:{index:"196d783b-3779-4c39-898e-6606fe633d05",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"dns.question.name"}},{"term":{"suricata.eve.dns.type":{"value":"query"}}},{"exists":{"field":"zeek.dns.query"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"dns.question.name"}},{term:{"suricata.eve.dns.type":{value:"query"}}},{exists:{field:"zeek.dns.query"}}],minimum_should_match:1}}}],datasourceStates:{indexpattern:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columns:{"0374e520-eae0-4ac1-bcfe-37565e7fc9e3":{label:"",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["0374e520-eae0-4ac1-bcfe-37565e7fc9e3"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3"},{type:"index-pattern",name:"196d783b-3779-4c39-898e-6606fe633d05",id:"{dataViewId}"}]}}],description:N.i18n.translate("xpack.securitySolution.kpiNetwork.dnsQueries.title",{defaultMessage:"DNS queries"})}],Rg=({filterQuery:e,from:t,indexNames:a,to:s,updateDateRange:r,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(zt.a)(Ag),[d,p]=Object(n.useState)(l||!c);Object(n.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:s})=>{const{data:r}=Object(u.k)().services,o=Object(n.useRef)(y.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new iu.Subscription),[d,p]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[f,b]=Object(n.useState)({dnsQueries:0,id:Ag,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:E}=Object(ma.a)(),v=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=r.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(an.isCompleteResponse)(e)?(p(!1),b((t=>({...t,dnsQueries:e.dnsQueries,inspect:Object(ou.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(an.isErrorResponse)(e)&&(p(!1),E(Mg),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:Dg}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[r.search,h,E,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rn.p.dns,filterQuery:Object(Mi.a)(e),timerange:{interval:"12h",from:s,to:t}};return Ii()(n,i)?n:i}))}),[a,t,e,s]),Object(n.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(n.useEffect)((()=>{i&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[d,f]})({filterQuery:e,endDate:s,indexNames:a,startDate:t,skip:d});return i.a.createElement(Du,{data:h,id:f,inspect:b,loading:m,fieldsMapping:Fg,from:t,to:s,updateDateRange:r,refetch:g,setQuery:o,setQuerySkip:p})},Pg=i.a.memo(Rg),_g=N.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi network events search"}),qg=N.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.failSearchDescription",{defaultMessage:"Failed to run search on network kpi network events"}),Ng="networkKpiNetworkEventsQuery",Lg=N.i18n.translate("xpack.securitySolution.kpiNetwork.networkEvents.title",{defaultMessage:"Network events"}),Bg=[{key:"networkEvents",fields:[{key:"networkEvents",value:null,color:Object(B.euiPaletteColorBlind)()[1],lensAttributes:{title:"[Network] Network events",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"eaadfec7-deaa-4aeb-a403-3b4e516416d2",accessor:"370ebd07-5ce0-4f46-a847-0e363c50d037",layerType:"data"},query:{query:"",language:"kuery"},filters:[{meta:{index:"security-solution-default",alias:null,negate:!1,disabled:!1,type:"exists",key:"source.ip",value:"exists"},query:{exists:{field:"source.ip"}},$state:{store:"appState"}},{meta:{index:"security-solution-default",alias:null,negate:!1,disabled:!1,type:"exists",key:"destination.ip",value:"exists"},query:{exists:{field:"destination.ip"}},$state:{store:"appState"}}],datasourceStates:{indexpattern:{layers:{"eaadfec7-deaa-4aeb-a403-3b4e516416d2":{columns:{"370ebd07-5ce0-4f46-a847-0e363c50d037":{label:" ",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["370ebd07-5ce0-4f46-a847-0e363c50d037"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-eaadfec7-deaa-4aeb-a403-3b4e516416d2"},{type:"index-pattern",name:"861af17d-be25-45a3-a82d-d6e697b76e51",id:"{dataViewId}"},{type:"index-pattern",name:"09617767-f732-410e-af53-bebcbd0bf4b9",id:"{dataViewId}"}]}}],description:Lg}],zg=({filterQuery:e,from:t,indexNames:a,to:s,updateDateRange:r,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(zt.a)(Ng),[d,p]=Object(n.useState)(l||!c);Object(n.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:s})=>{const{data:r}=Object(u.k)().services,o=Object(n.useRef)(y.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new iu.Subscription),[d,p]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[f,b]=Object(n.useState)({networkEvents:0,id:Ng,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:E}=Object(ma.a)(),v=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=r.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(an.isCompleteResponse)(e)?(p(!1),b((t=>({...t,networkEvents:e.networkEvents,inspect:Object(ou.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(an.isErrorResponse)(e)&&(p(!1),E(_g),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:qg}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[r.search,h,E,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rn.p.networkEvents,filterQuery:Object(Mi.a)(e),timerange:{interval:"12h",from:s,to:t}};return Ii()(n,i)?n:i}))}),[a,t,e,s]),Object(n.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(n.useEffect)((()=>{i&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[d,f]})({filterQuery:e,endDate:s,indexNames:a,startDate:t,skip:d});return i.a.createElement(Du,{data:h,id:f,inspect:b,loading:m,fieldsMapping:Bg,from:t,to:s,updateDateRange:r,refetch:g,setQuery:o,setQuerySkip:p})},Hg=i.a.memo(zg),$g=N.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi tls handshakes search"}),Vg=N.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.failSearchDescription",{defaultMessage:"Failed to run search on network kpi tls handshakes"}),Ug="networkKpiTlsHandshakesQuery",Qg=[{key:"tlsHandshakes",fields:[{key:"tlsHandshakes",value:null,lensAttributes:{title:"[Network] TLS handshakes",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"1f48a633-8eee-45ae-9471-861227e9ca03",accessor:"21052b6b-5504-4084-a2e2-c17f772345cf",layerType:"data"},query:{query:"(source.ip: * or destination.ip: *) and (tls.version: * or suricata.eve.tls.version: * or zeek.ssl.version: * )",language:"kuery"},filters:[{meta:{index:"32ee22d9-2e77-4aee-8073-87750e92c3ee",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"source.ip"}},{"exists":{"field":"destination.ip"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}}},{meta:{index:"1e93f984-9374-4755-a198-de57751533c6",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"tls.version"}},{"exists":{"field":"suricata.eve.tls.version"}},{"exists":{"field":"zeek.ssl.version"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"tls.version"}},{exists:{field:"suricata.eve.tls.version"}},{exists:{field:"zeek.ssl.version"}}],minimum_should_match:1}}}],datasourceStates:{indexpattern:{layers:{"1f48a633-8eee-45ae-9471-861227e9ca03":{columns:{"21052b6b-5504-4084-a2e2-c17f772345cf":{label:" ",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["21052b6b-5504-4084-a2e2-c17f772345cf"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-1f48a633-8eee-45ae-9471-861227e9ca03"}]}}],description:N.i18n.translate("xpack.securitySolution.kpiNetwork.tlsHandshakes.title",{defaultMessage:"TLS handshakes"})}],Wg=({filterQuery:e,from:t,indexNames:a,to:s,updateDateRange:r,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(zt.a)(Ug),[d,p]=Object(n.useState)(l||!c);Object(n.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:s})=>{const{data:r}=Object(u.k)().services,o=Object(n.useRef)(y.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new iu.Subscription),[d,p]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[f,b]=Object(n.useState)({tlsHandshakes:0,id:Ug,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:E}=Object(ma.a)(),v=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=r.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(an.isCompleteResponse)(e)?(p(!1),b((t=>({...t,tlsHandshakes:e.tlsHandshakes,inspect:Object(ou.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(an.isErrorResponse)(e)&&(p(!1),E($g),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:Vg}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[r.search,h,E,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rn.p.tlsHandshakes,filterQuery:Object(Mi.a)(e),timerange:{interval:"12h",from:s,to:t}};return Ii()(n,i)?n:i}))}),[a,t,e,s]),Object(n.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(n.useEffect)((()=>{i&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[d,f]})({filterQuery:e,endDate:s,indexNames:a,startDate:t,skip:d});return i.a.createElement(Du,{data:h,id:f,inspect:b,loading:m,fieldsMapping:Qg,from:t,to:s,updateDateRange:r,refetch:g,setQuery:o,setQuerySkip:p})},Gg=i.a.memo(Wg),Kg=N.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique flows search"}),Jg=N.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique flows"}),Yg="networkKpiUniqueFlowsQuery",Xg=[{key:"uniqueFlowId",fields:[{key:"uniqueFlowId",value:null,lensAttributes:{title:"[Network] Unique flow IDs",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"5d46d48f-6ce8-46be-a797-17ad50642564",accessor:"a27f3503-9c73-4fc1-86bb-12461dae4b70",layerType:"data"},query:{query:"source.ip: * or destination.ip: * ",language:"kuery"},filters:[{meta:{index:"c01edc8a-90ce-4d49-95f0-76954a034eb2",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"source.ip"}},{"exists":{"field":"destination.ip"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}}}],datasourceStates:{indexpattern:{layers:{"5d46d48f-6ce8-46be-a797-17ad50642564":{columns:{"a27f3503-9c73-4fc1-86bb-12461dae4b70":{label:" ",dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"network.community_id",isBucketed:!1,customLabel:!0}},columnOrder:["a27f3503-9c73-4fc1-86bb-12461dae4b70"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-5d46d48f-6ce8-46be-a797-17ad50642564"}]}}],description:N.i18n.translate("xpack.securitySolution.kpiNetwork.uniqueFlowIds.title",{defaultMessage:"Unique flow IDs"})}],Zg=({filterQuery:e,from:t,indexNames:a,to:s,updateDateRange:r,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(zt.a)(Yg),[d,p]=Object(n.useState)(l||!c);Object(n.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:s})=>{const{data:r}=Object(u.k)().services,o=Object(n.useRef)(y.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new iu.Subscription),[d,p]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[f,b]=Object(n.useState)({uniqueFlowId:0,id:Yg,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:E}=Object(ma.a)(),v=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=r.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(an.isCompleteResponse)(e)?(p(!1),b((t=>({...t,uniqueFlowId:e.uniqueFlowId,inspect:Object(ou.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(an.isErrorResponse)(e)&&(p(!1),E(Kg),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:Jg}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[r.search,h,E,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rn.p.uniqueFlows,filterQuery:Object(Mi.a)(e),timerange:{interval:"12h",from:s,to:t}};return Ii()(n,i)?n:i}))}),[a,t,e,s]),Object(n.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(n.useEffect)((()=>{i&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[d,f]})({filterQuery:e,endDate:s,indexNames:a,startDate:t,skip:d});return i.a.createElement(Du,{data:h,id:f,inspect:b,loading:m,fieldsMapping:Xg,from:t,to:s,updateDateRange:r,refetch:g,setQuery:o,setQuerySkip:p})},ef=i.a.memo(Zg),tf=N.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique private ips search"}),af=N.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique private ips"}),nf="networkKpiUniquePrivateIpsQuery",sf=N.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.title",{defaultMessage:"Unique private IPs"}),rf=N.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceUnitLabel",{defaultMessage:"source"}),of=N.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationUnitLabel",{defaultMessage:"destination"}),lf=N.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceChartLabel",{defaultMessage:"Src."}),cf=N.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationChartLabel",{defaultMessage:"Dest."}),uf={title:"[Network] Unique private IPs - area chart",description:"",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!1,position:"right",showSingleSeries:!1},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"area",layers:[{layerId:"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7",seriesType:"area",accessors:["5f317308-cfbb-4ee5-bfb9-07653184fabf"],layerType:"data",xAccessor:"662cd5e5-82bf-4325-a703-273f84b97e09",yConfig:[{forAccessor:"5f317308-cfbb-4ee5-bfb9-07653184fabf",color:"#d36186"}]},{layerId:"72dc4b99-b07d-4dc9-958b-081d259e11fa",seriesType:"area",accessors:["ac1eb80c-ddde-46c4-a90c-400261926762"],layerType:"data",xAccessor:"36444b8c-7e10-4069-8298-6c1b46912be2",yConfig:[{forAccessor:"ac1eb80c-ddde-46c4-a90c-400261926762",color:"#9170b8"}]}]},query:{query:"",language:"kuery"},filters:[],datasourceStates:{indexpattern:{layers:{"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7":{columns:{"662cd5e5-82bf-4325-a703-273f84b97e09":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"5f317308-cfbb-4ee5-bfb9-07653184fabf":{label:oi.l,dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"source.ip",isBucketed:!1,customLabel:!0,filter:{query:'"source.ip": "10.0.0.0/8" or "source.ip": "192.168.0.0/16" or "source.ip": "172.16.0.0/12" or "source.ip": "fd00::/8"',language:"kuery"}}},columnOrder:["662cd5e5-82bf-4325-a703-273f84b97e09","5f317308-cfbb-4ee5-bfb9-07653184fabf"],incompleteColumns:{}},"72dc4b99-b07d-4dc9-958b-081d259e11fa":{columns:{"36444b8c-7e10-4069-8298-6c1b46912be2":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"ac1eb80c-ddde-46c4-a90c-400261926762":{label:oi.g,dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",isBucketed:!1,filter:{query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"',language:"kuery"}}},columnOrder:["36444b8c-7e10-4069-8298-6c1b46912be2","ac1eb80c-ddde-46c4-a90c-400261926762"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-72dc4b99-b07d-4dc9-958b-081d259e11fa"}]},df={title:"[Network] Unique private IPs - bar chart",description:"",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!1,position:"right",showSingleSeries:!1},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"bar_horizontal_stacked",layers:[{layerId:"e406bf4f-942b-41ac-b516-edb5cef06ec8",accessors:["5acd4c9d-dc3b-4b21-9632-e4407944c36d"],position:"top",seriesType:"bar_horizontal_stacked",showGridlines:!1,layerType:"data",yConfig:[{forAccessor:"5acd4c9d-dc3b-4b21-9632-e4407944c36d",color:"#d36186"}],xAccessor:"d9c438c5-f776-4436-9d20-d62dc8c03be8"},{layerId:"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7",seriesType:"bar_horizontal_stacked",accessors:["d27e0966-daf9-41f4-9033-230cf1e76dc9"],layerType:"data",yConfig:[{forAccessor:"d27e0966-daf9-41f4-9033-230cf1e76dc9",color:"#9170b8"}],xAccessor:"4607c585-3af3-43b9-804f-e49b27796d79"}]},query:{query:"",language:"kuery"},filters:[],datasourceStates:{indexpattern:{layers:{"e406bf4f-942b-41ac-b516-edb5cef06ec8":{columns:{"5acd4c9d-dc3b-4b21-9632-e4407944c36d":{label:Object(oi.o)("source.ip"),dataType:"number",isBucketed:!1,operationType:"unique_count",scale:"ratio",sourceField:"source.ip",filter:{query:'source.ip: "10.0.0.0/8" or source.ip: "192.168.0.0/16" or source.ip: "172.16.0.0/12" or source.ip: "fd00::/8"',language:"kuery"}},"d9c438c5-f776-4436-9d20-d62dc8c03be8":{label:"Filters",dataType:"string",operationType:"filters",scale:"ordinal",isBucketed:!0,params:{filters:[{input:{query:"",language:"kuery"},label:oi.l}]}}},columnOrder:["d9c438c5-f776-4436-9d20-d62dc8c03be8","5acd4c9d-dc3b-4b21-9632-e4407944c36d"],incompleteColumns:{}},"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7":{columns:{"d27e0966-daf9-41f4-9033-230cf1e76dc9":{label:Object(oi.o)("destination.ip"),dataType:"number",isBucketed:!1,operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",filter:{query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"',language:"kuery"}},"4607c585-3af3-43b9-804f-e49b27796d79":{label:"Filters",dataType:"string",operationType:"filters",scale:"ordinal",isBucketed:!0,params:{filters:[{input:{query:"",language:"kuery"},label:oi.g}]}}},columnOrder:["4607c585-3af3-43b9-804f-e49b27796d79","d27e0966-daf9-41f4-9033-230cf1e76dc9"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-e406bf4f-942b-41ac-b516-edb5cef06ec8"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7"}]},pf=Object(B.euiPaletteColorBlind)(),mf=[{key:"UniqueIps",fields:[{key:"uniqueSourcePrivateIps",value:null,name:lf,description:rf,color:pf[2],icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columnOrder:["bd17c23e-4f83-4108-8005-2669170d064b"],columns:{"bd17c23e-4f83-4108-8005-2669170d064b":{customLabel:!0,dataType:"number",isBucketed:!1,label:"",operationType:"unique_count",scale:"ratio",sourceField:"source.ip",filter:{query:'source.ip: "10.0.0.0/8" or source.ip: "192.168.0.0/16" or source.ip: "172.16.0.0/12" or source.ip: "fd00::/8"',language:"kuery"}}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"bd17c23e-4f83-4108-8005-2669170d064b",layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",layerType:"data"}},title:"[Network] Unique private IPs - source metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3",type:"index-pattern"}]}},{key:"uniqueDestinationPrivateIps",value:null,name:cf,description:of,color:pf[3],icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{indexpattern:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columnOrder:["bd17c23e-4f83-4108-8005-2669170d064b"],columns:{"bd17c23e-4f83-4108-8005-2669170d064b":{customLabel:!0,dataType:"number",isBucketed:!1,label:"",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",filter:{language:"kuery",query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"'}}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"bd17c23e-4f83-4108-8005-2669170d064b",layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",layerType:"data"}},title:"[Network] Unique private IPs - destination metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3",type:"index-pattern"}]}}],description:sf,enableAreaChart:!0,enableBarChart:!0,areaChartLensAttributes:uf,barChartLensAttributes:df}],gf=({filterQuery:e,from:t,indexNames:a,to:s,updateDateRange:r,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(zt.a)(nf),[d,p]=Object(n.useState)(l||!c);Object(n.useEffect)((()=>{p(l||!c)}),[l,c]);const[m,{refetch:g,id:f,inspect:b,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:s})=>{const{data:r}=Object(u.k)().services,o=Object(n.useRef)(y.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new iu.Subscription),[d,p]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[f,b]=Object(n.useState)({uniqueDestinationPrivateIps:0,uniqueDestinationPrivateIpsHistogram:null,uniqueSourcePrivateIps:0,uniqueSourcePrivateIpsHistogram:null,id:nf,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:h,addWarning:E}=Object(ma.a)(),v=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,p(!0),c.current=r.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(an.isCompleteResponse)(e)?(p(!1),b((t=>({...t,uniqueDestinationPrivateIps:e.uniqueDestinationPrivateIps,uniqueDestinationPrivateIpsHistogram:e.uniqueDestinationPrivateIpsHistogram,uniqueSourcePrivateIps:e.uniqueSourcePrivateIps,uniqueSourcePrivateIpsHistogram:e.uniqueSourcePrivateIpsHistogram,inspect:Object(ou.c)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(an.isErrorResponse)(e)&&(p(!1),E(tf),c.current.unsubscribe())},error:e=>{p(!1),h(e,{title:af}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[r.search,h,E,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:rn.p.uniquePrivateIps,filterQuery:Object(Mi.a)(e),timerange:{interval:"12h",from:s,to:t}};return Ii()(n,i)?n:i}))}),[a,t,e,s]),Object(n.useEffect)((()=>(v(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,v]),Object(n.useEffect)((()=>{i&&(p(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[d,f]})({filterQuery:e,endDate:s,indexNames:a,startDate:t,skip:d});return i.a.createElement(Du,{data:h,id:f,inspect:b,loading:m,fieldsMapping:mf,from:t,to:s,updateDateRange:r,refetch:g,setQuery:o,setQuerySkip:p})},ff=i.a.memo(gf),bf=i.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:s,skip:r,updateDateRange:o})=>i.a.createElement(B.EuiFlexGroup,{wrap:!0},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(B.EuiFlexGroup,{wrap:!0},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Hg,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:s,skip:r})),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Pg,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:s,skip:r}))),i.a.createElement(B.EuiSpacer,{size:"l"}),i.a.createElement(B.EuiFlexGroup,{wrap:!0},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(ef,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:s,skip:r})),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Gg,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:s,skip:r})))),i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(ff,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:s,skip:r})))));bf.displayName="NetworkKpiComponent";var hf=a(214),yf=a(602),Ef=a(441),vf=a(347);const kf=H.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-5donvf-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),Sf=i.a.memo((({hasMlUserPermissions:e,capabilitiesFetched:t})=>{const a=Object(o.useDispatch)(),s=Object(n.useRef)(null),r=Object(n.useMemo)((()=>d.b.getTimelineByIdSelector()),[]),c=Object(E.b)((e=>{var t;return(null!==(t=r(e,l.i.networkPageEvents))&&void 0!==t?t:ge.a).graphEventId})),m=Object(n.useMemo)((()=>fn.f.globalFiltersQuerySelector()),[]),g=Object(n.useMemo)((()=>fn.f.globalQuerySelector()),[]),b=Object(E.a)(g),k=Object(E.a)(m),{to:S,from:T,setQuery:x,isInitializing:w}=Object(U.a)(),{globalFullScreen:O}=Object(de.a)(),j=Object(u.k)(),{tabName:I}=Object(P.useParams)(),C=j.services.application.capabilities.maps.show,M=Object(n.useMemo)((()=>I===vf.a.events?k.length>0?[...k,...Ln.a]:Ln.a:k),[I,k]),D=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;a(Object(J.setAbsoluteRangeDatePicker)({id:V.a.global,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[a]),{indicesExist:A,indexPattern:F,selectedPatterns:R}=Object(p.d)(),_=Object(n.useCallback)((()=>{var e,t;null===(e=s.current)||void 0===e||null===(t=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===t||t.focus()}),[s]),q=Object(n.useCallback)((()=>{Object(me.l)()}),[]),N=Object(n.useCallback)((e=>{Object($.isTab)(e)&&Object(me.k)({containerElement:s.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:_,onSkipFocusAfterEventsTable:q})}),[s,_,q]),[L,z]=Object(Ac.c)({config:Object(an.getEsQueryConfig)(j.services.uiSettings),indexPattern:F,queries:[b],filters:k}),[H]=Object(Ac.c)({config:Object(an.getEsQueryConfig)(j.services.uiSettings),indexPattern:F,queries:[b],filters:M});return Object(Rc.a)({id:"NetworkQueryId",filterQuery:L,kqlError:z,query:b,startDate:T,endDate:S}),i.a.createElement(i.a.Fragment,null,A?i.a.createElement(kf,{onKeyDown:N,ref:s},i.a.createElement(B.EuiWindowEvent,{event:"resize",handler:y.noop}),i.a.createElement(Q.a,{show:Object(me.m)({globalFullScreen:O,graphEventId:c})},i.a.createElement(G.a,{indexPattern:F,id:V.a.global})),i.a.createElement(f.a,{noPadding:O},i.a.createElement(pe.a,{show:!O},i.a.createElement(Yt.a,{subtitle:i.a.createElement(on.a,{indexKey:rn.k.network,indexNames:R}),title:Ef.h,border:!0}),C&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiPanel,{hasBorder:!0,paddingSize:"none","data-test-subj":"conditional-embeddable-map"},i.a.createElement(Cg,{query:b,filters:k,startDate:T,endDate:S,setQuery:x})),i.a.createElement(B.EuiSpacer,null)),i.a.createElement(bf,{filterQuery:L,from:T,indexNames:R,updateDateRange:D,setQuery:x,skip:w||void 0===L,to:S})),t&&!w?i.a.createElement(i.a.Fragment,null,i.a.createElement(pe.a,{show:!O},i.a.createElement(B.EuiSpacer,null),i.a.createElement(mn.a,{navTabs:Object(yf.j)(e)}),i.a.createElement(B.EuiSpacer,null)),i.a.createElement(yf.e,{filterQuery:H,from:T,isInitializing:w,indexPattern:F,indexNames:R,setQuery:x,type:hf.c.NetworkType.page,to:S})):i.a.createElement(yf.f,null))):i.a.createElement(Xt.a,null),i.a.createElement(h.a,{pageName:v.a.network}))}));Sf.displayName="NetworkComponent";const Tf=i.a.memo(Sf),xf=i.a.memo((()=>{const{path:e}=Object(P.useRouteMatch)();return i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{strict:!0,exact:!0,path:e,render:({location:e})=>{const t=Object(Lc.parse)(e.search.substring(1),{sort:!1});null!=t.query&&(t.query=Xc(t.query));const a=Object(Lc.stringify)(Bc.url.encodeQuery(t),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${r.Sb}?${a}`})}}),i.a.createElement(_.Route,{path:`${e}/ip/:ip`,render:({location:e,match:{params:{ip:t}}})=>{const a=Object(Lc.parse)(e.search.substring(1),{sort:!1});if(null!=a.query&&(a.query=Xc(a.query)),Zc(t)){const e=Object(Lc.stringify)(Bc.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${r.Sb}?${e}`})}if(eu(t)){const e=tu(t);a.query=Qc(["source.ip","destination.ip"],e,a.query||"");const n=Object(Lc.stringify)(Bc.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${r.Sb}?${n}`})}{const e=Object(Lc.stringify)(Bc.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${r.Sb}/ip/${t}?${e}`})}}}),i.a.createElement(_.Route,{path:`${r.Sb}/ml-network/`,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{from:`${r.Sb}/ml-network/`,to:{pathname:`${r.Sb}/ml-network`,search:e}})}))}));xf.displayName="MlNetworkConditionalContainer";var wf=a(521);const Of=(e,t)=>`${r.Sb}/ip/${e}/${t||rn.g.source}/${vf.a.flows}`,jf=()=>{const e=Object(dn.a)(),t=e.capabilitiesFetched,a=Object(n.useMemo)((()=>Object(un.a)(e)),[e]),s=Object(n.useMemo)((()=>Object(yf.i)(t,a)),[t,a]);return i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{exact:!0,strict:!0,path:r.Sb,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${r.Sb}/${vf.a.flows}`,search:e}})}),i.a.createElement(_.Route,{path:`${r.Sb}/ml-network`},i.a.createElement(xf,null)),i.a.createElement(_.Route,{strict:!0,path:s},i.a.createElement(Tf,{capabilitiesFetched:e.capabilitiesFetched,hasMlUserPermissions:a})),i.a.createElement(_.Route,{path:wf.c},i.a.createElement(mm.a,null)),i.a.createElement(_.Route,{path:`${wf.b}/:flowTarget(${wf.a})?`,render:({match:{params:{detailName:e,flowTarget:t}},location:{search:a=""}})=>i.a.createElement(P.Redirect,{to:{pathname:Of(e,t),search:a}})}),i.a.createElement(_.Route,null,i.a.createElement(P.Redirect,{to:{pathname:r.Sb}})))},If=i.a.memo(jf),Cf=[{path:r.Sb,component:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:v.a.network},i.a.createElement(If,null)))}],Mf=N.i18n.translate("xpack.securitySolution.kubernetes.columnSessionStart",{defaultMessage:"Date connected"}),Df=N.i18n.translate("xpack.securitySolution.kubernetes.columnExecutable",{defaultMessage:"Session leader"}),Af=N.i18n.translate("xpack.securitySolution.kubernetes.columnNode",{defaultMessage:"Node"}),Ff=N.i18n.translate("xpack.securitySolution.kubernetes.columnEntryUser",{defaultMessage:"Session entry user"}),Rf=N.i18n.translate("xpack.securitySolution.kubernetes.columnInteractive",{defaultMessage:"Interactivity"}),Pf=N.i18n.translate("xpack.securitySolution.kubernetes.columnEntryType",{defaultMessage:"Entry type"}),_f=N.i18n.translate("xpack.securitySolution.kubernetes.columnContainer",{defaultMessage:"Container"}),qf=N.i18n.translate("xpack.securitySolution.kubernetes.columnPod",{defaultMessage:"Pod"}),Nf=[{columnHeaderType:rc.a,id:"process.entry_leader.start",initialWidth:oc.b,display:Mf},{columnHeaderType:rc.a,id:"process.entry_leader.user.name",display:Ff},{columnHeaderType:rc.a,id:"process.entry_leader.executable",display:Df},{columnHeaderType:rc.a,id:"cloud.instance.name",display:Af},{columnHeaderType:rc.a,id:"process.entry_leader.entry_meta.type",display:Pf},{columnHeaderType:rc.a,id:"process.entry_leader.interactive",display:Rf},{columnHeaderType:rc.a,id:"container.name",display:_f},{columnHeaderType:rc.a,id:"orchestrator.resource.name",display:qf}],Lf=i.a.memo((()=>{const{kubernetesSecurity:e,uiSettings:t}=Object(u.k)().services,{globalFullScreen:a}=Object(de.a)(),{indexPattern:s}=Object(p.d)(),{from:o,to:c}=Object(U.a)(),d=Object(n.useMemo)((()=>fn.f.globalFiltersQuerySelector()),[]),m=Object(n.useMemo)((()=>fn.f.globalQuerySelector()),[]),g=Object(E.a)(m),b=Object(E.a)(d),[y,v]=Object(n.useMemo)((()=>Object(Ac.c)({config:Object(an.getEsQueryConfig)(t),indexPattern:s,queries:[g],filters:b})),[b,s,t,g]);Object(Rc.a)({id:"kubernetesQuery",filterQuery:y,kqlError:v,query:g,startDate:o,endDate:c});const k=Object(n.useCallback)((e=>i.a.createElement(wc,{timelineId:l.i.kubernetesPageSessions,endDate:c,pageFilters:[],startDate:o,filterQuery:e,columns:Nf,defaultColumns:Nf})),[o,c]);return i.a.createElement(f.a,{noPadding:!0},e.getKubernetesPage({filter:i.a.createElement(Q.a,{show:Object(me.m)({globalFullScreen:a,graphEventId:void 0})},i.a.createElement(G.a,{id:V.a.global,indexPattern:s})),indexPattern:s,globalFilter:{filterQuery:y,startDate:o,endDate:c},renderSessionsView:k}),i.a.createElement(h.a,{pageName:r.uc.kubernetes}))}));Lf.displayName="KubernetesContainer";const Bf=[{path:r.Nb,component:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:v.a.kubernetes},i.a.createElement(Lf,null)))}],zf=Object(n.memo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Xt.a,null),i.a.createElement(h.a,{pageName:r.uc.landing}))));zf.displayName="LandingPage";var Hf=a(316),$f=a(949);const Vf=N.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),Uf="overviewHostQuery",Qf=H.a.div.withConfig({displayName:"ProgressContainer",componentId:"sc-1qvjg2g-0"})(["margin-left:8px;min-width:100px;@media only screen and (min-width:1400px){min-width:200px;}"]),Wf=H()(B.EuiLoadingContent).withConfig({displayName:"LoadingContent",componentId:"sc-1qvjg2g-1"})([".euiLoadingContent__singleLine{margin-bottom:0px;}"]),Gf=({count:e,isGroupStat:t,isLoading:a,max:s})=>{const[o]=Object(u.q)(r.Y),[l,c]=Object(n.useState)(!0);return Object(n.useEffect)((()=>{l&&!a&&c(!1)}),[a,l,c]),i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1,justifyContent:"spaceBetween"},i.a.createElement(B.EuiFlexItem,{grow:!1},!l&&i.a.createElement(B.EuiText,{color:t?"default":"subdued",size:t?"m":"s"},_t()(e).format(o))),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(Qf,null,a?i.a.createElement(Wf,{"data-test-subj":"stat-value-loading-spinner",lines:1}):i.a.createElement(B.EuiProgress,{color:t?"primary":"subdued",max:s,size:"m",value:e}))))};Gf.displayName="StatValueComponent";const Kf=i.a.memo(Gf),Jf=e=>{var t,a,n,s,r,o,l,c,u,d,p,m,g,f,b,h;return[{count:null!==(t=e.auditbeatAuditd)&&void 0!==t?t:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatAuditTitle",defaultMessage:"Audit"}),id:"auditbeatAuditd"},{count:null!==(a=e.auditbeatFIM)&&void 0!==a?a:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatFimTitle",defaultMessage:"File Integrity Module"}),id:"auditbeatFIM"},{count:null!==(n=e.auditbeatLogin)&&void 0!==n?n:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatLoginTitle",defaultMessage:"Login"}),id:"auditbeatLogin"},{count:null!==(s=e.auditbeatPackage)&&void 0!==s?s:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatPackageTitle",defaultMessage:"Package"}),id:"auditbeatPackage"},{count:null!==(r=e.auditbeatProcess)&&void 0!==r?r:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatProcessTitle",defaultMessage:"Process"}),id:"auditbeatProcess"},{count:null!==(o=e.auditbeatUser)&&void 0!==o?o:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatUserTitle",defaultMessage:"User"}),id:"auditbeatUser"},{count:null!==(l=e.endgameDns)&&void 0!==l?l:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endgameDnsTitle",defaultMessage:"DNS"}),id:"endgameDns"},{count:null!==(c=e.endgameFile)&&void 0!==c?c:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endgameFileTitle",defaultMessage:"File"}),id:"endgameFile"},{count:null!==(u=e.endgameImageLoad)&&void 0!==u?u:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endgameImageLoadTitle",defaultMessage:"Image Load"}),id:"endgameImageLoad"},{count:null!==(d=e.endgameNetwork)&&void 0!==d?d:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endgameNetworkTitle",defaultMessage:"Network"}),id:"endgameNetwork"},{count:null!==(p=e.endgameProcess)&&void 0!==p?p:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endgameProcessTitle",defaultMessage:"Process"}),id:"endgameProcess"},{count:null!==(m=e.endgameRegistry)&&void 0!==m?m:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endgameRegistryTitle",defaultMessage:"Registry"}),id:"endgameRegistry"},{count:null!==(g=e.endgameSecurity)&&void 0!==g?g:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endgameSecurityTitle",defaultMessage:"Security"}),id:"endgameSecurity"},{count:null!==(f=e.filebeatSystemModule)&&void 0!==f?f:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatSystemModuleTitle",defaultMessage:"System Module"}),id:"filebeatSystemModule"},{count:null!==(b=e.winlogbeatSecurity)&&void 0!==b?b:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatSecurityTitle",defaultMessage:"Security"}),id:"winlogbeatSecurity"},{count:null!==(h=e.winlogbeatMWSysmonOperational)&&void 0!==h?h:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatMWSysmonOperational",defaultMessage:"Microsoft-Windows-Sysmon/Operational"}),id:"winlogbeatMWSysmonOperational"}]},Yf=H.a.div.withConfig({displayName:"HostStatsContainer",componentId:"sc-ej4zfy-0"})([".accordion-button{width:100%;}"]),Xf=[{groupId:"auditbeat",name:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatAuditd","auditbeatFIM","auditbeatLogin","auditbeatPackage","auditbeatProcess","auditbeatUser"]},{groupId:"endgame",name:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupElasticEndpointSecurity",defaultMessage:"Endpoint Security"}),statIds:["endgameDns","endgameFile","endgameImageLoad","endgameNetwork","endgameProcess","endgameRegistry","endgameSecurity"]},{groupId:"filebeat",name:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatSystemModule"]},{groupId:"winlogbeat",name:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupWinlogbeat",defaultMessage:"Winlogbeat"}),statIds:["winlogbeatSecurity","winlogbeatMWSysmonOperational"]}],Zf=H.a.div.withConfig({displayName:"MoveItLeftTitle",componentId:"sc-ej4zfy-1"})(["margin-left:24px;@media only screen and (min-width:","){max-width:40px;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),eb=H.a.div.withConfig({displayName:"MoveItLeft",componentId:"sc-ej4zfy-2"})(["margin-left:24px;"]),tb=H()(B.EuiFlexItem).withConfig({displayName:"NoMarginTopFlexItem",componentId:"sc-ej4zfy-3"})(["@media only screen and (max-width:","){margin-top:-10px !important;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),ab=H.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-ej4zfy-4"})(["margin-top:8px;"]),nb=({data:e,loading:t})=>{const a=Jf(e),n=a.reduce(((e,t)=>e+t.count),0);return i.a.createElement(Yf,{"data-test-subj":"overview-hosts-stats"},Xf.map(((e,s)=>{const r=a.filter((t=>e.statIds.includes(t.id))),o=r.reduce(((e,t)=>e+t.count),0);return i.a.createElement(i.a.Fragment,{key:e.groupId},i.a.createElement(B.EuiHorizontalRule,{margin:"xs"}),i.a.createElement(B.EuiAccordion,{id:`host-stat-accordion-group${e.groupId}`,buttonContent:i.a.createElement(B.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiText,null,e.name)),i.a.createElement(tb,{grow:!1},i.a.createElement(Kf,{count:o,isGroupStat:!0,isLoading:t,max:n}))),buttonContentClassName:"accordion-button"},i.a.createElement(ab,null,r.map((e=>i.a.createElement(B.EuiFlexGroup,{key:e.id,gutterSize:"s",justifyContent:"spaceBetween"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiText,{color:"subdued",size:"s"},i.a.createElement(Zf,null,e.title))),i.a.createElement(tb,{"data-test-subj":`host-stat-${e.id}`,grow:!1},i.a.createElement(eb,null,i.a.createElement(Kf,{count:e.count,isGroupStat:!1,isLoading:t,max:o})))))))))})))},ib=i.a.memo(nb),sb=Object(Pi.a)(ib),rb=({endDate:e,filterQuery:t,indexNames:a,startDate:s,setQuery:o})=>{const[l]=Object(u.q)(r.Y),{toggleStatus:c,setToggleStatus:d}=Object(zt.a)(Uf),[p,m]=Object(n.useState)(void 0===t||!c);Object(n.useEffect)((()=>{m(void 0===t||!c)}),[t,c]);const g=Object(n.useCallback)((e=>{d(e),m(!e)}),[m,d]),[f,{overviewHost:b,id:h,inspect:E,refetch:k}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:s})=>{const{loading:r,result:o,search:l,refetch:c,inspect:u}=Object(Fi.a)({factoryQueryType:Ci.h.overview,initialResult:{overviewHost:{}},errorMessage:Vf,abort:i}),d=Object(n.useMemo)((()=>({endDate:t,overviewHost:o.overviewHost,id:Uf,inspect:u,isInspected:!1,refetch:c,startDate:s})),[t,u,c,o.overviewHost,s]),p=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:Ci.h.overview,filterQuery:Object(Mi.a)(e),timerange:{interval:"12h",from:s,to:t}})),[t,e,a,s]);return Object(n.useEffect)((()=>{i||l(p)}),[p,l,i]),[r,d]})({endDate:e,filterQuery:t,indexNames:a,startDate:s,skip:p}),S=Object(n.useMemo)((()=>Jf(b).reduce(((e,t)=>e+t.count),0)),[b]),T=Object(n.useMemo)((()=>_t()(S).format(l)),[l,S]),x=Object(n.useMemo)((()=>i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.hostsTitle",defaultMessage:"Host events"})),[]),w=Object(n.useMemo)((()=>Object(y.isEmpty)(b)?i.a.createElement(i.a.Fragment,null,""):i.a.createElement(Hs.FormattedMessage,{defaultMessage:"Showing: {formattedHostEventsCount} {hostEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewHost.hostsSubtitle",values:{hostEventsCount:S,formattedHostEventsCount:T}})),[T,S,b]);return i.a.createElement(De.c,{show:c},i.a.createElement(B.EuiPanel,{hasBorder:!0},i.a.createElement(Tt.a,{id:Uf,subtitle:w,toggleStatus:c,toggleQuery:g,title:x,isInspectDisabled:void 0===t},i.a.createElement(ue.l,{deepLinkId:v.a.hosts},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.hostsAction",defaultMessage:"View hosts"}))),c&&i.a.createElement(sb,{loading:f,data:b,setQuery:o,id:h,inspect:E,refetch:k})))};rb.displayName="OverviewHostComponent";const ob=i.a.memo(rb),lb=(N.i18n.translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"}),N.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"})),cb="overviewNetworkQuery",ub=e=>{var t,a,n,s,r,o,l,c,u;return[{count:null!==(t=e.auditbeatSocket)&&void 0!==t?t:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatSocketTitle",defaultMessage:"Socket"}),id:"auditbeatSocket"},{count:null!==(a=e.filebeatCisco)&&void 0!==a?a:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatCiscoTitle",defaultMessage:"Cisco"}),id:"filebeatCisco"},{count:null!==(n=e.filebeatNetflow)&&void 0!==n?n:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatNetflowTitle",defaultMessage:"Netflow"}),id:"filebeatNetflow"},{count:null!==(s=e.filebeatPanw)&&void 0!==s?s:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatPanwTitle",defaultMessage:"Palo Alto Networks"}),id:"filebeatPanw"},{count:null!==(r=e.filebeatSuricata)&&void 0!==r?r:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatSuricataTitle",defaultMessage:"Suricata"}),id:"filebeatSuricata"},{count:null!==(o=e.filebeatZeek)&&void 0!==o?o:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatZeekTitle",defaultMessage:"Zeek"}),id:"filebeatZeek"},{count:null!==(l=e.packetbeatDNS)&&void 0!==l?l:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatDnsTitle",defaultMessage:"DNS"}),id:"packetbeatDNS"},{count:null!==(c=e.packetbeatFlow)&&void 0!==c?c:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatFlowTitle",defaultMessage:"Flow"}),id:"packetbeatFlow"},{count:null!==(u=e.packetbeatTLS)&&void 0!==u?u:0,title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.packetbeatTLSTitle",defaultMessage:"TLS"}),id:"packetbeatTLS"}]},db=[{groupId:"auditbeat",name:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatSocket"]},{groupId:"filebeat",name:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatCisco","filebeatNetflow","filebeatPanw","filebeatSuricata","filebeatZeek"]},{groupId:"packetbeat",name:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupPacketbeat",defaultMessage:"Packetbeat"}),statIds:["packetbeatDNS","packetbeatFlow","packetbeatTLS"]}],pb=H.a.div.withConfig({displayName:"NetworkStatsContainer",componentId:"sc-1wm45zw-0"})([".accordion-button{width:100%;}"]),mb=H.a.div.withConfig({displayName:"MoveItLeftTitle",componentId:"sc-1wm45zw-1"})(["margin-left:24px;@media only screen and (min-width:","){max-width:40px;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),gb=H.a.div.withConfig({displayName:"MoveItLeft",componentId:"sc-1wm45zw-2"})(["margin-left:24px;"]),fb=H()(B.EuiFlexItem).withConfig({displayName:"NoMarginTopFlexItem",componentId:"sc-1wm45zw-3"})(["@media only screen and (max-width:","){margin-top:-10px !important;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),bb=H.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-1wm45zw-4"})(["margin-top:8px;"]),hb=({data:e,loading:t})=>{const a=ub(e),n=a.reduce(((e,t)=>e+t.count),0);return i.a.createElement(pb,{"data-test-subj":"overview-network-stats"},db.map(((e,s)=>{const r=a.filter((t=>e.statIds.includes(t.id))),o=r.reduce(((e,t)=>e+t.count),0);return i.a.createElement(i.a.Fragment,{key:e.groupId},i.a.createElement(B.EuiHorizontalRule,{margin:"xs"}),i.a.createElement(B.EuiAccordion,{id:`network-stat-accordion-group${e.groupId}`,buttonContent:i.a.createElement(B.EuiFlexGroup,{"data-test-subj":`network-stat-group-${e.groupId}`,justifyContent:"spaceBetween",gutterSize:"s"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiText,null,e.name)),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(Kf,{count:o,isGroupStat:!0,isLoading:t,max:n}))),buttonContentClassName:"accordion-button"},i.a.createElement(bb,null,r.map((e=>i.a.createElement(B.EuiFlexGroup,{key:e.id,gutterSize:"s",justifyContent:"spaceBetween"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiText,{color:"subdued",size:"s"},i.a.createElement(mb,null,e.title))),i.a.createElement(fb,{"data-test-subj":`network-stat-${e.id}`,grow:!1},i.a.createElement(gb,null,i.a.createElement(Kf,{count:e.count,isGroupStat:!1,isLoading:t,max:o})))))))))})))},yb=i.a.memo(hb),Eb=Object(Pi.a)(yb),vb=({endDate:e,filterQuery:t,indexNames:a,startDate:s,setQuery:o})=>{const{formatUrl:l,search:d}=Object(c.l)(v.a.network),{navigateToApp:p}=Object(u.k)().services.application,[m]=Object(u.q)(r.Y),{toggleStatus:g,setToggleStatus:f}=Object(zt.a)(cb),[b,h]=Object(n.useState)(void 0===t||!g);Object(n.useEffect)((()=>{h(void 0===t||!g)}),[t,g]);const E=Object(n.useCallback)((e=>{f(e),h(!e)}),[h,f]),[k,{overviewNetwork:S,id:T,inspect:x,refetch:w}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:s})=>{const{loading:r,result:o,search:l,refetch:c,inspect:u}=Object(Fi.a)({factoryQueryType:Ci.p.overview,initialResult:{overviewNetwork:{}},errorMessage:lb,abort:i}),d=Object(n.useMemo)((()=>({endDate:t,overviewNetwork:o.overviewNetwork,id:cb,inspect:u,isInspected:!1,refetch:c,startDate:s})),[t,u,c,o.overviewNetwork,s]),p=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:Ci.p.overview,filterQuery:Object(Mi.a)(e),timerange:{interval:"12h",from:s,to:t}})),[t,e,a,s]);return Object(n.useEffect)((()=>{i||l(p)}),[p,l,i]),[r,d]})({endDate:e,filterQuery:t,indexNames:a,startDate:s,skip:b}),O=Object(n.useCallback)((e=>{e.preventDefault(),p(r.A,{deepLinkId:v.a.network,path:Object(c.g)(d)})}),[p,d]),j=Object(n.useMemo)((()=>ub(S).reduce(((e,t)=>e+t.count),0)),[S]),I=Object(n.useMemo)((()=>_t()(j).format(m)),[m,j]),C=Object(n.useMemo)((()=>i.a.createElement(ue.g,{"data-test-subj":"overview-network-go-to-network-page",onClick:O,href:l(Object(c.g)())},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.networkAction",defaultMessage:"View network"}))),[O,l]),M=Object(n.useMemo)((()=>i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.networkTitle",defaultMessage:"Network events"})),[]),D=Object(n.useMemo)((()=>Object(y.isEmpty)(S)?i.a.createElement(i.a.Fragment,null,""):i.a.createElement(Hs.FormattedMessage,{defaultMessage:"Showing: {formattedNetworkEventsCount} {networkEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewNetwork.networkSubtitle",values:{formattedNetworkEventsCount:I,networkEventsCount:j}})),[I,j,S]);return i.a.createElement(De.c,{show:g},i.a.createElement(B.EuiPanel,{hasBorder:!0,"data-test-subj":"overview-network-query"},i.a.createElement(i.a.Fragment,null,i.a.createElement(Tt.a,{id:cb,subtitle:D,title:M,toggleStatus:g,toggleQuery:E,isInspectDisabled:void 0===t},C),g&&i.a.createElement(Eb,{loading:k,data:S,id:T,inspect:x,setQuery:o,refetch:w}))))};vb.displayName="OverviewNetworkComponent";const kb=i.a.memo(vb),Sb=({filters:e,from:t,indexNames:a,indexPattern:s,query:r,setQuery:o,to:l})=>{const{uiSettings:c}=Object(u.k)().services,[d,p]=Object(n.useMemo)((()=>Object(Ac.c)({config:Object(an.getEsQueryConfig)(c),indexPattern:s,queries:[r],filters:[...e,...Ln.e]})),[e,s,r,c]),[m]=Object(n.useMemo)((()=>Object(Ac.c)({config:Object(an.getEsQueryConfig)(c),indexPattern:s,queries:[r],filters:[...e,...Ln.a]})),[e,s,c,r]);return Object(Rc.a)({id:Uf,filterQuery:d||m,kqlError:p,query:r,startDate:t,endDate:l}),i.a.createElement(B.EuiFlexGroup,{direction:"row"},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(ob,{endDate:l,filterQuery:d,indexNames:a,startDate:t,setQuery:o})),i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(kb,{endDate:l,filterQuery:m,indexNames:a,startDate:t,setQuery:o})))},Tb=i.a.memo(Sb),xb=N.i18n.translate("xpack.securitySolution.recentTimelines.favoritesButtonLabel",{defaultMessage:"Favorites"}),wb=N.i18n.translate("xpack.securitySolution.recentTimelines.noFavoriteTimelinesMessage",{defaultMessage:"You haven't favorited any timelines yet. Get out there and start threat hunting!"}),Ob=N.i18n.translate("xpack.securitySolution.recentTimelines.lastUpdatedButtonLabel",{defaultMessage:"Last updated"}),jb=N.i18n.translate("xpack.securitySolution.recentTimelines.noTimelinesMessage",{defaultMessage:"You haven't created any timelines yet. Get out there and start threat hunting!"}),Ib=N.i18n.translate("xpack.securitySolution.recentTimelines.notesTooltip",{defaultMessage:"Notes"}),Cb=N.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTooltip",{defaultMessage:"Open as a timeline duplicate"}),Mb=N.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTemplateTooltip",{defaultMessage:"Open as a template duplicate"}),Db=N.i18n.translate("xpack.securitySolution.recentTimelines.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),Ab=N.i18n.translate("xpack.securitySolution.recentTimelines.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),Fb=N.i18n.translate("xpack.securitySolution.recentTimelines.viewAllTimelinesLink",{defaultMessage:"View all timelines"}),Rb=N.i18n.translate("xpack.securitySolution.recentTimelines.filterControlLegend",{defaultMessage:"Timelines filter"}),Pb=[{id:"favorites",label:xb,iconType:"starFilled"},{id:"recently-updated",label:Ob,iconType:"documentEdit"}],_b=i.a.memo((({filterBy:e,setFilterBy:t})=>i.a.createElement(B.EuiButtonGroup,{options:Pb,idSelected:e,onChange:e=>{t(e)},isIconOnly:!0,legend:Rb})));_b.displayName="Filters";var qb=a(117),Nb=a(302);const Lb=i.a.memo((({onOpenTimeline:e,timeline:t,timeline:{title:a,savedObjectId:s}})=>{const r=Object(n.useCallback)((()=>e({duplicate:!1,timelineId:`${s}`})),[e,s]);return i.a.createElement(B.EuiText,{size:"s"},i.a.createElement(B.EuiLink,{onClick:r},Object(Nb.f)(t)?Ab:a))}));Lb.displayName="RecentTimelineHeader";var Bb=a(724);const zb=H()(B.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1ht70gq-0"})(["margin-right:8px;"]),Hb=H()(B.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1ht70gq-1"})(["margin-right:16px;"]),$b=i.a.memo((({count:e,icon:t,tooltip:a})=>i.a.createElement(B.EuiToolTip,{content:a},i.a.createElement(Hb,{alignItems:"center",gutterSize:"none"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(zb,{color:"subdued",size:"s",type:t})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiText,{color:"subdued",size:"xs"},e))))));$b.displayName="IconWithCount";const Vb=i.a.memo((({timeline:e})=>i.a.createElement("div",null,i.a.createElement($b,{count:Object(Nb.e)(e),icon:"pinFilled",tooltip:Db}),i.a.createElement($b,{count:Object(Nb.d)(e),icon:"editorComment",tooltip:Ib}))));Vb.displayName="RecentTimelineCounts";const Ub=H.a.div.withConfig({displayName:"ClampText",componentId:"sc-1pmjzib-0"})(["display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;word-break:break-word;"]),Qb=i.a.memo((({timeline:e,onOpenTimeline:t,isLastItem:a})=>{const s=Object(n.useCallback)((()=>t({duplicate:!0,timelineId:`${e.savedObjectId}`})),[t,e.savedObjectId]),r=Object(n.useCallback)((a=>i.a.createElement(B.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween","data-test-subj":"overview-recent-timelines"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(Lb,{onOpenTimeline:t,timeline:e}),i.a.createElement(Vb,{timeline:e}),e.description&&e.description.length&&i.a.createElement(B.EuiText,{color:"subdued",size:"xs"},i.a.createElement(Ub,null,e.description))),a&&i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiToolTip,{content:e.timelineType===l.m.default?Cb:Mb},i.a.createElement(B.EuiButtonIcon,{"aria-label":e.timelineType===l.m.default?Cb:Mb,"data-test-subj":"open-duplicate",isDisabled:null==e.savedObjectId,iconSize:"s",iconType:"copy",onClick:s,size:"s"}))))),[s,t,e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Bb.a,{render:r}),i.a.createElement(i.a.Fragment,null,!a&&i.a.createElement(B.EuiSpacer,{size:"l"})))}));Qb.displayName="RecentTimelinesItem";const Wb=i.a.memo((({noTimelinesMessage:e,onOpenTimeline:t,timelines:a})=>{const s=Object(n.useMemo)((()=>a.map(((e,n)=>i.a.createElement(Qb,{key:`${e.savedObjectId}-${e.title}`,timeline:e,onOpenTimeline:t,isLastItem:n===a.length-1})))),[t,a]);return 0===a.length?i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiText,{color:"subdued",size:"s"},e)):i.a.createElement(i.a.Fragment,null,s)}));Wb.displayName="RecentTimelines";const Gb=({lines:e,placeholders:t})=>i.a.createElement(i.a.Fragment,null,[...Array(t).keys()].map(((a,n)=>i.a.createElement(i.a.Fragment,{key:n},i.a.createElement(B.EuiLoadingContent,{lines:e}),n!==t-1&&i.a.createElement(B.EuiSpacer,{size:"l"})))));Gb.displayName="LoadingPlaceholdersComponent";const Kb=i.a.memo(Gb);var Jb=a(960);const Yb=({filterBy:e})=>{const t=Object(o.useDispatch)(),a=Object(n.useCallback)((e=>t(Object(k.updateIsLoading)(e))),[t]),s=Object(n.useMemo)((()=>Object(Nb.b)(t)),[t]),{formatUrl:d}=Object(c.l)(v.a.timelines),{navigateToApp:p}=Object(u.k)().services.application,m=Object(n.useCallback)((({duplicate:e,timelineId:t})=>{Object(Nb.h)({duplicate:e,timelineId:t,updateIsLoading:a,updateTimeline:s})}),[a,s]),g=Object(n.useCallback)((e=>{e.preventDefault(),p(r.A,{deepLinkId:v.a.timelines})}),[p]),f="favorites"===e?wb:jb,b=Object(n.useMemo)((()=>i.a.createElement(ue.f,{onClick:g,href:d("")},Fb)),[g,d]),h=Object(n.useMemo)((()=>i.a.createElement(Kb,{lines:2,placeholders:"favorites"===e?1:3})),[e]),{fetchAllTimeline:y,timelines:E,loading:S}=Object(qb.b)(),T=l.m.default,{timelineStatus:x}=Object(Jb.a)({timelineType:T});return Object(n.useEffect)((()=>{y({pageInfo:{pageIndex:1,pageSize:3},search:"",sort:{sortField:l.f.updated,sortOrder:rn.b.desc},onlyUserFavorite:"favorites"===e,status:x,timelineType:T})}),[y,e,x,T]),i.a.createElement(i.a.Fragment,null,S?h:i.a.createElement(Wb,{noTimelinesMessage:f,onOpenTimeline:m,timelines:null!=E?E:[]}),i.a.createElement(B.EuiHorizontalRule,{margin:"s"}),i.a.createElement(B.EuiText,{size:"xs"},b))};Yb.displayName="StatefulRecentTimelinesComponent";const Xb=i.a.memo(Yb);var Zb=a(661),eh=a.n(Zb);const th="en",ah=[],nh=i.a.memo((({children:e,title:t})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiTitle,{size:"xs"},i.a.createElement("h2",null,t))),i.a.createElement(B.EuiFlexItem,{grow:!1},e)),i.a.createElement(B.EuiHorizontalRule,{margin:"s"}))));nh.displayName="SidebarHeader";const ih=N.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessage",{defaultMessage:"Your current news feed URL returned no recent news."}),sh=N.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessageForAdmin",{defaultMessage:"Your current news feed URL returned no recent news. You may update the URL or disable security news via"}),rh=N.i18n.translate("xpack.securitySolution.newsFeed.advancedSettingsLinkTitle",{defaultMessage:"Security Solution advanced settings"}),oh=i.a.memo((()=>{var e;const{getUrlForApp:t,navigateToApp:a,capabilities:s}=Object(u.k)().services.application,r=null!==(e=s.management.kibana.settings)&&void 0!==e&&e,o=Object(n.useCallback)((()=>a("management",{path:"/kibana/settings"})),[a]);return i.a.createElement(B.EuiText,{color:"subdued",size:"s"},r?sh:ih,r&&i.a.createElement(i.a.Fragment,null," ",i.a.createElement(ue.f,{onClick:o,href:`${t("management",{path:"/kibana/settings"})}`},rh),"."))}));oh.displayName="NoNews";const lh=({href:e,children:t})=>i.a.createElement(B.EuiLink,{href:e,rel:"noopener nofollow noreferrer",target:"_blank"},t),ch=H.a.img.withConfig({displayName:"NewsItemPreviewImage",componentId:"sc-e9sq8j-0"})(["height:56px;margin-left:16px;min-width:56px;padding:4px;width:56px;"]),uh=i.a.memo((({newsItem:e})=>{const{linkUrl:t,title:a,publishOn:n,description:s,imageUrl:r}=e;return(({publishOn:e,expireOn:t})=>$o()(Date.now()).isAfter(e)&&$o()(Date.now()).isBefore(t))(e)?i.a.createElement(B.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiText,{size:"s"},i.a.createElement(lh,{href:t},a)),i.a.createElement(B.EuiText,{color:"subdued",size:"xs"},i.a.createElement(Ba.e,{value:n}),i.a.createElement(B.EuiSpacer,{size:"s"}),i.a.createElement("div",null,s),i.a.createElement(B.EuiSpacer,{size:"l"}))),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement("div",null,r&&i.a.createElement(ch,{alt:a,className:"euiPanel",src:r})))):null}));uh.displayName="Post";const dh=({news:e})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(nh,{title:Cc.e}),null==e?i.a.createElement(Kb,{lines:4,placeholders:5}):0===e.length?i.a.createElement(oh,null):e.map((e=>i.a.createElement(uh,{key:e.hash,newsItem:e}))));dh.displayName="NewsFeedComponent";const ph=i.a.memo(dh),mh=i.a.memo((({enableNewsFeedSetting:e,newsFeedSetting:t})=>{const a=Object(u.k)().services.newsfeed,[s]=Object(u.q)(e),[r]=Object(u.q)(t),[o,l]=Object(n.useState)(null),c=a&&s,d=(({newsFeedUrlSetting:e,getKibanaVersion:t})=>{return[null==e?void 0:e.trim().replace(/\/$/,""),`v${a=t(),null!==(n=null===(i=eh()(a))||void 0===i?void 0:i.version)&&void 0!==n?n:a}.json`].join("/");var a,n,i})({newsFeedUrlSetting:r,getKibanaVersion:()=>u.b.getKibanaVersion()});return Object(n.useEffect)((()=>{let e=!1;return c&&(async()=>{try{const t=await(async({newsFeedUrl:e})=>u.b.get().http.fetch(e,{method:"GET",credentials:"omit",mode:"cors"}))({newsFeedUrl:d});e||l((e=>{const t=""===document.documentElement.lang?"en":null!==(a=document.documentElement.lang)&&void 0!==a?a:"en";var a;return null==e||null==e.items?ah:e.items.filter((e=>null!=e)).map((e=>{var a,n,i,s,r,o,l,c,u,d,p;return{description:null!==(a=null!==(n=Object(y.get)(t,e.description))&&void 0!==n?n:Object(y.get)(th,e.description))&&void 0!==a?a:"",expireOn:new Date(null!==(i=e.expire_on)&&void 0!==i?i:""),hash:null!==(s=e.hash)&&void 0!==s?s:Qe.a.v4(),imageUrl:null!==(r=null!==(o=Object(y.get)(t,e.image_url))&&void 0!==o?o:Object(y.get)(th,e.image_url))&&void 0!==r?r:null,linkUrl:null!==(l=null!==(c=Object(y.get)(t,e.link_url))&&void 0!==c?c:Object(y.get)(th,e.link_url))&&void 0!==l?l:"",publishOn:new Date(null!==(u=e.publish_on)&&void 0!==u?u:""),title:null!==(d=null!==(p=Object(y.get)(t,e.title))&&void 0!==p?p:Object(y.get)(th,e.title))&&void 0!==d?d:""}}))})(t))}catch{e||l([])}})(),()=>{e=!0}}),[c,d]),i.a.createElement(i.a.Fragment,null,c?i.a.createElement(ph,{news:o}):null)}));mh.displayName="StatefulNewsFeed";const gh=()=>{const{cases:e}=Object(u.k)().services,t=Object(u.i)();return e.ui.getRecentCases({permissions:t,maxCasesToShow:3,owner:[r.o]})};gh.displayName="RecentCasesComponent";const fh=i.a.memo(gh),bh=i.a.memo((({recentTimelinesFilterBy:e,setRecentTimelinesFilterBy:t})=>{const a=Object(n.useMemo)((()=>i.a.createElement(_b,{filterBy:e,setFilterBy:t})),[e,t]),s=Object(u.i)().read;return i.a.createElement(B.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"l"},s&&i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(fh,null)),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(nh,{title:Cc.h},a),i.a.createElement(Xb,{filterBy:e})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(mh,{enableNewsFeedSetting:r.yb,newsFeedSetting:r.Tb})))}));bh.displayName="Sidebar";const hh=i.a.memo((()=>{const[e,t]=Object(n.useState)("favorites");return i.a.createElement(bh,{recentTimelinesFilterBy:e,setRecentTimelinesFilterBy:t})}));hh.displayName="StatefulSidebar";var yh=a(1005),Eh=a(400);const vh=Object(n.memo)((({onDismiss:e})=>{const{getUrlForApp:t}=Object(u.k)().services.application,a=Object(b.e)({name:"endpointList"}),n=t(r.A,{path:a}),s=Object(Eh.a)(r.A,{path:a});return i.a.createElement(B.EuiCallOut,{"data-test-subj":"endpoint-prompt-banner",iconType:"cheer",title:i.a.createElement(i.a.Fragment,null,i.a.createElement("b",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.introducing",defaultMessage:"Introducing: "})),i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.title",defaultMessage:"Endpoint Security"}))},i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.message",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),i.a.createElement(B.EuiButton,{onClick:s,href:n},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.tryButton",defaultMessage:"Try Endpoint Security"})),i.a.createElement(B.EuiButtonEmpty,{onClick:e},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.dismiss",defaultMessage:"Dismiss message"}))))}));vh.displayName="EndpointNotice";var kh=a(669),Sh=a(10),Th=a(271),xh=a(180),wh=a(111);const Oh=N.i18n.translate("xpack.securitySolution.overview.ctiDashboardDangerPanelTitle",{defaultMessage:"No threat intelligence data"}),jh=N.i18n.translate("xpack.securitySolution.overview.ctiDashboardEnableThreatIntel",{defaultMessage:"You need to enable threat intel sources in order to view data."}),Ih=N.i18n.translate("xpack.securitySolution.overview.ctiDashboardDangerButton",{defaultMessage:"Enable sources"}),Ch=N.i18n.translate("xpack.securitySolution.overview.ctiDashboardTitle",{defaultMessage:"Threat Intelligence"}),Mh=(N.i18n.translate("xpack.securitySolution.overview.ctiViewDasboard",{defaultMessage:"View dashboard"}),N.i18n.translate("xpack.securitySolution.overview.ctiDashboardOtherDatasourceTitle",{defaultMessage:"Others"})),Dh=N.i18n.translate("xpack.securitySolution.overview.ctiLinkSource",{defaultMessage:"Source"});var Ah=a(101);const Fh="ctiEventCountQuery",Rh=Object(Th.d)((e=>(({data:e,defaultIndex:t,timerange:a,signal:n})=>e.search.search({defaultIndex:t,factoryQueryType:wh.a.dataSource,timerange:a},{strategy:"securitySolutionSearchStrategy",abortSignal:n}))(e).pipe(Object(Sh.filter)((e=>Object(xh.isErrorResponse)(e)||Object(xh.isCompleteResponse)(e)))))),Ph=({to:e,from:t,allTiDataSources:a,setQuery:i,deleteQuery:s})=>{const[o,l]=Object(n.useState)([]),[c,d]=Object(n.useState)(!1),{data:p,uiSettings:m}=Object(u.k)().services,g=m.get(r.db),{result:f,start:b,loading:h}=Object(Th.c)(Rh);Object(n.useEffect)((()=>{b({data:p,timerange:e&&t?{to:e,from:t,interval:""}:void 0,defaultIndex:g})}),[e,t,b,p,g]),Object(n.useEffect)((()=>{var e,t;!h&&null!=f&&f.rawResponse&&null!=f&&f.inspect&&i&&i({id:Fh,inspect:{dsl:null!==(e=null==f||null===(t=f.inspect)||void 0===t?void 0:t.dsl)&&void 0!==e?e:[],response:[JSON.stringify(f.rawResponse,null,2)]},loading:h,refetch:()=>{}})}),[i,h,f]),Object(n.useEffect)((()=>()=>{s&&s({id:Fh})}),[s]),Object(n.useEffect)((()=>{f&&!c&&d(!0)}),[c,f]),Object(n.useEffect)((()=>{if(!h&&f){var e,t,n,i;const s=null!==(e=null==f||null===(t=f.rawResponse)||void 0===t||null===(n=t.aggregations)||void 0===n||null===(i=n.dataset)||void 0===i?void 0:i.buckets)&&void 0!==e?e:[],r=e=>{var t,a;return null==e||null===(t=e.buckets)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.key},o=s.reduce(((e,t)=>{const a=r(null==t?void 0:t.name);if(a)return{...e,[t.key]:{dataset:null==t?void 0:t.key,name:a,dashboardId:r(null==t?void 0:t.dashboard),count:null==t?void 0:t.doc_count}};{var n,i,s;const a=Ah.o,r=null!==(n=null===(i=e[a])||void 0===i?void 0:i.count)&&void 0!==n?n:0;return{...e,[a]:{dataset:a,name:Mh,count:r+(null!==(s=null==t?void 0:t.doc_count)&&void 0!==s?s:0)}}}}),{});Array.isArray(a)&&a.forEach((e=>{o[e.dataset]||(o[e.dataset]={...e,count:0})})),l(Object.values(o))}}),[f,h,a]);const y=o.reduce(((e,t)=>e+t.count),0);return{tiDataSources:o,totalCount:y,isInitiallyLoaded:c}},_h={type:"tag",search:"threat intel",searchFields:["name"]},qh=N.i18n.translate("xpack.securitySolution.overview.linkPanelLearnMoreButton",{defaultMessage:"Learn More"}),Nh=H()(B.EuiFlexGroup).withConfig({displayName:"ButtonContainer",componentId:"sc-1se23m-0"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),Lh=H()(B.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1se23m-1"})(["padding:0;margin-top:",";margin-left:12px;transform:scale(",");"],(({theme:e})=>e.eui.euiSizeM),(({color:e})=>"primary"===e?1.4:1)),Bh=H()(B.EuiSplitPanel.Inner).withConfig({displayName:"PanelContainer",componentId:"sc-1se23m-2"})(["margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeM)),zh=H()(B.EuiText).withConfig({displayName:"Title",componentId:"sc-1se23m-3"})(["color:",";margin-bottom:",";"],(({theme:e,textcolor:t})=>"primary"===t?e.eui.euiColorPrimary:e.eui.euiColorWarningText),(({theme:e})=>e.eui.euiSizeM)),Hh=({body:e,button:t,color:a,dataTestSubj:n,learnMoreLink:s,title:r})=>i.a.createElement(Bh,{grow:!1,color:a},i.a.createElement(B.EuiFlexGroup,{direction:"column","data-test-subj":n},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiFlexGroup,{direction:"row"},i.a.createElement(Lh,{type:"primary"===a?"iInCircle":"help",size:"m",color:a}),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(zh,{"data-test-subj":"inner-link-panel-title",textcolor:a},r))),i.a.createElement("p",null,e," ",s&&i.a.createElement(B.EuiLink,{href:s,target:"_blank","data-test-subj":`${n}-learn-more`,external:!0},qh))),t&&i.a.createElement(Nh,null,i.a.createElement(B.EuiFlexItem,{grow:!1},t))));Hh.displayName="InnerLinkPanel";var $h=a(5);const Vh=H()(B.EuiBasicTable).withConfig({displayName:"StyledTable",componentId:"sc-1cmro1k-0"})(["[data-test-subj='panel-link'],[data-test-subj='panel-no-link']{opacity:0;}tr:hover{[data-test-subj='panel-link'],[data-test-subj='panel-no-link']{opacity:1;}}"]),Uh=({button:e,columns:t,dataTestSubj:a,defaultSortField:s,defaultSortOrder:r,infoPanel:o,inspectQueryId:l,listItems:c,panelTitle:u,splitPanel:d,subtitle:p})=>{const[m,g]=Object(n.useState)(0),[f,b]=Object(n.useState)(null!=s?s:"title"),[h,y]=Object(n.useState)(null!=r?r:"asc"),E=Object(n.useMemo)((()=>((e,t,a)=>{const n=[...e].sort(((e,a)=>{const n=e[t],i=a[t];return void 0!==n&&void 0!==i?n===i?e.title>a.title?1:e.title<a.title?-1:0:n>i?1:n<i?-1:0:0}));return"desc"===a&&n.reverse(),Object($h.chunk)(n,5)})(c,f,h)),[c,h,f]),v=Object(n.useMemo)((()=>({showPerPageOptions:!1,pageIndex:m,pageSize:5,totalItemCount:c.length})),[m,c.length]),k=Object(n.useMemo)((()=>({sort:{direction:h,field:f}})),[f,h]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,{"data-test-subj":"spacer",size:"l"}),i.a.createElement(B.EuiFlexGroup,{gutterSize:"l",justifyContent:"spaceBetween","data-test-subj":a},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(De.c,null,i.a.createElement(B.EuiPanel,{hasBorder:!0},i.a.createElement(Tt.a,{id:l,subtitle:p,title:u},i.a.createElement(i.a.Fragment,null,e)),d,o,E.length>0&&i.a.createElement(Vh,{columns:t,itemId:"id",items:E[m]||[],onChange:({page:e,sort:t})=>{const{index:a}=e;if(g(a),t){const{field:e,direction:a}=t;b(e),y(a)}},pagination:v,sorting:k}))))))},Qh=i.a.memo(Uh);Qh.displayName="LinkPanel";const Wh=({path:e,copy:t})=>e?i.a.createElement(B.EuiLink,{href:e,target:"_blank","data-test-subj":"panel-link"},t):i.a.createElement(B.EuiText,{color:"subdued",size:"s","data-test-subj":"panel-no-link"},t);Wh.displayName="Link";const Gh=[{name:"Name",field:"title",sortable:!0,truncateText:!0,width:"100%"},{name:"Indicator",field:"count",render:e=>{var t;if(e<1e4)return e.toString();const{magnitude:a,unit:n}=null!==(t=[{magnitude:1e18,unit:"E"},{magnitude:1e15,unit:"P"},{magnitude:1e12,unit:"T"},{magnitude:1e9,unit:"B"},{magnitude:1e6,unit:"M"},{magnitude:1e3,unit:"K"}].find((t=>e>=t.magnitude)))&&void 0!==t?t:{magnitude:1,unit:""};return((e,t)=>{const a=e.toFixed(t);return+a<=e?a:(+a-Math.pow(.1,t)).toFixed(t)})(e/a,1).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+n},sortable:!0,truncateText:!0,width:"70px",align:"right"},{name:"",field:"path",truncateText:!0,width:"80px",render:e=>i.a.createElement(Wh,{path:e,copy:Dh})}],Kh=({isInspectEnabled:e=!0,listItems:t,splitPanel:a,totalCount:s=0})=>i.a.createElement(Qh,{columns:Gh,dataTestSubj:"cti-dashboard-links",inspectQueryId:e?Fh:void 0,listItems:t,panelTitle:Ch,splitPanel:a,subtitle:Object(n.useMemo)((()=>i.a.createElement(Hs.FormattedMessage,{"data-test-subj":"cti-total-event-count",defaultMessage:"Showing: {totalCount} {totalCount, plural, one {indicator} other {indicators}}",id:"xpack.securitySolution.overview.ctiDashboardSubtitle",values:{totalCount:s}})),[s])}),Jh=e=>{const{to:t,from:a,allTiDataSources:s,setQuery:r,deleteQuery:o}=e,{tiDataSources:l,totalCount:c}=Ph({to:t,from:a,allTiDataSources:s,setQuery:r,deleteQuery:o}),{listItems:d}=(({to:e,from:t,tiDataSources:a=[]})=>{var i;const[s,r]=Object(n.useState)([]),o=null===(i=Object(u.k)().services.dashboard)||void 0===i?void 0:i.locator,l=Object(u.k)().services.savedObjects.client,c=Object(n.useCallback)((e=>{var t;if(null!=e&&null!==(t=e.savedObjects)&&void 0!==t&&t.length)return l.find({type:"dashboard",hasReference:{id:e.savedObjects[0].id,type:"tag"}})}),[l]);return Object(n.useEffect)((()=>{l&&l.find(_h).then(c).then((async e=>{var t;null!=e&&null!==(t=e.savedObjects)&&void 0!==t&&t.length&&r(e.savedObjects.map((e=>{var t;return null!==(t=e.id)&&void 0!==t?t:""})).filter(Boolean))}))}),[c,l]),{listItems:a.map((a=>{const n={title:a.name,count:a.count,path:""};return a.dashboardId&&s.includes(a.dashboardId)&&o&&(n.path=o.getRedirectUrl({dashboardId:a.dashboardId,timeRange:{to:e,from:t}})),n}))}})({to:t,from:a,tiDataSources:l});return i.a.createElement(Kh,{listItems:d,totalCount:c})},Yh=i.a.memo(Jh);Yh.displayName="CtiEnabledModule";const Xh=({bodyCopy:e,buttonCopy:t,dataTestSubjPrefix:a,docLink:n,learnMoreUrl:s,LinkPanelViewComponent:r,listItems:o,moreButtons:l,titleCopy:c})=>i.a.createElement(r,{listItems:o,splitPanel:i.a.createElement(Hh,{body:e,button:i.a.createElement(B.EuiFlexGroup,null,t&&n&&i.a.createElement(B.EuiFlexItem,null,i.a.createElement(ue.g,{color:"warning",href:n,target:"_blank","data-test-subj":`${a}-enable-module-button`},t)),l&&l),color:"warning",dataTestSubj:`${a}-inner-panel-danger`,learnMoreLink:s,title:c})}),Zh=Object(n.memo)(Xh);Zh.displayName="DisabledLinkPanel";const ey=()=>{const e=`${Object(u.e)()}/app/integrations/browse/threat_intel`;return i.a.createElement(Zh,{bodyCopy:jh,buttonCopy:Ih,dataTestSubjPrefix:"cti",docLink:e,listItems:[],titleCopy:Oh,LinkPanelViewComponent:Kh})},ty=i.a.memo(ey);ty.displayName="CtiDisabledModule";const ay=e=>{const{allTiDataSources:t}=e;return t.length>0?i.a.createElement("div",{"data-test-subj":"cti-enabled-module"},i.a.createElement(Yh,yn()({},e,{allTiDataSources:t}))):i.a.createElement("div",{"data-test-subj":"cti-disabled-module"},i.a.createElement(ty,null))},ny=i.a.memo(ay);ny.displayName="ThreatIntelDashboardLinksComponent";var iy=a(235);const sy=()=>{const e=Object(n.useMemo)((()=>fn.f.globalFiltersQuerySelector()),[]),t=Object(n.useMemo)((()=>fn.f.globalQuerySelector()),[]),a=Object(E.a)(t),s=Object(E.a)(e),{from:o,deleteQuery:l,setQuery:c,to:u}=Object(U.a)(),{indicesExist:d,indexPattern:m,selectedPatterns:g}=Object(p.d)(),b=Object(n.useMemo)((()=>[r.Ab]),[]),[,{indexExists:y}]=Object(Hf.b)(b,!0),{addMessage:k,hasMessage:S}=Object(kh.a)(),T=Object(n.useMemo)((()=>S("management","dismissEndpointNotice")),[S]),[x,w]=Object(n.useState)(T),O=Object(n.useCallback)((()=>{w(!0),k("management","dismissEndpointNotice")}),[k]),{endpointPrivileges:{canAccessFleet:j}}=Object(iy.a)(),{hasIndexRead:I,hasKibanaREAD:C}=Object(na.a)(),{tiDataSources:M,isInitiallyLoaded:D}=(()=>{const{to:e,from:t}=Object(n.useMemo)((()=>({to:(new Date).toISOString(),from:new Date(0).toISOString()})),[]),{tiDataSources:a,isInitiallyLoaded:i}=Ph({to:e,from:t});return{tiDataSources:a,isInitiallyLoaded:i}})();return i.a.createElement(i.a.Fragment,null,d?i.a.createElement(i.a.Fragment,null,i.a.createElement(Q.a,null,i.a.createElement(G.a,{id:V.a.global,indexPattern:m})),i.a.createElement(f.a,null,!x&&!y&&j&&i.a.createElement(i.a.Fragment,null,i.a.createElement(vh,{onDismiss:O}),i.a.createElement(B.EuiSpacer,{size:"l"})),i.a.createElement(B.EuiFlexGroup,null,i.a.createElement(B.EuiShowFor,{sizes:["xl"]},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(hh,null))),i.a.createElement(B.EuiFlexItem,{grow:3},i.a.createElement(B.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"none"},I&&C&&i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(yh.a,{filters:s,query:a}),i.a.createElement(B.EuiSpacer,{size:"l"})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement($f.a,{deleteQuery:l,filters:s,from:o,indexPattern:m,indexNames:g,query:a,queryType:"overview",setQuery:c,to:u})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(Tb,{filters:s,from:o,indexNames:g,indexPattern:m,query:a,setQuery:c,to:u})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiFlexGroup,{direction:"row"},i.a.createElement(B.EuiFlexItem,{grow:1},D&&i.a.createElement(ny,{allTiDataSources:M,deleteQuery:l,from:o,setQuery:c,to:u}))))))))):i.a.createElement(Xt.a,null),i.a.createElement(h.a,{pageName:v.a.overview}))},ry=i.a.memo(sy);var oy=a(238);const ly=N.i18n.translate("xpack.securitySolution.socTrends.properties.lockDatePickerTooltip",{defaultMessage:"Disable syncing of date/time range between the currently viewed page and SOC Trends"}),cy=N.i18n.translate("xpack.securitySolution.socTrends.properties.unlockDatePickerTooltip",{defaultMessage:"Enable syncing of date/time range between the currently viewed page and SOC Trends"}),uy=N.i18n.translate("xpack.securitySolution.socTrends.properties.lockDatePickerDescription",{defaultMessage:"Lock global date picker to SOC Trends date picker"}),dy=N.i18n.translate("xpack.securitySolution.socTrends.properties.unlockDatePickerDescription",{defaultMessage:"Unlock global date picker from SOC Trends date picker"}),py=()=>{const e=Object(o.useDispatch)(),t=Object(n.useMemo)((()=>K.d.globalSelector()),[]),a=Object(E.b)((e=>t(e).linkTo.includes(V.a.socTrends))),s=Object(n.useCallback)((()=>e(K.b.toggleSocTrendsLinkTo())),[e]);return i.a.createElement(B.EuiToolTip,{"data-test-subj":"socTrends-date-picker-lock-tooltip",position:"top",content:a?ly:cy},i.a.createElement(B.EuiButtonIcon,{"data-test-subj":`socTrends-date-picker-${a?"lock":"unlock"}-button`,color:"primary",onClick:s,iconType:a?"lock":"lockOpen","aria-label":a?dy:uy}))};py.displayName="SocTrendsDatePickerLockComponent";const my=i.a.memo(py);var gy=a(433),fy=a(313);const by=N.i18n.translate("xpack.securitySolution.detectionResponse.socTrends",{defaultMessage:"SOC Trends"}),hy=N.i18n.translate("xpack.securitySolution.detectionResponse.mttr",{defaultMessage:"Average case response time"}),yy=N.i18n.translate("xpack.securitySolution.detectionResponse.mttrDescription",{defaultMessage:"The average duration (from creation to closure) for your current cases"}),Ey=N.i18n.translate("xpack.securitySolution.detectionResponse.criticalAlerts",{defaultMessage:"Open critical alerts"}),vy=N.i18n.translate("xpack.securitySolution.detectionResponse.criticalAlertsDescription",{defaultMessage:"The count of open critical alerts for the current time range"}),ky=e=>N.i18n.translate("xpack.securitySolution.detectionResponse.noChange",{defaultMessage:"Your {dataType} is unchanged",values:{dataType:e}}),Sy=e=>N.i18n.translate("xpack.securitySolution.detectionResponse.noData",{defaultMessage:"There is no {dataType} data to compare",values:{dataType:e}}),Ty=e=>N.i18n.translate("xpack.securitySolution.detectionResponse.noDataCompare",{defaultMessage:"There is no {dataType} data to compare from the compare time range",values:{dataType:e}}),xy=e=>N.i18n.translate("xpack.securitySolution.detectionResponse.noDataCurrent",{defaultMessage:"There is no {dataType} data to compare from the current time range",values:{dataType:e}}),wy=({upOrDown:e,percentageChange:t,stat:a,statType:n})=>N.i18n.translate("xpack.securitySolution.detectionResponse.timeDifference",{defaultMessage:"Your {statType} is {upOrDown} by {percentageChange} from {stat}",values:{upOrDown:e,percentageChange:t,stat:a,statType:n}}),Oy=(e,t)=>{switch(t.type){case"setIsLoading":return{...e,isLoading:t.isLoading};case"setUpdatedAt":return{...e,updatedAt:t.updatedAt};case"setStat":return{...e,stat:t.stat};case"setPercentage":return{...e,percentage:t.percentage};default:throw new Error}};var jy=a(1193),Iy=a.n(jy);const Cy=(e,t)=>null!=e&&0!==e&&null!=t&&0!==t?`${((e-t)/t*100).toFixed(1)}%`:null,My=e=>Iy()(1e3*e,{compact:!0,verbose:!1}),Dy=({from:e,to:t})=>({size:0,query:{bool:{filter:[{range:{"@timestamp":{gte:e,lte:t}}}]}},aggs:{open:{filter:{term:{"kibana.alert.workflow_status":"open"}},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}}}}}}),Ay="socTrends",Fy=H()(B.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-16ex3ir-0"})(["min-width:300px;"]),Ry=H()(B.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-16ex3ir-1"})(["max-width:300px;"]),Py=({signalIndexName:e})=>{const{toggleStatus:t,setToggleStatus:a}=Object(zt.a)(Ay),{stats:s,latestUpdate:o,isUpdating:l}=(({skip:e=!1,signalIndexName:t})=>{const{to:a,from:i,setQuery:s,deleteQuery:o}=Object(U.a)(),{from:l="",to:c=""}=Object(E.a)((e=>Object(y.pick)(["from","to"],fn.f.socTrendsTimeRangeSelector(e)))),d=(({deleteQuery:e,from:t,fromCompare:a,setQuery:i,skip:s=!1,to:o,toCompare:l})=>{const{services:{cases:c}}=Object(u.k)(),d=Object(n.useMemo)((()=>`useCasesMttr-${Qe.a.v4()}`),[]),[p,m]=Object(n.useReducer)(Oy,{description:yy,isLoading:!0,percentage:{percent:null,color:"hollow",note:Sy("case")},stat:"-",testRef:"casesMttr",title:hy,updatedAt:Date.now()});return Object(n.useEffect)((()=>{let n=!0;const u=new AbortController,p=async()=>{try{const[e,i]=await Promise.all([c.api.cases.getCasesMetrics({from:t,to:o,owner:r.o,features:["mttr"]},u.signal),c.api.cases.getCasesMetrics({from:a,to:l,owner:r.o,features:["mttr"]},u.signal)]),s=Cy(e.mttr,i.mttr);if(n&&null!=e.mttr?m({type:"setStat",stat:My(e.mttr)}):n&&m({type:"setStat",stat:"-"}),null!=e.mttr&&null!=i.mttr&&null!=s){const e="-"===s.charAt(0),t="0.0%"===s;m({type:"setPercentage",percentage:{percent:e||t?s:`+${s}`,color:t?"hollow":e?"success":"danger",note:t?ky("case resolution time"):wy({upOrDown:e?"down":"up",percentageChange:e?s.substring(1):s,stat:My(i.mttr),statType:"case resolution time"})}})}else{const t=null==e.mttr,a=null==i.mttr,n=t&&a?Sy("case"):t?xy("case"):Ty("case");m({type:"setPercentage",percentage:{percent:null,color:"hollow",note:n}})}}catch(e){n&&m({type:"setStat",stat:"-"})}n&&(m({type:"setIsLoading",isLoading:!1}),m({type:"setUpdatedAt",updatedAt:Date.now()}))};return s||(p(),i({id:d,inspect:null,loading:!1,refetch:p})),s&&(m({type:"setIsLoading",isLoading:!1}),n=!1,u.abort()),()=>{n=!1,u.abort(),e&&e({id:d})}}),[c.api.cases,t,s,o,i,e,d,a,l]),p})({deleteQuery:o,from:i,fromCompare:l,setQuery:s,skip:e,to:a,toCompare:c}),p=(({from:e,fromCompare:t,skip:a=!1,signalIndexName:i,to:s,toCompare:r})=>{var o,l;const[c,u]=Object(n.useReducer)(Oy,{description:vy,isLoading:!0,percentage:{percent:null,color:"hollow",note:Sy("alerts")},stat:"-",testRef:"criticalAlerts",title:Ey,updatedAt:Date.now()}),d=Object(n.useMemo)((()=>Dy({from:e,to:s})),[e,s]),p=Object(n.useMemo)((()=>Dy({from:t,to:r})),[t,r]),{data:m,loading:g,setQuery:f}=Object(w.a)({query:d,indexName:i,skip:a,queryName:O.a.SOC_TRENDS}),{data:b,loading:h,setQuery:y}=Object(w.a)({query:p,indexName:i,skip:a,queryName:O.a.SOC_TRENDS});Object(n.useEffect)((()=>{f(d)}),[d,f]),Object(n.useEffect)((()=>{y(p)}),[p,y]),Object(n.useEffect)((()=>{u({type:"setIsLoading",isLoading:g||h})}),[g,h]);const E=Object(n.useMemo)((()=>{var e,t;return null!==(e=null==m||null===(t=m.aggregations)||void 0===t?void 0:t.open.critical.doc_count)&&void 0!==e?e:null}),[null==m||null===(o=m.aggregations)||void 0===o?void 0:o.open.critical.doc_count]),v=Object(n.useMemo)((()=>{var e,t;return null!==(e=null==b||null===(t=b.aggregations)||void 0===t?void 0:t.open.critical.doc_count)&&void 0!==e?e:null}),[null==b||null===(l=b.aggregations)||void 0===l?void 0:l.open.critical.doc_count]);return Object(n.useEffect)((()=>{const e=Cy(E,v);if(u(null!=E?{type:"setStat",stat:`${E}`}:{type:"setStat",stat:"-"}),null!=E&&null!=v&&0!==E&&0!==v&&null!=e){const t="-"===e.charAt(0),a="0.0%"===e;u({type:"setPercentage",percentage:{percent:t||a?e:`+${e}`,color:a?"hollow":t?"success":"danger",note:a?ky("open critical alert count"):wy({upOrDown:t?"down":"up",percentageChange:t?e.substring(1):e,stat:`${v}`,statType:"open critical alert count"})}})}else{const e=null==E||0===E,t=null==v||0===v,a=e&&t?Sy("alerts"):e?xy("alerts"):Ty("alerts");u({type:"setPercentage",percentage:{percent:null,color:"hollow",note:a}})}u({type:"setUpdatedAt",updatedAt:Date.now()})}),[E,v]),c})({from:i,fromCompare:l,skip:e,signalIndexName:t,to:a,toCompare:c}),m=Object(n.useMemo)((()=>Math.max(d.updatedAt,p.updatedAt)),[d.updatedAt,p.updatedAt]),g=Object(n.useMemo)((()=>d.isLoading||p.isLoading),[d.isLoading,p.isLoading]);return{stats:[d,p],isUpdating:g,latestUpdate:m}})({skip:!t,signalIndexName:e}),c=Object(n.useMemo)((()=>s.map((e=>(e=>({title:i.a.createElement(B.EuiToolTip,{content:e.description},i.a.createElement(B.EuiText,null,i.a.createElement("h6",null,e.title," ",i.a.createElement(B.EuiIcon,{type:"questionInCircle"})))),description:e.isLoading?i.a.createElement(B.EuiLoadingSpinner,{"data-test-subj":`${e.testRef}-stat-loading-spinner`}):i.a.createElement(i.a.Fragment,null,e.stat," ",i.a.createElement(B.EuiToolTip,{content:e.percentage.note},i.a.createElement(B.EuiBadge,{color:e.percentage.color},null!=e.percentage.percent?e.percentage.percent:"-")))}))(e)))),[s]);return i.a.createElement(Fy,{hasBorder:!0},i.a.createElement(Tt.a,{id:Ay,showInspectButton:!1,stackHeader:!0,subtitle:i.a.createElement(fy.a,{updatedAt:o,isUpdating:l}),title:by,titleSize:"s",toggleQuery:a,toggleStatus:t},i.a.createElement(Ry,{gutterSize:"s"},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(gy.a,{id:V.a.socTrends,showUpdateButton:"iconOnly",width:"auto",compressed:!0})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(my,null)))),t&&i.a.createElement(B.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(B.EuiFlexItem,{grow:!0},i.a.createElement(B.EuiDescriptionList,{"data-test-subj":"statsList",textStyle:"reverse",listItems:c}))))},_y=i.a.memo(Py);var qy=a(297),Ny=a(438),Ly=a(336),By=a(437);const zy={pageCount:0,currentPage:0},Hy=({from:e,to:t,currentPage:a})=>({query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}}]}},size:0,aggs:{host_count:{cardinality:{field:"host.name"}},hostsBySeverity:{terms:{size:100,field:"host.name",order:[{"critical.doc_count":"desc"},{"high.doc_count":"desc"},{"medium.doc_count":"desc"},{"low.doc_count":"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},bucketOfPagination:{bucket_sort:{from:By.a*a,size:4}}}}}}),$y="vulnerableHostsBySeverityQuery",Vy=i.a.memo((({signalIndexName:e})=>{const{openTimelineWithFilters:t}=Object(Ny.a)(),a=Object(n.useCallback)((({hostName:e,severity:a})=>{const n={field:"host.name",value:e},i=a?{field:"kibana.alert.severity",value:a}:void 0;t(i?[[n,By.d,i]]:[[n,By.d]])}),[t]),{toggleStatus:s,setToggleStatus:r}=Object(zt.a)($y),{items:o,isLoading:l,updatedAt:c,pagination:u}=(({skip:e,queryId:t,signalIndexName:a})=>{const[i,s]=Object(n.useState)(Date.now()),[r,o]=Object(n.useState)([]),[l,c]=Object(n.useState)(zy),{to:u,from:d,setQuery:p,deleteQuery:m}=Object(U.a)(),{data:g,request:f,response:b,setQuery:h,loading:y,refetch:E}=Object(w.a)({query:Hy({from:d,to:u,currentPage:l.currentPage}),indexName:a,skip:e,queryName:O.a.VULNERABLE_HOSTS});Object(n.useEffect)((()=>{h(Hy({from:d,to:u,currentPage:l.currentPage}))}),[h,d,u,l.currentPage]),Object(n.useEffect)((()=>{var e,t;null!=g&&g.aggregations?(o((null!==(t=null==(e=g.aggregations)?void 0:e.hostsBySeverity.buckets)&&void 0!==t?t:[]).reduce(((e,t)=>(e.push({hostName:t.key||"—",totalAlerts:t.doc_count,low:t.low.doc_count,medium:t.medium.doc_count,high:t.high.doc_count,critical:t.critical.doc_count}),e)),[])),c((e=>{var t;return{...e,pageCount:Object(By.c)(null===(t=g.aggregations)||void 0===t?void 0:t.host_count.value)}}))):o([]),s(Date.now())}),[g]);const v=Object(n.useCallback)((()=>{!e&&E&&E()}),[e,E]);return Object(Pi.b)({deleteQuery:m,inspect:{dsl:[f],response:[b]},refetch:v,setQuery:p,queryId:t,loading:y}),{items:r,isLoading:y,updatedAt:i,pagination:{...l,setPage:e=>{c((t=>({...t,currentPage:e})))}}}})({skip:!s,queryId:$y,signalIndexName:e}),d=Object(n.useMemo)((()=>Uy(a)),[a]);return i.a.createElement(du.a,{show:!0,targetClassNames:[De.a]},i.a.createElement(B.EuiPanel,{hasBorder:!0,"data-test-subj":"severityHostAlertsPanel"},i.a.createElement(Tt.a,{id:$y,title:Ly.m,subtitle:i.a.createElement(fy.a,{updatedAt:c,isUpdating:l}),titleSize:"s",toggleQuery:r,toggleStatus:s,tooltip:Ly.n}),s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiBasicTable,{items:o,columns:d,loading:l,"data-test-subj":"severityHostAlertsTable",noItemsMessage:i.a.createElement(B.EuiEmptyPrompt,{title:i.a.createElement("h3",null,Ly.p),titleSize:"xs"})}),i.a.createElement(B.EuiSpacer,{size:"m"}),u.pageCount>1&&i.a.createElement(B.EuiTablePagination,{"data-test-subj":"hostTablePaginator",activePage:u.currentPage,itemsPerPage:By.a,pageCount:u.pageCount,onChangePage:u.setPage,showPerPageOptions:!1}))))}));Vy.displayName="HostAlertsTable";const Uy=e=>[{field:"hostName",name:Ly.l,"data-test-subj":"hostSeverityAlertsTable-hostName",render:e=>i.a.createElement(B.EuiToolTip,{title:Ly.t,content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(ue.d,{hostName:e}))},{field:"totalAlerts",name:Ly.c,"data-test-subj":"hostSeverityAlertsTable-totalAlerts",render:(t,{hostName:a})=>i.a.createElement(B.EuiLink,{"data-test-subj":"hostSeverityAlertsTable-totalAlertsLink",disabled:0===t,onClick:()=>e({hostName:a})},i.a.createElement(qy.a,{count:t}))},{field:"critical",name:Ly.D,render:(t,{hostName:a})=>i.a.createElement(B.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-critical",color:By.b.critical},i.a.createElement(B.EuiLink,{"data-test-subj":"hostSeverityAlertsTable-criticalLink",disabled:0===t,onClick:()=>e({hostName:a,severity:"critical"})},i.a.createElement(qy.a,{count:t})))},{field:"high",name:Ly.E,render:(t,{hostName:a})=>i.a.createElement(B.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-high",color:By.b.high},i.a.createElement(B.EuiLink,{disabled:0===t,onClick:()=>e({hostName:a,severity:"high"})},i.a.createElement(qy.a,{count:t})))},{field:"medium",name:Ly.H,render:(t,{hostName:a})=>i.a.createElement(B.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-medium",color:By.b.medium},i.a.createElement(B.EuiLink,{disabled:0===t,onClick:()=>e({hostName:a,severity:"medium"})},i.a.createElement(qy.a,{count:t})))},{field:"low",name:Ly.G,render:(t,{hostName:a})=>i.a.createElement(B.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-low",color:By.b.low},i.a.createElement(B.EuiLink,{disabled:0===t,onClick:()=>e({hostName:a,severity:"low"})},i.a.createElement(qy.a,{count:t})))}],Qy=({from:e,to:t})=>({size:0,query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}}]}},aggs:{alertsByRule:{terms:{field:"kibana.alert.rule.name",size:4,order:[{critical:"desc"},{high:"desc"},{medium:"desc"},{low:"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},lastRuleAlert:{top_hits:{size:1,sort:{"@timestamp":"desc"}}}}}}}),Wy="detection-response-rule-alerts-severity-table",Gy=i.a.memo((({signalIndexName:e})=>{const{getAppUrl:t,navigateTo:a}=Object(u.m)(),{toggleStatus:s,setToggleStatus:o}=Object(zt.a)(Wy),{items:l,isLoading:c,updatedAt:d}=(({queryId:e,signalIndexName:t,skip:a=!1})=>{const[i,s]=Object(n.useState)([]),[r,o]=Object(n.useState)(Date.now()),{to:l,from:c,deleteQuery:u,setQuery:d}=Object(U.a)(),{loading:p,data:m,setQuery:g,response:f,request:b,refetch:h}=Object(w.a)({query:Qy({from:c,to:l}),indexName:t,skip:a,queryName:O.a.BY_SEVERITY});Object(n.useEffect)((()=>{g(Qy({from:c,to:l}))}),[g,c,l]),Object(n.useEffect)((()=>{var e,t;s(null==m?[]:(null!==(t=null==(e=m.aggregations)?void 0:e.alertsByRule.buckets)&&void 0!==t?t:[]).map((e=>{const t=e.lastRuleAlert.hits.hits[0]._source;return{id:t["kibana.alert.rule.uuid"],alert_count:e.lastRuleAlert.hits.total.value,name:t["kibana.alert.rule.name"],last_alert_at:t["@timestamp"],severity:t["kibana.alert.severity"]}}))),o(Date.now())}),[m]);const y=Object(n.useCallback)((()=>{!a&&h&&h()}),[a,h]);return Object(Pi.b)({deleteQuery:u,inspect:{dsl:[b],response:[f]},refetch:y,setQuery:d,queryId:e,loading:p}),{items:i,isLoading:p,updatedAt:r}})({signalIndexName:e,queryId:Wy,skip:!s}),{openTimelineWithFilters:p}=Object(Ny.a)(),m=Object(n.useCallback)((e=>{p([[{field:"kibana.alert.rule.name",value:e},By.d]])}),[p]),g=Object(n.useCallback)((()=>{a({deepLinkId:r.uc.alerts})}),[a]),f=Object(n.useMemo)((()=>(({getAppUrl:e,navigateTo:t,openRuleInTimeline:a})=>[{field:"name",name:Ly.y,render:(a,{id:n})=>{const s=e({deepLinkId:r.uc.rules,path:`id/${n}`});return i.a.createElement(B.EuiToolTip,{"data-test-subj":`${n}-tooltip`,title:Ly.u,content:a,anchorClassName:"eui-textTruncate"},i.a.createElement(B.EuiLink,{"data-test-subj":"severityRuleAlertsTable-name",href:s,onClick:e=>{e&&e.preventDefault(),t({url:s})}},a))}},{field:"last_alert_at",name:Ly.x,"data-test-subj":"severityRuleAlertsTable-lastAlertAt",render:e=>i.a.createElement(Hs.FormattedRelative,{value:new Date(e)})},{field:"alert_count",name:Ly.w,"data-test-subj":"severityRuleAlertsTable-alertCount",render:(e,{name:t})=>i.a.createElement(B.EuiLink,{"data-test-subj":"severityRuleAlertsTable-alertCountLink",disabled:0===e,onClick:()=>a(t)},i.a.createElement(qy.a,{count:e}))},{field:"severity",name:Ly.z,"data-test-subj":"severityRuleAlertsTable-severity",render:e=>i.a.createElement(B.EuiHealth,{color:By.b[e]},Object($h.capitalize)(e))}])({getAppUrl:t,navigateTo:a,openRuleInTimeline:m})),[t,a,m]);return i.a.createElement(du.a,{show:!0,targetClassNames:[De.a]},i.a.createElement(B.EuiPanel,{hasBorder:!0,"data-test-subj":"severityRuleAlertsPanel"},i.a.createElement(Tt.a,{id:Wy,title:Ly.A,titleSize:"s",toggleStatus:s,toggleQuery:o,subtitle:i.a.createElement(fy.a,{updatedAt:d,isUpdating:c})}),s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiBasicTable,{"data-test-subj":"severityRuleAlertsTable",columns:f,items:l,loading:c,noItemsMessage:i.a.createElement(B.EuiEmptyPrompt,{title:i.a.createElement("h3",null,Ly.p),titleSize:"xs"})}),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiButton,{"data-test-subj":"severityRuleAlertsButton",onClick:g},Ly.r))))}));Gy.displayName="RuleAlertsTable";const Ky={pageCount:0,currentPage:0},Jy=({from:e,to:t,currentPage:a})=>({query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}}]}},size:0,aggs:{user_count:{cardinality:{field:"user.name"}},usersBySeverity:{terms:{size:100,field:"user.name",order:[{"critical.doc_count":"desc"},{"high.doc_count":"desc"},{"medium.doc_count":"desc"},{"low.doc_count":"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},bucketOfPagination:{bucket_sort:{from:By.a*a,size:4}}}}}}),Yy="vulnerableUsersBySeverityQuery",Xy=i.a.memo((({signalIndexName:e})=>{const{openTimelineWithFilters:t}=Object(Ny.a)(),a=Object(n.useCallback)((({userName:e,severity:a})=>{const n={field:"user.name",value:e},i=a?{field:"kibana.alert.severity",value:a}:void 0;t(i?[[n,By.d,i]]:[[n,By.d]])}),[t]),{toggleStatus:s,setToggleStatus:r}=Object(zt.a)(Yy),{items:o,isLoading:l,updatedAt:c,pagination:u}=(({skip:e,queryId:t,signalIndexName:a})=>{const[i,s]=Object(n.useState)(Date.now()),[r,o]=Object(n.useState)([]),[l,c]=Object(n.useState)(Ky),{to:u,from:d,setQuery:p,deleteQuery:m}=Object(U.a)(),{setQuery:g,data:f,loading:b,request:h,response:y,refetch:E}=Object(w.a)({query:Jy({from:d,to:u,currentPage:l.currentPage}),indexName:a,skip:e,queryName:O.a.VULNERABLE_USERS});Object(n.useEffect)((()=>{g(Jy({from:d,to:u,currentPage:l.currentPage}))}),[g,d,u,l.currentPage]),Object(n.useEffect)((()=>{var e,t;null!=f&&f.aggregations?(o((null!==(t=null==(e=f.aggregations)?void 0:e.usersBySeverity.buckets)&&void 0!==t?t:[]).reduce(((e,t)=>(e.push({userName:t.key||"—",totalAlerts:t.doc_count,low:t.low.doc_count,medium:t.medium.doc_count,high:t.high.doc_count,critical:t.critical.doc_count}),e)),[])),c((e=>{var t;return{...e,pageCount:Object(By.c)(null===(t=f.aggregations)||void 0===t?void 0:t.user_count.value)}}))):o([]),s(Date.now())}),[f]);const v=Object(n.useCallback)((()=>{!e&&E&&E()}),[e,E]);return Object(Pi.b)({deleteQuery:m,inspect:{dsl:[h],response:[y]},refetch:v,setQuery:p,queryId:t,loading:b}),{items:r,isLoading:b,updatedAt:i,pagination:{...l,setPage:e=>{c((t=>({...t,currentPage:e})))}}}})({skip:!s,queryId:Yy,signalIndexName:e}),d=Object(n.useMemo)((()=>Zy(a)),[a]);return i.a.createElement(du.a,{show:!0,targetClassNames:[De.a]},i.a.createElement(B.EuiPanel,{hasBorder:!0,"data-test-subj":"severityUserAlertsPanel"},i.a.createElement(Tt.a,{id:Yy,title:Ly.J,titleSize:"s",toggleStatus:s,toggleQuery:r,subtitle:i.a.createElement(fy.a,{updatedAt:c,isUpdating:l}),tooltip:Ly.L}),s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiBasicTable,{"data-test-subj":"severityUserAlertsTable",columns:d,items:o,loading:l,noItemsMessage:i.a.createElement(B.EuiEmptyPrompt,{title:i.a.createElement("h3",null,Ly.p),titleSize:"xs"})}),i.a.createElement(B.EuiSpacer,{size:"m"}),u.pageCount>1&&i.a.createElement(B.EuiTablePagination,{"data-test-subj":"userTablePaginator",activePage:u.currentPage,itemsPerPage:By.a,pageCount:u.pageCount,onChangePage:u.setPage,showPerPageOptions:!1}))))}));Xy.displayName="UserAlertsTable";const Zy=e=>[{field:"userName",name:Ly.K,"data-test-subj":"userSeverityAlertsTable-userName",render:e=>i.a.createElement(B.EuiToolTip,{title:Ly.v,content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(ue.m,{userName:e}))},{field:"totalAlerts",name:Ly.c,"data-test-subj":"userSeverityAlertsTable-totalAlerts",render:(t,{userName:a})=>i.a.createElement(B.EuiLink,{"data-test-subj":"userSeverityAlertsTable-totalAlertsLink",disabled:0===t,onClick:()=>e({userName:a})},i.a.createElement(qy.a,{count:t}))},{field:"critical",name:Ly.D,render:(t,{userName:a})=>i.a.createElement(B.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-critical",color:By.b.critical},i.a.createElement(B.EuiLink,{"data-test-subj":"userSeverityAlertsTable-criticalLink",disabled:0===t,onClick:()=>e({userName:a,severity:"critical"})},i.a.createElement(qy.a,{count:t})))},{field:"high",name:Ly.E,render:(t,{userName:a})=>i.a.createElement(B.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-high",color:By.b.high},i.a.createElement(B.EuiLink,{disabled:0===t,onClick:()=>e({userName:a,severity:"high"})},i.a.createElement(qy.a,{count:t})))},{field:"medium",name:Ly.H,render:(t,{userName:a})=>i.a.createElement(B.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-medium",color:By.b.medium},i.a.createElement(B.EuiLink,{disabled:0===t,onClick:()=>e({userName:a,severity:"medium"})},i.a.createElement(qy.a,{count:t})))},{field:"low",name:Ly.G,render:(t,{userName:a})=>i.a.createElement(B.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-low",color:By.b.low},i.a.createElement(B.EuiLink,{disabled:0===t,onClick:()=>e({userName:a,severity:"low"})},i.a.createElement(qy.a,{count:t})))}];var eE=a(31);const tE={[eE.CaseStatuses.open]:{color:"primary",label:Ly.I},[eE.CaseStatuses["in-progress"]]:{color:"warning",label:Ly.F},[eE.CaseStatuses.closed]:{color:"default",label:Ly.C}},aE=({status:e})=>i.a.createElement(B.EuiBadge,{color:tE[e].color,"data-test-subj":"case-status-badge"},tE[e].label);aE.displayName="StatusBadge";var nE=a(28);const iE="recentlyCreatedCasesQuery",sE=i.a.memo((()=>{const{getAppUrl:e,navigateTo:t}=Object(u.m)(),{toggleStatus:a,setToggleStatus:s}=Object(zt.a)(iE),{items:o,isLoading:l,updatedAt:c}=(({skip:e})=>{const{services:{cases:t}}=Object(u.k)(),{to:a,from:i,setQuery:s,deleteQuery:o}=Object(U.a)(),[l,c]=Object(n.useState)(!0),[d,p]=Object(n.useState)(Date.now()),[m,g]=Object(n.useState)([]),f=Object(n.useMemo)((()=>`useCaseItems-${Qe.a.v4()}`),[]);return Object(n.useEffect)((()=>{let n=!0;const l=new AbortController,u=async()=>{try{const e=await t.api.cases.find({from:i,to:a,owner:r.o,sortField:"create_at",sortOrder:"desc",page:1,perPage:4});n&&(g(function(e){return(e.cases||[]).reduce(((e,t)=>(e.push({id:t.id,name:t.title,totalAlerts:t.totalAlerts,createdAt:t.createdAt,createdBy:t.createdBy.username||"—",status:t.status}),e)),[])}(e)),p(Date.now()))}catch(e){n&&Object(nE.addError)(e,{title:Ly.k})}c(!1)};return e||(u(),s({id:f,inspect:null,loading:!1,refetch:u})),e&&(c(!1),n=!1,l.abort()),()=>{n=!1,l.abort(),o({id:f})}}),[t.api.cases,i,e,a,s,o,f]),{items:m,isLoading:l,updatedAt:d}})({skip:!a}),d=Object(n.useCallback)((()=>{t({deepLinkId:v.a.case})}),[t]),p=Object(n.useMemo)((()=>rE({getAppUrl:e,navigateTo:t})),[e,t]);return i.a.createElement(du.a,{show:!0,targetClassNames:[De.a]},i.a.createElement(B.EuiPanel,{hasBorder:!0,"data-test-subj":"recentlyCreatedCasesPanel"},i.a.createElement(Tt.a,{id:iE,title:Ly.j,titleSize:"s",toggleStatus:a,toggleQuery:s,subtitle:i.a.createElement(fy.a,{updatedAt:c,isUpdating:l}),showInspectButton:!1}),a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiBasicTable,{"data-test-subj":"recentlyCreatedCasesTable",columns:p,items:o,loading:l,noItemsMessage:i.a.createElement(B.EuiEmptyPrompt,{title:i.a.createElement("h3",null,Ly.q),titleSize:"xs"})}),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiButton,{"data-test-subj":"allCasesButton",onClick:d},Ly.N))))}));sE.displayName="CasesTable";const rE=()=>[{field:"id",name:Ly.g,"data-test-subj":"recentlyCreatedCaseName",render:(e,{name:t})=>i.a.createElement(B.EuiToolTip,{title:Ly.s,content:t,anchorClassName:"eui-textTruncate"},i.a.createElement(ue.a,{detailName:e},t))},{field:"totalAlerts",name:Ly.c,truncateText:!0,textOnly:!0,"data-test-subj":"recentlyCreatedCaseAlert",render:e=>i.a.createElement(qy.a,{count:e})},{field:"createdAt",name:Ly.i,render:e=>i.a.createElement(Ba.a,{fieldName:Ly.i,value:e,className:"eui-textTruncate",dateFormat:"MMMM D, YYYY"}),"data-test-subj":"recentlyCreatedCaseTime"},{field:"createdBy",name:Ly.f,render:e=>i.a.createElement(B.EuiText,{"data-test-subj":"recentlyCreatedCaseCreatedBy",size:"s"},e)},{field:"status",name:Ly.h,render:e=>i.a.createElement(aE,{status:e}),"data-test-subj":"recentlyCreatedCaseStatus"}];var oE=a(276);const lE="casesByStatus",cE={series:{xScaleType:We.ScaleType.Ordinal,yScaleType:We.ScaleType.Linear,stackAccessors:["g"],barSeriesStyle:{rect:{widthPixel:22,opacity:1}}},axis:{xTickFormatter:e=>e.toLocaleString(),left:{style:{tickLine:{size:0},tickLabel:{padding:16,fontSize:14}}},bottom:{style:{tickLine:{size:0},tickLabel:{padding:16,fontSize:10.5}},labelFormat:e=>_t()(e).format("0")}},settings:{rotation:90},customHeight:146},uE=H()(B.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1ovqqq4-0"})(["align-items:center;width:70%;"]),dE=H.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1ovqqq4-1"})(["width:100%;"]),pE=()=>{const{toggleStatus:e,setToggleStatus:t}=Object(zt.a)(lE),{getAppUrl:a,navigateTo:s}=Object(u.m)(),{search:o}=Object(c.l)(r.uc.case),l=a({deepLinkId:r.uc.case,path:Object(oE.a)(o)}),d=Object(n.useCallback)((e=>{e.preventDefault(),s({url:l})}),[l,s]),{closed:p,inProgress:m,isLoading:g,open:f,totalCounts:b,updatedAt:h}=(({skip:e=!1})=>{var t,a,i,s,o,l;const{services:{cases:c}}=Object(u.k)(),{to:d,from:p,setQuery:m,deleteQuery:g}=Object(U.a)(),f=Object(n.useMemo)((()=>`useCaseItems-${Qe.a.v4()}`),[]),[b,h]=Object(n.useState)(Date.now()),[y,E]=Object(n.useState)(!0),[v,k]=Object(n.useState)(null);return Object(n.useEffect)((()=>{let t=!0;const a=new AbortController,n=async()=>{try{const e=await c.api.cases.getCasesStatus({from:p,to:d,owner:r.o},a.signal);t&&k(e)}catch(e){t&&k(null)}t&&(E(!1),h(Date.now()))};return e||(n(),m({id:f,inspect:null,loading:!1,refetch:n})),e&&(E(!1),t=!1,a.abort()),()=>{t=!1,a.abort(),g({id:f})}}),[c.api.cases,p,e,d,m,g,f]),{closed:null!==(t=null==v?void 0:v.countClosedCases)&&void 0!==t?t:0,inProgress:null!==(a=null==v?void 0:v.countInProgressCases)&&void 0!==a?a:0,isLoading:y,open:null!==(i=null==v?void 0:v.countOpenCases)&&void 0!==i?i:0,totalCounts:(null!==(s=null==v?void 0:v.countClosedCases)&&void 0!==s?s:0)+(null!==(o=null==v?void 0:v.countInProgressCases)&&void 0!==o?o:0)+(null!==(l=null==v?void 0:v.countOpenCases)&&void 0!==l?l:0),updatedAt:b}})({skip:!e}),y=Object(n.useMemo)((()=>[{key:"open",value:[{y:f,x:Ly.I,g:Ly.I}],color:"#79aad9"},{key:"in-progress",value:[{y:m,x:Ly.F,g:Ly.F}],color:"#f1d86f"},{key:"closed",value:[{y:p,x:Ly.C,g:Ly.C}],color:"#d3dae6"}]),[p,m,f]);return i.a.createElement(B.EuiPanel,{hasBorder:!0},i.a.createElement(Tt.a,{id:lE,title:Ly.e,titleSize:"s",toggleStatus:e,toggleQuery:t,subtitle:i.a.createElement(fy.a,{updatedAt:h,isUpdating:g}),showInspectButton:!1},i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(ue.g,{href:l,onClick:d},Ly.M)))),!g&&e&&i.a.createElement(B.EuiFlexGroup,{justifyContent:"center",alignItems:"center",direction:"column",gutterSize:"s"},i.a.createElement(B.EuiFlexItem,null,0!==b&&i.a.createElement(B.EuiText,{className:"eui-textCenter",size:"s",grow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement("b",null,i.a.createElement(Hs.FormattedNumber,{value:b}))," ",i.a.createElement("span",null," ",Object(Ly.d)(b))))),i.a.createElement(uE,{grow:!1},i.a.createElement(dE,{"data-test-subj":"chart-wrapper"},i.a.createElement(yu.a,{configs:cE,barChart:y})))))},mE=i.a.memo(pE),gE=()=>{const{docLinks:e}=Object(u.k)().services,t=Object(n.useMemo)((()=>({feature:{icon:"documents",label:Cc.d,url:`${e.links.siem.privileges}`,target:"_blank"}})),[e]);return i.a.createElement(ie.a,{"data-test-subj":"noPermissionPage",actions:t,title:Cc.g,message:Cc.f})},fE=()=>{const{indicesExist:e,indexPattern:t,loading:a}=Object(p.d)(),{signalIndexName:n}=Object(sn.a)(),{hasKibanaREAD:s,hasIndexRead:r}=Object(na.a)(),o=Object(u.i)().read,l=s&&r,c=Object(oy.a)("socTrendsEnabled");return l||o?i.a.createElement(i.a.Fragment,null,e?i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,{"data-test-subj":"detectionResponsePage"},i.a.createElement(Yt.a,{title:Cc.b},i.a.createElement(G.a,{id:V.a.global,indexPattern:t,hideFilterBar:!0,hideQueryInput:!0})),a?i.a.createElement(B.EuiLoadingSpinner,{size:"l","data-test-subj":"detectionResponseLoader"}):i.a.createElement(B.EuiFlexGroup,{direction:"column","data-test-subj":"detectionResponseSections"},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiFlexGroup,null,l&&i.a.createElement(B.EuiFlexItem,null,i.a.createElement(nn.a,{signalIndexName:n})),o&&i.a.createElement(B.EuiFlexItem,null,i.a.createElement(mE,null)))),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiFlexGroup,null,i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiFlexGroup,{direction:"column"},l&&i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Gy,{signalIndexName:n})),o&&i.a.createElement(B.EuiFlexItem,null,i.a.createElement(sE,null)))),c&&i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(_y,{signalIndexName:n})))),l&&i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiFlexGroup,null,i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Vy,{signalIndexName:n})),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Xy,{signalIndexName:n}))))))):i.a.createElement(Xt.a,null),i.a.createElement(h.a,{pageName:v.a.detectionAndResponse})):i.a.createElement(gE,null)},bE=i.a.memo(fE);var hE=a(18);const yE=N.i18n.translate("xpack.securitySolution.paywall.platinum",{defaultMessage:"Platinum"}),EE=N.i18n.translate("xpack.securitySolution.paywall.upgradeMessage",{defaultMessage:"This feature is available with Platinum or higher subscription"}),vE=N.i18n.translate("xpack.securitySolution.paywall.upgradeButton",{defaultMessage:"Upgrade to Platinum"});var kE=a(1195),SE=a.n(kE);const TE=H.a.div.withConfig({displayName:"PaywallDiv",componentId:"sc-10p6lrh-0"})(["max-width:75%;margin:0 auto;.euiCard__betaBadgeWrapper{.euiCard__betaBadge{width:auto;}}.platinumCardDescription{padding:0 15%;}"]),xE=H()(B.EuiCard).withConfig({displayName:"StyledEuiCard",componentId:"sc-10p6lrh-1"})(["span.euiTitle{max-width:540px;display:block;margin:0 auto;}"]),wE=Object(n.memo)((({heading:e})=>{const{getAppUrl:t,navigateTo:a}=Object(u.m)(),s=t({appId:"management",path:"stack/license_management"}),r=Object(n.useCallback)((()=>{a({url:s})}),[a,s]);return i.a.createElement(TE,null,i.a.createElement(xE,{"data-test-subj":"platinumCard",betaBadgeProps:{label:yE},icon:i.a.createElement(B.EuiIcon,{size:"xl",type:"lock"}),display:"subdued",title:i.a.createElement("h3",null,i.a.createElement("strong",null,e)),description:!1,paddingSize:"xl"},i.a.createElement(B.EuiFlexGroup,{className:"platinumCardDescription",direction:"column",gutterSize:"none"},i.a.createElement(B.EuiText,null,i.a.createElement(B.EuiFlexItem,null,i.a.createElement("p",null,i.a.createElement(B.EuiTextColor,{color:"subdued"},EE))),i.a.createElement(B.EuiFlexItem,null,i.a.createElement("div",null,i.a.createElement(B.EuiButton,{onClick:r,fill:!0},vE)))))),i.a.createElement(B.EuiFlexGroup,null,i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiImage,{alt:EE,src:SE.a,size:"fullWidth"}))))}));wE.displayName="Paywall";var OE=a(368),jE=a(749),IE=a(512),CE=a(634),ME=a(698),DE=a(641);const AE=e=>{var t;return null!==(t=ps.a[e.dataName])&&void 0!==t?t:IE.b},FE=H()(B.EuiFlexItem).withConfig({displayName:"DonutContainer",componentId:"sc-1tc3rph-0"})(["padding-right:",";padding-left:",";"],(({theme:e})=>e.eui.euiSizeXXL),(({theme:e})=>e.eui.euiSizeM)),RE=H()(B.EuiFlexItem).withConfig({displayName:"StyledLegendItems",componentId:"sc-1tc3rph-1"})(["justify-content:center;"]),PE=({severityCount:e})=>{const[t,a,s]=(e=>{const[t,a,i]=Object(n.useMemo)((()=>{const t=Object.keys(ps.a);return[t.map((t=>({key:t,value:e[t]}))),t.map((e=>({color:ps.a[e],field:"kibana.alert.severity",value:e}))),Object(y.sum)(Object.values(e))]}),[e]);return[t,a,i]})(e);return i.a.createElement(B.EuiFlexGroup,{responsive:!1},i.a.createElement(RE,{grow:!1},a.length>0&&i.a.createElement(ME.a,{legendItems:a})),i.a.createElement(FE,{grow:!1,className:"eui-textCenter"},i.a.createElement(CE.a,{data:null!=t?t:null,fillColor:AE,height:120,label:co.c,title:i.a.createElement(DE.a,{count:s}),totalCount:s})))},_E=H()(B.EuiBasicTable).withConfig({displayName:"BasicTableWithoutBorderBottom",componentId:"sc-1nwk2cn-0"})([".euiTableRow{.euiTableRowCell{border-bottom:none !important;}}"]);var qE=a(261);const NE=()=>{const e=Object(n.useMemo)((()=>Object(qE.h)()),[]),t=Object(E.a)((t=>e(t,V.a.global)));return Object(n.useCallback)((()=>{t.forEach((e=>e.refetch&&e.refetch()))}),[t])},LE="hostRiskDashboardTable",BE=()=>{const{deleteQuery:e,setQuery:t,from:a,to:s}=Object(U.a)(),[l,c]=Object(n.useState)(Date.now()),{toggleStatus:u,setToggleStatus:d}=Object(zt.a)(LE),p=Object(n.useMemo)((()=>[{field:"host.name",name:jE.a,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e&&e.length>0?i.a.createElement(ue.d,{hostName:e,hostTab:En.HostsTableType.risk}):Object(ri.d)()},{field:rn.w.hostRiskScore,name:jE.c,truncateText:!0,mobileOptions:{show:!0},render:e=>null!=e?i.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},e.toFixed(2)):Object(ri.d)()},{field:rn.w.hostRisk,name:i.a.createElement(B.EuiToolTip,{content:jE.d},i.a.createElement(i.a.Fragment,null,jE.b,i.a.createElement(B.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?i.a.createElement(ps.b,{severity:e}):Object(ri.d)()}]),[]),[m,g]=Object(n.useState)([]),f=Object(ue.o)(),b=Object(o.useDispatch)(),h=Object(n.useMemo)((()=>{const[e]=Object(sd.a)(m,rn.v.host);return e?JSON.stringify(e.query):void 0}),[m]),y=Object(n.useMemo)((()=>({from:a,to:s})),[a,s]),{severityCount:E,loading:k,refetch:S,inspect:T}=Object(Io.d)({filterQuery:h,skip:!u,timerange:y});Object(Pi.b)({queryId:"headerHostRiskScoreKpiQuery",loading:k,refetch:S,setQuery:t,deleteQuery:e,inspect:T});const[x,{data:w,inspect:O,refetch:j,isDeprecated:I,isLicenseValid:C,isModuleEnabled:M}]=Object(Io.c)({filterQuery:h,skip:!u,pagination:{cursorStart:0,querySize:5},timerange:y});Object(Pi.b)({queryId:LE,loading:x,refetch:j,setQuery:t,deleteQuery:e,inspect:O}),Object(n.useEffect)((()=>{c(Date.now())}),[x,k]);const[D,A]=Object(n.useMemo)((()=>{const{onClick:e,href:t}=f({deepLinkId:v.a.hosts,path:Object(OE.c)(En.HostsTableType.risk),onClick:()=>{b(Rn.a.updateHostRiskScoreSeverityFilter({severitySelection:[],hostsType:En.HostsType.page}))}});return[e,t]}),[b,f]),F=NE();return C?M||x?I&&!x?i.a.createElement(po,{entityType:rn.v.host,refetch:F,timerange:y}):M&&0===m.length&&w&&0===w.length?i.a.createElement($l,{entityType:rn.v.host,refetch:F}):i.a.createElement(De.c,null,i.a.createElement(Mn.a,{hasBorder:!0,"data-test-subj":"entity_analytics_hosts"},i.a.createElement(Tt.a,{title:i.a.createElement(uo.a,{riskScoreEntity:rn.v.host}),titleSize:"s",subtitle:i.a.createElement(fy.a,{isUpdating:x||k,updatedAt:l}),id:LE,toggleStatus:u,toggleQuery:d,tooltip:co.a},u&&i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiButtonEmpty,{rel:"noopener nofollow noreferrer",href:r.cc,target:"_blank"},jE.e)),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(Xl,{selectedSeverities:m,severityCount:null!=E?E:rn.c,title:jE.b,onSelect:g})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(ue.g,{"data-test-subj":"view-all-button",onClick:D,href:A},jE.f)))),u&&i.a.createElement(B.EuiFlexGroup,{"data-test-subj":"entity_analytics_content"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(PE,{severityCount:null!=E?E:rn.c})),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(_E,{responsive:!1,items:null!=w?w:[],columns:p,loading:x,id:LE}))),(x||k)&&i.a.createElement(ba.a,{"data-test-subj":"loadingPanelRiskScore",overlay:!0,size:"xl"}))):i.a.createElement(Nl,{refetch:F,timerange:y}):null},zE=i.a.memo(BE);zE.displayName="EntityAnalyticsHostRiskScores";var HE=a(186);const $E=N.i18n.translate("xpack.securitySolution.entityAnalytics.header.criticalHosts",{defaultMessage:"Critical Hosts"}),VE=N.i18n.translate("xpack.securitySolution.entityAnalytics.header.criticalUsers",{defaultMessage:"Critical Users"}),UE=N.i18n.translate("xpack.securitySolution.entityAnalytics.header.anomalies",{defaultMessage:"Anomalies"});var QE=a(507),WE=a(644);const GE=["auth_rare_source_ip_for_a_user","packetbeat_dns_tunneling","packetbeat_rare_server_domain","packetbeat_rare_dns_question","suspicious_login_activity","v3_windows_anomalous_script"];let KE,JE;!function(e){e[e.enabled=0]="enabled",e[e.disabled=1]="disabled",e[e.uninstalled=2]="uninstalled",e[e.failed=3]="failed"}(KE||(KE={})),function(e){e[e.User=0]="User",e[e.Host=1]="Host"}(JE||(JE={}));const YE=({skip:e,from:t,to:a})=>{const[i,s]=Object(n.useState)(ZE([],[])),o=Object(n.useRef)(y.noop),{loading:l,isMlUser:c,jobs:d}=Object(Dn.a)(),[p,m]=Object(n.useState)(!0),{addError:g}=Object(ma.a)(),[f]=Object(u.q)(r.I),{notableAnomaliesJobs:b,query:h}=Object(n.useMemo)((()=>{const e=d.filter((({id:e})=>GE.some((t=>ev(e,t))))),n=(({from:e,to:t,jobIds:a,anomalyScoreThreshold:n})=>({size:0,query:{bool:{filter:[{term:{result_type:"record"}},{range:{record_score:{gte:n}}},{range:{timestamp:{gte:e,lte:t}}},{terms:{job_id:a}}]}},aggs:{number_of_anomalies:{terms:{field:"job_id"},aggs:{entity:{top_hits:{_source:{includes:["host.name","user.name"]},size:1}}}}}}))({jobIds:e.map((({id:e})=>e)),anomalyScoreThreshold:f,from:t,to:a});return{query:n,notableAnomaliesJobs:e}}),[d,f,t,a]);return Object(n.useEffect)((()=>{let t=!0;const a=new AbortController;async function n(){if(t)if(!e&&c&&0!==b.length){m(!0);try{const e=await(async(e,t)=>u.b.get().http.fetch("/api/ml/results/anomaly_search",{method:"POST",body:JSON.stringify(e),asSystemRequest:!0,signal:t}))({jobIds:b.map((({id:e})=>e)),query:h},a.signal);if(t){m(!1);const t=e.aggregations.number_of_anomalies.buckets;s(ZE(t,b))}}catch(e){t&&"AbortError"!==e.name&&(g(e,{title:WE.a}),m(!1))}}else m(!1)}return n(),o.current=n,()=>{t=!1,a.abort()}}),[e,c,g,h,b]),{isLoading:p||l,data:i,refetch:o.current}},XE=(e,t,a)=>{if(t){if(Object(el.c)(t.jobState,t.datafeedState))return KE.enabled;if(Object(el.a)(t.jobState,t.datafeedState))return KE.failed}return a.some((({id:t})=>ev(t,e)))?KE.disabled:KE.uninstalled};function ZE(e,t){return GE.map((a=>{var n;const i=tv(a)(t),s=e.find((({key:e})=>e===(null==i?void 0:i.id))),r=Object(y.has)("entity.hits.hits[0]._source['user.name']",s);return{name:a,jobId:null==i?void 0:i.id,count:null!==(n=null==s?void 0:s.doc_count)&&void 0!==n?n:0,status:XE(a,i,t),entity:r?JE.User:JE.Host}}))}const ev=(e,t)=>e.endsWith(t),tv=e=>Object(y.pipe)(Object(y.filter)((({id:t})=>ev(t,e))),Object(y.orderBy)("latestTimestampSortValue","desc"),y.head),av=H()(B.EuiTitle).withConfig({displayName:"StyledEuiTitle",componentId:"sc-yr7774-0"})(["color:",";"],(({theme:{eui:e}})=>e.euiColorDanger)),nv=()=>{const{from:e,to:t}=Object(U.a)(!1),a=Object(n.useMemo)((()=>({from:e,to:t})),[e,t]),{severityCount:s,loading:r,inspect:l,refetch:c}=Object(Io.d)({timerange:a}),{severityCount:d,loading:p,refetch:m,inspect:g}=Object(Io.f)({timerange:a}),{data:f}=YE({skip:!1,from:e,to:t}),b=Object(o.useDispatch)(),h=Object(ue.o)(),E=Object(dn.a)().isPlatinumOrTrialLicense,{services:{ml:k,http:S}}=Object(u.k)(),[T,x]=Object(n.useMemo)((()=>{const{onClick:e,href:t}=h({deepLinkId:v.a.hosts,path:Object(OE.c)(En.HostsTableType.risk),onClick:()=>{b(Rn.a.updateHostRiskScoreSeverityFilter({severitySelection:[rn.x.critical],hostsType:En.HostsType.page})),b(Rn.a.updateHostRiskScoreSort({sort:{field:rn.w.hostRiskScore,direction:rn.b.desc},hostsType:En.HostsType.page}))}});return[e,t]}),[b,h]),[w,O]=Object(n.useMemo)((()=>{const{onClick:e,href:t}=h({deepLinkId:v.a.users,path:Object(QE.b)(md.UsersTableType.risk),onClick:()=>{b(kd.b.updateUserRiskScoreSeverityFilter({severitySelection:[rn.x.critical]})),b(kd.b.updateTableSorting({sort:{field:rn.w.userRiskScore,direction:rn.b.desc},tableType:md.UsersTableType.risk}))}});return[e,t]}),[b,h]),{deleteQuery:j,setQuery:I}=Object(U.a)();Object(Pi.b)({queryId:"userRiskScoreKpiQuery",loading:p,refetch:m,setQuery:I,deleteQuery:j,inspect:g}),Object(Pi.b)({queryId:"hostRiskScoreKpiQuery",loading:r,refetch:c,setQuery:I,deleteQuery:j,inspect:l});const C=Object(n.useMemo)((()=>f.some((({jobId:e})=>!!e))),[f]),M=Object(n.useMemo)((()=>C?Object(y.sumBy)("count",f):"-"),[f,C]),D=Object(HE.useMlHref)(k,S.basePath.get(),{page:HE.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE});return i.a.createElement(B.EuiPanel,{hasBorder:!0,paddingSize:"l"},i.a.createElement(B.EuiFlexGroup,{justifyContent:"spaceAround"},E&&i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(B.EuiFlexItem,{className:"eui-textCenter"},i.a.createElement(av,{"data-test-subj":"critical_hosts_quantity",size:"l"},i.a.createElement("span",null,s?s[rn.x.critical]:"-"))),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(ue.f,{onClick:T,href:x,"data-test-subj":"critical_hosts_link"},$E)))),E&&i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(B.EuiFlexItem,{className:"eui-textCenter"},i.a.createElement(av,{"data-test-subj":"critical_users_quantity",size:"l"},i.a.createElement("span",null,d?d[rn.x.critical]:"-"))),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(ue.f,{onClick:w,href:O,"data-test-subj":"critical_users_link"},VE)))),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(B.EuiFlexItem,{className:"eui-textCenter"},i.a.createElement(B.EuiTitle,{"data-test-subj":"anomalies_quantity",size:"l"},i.a.createElement("span",null,M))),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(ue.f,{"data-test-subj":"all_anomalies_link",href:D,target:"_blank"},UE))))))},iv=N.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.userRiskToolTip",{defaultMessage:"User risk classification is determined by User risk score. Users classified as Critical or High are indicated as risky."}),sv=N.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.userRiskClassificationTitle",{defaultMessage:"User risk classification"}),rv=N.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.userRiskScoreTitle",{defaultMessage:"User risk score"}),ov=N.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.userNameTitle",{defaultMessage:"User Name"}),lv=(N.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.totalLabel",{defaultMessage:"Total"}),N.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.viewAllLabel",{defaultMessage:"View all"})),cv=N.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.learnMore",{defaultMessage:"Learn more"}),uv=(N.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.enableViaDevToolsButtonTitle",{defaultMessage:"Enable via Dev Tools"}),"userRiskDashboardTable"),dv=()=>{const{deleteQuery:e,setQuery:t,from:a,to:s}=Object(U.a)(),[l,c]=Object(n.useState)(Date.now()),{toggleStatus:u,setToggleStatus:d}=Object(zt.a)(uv),p=Object(n.useMemo)((()=>[{field:"user.name",name:ov,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e&&e.length>0?i.a.createElement(ue.m,{userName:e,userTab:md.UsersTableType.risk}):Object(ri.d)()},{field:rn.w.userRiskScore,name:rv,truncateText:!0,mobileOptions:{show:!0},render:e=>null!=e?i.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},e.toFixed(2)):Object(ri.d)()},{field:rn.w.userRisk,name:i.a.createElement(B.EuiToolTip,{content:iv},i.a.createElement(i.a.Fragment,null,sv,i.a.createElement(B.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?i.a.createElement(ps.b,{severity:e}):Object(ri.d)()}]),[]),[m,g]=Object(n.useState)([]),f=Object(ue.o)(),b=Object(o.useDispatch)(),h=Object(n.useMemo)((()=>{const[e]=Object(sd.a)(m,rn.v.user);return e?JSON.stringify(e.query):void 0}),[m]),y=Object(n.useMemo)((()=>({from:a,to:s})),[a,s]),{severityCount:E,loading:k,refetch:S,inspect:T}=Object(Io.f)({filterQuery:h,skip:!u,timerange:y}),[x,{data:w,inspect:O,refetch:j,isLicenseValid:I,isDeprecated:C,isModuleEnabled:M}]=Object(Io.e)({filterQuery:h,skip:!u,pagination:{cursorStart:0,querySize:5},timerange:y});Object(Pi.b)({queryId:uv,loading:x,refetch:j,setQuery:t,deleteQuery:e,inspect:O}),Object(Pi.b)({queryId:"headerUserRiskScoreKpiQuery",loading:k,refetch:S,setQuery:t,deleteQuery:e,inspect:T}),Object(n.useEffect)((()=>{c(Date.now())}),[x,k]);const[D,A]=Object(n.useMemo)((()=>{const{onClick:e,href:t}=f({deepLinkId:v.a.users,path:Object(QE.b)(md.UsersTableType.risk),onClick:()=>{b(kd.b.updateUserRiskScoreSeverityFilter({severitySelection:[]}))}});return[e,t]}),[b,f]),F=NE();return I?M||x?C&&!x?i.a.createElement(po,{entityType:rn.v.user,refetch:F,timerange:y}):M&&0===m.length&&w&&0===w.length?i.a.createElement($l,{entityType:rn.v.user,refetch:F}):i.a.createElement(De.c,null,i.a.createElement(Mn.a,{hasBorder:!0,"data-test-subj":"entity_analytics_users"},i.a.createElement(Tt.a,{title:i.a.createElement(uo.a,{riskScoreEntity:rn.v.user}),titleSize:"s",subtitle:i.a.createElement(fy.a,{isUpdating:x||k,updatedAt:l}),id:uv,toggleStatus:u,toggleQuery:d,tooltip:co.d},u&&i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiButtonEmpty,{rel:"noopener nofollow noreferrer",href:r.ec,target:"_blank"},cv)),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(Xl,{selectedSeverities:m,severityCount:null!=E?E:rn.c,title:sv,onSelect:g})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(ue.g,{"data-test-subj":"view-all-button",onClick:D,href:A},lv)))),u&&i.a.createElement(B.EuiFlexGroup,{"data-test-subj":"entity_analytics_content"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(PE,{severityCount:null!=E?E:rn.c})),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(_E,{responsive:!1,items:null!=w?w:[],columns:p,loading:x,id:uv}))),(x||k)&&i.a.createElement(ba.a,{"data-test-subj":"loadingPanelRiskScore",overlay:!0,size:"xl"}))):i.a.createElement(tp,{refetch:F,timerange:y}):null},pv=i.a.memo(dv);pv.displayName="EntityAnalyticsUserRiskScores";const mv=N.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.anomaliesTitle",{defaultMessage:"Notable Anomalies"}),gv=N.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.anomalyName",{defaultMessage:"Anomaly name"}),fv=N.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.anomalyCount",{defaultMessage:"Count"}),bv=N.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.viewUsersAnomalies",{defaultMessage:"View all user anomalies"}),hv=N.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.viewHostsAnomalies",{defaultMessage:"View all host anomalies"}),yv=N.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.viewAnomalies",{defaultMessage:"View all"}),Ev=N.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.enableJob",{defaultMessage:"Run job"}),vv=N.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.jobStatusDisabled",{defaultMessage:"disabled"}),kv=N.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.jobStatusUninstalled",{defaultMessage:"uninstalled"}),Sv=N.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.jobStatusFailed",{defaultMessage:"failed"}),Tv=H.a.span.withConfig({displayName:"MediumShadeText",componentId:"sc-16wzidn-0"})(["color:",";"],(({theme:e})=>e.eui.euiColorMediumShade)),xv={[KE.disabled]:vv,[KE.failed]:Sv},wv=({jobId:e})=>{const{services:{ml:t,http:a,application:{navigateToUrl:s}}}=Object(u.k)(),r=Object(HE.useMlHref)(t,a.basePath.get(),{page:HE.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:e}}),o=Object(n.useCallback)((e=>{e.preventDefault(),s(r)}),[r,s]);return i.a.createElement(ue.f,{"data-test-subj":"jobs-table-link",href:r,onClick:o},Ev)},Ov=({count:e,jobId:t,entity:a})=>{const s=Object(o.useDispatch)(),r=a===JE.User?v.a.usersAnomalies:v.a.hostsAnomalies,l=Object(n.useCallback)((()=>{t&&(a===JE.User?(s(kd.b.updateUsersAnomaliesJobIdFilter({jobIds:[t],usersType:md.UsersType.page})),s(kd.b.updateUsersAnomaliesInterval({interval:"second",usersType:md.UsersType.page}))):(s(Rn.a.updateHostsAnomaliesJobIdFilter({jobIds:[t],hostsType:En.HostsType.page})),s(Rn.a.updateHostsAnomaliesInterval({interval:"second",hostsType:En.HostsType.page}))))}),[t,s,a]);return i.a.createElement(ue.k,{onClick:l,deepLinkId:r},e)},jv="entityAnalyticsDashboardAnomaliesTable",Iv={sort:{field:"count",direction:"desc"}},Cv=()=>{const{services:{ml:e,http:t}}=Object(u.k)(),a=Object(HE.useMlHref)(e,t.basePath.get(),{page:HE.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE}),[s,r]=Object(n.useState)(Date.now()),{toggleStatus:o,setToggleStatus:l}=Object(zt.a)(jv),{deleteQuery:c,setQuery:d,from:p,to:m}=Object(U.a)(!1),{isLoading:g,data:f,refetch:b}=YE({skip:!o,from:p,to:m}),h=(y=g,Object(n.useMemo)((()=>[{field:"name",name:gv,truncateText:!0,mobileOptions:{show:!0},"data-test-subj":"anomalies-table-column-name",render:(e,{status:t,count:a})=>a>0||t===KE.enabled?e:i.a.createElement(Tv,null,e)},{field:"count",sortable:({count:e,status:t})=>e>0?e:t===KE.disabled?-1:-2,truncateText:!0,align:"right",name:fv,mobileOptions:{show:!0},width:"15%","data-test-subj":"anomalies-table-column-count",render:(e,{status:t,jobId:a,entity:n})=>y?"":e>0||t===KE.enabled?i.a.createElement(Ov,{count:e,jobId:a,entity:n}):t===KE.disabled&&a?i.a.createElement(wv,{jobId:a}):t===KE.uninstalled?i.a.createElement(B.EuiLink,{external:!0,target:"_blank",href:"https://www.elastic.co/guide/en/machine-learning/current/ml-ad-run-jobs.html"},kv):i.a.createElement(Tv,null,xv[t])}]),[y]));var y;const E=Object(ue.o)();Object(n.useEffect)((()=>{r(Date.now())}),[g]),Object(Pi.b)({refetch:b,queryId:jv,loading:g,setQuery:d,deleteQuery:c});const[k,S]=Object(n.useMemo)((()=>{const{onClick:e,href:t}=E({deepLinkId:v.a.hosts,path:Object(OE.c)(En.HostsTableType.anomalies)});return[e,t]}),[E]),[T,x]=Object(n.useMemo)((()=>{const{onClick:e,href:t}=E({deepLinkId:v.a.users,path:Object(QE.b)(md.UsersTableType.anomalies)});return[e,t]}),[E]);return i.a.createElement(B.EuiPanel,{hasBorder:!0,"data-test-subj":"entity_analytics_anomalies"},i.a.createElement(Tt.a,{title:mv,titleSize:"s",subtitle:i.a.createElement(fy.a,{isUpdating:g,updatedAt:s}),toggleStatus:o,toggleQuery:l},i.a.createElement(B.EuiFlexGroup,{alignItems:"center"},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(ue.f,{"data-test-subj":"anomalies_table_hosts_link",onClick:k,href:S,className:"eui-textNoWrap"},hv)),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(ue.f,{"data-test-subj":"anomalies_table_users_link",onClick:T,href:x,className:"eui-textNoWrap"},bv)),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(ue.g,{"data-test-subj":"anomalies_table_all",href:a,target:"_blank"},yv)))),o&&i.a.createElement(B.EuiInMemoryTable,{responsive:!1,items:f,columns:h,loading:g,id:jv,sorting:Iv}))},Mv=()=>{const{indicesExist:e,loading:t,indexPattern:a}=Object(p.d)(),{isPlatinumOrTrialLicense:n,capabilitiesFetched:s}=Object(dn.a)();return i.a.createElement(i.a.Fragment,null,e?i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,{"data-test-subj":"entityAnalyticsPage"},i.a.createElement(Yt.a,{title:hE.i},n&&s&&i.a.createElement(G.a,{id:V.a.global,indexPattern:a,hideFilterBar:!0,hideQueryInput:!0})),!n&&s?i.a.createElement(wE,{heading:Cc.c}):t?i.a.createElement(B.EuiLoadingSpinner,{size:"l","data-test-subj":"entityAnalyticsLoader"}):i.a.createElement(B.EuiFlexGroup,{direction:"column","data-test-subj":"entityAnalyticsSections"},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(nv,null)),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(zE,null)),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(pv,null)),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(Cv,null))))):i.a.createElement(Xt.a,null),i.a.createElement(h.a,{pageName:v.a.entityAnalytics}))},Dv=i.a.memo(Mv),Av=[{path:r.Yb,component:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:r.uc.overview},i.a.createElement(ry,null)))},{path:r.wb,component:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:r.uc.detectionAndResponse},i.a.createElement(bE,null)))},{path:r.Ob,render:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:r.uc.landing},i.a.createElement(zf,null)))},{path:r.Cb,render:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:r.uc.entityAnalytics},i.a.createElement(Dv,null)))}],Fv=N.i18n.translate("xpack.securitySolution.rules.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete rules"});var Rv=a(503);const Pv=N.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageTitle",{defaultMessage:"ML rule updates may override your existing rules"}),_v=N.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.cancelTitle",{defaultMessage:"Cancel"}),qv=N.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.confirmTitle",{defaultMessage:"Load rules"}),Nv=N.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.affectedJobsTitle",{defaultMessage:"Affected jobs:"}),Lv=()=>i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageBody",defaultMessage:"{summary} Documentation: {docs}",values:{summary:i.a.createElement("p",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageBody.summary",defaultMessage:"New V3 machine learning jobs have been released, and the latest corresponding prebuilt detection rules now use these new ML jobs. You're currently running one or more V1/V2 jobs, which only work with legacy prebuilt rules. To ensure continued coverage using V1/V2 jobs, you may need to duplicate or create new rules before updating your Elastic prebuilt detection rules. Check the documentation below for instructions on how to keep using the V1/V2 jobs, and how to start using the new V3 jobs."})),docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(Rv.b,null)))}}),Bv=H.a.ul.withConfig({displayName:"JobsUL",componentId:"sc-yxot17-0"})(["max-height:200px;overflow-y:auto;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(Ha.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),zv=({jobs:e,onCancel:t,onConfirm:a})=>i.a.createElement(B.EuiConfirmModal,{title:Pv,onCancel:t,onConfirm:a,cancelButtonText:_v,confirmButtonText:qv,buttonColor:"danger",defaultFocusedButton:"confirm"},i.a.createElement(Lv,null),Nv,i.a.createElement(Bv,null,e.map((e=>i.a.createElement("li",{key:e.id},e.id))))),Hv=Object(n.memo)(zv),$v=["v2_rare_process_by_host_linux_ecs","v2_linux_rare_metadata_user","v2_linux_rare_metadata_process","v2_linux_anomalous_user_name_ecs","v2_linux_anomalous_process_all_hosts_ecs","v2_linux_anomalous_network_port_activity_ecs","v2_rare_process_by_host_windows_ecs","v2_windows_anomalous_network_activity_ecs","v2_windows_anomalous_path_activity_ecs","v2_windows_anomalous_process_all_hosts_ecs","v2_windows_anomalous_process_creation","v2_windows_anomalous_user_name_ecs","v2_windows_rare_metadata_process","v2_windows_rare_metadata_user","rare_process_by_host_linux_ecs","linux_anomalous_network_activity_ecs","linux_anomalous_network_port_activity_ecs","linux_anomalous_network_service","linux_anomalous_network_url_activity_ecs","linux_anomalous_process_all_hosts_ecs","linux_anomalous_user_name_ecs","linux_rare_metadata_process","linux_rare_metadata_user","linux_rare_user_compiler","linux_rare_kernel_module_arguments","linux_rare_sudo_user","linux_system_user_discovery","linux_system_information_discovery","linux_system_process_discovery","linux_network_connection_discovery","linux_network_configuration_discovery","rare_process_by_host_windows_ecs","windows_anomalous_network_activity_ecs","windows_anomalous_path_activity_ecs","windows_anomalous_process_all_hosts_ecs","windows_anomalous_process_creation","windows_anomalous_script","windows_anomalous_service","windows_anomalous_user_name_ecs","windows_rare_user_runas_event","windows_rare_metadata_process","windows_rare_metadata_user","windows_rare_user_type10_remote_login"];var Vv=a(452);const Uv=H.a.div.withConfig({displayName:"ToolbarLayout",componentId:"sc-51u63m-0"})(["display:grid;grid-template-columns:1fr auto;align-items:center;grid-gap:16px;box-shadow:inset 0 -1px 0 ",";"],(({theme:e})=>e.eui.euiBorderColor));let Qv;!function(e){e.rules="rules",e.monitoring="monitoring"}(Qv||(Qv={}));const Wv=[{id:Qv.rules,name:il.Ac,disabled:!1},{id:Qv.monitoring,name:il.Qb,disabled:!1}],Gv=i.a.memo((({onTabChange:e,activeTab:t})=>{const{state:{isInMemorySorting:a},actions:{setIsInMemorySorting:s}}=Object(nl.b)(),{startTransaction:r}=Object(bl.a)(),o=Object(n.useCallback)((e=>{r({name:a?ml.d.PREVIEW_OFF:ml.d.PREVIEW_ON}),s(e.target.checked)}),[a,s,r]);return i.a.createElement(Uv,null,i.a.createElement(B.EuiTabs,null,Wv.map((a=>i.a.createElement(B.EuiTab,{"data-test-subj":`allRulesTableTab-${a.id}`,onClick:()=>e(a.id),isSelected:a.id===t,disabled:a.disabled,key:a.id},a.name)))),i.a.createElement(B.EuiToolTip,{content:il.Db},i.a.createElement(B.EuiSwitch,{"data-test-subj":a?"allRulesTableTechnicalPreviewOff":"allRulesTableTechnicalPreviewOn",label:a?il.Fb:il.Eb,checked:a,onChange:o})))}));Gv.displayName="RulesTableToolbar";var Kv=a(413);const Jv=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptTitle",{defaultMessage:"Load Elastic prebuilt detection rules"}),Yv=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptMessage",{defaultMessage:"Elastic Security comes with prebuilt detection rules that run in the background and create alerts when their conditions are met. By default, all prebuilt rules except the Endpoint Security rule are disabled. You can select additional rules you want to enable."}),Xv=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.createOwnRuletButton",{defaultMessage:"Create your own rules"}),Zv=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesTitle",{defaultMessage:"Update available for Elastic prebuilt rules or timeline templates"}),ek=e=>N.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesMsg",{values:{updateRules:e},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"}),tk=(e,t)=>N.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesMsg",{values:{updateRules:e,updateTimelines:t},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}. Note that this will reload deleted Elastic prebuilt rules."}),ak=e=>N.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesButton",{values:{updateRules:e},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"}),nk=e=>N.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesButton",{values:{updateTimelines:e},defaultMessage:"Update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"}),ik=(e,t)=>N.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesButton",{values:{updateRules:e,updateTimelines:t},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"}),sk=N.i18n.translate("xpack.securitySolution.detectionEngine.rules.releaseNotesHelp",{defaultMessage:"Release notes"}),rk=H()(B.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1rs1rob-0"})(["align-self:center;"]);rk.displayName="EmptyPrompt";const ok=({createPrePackagedRules:e,loading:t=!1,userHasPermissions:a=!1})=>{const[{isSignalIndexExists:s,isAuthenticated:r,hasEncryptionKey:o,canUserCRUD:l,hasIndexWrite:c}]=Object(ne.b)(),{loading:u,jobs:d}=Object(Dn.a)(),p=d.filter((e=>$v.includes(e.id))),[m,g]=Object(n.useState)(!1),{getLoadPrebuiltRulesAndTemplatesButton:f}=Object(Vv.d)({canUserCRUD:l,hasIndexWrite:c,isSignalIndexExists:s,isAuthenticated:r,hasEncryptionKey:o}),b=Object(n.useCallback)((()=>{g(!1),e()}),[e,g]),h=Object(n.useMemo)((()=>f({isDisabled:!a||t||u,onClick:()=>{p.length>0?g(!0):e()},fill:!0,"data-test-subj":"load-prebuilt-rules"})),[f,a,t,u,p,e]);return i.a.createElement(rk,{"data-test-subj":"rulesEmptyPrompt",title:i.a.createElement("h2",null,Jv),body:i.a.createElement("p",null,Yv),actions:i.a.createElement(B.EuiFlexGroup,{justifyContent:"center"},i.a.createElement(B.EuiFlexItem,{grow:!1},h),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(ue.l,{isDisabled:!a,iconType:"plusInCircle",deepLinkId:v.a.rulesCreate},Xv)),m&&i.a.createElement(Hv,{jobs:p,onCancel:()=>g(!1),onConfirm:b}))})},lk=Object(n.memo)(ok);var ck=a(274),uk=a(307);const dk=({onInit:e,onFinish:t})=>{const a=Object(n.useRef)(),i=Object(n.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.call(a,!0)}),[]),s=Object(n.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.call(a,!1)}),[]);return[Object(n.useCallback)((()=>(e(),new Promise((e=>{a.current=e})).finally((()=>{t()})))),[e,t]),i,s]};var pk=a(865);const mk=H.a.div.withConfig({displayName:"PopoverContentWrapper",componentId:"sc-1c6dnvx-0"})(["width:275px;"]),gk=H.a.div.withConfig({displayName:"ScrollableDiv",componentId:"sc-1c6dnvx-1"})(["max-height:250px;overflow-y:auto;"]),fk=H.a.span.withConfig({displayName:"TagOverflowContainer",componentId:"sc-1c6dnvx-2"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]),bk=({tags:e,selectedTags:t,onSelectedTagsChanged:a})=>{const s=Object(n.useMemo)((()=>Object(Ga.a)(Array.from(new Set([...e,...t])))),[t,e]),[r,o]=Object(n.useState)(!1),[l,c]=Object(n.useState)(""),[u,d]=Object(n.useState)(s),p=Object(n.useMemo)((()=>u.map(((e,n)=>i.a.createElement(B.EuiFilterSelectItem,{checked:t.includes(e)?"on":void 0,key:`${n}-${e}`,onClick:()=>Object(pk.a)(e,t,a),title:e},i.a.createElement(fk,null,e))))),[a,t,u]),m=Object(n.useCallback)((e=>{c(e.target.value)}),[]);return Object(n.useEffect)((()=>{d(s.filter((e=>e.toLowerCase().includes(l.toLowerCase()))))}),[s,l]),i.a.createElement(B.EuiPopover,{ownFocus:!0,button:i.a.createElement(B.EuiFilterButton,{grow:!0,"data-test-subj":"tags-filter-popover-button",iconType:"arrowDown",onClick:()=>o(!r),numFilters:e.length,isSelected:r,hasActiveFilters:t.length>0,numActiveFilters:t.length},il.Nc),isOpen:r,closePopover:()=>o(!r),panelPaddingSize:"none",repositionOnScroll:!0},i.a.createElement(mk,null,i.a.createElement(B.EuiPopoverTitle,null,i.a.createElement(B.EuiFieldSearch,{placeholder:"Search tags",value:l,onChange:m,isClearable:!0,"aria-label":"Rules tag search"})),i.a.createElement(gk,null,p),0===u.length&&i.a.createElement(B.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},i.a.createElement(B.EuiFlexItem,{grow:!0},i.a.createElement(B.EuiPanel,null,i.a.createElement(B.EuiText,null,il.Tb))))))};bk.displayName="TagsFilterPopoverComponent";const hk=i.a.memo(bk);hk.displayName="TagsFilterPopover";const yk=H()(B.EuiFlexGroup).withConfig({displayName:"FilterWrapper",componentId:"sc-16jvv68-0"})(["margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeXS)),Ek=H()(B.EuiFlexItem).withConfig({displayName:"SearchBarWrapper",componentId:"sc-16jvv68-1"})(["& .euiPopover,& .euiPopover__anchor{display:block;}"]),vk=({rulesCustomInstalled:e,rulesInstalled:t,allTags:a})=>{const{startTransaction:s}=Object(bl.a)(),{state:{filterOptions:r},actions:{setFilterOptions:o}}=Object(nl.b)(),{showCustomRules:l,showElasticRules:c,tags:u}=r,d=Object(n.useCallback)((e=>{s({name:ml.d.FILTER}),o({filter:e.trim()})}),[o,s]),p=Object(n.useCallback)((()=>{s({name:ml.d.FILTER}),o({showElasticRules:!c,showCustomRules:!1})}),[o,c,s]),m=Object(n.useCallback)((()=>{s({name:ml.d.FILTER}),o({showCustomRules:!l,showElasticRules:!1})}),[o,l,s]),g=Object(n.useCallback)((e=>{Object(y.isEqual)(e,u)||(s({name:ml.d.FILTER}),o({tags:e}))}),[u,o,s]);return i.a.createElement(yk,{gutterSize:"m",justifyContent:"flexEnd"},i.a.createElement(Ek,{grow:!0},i.a.createElement(B.EuiFieldSearch,{"aria-label":il.Hc,fullWidth:!0,incremental:!1,placeholder:il.Gc,onSearch:d})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiFilterGroup,null,i.a.createElement(hk,{onSelectedTagsChanged:g,selectedTags:u,tags:a,"data-test-subj":"allRulesTagPopover"}))),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiFilterGroup,null,i.a.createElement(B.EuiFilterButton,{hasActiveFilters:c,onClick:p,"data-test-subj":"showElasticRulesFilterButton",withNext:!0},il.Cb,null!=t?` (${t})`:""),i.a.createElement(B.EuiFilterButton,{hasActiveFilters:l,onClick:m,"data-test-subj":"showCustomRulesFilterButton"},il.qb,null!=e?` (${e})`:""))))};vk.displayName="RulesTableFiltersComponent";const kk=i.a.memo(vk);kk.displayName="RulesTableFilters";const Sk=i.a.memo((({canBulkEdit:e,isAllSelected:t,isAutoRefreshOn:a,numberSelectedItems:s,onGetBulkItemsPopoverContent:r,onRefresh:o,onRefreshSwitch:l,onToggleSelectAll:c,pagination:d,isBulkActionInProgress:p,hasDisabledActions:m})=>{const{timelines:g}=Object(u.k)().services,f=Object(nl.b)(),b=s>0,h=Object(n.useCallback)((e=>null!=r?i.a.createElement(B.EuiContextMenu,{initialPanelId:0,panels:r(e)}):null),[r]),y=Object(n.useCallback)((e=>t=>{null!=l&&(l(t.target.checked),e())}),[l]),E=Object(n.useCallback)((e=>i.a.createElement(B.EuiContextMenuPanel,{items:[i.a.createElement(B.EuiSwitch,{key:"allRulesAutoRefreshSwitch",label:il.Zb,checked:null!=a&&a,onChange:y(e),compressed:!0,disabled:b,"data-test-subj":"refreshSettingsSwitch"}),...b?[i.a.createElement("div",{key:"refreshSettingsSelectionNote"},i.a.createElement(B.EuiSpacer,{size:"s"}),i.a.createElement(B.EuiTextColor,{color:"subdued","data-test-subj":"refreshSettingsSelectionNote"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.refreshRulePopoverSelectionHelpText",defaultMessage:"Note: Refresh is disabled while there is an active selection."})))]:[]]})),[a,y,b]);return i.a.createElement(qa.a,{border:!0},i.a.createElement(qa.d,null,i.a.createElement(qa.c,null,i.a.createElement(qa.e,{dataTestSubj:"showingRules"},il.Lc(...(({page:e,perPage:t,total:a})=>[0===a?0:(e-1)*t+1,e*t>a?a:e*t,a])(d)))),i.a.createElement(i.a.Fragment,null,i.a.createElement(qa.c,{"data-test-subj":"tableBulkActions"},i.a.createElement(qa.e,{dataTestSubj:"selectedRules"},il.Ic(s)),e&&i.a.createElement(qa.b,{disabled:m,dataTestSubj:"selectAllRules",iconType:t?"cross":"pagesSelect",iconSide:"left",onClick:c},t?il.Z:il.Jc(d.total)),e&&i.a.createElement(qa.b,{disabled:m,inProgress:p,dataTestSubj:"bulkActions",iconSide:"right",iconType:"arrowDown",popoverPanelPaddingSize:"none",popoverContent:h},il.f),i.a.createElement(qa.b,{disabled:m,dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:o},il.Yb),i.a.createElement(qa.b,{disabled:m,dataTestSubj:"refreshSettings",iconSide:"right",iconType:"arrowDown",popoverContent:E},il.ac)))),i.a.createElement(qa.d,{dataTestSubj:"refreshRulesStatus"},g.getLastUpdated({showUpdating:f.state.isFetching,updatedAt:f.state.lastUpdated})))}));Sk.displayName="RulesTableUtilityBar";var Tk=a(218),xk=a(2);const wk=(e,t)=>{if(e===dl.a.edit&&t)switch(t){case dl.b.add_index_patterns:case dl.b.delete_index_patterns:case dl.b.set_index_patterns:case dl.b.add_tags:case dl.b.delete_tags:case dl.b.set_tags:return[{type:t,value:[]}];case dl.b.set_timeline:return[{type:t,value:{timeline_id:"",timeline_title:""}}];case dl.b.add_rule_actions:case dl.b.set_rule_actions:return[{type:t,value:{throttle:"1h",actions:[]}}];case dl.b.set_schedule:return[{type:t,value:{interval:"5m",lookback:"1m"}}];default:Object(xk.a)(t)}},Ok=({errorCode:e,message:t,rulesCount:a})=>{switch(e){case r.D.IMMUTABLE:return i.a.createElement("li",{key:t},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.elasticRulesEditDescription",defaultMessage:"{rulesCount, plural, =1 {# prebuilt Elastic rule} other {# prebuilt Elastic rules}} (editing prebuilt rules is not supported)",values:{rulesCount:a}}));case r.D.MACHINE_LEARNING_INDEX_PATTERN:return i.a.createElement("li",{key:t},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.machineLearningRulesIndexEditDescription",defaultMessage:"{rulesCount, plural, =1 {# custom machine learning rule} other {# custom machine learning rules}} (these rules don't have index patterns)",values:{rulesCount:a}}));case r.D.MACHINE_LEARNING_AUTH:return i.a.createElement("li",{key:t},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.machineLearningRulesAuthDescription",defaultMessage:"{rulesCount, plural, =1 {# machine learning rule} other {# machine learning rules}} can't be edited ({message})",values:{rulesCount:a,message:t}}));default:return i.a.createElement("li",{key:t},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.defaultRulesEditFailureDescription",defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} can't be edited ({message})",values:{rulesCount:a,message:t}}))}},jk=({errorCode:e,message:t,rulesCount:a})=>e===r.D.IMMUTABLE?i.a.createElement("li",{key:t},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.elasticRulesExportDescription",defaultMessage:"{rulesCount, plural, =1 {# prebuilt Elastic rule} other {# prebuilt Elastic rules}} (exporting prebuilt rules is not supported)",values:{rulesCount:a}})):i.a.createElement("li",{key:t},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.defaultRulesExportFailureDescription",defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} can't be exported ({message})",values:{rulesCount:a,message:t}})),Ik=({ruleErrors:e=[],bulkAction:t})=>0===e.length?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.actionRejectionDescription",defaultMessage:"This action can't be applied to the following rules in your selection:"}),i.a.createElement(B.EuiSpacer,null),i.a.createElement("ul",null,e.map((({message:e,errorCode:a,ruleIds:n})=>{const s=n.length;switch(t){case dl.a.edit:return i.a.createElement(Ok,{message:e,errorCode:a,rulesCount:s});case dl.a.export:return i.a.createElement(jk,{message:e,errorCode:a,rulesCount:s});default:return null}})))),Ck=i.a.memo(Ik);Ck.displayName="BulkActionRuleErrorsList";const Mk=(e,t)=>{switch(e){case dl.a.edit:return il.A(t);case dl.a.export:return il.Y(t);default:Object(xk.a)(e)}},Dk=(e,t)=>{switch(e){case dl.a.edit:return il.z(t);case dl.a.export:return il.X(t);default:Object(xk.a)(e)}},Ak=({onCancel:e,onConfirm:t,result:a,bulkAction:n})=>{const{failedRulesCount:s=0,succeededRulesCount:r=0,ruleErrors:o=[]}=null!=a?a:{};return 0===r?i.a.createElement(B.EuiConfirmModal,{title:Mk(n,s),onCancel:e,onConfirm:e,confirmButtonText:il.l,defaultFocusedButton:"confirm","data-test-subj":"bulkActionRejectModal"},i.a.createElement(Ck,{bulkAction:n,ruleErrors:o})):i.a.createElement(B.EuiConfirmModal,{title:il.m(r),onCancel:e,onConfirm:t,confirmButtonText:Dk(n,r),cancelButtonText:il.y,defaultFocusedButton:"confirm","data-test-subj":"bulkActionConfirmationModal"},i.a.createElement(Ck,{bulkAction:n,ruleErrors:o}))},Fk=i.a.memo(Ak);Fk.displayName="BulkActionDryRunConfirmation";var Rk=a(210);const Pk=({form:e,title:t,banner:a,children:n,onClose:s,onSubmit:r,flyoutSize:o="s"})=>{const l=Object(B.useGeneratedHtmlId)({prefix:"RulesBulkEditForm"}),{isValid:c}=e;return i.a.createElement(B.EuiFlyout,{ownFocus:!0,onClose:s,"aria-labelledby":l,size:o},i.a.createElement(B.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(B.EuiTitle,{size:"m","data-test-subj":"rulesBulkEditFormTitle"},i.a.createElement("h2",{id:l},t))),i.a.createElement(B.EuiFlyoutBody,{banner:a},i.a.createElement(Rk.c,{form:e},n)),i.a.createElement(B.EuiFlyoutFooter,null,i.a.createElement(B.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButtonEmpty,{onClick:s,flush:"left","data-test-subj":"rulesBulkEditFormCancelBtn"},il.K)),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{onClick:r,fill:!0,disabled:!1===c,"data-test-subj":"rulesBulkEditFormSaveBtn"},il.S)))))},_k=i.a.memo(Pk);_k.displayName="BulkEditFormWrapper";const qk=Object(Rk.j)({component:Rk.b}),Nk={index:{fieldsToValidateOnChange:["index"],type:Rk.a.COMBO_BOX,validations:[{validator:Rk.h.emptyField(il.E)}]},overwrite:{type:Rk.a.CHECKBOX,label:il.D},overwriteDataViews:{type:Rk.a.CHECKBOX,label:il.L}},Lk={index:[],overwrite:!1,overwriteDataViews:!1},Bk=({editAction:e,rulesCount:t,onClose:a,onConfirm:n})=>{const{form:s}=Object(Rk.k)({defaultValue:Lk,schema:Nk}),{indexHelpText:o,indexLabel:l,formTitle:c}=(e=>e===dl.b.add_index_patterns?{indexLabel:il.C,indexHelpText:il.B,formTitle:il.F}:{indexLabel:il.N,indexHelpText:il.M,formTitle:il.O})(e),[{overwrite:d,overwriteDataViews:p}]=Object(Rk.m)({form:s,watch:["overwrite","overwriteDataViews"]}),{uiSettings:m}=Object(u.k)().services,g=m.get(r.Q);return i.a.createElement(_k,{form:s,onClose:a,onSubmit:async()=>{const{data:t,isValid:a}=await s.submit();if(!a)return;const i={value:t.index,type:t.overwrite?dl.b.set_index_patterns:e,overwrite_data_views:t.overwriteDataViews};n(i)},title:c},i.a.createElement(qk,{path:"index",config:{...Nk.index,label:l,helpText:o},componentProps:{idAria:"bulkEditRulesIndexPatterns","data-test-subj":"bulkEditRulesIndexPatterns",euiFieldProps:{fullWidth:!0,placeholder:"",noSuggestions:!1,options:g.map((e=>({label:e})))}}}),e===dl.b.add_index_patterns&&i.a.createElement(qk,{path:"overwrite",componentProps:{idAria:"bulkEditRulesOverwriteIndexPatterns","data-test-subj":"bulkEditRulesOverwriteIndexPatterns"}}),d&&i.a.createElement(B.EuiFormRow,{fullWidth:!0},i.a.createElement(B.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesIndexPatternsWarning"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.setIndexPatternsWarningCallout",defaultMessage:"You’re about to overwrite index patterns for {rulesCount, plural, one {# selected rule} other {# selected rules}}, press Save to apply changes.",values:{rulesCount:t}}))),e===dl.b.add_index_patterns&&i.a.createElement(qk,{path:"overwriteDataViews",componentProps:{idAria:"bulkEditRulesOverwriteRulesWithDataViews","data-test-subj":"bulkEditRulesOverwriteRulesWithDataViews"}}),p&&i.a.createElement(B.EuiFormRow,{fullWidth:!0},i.a.createElement(B.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesDataViewsWarning"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.setDataViewsOverwriteWarningCallout",defaultMessage:"If you have selected rules which depend on a data view this action will force those rules to read from the index pattern as defined after this update, not the dataview, and may result in broken rules."}))),e===dl.b.delete_index_patterns&&i.a.createElement(B.EuiFormRow,{fullWidth:!0},i.a.createElement(B.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesDataViewsWarning"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPattnersDataViewsOverwriteWarningCallout",defaultMessage:"If you have selected rules which depend on a data view this action will not have any effect on those rules."}))))},zk=i.a.memo(Bk);zk.displayName="IndexPatternsForm";const Hk=Object(Rk.j)({component:Rk.b}),$k={tags:{fieldsToValidateOnChange:["tags"],type:Rk.a.COMBO_BOX,validations:[{validator:Rk.h.emptyField(il.T)}]},overwrite:{type:Rk.a.CHECKBOX,label:il.I}},Vk={tags:[],overwrite:!1},Uk=({editAction:e,rulesCount:t,onClose:a,onConfirm:s,tags:r})=>{const{form:o}=Object(Rk.k)({defaultValue:Vk,schema:$k}),[{overwrite:l}]=Object(Rk.m)({form:o,watch:["overwrite"]}),c=Object(n.useMemo)((()=>Object(Ga.a)(r)),[r]),{tagsLabel:u,tagsHelpText:d,formTitle:p}=(e=>e===dl.b.add_tags?{tagsLabel:il.H,tagsHelpText:il.G,formTitle:il.J}:{tagsLabel:il.Q,tagsHelpText:il.P,formTitle:il.R})(e);return i.a.createElement(_k,{form:o,onClose:a,onSubmit:async()=>{const{data:t,isValid:a}=await o.submit();if(!a)return;const n={value:t.tags,type:t.overwrite?dl.b.set_tags:e};s(n)},title:p},i.a.createElement(Hk,{path:"tags",config:{...$k.tags,label:u,helpText:d},componentProps:{idAria:"bulkEditRulesTags","data-test-subj":"bulkEditRulesTags",euiFieldProps:{fullWidth:!0,placeholder:"",noSuggestions:!1,options:c.map((e=>({label:e})))}}}),e===dl.b.add_tags?i.a.createElement(Hk,{path:"overwrite",componentProps:{idAria:"bulkEditRulesOverwriteTags","data-test-subj":"bulkEditRulesOverwriteTags"}}):null,l&&i.a.createElement(B.EuiFormRow,null,i.a.createElement(B.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesTagsWarning"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.setTagsWarningCallout",defaultMessage:"You’re about to overwrite tags for {rulesCount, plural, one {# selected rule} other {# selected rules}}, press Save to apply changes.",values:{rulesCount:t}}))))},Qk=i.a.memo(Uk);Qk.displayName="TagsForm";var Wk=a(697);const Gk={FORM_TITLE:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.formTitle",{defaultMessage:"Apply Timeline template"}),TEMPLATE_SELECTOR_LABEL:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorLabel",{defaultMessage:"Apply Timeline template to selected rules"}),TEMPLATE_SELECTOR_HELP_TEXT:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorHelpText",{defaultMessage:"Select which Timeline to apply to selected rules when investigating generated alerts."}),TEMPLATE_SELECTOR_PLACEHOLDER:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorPlaceholder",{defaultMessage:"Search Timeline template"}),TEMPLATE_SELECTOR_DEFAULT_VALUE:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorDefaultValue",{defaultMessage:"None"}),warningCalloutMessage:e=>i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.warningCalloutMessage",defaultMessage:"You're about to apply changes to {rulesCount, plural, one {# selected rule} other {# selected rules}}. If you previously applied Timeline templates to these rules, they will be overwritten or (if you select 'None') reset to none.",values:{rulesCount:e}})},Kk={FORM_TITLE:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.formTitle",{defaultMessage:"Add rule actions"}),OVERWRITE_LABEL:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.overwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules actions"}),THROTTLE_LABEL:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.throttleLabel",{defaultMessage:"Actions frequency"}),THROTTLE_HELP_TEXT:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.throttleHelpText",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true."}),RULE_VARIABLES_DETAIL:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.ruleVariablesDetail",{defaultMessage:"Rule variables may affect only some of the rules you select, based on the rule types (for example, \\u007b\\u007bcontext.rule.threshold\\u007d\\u007d will only display values for threshold rules)."})},Jk={FORM_TITLE:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.formTitle",{defaultMessage:"Update rule schedules"}),INTERVAL_LABEL:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.intervalLabel",{defaultMessage:"Runs every"}),INTERVAL_HELP_TEXT:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.intervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."}),LOOKBACK_LABEL:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.lookbackLabel",{defaultMessage:"Additional look-back time"}),LOOKBACK_HELP_TEXT:N.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.lookbackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."}),warningCalloutMessage:e=>i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.warningCalloutMessage",defaultMessage:"You're about to apply changes to {rulesCount, plural, one {# selected rule} other {# selected rules}}. The changes you make will overwrite the existing rule schedules and additional look-back time (if any).",values:{rulesCount:e}})},Yk={timeline:{label:Gk.TEMPLATE_SELECTOR_LABEL,helpText:Gk.TEMPLATE_SELECTOR_HELP_TEXT}},Xk={timeline:{id:null,title:Gk.TEMPLATE_SELECTOR_DEFAULT_VALUE}},Zk=e=>{const{rulesCount:t,onClose:a,onConfirm:s}=e,{form:r}=Object(Rk.k)({schema:Yk,defaultValue:Xk}),o=Object(n.useCallback)((async()=>{const{data:e,isValid:t}=await r.submit();if(!t)return;const a=e.timeline.id||"",n=a?e.timeline.title:"";s({type:dl.b.set_timeline,value:{timeline_id:a,timeline_title:n}})}),[r,s]),l=i.a.createElement(B.EuiCallOut,{color:"warning","data-test-subj":"bulkEditRulesTimelineTemplateWarning"},Gk.warningCalloutMessage(t));return i.a.createElement(_k,{form:r,title:Gk.FORM_TITLE,banner:l,onClose:a,onSubmit:o},i.a.createElement(Rk.e,{path:"timeline",component:Wk.a,componentProps:{idAria:"bulkEditRulesTimelineTemplateSelector",dataTestSubj:"bulkEditRulesTimelineTemplateSelector",placeholder:Gk.TEMPLATE_SELECTOR_PLACEHOLDER}}))},eS=i.a.memo(Zk);eS.displayName="TimelineTemplateForm";var tS=a(523),aS=a(696),nS=a(685);const iS=Object(Rk.j)({component:Rk.b}),sS={throttle:r.Wb,actions:[],overwrite:!1},rS=({rulesCount:e,onClose:t,onConfirm:a})=>{const{services:{triggersActionsUi:{actionTypeRegistry:s}}}=Object(u.k)(),r=Object(n.useMemo)((()=>(e=>({throttle:{label:Kk.THROTTLE_LABEL,helpText:Kk.THROTTLE_HELP_TEXT},actions:{validations:[{validator:Object(nS.a)(e)}]},overwrite:{type:Rk.a.CHECKBOX,label:Kk.OVERWRITE_LABEL}}))(s)),[s]),{form:o}=Object(Rk.k)({schema:r,defaultValue:sS}),[{overwrite:l}]=Object(Rk.m)({form:o,watch:["overwrite","throttle"]}),c=Object(n.useCallback)((async()=>{const{data:e,isValid:t}=await o.submit();if(!t)return;const{actions:n=[],throttle:i,overwrite:s}=e,r=s?dl.b.set_rule_actions:dl.b.add_rule_actions;a({type:r,value:{actions:n.map((({actionTypeId:e,...t})=>t)),throttle:i}})}),[o,a]),d=Object(n.useMemo)((()=>({idAria:"bulkEditRulesRuleActionThrottle","data-test-subj":"bulkEditRulesRuleActionThrottle",hasNoInitialSelection:!1,euiFieldProps:{options:tS.b}})),[]),p=Object(n.useMemo)((()=>Object(uk.d)()),[]);return i.a.createElement(_k,{form:o,title:Kk.FORM_TITLE,onClose:t,onSubmit:c,flyoutSize:"l"},i.a.createElement(B.EuiCallOut,{color:"primary","data-test-subj":"bulkEditRulesRuleActionInfo",title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.infoCalloutTitle",defaultMessage:"Configure actions for {rulesCount, plural, one {# rule} other {# rules}} you’ve selected",values:{rulesCount:e}})},i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.actionFrequencyDetail",defaultMessage:"The actions frequency you select below is applied to all actions (both new and existing) for all selected rules."})),i.a.createElement("li",null,Kk.RULE_VARIABLES_DETAIL))),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(Rk.e,{path:"throttle",component:tS.d,componentProps:d}),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(Rk.e,{path:"actions",component:aS.a,componentProps:{messageVariables:p}}),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(iS,{path:"overwrite",componentProps:{idAria:"bulkEditRulesOverwriteRuleActions","data-test-subj":"bulkEditRulesOverwriteRuleActions"}}),l&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiCallOut,{color:"warning","data-test-subj":"bulkEditRulesRuleActionsWarning"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.warningCalloutMessage",defaultMessage:"You're about to overwrite rule actions for {rulesCount, plural, one {# selected rule} other {# selected rules}}. Click {saveButton} to apply changes.",values:{rulesCount:e,saveButton:i.a.createElement("strong",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.warningCalloutMessage.buttonLabel",defaultMessage:"Save"}))}}))))},oS=i.a.memo(rS);oS.displayName="RuleActionsForm";var lS=a(0),cS=a(16),uS=a(330),dS=a(310),pS=a(219),mS=a(255),gS=a(456);const fS=(e,t,a)=>lS.intersection([lS.partial(e),lS.partial(t),lS.partial(a)]),bS=(e,t,a)=>{const n=Object.keys(t).reduce(((e,a)=>(e[a]=lS.union([t[a],lS[void 0]]),e)),{});return lS.intersection([lS.exact(lS.type(e)),lS.exact(lS.type(n)),lS.exact(lS.type(a))])},hS=e=>{return{create:(t=e.required,a=e.optional,n=e.defaultable,lS.intersection([lS.exact(lS.type(t)),lS.exact(lS.partial(a)),lS.exact(lS.partial(n))])),patch:fS(e.required,e.optional,e.defaultable),response:bS(e.required,e.optional,e.defaultable)};var t,a,n},yS={required:{name:uS.C,description:uS.p,risk_score:dS.m,severity:dS.o},optional:{building_block_type:uS.l,note:uS.F,license:uS.A,outcome:uS.G,alias_target_id:uS.i,alias_purpose:uS.h,output_index:uS.H,timeline_id:uS.R,timeline_title:uS.S,meta:uS.B,rule_name_override:uS.M,timestamp_override:uS.U,timestamp_override_fallback_disabled:uS.V,namespace:uS.D},defaultable:{tags:uS.O,interval:uS.z,enabled:uS.q,throttle:dS.y,actions:dS.g,author:uS.k,false_positives:uS.s,from:dS.i,max_signals:dS.l,risk_score_mapping:dS.n,severity_mapping:dS.p,threat:dS.x,to:uS.W,references:uS.K,version:cS.y,exceptions_list:pS.w}},{create:ES,patch:vS,response:kS}=hS(yS),SS=lS.intersection([ES,lS.exact(lS.partial({rule_id:uS.L}))]),TS=lS.intersection([ES,lS.exact(lS.partial({rule_id:uS.L})),lS.exact(lS.partial({id:uS.w}))]),xS=lS.intersection([vS,lS.exact(lS.partial({rule_id:uS.L,id:uS.w}))]),wS={required:{type:lS.literal("eql"),language:lS.literal("eql"),query:uS.I},optional:{index:uS.y,data_view_id:uS.o,filters:uS.u,timestamp_field:uS.T,event_category_override:uS.r,tiebreaker_field:uS.Q},defaultable:{}},{create:OS,patch:jS,response:IS}=hS(wS),CS={required:{type:lS.literal("threat_match"),query:uS.I,threat_query:dS.w,threat_mapping:dS.v,threat_index:dS.s},optional:{index:uS.y,data_view_id:uS.o,filters:uS.u,saved_id:uS.N,threat_filters:dS.r,threat_indicator_path:dS.t,threat_language:lS.keyof({kuery:null,lucene:null}),concurrent_searches:dS.h,items_per_search:dS.j},defaultable:{language:lS.keyof({kuery:null,lucene:null})}},{create:MS,patch:DS,response:AS}=hS(CS),FS={required:{type:lS.literal("query")},optional:{index:uS.y,data_view_id:uS.o,filters:uS.u,saved_id:uS.N,response_actions:gS.b},defaultable:{query:uS.I,language:lS.keyof({kuery:null,lucene:null})}},{create:RS,patch:PS,response:_S}=hS(FS),qS={required:{type:lS.literal("saved_query"),saved_id:uS.N},optional:{index:uS.y,data_view_id:uS.o,query:uS.I,filters:uS.u,response_actions:gS.b},defaultable:{language:lS.keyof({kuery:null,lucene:null})}},{create:NS,patch:LS,response:BS}=hS(qS),zS={required:{type:lS.literal("threshold"),query:uS.I,threshold:uS.P},optional:{index:uS.y,data_view_id:uS.o,filters:uS.u,saved_id:uS.N},defaultable:{language:lS.keyof({kuery:null,lucene:null})}},{create:HS,patch:$S,response:VS}=hS(zS),US={required:{type:lS.literal("machine_learning"),anomaly_threshold:uS.j,machine_learning_job_id:dS.k},optional:{},defaultable:{}},{create:QS,patch:WS,response:GS}=hS(US),KS={required:{type:lS.literal("new_terms"),query:uS.I,new_terms_fields:uS.E,history_window_start:uS.v},optional:{index:uS.y,data_view_id:uS.o,filters:uS.u},defaultable:{language:lS.keyof({kuery:null,lucene:null})}},{create:JS,patch:YS,response:XS}=hS(KS),ZS=lS.union([OS,MS,RS,NS,HS,QS,JS]),eT=lS.intersection([SS,ZS]),tT=(lS.intersection([SS,ZS,lS.type({invocationCount:lS.number,timeframeEnd:lS.string})]),lS.union([jS,DS,PS,LS,$S,WS,YS])),aT=lS.union([IS,AS,_S,BS,VS,GS,XS]),nT=lS.intersection([ZS,TS]),iT={id:uS.w,rule_id:uS.L,immutable:uS.x,updated_at:uS.X,updated_by:uS.Y,created_at:uS.m,created_by:uS.n,related_integrations:uS.c,required_fields:uS.d,setup:uS.e},sT={execution_summary:mS.g},rT=lS.intersection([kS,lS.exact(lS.type(iT)),lS.exact(lS.partial(sT))]);lS.intersection([rT,aT]),lS.intersection([ES,ZS,lS.exact(lS.type({rule_id:uS.L,version:cS.y})),lS.exact(lS.partial({related_integrations:uS.c,required_fields:uS.d,setup:uS.e}))]),lS.array(eT),lS.exact(lS.type({items:lS.array(pS.h)}));var oT=a(48);const lT=lS.array(lS.exact(lS.type({rule_id:oT.H}))),cT=(lS.union([lS.exact(lS.type({objects:lT})),lS.null]),lS.exact(lS.partial({file_name:dS.a,exclude_export_details:cS.d})),lS.exact(lS.partial({fields:uS.t,filter:uS.J,sort_field:uS.f,sort_order:uS.g,page:dS.b,per_page:dS.c})),lS.intersection([ES,ZS,lS.exact(lS.type({rule_id:uS.L})),lS.exact(lS.partial({id:uS.w,immutable:cS.m,updated_at:uS.X,updated_by:uS.Y,created_at:uS.m,created_by:uS.n,related_integrations:uS.c,required_fields:uS.d,setup:uS.e}))]),lS.exact(lS.type({file:lS.object})),lS.intersection([tT,xS]));lS.intersection([$S,xS]),lS.array(cT),lS.exact(lS.type({id:oT.q})),lS.exact(lS.partial({rule_id:oT.H,id:oT.q})),lS.exact(lS.partial({query:lS.object,aggs:lS.object,size:cS.n,track_total_hits:lS.boolean,_source:lS.union([lS.boolean,lS.string,lS.array(lS.string)]),fields:lS.array(lS.string),runtime_mappings:lS.unknown,sort:lS.object})),lS.intersection([lS.type({status:oT.M}),lS.partial({conflicts:oT.f,signal_ids:oT.K,query:oT.L})]),lS.array(nT);var uT=a(535);const dT={interval:{label:Jk.INTERVAL_LABEL,helpText:Jk.INTERVAL_HELP_TEXT},lookback:{label:Jk.LOOKBACK_LABEL,helpText:Jk.LOOKBACK_HELP_TEXT}},pT={interval:"5m",lookback:"1m"},mT=({rulesCount:e,onClose:t,onConfirm:a})=>{const{form:s}=Object(Rk.k)({schema:dT,defaultValue:pT}),r=Object(n.useCallback)((async()=>{const{data:e,isValid:t}=await s.submit();t&&a({type:dl.b.set_schedule,value:{interval:e.interval,lookback:e.lookback}})}),[s,a]),o=i.a.createElement(B.EuiCallOut,{color:"warning","data-test-subj":"bulkEditRulesSchedulesWarning"},Jk.warningCalloutMessage(e));return i.a.createElement(_k,{form:s,title:Jk.FORM_TITLE,banner:o,onClose:t,onSubmit:r},i.a.createElement(Rk.e,{path:"interval",component:uT.a,componentProps:{idAria:"bulkEditRulesScheduleIntervalSelector",dataTestSubj:"bulkEditRulesScheduleIntervalSelector",fullWidth:!0,minimumValue:1}}),i.a.createElement(Rk.e,{path:"lookback",component:uT.a,componentProps:{idAria:"bulkEditRulesScheduleLookbackSelector",dataTestSubj:"bulkEditRulesScheduleLookbackSelector",fullWidth:!0,minimumValue:1}}))},gT=({editAction:e,tags:t,...a})=>{switch(e){case dl.b.add_index_patterns:case dl.b.delete_index_patterns:case dl.b.set_index_patterns:return i.a.createElement(zk,yn()({},a,{editAction:e}));case dl.b.add_tags:case dl.b.delete_tags:case dl.b.set_tags:return i.a.createElement(Qk,yn()({},a,{editAction:e,tags:t}));case dl.b.set_timeline:return i.a.createElement(eS,a);case dl.b.add_rule_actions:case dl.b.set_rule_actions:return i.a.createElement(oS,a);case dl.b.set_schedule:return i.a.createElement(mT,a);default:return null}},fT=i.a.memo(gT);fT.displayName="BulkEditFlyout";var bT=a(744);const hT=({dryRunResult:e,...t})=>{if("selectedRuleIds"in t){const a=new Set(null==e?void 0:e.ruleErrors.flatMap((({ruleIds:e})=>e)));return{ids:t.selectedRuleIds.filter((e=>!a.has(e)))}}let a={...t.filterOptions};return null==e||e.ruleErrors.forEach((({errorCode:e})=>{var t;switch(e){case r.D.IMMUTABLE:a={...a,showCustomRules:!0};break;case r.D.MACHINE_LEARNING_INDEX_PATTERN:case r.D.MACHINE_LEARNING_AUTH:a={...a,excludeRuleTypes:[...null!==(t=a.excludeRuleTypes)&&void 0!==t?t:[],"machine_learning"]}}})),{query:Object(bT.a)(a)}},yT=i.a.createElement(B.EuiEmptyPrompt,{title:i.a.createElement("h3",null,il.Rb),titleSize:"xs",body:il.Sb}),ET=i.a.memo((({createPrePackagedRules:e,hasPermissions:t,loadingCreatePrePackagedRules:a,rulesCustomInstalled:s,rulesInstalled:o,rulesNotInstalled:l,rulesNotUpdated:c,selectedTab:d})=>{var p;const{startTransaction:m}=Object(bl.a)(),g=Object(n.useRef)(null),f=Object(nl.b)(),{state:{rules:b,filterOptions:h,isActionInProgress:E,isAllSelected:v,isFetched:k,isLoading:S,isRefetching:T,isRefreshOn:x,loadingRuleIds:w,loadingRulesAction:O,pagination:j,selectedRuleIds:I,sortingOptions:C},actions:{reFetchRules:M,setIsAllSelected:D,setIsRefreshOn:A,setPage:F,setPerPage:R,setSelectedRuleIds:P,setSortingOptions:q}}=f,N=Object(uk.e)(o,l,c),[,L,z]=(()=>{const[e,t]=Object(n.useState)([]),[a,i]=Object(n.useState)(!0),s=Object(n.useRef)(y.noop),{addError:r}=Object(ma.a)();return Object(n.useEffect)((()=>{let e=!0;const a=new AbortController,n=async()=>{i(!0);try{const n=await Object(za.f)({signal:a.signal});e&&t(n)}catch(t){e&&r(t,{title:ck.l})}e&&i(!1)};return n(),s.current=n,()=>{e=!1,a.abort()}}),[r]),[a,e,s.current]})();Object(n.useEffect)((()=>{z()}),[s,o]);const[H,$,V]=Object(Kv.a)(),[U,Q,W]=dk({onInit:$,onFinish:V}),{bulkActionsDryRunResult:G,bulkAction:K,isBulkActionConfirmationVisible:J,showBulkActionConfirmation:Y,cancelBulkActionConfirmation:X,approveBulkActionConfirmation:Z}=(()=>{const[e,t]=Object(n.useState)(),[a,i]=Object(n.useState)(),[s,r,o]=Object(Kv.a)(),[l,c,u]=dk({onInit:r,onFinish:o});return{bulkActionsDryRunResult:a,bulkAction:e,isBulkActionConfirmationVisible:s,showBulkActionConfirmation:Object(n.useCallback)((async(e,a)=>{var n;if(t(a),i(e),!((null!==(n=null==e?void 0:e.failedRulesCount)&&void 0!==n?n:0)>0))return!0;const s=await l();return s&&c(),s}),[l,c]),cancelBulkActionConfirmation:u,approveBulkActionConfirmation:c}})(),{bulkEditActionType:ee,isBulkEditFlyoutVisible:te,handleBulkEditFormConfirm:ae,handleBulkEditFormCancel:ne,completeBulkEditForm:ie}=(()=>{const e=Object(n.useRef)(null),[t,a]=Object(n.useState)(),[i,s,r]=Object(Kv.a)(),[o,l,c]=dk({onInit:s,onFinish:r}),u=Object(n.useCallback)((async t=>(a(t),!0===await o()?e.current:null)),[o]);return{bulkEditActionType:t,isBulkEditFlyoutVisible:i,handleBulkEditFormConfirm:Object(n.useCallback)((t=>{e.current=t,l()}),[l]),handleBulkEditFormCancel:c,completeBulkEditForm:u}})(),re=v?j.total:I.length,{isBulkActionsDryRunLoading:oe,executeBulkActionsDryRun:le}=(()=>{const{data:e,mutateAsync:t,isLoading:a}=Object(Tk.useMutation)(["bulkActionsDryRun"],(async({searchParams:e,action:t,editAction:a})=>{if(!t)return;let n;try{n=await Object(Vv.b)({...e,action:t,edit:wk(t,a),isDryRun:!0})}catch(e){var i,s,r;if(void 0===(null===(i=e.body)||void 0===i||null===(s=i.attributes)||void 0===s||null===(r=s.summary)||void 0===r?void 0:r.total))return;n=e.body}return{succeededRulesCount:null==(o=n)?void 0:o.attributes.summary.succeeded,failedRulesCount:null==o?void 0:o.attributes.summary.failed,ruleErrors:null!==(l=null==o||null===(c=o.attributes.errors)||void 0===c?void 0:c.map((({message:e,err_code:t,rules:a})=>({message:e,errorCode:t,ruleIds:a.map((({id:e})=>e))}))))&&void 0!==l?l:[]};var o,l,c}));return{bulkActionsDryRunResult:e,isBulkActionsDryRunLoading:a,executeBulkActionsDryRun:t}})(),ce=(({filterOptions:e,confirmDeletion:t,showBulkActionConfirmation:a,completeBulkEditForm:s,reFetchTags:o,executeBulkActionsDryRun:l})=>{const c=ul(),u=Object(nl.b)(),d=Object(hl.b)(),p=Object(hl.c)(),m=Object(yl.a)(),g=ol(),f=Object(ma.a)(),b=Object(Th.b)(),h=Object(bT.a)(e),{startTransaction:y}=Object(bl.a)(),E=Object(n.useCallback)((async e=>[dl.b.add_tags,dl.b.set_tags,dl.b.delete_tags].includes(e)?o():null),[o]),{state:{isAllSelected:v,rules:k,loadingRuleIds:S,selectedRuleIds:T},actions:{setLoadingRules:x,clearRulesSelection:w}}=u;return Object(n.useCallback)((n=>{const o=k.filter((({id:e})=>T.includes(e))),u=o.some((({enabled:e})=>e)),O=o.some((({enabled:e})=>!e)),j=T.some((e=>S.includes(e))),I=o.some((({immutable:e})=>e)),C=!g&&o.some((e=>!Object(pa.a)(e,g))),M=t=>async()=>{var r,o,c;let u,d=!1;n();const m=await l({action:dl.a.edit,editAction:t,searchParams:v?{query:Object(bT.a)(e)}:{ids:T}});if(!1===await a(m,dl.a.edit))return;const g=await s(t);if(null==g)return;y({name:ml.b.EDIT});const h=()=>{u&&f.api.remove(u)};setTimeout((()=>{var e;d||(u=f.addWarning({title:il.W,text:Object(_.toMountPoint)(i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,il.U(null!==(e=null==m?void 0:m.succeededRulesCount)&&void 0!==e?e:0)),i.a.createElement(B.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{color:"warning",size:"s",onClick:h},il.V))))),iconType:void 0},{toastLifeTimeMs:6e5}))}),5e3);const k=await Object(pl.c)({visibleRuleIds:T,action:dl.a.edit,setLoadingRules:x,toasts:f,payload:{edit:[g]},onFinish:()=>h(),search:hT({...v?{filterOptions:e}:{selectedRuleIds:T},dryRunResult:m})});d=!0,p(null!==(r=null==k||null===(o=k.attributes)||void 0===o||null===(c=o.results)||void 0===c?void 0:c.updated)&&void 0!==r?r:[]),b()&&await E(t)},D=j||0===T.length,A=C||j||0===T.length;return[{id:0,title:il.v,items:[{key:il.s,name:il.s,"data-test-subj":"enableRuleBulk",disabled:C||j||!O&&!v,onClick:async()=>{var e,t,a;y({name:ml.b.ENABLE}),n();const i=o.filter((({enabled:e})=>!e)),s=i.filter((({type:e})=>!Object(el.d)(e))),r=i.length-s.length;!c&&r>0&&f.addWarning(se.g(r));const l=c?i.map((({id:e})=>e)):s.map((({id:e})=>e)),u=await Object(pl.c)({visibleRuleIds:l,action:dl.a.enable,setLoadingRules:x,toasts:f,search:v?{query:h}:{ids:l}});p(null!==(e=null==u||null===(t=u.attributes)||void 0===t||null===(a=t.results)||void 0===a?void 0:a.updated)&&void 0!==e?e:[])},toolTipContent:C?il.Ob:void 0,toolTipPosition:"right",icon:void 0},{key:il.r,name:il.r,"data-test-subj":"duplicateRuleBulk",disabled:A,onClick:async()=>{y({name:ml.b.DUPLICATE}),n(),await Object(pl.c)({visibleRuleIds:T,action:dl.a.duplicate,setLoadingRules:x,toasts:f,search:v?{query:h}:{ids:T}}),d(),m(),w()},toolTipContent:C?il.Ob:void 0,toolTipPosition:"right",icon:void 0},{key:il.u,name:il.u,"data-test-subj":"indexPatternsBulkEditRule",disabled:A,panel:2},{key:il.x,name:il.x,"data-test-subj":"tagsBulkEditRule",disabled:A,panel:1},{key:il.i,name:il.i,"data-test-subj":"addRuleActionsBulk",disabled:!g||A,onClick:M(dl.b.add_rule_actions),toolTipContent:g?void 0:il.Ob,toolTipPosition:"right",icon:void 0},{key:il.w,name:il.w,"data-test-subj":"setScheduleBulk",disabled:A,onClick:M(dl.b.set_schedule),toolTipContent:C?il.Ob:void 0,toolTipPosition:"right",icon:void 0},{key:il.k,name:il.k,"data-test-subj":"applyTimelineTemplateBulk",disabled:A,onClick:M(dl.b.set_timeline),toolTipContent:C?il.Ob:void 0,toolTipPosition:"right",icon:void 0},{key:il.t,name:il.t,"data-test-subj":"exportRuleBulk",disabled:j||0===T.length,onClick:async()=>{n(),y({name:ml.b.EXPORT});const e=await Object(pl.c)({visibleRuleIds:T,action:dl.a.export,setLoadingRules:x,toasts:f,search:v?{query:h}:{ids:T}});if(!e)return;const t=await Object(Ga.c)(e),i=await a((e=>({succeededRulesCount:e.exported_rules_count,failedRulesCount:e.missing_rules_count,ruleErrors:e.missing_rules.length?[{errorCode:r.D.IMMUTABLE,message:"Prebuilt rules can't be exported.",ruleIds:e.missing_rules.map((({rule_id:e})=>e))}]:[]}))(t),dl.a.export);!1!==i&&await Object(pl.b)({response:e,toasts:f})},icon:void 0},{key:il.q,name:il.q,"data-test-subj":"disableRuleBulk",disabled:C||j||!u&&!v,onClick:async()=>{var e,t,a;y({name:ml.b.DISABLE}),n();const i=o.filter((({enabled:e})=>e)).map((({id:e})=>e)),s=await Object(pl.c)({visibleRuleIds:i,action:dl.a.disable,setLoadingRules:x,toasts:f,search:v?{query:h}:{ids:i}});p(null!==(e=null==s||null===(t=s.attributes)||void 0===t||null===(a=t.results)||void 0===a?void 0:a.updated)&&void 0!==e?e:[])},toolTipContent:C?il.Ob:void 0,toolTipPosition:"right",icon:void 0},{key:il.n,name:i.a.createElement(B.EuiTextColor,{color:D?Co.euiThemeVars.euiButtonColorDisabledText:"danger"},il.n),"data-test-subj":"deleteRuleBulk",disabled:D,onClick:async()=>{n(),v&&!1===await t()||(y({name:ml.b.DELETE}),await Object(pl.c)({visibleRuleIds:T,action:dl.a.delete,setLoadingRules:x,toasts:f,search:v?{query:h}:{ids:T}}),d(),m())},toolTipContent:I?il.g:void 0,toolTipPosition:"right",icon:void 0}]},{id:1,title:il.v,items:[{key:il.j,name:il.j,"data-test-subj":"addTagsBulkEditRule",onClick:M(dl.b.add_tags),disabled:A,toolTipContent:C?il.Ob:void 0,toolTipPosition:"right"},{key:il.p,name:il.p,"data-test-subj":"deleteTagsBulkEditRule",onClick:M(dl.b.delete_tags),disabled:A,toolTipContent:C?il.Ob:void 0,toolTipPosition:"right"}]},{id:2,title:il.v,items:[{key:il.h,name:il.h,"data-test-subj":"addIndexPatternsBulkEditRule",onClick:M(dl.b.add_index_patterns),disabled:A,toolTipContent:C?il.Ob:void 0,toolTipPosition:"right"},{key:il.o,name:il.o,"data-test-subj":"deleteIndexPatternsBulkEditRule",onClick:M(dl.b.delete_index_patterns),disabled:A,toolTipContent:C?il.Ob:void 0,toolTipPosition:"right"}]}]}),[k,T,g,v,S,y,c,x,f,h,p,d,m,w,t,a,l,e,s,b,E])})({filterOptions:h,confirmDeletion:U,showBulkActionConfirmation:Y,completeBulkEditForm:ie,reFetchTags:z,executeBulkActionsDryRun:le}),ue=Object(n.useMemo)((()=>({pageIndex:j.page-1,pageSize:j.perPage,totalItemCount:j.total,pageSizeOptions:r.nc})),[j]),de=Object(n.useCallback)((({page:e,sort:t})=>{var a,n;q({field:null!==(a=null==t?void 0:t.field)&&void 0!==a?a:"enabled",order:null!==(n=null==t?void 0:t.direction)&&void 0!==n?n:"desc"}),F(e.index+1),R(e.size)}),[F,R,q]),pe=(({hasCRUDPermissions:e})=>{const t=wl(),a=vl({hasCRUDPermissions:e}),s=Sl(),{isInMemorySorting:o}=Object(nl.b)().state,[l]=Object(u.q)(r.sc);return Object(n.useMemo)((()=>[s,...l?[xl]:[],Tl,{field:"risk_score",name:il.kb,render:e=>i.a.createElement(B.EuiText,{"data-test-subj":"riskScore",size:"s"},e),sortable:!0,truncateText:!0,width:"85px"},{field:"severity",name:il.mb,render:e=>i.a.createElement(al.a,{value:e}),sortable:!0,truncateText:!0,width:"12%"},{field:"execution_summary.last_execution.date",name:il.fb,render:e=>null==e?Object(ri.d)():i.a.createElement(Ba.b,{tooltipFieldName:il.fb,relativeThresholdInHrs:r.ab,value:e,tooltipAnchorClassName:"eui-textTruncate"}),sortable:!!o,truncateText:!0,width:"16%"},{field:"execution_summary.last_execution.status",name:il.gb,render:e=>i.a.createElement(fl.b,{status:e}),sortable:!!o,truncateText:!0,width:"16%"},{field:"updated_at",name:il.hb,render:e=>null==e?Object(ri.d)():i.a.createElement(Ba.b,{tooltipFieldName:il.hb,relativeThresholdInHrs:r.ab,value:e,tooltipAnchorClassName:"eui-textTruncate"}),sortable:!0,width:"18%",truncateText:!0},{field:"version",name:il.ob,render:e=>null==e?Object(ri.d)():i.a.createElement(B.EuiText,{"data-test-subj":"version",size:"s"},e),sortable:!!o,truncateText:!0,width:"65px"},a,...e?[t]:[]]),[t,a,e,o,s,l])})({hasCRUDPermissions:t}),me=(({hasCRUDPermissions:e})=>{const t=Object(u.k)().services.docLinks,a=wl(),s=vl({hasCRUDPermissions:e}),o=Sl(),{isInMemorySorting:l}=Object(nl.b)().state,[c]=Object(u.q)(r.sc);return Object(n.useMemo)((()=>[{...o,width:"28%"},...c?[xl]:[],Tl,{field:"execution_summary.last_execution.metrics.total_indexing_duration_ms",name:i.a.createElement(rl.a,{title:il.db,tooltipContent:il.eb}),render:e=>i.a.createElement(B.EuiText,{"data-test-subj":"total_indexing_duration_ms",size:"s"},null!=e?e.toFixed():Object(ri.d)()),sortable:!!l,truncateText:!0,width:"16%"},{field:"execution_summary.last_execution.metrics.total_search_duration_ms",name:i.a.createElement(rl.a,{title:il.ib,tooltipContent:il.jb}),render:e=>i.a.createElement(B.EuiText,{"data-test-subj":"total_search_duration_ms",size:"s"},null!=e?e.toFixed():Object(ri.d)()),sortable:!!l,truncateText:!0,width:"14%"},{field:"execution_summary.last_execution.metrics.execution_gap_duration_s",name:i.a.createElement(rl.a,{title:il.bb,customTooltip:i.a.createElement("div",{style:{maxWidth:"20px"}},i.a.createElement(sl.a,{columnName:il.bb},i.a.createElement(B.EuiText,{style:{width:300}},i.a.createElement("p",null,i.a.createElement(Hs.FormattedMessage,{defaultMessage:"Duration of most recent gap in Rule execution. Adjust Rule look-back or {seeDocs} for mitigating gaps.",id:"xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltip",values:{seeDocs:i.a.createElement(B.EuiLink,{href:`${t.links.siem.troubleshootGaps}`,target:"_blank"},il.cb)}})))))}),render:e=>i.a.createElement(B.EuiText,{"data-test-subj":"gap",size:"s"},null!=e?$o.a.duration(e,"seconds").humanize():Object(ri.d)()),sortable:!!l,truncateText:!0,width:"14%"},{field:"execution_summary.last_execution.status",name:il.gb,render:e=>i.a.createElement(fl.b,{status:e}),sortable:!!l,truncateText:!0,width:"12%"},{field:"execution_summary.last_execution.date",name:il.fb,render:e=>null==e?Object(ri.d)():i.a.createElement(Ba.b,{tooltipFieldName:il.fb,relativeThresholdInHrs:r.ab,value:e,tooltipAnchorClassName:"eui-textTruncate"}),sortable:!!l,truncateText:!0,width:"16%"},s,...e?[a]:[]]),[a,t.links.siem.troubleshootGaps,s,e,l,o,c])})({hasCRUDPermissions:t}),ge=Object(n.useCallback)((async()=>{null!=e&&(m({name:ml.d.LOAD_PREBUILT}),await e(),await M())}),[e,M,m]),fe=Object(n.useCallback)((()=>{m({name:ml.d.REFRESH}),M()}),[M,m]),be=Object(n.useRef)(!1);((e,t)=>{const a=Object(n.useRef)(t);Object(n.useEffect)((()=>{JSON.stringify(a.current)!==JSON.stringify(t)&&(a.current=t,e(t))}),[e,t])})((e=>{null!=g.current&&g.current.setSelection(b.filter((t=>e.includes(t.id))))}),I);const he=Object(n.useMemo)((()=>({selectable:e=>!w.includes(e.id),onSelectionChange:e=>{be.current?(be.current=!1,0===e.length&&(D(!1),P([]))):(P(e.map((({id:e})=>e))),D(!1))}})),[w,D,P]),ye=Object(n.useCallback)((()=>{be.current=!0,D(!v),P(v?[]:b.map((({id:e})=>e)))}),[b,v,D,P]),Ee=Object(n.useCallback)((e=>{e&&M(),A(e)}),[A,M]),ve=Object(n.useMemo)((()=>Object(Ga.e)({rulesCustomInstalled:s,rulesInstalled:o})&&!S),[S,s,o]),ke=Object(n.useMemo)((()=>null!=s&&0===s&&"ruleNotInstalled"===N&&!S),[S,N,s]),Se=d===Qv.rules?{"data-test-subj":"rules-table",columns:pe}:{"data-test-subj":"monitoring-table",columns:me},Te=k&&T,xe=!k&&T||E;return i.a.createElement(i.a.Fragment,null,Te&&i.a.createElement(B.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),xe&&i.a.createElement(ba.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),ve&&i.a.createElement(kk,{rulesCustomInstalled:s,rulesInstalled:o,allTags:L}),ke&&i.a.createElement(lk,{createPrePackagedRules:ge,loading:a,userHasPermissions:t}),S&&i.a.createElement(B.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}),H&&i.a.createElement(B.EuiConfirmModal,{title:il.xb,onCancel:W,onConfirm:Q,confirmButtonText:il.wb,cancelButtonText:il.vb,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"allRulesDeleteConfirmationModal"},i.a.createElement("p",null,il.ub)),J&&K&&i.a.createElement(Fk,{bulkAction:K,result:G,onCancel:X,onConfirm:Z}),te&&void 0!==ee&&i.a.createElement(fT,{rulesCount:null!==(p=null==G?void 0:G.succeededRulesCount)&&void 0!==p?p:0,editAction:ee,onClose:ne,onConfirm:ae,tags:L}),ve&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Sk,{canBulkEdit:t,pagination:j,numberSelectedItems:re,onGetBulkItemsPopoverContent:ce,onRefresh:fe,isAutoRefreshOn:x,onRefreshSwitch:Ee,isAllSelected:v,onToggleSelectAll:ye,isBulkActionInProgress:oe||null!=O,hasDisabledActions:null!=O}),i.a.createElement(B.EuiBasicTable,yn()({itemId:"id",items:b,isSelectable:t,noItemsMessage:yT,onChange:de,pagination:ue,ref:g,selection:t?he:void 0,sorting:{sort:{field:C.field,direction:C.order}}},Se))))}));ET.displayName="RulesTables";const vT=i.a.memo((({createPrePackagedRules:e,hasPermissions:t,loadingCreatePrePackagedRules:a,rulesCustomInstalled:s,rulesInstalled:r,rulesNotInstalled:o,rulesNotUpdated:l})=>{const[c,u]=Object(n.useState)(Qv.rules);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Gv,{activeTab:c,onTabChange:u}),i.a.createElement(B.EuiSpacer,null),i.a.createElement(ET,{createPrePackagedRules:e,hasPermissions:t,loadingCreatePrePackagedRules:a,rulesCustomInstalled:s,rulesInstalled:r,rulesNotInstalled:o,rulesNotUpdated:l,selectedTab:c}))}));vT.displayName="AllRules";var kT=a(1006),ST=a(285);const TT=N.i18n.translate("xpack.securitySolution.lists.importValueListTitle",{defaultMessage:"Import value lists"}),xT=N.i18n.translate("xpack.securitySolution.lists.importValueListDescription",{defaultMessage:"Import single value lists to use while writing rule exceptions."}),wT=N.i18n.translate("xpack.securitySolution.lists.uploadValueListPrompt",{defaultMessage:"Select or drag and drop a file"}),OT=N.i18n.translate("xpack.securitySolution.lists.closeValueListsModalTitle",{defaultMessage:"Close"}),jT=N.i18n.translate("xpack.securitySolution.lists.cancelValueListsImportTitle",{defaultMessage:"Cancel import"}),IT=N.i18n.translate("xpack.securitySolution.lists.valueListsImportButton",{defaultMessage:"Import list"}),CT=N.i18n.translate("xpack.securitySolution.lists.valueListsImportSuccessTitle",{defaultMessage:"Value list imported"}),MT=N.i18n.translate("xpack.securitySolution.lists.valueListsUploadError",{defaultMessage:"There was an error uploading the value list."}),DT=N.i18n.translate("xpack.securitySolution.lists.valueListsExportError",{defaultMessage:"There was an error exporting the value list."}),AT=N.i18n.translate("xpack.securitySolution.lists.valueListsTable.fileNameColumn",{defaultMessage:"Filename"}),FT=N.i18n.translate("xpack.securitySolution.lists.valueListsTable.typeColumn",{defaultMessage:"Type"}),RT=N.i18n.translate("xpack.securitySolution.lists.valueListsTable.importDateColumn",{defaultMessage:"Import Date"}),PT=N.i18n.translate("xpack.securitySolution.lists.valueListsTable.createdByColumn",{defaultMessage:"Created by"}),_T=N.i18n.translate("xpack.securitySolution.lists.valueListsTable.actionsColumn",{defaultMessage:"Actions"}),qT=N.i18n.translate("xpack.securitySolution.lists.valueListsTable.exportActionDescription",{defaultMessage:"Export value list"}),NT=N.i18n.translate("xpack.securitySolution.lists.valueListsTable.deleteActionDescription",{defaultMessage:"Remove value list"}),LT=N.i18n.translate("xpack.securitySolution.lists.valueListsTable.title",{defaultMessage:"Value lists"}),BT=N.i18n.translate("xpack.securitySolution.lists.valueListsForm.listTypesRadioLabel",{defaultMessage:"Type of value list"}),zT=N.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRadioLabel",{defaultMessage:"IP addresses"}),HT=N.i18n.translate("xpack.securitySolution.lists.valueListsForm.keywordsRadioLabel",{defaultMessage:"Keywords"}),$T=N.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRangesRadioLabel",{defaultMessage:"IP ranges"}),VT=N.i18n.translate("xpack.securitySolution.lists.valueListsForm.textRadioLabel",{defaultMessage:"Text"}),UT=N.i18n.translate("xpack.securitySolution.lists.referenceModalTitle",{defaultMessage:"Remove value list"}),QT=N.i18n.translate("xpack.securitySolution.lists.referenceModalCancelButton",{defaultMessage:"Cancel"}),WT=N.i18n.translate("xpack.securitySolution.lists.referenceModalDeleteButton",{defaultMessage:"Remove value list"}),GT=[{value:"keyword",text:HT},{value:"ip",text:zT},{value:"ip_range",text:$T},{value:"text",text:VT}],KT="keyword",JT=["text/csv","text/plain"],YT=({onError:e,onSuccess:t})=>{const a=Object(n.useRef)(new AbortController),[s,r]=Object(n.useState)(null),[o,l]=Object(n.useState)(KT),c=Object(n.useRef)(null),{http:d}=Object(u.k)().services,{start:p,...m}=Object(da.j)(),g=!s||JT.some((e=>s.type===e)),f=Object(n.useCallback)((e=>l(e.target.value)),[l]),b=Object(n.useCallback)((e=>{var t;r(null!==(t=null==e?void 0:e.item(0))&&void 0!==t?t:null)}),[]),h=Object(n.useCallback)((()=>{var e;null!==(e=c.current)&&void 0!==e&&e.fileInput&&(c.current.fileInput.value="",c.current.handleChange()),r(null),l(KT)}),[]),y=Object(n.useCallback)((()=>{a.current.abort()}),[]),E=Object(n.useCallback)((e=>{h(),t(e)}),[h,t]),v=Object(n.useCallback)((t=>{e(t)}),[e]),k=Object(n.useCallback)((()=>{!m.loading&&s&&(a.current=new AbortController,p({file:s,listId:void 0,http:d,signal:a.current.signal,type:o}))}),[m.loading,s,p,d,o]);return Object(n.useEffect)((()=>{!m.loading&&m.result?E(m.result):!m.loading&&m.error&&v(m.error)}),[v,E,m.error,m.loading,m.result]),Object(n.useEffect)((()=>y),[y]),i.a.createElement(B.EuiForm,null,i.a.createElement(B.EuiFormRow,{"data-test-subj":"value-list-file-picker-row",label:xT,fullWidth:!0,isInvalid:!g,error:[(S=JT.join(", "),N.i18n.translate("xpack.securitySolution.lists.uploadValueListExtensionValidationMessage",{values:{fileTypes:S},defaultMessage:"File must be one of the following types: [{fileTypes}]"}))]},i.a.createElement(B.EuiFilePicker,{accept:JT.join(),"data-test-subj":"value-list-file-picker",id:"value-list-file-picker",initialPromptText:wT,ref:c,onChange:b,fullWidth:!0,isLoading:m.loading,isInvalid:!g})),i.a.createElement(B.EuiFormRow,{fullWidth:!0},i.a.createElement(B.EuiFlexGroup,null,i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiFormRow,{label:BT},i.a.createElement(B.EuiSelect,{"data-test-subj":"value-lists-form-select-type-action",options:GT,value:o,onChange:f,name:"valueListType"}))),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiFormRow,{hasEmptyLabelSpace:!0},i.a.createElement(B.EuiFlexGroup,{alignItems:"flexEnd"},i.a.createElement(B.EuiFlexItem,null,m.loading&&i.a.createElement(B.EuiButtonEmpty,{onClick:y},jT)),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiButton,{"data-test-subj":"value-lists-form-import-action",onClick:k,disabled:null==s||!g||m.loading},IT))))))));var S};YT.displayName="ValueListsFormComponent";const XT=i.a.memo(YT);XT.displayName="ValueListsForm";const ZT=H()(B.EuiLoadingSpinner).withConfig({displayName:"AlignedSpinner",componentId:"sc-ul6fx2-0"})(["margin:",";vertical-align:middle;"],(({theme:e})=>e.eui.euiSizeXS)),ex={contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""},tx=({onClose:e,showFlyout:t})=>{var a,s,r,o;const[l,c]=Object(n.useState)(0),[d,p]=Object(n.useState)(5),[m,g]=Object(da.e)({pageIndex:l,pageSize:d}),{http:f}=Object(u.k)().services,{start:b,...h}=Object(da.h)(),{start:E,result:v,error:k}=Object(da.f)(),[S,T]=Object(n.useState)([]),[x,w]=Object(n.useState)([]),[O,j]=Object(n.useState)({}),{addError:I,addSuccess:C}=Object(ma.a)(),[M,D]=Object(n.useState)(!1),[A,F]=Object(n.useState)(ex),R=Object(n.useCallback)((()=>{b({cursor:m,http:f,pageIndex:l+1,pageSize:d,sortOrder:"desc",sortField:"created_at"})}),[m,f,b,l,d]),P=Object(n.useCallback)((({deleteReferences:e,id:t})=>{T([...S,t]),E({deleteReferences:e,http:f,id:t})}),[E,S,f]),_=Object(n.useCallback)((async()=>{D(!1),E({deleteReferences:!0,http:f,id:A.valueListId}),F(ex),T([])}),[E,f,A.valueListId]);Object(n.useEffect)((()=>{null!=v&&(T((e=>[...e.filter((e=>e!==v.id))])),R())}),[v,R]),Object(n.useEffect)((()=>{if(!Object(y.isEmpty)(k)){var e,t,a,n,i,s,r,o;const c=null!==(e=null==k||null===(t=k.body)||void 0===t||null===(a=t.message)||void 0===a||null===(n=a.error)||void 0===n||null===(i=n.references)||void 0===i?void 0:i.map((e=>null==e?void 0:e.exception_list.name)))&&void 0!==e?e:[],u=Array.from(new Set(c));D(!0),F({contentText:(l=u.length,N.i18n.translate("xpack.securitySolution.lists.referenceModalDescription",{defaultMessage:"This value list is associated with ({referenceCount}) exception {referenceCount, plural, =1 {list} other {lists}}. Removing this list will remove all exception items that reference this value list.",values:{referenceCount:l}})),exceptionListReferences:u,isLoading:!1,valueListId:null==k||null===(s=k.body)||void 0===s||null===(r=s.message)||void 0===r||null===(o=r.error)||void 0===o?void 0:o.value_list_id})}var l}),[k]);const q=Object(n.useCallback)((async({id:e})=>{try{w((t=>[...t,e]));const t=await Object(ST.i)({http:f,listId:e,signal:(new AbortController).signal});j({name:e,blob:t})}catch(e){I(e,{title:DT})}finally{w((t=>[...t.filter((t=>t!==e))]))}}),[I,f]),L=Object(n.useCallback)((({page:{index:e,size:t}})=>{c(e),p(t)}),[c,p]),z=Object(n.useCallback)((e=>{"AbortError"!==e.name&&I(e,{title:MT})}),[I]),H=Object(n.useCallback)((e=>{var t;C({text:(t=e.name,N.i18n.translate("xpack.securitySolution.lists.valueListsImportSuccess",{defaultMessage:"Value list '{fileName}' was imported",values:{fileName:t}})),title:CT}),R(),c(0)}),[C]);Object(n.useEffect)((()=>{t&&R()}),[t,R]),Object(n.useEffect)((()=>{var e;!h.loading&&null!==(e=h.result)&&void 0!==e&&e.cursor&&g(h.result.cursor)}),[h.loading,h.result,g]);const $=Object(n.useCallback)((()=>{T([]),D(!1),F({contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""})}),[]);if(!t)return null;const V=(null!==(a=null===(s=h.result)||void 0===s?void 0:s.data)&&void 0!==a?a:[]).map((e=>({...e,isDeleting:S.includes(e.id),isExporting:x.includes(e.id)}))),U={pageIndex:l,pageSize:d,totalItemCount:null!==(r=null===(o=h.result)||void 0===o?void 0:o.total)&&void 0!==r?r:0,showPerPageOptions:!1},Q=(W=q,G=P,[{field:"name",name:AT,truncateText:!1},{field:"type",name:FT,width:"15%",truncateText:!0,render:e=>{const t=GT.find((({value:t})=>t===e));return i.a.createElement(i.a.Fragment,null,t?t.text:e)}},{field:"created_at",name:RT,render:e=>i.a.createElement(Ba.a,{value:e,fieldName:"created_at"}),width:"30%"},{field:"created_by",name:PT,truncateText:!0,width:"20%"},{name:_T,actions:[{render:e=>i.a.createElement(B.EuiToolTip,{content:qT},e.isExporting?i.a.createElement(ZT,{size:"m"}):i.a.createElement(B.EuiButtonIcon,{"aria-label":qT,"data-test-subj":"action-export-value-list",iconType:"exportAction",onClick:()=>W(e)}))},{render:e=>i.a.createElement(B.EuiToolTip,{content:NT},e.isDeleting?i.a.createElement(ZT,{size:"m"}):i.a.createElement(B.EuiButtonIcon,{"aria-label":NT,"data-test-subj":`action-delete-value-list-${e.name}`,iconType:"trash",onClick:()=>G(e)}))}],width:"15%"}]);var W,G;return i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiFlyout,{onClose:e,maxWidth:800},i.a.createElement(B.EuiFlyoutHeader,null,i.a.createElement(B.EuiTitle,null,i.a.createElement("h2",null,TT))),i.a.createElement(B.EuiFlyoutBody,null,i.a.createElement(XT,{onSuccess:H,onError:z}),i.a.createElement(B.EuiSpacer,null),i.a.createElement(B.EuiText,{size:"s"},i.a.createElement("h2",null,LT)),i.a.createElement(B.EuiBasicTable,{"data-test-subj":"value-lists-table",columns:Q,items:V,loading:h.loading,onChange:L,pagination:U})),i.a.createElement(B.EuiFlyoutFooter,null,i.a.createElement(B.EuiButton,{"data-test-subj":"value-lists-flyout-close-action",onClick:e},OT))),i.a.createElement(Ua,{cancelText:QT,confirmText:WT,contentText:A.contentText,onCancel:$,onClose:$,onConfirm:_,references:A.exceptionListReferences,showModal:M,titleText:UT}),i.a.createElement(fa,{blob:O.blob,name:O.name,onDownload:()=>j({})}))};tx.displayName="ValueListsFlyoutComponent";const ax=i.a.memo(tx);ax.displayName="ValueListsFlyout";const nx=({loading:e,numberOfUpdatedRules:t,numberOfUpdatedTimelines:a,updateRules:s})=>{const{services:r}=Object(u.k)(),o=Object(n.useMemo)((()=>{return t>0&&0===a?{callOutMessage:ek(t),buttonTitle:ak(t)}:0===t&&a>0?{callOutMessage:(e=a,N.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesMsg",{values:{updateTimelines:e},defaultMessage:"You can update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"})),buttonTitle:nk(a)}:t>0&&a>0?{callOutMessage:tk(t,a),buttonTitle:ik(t,a)}:void 0;var e}),[t,a]);return i.a.createElement(B.EuiCallOut,{title:Zv,"data-test-subj":"update-callout"},i.a.createElement("p",null,null==o?void 0:o.callOutMessage,i.a.createElement("br",null),i.a.createElement(B.EuiLink,{href:`${r.docLinks.links.siem.ruleChangeLog}`,target:"_blank"},sk)),i.a.createElement(B.EuiButton,{onClick:s,size:"s",isLoading:e,"data-test-subj":"update-callout-button"},null==o?void 0:o.buttonTitle))},ix=Object(n.memo)(nx),sx=()=>i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody",defaultMessage:"{summary} Related documentation: {docs}",values:{summary:i.a.createElement("p",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody.summary",defaultMessage:"Machine learning rules use ML jobs that in turn have dependencies on data fields populated by the Beats and Elastic Agent integrations that were current when the ML job was created. New ML jobs, prefixed with V3, have been released to operate on now-current ECS fields. If you're using multiple versions of Beats or Elastic Agent, you may need to duplicate or create new machine learning rules that specify the new ML (V3) jobs and enable them to run alongside your existing rules, to ensure continued rule coverage using V1/V2 jobs."})),docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(Rv.b,null)))}}),rx={type:"primary",id:"ml-job-compatibility",title:N.i18n.translate("xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageTitle",{defaultMessage:"Your ML jobs may be incompatible with your data sources and/or ML rules"}),description:i.a.createElement(sx,null)},ox=()=>{const{loading:e,jobs:t}=Object(Dn.a)(),a=t.some((e=>$v.includes(e.id)));return i.a.createElement(Ju.c,{namespace:"detections",condition:!e&&a,message:rx})},lx=Object(n.memo)(ox),cx=()=>{const[e,t,a]=Object(Kv.a)(),[s,o,l]=Object(Kv.a)(),{navigateToApp:c}=Object(u.k)().services.application,{startTransaction:d}=Object(bl.a)(),p=Object(hl.b)(),{loading:m,jobs:g}=Object(Dn.a)(),b=g.filter((e=>$v.includes(e.id))),[y,E]=Object(n.useState)(!1),[{loading:k,isSignalIndexExists:S,isAuthenticated:T,hasEncryptionKey:x,canUserCRUD:w,hasIndexWrite:O}]=Object(ne.b)(),{loading:j,canWriteIndex:I,needsConfiguration:C}=Object(le.a)(),M=k||j,{createPrePackagedRules:D,loadingCreatePrePackagedRules:A,rulesCustomInstalled:F,rulesInstalled:R,rulesNotInstalled:P,rulesNotUpdated:_,timelinesInstalled:q,timelinesNotInstalled:N,timelinesNotUpdated:L,getLoadPrebuiltRulesAndTemplatesButton:z,getReloadPrebuiltRulesAndTemplatesButton:H}=Object(Vv.d)({canUserCRUD:w,hasIndexWrite:O,isSignalIndexExists:S,isAuthenticated:T,hasEncryptionKey:x}),$=Object(uk.e)(R,P,_),V=Object(uk.f)(q,N,L),U=Object(n.useCallback)((async()=>{null!=D&&(d({name:ml.d.LOAD_PREBUILT}),await D())}),[D,d]),Q=Object(n.useCallback)((async()=>{E(!1),await U()}),[U,E]),G=Object(n.useCallback)((async()=>{b.length>0?E(!0):await U()}),[U,b.length]),K=Object(n.useMemo)((()=>z({isDisabled:!Object(pa.c)(w)||M||m,onClick:G})),[w,z,G,M,m]),J=Object(n.useMemo)((()=>H({isDisabled:!Object(pa.c)(w)||M||m,onClick:G})),[w,H,G,M,m]);return Object(uk.h)(S,T,x,C)?(c(r.A,{deepLinkId:v.a.alerts,path:Object(W.a)()}),null):i.a.createElement(i.a.Fragment,null,i.a.createElement(Gt.a,null),i.a.createElement(Kt.a,null),i.a.createElement(lx,null),y&&i.a.createElement(Hv,{jobs:b,onCancel:()=>E(!1),onConfirm:Q}),i.a.createElement(ax,{showFlyout:s,onClose:l}),i.a.createElement(kT.a,{checkBoxLabel:il.Vb,closeModal:a,description:il.Kc,errorMessage:il.Ib,failedDetailed:il.Jb,importComplete:p,importData:Vv.a,successMessage:il.Mc,showModal:e,submitBtnText:il.Lb,subtitle:il.Nb,title:il.Kb,showExceptionsCheckBox:!0,showCheckBox:!0}),i.a.createElement(nl.a,null,i.a.createElement(f.a,null,i.a.createElement(Yt.a,{title:il.Wb},i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,wrap:!0},K&&i.a.createElement(B.EuiFlexItem,{grow:!1},K),J&&i.a.createElement(B.EuiFlexItem,{grow:!1},J),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiToolTip,{position:"top",content:il.Oc},i.a.createElement(B.EuiButton,{"data-test-subj":"open-value-lists-modal-button",iconType:"importAction",isDisabled:!I||!w||M,onClick:o},il.Mb))),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{"data-test-subj":"rules-import-modal-button",iconType:"importAction",isDisabled:!Object(pa.c)(w)||M,onClick:t},il.Kb)),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(ue.l,{"data-test-subj":"create-new-rule",fill:!0,iconType:"plusInCircle",isDisabled:!Object(pa.c)(w)||M,deepLinkId:v.a.rulesCreate},il.d)))),("ruleNeedUpdate"===$||"timelineNeedUpdate"===V)&&i.a.createElement(ix,{"data-test-subj":"update-callout-button",loading:A,numberOfUpdatedRules:null!=_?_:0,numberOfUpdatedTimelines:null!=L?L:0,updateRules:G}),i.a.createElement(vT,{createPrePackagedRules:D,"data-test-subj":"all-rules",loadingCreatePrePackagedRules:A,hasPermissions:Object(pa.c)(w),rulesCustomInstalled:F,rulesInstalled:R,rulesNotInstalled:P,rulesNotUpdated:_}))),i.a.createElement(h.a,{pageName:v.a.rules}))},ux=i.a.memo(cx);var dx=a(262);const px=H.a.div.withConfig({displayName:"RuleStatusIconStyled",componentId:"sc-1sbrlhw-0"})(["position:relative;svg{position:absolute;top:8px;left:9px;}"]),mx=({name:e,type:t})=>{const a=(()=>{const[e]=Object(u.q)(r.M);return e?Co.euiDarkVars:Co.euiLightVars})(),n="passive"===t?a.euiColorLightestShade:a.euiColorPrimary;return i.a.createElement(px,null,i.a.createElement(B.EuiAvatar,{color:n,name:"valid"===t?"":e,size:"l"}),"valid"===t?i.a.createElement(B.EuiIcon,{type:"check",color:a.euiColorEmptyShade,size:"l"}):null)},gx=Object(n.memo)(mx),fx=({name:e,title:t,type:a})=>i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(gx,{name:e,type:a})),i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiTitle,{size:"s",className:"euiAccordionForm__title"},i.a.createElement("h6",null,t)))),bx=i.a.memo(fx);var hx=a(605),yx=a(607),Ex=a(621),vx=a(606),kx=a(250),Sx=a(405);const Tx=N.i18n.translate("xpack.securitySolution.detectionEngine.createRule.pageTitle",{defaultMessage:"Create new rule"}),xx=N.i18n.translate("xpack.securitySolution.detectionEngine.createRule.backToRulesButton",{defaultMessage:"Rules"}),wx=N.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewTitle",{defaultMessage:"Rule preview"}),Ox=(N.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewDescription",{defaultMessage:"Rule preview reflects the current configuration of your rule settings and exceptions, click refresh icon to see the updated preview."}),N.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),N.i18n.translate("xpack.securitySolution.detectionEngine.createRule.editRuleButton",{defaultMessage:"Edit"}));var jx=a(477),Ix=a(102),Cx=a.n(Ix),Mx=a(411),Dx=a(392);const Ax=({timeframeOptions:e})=>{const t=1e3*(e.timeframeEnd.valueOf()/1e3-e.timeframeStart.valueOf()/1e3),{unit:a,value:n}=Object(Sx.f)(e.interval),i=$o.a.duration(n,a),s=i.asMilliseconds(),r=Math.max(Math.ceil(t/s),1),o=e.interval,{unit:l,value:c}=Object(Sx.f)(e.lookback);return i.add(c,l),{invocationCount:r,interval:o,from:`now-${i.asSeconds()}s`}},Fx={previewId:void 0,logs:[],isAborted:!1};var Rx=a(462),Px=a.n(Rx),_x=a(646),qx=a(663),Nx=a(1013),Lx=a(647),Bx=a(988),zx=a(340),Hx=a(311),$x=a(986);const Vx=({columnId:e,data:t,ecsData:a,eventId:n,globalFilters:s,header:r,isDetails:o,isDraggable:l,isExpandable:c,isExpanded:u,linkValues:d,rowIndex:p,colIndex:m,rowRenderers:g,setCellProps:f,timelineId:b,truncate:h})=>i.a.createElement(Ux,{columnId:e,data:t,ecsData:a,eventId:n,globalFilters:s,header:r,isDetails:o,isDraggable:l,isExpandable:c,isExpanded:u,linkValues:d,rowIndex:p,colIndex:m,rowRenderers:g,setCellProps:f,timelineId:b,truncate:h}),Ux=({data:e,ecsData:t,eventId:a,header:s,isDetails:r,isDraggable:o,isTimeline:l,linkValues:c,rowRenderers:u,timelineId:d,truncate:p})=>{const m=Object(n.useMemo)((()=>void 0!==Object(zx.b)(s.id,s.type,void 0)&&!l),[s.id,s.type,l]),g=Object(Hx.c)({data:e,fieldName:s.id}),f=r?"eui-textBreakWord":"eui-displayInlineBlock eui-textTruncate";return i.a.createElement(i.a.Fragment,null,i.a.createElement(Bx.b,{className:f,$isDetails:r},Object($x.a)(s.id,Ec.a,e).renderColumn({asPlainText:m,columnName:s.id,ecsData:t,eventId:a,field:s,isDetails:r,isDraggable:o,linkValues:c,rowRenderers:u,timelineId:d,truncate:p,values:g})))},Qx=H.a.div.attrs((({className:e})=>({className:`siemEventsTable__tdContent ${null!=e?e:""}`}))).withConfig({displayName:"EventsTdContent",componentId:"sc-w2s741-0"})(["font-size:",";line-height:",";min-width:0;padding:",";text-align:",";width:",";button.euiButtonIcon{margin-left:",";}"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS),(({textAlign:e})=>e),(({width:e})=>null!=e?`${e}px`:"100%"),(({theme:e})=>`-${e.eui.euiSizeXS}`)),Wx=H.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-w2s741-1"})(["align-items:center;display:flex;"]),Gx=({ariaRowindex:e,columnValues:t,onEventDetailsPanelOpened:a})=>i.a.createElement(Wx,null,i.a.createElement("div",{key:"expand-event"},i.a.createElement(Qx,{textAlign:"center",width:$.DEFAULT_ACTION_BUTTON_WIDTH+10},i.a.createElement(B.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:Mx.r},i.a.createElement(B.EuiButtonIcon,{"aria-label":Mx.s({ariaRowindex:e,columnValues:t}),"data-test-subj":"expand-event",iconType:"expand",onClick:a,size:"s"})))));Gx.displayName="PreviewActionsComponent";const Kx=i.a.memo(Gx),Jx=H()(B.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-1g7nn5q-0"})(["display:block;margin:0 auto;"]),Yx=H.a.div.withConfig({displayName:"FullScreenContainer",componentId:"sc-1g7nn5q-1"})(["height:",";flex:1 1 auto;display:flex;width:100%;"],(({$isFullScreen:e})=>e?"100%":void 0)),Xx=({previewId:e,addNoiseWarning:t,spaceId:a,ruleType:s,indexPattern:l,timeframeOptions:c})=>{const g=Object(o.useDispatch)(),{setQuery:f,isInitializing:b}=Object(U.a)(),{timelines:h}=Object(u.k)().services,y=Object(n.useMemo)((()=>c.timeframeStart.toISOString()),[c]),E=Object(n.useMemo)((()=>c.timeframeEnd.toISOString()),[c]),v=Object(n.useMemo)((()=>"eql"===s),[s]),k=Object(n.useMemo)((()=>"machine_learning"===s),[s]),[S,{data:T,inspect:w,totalCount:O,refetch:j}]=(({previewId:e,startDate:t,endDate:a,spaceId:i,ruleType:s,indexPattern:o})=>{const{uiSettings:l}=Object(u.k)().services,[c,d]=Object(Ac.c)({config:Object(an.getEsQueryConfig)(l),indexPattern:o,queries:[{query:`kibana.alert.rule.uuid:${e}`,language:"kuery"}],filters:[]}),p=Object(n.useMemo)((()=>"machine_learning"===s?"host.name":"event.category"),[s]),m=Object(n.useMemo)((()=>({endDate:a,errorMessage:Mx.k,filterQuery:c,histogramType:rn.l.preview,indexNames:[`${r.Z}-${i}`],stackByField:p,startDate:t,includeMissingData:!1,skip:null!=d})),[t,a,c,i,d,p]);return Object(Nx.a)(m)})({previewId:e,startDate:y,endDate:E,spaceId:a,indexPattern:l,ruleType:s}),I=Object(Sc.b)(),{timeline:{columns:C,dataProviders:M,defaultColumns:D,deletedEventIds:A,itemsPerPage:F,itemsPerPageOptions:R,kqlMode:P,sort:_}=Object(fe.g)(I)}=Object(o.useSelector)((e=>Object(_x.a)(e,jc.c.rulePreview))),{browserFields:q,indexPattern:N,runtimeMappings:L,dataViewId:z,loading:H}=Object(p.d)(m.SourcererScopeName.detections),{globalFullScreen:V}=Object(de.a)(),Q=Px()(e),W=Object(oy.a)("tGridEventRenderedViewEnabled");Object(n.useEffect)((()=>{Q!==e&&O>0&&Object(qx.c)(O,c)&&t()}),[O,t,Q,e,c]),Object(n.useEffect)((()=>{S||b||f({id:`previewHistogram-${e}`,inspect:w,loading:S,refetch:j})}),[f,w,S,b,j,e]),Object(n.useEffect)((()=>{g(d.a.createTimeline({columns:C,dataViewId:z,defaultColumns:D,id:jc.c.rulePreview,indexNames:[`${r.Z}-${a}`],itemsPerPage:F,sort:_}))}),[]);const G=Object(n.useMemo)((()=>Object(qx.a)(E,y,!v)),[E,y,v]),K=Object(n.useMemo)((()=>[{key:"hits",value:T}]),[T]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Mn.a,{height:300,"data-test-subj":"preview-histogram-panel"},i.a.createElement(B.EuiFlexGroup,{gutterSize:"none",direction:"column"},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(Tt.a,{id:`previewHistogram-${e}`,title:Mx.j,titleSize:"xs"})),i.a.createElement(B.EuiFlexItem,{grow:1},S?i.a.createElement(Jx,{size:"l","data-test-subj":"preview-histogram-loading"}):i.a.createElement(yu.a,{configs:G,barChart:K,"data-test-subj":"preview-histogram-bar-chart"})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,null),i.a.createElement(B.EuiText,{size:"s",color:"subdued"},i.a.createElement("p",null,k?Mx.f:Mx.g)))))),i.a.createElement(B.EuiSpacer,null),i.a.createElement(Yx,{$isFullScreen:V},i.a.createElement(De.c,null,h.getTGrid({additionalFilters:i.a.createElement(i.a.Fragment,null),appId:r.A,browserFields:q,columns:C,dataProviders:M,deletedEventIds:A,disabledCellActions:Lx.a,end:"now+5m",start:"now-5m",entityType:"events",filters:[],globalFullScreen:V,hasAlertsCrud:!1,id:jc.c.rulePreview,indexNames:[`${r.Z}-${a}`],indexPattern:N,isLive:!1,isLoadingIndexPattern:H,itemsPerPage:F,itemsPerPageOptions:R,kqlMode:P,query:{query:`kibana.alert.rule.uuid:${e}`,language:"kuery"},renderCellValue:Vx,rowRenderers:Ec.b,runtimeMappings:L,setQuery:()=>{},sort:_,tGridEventRenderedViewEnabled:W,type:"embedded",leadingControlColumns:(1.5,[{headerCellRender:()=>i.a.createElement(i.a.Fragment,null,Mx.a),id:"default-timeline-control-column",rowCellRender:Kx,width:Object($.getActionsColumnWidth)(1.5)}])}))),i.a.createElement(x.a,{browserFields:q,entityType:"events",isFlyoutView:!0,runtimeMappings:L,timelineId:jc.c.rulePreview,isReadOnly:!0}))},Zx=({message:e})=>i.a.createElement(B.EuiCallOut,{color:"warning",iconType:"alert","data-test-subj":"preview-abort"},i.a.createElement(B.EuiText,null,i.a.createElement("p",null,e))),ew=(e,t,a,n)=>t.length?[{startedAt:e,logs:t,duration:a},...n]:n,tw=({logs:e,hasNoiseWarning:t,isAborted:a})=>{const s=Object(n.useMemo)((()=>e.reduce((({errors:e,warnings:t},a)=>({errors:ew(a.startedAt,a.errors,a.duration,e),warnings:ew(a.startedAt,a.warnings,a.duration,t)})),{errors:[],warnings:[]})),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,{size:"s"}),null!=t?t:i.a.createElement(Zx,{message:Mx.o}),i.a.createElement(aw,{logs:s.errors,isError:!0}),i.a.createElement(aw,{logs:s.warnings},a?i.a.createElement(Zx,{message:Mx.h}):null))},aw=({logs:e,isError:t,children:a})=>{const n=e[0];if(!a&&!n)return null;const s=a?e:e.slice(1),r=null!=a?a:i.a.createElement(nw,{logs:n.logs,startedAt:n.startedAt,isError:t,duration:n.duration});return i.a.createElement(i.a.Fragment,null,r,s.length>0?i.a.createElement(B.EuiAccordion,{id:t?"previewErrorAccordion":"previewWarningAccordion",buttonContent:t?Mx.p:Mx.q},s.map(((e,a)=>i.a.createElement(nw,{key:`accordion-log-${a}`,logs:e.logs,startedAt:e.startedAt,duration:e.duration,isError:t})))):null,i.a.createElement(B.EuiSpacer,{size:"m"}))},nw=({logs:e,startedAt:t,isError:a,duration:s})=>e.length>0?i.a.createElement(i.a.Fragment,null,e.map(((e,r)=>i.a.createElement(n.Fragment,{key:r},i.a.createElement(B.EuiCallOut,{color:a?"danger":"warning",iconType:"alert","data-test-subj":a?"preview-error":"preview-warning",title:`${t?`[${t}] `:""}[${s}ms]`},i.a.createElement(B.EuiText,null,i.a.createElement("p",null,e))),i.a.createElement(B.EuiSpacer,{size:"s"}))))):null,iw=H()(B.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-179y2u8-0"})(["display:block;margin:0 auto;"]),sw=()=>i.a.createElement(Mn.a,{height:300,"data-test-subj":"preview-histogram-panel"},i.a.createElement(B.EuiFlexGroup,{gutterSize:"none",direction:"column"},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(Tt.a,{title:Mx.j,titleSize:"xs",subtitle:"loading"})),i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(iw,{size:"l","data-test-subj":"preview-histogram-loading"})),i.a.createElement(B.EuiSpacer,null))),rw=[{start:"now/d",end:"now",label:"Today"},{start:"now/w",end:"now",label:"This week"},{start:"now-15m",end:"now",label:"Last 15 minutes"},{start:"now-30m",end:"now",label:"Last 30 minutes"},{start:"now-1h",end:"now",label:"Last 1 hour"},{start:"now-24h",end:"now",label:"Last 24 hours"},{start:"now-7d",end:"now",label:"Last 7 days"},{start:"now-30d",end:"now",label:"Last 30 days"}],ow=(e,t)=>({start:Cx.a.parse(e)||$o()().subtract(1,"hour"),end:Cx.a.parse(t)||$o()()}),lw=({isDisabled:e,defineRuleData:t,aboutRuleData:a,scheduleRuleData:s,exceptionsList:r})=>{const{indexPattern:o,ruleType:l}=t,{spaces:c}=Object(u.k)().services,[d,p]=Object(n.useState)("");Object(n.useEffect)((()=>{c&&c.getActiveSpace().then((e=>p(e.id)))}),[c]);const[m,g]=Object(n.useState)("now-1h"),[f,b]=Object(n.useState)("now"),[h,y]=Object(n.useState)($o()().subtract(1,"hour")),[E,v]=Object(n.useState)($o()()),[k,S]=Object(n.useState)(!1);Object(n.useEffect)((()=>{const{start:e,end:t}=ow(m,f);y(e),v(t)}),[m,f]);const[T,x]=Object(n.useState)({timeframeOptions:{timeframeStart:h,timeframeEnd:E,interval:"5m",lookback:"1m"}}),{invocationCount:w}=Ax({timeframeOptions:{timeframeStart:h,timeframeEnd:E,interval:s.interval,lookback:s.from}}),O=w>200,{addNoiseWarning:j,createPreview:I,isPreviewRequestInProgress:C,previewId:M,logs:D,hasNoiseWarning:A,isAborted:F}=(({defineRuleData:e,aboutRuleData:t,scheduleRuleData:a,exceptionsList:i,timeframeOptions:s})=>{var r,o;const[l,c]=Object(n.useState)(!1),{isLoading:u,response:d,rule:p,setRule:m}=(({timeframeOptions:e})=>{const[t,a]=Object(n.useState)(null),[i,s]=Object(n.useState)(Fx),[r,o]=Object(n.useState)(!1),{addError:l}=Object(ma.a)(),{invocationCount:c,interval:u,from:d}=Ax({timeframeOptions:e}),p=Object(n.useMemo)((()=>e.timeframeEnd.toISOString()),[e]);return Object(n.useEffect)((()=>{t||(s(Fx),o(!1))}),[t]),Object(n.useEffect)((()=>{let e=!0;const a=new AbortController;return s(Fx),(async()=>{if(null!=t){try{o(!0);const n=await Object(za.l)({rule:{...Object(Dx.b)({...t,interval:u,from:d}),invocationCount:c,timeframeEnd:p},signal:a.signal});e&&s(n)}catch(t){e&&l(t,{title:ck.g})}e&&o(!1)}})(),()=>{e=!1,a.abort()}}),[t,l,c,d,u,p]),{isLoading:r,response:i,rule:t,setRule:a}})({timeframeOptions:s}),[g,f]=Object(n.useState)(null!==(r=d.logs)&&void 0!==r?r:[]),[b,h]=Object(n.useState)(!!d.isAborted),[y,E]=Object(n.useState)(!1);Object(n.useEffect)((()=>{var e;f(null!==(e=d.logs)&&void 0!==e?e:[]),h(!!d.isAborted)}),[d]);const v=Object(n.useCallback)((()=>{E(!0)}),[E]),k=Object(n.useCallback)((()=>{m(null),f([]),h(!1),c(!1),E(!1)}),[m]);return Object(n.useEffect)((()=>{k()}),[k,e,t,a]),Object(n.useEffect)((()=>{e&&t&&a&&l&&null===p&&m(Object(Sx.c)({defineRuleData:e,aboutRuleData:t,scheduleRuleData:a,exceptionsList:i}))}),[l,p,m,e,t,a,i]),{hasNoiseWarning:y,addNoiseWarning:v,createPreview:()=>c(!0),clearPreview:k,isPreviewRequestInProgress:u,previewId:null!==(o=d.previewId)&&void 0!==o?o:"",logs:g,isAborted:b}})({defineRuleData:T.defineRuleData,aboutRuleData:T.aboutRuleData,scheduleRuleData:T.scheduleRuleData,exceptionsList:r,timeframeOptions:T.timeframeOptions}),{startTransaction:R}=Object(bl.a)(),[P,_]=Object(n.useState)(!1);Object(n.useEffect)((()=>{P&&(I(),_(!1))}),[P,I]),Object(n.useEffect)((()=>{const{start:e,end:t}=ow(m,f);y(e),v(t)}),[f,m]);const q=Object(n.useCallback)((({start:e,end:t,isInvalid:a})=>{S(a),a||(g(e),b(t))}),[]),N=Object(n.useCallback)((()=>{R({name:ml.e.PREVIEW});const{start:e,end:n}=ow(m,f);y(e),v(n),x({defineRuleData:t,aboutRuleData:a,scheduleRuleData:s,timeframeOptions:{timeframeStart:e,timeframeEnd:n,interval:s.interval,lookback:s.from}}),_(!0)}),[a,t,f,s,m,R]),L=Object(n.useMemo)((()=>!(h.isSame(T.timeframeOptions.timeframeStart)&&E.isSame(T.timeframeOptions.timeframeEnd)&&Object($h.isEqual)(t,T.defineRuleData)&&Object($h.isEqual)(a,T.aboutRuleData)&&Object($h.isEqual)(s,T.scheduleRuleData))),[a,t,T.aboutRuleData,T.defineRuleData,T.scheduleRuleData,T.timeframeOptions.timeframeEnd,T.timeframeOptions.timeframeStart,s,E,h]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,{size:"s"}),O&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiCallOut,{color:"warning",title:Mx.m,"data-test-subj":"previewInvocationCountWarning"},Mx.l),i.a.createElement(B.EuiSpacer,null)),i.a.createElement(B.EuiFormRow,{label:Mx.n,error:void 0,isInvalid:!1,"data-test-subj":"rule-preview",describedByIds:["rule-preview"]},i.a.createElement(B.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},i.a.createElement(B.EuiSuperDatePicker,{start:m,end:f,isDisabled:e,onTimeChange:q,showUpdateButton:!1,commonlyUsedRanges:rw,onRefresh:N,"data-test-subj":"preview-time-frame"}),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiSuperUpdateButton,{isDisabled:k||e,iconType:L?"kqlFunction":"refresh",onClick:N,color:L?"success":"primary",fill:!0,"data-test-subj":"previewSubmitButton"})))),i.a.createElement(B.EuiSpacer,{size:"l"}),C&&i.a.createElement(sw,null),!C&&M&&d&&i.a.createElement(Xx,{ruleType:l,previewId:M,addNoiseWarning:j,spaceId:d,indexPattern:o,timeframeOptions:T.timeframeOptions}),i.a.createElement(tw,{logs:D,hasNoiseWarning:A,isAborted:F}))},cw=i.a.memo(lw),uw=N.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewTitle",{defaultMessage:"Rule preview"}),dw=N.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewDescription",{defaultMessage:"Rule preview reflects the current configuration of your rule settings and exceptions, click refresh icon to see the updated preview."}),pw=N.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),mw=H()(B.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1oj0sti-0"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{mask-image:none;}"]),gw=({isDisabled:e,defineStepData:t,aboutStepData:a,scheduleStepData:n,exceptionsList:s,onClose:r})=>i.a.createElement(B.EuiFlyout,{type:"push",size:"550px",ownFocus:!1,onClose:r},i.a.createElement(B.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(B.EuiTitle,{size:"m"},i.a.createElement("h2",null,uw)),i.a.createElement(B.EuiSpacer,{size:"s"}),i.a.createElement(B.EuiText,{color:"subdued"},i.a.createElement("p",null,dw))),i.a.createElement(mw,null,i.a.createElement(cw,{isDisabled:e,defineRuleData:t,aboutRuleData:a,scheduleRuleData:n,exceptionsList:s})),i.a.createElement(B.EuiFlyoutFooter,null,i.a.createElement(B.EuiButton,{onClick:r},pw))),fw=i.a.memo(gw),bw=async()=>{},hw=H()(B.EuiPanel).withConfig({displayName:"MyEuiPanel",componentId:"sc-wzrzmg-0"})(["position:relative;z-index:",";> .euiAccordion > .euiAccordion__triggerWrapper{.euiAccordion__button{cursor:default !important;&:hover{text-decoration:none !important;}}.euiAccordion__iconWrapper{display:none;}}.euiAccordion__childWrapper{transform:none;}"],(e=>e.zindex));hw.displayName="MyEuiPanel";const yw=(e,t)=>t!==e?"0":"1",Ew=()=>{var e,t;const[{loading:a,isSignalIndexExists:s,isAuthenticated:o,hasEncryptionKey:l,canUserCRUD:c}]=Object(ne.b)(),{loading:d,needsConfiguration:p}=Object(le.a)(),{navigateToApp:m}=Object(u.k)().services.application,{data:g}=Object(u.k)().services,b=a||d,[,y]=Object(bm.g)(),[E,k]=Object(n.useState)(kx.b.defineRule),S=Object(n.useRef)(null),T=Object(n.useRef)(null),x=Object(n.useRef)(null),w=Object(n.useRef)(null),[O]=Object(u.q)(r.Q),[j]=Object(u.q)(r.db),I=Object(n.useRef)({[kx.b.defineRule]:bw,[kx.b.aboutRule]:bw,[kx.b.scheduleRule]:bw,[kx.b.ruleActions]:bw}),C=Object(n.useCallback)(((e,t)=>{I.current[e]=t}),[]),M=Object(n.useRef)({[kx.b.defineRule]:{isValid:!1,data:void 0},[kx.b.aboutRule]:{isValid:!1,data:void 0},[kx.b.scheduleRule]:{isValid:!1,data:void 0},[kx.b.ruleActions]:{isValid:!1,data:void 0}}),D=(e,t)=>{M.current[e]=t},[A,F]=Object(n.useState)({[kx.b.defineRule]:!1,[kx.b.aboutRule]:!1,[kx.b.scheduleRule]:!1,[kx.b.ruleActions]:!1}),[{isLoading:R,ruleId:P},_]=Object(Vv.c)(),q=null===(e=M.current[kx.b.defineRule].data)||void 0===e?void 0:e.ruleType,L=null===(t=M.current[kx.b.aboutRule].data)||void 0===t?void 0:t.name,z=Object(n.useMemo)((()=>Object(uk.c)(q)),[q]),[H,$]=Object(n.useState)({}),[V,U]=Object(n.useState)(!1),[Q,G]=Object(n.useState)(!1),[K,J]=Object(n.useState)({...jx.f,index:O,threatIndex:j}),[Y,X]=Object(n.useState)(jx.e),[Z,ee]=Object(n.useState)(Object(jx.b)(K.ruleType));Object(n.useEffect)((()=>{const e=Object(dx.e)(K.ruleType);X(e?{...jx.e,threatIndicatorPath:r.S}:jx.e),ee(Object(jx.b)(K.ruleType))}),[K.ruleType]);const te=Object(n.useCallback)((e=>{E===kx.b.defineRule?J(e):E===kx.b.aboutRule?X(e):E===kx.b.scheduleRule&&ee(e)}),[E]);Object(n.useEffect)((()=>{(async()=>{const e=(await g.dataViews.getIdsWithTitle()).reduce(((e,t)=>({...e,[t.id]:t})),{});$(e)})()}),[g.dataViews]);const ae=Object(n.useCallback)(((e,t)=>F((a=>({...a,[e]:t})))),[]),ie=Object(n.useCallback)((e=>{jx.d.indexOf(e)>jx.d.indexOf(E)&&!A[e]&&se(e),k(e)}),[E,A]),se=e=>{var t;if(e===kx.b.defineRule)null===(t=S.current)||void 0===t||t.onToggle();else if(e===kx.b.aboutRule){var a;null===(a=T.current)||void 0===a||a.onToggle()}else if(e===kx.b.scheduleRule){var n;null===(n=x.current)||void 0===n||n.onToggle()}else if(e===kx.b.ruleActions){var i;null===(i=w.current)||void 0===i||i.onToggle()}},re=Object(n.useCallback)((async e=>{const t=await I.current[E]();null!=t&&t.isValid&&(D(E,t),ie(e))}),[E,ie]),oe=Object(n.useCallback)((async e=>{const t=await I.current[e]();if(null!=t&&t.isValid&&t.data){te(t.data),D(e,t);const a=(e=>jx.d[jx.d.indexOf(e)+1])(e);if(null!=a)ie(a);else{const e=M.current[kx.b.defineRule],t=M.current[kx.b.aboutRule],a=M.current[kx.b.scheduleRule],n=M.current[kx.b.ruleActions];Object(Sx.k)(e)&&Object(Sx.k)(t)&&Object(Sx.k)(a)&&Object(Sx.k)(n)&&_(Object(Sx.d)(e.data,t.data,a.data,n.data))}}}),[ie,_,te]),ce=Object(n.useCallback)((e=>e===E?"active":M.current[e].isValid?"valid":"passive"),[E]),ue=i.a.createElement(bx,{name:"1",title:il.rb,type:ce(kx.b.defineRule)}),de=i.a.createElement(bx,{name:"2",title:il.b,type:ce(kx.b.aboutRule)}),pe=i.a.createElement(bx,{name:"3",title:il.Fc,type:ce(kx.b.scheduleRule)}),me=i.a.createElement(bx,{name:"4",title:il.Bc,type:ce(kx.b.ruleActions)});return L&&P?(Object(bm.e)((e=>N.i18n.translate("xpack.securitySolution.detectionEngine.rules.create.successfullyCreatedRuleTitle",{values:{ruleName:e},defaultMessage:"{ruleName} was created"}))(L),y),m(r.A,{deepLinkId:v.a.rules,path:Object(W.d)(P)}),null):Object(uk.h)(s,o,l,p)?(m(r.A,{deepLinkId:v.a.alerts,path:Object(W.a)()}),null):Object(pa.c)(c)?i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,null,i.a.createElement(B.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},i.a.createElement(uk.a,null,i.a.createElement(Yt.a,{backOptions:{path:Object(W.e)(),text:xx,pageId:v.a.rules},isLoading:R||b,title:Tx},i.a.createElement(B.EuiButton,{"data-test-subj":"preview-flyout",iconType:"visBarVerticalStacked",onClick:()=>G((e=>!e))},wx)),i.a.createElement(hw,{zindex:4,hasBorder:!0},i.a.createElement(B.EuiAccordion,{initialIsOpen:!0,id:kx.b.defineRule,buttonContent:ue,paddingSize:"xs",ref:S,onToggle:ae.bind(null,kx.b.defineRule),extraAction:M.current[kx.b.defineRule].isValid&&i.a.createElement(B.EuiButtonEmpty,{"data-test-subj":"edit-define-rule",iconType:"pencil",size:"xs",onClick:()=>re(kx.b.defineRule)},Ox)},i.a.createElement(B.EuiHorizontalRule,{margin:"m"}),i.a.createElement(hx.b,{addPadding:!0,defaultValues:K,isReadOnlyView:E!==kx.b.defineRule,isLoading:R||b,setForm:C,onSubmit:()=>oe(kx.b.defineRule),kibanaDataViews:H,descriptionColumns:"singleSplit",key:yw(kx.b.defineRule,E),indicesConfig:O,threatIndicesConfig:j,onRuleDataChange:te,onPreviewDisabledStateChange:U}))),i.a.createElement(B.EuiSpacer,{size:"l"}),i.a.createElement(hw,{hasBorder:!0,zindex:3},i.a.createElement(B.EuiAccordion,{initialIsOpen:!1,id:kx.b.aboutRule,buttonContent:de,paddingSize:"xs",ref:T,onToggle:ae.bind(null,kx.b.aboutRule),extraAction:M.current[kx.b.aboutRule].isValid&&i.a.createElement(B.EuiButtonEmpty,{"data-test-subj":"edit-about-rule",iconType:"pencil",size:"xs",onClick:()=>re(kx.b.aboutRule)},Ox)},i.a.createElement(B.EuiHorizontalRule,{margin:"m"}),i.a.createElement(yx.a,{addPadding:!0,defaultValues:Y,defineRuleData:K,descriptionColumns:"singleSplit",isReadOnlyView:E!==kx.b.aboutRule,isLoading:R||b,setForm:C,onSubmit:()=>oe(kx.b.aboutRule),key:yw(kx.b.aboutRule,E),onRuleDataChange:te}))),i.a.createElement(B.EuiSpacer,{size:"l"}),i.a.createElement(hw,{hasBorder:!0,zindex:2},i.a.createElement(B.EuiAccordion,{initialIsOpen:!1,id:kx.b.scheduleRule,buttonContent:pe,paddingSize:"xs",ref:x,onToggle:ae.bind(null,kx.b.scheduleRule),extraAction:M.current[kx.b.scheduleRule].isValid&&i.a.createElement(B.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>re(kx.b.scheduleRule)},Ox)},i.a.createElement(B.EuiHorizontalRule,{margin:"m"}),i.a.createElement(Ex.a,{addPadding:!0,defaultValues:Z,descriptionColumns:"singleSplit",isReadOnlyView:E!==kx.b.scheduleRule,isLoading:R||b,setForm:C,onSubmit:()=>oe(kx.b.scheduleRule),key:yw(kx.b.scheduleRule,E),onRuleDataChange:te}))),i.a.createElement(B.EuiSpacer,{size:"l"}),i.a.createElement(hw,{hasBorder:!0,zindex:1},i.a.createElement(B.EuiAccordion,{initialIsOpen:!1,id:kx.b.ruleActions,buttonContent:me,paddingSize:"xs",ref:w,onToggle:ae.bind(null,kx.b.ruleActions),extraAction:M.current[kx.b.ruleActions].isValid&&i.a.createElement(B.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>re(kx.b.ruleActions)},Ox)},i.a.createElement(B.EuiHorizontalRule,{margin:"m"}),i.a.createElement(vx.a,{addPadding:!0,defaultValues:M.current[kx.b.ruleActions].data,isReadOnlyView:E!==kx.b.ruleActions,isLoading:R||b,setForm:C,onSubmit:()=>oe(kx.b.ruleActions),actionMessageParams:z,key:yw(kx.b.ruleActions,E),ruleType:q}))),Q&&i.a.createElement(fw,{isDisabled:V&&E===kx.b.defineRule,defineStepData:K,aboutStepData:Y,scheduleStepData:Z,onClose:()=>G(!1)})))),i.a.createElement(h.a,{pageName:v.a.rulesCreate})):(m(r.A,{deepLinkId:v.a.rules,path:Object(W.e)()}),null)},vw=i.a.memo(Ew);var kw=a(665);const Sw=N.i18n.translate("xpack.securitySolution.detectionEngine.editRule.pageTitle",{defaultMessage:"Edit rule settings"}),Tw=N.i18n.translate("xpack.securitySolution.detectionEngine.editRule.cancelTitle",{defaultMessage:"Cancel"}),xw=N.i18n.translate("xpack.securitySolution.detectionEngine.editRule.saveChangeTitle",{defaultMessage:"Save changes"}),ww=N.i18n.translate("xpack.securitySolution.detectionEngine.editRule.errorMsgDescription",{defaultMessage:"Sorry"}),Ow=N.i18n.translate("xpack.securitySolution.detectionEngine.editRule.backToDescription",{defaultMessage:"Back to"});var jw=a(668);const Iw=async()=>{},Cw=()=>{var e;const[,t]=Object(bm.g)(),[{loading:a,isSignalIndexExists:s,isAuthenticated:o,hasEncryptionKey:l,canUserCRUD:c}]=Object(ne.b)(),{loading:d,needsConfiguration:p}=Object(le.a)(),{data:m}=Object(u.k)().services,{navigateToApp:g}=Object(u.k)().services.application,{detailName:b}=Object(P.useParams)(),[y,E]=Object(Vv.e)(b),k=y||a||d,{isSavedQueryLoading:S,savedQueryBar:T,savedQuery:x}=Object(jw.a)(null==E?void 0:E.saved_id,{ruleType:null==E?void 0:E.type,onError:$h.noop}),w=Object(n.useRef)({[kx.b.defineRule]:Iw,[kx.b.aboutRule]:Iw,[kx.b.scheduleRule]:Iw,[kx.b.ruleActions]:Iw}),O=Object(n.useRef)({[kx.b.defineRule]:{isValid:!1,data:void 0},[kx.b.aboutRule]:{isValid:!1,data:void 0},[kx.b.scheduleRule]:{isValid:!1,data:void 0},[kx.b.ruleActions]:{isValid:!1,data:void 0}}),[j,I]=Object(n.useState)(O.current[kx.b.defineRule]),[C,M]=Object(n.useState)(O.current[kx.b.aboutRule]),[D,A]=Object(n.useState)(O.current[kx.b.scheduleRule]),[F,R]=Object(n.useState)(O.current[kx.b.ruleActions]),[_,q]=Object(n.useState)(kx.b.defineRule),L=jx.d.filter((e=>{const t=O.current[e];return null!=t.data&&!Object(Sx.k)(t)})),[{isLoading:z,isSaved:H},$]=Object(Vv.f)(),[V,U]=Object(n.useState)({}),[Q,G]=Object(n.useState)(!1),[K,J]=Object(n.useState)(!1);Object(n.useEffect)((()=>{(async()=>{const e=(await m.dataViews.getIdsWithTitle()).reduce(((e,t)=>({...e,[t.id]:t})),{});U(e)})()}),[m.dataViews]);const Y=Object(n.useMemo)((()=>Object(uk.c)(null==E?void 0:E.type)),[null==E?void 0:E.type]),X=Object(n.useCallback)(((e,t)=>{w.current[e]=t,e===_&&t()}),[_]),Z=Object(n.useCallback)(((e,t,a)=>{switch(e){case kx.b.aboutRule:const n=t;return void M({...O.current[e],data:n,isValid:a});case kx.b.defineRule:const i=t;return void I({...O.current[e],data:i,isValid:a});case kx.b.ruleActions:const s=t;return void R({...O.current[e],data:s,isValid:a});case kx.b.scheduleRule:const r=t;A({...O.current[e],data:r,isValid:a})}}),[]),ee=Object(n.useCallback)((async()=>{if(_===kx.b.defineRule){const e=await w.current[kx.b.defineRule]();null!=e&&e.isValid&&null!=e&&e.data&&I(e)}else if(_===kx.b.aboutRule){const e=await w.current[kx.b.aboutRule]();null!=e&&e.isValid&&null!=e&&e.data&&M(e)}else if(_===kx.b.scheduleRule){const e=await w.current[kx.b.scheduleRule]();null!=e&&e.isValid&&null!=e&&e.data&&A(e)}}),[_]),te=Object(n.useCallback)((()=>J(!1)),[]),[ae]=Object(u.q)(r.Q),[ie]=Object(u.q)(r.db),se=Object(n.useMemo)((()=>j.data?{...j.data,queryBar:null!=T?T:j.data.queryBar}:j.data),[j.data,T]),re=Object(n.useMemo)((()=>[{"data-test-subj":"edit-rule-define-tab",id:kx.b.defineRule,name:il.sb,disabled:null==E?void 0:E.immutable,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,null),i.a.createElement(kw.a,{loading:k||S,title:il.sb},null!=se&&!S&&i.a.createElement(hx.b,{isReadOnlyView:!1,isLoading:z||S,isUpdateView:!0,defaultValues:se,setForm:X,kibanaDataViews:V,indicesConfig:ae,threatIndicesConfig:ie,onRuleDataChange:ee,onPreviewDisabledStateChange:G,defaultSavedQuery:x}),i.a.createElement(B.EuiSpacer,null)))},{"data-test-subj":"edit-rule-about-tab",id:kx.b.aboutRule,name:il.a,disabled:null==E?void 0:E.immutable,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,null),i.a.createElement(kw.a,{loading:k,title:il.a},null!=C.data&&null!=j.data&&i.a.createElement(yx.a,{isReadOnlyView:!1,isLoading:z,isUpdateView:!0,defaultValues:C.data,defineRuleData:j.data,setForm:X,onRuleDataChange:ee}),i.a.createElement(B.EuiSpacer,null)))},{"data-test-subj":"edit-rule-schedule-tab",id:kx.b.scheduleRule,name:il.Ec,disabled:null==E?void 0:E.immutable,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,null),i.a.createElement(kw.a,{loading:k,title:il.Ec},null!=D.data&&i.a.createElement(Ex.a,{isReadOnlyView:!1,isLoading:z,isUpdateView:!0,defaultValues:D.data,setForm:X,onRuleDataChange:ee}),i.a.createElement(B.EuiSpacer,null)))},{"data-test-subj":"edit-rule-actions-tab",id:kx.b.ruleActions,name:il.c,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,null),i.a.createElement(kw.a,{loading:k},null!=F.data&&i.a.createElement(vx.a,{isReadOnlyView:!1,isLoading:z,isUpdateView:!0,defaultValues:F.data,setForm:X,actionMessageParams:Y,ruleType:null==E?void 0:E.type}),i.a.createElement(B.EuiSpacer,null)))}]),[null==E?void 0:E.immutable,null==E?void 0:E.type,k,j.data,z,S,se,X,V,ae,ie,ee,C.data,D.data,F.data,Y,x]),{startTransaction:oe}=Object(bl.a)(),ce=Object(n.useCallback)((async()=>{const e=await w.current[_]();null!=(null==e?void 0:e.data)&&Z(_,e.data,e.isValid);const t=Object(Sx.i)(e)?e:j,a=Object(Sx.g)(e)?e:C,n=Object(Sx.j)(e)?e:D,i=Object(Sx.h)(e)?e:F;Object(Sx.k)(t)&&Object(Sx.k)(a)&&Object(Sx.k)(n)&&Object(Sx.k)(i)&&(oe({name:ml.e.SAVE}),$({...Object(Sx.d)(t.data,a.data,n.data,i.data,null==E?void 0:E.exceptions_list),...b?{id:b}:{},...null!=E?{max_signals:E.max_signals}:{}}))}),[C,F,_,j,E,b,D,$,Z,oe]);Object(n.useEffect)((()=>{if(null!=E){const{aboutRuleData:e,defineRuleData:t,scheduleRuleData:a,ruleActionsData:n}=Object(uk.g)({rule:E});Z(kx.b.defineRule,t,!0),Z(kx.b.aboutRule,e,!0),Z(kx.b.scheduleRule,a,!0),Z(kx.b.ruleActions,n,!0)}}),[E,Z]);const ue=Object(n.useCallback)((async e=>{q(e),await w.current[e]()}),[]),de=Object(n.useCallback)((async e=>{const t=e.id,a=await w.current[_]();null!=(null==a?void 0:a.data)&&(Z(_,a.data,a.isValid),ue(t))}),[_,ue,Z]),pe=Object(n.useCallback)((e=>{e.preventDefault(),g(r.A,{deepLinkId:v.a.rules,path:Object(W.d)(null!=b?b:"")})}),[g,b]);var me,ge;return Object(n.useEffect)((()=>{null!=E&&E.immutable?q(kx.b.ruleActions):q(kx.b.defineRule)}),[E]),H?(Object(bm.e)((ge=null!==(me=null==E?void 0:E.name)&&void 0!==me?me:"",N.i18n.translate("xpack.securitySolution.detectionEngine.rules.update.successfullySavedRuleTitle",{values:{ruleName:ge},defaultMessage:"{ruleName} was saved"})),t),g(r.A,{deepLinkId:v.a.rules,path:Object(W.d)(null!=b?b:"")}),null):Object(uk.h)(s,o,l,p)?(g(r.A,{deepLinkId:v.a.alerts,path:Object(W.a)()}),null):Object(pa.c)(c)?i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,null,i.a.createElement(B.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},i.a.createElement(uk.a,null,i.a.createElement(Yt.a,{backOptions:{path:Object(W.d)(null!=b?b:""),text:`${Ow} ${null!==(e=null==E?void 0:E.name)&&void 0!==e?e:""}`,pageId:v.a.rules,dataTestSubj:"ruleEditBackToRuleDetails"},isLoading:z,title:Sw},j.data&&C.data&&D.data&&i.a.createElement(B.EuiButton,{iconType:"visBarVerticalStacked",onClick:()=>J((e=>!e))},il.Cc)),L.length>0&&i.a.createElement(B.EuiCallOut,{title:ww,color:"danger",iconType:"alert"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rule.editRule.errorMsgDescription",defaultMessage:"You have an invalid input in {countError, plural, one {this tab} other {these tabs}}: {tabHasError}",values:{countError:L.length,tabHasError:L.map((e=>e===kx.b.aboutRule?il.a:e===kx.b.defineRule?il.sb:e===kx.b.scheduleRule?il.Ec:e===kx.b.ruleActions?il.Bc:e)).join(", ")}})),i.a.createElement(B.EuiTabbedContent,{initialSelectedTab:re[0],selectedTab:re.find((e=>e.id===_)),onTabClick:de,tabs:re}),i.a.createElement(B.EuiSpacer,null),i.a.createElement(B.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd",responsive:!1},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{iconType:"cross",onClick:pe},Tw)),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{"data-test-subj":"ruleEditSubmitButton",fill:!0,onClick:ce,iconType:"save",isLoading:z,isDisabled:k},xw))),K&&j.data&&C.data&&D.data&&i.a.createElement(fw,{isDisabled:Q,defineStepData:j.data,aboutStepData:C.data,scheduleStepData:D.data,exceptionsList:null==E?void 0:E.exceptions_list,onClose:te})))),i.a.createElement(h.a,{pageName:v.a.rules,state:{ruleName:null==E?void 0:E.name}})):(g(r.A,{deepLinkId:v.a.rules,path:Object(W.d)(null!=b?b:"")}),null)},Mw=[{path:"/rules/id/:detailName/edit",main:Object(n.memo)(Cw),exact:!0},{path:`/rules/id/:detailName/:tabName(${El.b.alerts}|${El.b.exceptions}|${El.b.endpointExceptions}|${El.b.executionResults}|${El.b.executionEvents})`,main:El.c,exact:!0},{path:"/rules/create",main:vw,exact:!0},{path:"/rules",main:ux,exact:!0}],Dw=()=>(ia(Fv),i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:r.uc.rules},i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:"/rules/id/:detailName",exact:!0,render:({match:{params:{detailName:e}},location:t})=>i.a.createElement(P.Redirect,{to:{...t,pathname:`/rules/id/${e}/${El.b.alerts}`,search:t.search}})}),Mw.map((e=>{var t;return i.a.createElement(_.Route,{key:`rules-route-${e.path}`,path:e.path,exact:null!==(t=null==e?void 0:e.exact)&&void 0!==t&&t},i.a.createElement(e.main,null))})),i.a.createElement(_.Route,{component:q.a}),i.a.createElement(h.a,{pageName:r.uc.rules}))))),Aw=i.a.memo(Dw),Fw=[{path:r.mc,render:()=>i.a.createElement(Aw,null)}];var Rw=a(991),Pw=a(470),_w=a(961),qw=a(515),Nw=a(66);const Lw=H.a.div.withConfig({displayName:"TimelinesContainer",componentId:"sc-13wjqgh-0"})(["width:100%;"]),Bw=()=>{const{tabName:e}=Object(P.useParams)(),[t,a]=Object(n.useState)(!1),s=Object(n.useCallback)((()=>{a(!0)}),[a]),{indicesExist:r}=Object(p.d)(),o=!!Object(u.k)().services.application.capabilities.siem.crud;return i.a.createElement(i.a.Fragment,null,r?i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,null,i.a.createElement(Yt.a,{title:Nw.d},i.a.createElement(B.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(B.EuiFlexItem,null,o&&i.a.createElement(B.EuiButton,{iconType:"indexOpen",onClick:s,"data-test-subj":"open-import-data-modal-btn"},Nw.a)),e===l.m.default?i.a.createElement(B.EuiFlexItem,null,i.a.createElement(qw.c,{timelineId:l.i.active,outline:!0,"data-test-subj":"create-default-btn"})):i.a.createElement(B.EuiFlexItem,null,i.a.createElement(_w.a,{outline:!0,title:Pw.g,"data-test-subj":"create-template-btn"})))),i.a.createElement(Lw,{"data-test-subj":"timelines-container"},i.a.createElement(Rw.a,{defaultPageSize:10,isModal:!1,importDataModalToggle:t&&o,setImportDataModalToggle:a,title:Nw.b,"data-test-subj":"stateful-open-timeline"})))):i.a.createElement(Xt.a,null),i.a.createElement(h.a,{pageName:v.a.timelines}))},zw=i.a.memo(Bw),Hw=`${r.vc}/:tabName(${l.m.default}|${l.m.template})`,$w=`${r.vc}/${l.m.default}`,Vw=i.a.memo((()=>i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{exact:!0,path:Hw},i.a.createElement(zw,null)),i.a.createElement(_.Route,{path:r.vc,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{to:`${$w}${Object(oE.a)(e)}`})}))));Vw.displayName="Timelines";const Uw=[{path:r.vc,component:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:v.a.timelines},i.a.createElement(Vw,null)))}];var Qw=a(45),Ww=a(55);const Gw={timelineById:{},autoSavedWarningMsg:{timelineId:null,newTimelineModel:null},showCallOutUnauthorizedMsg:!1,insertTimeline:null},Kw=Object(Qw.reducerWithInitialState)(Gw).case(k.addTimeline,((e,{id:t,timeline:a,resolveTimelineConfig:n})=>({...e,timelineById:Object(Ww.f)({id:t,timeline:a,resolveTimelineConfig:n,timelineById:e.timelineById})}))).case(k.createTimeline,((e,{id:t,timelineType:a=l.m.default,...n})=>({...e,timelineById:Object(Ww.a)({id:t,timelineById:e.timelineById,timelineType:a,...n})}))).case(k.addHistory,((e,{id:t,historyId:a})=>({...e,timelineById:Object(Ww.b)({id:t,historyId:a,timelineById:e.timelineById})}))).case(k.addNote,((e,{id:t,noteId:a})=>({...e,timelineById:Object(Ww.c)({id:t,noteId:a,timelineById:e.timelineById})}))).case(k.addNoteToEvent,((e,{id:t,noteId:a,eventId:n})=>({...e,timelineById:Object(Ww.d)({id:t,noteId:a,eventId:n,timelineById:e.timelineById})}))).case(k.addProvider,((e,{id:t,providers:a})=>({...e,timelineById:Object(Ww.e)({id:t,providers:a,timelineById:e.timelineById})}))).case(k.applyKqlFilterQuery,((e,{id:t,filterQuery:a})=>({...e,timelineById:Object(Ww.g)({id:t,filterQuery:a,timelineById:e.timelineById})}))).case(k.showTimeline,((e,{id:t,show:a})=>({...e,timelineById:Object(Ww.C)({id:t,show:a,timelineById:e.timelineById})}))).case(k.updateTimelineGraphEventId,((e,{id:t,graphEventId:a})=>({...e,timelineById:Object(Ww.n)({id:t,graphEventId:a,timelineById:e.timelineById})}))).case(k.updateTimelineSessionViewConfig,((e,{id:t,sessionViewConfig:a})=>({...e,timelineById:Object(Ww.p)({id:t,sessionViewConfig:a,timelineById:e.timelineById})}))).case(k.pinEvent,((e,{id:t,eventId:a})=>({...e,timelineById:Object(Ww.i)({id:t,eventId:a,timelineById:e.timelineById})}))).case(k.removeProvider,((e,{id:t,providerId:a,andProviderId:n})=>({...e,timelineById:Object(Ww.j)({id:t,providerId:a,timelineById:e.timelineById,andProviderId:n})}))).case(k.startTimelineSaving,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isSaving:!0}}}))).case(k.endTimelineSaving,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isSaving:!1}}}))).case(k.setExcludedRowRendererIds,((e,{id:t,excludedRowRendererIds:a})=>({...e,timelineById:Object(Ww.l)({id:t,excludedRowRendererIds:a,timelineById:e.timelineById})}))).case(k.updateTimeline,((e,{id:t,timeline:a})=>({...e,timelineById:{...e.timelineById,[t]:a}}))).case(k.unPinEvent,((e,{id:t,eventId:a})=>({...e,timelineById:Object(Ww.k)({id:t,eventId:a,timelineById:e.timelineById})}))).case(k.updateEventType,((e,{id:t,eventType:a})=>({...e,timelineById:Object(Ww.q)({id:t,eventType:a,timelineById:e.timelineById})}))).case(k.updateIsFavorite,((e,{id:t,isFavorite:a})=>({...e,timelineById:Object(Ww.r)({id:t,isFavorite:a,timelineById:e.timelineById})}))).case(k.updateIsLive,((e,{id:t,isLive:a})=>({...e,timelineById:Object(Ww.s)({id:t,isLive:a,timelineById:e.timelineById})}))).case(k.updateKqlMode,((e,{id:t,kqlMode:a})=>({...e,timelineById:Object(Ww.t)({id:t,kqlMode:a,timelineById:e.timelineById})}))).case(k.updateTitleAndDescription,((e,{id:t,title:a,description:n})=>({...e,timelineById:Object(Ww.D)({id:t,title:a,description:n,timelineById:e.timelineById})}))).case(k.updateProviders,((e,{id:t,providers:a})=>({...e,timelineById:Object(Ww.A)({id:t,providers:a,timelineById:e.timelineById})}))).case(k.updateRange,((e,{id:t,start:a,end:n})=>({...e,timelineById:Object(Ww.B)({id:t,start:a,end:n,timelineById:e.timelineById})}))).case(k.updateDataProviderEnabled,((e,{id:t,enabled:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(Ww.v)({id:t,enabled:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(k.updateDataProviderExcluded,((e,{id:t,excluded:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(Ww.w)({id:t,excluded:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(k.dataProviderEdited,((e,{andProviderId:t,excluded:a,field:n,id:i,operator:s,providerId:r,value:o})=>({...e,timelineById:Object(Ww.y)({andProviderId:t,excluded:a,field:n,id:i,operator:s,providerId:r,timelineById:e.timelineById,value:o})}))).case(k.updateDataProviderType,((e,{id:t,type:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(Ww.z)({id:t,type:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(k.updateDataProviderKqlQuery,((e,{id:t,kqlQuery:a,providerId:n})=>({...e,timelineById:Object(Ww.x)({id:t,kqlQuery:a,providerId:n,timelineById:e.timelineById})}))).case(k.updatePageIndex,((e,{id:t,activePage:a})=>({...e,timelineById:Object(Ww.u)({id:t,activePage:a,timelineById:e.timelineById})}))).case(k.updateAutoSaveMsg,((e,{timelineId:t,newTimelineModel:a})=>({...e,autoSavedWarningMsg:{timelineId:t,newTimelineModel:a}}))).case(k.showCallOutUnauthorizedMsg,(e=>({...e,showCallOutUnauthorizedMsg:!0}))).case(k.setSavedQueryId,((e,{id:t,savedQueryId:a})=>({...e,timelineById:Object(Ww.o)({id:t,savedQueryId:a,timelineById:e.timelineById})}))).case(k.setFilters,((e,{id:t,filters:a})=>({...e,timelineById:Object(Ww.m)({id:t,filters:a,timelineById:e.timelineById})}))).case(k.setInsertTimeline,((e,t)=>({...e,insertTimeline:t}))).case(k.updateDataView,((e,{id:t,dataViewId:a,indexNames:n})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],dataViewId:a,indexNames:n}}}))).case(k.setActiveTabTimeline,((e,{id:t,activeTab:a,scrollToTop:n})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],activeTab:a,prevActiveTab:e.timelineById[t].activeTab,scrollToTop:n?{timestamp:Math.floor(Date.now()/1e3)}:void 0}}}))).case(k.toggleModalSaveTimeline,((e,{id:t,showModalSaveTimeline:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],showSaveModal:a}}}))).case(k.updateEqlOptions,((e,{id:t,field:a,value:n})=>{var i;return{...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],eqlOptions:{...null!==(i=e.timelineById[t].eqlOptions)&&void 0!==i?i:{},[a]:n}}}}})).case(k.setInsertTimeline,((e,t)=>({...e,insertTimeline:t}))).case(k.showTimeline,((e,{id:t,show:a})=>({...e,timelineById:Object(Ww.C)({id:t,show:a,timelineById:e.timelineById})}))).case(k.setTimelineUpdatedAt,((e,{id:t,updated:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],updated:a}}}))).build();var Jw=a(209),Yw=a(14),Xw=a(189),Zw=a(312),eO=a(270),tO=a(875),aO=a(879);const nO=N.i18n.translate("xpack.securitySolution.endpointDetails.overview",{defaultMessage:"Overview"}),iO={tabTitle:N.i18n.translate("xpack.securitySolution.endpointDetails.responseActionsHistory",{defaultMessage:"Response actions history"}),LogEntry:{endOfLog:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.endOfLog",{defaultMessage:"Nothing more to show"}),dateRangeMessage:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.dateRangeMessage.title",{defaultMessage:"Nothing to show for selected date range, please select another and try again."}),emptyState:{title:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.emptyState.title",{defaultMessage:"No logged actions"}),body:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.emptyState.body",{defaultMessage:"No actions have been logged for this endpoint."})},action:{isolatedAction:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.isolated",{defaultMessage:"submitted request: Isolate host"}),unisolatedAction:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.unisolated",{defaultMessage:"submitted request: Release host"}),failedEndpointReleaseAction:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.failedEndpointReleaseAction",{defaultMessage:"failed to submit request: Release host"}),failedEndpointIsolateAction:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.failedEndpointIsolateAction",{defaultMessage:"failed to submit request: Isolate host"})},response:{isolationCompletedAndSuccessful:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationCompletedAndSuccessful",{defaultMessage:"Host isolation request completed by Endpoint"}),isolationCompletedAndUnsuccessful:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationCompletedAndUnsuccessful",{defaultMessage:"Host isolation request completed by Endpoint with errors"}),unisolationCompletedAndSuccessful:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationCompletedAndSuccessful",{defaultMessage:"Release request completed by Endpoint"}),unisolationCompletedAndUnsuccessful:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationCompletedAndUnsuccessful",{defaultMessage:"Release request completed by Endpoint with errors"}),isolationSuccessful:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationSuccessful",{defaultMessage:"Host isolation request received by Endpoint"}),isolationFailed:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationFailed",{defaultMessage:"Host isolation request received by Endpoint with errors"}),unisolationSuccessful:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationSuccessful",{defaultMessage:"Release host request received by Endpoint"}),unisolationFailed:N.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationFailed",{defaultMessage:"Release host request received by Endpoint with errors"})}}};var sO=a(570);const rO=i.a.memo((()=>{const e=Object(Zw.b)(eO.detailsData),t=Object(Zw.a)(e),[a,s]=Object(n.useState)(!1),r=Object(n.useCallback)((()=>{s(!1)}),[]),o=Object(n.useMemo)((()=>t.map((e=>i.a.createElement(sO.a,yn()({},e,{onClick:t=>{r(),e.onClick&&e.onClick(t)}}))))),[r,t]),l=Object(n.useMemo)((()=>i.a.createElement(B.EuiButton,{iconSide:"right",fill:!0,iconType:"arrowDown","data-test-subj":"endpointDetailsActionsButton",onClick:()=>{s(!a)}},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.detailsActions.buttonLabel",defaultMessage:"Take action"}))),[a]);return i.a.createElement(B.EuiPopover,{id:"endpointDetailsActionsPanel",button:l,isOpen:a,closePopover:r,panelPaddingSize:"none",anchorPosition:"downLeft","data-test-subj":"endpointDetailsActionsPopover"},i.a.createElement(B.EuiContextMenuPanel,{size:"s",items:o}))}));rO.displayName="ActionMenu";var oO=a(675),lO=a(362);const cO=Object(n.memo)((({hostMeta:e})=>{const t=Object(P.useHistory)(),a=Object(o.useDispatch)(),{show:s,...r}=Object(Zw.b)(eO.uiQueryParams),l=Object(Zw.b)(eO.getIsEndpointHostIsolated),c=Object(Zw.b)(eO.getIsIsolationRequestPending),u=Object(Zw.b)(eO.getWasIsolationRequestSuccessful),d=Object(Zw.b)(eO.getIsolationRequestError),[p,m]=Object(n.useState)({comment:""}),g=l?lO.e:lO.c,f=Object(n.useCallback)((()=>{t.push(Object(b.d)({name:"endpointDetails",...r,selected_endpoint:e.agent.id}))}),[t,e.agent.id,r]),h=Object(n.useCallback)((()=>{a({type:"endpointIsolationRequest",payload:{type:l?"unisolate":"isolate",data:{endpoint_ids:[e.agent.id],comment:p.comment}}})}),[a,p.comment,e.agent.id,l]),y=Object(n.useCallback)((e=>{m((t=>({...t,...e})))}),[]);return i.a.createElement(i.a.Fragment,null,u&&i.a.createElement(lO.d,{hostName:e.host.name,isolateAction:l?"unisolateHost":"isolateHost"}),i.a.createElement(B.EuiFlyoutBody,null,u?i.a.createElement(lO.a,{onClick:f,buttonText:N.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.successProceedButton",{defaultMessage:"Return to endpoint details"})}):i.a.createElement(B.EuiForm,{isInvalid:!!d,error:null==d?void 0:d.message,"data-test-subj":"endpointIsolationForm"},i.a.createElement(g,{comment:p.comment,isLoading:c,hostName:e.host.name,onCancel:f,onConfirm:h,onChange:y}))))}));cO.displayName="EndpointIsolateFlyoutPanel";var uO=a(699);const dO=(e,t)=>!(!t||!e.id||e.id===t.endpoint.id&&t.agent.configured.id===t.agent.applied.id&&e.version>=t.agent.applied.revision&&e.version>=t.agent.configured.revision&&e.endpoint_policy_version>=t.endpoint.revision);var pO=a(649),mO=a(415);const gO=Object(n.memo)((({policyId:e,backLink:t,children:a,missingPolicies:s={},...r})=>{const{getAppUrl:o}=Object(gs.b)(),{toRoutePath:l,toRouteUrl:c}=Object(n.useMemo)((()=>{const a=e?Object(b.j)(e):"";return{toRoutePath:t?{pathname:a,state:{backLink:t}}:a,toRouteUrl:o({path:a})}}),[e,o,t]),u=Object(mO.a)(l);return!e||s[e]?i.a.createElement("span",{className:r.className,"data-test-subj":r["data-test-subj"]},a,i.a.createElement(B.EuiText,{color:"subdued",size:"xs",className:"eui-textNoWrap"},i.a.createElement(B.EuiIcon,{size:"m",type:"alert",color:"warning"})," ",i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyNotFound",defaultMessage:"Policy not found!"}))):i.a.createElement(B.EuiLink,yn()({href:c,onClick:u},r),a)}));gO.displayName="EndpointPolicyLink";const fO=i.a.memo((({style:e,...t})=>i.a.createElement(B.EuiText,yn()({color:"subdued",size:"xs",className:"eui-textNoWrap eui-displayInlineBlock",style:e},t),i.a.createElement(B.EuiIcon,{className:"eui-alignTop",size:"m",type:"alert",color:"warning"}),i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.outOfDateLabel",defaultMessage:"Out-of-date"}))));fO.displayName="OutOfDate";var bO=a(561);const hO=H()(B.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-4x4obe-0"})([".isolation-status{margin-left:",";}"],(({theme:e})=>e.eui.euiSizeS)),yO=Object(n.memo)((({endpointMetadata:e,hostStatus:t})=>{const a=Object(Zw.b)(eO.getEndpointHostIsolationStatusPropsCallback);return i.a.createElement(hO,{gutterSize:"none",responsive:!1,className:"eui-textTruncate"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(bO.a,{hostStatus:t})),i.a.createElement(B.EuiFlexItem,{grow:!1,className:"eui-textTruncate isolation-status"},i.a.createElement(lO.b,yn()({"data-test-subj":"rowIsolationStatus"},a(e)))))}));yO.displayName="EndpointAgentStatus";const EO=H.a.div.withConfig({displayName:"EndpointDetailsContentStyled",componentId:"sc-2wf17-0"})(["dl dt{max-width:27%;}dl dd{max-width:73%;}.policyLineText{padding-right:5px;}"]),vO=({children:e})=>i.a.createElement(B.EuiText,{size:"s"},i.a.createElement("h5",null,e)),kO=Object(n.memo)((({details:e,policyInfo:t,hostStatus:a})=>{const s=Object(Zw.b)(eO.uiQueryParams),r=Object(Zw.b)(eO.policyResponseStatus),o=Object(Zw.b)(eO.nonExistingPolicies),l=Object(n.useMemo)((()=>{const{selected_endpoint:t,show:a,...n}=s;return Object(b.d)({name:"endpointPolicyResponse",...n,selected_endpoint:e.agent.id})}),[e.agent.id,s]),c=Object(mO.a)(l),u=Object(n.useMemo)((()=>[{title:i.a.createElement(vO,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.os",defaultMessage:"OS"})),description:i.a.createElement(B.EuiText,{size:"xs"},e.host.os.full)},{title:i.a.createElement(vO,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.agentStatus",defaultMessage:"Agent Status"})),description:i.a.createElement(yO,{hostStatus:a,endpointMetadata:e})},{title:i.a.createElement(vO,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.lastSeen",defaultMessage:"Last Seen"})),description:i.a.createElement(B.EuiText,{size:"xs"},i.a.createElement(Ba.a,{value:e["@timestamp"],fieldName:""}))},{title:i.a.createElement(vO,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policy",defaultMessage:"Policy"})),description:i.a.createElement(B.EuiText,{size:"xs",className:"eui-textBreakWord"},i.a.createElement(gO,{policyId:e.Endpoint.policy.applied.id,"data-test-subj":"policyDetailsValue",className:"policyLineText",missingPolicies:o},e.Endpoint.policy.applied.name),e.Endpoint.policy.applied.endpoint_policy_version&&i.a.createElement(B.EuiText,{color:"subdued",size:"xs",className:"eui-displayInlineBlock eui-textNoWrap policyLineText","data-test-subj":"policyDetailsRevNo"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policy.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:e.Endpoint.policy.applied.endpoint_policy_version}})),dO(e.Endpoint.policy.applied,t)&&i.a.createElement(fO,null))},{title:i.a.createElement(vO,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policyStatus",defaultMessage:"Policy Status"})),description:i.a.createElement(B.EuiHealth,{"data-test-subj":`policyStatusValue-${r}`,color:pO.b[r]||"default"},i.a.createElement(B.EuiLink,{onClick:c,"data-test-subj":"policyStatusValue"},i.a.createElement(B.EuiText,{size:"xs"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policyStatusValue",defaultMessage:"{policyStatus, select, success {Success} warning {Warning} failure {Failed} other {Unknown}}",values:{policyStatus:r}}))))},{title:i.a.createElement(vO,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.endpointVersion",defaultMessage:"Endpoint Version"})),description:i.a.createElement(B.EuiText,{size:"xs"},e.agent.version)},{title:i.a.createElement(vO,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.ipAddress",defaultMessage:"IP Address"})),description:i.a.createElement(B.EuiFlexGroup,{direction:"column",gutterSize:"s"},e.host.ip.map(((e,t)=>i.a.createElement(B.EuiFlexItem,{key:t},i.a.createElement(B.EuiText,{size:"xs"},e)))))}]),[e,a,r,c,t,o]);return i.a.createElement(EO,null,i.a.createElement(B.EuiSpacer,{size:"s"}),i.a.createElement(B.EuiDescriptionList,{compressed:!0,type:"column",listItems:u,"data-test-subj":"endpointDetailsList"}))}));kO.displayName="EndpointDetailsContent";const SO=Object(n.memo)((()=>{var e;const t=Object(u.o)(),a=Object(Zw.b)(eO.uiQueryParams),s=Object(Zw.b)(eO.detailsData),r=Object(Zw.b)(eO.detailsError),o=Object(Zw.b)(eO.policyVersionInfo),l=Object(Zw.b)(eO.hostStatusInfo),c=Object(Zw.b)(eO.showView),d=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiLoadingContent,{lines:3}),i.a.createElement(B.EuiSpacer,{size:"l"}),i.a.createElement(B.EuiLoadingContent,{lines:3}))),[]),p=Object(n.useCallback)((e=>[{id:oO.b.overview,name:nO,route:Object(b.d)({...a,name:"endpointDetails",selected_endpoint:e}),content:void 0===s?d:i.a.createElement(kO,{details:s,policyInfo:o,hostStatus:l})},{id:oO.b.activityLog,name:iO.tabTitle,route:Object(b.d)({...a,name:"endpointActivityLog",selected_endpoint:e}),content:i.a.createElement(tO.a,{agentIds:e})}]),[d,s,o,l,a]),m="details"===c||"policy_response"===c||"activity_log"===c;return Object(n.useEffect)((()=>{void 0!==r&&t.addDanger({title:N.i18n.translate("xpack.securitySolution.endpoint.details.errorTitle",{defaultMessage:"Could not find host"}),text:N.i18n.translate("xpack.securitySolution.endpoint.details.errorBody",{defaultMessage:"Please exit the flyout and select an available host."})})}),[r,c,t]),i.a.createElement(i.a.Fragment,null,("policy_response"===c||"isolate"===c||"unisolate"===c)&&i.a.createElement(uO.a,{hasBorder:!0,endpointId:null==s?void 0:s.agent.id,hostname:null==s||null===(e=s.host)||void 0===e?void 0:e.hostname}),void 0===s?i.a.createElement(B.EuiFlyoutBody,null,i.a.createElement(B.EuiLoadingContent,{lines:3})," ",i.a.createElement(B.EuiSpacer,{size:"l"})," ",i.a.createElement(B.EuiLoadingContent,{lines:3})):i.a.createElement(i.a.Fragment,null,("details"===c||"activity_log"===c)&&i.a.createElement(oO.a,{hostname:s.host.hostname,show:c,tabs:p(s.agent.id)}),"policy_response"===c&&i.a.createElement(TO,{hostMeta:s}),("isolate"===c||"unisolate"===c)&&i.a.createElement(cO,{hostMeta:s}),m&&i.a.createElement(B.EuiFlyoutFooter,{className:"eui-textRight","data-test-subj":"endpointDetailsFlyoutFooter"},i.a.createElement(rO,null))))}));SO.displayName="EndpointDetails";const TO=Object(n.memo)((({hostMeta:e})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiFlyoutBody,{"data-test-subj":"endpointDetailsPolicyResponseFlyoutBody",className:"endpointDetailsPolicyResponseFlyoutBody"},i.a.createElement(aO.a,{endpointId:e.agent.id})))));TO.displayName="PolicyResponseFlyoutPanel";const xO=Object(n.memo)((()=>{const e=Object(P.useHistory)(),t=Object(Zw.b)(eO.uiQueryParams),{selected_endpoint:a,...s}=t,r=Object(n.useCallback)((()=>{const{show:t,...a}=s;e.push(Object(b.e)({name:"endpointList",...a}))}),[e,s]);return i.a.createElement(B.EuiFlyout,{onClose:r,"data-test-subj":"endpointDetailsFlyout",size:"m",paddingSize:"l",ownFocus:!1},i.a.createElement(SO,null))}));xO.displayName="EndpointDetailsFlyout";var wO=a(1196),OO=a.n(wO);const jO=Object.freeze({textAlign:"center"}),IO=Object.freeze({maxWidth:550,maxHeight:420}),CO=i.a.memo((({loading:e,onActionClick:t,actionDisabled:a,policyEntryPoint:n=!1})=>{const s=Object(u.k)().services.docLinks;return i.a.createElement("div",{"data-test-subj":"emptyPolicyTable"},e?i.a.createElement(B.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiLoadingSpinner,{size:"xl",className:"essentialAnimation"}))):i.a.createElement(B.EuiFlexGroup,{"data-test-subj":"policyOnboardingInstructions",alignItems:"center"},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(B.EuiText,null,i.a.createElement("h1",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingTitle",defaultMessage:"Get started with Elastic Defend"}))),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiText,{size:"s",color:"subdued"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionOne",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiText,{size:"s",color:"subdued"},n?i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionTwo.fromPolicyPage",defaultMessage:"From this page, you’ll be able to view and manage the Elastic Defend Integration policies in your environment running Elastic Defend."}):i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionTwo.fromEndpointPage",defaultMessage:"From this page, you’ll be able to view and manage the hosts in your environment running Elastic Defend."})),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiText,{size:"s",color:"subdued"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionThree",defaultMessage:"To get started, add the Elastic Defend integration to your Agents. For more information, "}),i.a.createElement(B.EuiLink,{external:!0,href:`${s.links.siem.guide}`},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingDocsLink",defaultMessage:"view the Elastic Security documentation"}))),i.a.createElement(B.EuiSpacer,{size:"l"}),i.a.createElement(B.EuiFlexGroup,null,i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:t,isDisabled:a,"data-test-subj":"onboardingStartButton"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.actionButtonText",defaultMessage:"Add Elastic Defend"}))))),i.a.createElement(B.EuiFlexItem,{grow:2},i.a.createElement(B.EuiIcon,{type:OO.a,size:"original",style:IO}))))})),MO=i.a.memo((({loading:e,onActionClick:t,actionDisabled:a,handleSelectableOnChange:s,selectionOptions:r})=>{const o=Object(n.useMemo)((()=>[{title:N.i18n.translate("xpack.securitySolution.endpoint.list.stepOneTitle",{defaultMessage:"Select the integration you want to use"}),children:i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiText,{color:"subdued",size:"m",grow:!1},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.stepOne",defaultMessage:"Select from existing integrations. This can be changed later."})),i.a.createElement(B.EuiSpacer,{size:"xxl"}),i.a.createElement(B.EuiSelectable,{options:r,singleSelection:"always",isLoading:e,height:100,listProps:{bordered:!0,singleSelection:!0},onChange:s,"data-test-subj":"onboardingPolicySelect"},(t=>e?i.a.createElement(B.EuiSelectableMessage,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.loadingPolicies",defaultMessage:"Loading integrations"})):r.length?t:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noPolicies",defaultMessage:"There are no integrations."}))))},{title:N.i18n.translate("xpack.securitySolution.endpoint.list.stepTwoTitle",{defaultMessage:"Enroll your agents enabled with Elastic Defend through Fleet"}),status:a?"disabled":"",children:i.a.createElement(B.EuiFlexGroup,{alignItems:"center"},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(B.EuiText,{color:"subdued",size:"m",grow:!1},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.stepTwo",defaultMessage:"You’ll be provided with the necessary commands to get started."}))),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{fill:!0,onClick:t,isDisabled:a,"data-test-subj":"onboardingStartButton"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.emptyCreateNewButton",defaultMessage:"Enroll Agent"}))))}]),[r,s,e,a,t]);return i.a.createElement(DO,{loading:e,dataTestSubj:"emptyHostsTable",steps:o,headerComponent:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noEndpointsPrompt",defaultMessage:"Next step: Enroll an Agent with Elastic Defend"}),bodyComponent:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noEndpointsInstructions",defaultMessage:"You’ve added the Elastic Defend integration. Now enroll your agents using the steps below."})})})),DO=i.a.memo((({loading:e,dataTestSubj:t,steps:a,headerComponent:n,bodyComponent:s})=>i.a.createElement("div",{"data-test-subj":t},e?i.a.createElement(B.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiLoadingSpinner,{size:"xl",className:"essentialAnimation"}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,{size:"xxl"}),i.a.createElement(B.EuiTitle,{size:"m"},i.a.createElement("h2",{style:jO},n)),i.a.createElement(B.EuiSpacer,{size:"xxl"}),i.a.createElement(B.EuiText,{textAlign:"center",color:"subdued",size:"m"},s),i.a.createElement(B.EuiSpacer,{size:"xxl"}),a&&i.a.createElement(B.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiSteps,{steps:a,"data-test-subj":"onboardingSteps"})))))));CO.displayName="PolicyEmptyState",MO.displayName="HostsEmptyState",DO.displayName="ManagementEmptyState";var AO=a(188),FO=a(369),RO=a.n(FO),PO=a(385);const _O=Object(n.memo)((()=>{const e=Object(P.useHistory)(),{admin_query:t,...a}=Object(Zw.b)(eO.uiQueryParams),s=Object(Zw.b)(eO.patterns),r=Object(Zw.b)(eO.searchBarQuery),o=Object(n.useMemo)((()=>s.map((e=>{return t=e,Object(PO.all)([t]);var t}))),[s]),l=Object(n.useCallback)((t=>{var n,i;e.push(function(e){return{search:RO.a.stringify(e)}}({...a,page_index:(null===(n=t.query)||void 0===n?void 0:n.query)===r.query?a.page_index:"0",...null!==(i=t.query)&&void 0!==i&&i.query.trim()?{admin_query:Object(zc.encode)(t.query)}:{}}))}),[e,a,r.query]),c=Object(n.useMemo)((()=>new xh.TimeHistory(new Bc.Storage(localStorage))),[]);return i.a.createElement("div",null,s&&s.length>0&&i.a.createElement("div",null,i.a.createElement(AO.SearchBar,{dataTestSubj:"adminSearchBar",query:r,indexPatterns:o,timeHistory:c,onQuerySubmit:l,fillSubmitButton:!0,isLoading:!1,iconType:"search",showFilterBar:!1,showDatePicker:!1,showQueryBar:!0,showQueryInput:!0})))}));_O.displayName="AdminSearchBar";var qO=a(569),NO=a(339);const LO=Object(n.memo)((({endpointMetadata:e})=>{const[t,a]=Object(n.useState)(!1),s=Object(Zw.a)(e,{isEndpointList:!0}),r=Object(n.useCallback)((()=>a(!1)),[a]),o=Object(n.useCallback)((()=>a(!t)),[t]),l=Object(n.useMemo)((()=>s.map((e=>i.a.createElement(sO.a,yn()({},e,{onClick:t=>{r(),e.onClick&&e.onClick(t)}}))))),[r,s]),c=Object(n.useMemo)((()=>({"data-test-subj":"tableRowActionsMenuPanel"})),[]);return i.a.createElement(B.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:c,button:i.a.createElement(B.EuiButtonIcon,{"data-test-subj":"endpointTableRowActions",iconType:"boxesHorizontal",onClick:o,"aria-label":N.i18n.translate("xpack.securitySolution.endpoint.list.actionmenu",{defaultMessage:"Open"})}),isOpen:t,closePopover:r},i.a.createElement(B.EuiContextMenuPanel,{items:l}))}));LO.displayName="EndpointTableRowActions";var BO=a(288),zO=a(657),HO=a(518);const $O=H.a.div.withConfig({displayName:"StyledDatePicker",componentId:"sc-1m5xywg-0"})([".euiFormControlLayout--group{background-color:rgba(0,119,204,0.2);}.euiDatePickerRange--readOnly{background-color:",";}"],(e=>e.theme.eui.euiFormBackgroundColor)),VO=Object(n.memo)((({name:e,href:t,route:a,dataTestSubj:n})=>{const s=Object(mO.a)(a);return i.a.createElement(B.EuiLink,{"data-test-subj":n,className:"eui-displayInline eui-textTruncate",href:t,onClick:s},e)}));VO.displayName="EndpointListNavLink";const UO=Object(Yw.createStructuredSelector)(eO),QO=()=>{var e,t;const a=Object(P.useHistory)(),{services:s}=Object(_.useKibana)(),{listData:l,pageIndex:u,pageSize:d,totalHits:p,listLoading:m,listError:g,uiQueryParams:f,hasSelectedEndpoint:h,policyItems:y,selectedPolicyId:E,policyItemsLoading:k,endpointPackageVersion:S,endpointsExist:T,autoRefreshInterval:x,isAutoRefreshEnabled:w,patternsError:O,areEndpointsEnrolling:j,agentsWithEndpointsTotalError:I,endpointsTotalError:C,metadataTransformStats:M}=Object(Zw.b)(UO),{search:D}=Object(c.l)(v.a.administration),{search:A}=Object(P.useLocation)(),{getAppUrl:F}=Object(gs.b)(),R=Object(o.useDispatch)(),q=p>9999?9999:p,[L,z]=Object(n.useState)(!1),[H,$]=Object(n.useState)(!0),{state:V={}}=Object(P.useLocation)(),U=Object(n.useMemo)((()=>{if(null!=V&&V.backLink)return{onBackButtonNavigateTo:V.backLink.navigateTo,backButtonLabel:V.backLink.label,backButtonUrl:V.backLink.href};const e=Object(b.h)();return{backButtonLabel:N.i18n.translate("xpack.securitySolution.endpoint.list.backToPolicyButton",{defaultMessage:"Back to policy list"}),backButtonUrl:F({path:e}),onBackButtonNavigateTo:[r.A,{path:e}]}}),[F,null==V?void 0:V.backLink]),Q=i.a.createElement(zO.a,yn()({},U,{"data-test-subj":"endpointListBackLink"}));Object(n.useEffect)((()=>{H&&y&&y.length&&(R({type:"loadMetadataTransformStats"}),$(!1))}),[y,H,R]),Object(n.useEffect)((()=>{const e=M.some((e=>r.Gc.has(null==e?void 0:e.state)));z(e)}),[M]);const W=Object(n.useCallback)((()=>{z(!1)}),[]),G=Object(n.useMemo)((()=>({pageIndex:u,pageSize:d,totalItemCount:q,pageSizeOptions:[...Jw.f],showPerPageOptions:!0})),[u,d,q]),K=Object(n.useCallback)((({page:e})=>{const{index:t,size:n}=e;a.push(Object(b.e)({name:"endpointList",...f,page_index:JSON.stringify(t),page_size:JSON.stringify(n)}))}),[a,f]),J=Object(Eh.a)("fleet",{path:`/integrations/${S?`/endpoint-${S}`:""}/add-integration`,state:{onCancelNavigateTo:[r.A,{path:Object(b.e)({name:"endpointList"})}],onCancelUrl:F({path:Object(b.e)({name:"endpointList"})}),onSaveNavigateTo:[r.A,{path:Object(b.e)({name:"endpointList"})}]}}),Y=Object(n.useMemo)((()=>{const e=Object(b.e)({name:"endpointList"},A);return{navigateTo:[r.A,{path:e}],label:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.backToListTitle",{defaultMessage:"View all endpoints"}),href:F({path:e})}}),[F,A]),X=Object(n.useCallback)((()=>{R({type:"appRequestedEndpointList"})}),[R]),Z=Object(n.useCallback)((e=>{R({type:"userUpdatedEndpointListRefreshOptions",payload:{isAutoRefreshEnabled:!e.isPaused,autoRefreshInterval:e.refreshInterval}})}),[R]),ee=Object(n.useCallback)((()=>{}),[]),te=Object(n.useMemo)((()=>({paddingLeft:"6px"})),[]),ae=Object(Eh.a)("fleet",{path:`/policies/${E}?openEnrollmentFlyout=true`,state:{onDoneNavigateTo:[r.A,{path:Object(b.e)({name:"endpointList"})}]}}),ne=Object(n.useMemo)((()=>y.map((e=>({key:e.policy_id,label:e.name,checked:E===e.policy_id?"on":void 0})))),[y,E]),ie=Object(n.useCallback)((e=>e.some((e=>"checked"in e&&"on"===e.checked&&(R({type:"userSelectedEndpointPolicy",payload:{selectedPolicyId:e.key}}),!0)))),[R]),se=Object(n.useCallback)((e=>({"data-endpoint-id":e.metadata.agent.id})),[]),re=Object(n.useMemo)((()=>{const e=N.i18n.translate("xpack.securitySolution.endpoint.list.lastActive",{defaultMessage:"Last active"});return[{field:"metadata",width:"15%",name:N.i18n.translate("xpack.securitySolution.endpoint.list.hostname",{defaultMessage:"Endpoint"}),render:({host:{hostname:e},agent:{id:t}})=>{const a=Object(b.d)({...f,name:"endpointDetails",selected_endpoint:t},D),n=F({path:a});return i.a.createElement(B.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(VO,{name:e,href:n,route:a,dataTestSubj:"hostnameCellLink"}))}},{field:"host_status",width:"14%",name:N.i18n.translate("xpack.securitySolution.endpoint.list.hostStatus",{defaultMessage:"Agent status"}),render:(e,t)=>i.a.createElement(yO,{hostStatus:e,endpointMetadata:t.metadata})},{field:"metadata.Endpoint.policy.applied",width:"15%",name:N.i18n.translate("xpack.securitySolution.endpoint.list.policy",{defaultMessage:"Policy"}),truncateText:!0,render:(e,t)=>i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},i.a.createElement(gO,{policyId:e.id,className:"eui-textTruncate","data-test-subj":"policyNameCellLink",backLink:Y},e.name)),e.endpoint_policy_version&&i.a.createElement(B.EuiText,{color:"subdued",size:"xs",style:{whiteSpace:"nowrap",...te},className:"eui-textTruncate","data-test-subj":"policyListRevNo"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.policy.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:e.endpoint_policy_version}})),dO(e,t.policy_info)&&i.a.createElement(fO,{style:te,"data-test-subj":"rowPolicyOutOfDate"}))},{field:"metadata.Endpoint.policy.applied",width:"9%",name:N.i18n.translate("xpack.securitySolution.endpoint.list.policyStatus",{defaultMessage:"Policy status"}),render:(e,t)=>{const a=Object(b.d)({name:"endpointPolicyResponse",...f,selected_endpoint:t.metadata.agent.id}),n=F({path:a});return i.a.createElement(B.EuiToolTip,{content:pO.d[e.status],anchorClassName:"eui-textTruncate"},i.a.createElement(B.EuiHealth,{color:pO.c[e.status],className:"eui-textTruncate eui-fullWidth","data-test-subj":"rowPolicyStatus"},i.a.createElement(VO,{name:pO.d[e.status],href:n,route:a,dataTestSubj:"policyStatusCellLink"})))}},{field:"metadata.host.os.name",width:"9%",name:N.i18n.translate("xpack.securitySolution.endpoint.list.os",{defaultMessage:"OS"}),render:e=>i.a.createElement(B.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(B.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},i.a.createElement("p",{className:"eui-displayInline eui-TextTruncate"},e)))},{field:"metadata.host.ip",width:"12%",name:N.i18n.translate("xpack.securitySolution.endpoint.list.ip",{defaultMessage:"IP address"}),render:e=>i.a.createElement(B.EuiToolTip,{content:e.toString().replace(",",", "),anchorClassName:"eui-textTruncate"},i.a.createElement(B.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},i.a.createElement("p",{className:"eui-displayInline eui-textTruncate"},e.toString().replace(",",", "))))},{field:"metadata.agent.version",width:"9%",name:N.i18n.translate("xpack.securitySolution.endpoint.list.endpointVersion",{defaultMessage:"Version"}),render:e=>i.a.createElement(B.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(B.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},i.a.createElement("p",{className:"eui-displayInline eui-TextTruncate"},e)))},{field:"metadata.@timestamp",name:e,width:"9%",render:t=>i.a.createElement(Ba.a,{fieldName:e,value:t,className:"eui-textTruncate"})},{field:"",width:"8%",name:N.i18n.translate("xpack.securitySolution.endpoint.list.actions",{defaultMessage:"Actions"}),actions:[{render:e=>i.a.createElement(LO,{endpointMetadata:e.metadata})}]}]}),[f,D,F,Y,te]),oe=Object(n.useMemo)((()=>T||j?i.a.createElement(B.EuiBasicTable,{"data-test-subj":"endpointListTable",items:[...l],columns:re,error:null==g?void 0:g.message,pagination:G,onChange:K,loading:m,rowProps:se}):!k&&y&&y.length>0?i.a.createElement(MO,{loading:m,onActionClick:ae,actionDisabled:void 0===E,handleSelectableOnChange:ie,selectionOptions:ne}):i.a.createElement(HO.a,null,i.a.createElement(CO,{loading:k,onActionClick:J}))),[T,j,k,y,l,re,null==g?void 0:g.message,G,K,m,se,ae,E,ie,ne,J]),le=l&&l.length>0,ce=Object(n.useMemo)((()=>({display:T?"flex":"none",maxWidth:200})),[T]),ue=Object(n.useMemo)((()=>!(!T||!h&&w)),[T,h,w]),de=Object(n.useMemo)((()=>T?x:Jw.a),[T,x]),pe=Object(n.useMemo)((()=>!(!C&&!I)),[C,I]),me=Object(n.useMemo)((()=>T&&!O),[T,O]),ge=Object(n.useMemo)((()=>{var e;const t=M.filter((e=>r.Gc.has(e.state))).map((e=>e.id)).join(", ");return i.a.createElement(i.a.Fragment,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.message",defaultMessage:"A required transform, {transformId}, is currently failing. Most of the time this can be fixed by {transformsPage}. For additional help, please visit the {docsPage}",values:{transformId:t||BO.p,transformsPage:i.a.createElement(NO.a,{"data-test-subj":"failed-transform-restart-link",appId:"management",appPath:"/data/transform"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.restartLink",defaultMessage:"restarting the transform"})),docsPage:i.a.createElement(B.EuiLink,{"data-test-subj":"failed-transform-docs-link",href:null==s||null===(e=s.docLinks)||void 0===e?void 0:e.links.endpoints.troubleshooting,target:"_blank"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.docsLink",defaultMessage:"troubleshooting documentation"}))}}),i.a.createElement(B.EuiSpacer,{size:"s"}))}),[M,null==s||null===(e=s.docLinks)||void 0===e?void 0:e.links.endpoints.troubleshooting]),fe=Object(n.useMemo)((()=>{if(L)return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ju.a,{message:{id:"endpoints-list-transform-failed",type:"warning",title:N.i18n.translate("xpack.securitySolution.endpoint.list.transformFailed.title",{defaultMessage:"Required transform failed"}),description:ge},dismissButtonText:N.i18n.translate("xpack.securitySolution.endpoint.list.transformFailed.dismiss",{defaultMessage:"Dismiss"}),onDismiss:W,showDismissButton:!0}),i.a.createElement(B.EuiSpacer,{size:"m"}))}),[L,W,ge]);return i.a.createElement(qO.a,{"data-test-subj":"endpointPage",hideHeader:!(T||j),title:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.pageTitle",defaultMessage:"Endpoints"}),subtitle:i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.pageSubTitle",defaultMessage:"Hosts running Elastic Defend"}),headerBackComponent:V.backLink&&Q},h&&i.a.createElement(xO,null),i.a.createElement(i.a.Fragment,null,j&&!pe&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiCallOut,{size:"s","data-test-subj":"endpointsEnrollingNotification"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.endpointsEnrolling",defaultMessage:"Endpoints are enrolling. {agentsLink} to track progress.",values:{agentsLink:i.a.createElement(NO.a,{appId:"fleet",appPath:`#${Xw.pagePathGetters.agent_list({kuery:'packages : "endpoint"'})}`,href:`${null==s||null===(t=s.application)||void 0===t?void 0:t.getUrlForApp("fleet")}#${Xw.pagePathGetters.agent_list({kuery:'packages : "endpoint"'})}`},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.endpointsEnrolling.viewAgentsLink",defaultMessage:"View agents"}))}})),i.a.createElement(B.EuiSpacer,{size:"m"})),fe,i.a.createElement(B.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},me&&i.a.createElement(B.EuiFlexItem,null,i.a.createElement(_O,null)),i.a.createElement(B.EuiFlexItem,{grow:!1,style:ce},i.a.createElement($O,null,i.a.createElement(B.EuiSuperDatePicker,{className:"endpointListDatePicker",onTimeChange:ee,isDisabled:h,onRefresh:X,isPaused:ue,refreshInterval:de,onRefreshChange:Z,isAutoRefreshOnly:!0})))),i.a.createElement(B.EuiSpacer,{size:"m"})),le&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiText,{color:"subdued",size:"xs","data-test-subj":"endpointListTableTotal"},p>1e4?i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.totalCount.limited",defaultMessage:"Showing {limit} of {totalItemCount, plural, one {# endpoint} other {# endpoints}}",values:{totalItemCount:p,limit:1e4}}):i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.totalCount",defaultMessage:"Showing {totalItemCount, plural, one {# endpoint} other {# endpoints}}",values:{totalItemCount:p}})),i.a.createElement(B.EuiHorizontalRule,{margin:"xs"})),oe)},WO=Object(n.memo)((()=>i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:Jw.h,exact:!0,component:QO}),i.a.createElement(_.Route,{path:"*",component:q.a}))));WO.displayName="EndpointsContainer";var GO=a(434),KO=a(571);const JO=Object(n.memo)((({policyId:e,nonLinkCondition:t,"data-test-subj":a,children:s,...o})=>{const l=`(language:kuery,query:'united.endpoint.Endpoint.policy.applied.id : "${e}"')`,{search:c}=Object(P.useLocation)(),{getAppUrl:d}=Object(u.d)(),{toRoutePathWithBackOptions:p,toRouteUrl:m}=Object(n.useMemo)((()=>{const e=Object(b.e)({name:"endpointList",admin_query:l}),t=Object(b.h)(c),a={navigateTo:[r.A,{path:t}],label:N.i18n.translate("xpack.securitySolution.policy.backToPolicyList",{defaultMessage:"Back to policy list"}),href:d({path:t})};return{toRoutePathWithBackOptions:{pathname:Object(b.e)({name:"endpointList"}),search:`?admin_query=${l}`,state:{backLink:a}},toRouteUrl:d({path:e})}}),[d,l,c]),g=Object(mO.a)(p);return t?i.a.createElement(B.EuiText,{size:"s","data-test-subj":`${a}_nonLink`},s):i.a.createElement(B.EuiLink,yn()({href:m,"data-test-subj":a,onClick:g},o),s)}));JO.displayName="PolicyEndpointCount";const YO=Object(n.memo)((()=>{const{pagination:e,pageSizeOptions:t,setPagination:a}=Object(GO.b)(),{search:s}=Object(P.useLocation)(),{getAppUrl:o}=Object(u.d)(),l=Object(u.o)(),{data:c,isFetching:d,error:p}=Object(KO.c)({page:e.page,perPage:e.pageSize}),m=Object(n.useMemo)((()=>{var e;return null!==(e=null==c?void 0:c.items.map((e=>e.id)))&&void 0!==e?e:[]}),[c]),g=Object(n.useMemo)((()=>{var e;return null!==(e=null==c?void 0:c.items.map((e=>e.policy_id)))&&void 0!==e?e:[]}),[c]),{data:f={items:[]}}=Object(KO.a)({agentPolicyIds:g,customQueryOptions:{enabled:g.length>0,onError:e=>{l.addDanger(N.i18n.translate("xpack.securitySolution.policyList.endpointCountError",{defaultMessage:"Error retrieving endpoint counts"}))}}}),{data:h,isFetching:y}=Object(KO.b)({customQueryOptions:{enabled:0===g.length,onError:e=>{l.addDanger(N.i18n.translate("xpack.securitySolution.policyList.packageVersionError",{defaultMessage:"Error retrieving the endpoint package version"}))}}}),E=Object(n.useMemo)((()=>{const e=new Map;for(const a of null==f?void 0:f.items)if(a.package_policies)for(const n of a.package_policies){var t;m.includes(n.id)&&e.set(n.id,null!==(t=a.agents)&&void 0!==t?t:0)}if(m.length>0&&0===e.size)for(const t of m)e.set(t,0);return e}),[f,m]),v=Object(n.useMemo)((()=>{var e;return null!==(e=null==c?void 0:c.total)&&void 0!==e?e:0}),[c]),k=Object(n.useMemo)((()=>Object(b.h)(s)),[s]),S=Object(n.useMemo)((()=>({navigateTo:[r.A,{path:k}],label:N.i18n.translate("xpack.securitySolution.policy.backToPolicyList",{defaultMessage:"Back to policy list"}),href:o({path:k})})),[o,k]),T=Object(Eh.a)("fleet",{path:Xw.pagePathGetters.add_integration_to_policy({pkgkey:h?`/endpoint-${null==h?void 0:h.version}`:""})[1],state:{onCancelNavigateTo:[r.A,{path:k}],onCancelUrl:o({path:Object(b.h)()}),onSaveNavigateTo:[r.A,{path:k}]}}),x=Object(n.useMemo)((()=>{const e=N.i18n.translate("xpack.securitySolution.policy.list.updatedAt",{defaultMessage:"Last Updated"}),t=N.i18n.translate("xpack.securitySolution.policy.list.createdAt",{defaultMessage:"Date Created"});return[{field:"",name:N.i18n.translate("xpack.securitySolution.policy.list.name",{defaultMessage:"Name"}),truncateText:!0,render:e=>i.a.createElement(B.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},i.a.createElement(gO,{policyId:e.id,className:"eui-textTruncate","data-test-subj":"policyNameCellLink",backLink:S},e.name))},{field:"created_by",name:N.i18n.translate("xpack.securitySolution.policy.list.createdBy",{defaultMessage:"Created by"}),truncateText:!0,render:e=>i.a.createElement(B.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiAvatar,{name:e,"data-test-subj":"created-by-avatar",size:"s"})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiText,{size:"s","data-test-subj":"created-by-name"},e)))},{field:"created_at",name:t,truncateText:!0,render:e=>i.a.createElement(Ba.a,{fieldName:t,value:e,className:"eui-textTruncate"})},{field:"updated_by",name:N.i18n.translate("xpack.securitySolution.policy.list.lastUpdatedBy",{defaultMessage:"Last updated by"}),truncateText:!0,render:e=>i.a.createElement(B.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiAvatar,{name:e,"data-test-subj":"updated-by-avatar",size:"s"})),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiText,{size:"s","data-test-subj":"updated-by-name"},e)))},{field:"updated_at",name:e,truncateText:!0,render:t=>i.a.createElement(Ba.a,{fieldName:e,value:t,className:"eui-textTruncate"})},{field:"",name:N.i18n.translate("xpack.securitySolution.policy.list.endpoints",{defaultMessage:"Endpoints"}),width:"8%",render:e=>{const t=E.get(e.id);return i.a.createElement(JO,{className:"eui-textTruncate","data-test-subj":"policyEndpointCountLink",policyId:e.id,nonLinkCondition:0===t},t)}}]}),[E,S]),w=Object(n.useCallback)((({page:e})=>{a({page:e.index+1,pageSize:e.size})}),[a]),O=Object(n.useMemo)((()=>({pageIndex:e.page-1,pageSize:e.pageSize,totalItemCount:v,pageSizeOptions:t})),[v,t,e.page,e.pageSize]),j=N.i18n.translate("xpack.securitySolution.policy.list.errorMessage",{defaultMessage:"Error while retrieving list of policies"});return i.a.createElement(qO.a,{"data-test-subj":"policyListPage",hideHeader:0===v,title:N.i18n.translate("xpack.securitySolution.policy.list.title",{defaultMessage:"Policies"}),subtitle:N.i18n.translate("xpack.securitySolution.policy.list.subtitle",{defaultMessage:"Use policies to customize endpoint and cloud workload protections and other configurations"})},v>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiText,{color:"subdued",size:"xs","data-test-subj":"endpointListTableTotal"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.policy.list.totalCount",defaultMessage:"Showing {totalItemCount, plural, one {# policy} other {# policies}}",values:{totalItemCount:v}})),i.a.createElement(B.EuiHorizontalRule,{margin:"xs"}),i.a.createElement(B.EuiBasicTable,{"data-test-subj":"policyListTable",items:(null==c?void 0:c.items)||[],columns:x,pagination:O,onChange:w,loading:d,error:null!==p?j:""})):i.a.createElement(HO.a,null,i.a.createElement(CO,{loading:y,onActionClick:T,policyEntryPoint:!0})))}));YO.displayName="PolicyList";var XO=a(228),ZO=a(231);const ej=Object(n.memo)((e=>{const t=Object(n.useMemo)((()=>[{key:"total",title:N.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.totalTitle",{defaultMessage:"Total agents"}),health:""},{key:"online",title:N.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.onlineTitle",{defaultMessage:"Healthy"}),health:"success"},{key:"error",title:N.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.errorTitle",{defaultMessage:"Unhealthy"}),health:"warning"},{key:"offline",title:N.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.offlineTitle",{defaultMessage:"Offline"}),health:"subdued"}]),[]),a=Object(n.useContext)(z.ThemeContext);return i.a.createElement(B.EuiFlexGroup,{gutterSize:"l",responsive:!1,"data-test-subj":"policyAgentsSummary"},t.map((({key:t,title:n,health:s})=>i.a.createElement(B.EuiFlexItem,{grow:!1,key:t,style:{marginRight:"total"===t?a.eui.gutterTypes.gutterExtraLarge:void 0}},i.a.createElement(B.EuiDescriptionList,{textStyle:"reverse",style:{textAlign:"right"},listItems:[{title:n,description:i.a.createElement(i.a.Fragment,null,s&&i.a.createElement(B.EuiHealth,{color:"warning"===s?a.eui.euiColorWarning:s,className:"eui-alignMiddle"}),i.a.createElement(B.EuiI18nNumber,{value:e[t]}))}]})))))}));ej.displayName="AgentsSummary";var tj=a(567),aj=a(303),nj=a(329);const ij=(e,t,a,i,s)=>{const{getAppUrl:o}=Object(gs.b)(),{toRoutePath:l,toRouteUrl:c}=Object(n.useMemo)((()=>{const e=i(s);return{toRoutePath:e,toRouteUrl:o({path:e})}}),[o,i,s]),u=a(e),d=Object(n.useMemo)((()=>({backButtonLabel:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.backButtonLabel",{defaultMessage:"Back to {policyName} policy",values:{policyName:t}}),onBackButtonNavigateTo:[r.A,{path:u}],backButtonUrl:o({appId:r.A,path:u})})),[o,t,u]);return{onClickHandler:Object(Eh.a)(r.A,{state:d,path:l}),toRouteUrl:c,state:d}},sj=Object(n.memo)((({policyId:e,policyName:t,listId:a,labels:s,getPolicyArtifactsPath:r,getArtifactPath:o})=>{const{canCreateArtifactsByPolicy:l}=Object(iy.a)().endpointPrivileges,{onClickHandler:c,toRouteUrl:u}=ij(e,t,r,o),d=Object(XO.b)(a),p=Object(n.useCallback)((()=>d({show:"list"})),[d]);return i.a.createElement(B.EuiPageTemplate_Deprecated,{template:"centeredContent"},i.a.createElement(B.EuiEmptyPrompt,{iconType:"plusInCircle","data-test-subj":"policy-artifacts-empty-unassigned",title:i.a.createElement("h2",null,s.emptyUnassignedTitle),body:s.emptyUnassignedMessage(t),actions:[...l?[i.a.createElement(B.EuiButton,{color:"primary",fill:!0,onClick:p,"data-test-subj":"assign-artifacts-button"},s.emptyUnassignedPrimaryActionButtonTitle)]:[],i.a.createElement(B.EuiLink,{onClick:c,href:u},s.emptyUnassignedSecondaryActionButtonTitle)]}))}));sj.displayName="PolicyArtifactsEmptyUnassigned";const rj=Object(n.memo)((({policyId:e,policyName:t,labels:a,getPolicyArtifactsPath:n,getArtifactPath:s})=>{const{onClickHandler:r,toRouteUrl:o}=ij(e,t,n,s,{show:"create"});return i.a.createElement(B.EuiPageTemplate_Deprecated,{template:"centeredContent"},i.a.createElement(B.EuiEmptyPrompt,{iconType:"plusInCircle","data-test-subj":"policy-artifacts-empty-unexisting",title:i.a.createElement("h2",null,a.emptyUnexistingTitle),body:a.emptyUnexistingMessage,actions:i.a.createElement(B.EuiButton,{color:"primary",fill:!0,onClick:r,href:o},a.emptyUnexistingPrimaryActionButtonTitle)}))}));rj.displayName="PolicyArtifactsEmptyUnexisting";const oj=Object.freeze({emptyUnassignedTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.title",{defaultMessage:"No assigned artifacts"}),emptyUnassignedMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.content",{defaultMessage:"There are currently no artifacts assigned to {policyName}. Assign artifacts now or add and manage them on the artifacts page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.primaryAction",{defaultMessage:"Assign artifacts"}),emptyUnassignedSecondaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.secondaryAction",{defaultMessage:"Manage artifacts"})}),lj=Object.freeze({emptyUnexistingTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.title",{defaultMessage:"No artifacts exist"}),emptyUnexistingMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.content",{defaultMessage:"There are currently no artifacts applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.action",{defaultMessage:"Add artifacts"})});var cj=a(883),uj=a(763),dj=a(604),pj=a(1016),mj=a(206);const gj=H()(dj.e).withConfig({displayName:"GridHeaderContainer",componentId:"sc-1qje9ej-0"})(["padding-top:0;padding-bottom:",";"],(({theme:e})=>e.eui.euiSizeS)),fj=Object(n.memo)((({"data-test-subj":e,expandAllIconType:t,onExpandCollapseAll:a})=>{const s=Object(mj.a)(e),r=Object(n.useMemo)((()=>i.a.createElement(B.EuiButtonIcon,{"data-test-subj":s("expandCollapseAllButton"),"aria-label":N.i18n.translate("xpack.securitySolution.artifactCardGrid.expandCollapseLabel",{defaultMessage:"{action} all cards",values:{action:"Expand"}}),iconType:t,onClick:()=>a(),style:{marginLeft:"-5px"}})),[s,t,a]);return i.a.createElement(gj,{"data-test-subj":e},i.a.createElement(dj.d,{expanded:!1,expandToggle:r,"data-test-subj":s("layout"),flushTop:!0,name:i.a.createElement(B.EuiText,{size:"xs","data-test-subj":s("name")},i.a.createElement("strong",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.nameColumn",defaultMessage:"Name"}))),description:i.a.createElement(B.EuiText,{size:"xs","data-test-subj":s("description")},i.a.createElement("strong",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.DescriptionColumn",defaultMessage:"Description"}))),effectScope:i.a.createElement(B.EuiText,{size:"xs","data-test-subj":s("assignment")},i.a.createElement("strong",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.assignmentColumn",defaultMessage:"Assignment"}))),actionMenu:!0}))}));fj.displayName="GridHeader";const bj=pj.a,hj=Object(n.memo)((({items:e,cardComponentProps:t,onPageChange:a,onExpandCollapse:s,"data-test-subj":r,...o})=>{const l=Object(mj.a)(r),c=e,u=Object(n.useMemo)((()=>{const e=new Map;for(const a of c)e.set(a,t?t(a):{});return e}),[t,c]),d=Object(n.useCallback)((e=>{const t=[],a=[];for(const[n,i]of u){const s=Boolean(i.expanded);(n===e?!s:s)?t.push(n):a.push(n)}s({expanded:t,collapsed:a})}),[u,s]),p=Object(n.useMemo)((()=>{for(const[e,t]of u)if(!Boolean(t.expanded))return!1;return!0}),[u]),m=Object(n.useCallback)((()=>{let e=[],t=[];p?t=Array.from(u.keys()):e=Array.from(u.keys()),s({expanded:e,collapsed:t})}),[u,s,p]),g=Object(n.useMemo)((()=>{const e=new Map;for(const[a,n]of u){var t;e.set(a,{...n,item:a,onExpandCollapse:()=>d(a),"data-test-subj":null!==(t=n["data-test-subj"])&&void 0!==t?t:l("card")})}return e}),[u,l,d]),f=Object(n.useCallback)((e=>g.get(e)),[g]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(fj,{expandAllIconType:p?"fold":"unfold",onExpandCollapseAll:m,"data-test-subj":l("header")}),i.a.createElement(bj,yn()({},o,{"data-test-subj":r,items:c,ItemComponent:dj.c,itemComponentProps:f,onChange:a})))}));hj.displayName="ArtifactCardGrid";var yj=a(573);const Ej=i.a.memo((({policy:e,apiClient:t,searchableFields:a,getArtifactPath:s,getPolicyArtifactsPath:o,labels:l,onDeleteActionCallback:c,externalPrivileges:d=!0})=>{var p;(()=>{const e=Object(P.useHistory)(),{urlParams:t}=Object(aj.a)();Object(n.useEffect)((()=>{(t.page_index&&!t.page||t.page_size&&!t.pageSize)&&e.replace(`${e.location.pathname}${e.location.search.replaceAll("page_size","pageSize").replaceAll(`page_index=${t.page_index}`,`page=${Number(t.page_index)+1}`)}`)}),[e,t.page,t.pageSize,t.page_index,t.page_size])})();const{getAppUrl:m}=Object(u.d)(),{canCreateArtifactsByPolicy:g}=Object(iy.a)().endpointPrivileges,f=Object(KO.c)({perPage:1e3}),b=Object(XO.b)(t.listId),{urlParams:h}=Object(aj.a)(),[y,E]=Object(n.useState)(new Map),{state:v}=ij(e.id,e.name,o,s),{pageSizeOptions:k,pagination:S,setPagination:T}=Object(GO.b)(),{data:x,isLoading:w,isRefetching:O}=Object(nj.e)(t,{page:S.page,perPage:S.pageSize,filter:h.filter,policies:[e.id,"all"]},a),j=Object(n.useMemo)((()=>({pageSize:S.pageSize,pageIndex:S.page-1,pageSizeOptions:k,totalItemCount:(null==x?void 0:x.total)||0})),[null==x?void 0:x.total,k,S.page,S.pageSize]),I=Object(n.useCallback)((e=>{b({filter:e})}),[b]),C=Object(n.useCallback)((({expanded:e,collapsed:t})=>{const a=new Map(y);for(const t of e)a.set(t.id,!0);for(const e of t)a.set(e.id,!1);E(a)}),[y]),M=Object(n.useCallback)((({pageIndex:e,pageSize:t})=>{null!=x&&x.total&&T({page:e+1,pageSize:t})}),[null==x?void 0:x.total,T]),D=Object(n.useMemo)((()=>l.listTotalItemCountMessage((null==x?void 0:x.data.length)||0)),[null==x?void 0:x.data.length,l]),A=Object(uj.a)(null===(p=f.data)||void 0===p?void 0:p.items),F=Object(n.useCallback)((e=>{const t=s({filter:e.item_id}),a={icon:"controlsHorizontal",children:l.listFullDetailsActionTitle,href:m({appId:r.A,path:t}),navigateAppId:r.A,navigateOptions:{path:t,state:v},"data-test-subj":"view-full-details-action"},n=e,i=Object(yj.d)(n.tags),o={icon:"trash",children:l.listRemoveActionTitle,onClick:()=>{c(n)},disabled:i,toolTipContent:i?l.listRemoveActionNotAllowedMessage:void 0,toolTipPosition:"top","data-test-subj":"remove-from-policy-action"};return{expanded:y.get(n.id)||!1,actions:g&&d?[a,o]:[a],policies:A}}),[A,g,y,d,m,s,l.listFullDetailsActionTitle,l.listRemoveActionNotAllowedMessage,l.listRemoveActionTitle,c,v]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(cj.a,{placeholder:l.listSearchPlaceholderMessage,defaultValue:h.filter,hideRefreshButton:!0,onSearch:I}),i.a.createElement(B.EuiSpacer,{size:"s"}),i.a.createElement(B.EuiText,{color:"subdued",size:"xs","data-test-subj":"policyDetailsArtifactsSearchCount"},D),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(hj,{items:(null==x?void 0:x.data)||[],onPageChange:M,onExpandCollapse:C,cardComponentProps:F,pagination:x?j:void 0,loading:w||O,"data-test-subj":"artifacts-collapsed-list"}))}));Ej.displayName="PolicyArtifactsList";const vj=Object.freeze({listTotalItemCountMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# artifact} other {# artifacts}}",values:{totalItemsCount:e}}),listFullDetailsActionTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.fullDetailsAction",{defaultMessage:"View full details"}),listRemoveActionTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeAction",{defaultMessage:"Remove from policy"}),listRemoveActionNotAllowedMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeActionNotAllowed",{defaultMessage:"Globally applied artifact cannot be removed from policy."}),listSearchPlaceholderMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"})}),kj=i.a.memo((({artifacts:e,isListLoading:t,selectedArtifactIds:a,selectedArtifactsUpdated:s})=>{const r=Object(n.useMemo)((()=>a.reduce(((e,t)=>({...e,[t]:!0})),{})),[a]),o=Object(n.useMemo)((()=>{if(!e||!e.data.length)return null;const t=e.data;return i.a.createElement("div",{"data-test-subj":"artifactsList"},t.map((e=>i.a.createElement(dj.b,{key:e.id,item:e,isSelected:r[e.id]||!1,onToggleSelectedArtifact:t=>s(e.id,t)}))))}),[e,r,s]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(B.EuiProgress,{size:"xs",color:"primary","data-test-subj":"artifactsAssignableListLoader"}),i.a.createElement("div",null,o))}));kj.displayName="PolicyArtifactsAssignableList";const Sj=i.a.memo((({policyItem:e,apiClient:t,searchableFields:a,onClose:s,labels:r})=>{const o=Object(u.o)(),l=Object(Tk.useQueryClient)(),[c,d]=Object(n.useState)([]),[p,m]=Object(n.useState)(""),g=Object(nj.a)(t,{onSuccess:e=>{o.addSuccess({title:r.flyoutSuccessMessageTitle,text:r.flyoutSuccessMessageText(e)}),l.invalidateQueries(["list",t]),s()},onError:()=>{o.addDanger(r.flyoutErrorMessage)}}),{data:f,isLoading:b,isRefetching:h}=Object(nj.e)(t,{perPage:100,filter:p,excludedPolicies:[e.id,"all"]},a),{data:E,isLoading:v}=Object(nj.e)(t,{excludedPolicies:[e.id,"all"]},a),k=Object(n.useCallback)((e=>{d([]),m(e)}),[]),S=Object(n.useCallback)((()=>{if(!f)return;const t=[];c.forEach((a=>{const n=f.data.find((e=>e.id===a));n&&(n.tags=[...n.tags,`policy:${e.id}`],t.push(n))})),g.mutate(t)}),[g,f,e.id,c]),T=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiCallOut,{"data-test-subj":"artifacts-too-many-results",color:"warning",size:"s",heading:"h4",title:r.flyoutWarningCalloutTitle},r.flyoutWarningCalloutMessage(100)),i.a.createElement(B.EuiSpacer,{size:"m"}))),[r]),x=Object(n.useMemo)((()=>0!==(null==E?void 0:E.total)&&(0!==(null==f?void 0:f.total)||""!==p)),[null==E?void 0:E.total,null==f?void 0:f.total,p]),w=Object(n.useMemo)((()=>b||h||v),[v,b,h]),O=Object(n.useMemo)((()=>w?null:x?0===(null==f?void 0:f.total)?i.a.createElement(B.EuiEmptyPrompt,{titleSize:"xs","data-test-subj":"artifacts-no-items-found",body:i.a.createElement("p",null,r.flyoutNoSearchResultsMessage)}):void 0:i.a.createElement(B.EuiEmptyPrompt,{titleSize:"xs","data-test-subj":"artifacts-no-assignable-items",body:i.a.createElement("p",null,r.flyoutNoArtifactsToBeAssignedMessage)})),[w,x,null==f?void 0:f.total,r.flyoutNoArtifactsToBeAssignedMessage,r.flyoutNoSearchResultsMessage]);return i.a.createElement(B.EuiFlyout,{onClose:s,"data-test-subj":"artifacts-assign-flyout"},i.a.createElement(B.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(B.EuiTitle,{size:"m"},i.a.createElement("h2",null,r.flyoutTitle)),i.a.createElement(B.EuiSpacer,{size:"m"}),r.flyoutSubtitle(e.name)),i.a.createElement(B.EuiFlyoutBody,null,((null==f?void 0:f.total)||0)>100?T:null,!v&&x&&i.a.createElement(cj.a,{onSearch:k,placeholder:r.flyoutSearchPlaceholder,hideRefreshButton:!0}),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(kj,{"data-test-subj":"artifacts-assignable-list",artifacts:f,selectedArtifactIds:c,isListLoading:b||h,selectedArtifactsUpdated:(e,t)=>{d((a=>t?[...a,e]:Object(y.without)([e],a)))}}),O),i.a.createElement(B.EuiFlyoutFooter,null,i.a.createElement(B.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButtonEmpty,{"data-test-subj":"artifacts-assign-cancel-button",onClick:s},r.flyoutCancelButtonTitle)),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{className:"eui-textTruncate",style:{maxWidth:"300px"},"data-test-subj":"artifacts-assign-confirm-button",fill:!0,onClick:S,isLoading:g.isLoading||b||h,disabled:Object(y.isEmpty)(c),title:e.name},r.flyoutSubmitButtonTitle(e.name))))))}));Sj.displayName="PolicyArtifactsFlyout";const Tj=Object.freeze({flyoutWarningCalloutTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.searchWarning.title",{defaultMessage:"Limited search results"}),flyoutWarningCalloutMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} artifacts are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.noAssignable",{defaultMessage:"There are no artifacts that can be assigned to this policy."}),flyoutNoSearchResultsMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.noResults",{defaultMessage:"No items found"}),flyoutTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.title",{defaultMessage:"Assign artifacts"}),flyoutSubtitle:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.subtitle",{defaultMessage:"Select artifacts to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.search.label",{defaultMessage:"Search artifacts"}),flyoutCancelButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.cancel",{defaultMessage:"Cancel"}),flyoutSubmitButtonTitle:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.confirm",{defaultMessage:"Assign to {policyName}",values:{policyName:e}}),flyoutErrorMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating artifacts"}),flyoutSuccessMessageTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.title",{defaultMessage:"Success"}),flyoutSuccessMessageText:e=>e.length>1?N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} artifacts have been added to your list.",values:{count:e.length}}):N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your artifacts list.',values:{name:e[0].name}})});var xj=a(519);const wj=i.a.memo((({policyId:e,policyName:t,apiClient:a,exception:s,onClose:r,labels:o})=>{const l=Object(u.o)(),c=Object(Tk.useQueryClient)(),{mutate:d,isLoading:p}=Object(nj.a)(a,{onSuccess:()=>{l.addSuccess({title:o.deleteModalSuccessMessageTitle,text:o.deleteModalSuccessMessageText(s,t)}),c.invalidateQueries(["list",a]),r()},onError:e=>{l.addError(e,{title:o.deleteModalErrorMessage})}}),m=Object(n.useCallback)((()=>{const t={...s,tags:s.tags.filter((t=>t!==`${xj.a}${e}`))};d([t])}),[s,e,d]),g=Object(n.useCallback)((()=>{p||r()}),[p,r]);return i.a.createElement(B.EuiConfirmModal,{onCancel:g,onConfirm:m,title:o.deleteModalTitle,cancelButtonText:o.deleteModalCancelButtonTitle,confirmButtonText:o.deleteModalSubmitButtonTitle,isLoading:p,"data-test-subj":"remove-from-policy-dialog"},i.a.createElement(B.EuiCallOut,{color:"warning",iconType:"help"},i.a.createElement("p",null,o.deleteModalImpactInfo)),i.a.createElement(B.EuiSpacer,null),i.a.createElement(B.EuiText,{size:"s"},i.a.createElement("p",null,o.deleteModalConfirmInfo)))})),Oj=Object.freeze({deleteModalTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.title",{defaultMessage:"Remove artifact from policy"}),deleteModalImpactInfo:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.messageCallout",{defaultMessage:"This artifact will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalConfirmInfo:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.message",{defaultMessage:"Are you sure you wish to continue?"}),deleteModalSubmitButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.confirmLabel",{defaultMessage:"Remove from policy"}),deleteModalCancelButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.cancelLabel",{defaultMessage:"Cancel"}),deleteModalSuccessMessageTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.successToastTitle",{defaultMessage:"Successfully removed"}),deleteModalSuccessMessageText:(e,t)=>N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.successToastText",{defaultMessage:'"{artifactName}" has been removed from {policyName} policy',values:{artifactName:e.name,policyName:t}}),deleteModalErrorMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove artifact"})}),jj=Object.freeze({layoutTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.title",{defaultMessage:"Assigned artifacts"}),layoutAssignButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.assignToPolicy",{defaultMessage:"Assign artifact to policy"}),layoutViewAllLinkMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.about.viewAllLinkLabel",{defaultMessage:"view all artifacts"}),layoutAboutMessage:(e,t)=>N.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.about",{defaultMessage:"There {count, plural, one {is} other {are}} {count} {count, plural, =1 {artifact} other {artifacts}} associated with this policy. Click here to view all artifacts",values:{count:e}})}),Ij=Object.freeze({...jj,...Oj,...Tj,...oj,...lj,...vj}),Cj=i.a.memo((({policyItem:e,labels:t={},getExceptionsListApiClient:a,searchableFields:s,getArtifactPath:o,getPolicyArtifactsPath:l,externalPrivileges:c=!0})=>{const d=Object(n.useMemo)((()=>a()),[a]),{getAppUrl:p}=Object(u.d)(),m=Object(XO.b)(d.listId),{canCreateArtifactsByPolicy:g}=Object(iy.a)().endpointPrivileges,{urlParams:f}=Object(aj.a)(),[b,h]=Object(n.useState)(),y=Object(n.useMemo)((()=>({...Ij,...t})),[t]),{data:E,isLoading:v}=Object(nj.e)(d,{policies:e?[e.id,"all"]:[]},s),{data:k,isLoading:S,isRefetching:T}=Object(nj.e)(d,{},s,{},["allExisting"]),x=Object(n.useCallback)((()=>{m({show:"list"})}),[m]),w=Object(n.useCallback)((()=>{m({show:void 0})}),[m]),O=Object(n.useCallback)((()=>{h(void 0)}),[h]),j=Object(n.useCallback)((e=>{h(e)}),[h]),I=Object(n.useMemo)((()=>i.a.createElement(B.EuiButton,{fill:!0,iconType:"plusInCircle","data-test-subj":"artifacts-assign-button",onClick:x},y.layoutAssignButtonTitle)),[x,y.layoutAssignButtonTitle]),C=Object(n.useMemo)((()=>{const e=i.a.createElement(B.EuiLink,{href:p({appId:r.A,path:o()}),target:"_blank"},y.layoutViewAllLinkMessage);return y.layoutAboutMessage((null==E?void 0:E.total)||0,e)}),[p,o,y,null==E?void 0:E.total]),M=Object(n.useMemo)((()=>v||S||T),[v,S,T]),D=Object(n.useMemo)((()=>E&&0===E.total),[E]);return!e||M?i.a.createElement(tj.a,{"data-test-subj":"policy-artifacts-loading-spinner"}):D?i.a.createElement(i.a.Fragment,null,g&&"list"===f.show&&i.a.createElement(Sj,{policyItem:e,apiClient:d,searchableFields:[...s],onClose:w,labels:y}),k&&0!==k.total?i.a.createElement(sj,{policyId:e.id,policyName:e.name,listId:d.listId,labels:y,getPolicyArtifactsPath:l,getArtifactPath:o}):i.a.createElement(rj,{policyId:e.id,policyName:e.name,labels:y,getPolicyArtifactsPath:l,getArtifactPath:o})):i.a.createElement("div",null,i.a.createElement(B.EuiPageHeader,{alignItems:"center"},i.a.createElement(B.EuiPageHeaderSection,{"data-test-subj":"policy-artifacts-header-section"},i.a.createElement(B.EuiTitle,{size:"m"},i.a.createElement("h2",null,y.layoutTitle)),i.a.createElement(B.EuiSpacer,{size:"s"}),i.a.createElement(B.EuiText,{size:"xs","data-test-subj":"policy-artifacts-layout-about"},i.a.createElement("p",null,C))),i.a.createElement(B.EuiPageHeaderSection,null,g&&c&&I)),g&&c&&"list"===f.show&&i.a.createElement(Sj,{policyItem:e,apiClient:d,searchableFields:[...s],onClose:w,labels:y}),b&&i.a.createElement(wj,{policyId:e.id,policyName:e.name,apiClient:d,exception:b,onClose:O,labels:y}),i.a.createElement(B.EuiSpacer,{size:"l"}),i.a.createElement(B.EuiPageContent_Deprecated,{hasBorder:!1,hasShadow:!1,paddingSize:"none",color:"transparent",borderRadius:"none"},i.a.createElement(Ej,{policy:e,apiClient:d,searchableFields:[...s],labels:y,onDeleteActionCallback:j,externalPrivileges:c,getPolicyArtifactsPath:l,getArtifactPath:o})))}));Cj.displayName="PolicyArtifactsLayout";var Mj=a(874);const Dj=i.a.memo((({endpointCount:e,onCancel:t,onConfirm:a})=>i.a.createElement(B.EuiConfirmModal,{"data-test-subj":"policyDetailsConfirmModal",title:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.title",{defaultMessage:"Save and deploy changes"}),onCancel:t,onConfirm:a,confirmButtonText:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.confirmButtonTitle",{defaultMessage:"Save and deploy changes"}),cancelButtonText:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.cancelButtonTitle",{defaultMessage:"Cancel"})},e>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiCallOut,{"data-test-subj":"policyDetailsWarningCallout",title:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.warningTitle",{defaultMessage:"This action will update {endpointCount, plural, one {# endpoint} other {# endpoints}}",values:{endpointCount:e}})},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateConfirm.warningMessage",defaultMessage:"Saving these changes will apply updates to all endpoints assigned to this agent policy."})),i.a.createElement(B.EuiSpacer,{size:"xl"})),i.a.createElement("p",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateConfirm.message",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})))));Dj.displayName="ConfirmUpdate";const Aj=i.a.memo((()=>{var e,t;const a=Object(o.useDispatch)(),{services:{theme:s,application:{navigateToApp:l}}}=Object(u.k)(),c=Object(u.o)(),{state:d}=Object(P.useLocation)(),p=Object(XO.c)(ZO.m),m=Object(XO.c)(ZO.a),g=Object(XO.c)(ZO.p),h=Object(XO.c)(ZO.f),[y,E]=Object(n.useState)(!1),[v,k]=Object(n.useState)(),S=null!==(e=null==p?void 0:p.name)&&void 0!==e?e:"",T=Object(b.e)({name:"endpointList"}),x=null==v?void 0:v.onCancelNavigateTo,w=Object(n.useMemo)((()=>null!=x?x:[r.A,{path:T}]),[T,x]);Object(n.useEffect)((()=>{g&&(g.success?(c.addSuccess({title:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateSuccessTitle",{defaultMessage:"Success!"}),text:Object(_.toMountPoint)(i.a.createElement("span",{"data-test-subj":"policyDetailsSuccessMessage"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateSuccessMessage",defaultMessage:"Integration {name} has been updated.",values:{name:S}})),{theme$:s.theme$})}),v&&v.onSaveNavigateTo&&l(...v.onSaveNavigateTo)):c.addDanger({title:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateErrorTitle",{defaultMessage:"Failed!"}),text:g.error.message}))}),[l,c,S,g,v,s.theme$]);const O=Object(Eh.a)(...w),j=Object(n.useCallback)((()=>{E(!0)}),[]),I=Object(n.useCallback)((()=>{a({type:"userClickedPolicyDetailsSaveButton"}),E(!1)}),[a]),C=Object(n.useCallback)((()=>{E(!1)}),[]);return Object(n.useEffect)((()=>{!v&&d&&k(d)}),[d,v]),p?i.a.createElement(i.a.Fragment,null,y&&i.a.createElement(Dj,{endpointCount:null!==(t=null==m?void 0:m.total)&&void 0!==t?t:0,onCancel:C,onConfirm:I}),i.a.createElement(Mj.a,null),i.a.createElement(B.EuiSpacer,{size:"xxl"}),i.a.createElement(B.EuiBottomBar,{paddingSize:"s"},i.a.createElement(B.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButtonEmpty,{color:"ghost",onClick:O,"data-test-subj":"policyDetailsCancelButton"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.cancel",defaultMessage:"Cancel"}))),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{fill:!0,iconType:"save","data-test-subj":"policyDetailsSaveButton",onClick:j,isLoading:h},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.save",defaultMessage:"Save"})))))):i.a.createElement(f.a,{noTimeline:!0},h?i.a.createElement(B.EuiLoadingSpinner,{size:"xl"}):null)}));Aj.displayName="PolicyFormLayout";const Fj=Object.freeze({deleteModalTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.title",{defaultMessage:"Remove event filter from policy"}),deleteModalImpactInfo:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.messageCallout",{defaultMessage:"This event filter will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove event filter"}),flyoutWarningCalloutMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} event filters are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.noAssignable",{defaultMessage:"There are no event filters that can be assigned to this policy."}),flyoutTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.title",{defaultMessage:"Assign event filters"}),flyoutSubtitle:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.subtitle",{defaultMessage:"Select event filters to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.search.label",{defaultMessage:"Search event filters"}),flyoutErrorMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating event filters"}),flyoutSuccessMessageText:e=>e.length>1?N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} event filters have been added to your list.",values:{count:e.length}}):N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your event filter list.',values:{name:e[0].name}}),emptyUnassignedTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.title",{defaultMessage:"No assigned event filters"}),emptyUnassignedMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.content",{defaultMessage:"There are currently no event filters assigned to {policyName}. Assign event filters now or add and manage them on the event filters page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.primaryAction",{defaultMessage:"Assign event filters"}),emptyUnassignedSecondaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.secondaryAction",{defaultMessage:"Manage event filters"}),emptyUnexistingTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.title",{defaultMessage:"No event filters exist"}),emptyUnexistingMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.content",{defaultMessage:"There are currently no event filters applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.action",{defaultMessage:"Add event filters"}),listTotalItemCountMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# event filter} other {# event filters}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeActionNotAllowed",{defaultMessage:"Globally applied event filter cannot be removed from policy."}),listSearchPlaceholderMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, comments, value"}),layoutTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.title",{defaultMessage:"Assigned event filters"}),layoutAssignButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.assignToPolicy",{defaultMessage:"Assign event filters to policy"}),layoutViewAllLinkMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.about.viewAllLinkLabel",{defaultMessage:"view all event filters"})}),Rj=Object.freeze({deleteModalTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.title",{defaultMessage:"Remove trusted application from policy"}),deleteModalImpactInfo:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.messageCallout",{defaultMessage:"This trusted application will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove trusted app"}),flyoutWarningCalloutMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} trusted applications are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.noAssignable",{defaultMessage:"There are no trusted applications that can be assigned to this policy."}),flyoutTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.title",{defaultMessage:"Assign trusted applications"}),flyoutSubtitle:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.subtitle",{defaultMessage:"Select trusted applications to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.search.label",{defaultMessage:"Search trusted applications"}),flyoutErrorMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating trusted applications"}),flyoutSuccessMessageText:e=>e.length>1?N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} trusted applications have been added to your list.",values:{count:e.length}}):N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your trusted application list.',values:{name:e[0].name}}),emptyUnassignedTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.title",{defaultMessage:"No assigned trusted applications"}),emptyUnassignedMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.content",{defaultMessage:"There are currently no trusted applications assigned to {policyName}. Assign trusted applications now or add and manage them on the trusted applications page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.primaryAction",{defaultMessage:"Assign trusted applications"}),emptyUnassignedSecondaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.secondaryAction",{defaultMessage:"Manage trusted applications"}),emptyUnexistingTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.title",{defaultMessage:"No trusted applications exist"}),emptyUnexistingMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.content",{defaultMessage:"There are currently no trusted applications applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.action",{defaultMessage:"Add trusted applications"}),listTotalItemCountMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# trusted app} other {# trusted applications}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeActionNotAllowed",{defaultMessage:"Globally applied trusted application cannot be removed from policy."}),listSearchPlaceholderMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"}),layoutTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.title",{defaultMessage:"Assigned trusted applications"}),layoutAssignButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.assignToPolicy",{defaultMessage:"Assign trusted applications to policy"}),layoutViewAllLinkMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.about.viewAllLinkLabel",{defaultMessage:"view all trusted applications"})}),Pj=Object.freeze({deleteModalTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.title",{defaultMessage:"Remove host isolation exception from policy"}),deleteModalImpactInfo:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.messageCallout",{defaultMessage:"This host isolation exception will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove host isolation exception"}),flyoutWarningCalloutMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} host isolation exceptions are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.noAssignable",{defaultMessage:"There are no host isolation exceptions that can be assigned to this policy."}),flyoutTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.title",{defaultMessage:"Assign host isolation exceptions"}),flyoutSubtitle:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.subtitle",{defaultMessage:"Select host isolation exceptions to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.search.label",{defaultMessage:"Search host isolation exceptions"}),flyoutErrorMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating host isolation exceptions"}),flyoutSuccessMessageText:e=>e.length>1?N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} host isolation exceptions have been added to your list.",values:{count:e.length}}):N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your host isolation exception list.',values:{name:e[0].name}}),emptyUnassignedTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.title",{defaultMessage:"No assigned host isolation exceptions"}),emptyUnassignedMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.content",{defaultMessage:"There are currently no host isolation exceptions assigned to {policyName}. Assign host isolation exceptions now or add and manage them on the host isolation exceptions page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.primaryAction",{defaultMessage:"Assign host isolation exceptions"}),emptyUnassignedSecondaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.secondaryAction",{defaultMessage:"Manage host isolation exceptions"}),emptyUnexistingTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.title",{defaultMessage:"No host isolation exceptions exist"}),emptyUnexistingMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.content",{defaultMessage:"There are currently no host isolation exceptions applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.action",{defaultMessage:"Add host isolation exceptions"}),listTotalItemCountMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# host isolation exception} other {# host isolation exceptions}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeActionNotAllowed",{defaultMessage:"Globally applied host isolation exception cannot be removed from policy."}),listSearchPlaceholderMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, IP"}),layoutTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.title",{defaultMessage:"Assigned host isolation exceptions"}),layoutAssignButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.assignToPolicy",{defaultMessage:"Assign host isolation exceptions to policy"}),layoutViewAllLinkMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.about.viewAllLinkLabel",{defaultMessage:"view all host isolation exceptions"})}),_j=Object.freeze({deleteModalTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.title",{defaultMessage:"Remove blocklist entry from policy"}),deleteModalImpactInfo:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.messageCallout",{defaultMessage:"This blocklist entry will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove blocklist entry"}),flyoutWarningCalloutMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} blocklist entries are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.noAssignable",{defaultMessage:"There are no blocklist entries that can be assigned to this policy."}),flyoutTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.title",{defaultMessage:"Assign blocklist entries"}),flyoutSubtitle:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.subtitle",{defaultMessage:"Select blocklist entries to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.search.label",{defaultMessage:"Search blocklist entries"}),flyoutErrorMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating blocklist entry"}),flyoutSuccessMessageText:e=>e.length>1?N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} blocklist entries have been added to your list.",values:{count:e.length}}):N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" blocklist has been added to your list.',values:{name:e[0].name}}),emptyUnassignedTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.title",{defaultMessage:"No assigned blocklist entries"}),emptyUnassignedMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.content",{defaultMessage:"There are currently no blocklist entries assigned to {policyName}. Assign blocklist entries now or add and manage them on the blocklist page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.primaryAction",{defaultMessage:"Assign blocklist entry"}),emptyUnassignedSecondaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.secondaryAction",{defaultMessage:"Manage blocklist entries"}),emptyUnexistingTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.title",{defaultMessage:"No blocklists entries exist"}),emptyUnexistingMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.content",{defaultMessage:"There are currently no blocklist entries applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.action",{defaultMessage:"Add blocklist entry"}),listTotalItemCountMessage:e=>N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklists.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# blocklist entry} other {# blocklist entries}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeActionNotAllowed",{defaultMessage:"Globally applied blocklist cannot be removed from policy."}),listSearchPlaceholderMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"}),layoutTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.title",{defaultMessage:"Assigned blocklist entries"}),layoutAssignButtonTitle:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.assignToPolicy",{defaultMessage:"Assign blocklist entry to policy"}),layoutViewAllLinkMessage:N.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.about.viewAllLinkLabel",{defaultMessage:"view all blocklist entries"})});var qj,Nj=a(495),Lj=a(572),Bj=a(416),zj=a(343),Hj=a(450),$j=a(520),Vj=a(334),Uj=a(496);!function(e){e.SETTINGS="settings",e.TRUSTED_APPS="trustedApps",e.EVENT_FILTERS="eventFilters",e.HOST_ISOLATION_EXCEPTIONS="hostIsolationExceptions",e.BLOCKLISTS="blocklists"}(qj||(qj={}));const Qj=i.a.memo((()=>{var e;const t=Object(P.useHistory)(),a=Object(u.j)(),s=Object(XO.c)(ZO.j),r=Object(XO.c)(ZO.k),o=Object(XO.c)(ZO.i),l=Object(XO.c)(ZO.h),c=Object(XO.c)(ZO.g),d=Object(XO.c)(ZO.o),p=Object(XO.c)(ZO.m),m=Object(iy.a)().endpointPrivileges,{state:g={}}=Object(P.useLocation)(),f=Object(nj.e)(zj.a.getInstance(a),{page:1,perPage:100,policies:[d,"all"]},Vj.b,{enabled:!m.loading&&!m.canIsolateHost}),h=m.canIsolateHost||f.isFetched&&0!==(null===(e=f.data)||void 0===e?void 0:e.total);Object(n.useEffect)((()=>{l&&!h&&t.replace(Object(b.j)(d))}),[h,t,l,d]);const y=Object(n.useCallback)((()=>Nj.a.getInstance(a)),[a]),E=Object(n.useCallback)((()=>Lj.a.getInstance(a)),[a]),v=Object(n.useCallback)((()=>zj.a.getInstance(a)),[a]),k=Object(n.useCallback)((()=>Bj.a.getInstance(a)),[a]),S=Object(n.useMemo)((()=>{const e={...Rj,layoutAboutMessage:(e,t)=>i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} trusted {count, plural, =1 {application} other {applications}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},t={...Fj,layoutAboutMessage:(e,t)=>i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.eventFilters.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} event {count, plural, =1 {filter} other {filters}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},a={...Pj,layoutAboutMessage:(e,t)=>i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.hostIsolationExceptions.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} host isolation {count, plural, =1 {exception} other {exceptions}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},n={..._j,layoutAboutMessage:(e,t)=>i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.blocklist.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} {count, plural, =1 {blocklist} other {blocklist entries}} associated with this policy. Click here to {link}",values:{count:e,link:t}})};return{[qj.SETTINGS]:{id:qj.SETTINGS,name:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.policyForm",{defaultMessage:"Policy settings"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,null),i.a.createElement(Aj,null))},[qj.TRUSTED_APPS]:{id:qj.TRUSTED_APPS,name:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.trustedApps",{defaultMessage:"Trusted applications"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,null),i.a.createElement(Cj,{policyItem:p,labels:e,getExceptionsListApiClient:y,searchableFields:Hj.a,getArtifactPath:b.o,getPolicyArtifactsPath:b.k}))},[qj.EVENT_FILTERS]:{id:qj.EVENT_FILTERS,name:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.eventFilters",{defaultMessage:"Event filters"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,null),i.a.createElement(Cj,{policyItem:p,labels:t,getExceptionsListApiClient:E,searchableFields:$j.d,getArtifactPath:b.f,getPolicyArtifactsPath:b.l}))},[qj.HOST_ISOLATION_EXCEPTIONS]:h?{id:qj.HOST_ISOLATION_EXCEPTIONS,name:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.isInHostIsolationExceptions",{defaultMessage:"Host isolation exceptions"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,null),i.a.createElement(Cj,{policyItem:p,labels:a,getExceptionsListApiClient:v,searchableFields:Vj.b,getArtifactPath:b.g,getPolicyArtifactsPath:b.m,externalPrivileges:m.canIsolateHost}))}:void 0,[qj.BLOCKLISTS]:{id:qj.BLOCKLISTS,name:N.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.blocklists",{defaultMessage:"Blocklist"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,null),i.a.createElement(Cj,{policyItem:p,labels:n,getExceptionsListApiClient:k,searchableFields:Uj.b,getArtifactPath:b.c,getPolicyArtifactsPath:b.i}))}}}),[h,E,v,k,y,p,m.canIsolateHost]),T=Object(n.useMemo)((()=>Object.values(S).filter((e=>void 0!==e))),[S]),x=Object(n.useMemo)((()=>{const e=S[qj.SETTINGS];let t;return s?t=S[qj.SETTINGS]:r?t=S[qj.TRUSTED_APPS]:o?t=S[qj.EVENT_FILTERS]:l?t=S[qj.HOST_ISOLATION_EXCEPTIONS]:c&&(t=S[qj.BLOCKLISTS]),t||e}),[S,s,r,o,l,c]),w=Object(n.useCallback)((e=>{let a="";switch(e.id){case qj.SETTINGS:a=Object(b.j)(d);break;case qj.TRUSTED_APPS:a=Object(b.n)(d);break;case qj.EVENT_FILTERS:a=Object(b.l)(d);break;case qj.HOST_ISOLATION_EXCEPTIONS:a=Object(b.m)(d);break;case qj.BLOCKLISTS:a=Object(b.i)(d)}t.push(a,null!=g&&g.backLink?{backLink:g.backLink}:null)}),[t,d,g]);return l&&(m.loading||f.isFetching)?i.a.createElement(tj.a,{"data-test-subj":"policyHostIsolationExceptionsTabLoading"}):i.a.createElement(B.EuiTabbedContent,{tabs:T,selectedTab:x,size:"l",onTabClick:w})}));Qj.displayName="PolicyTabs";const Wj=i.a.memo((()=>{var e,t,a,s,o,l;const c=Object(oy.a)("policyListEnabled"),{state:d={}}=Object(P.useLocation)(),{getAppUrl:p}=Object(u.d)(),m=Object(XO.c)(ZO.b),g=Object(XO.c)(ZO.m),f=Object(XO.c)(ZO.a),h=null!==(e=null==g?void 0:g.name)&&void 0!==e?e:"",y=null!==(t=null==g?void 0:g.description)&&void 0!==t?t:void 0,E=Object(n.useMemo)((()=>{if(null!=d&&d.backLink)return{onBackButtonNavigateTo:d.backLink.navigateTo,backButtonLabel:d.backLink.label,backButtonUrl:d.backLink.href};if(c){const e=Object(b.h)();return{backButtonLabel:N.i18n.translate("xpack.securitySolution.policyDetails.backToPolicyButton",{defaultMessage:"Back to policy list"}),backButtonUrl:p({path:e}),onBackButtonNavigateTo:[r.A,{path:e}]}}{const e=Object(b.e)({name:"endpointList"});return{backButtonLabel:N.i18n.translate("xpack.securitySolution.policyDetails.backToEndpointList",{defaultMessage:"View all endpoints"}),backButtonUrl:p({path:e}),onBackButtonNavigateTo:[r.A,{path:e}]}}}),[p,null==d?void 0:d.backLink,c]),v=i.a.createElement(ej,{total:null!==(a=null==f?void 0:f.total)&&void 0!==a?a:0,online:null!==(s=null==f?void 0:f.online)&&void 0!==s?s:0,offline:null!==(o=null==f?void 0:f.offline)&&void 0!==o?o:0,error:null!==(l=null==f?void 0:f.error)&&void 0!==l?l:0}),k=i.a.createElement(zO.a,yn()({},E,{"data-test-subj":"policyDetailsBackLink"})),S=Object(n.useMemo)((()=>m?i.a.createElement(B.EuiPageTemplate_Deprecated,{template:"centeredContent"},i.a.createElement(B.EuiCallOut,{color:"danger",title:null==m?void 0:m.error},i.a.createElement("span",{"data-test-subj":"policyDetailsIdNotFoundMessage"},null==m?void 0:m.message))):g?i.a.createElement(Qj,null):i.a.createElement(B.EuiPageTemplate_Deprecated,{template:"centeredContent"},i.a.createElement(B.EuiLoadingSpinner,{className:"essentialAnimation",size:"xl","data-test-subj":"policyDetailsLoading"}))),[m,g]);return i.a.createElement(qO.a,{"data-test-subj":"policyDetailsPage",title:h,subtitle:y,headerBackComponent:k,actions:m?void 0:v,restrictWidth:!0,hasBottomBorder:!1},S)}));Wj.displayName="PolicyDetails",a(619);const Gj=Object(n.memo)((()=>{const e=Object(oy.a)("policyListEnabled");return i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:[Jw.n,Jw.q,Jw.m,Jw.o,Jw.l],exact:!0,component:Wj}),i.a.createElement(_.Route,{path:Jw.p,exact:!0,render:e=>i.a.createElement(P.Redirect,{to:Object(b.j)(e.match.params.policyId)})}),e&&i.a.createElement(_.Route,{path:Jw.k,exact:!0,component:YO}),i.a.createElement(_.Route,{path:"*",component:q.a}))}));Gj.displayName="PolicyContainer";var Kj=a(677),Jj=a(223);const Yj=[32,40,64],Xj=/[^0-9a-f]/i,Zj=e=>Yj.includes(e.length)&&!Xj.test(e),eI=e=>e.field!==Jj.a.SIGNER,tI=N.i18n.translate("xpack.securitySolution.trustedApps.name.label",{defaultMessage:"Name"}),aI=N.i18n.translate("xpack.securitySolution.trustedApps.details.header",{defaultMessage:"Details"}),nI=N.i18n.translate("xpack.securitySolution.trustedApps.details.header.description",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts. Trusted applications may still generate alerts in some cases."}),iI=N.i18n.translate("xpack.securitySolution.trustedapps.create.description",{defaultMessage:"Description"}),sI=N.i18n.translate("xpack.securitySolution.trustedApps.conditions.header",{defaultMessage:"Conditions"}),rI=N.i18n.translate("xpack.securitySolution.trustedApps.conditions.header.description",{defaultMessage:"Select an operating system and add conditions. Availability of conditions may depend on your chosen OS."}),oI=N.i18n.translate("xpack.securitySolution.trustedApps.os.label",{defaultMessage:"Select operating system"}),lI={[Jj.a.HASH]:N.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.hash",{defaultMessage:"Hash"}),[Jj.a.PATH]:N.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.path",{defaultMessage:"Path"}),[Jj.a.SIGNER]:N.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.signature",{defaultMessage:"Signature"})},cI={[Jj.a.HASH]:N.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.hash",{defaultMessage:"md5, sha1, or sha256"}),[Jj.a.PATH]:N.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.path",{defaultMessage:"The full path of the application"}),[Jj.a.SIGNER]:N.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.signature",{defaultMessage:"The signer of the application"})},uI={is:N.i18n.translate("xpack.securitySolution.trustedapps.card.operator.is",{defaultMessage:"is"}),matches:N.i18n.translate("xpack.securitySolution.trustedapps.card.operator.matches",{defaultMessage:"matches"})},dI={field:N.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.field",{defaultMessage:"Field"}),operator:N.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.operator",{defaultMessage:"Operator"}),value:N.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.value",{defaultMessage:"Value"})},pI=N.i18n.translate("xpack.securitySolution.trustedApps.assignmentSectionDescription",{defaultMessage:"Assign this trusted application globally across all policies, or assign it to specific policies."}),mI={name:N.i18n.translate("xpack.securitySolution.trustedapps.create.nameRequiredMsg",{defaultMessage:"Name is required"}),os:N.i18n.translate("xpack.securitySolution.trustedapps.create.osRequiredMsg",{defaultMessage:"Operating System is required"}),field:N.i18n.translate("xpack.securitySolution.trustedapps.create.conditionRequiredMsg",{defaultMessage:"At least one Field definition is required"}),noDuplicateField:e=>N.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldDuplicatedMsg",{defaultMessage:"{field} cannot be added more than once",values:{field:lI[e]}}),mustHaveValue:e=>N.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldValueRequiredMsg",{defaultMessage:"[{row}] Field entry must have a value",values:{row:e+1}}),invalidHash:e=>N.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldInvalidHashMsg",{defaultMessage:"[{row}] Invalid hash value",values:{row:e+1}}),pathWarning:e=>N.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldInvalidPathMsg",{defaultMessage:"[{row}] Path may be formed incorrectly; verify value",values:{row:e+1}}),wildcardPathWarning:e=>N.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldDegradedPerformanceMsg",{defaultMessage:"[{row}] A wildcard in the filename will affect the endpoint's performance",values:{row:e+1}})};var gI=a(401),fI=a(426),bI=a(226);const hI=({os:e,field:t,type:a})=>{if(t===Jj.a.PATH)return e===Jj.c.WINDOWS?"wildcard"===a?"C:\\sample\\*\\path.exe":"C:\\sample\\path.exe":"wildcard"===a?"/opt/*/app":"/opt/bin"},yI=Object(n.memo)((({showLabel:e,label:t="",children:a})=>e?i.a.createElement(B.EuiFormRow,{label:t,fullWidth:!0},a):i.a.createElement(i.a.Fragment,null,a)));yI.displayName="ConditionEntryCell";const EI=H.a.div.withConfig({displayName:"InputGroup",componentId:"sc-1yk4mi3-0"})(["display:grid;grid-template-columns:25% 25% 45% 5%;grid-template-areas:'field operator value remove';"]),vI=H.a.div.withConfig({displayName:"InputItem",componentId:"sc-1yk4mi3-1"})(["grid-area:",";align-self:center;margin:4px;vertical-align:baseline;"],(({gridArea:e})=>e)),kI=Object.keys(bI.c).map((e=>({dropdownDisplay:uI[e],inputDisplay:uI[e],value:"matches"===e?"wildcard":"match"}))),SI=Object(n.memo)((({os:e,entry:t,showLabels:a=!1,onRemove:s,onChange:r,isRemoveDisabled:o=!1,onVisited:l,"data-test-subj":c})=>{const u=Object(mj.a)(c),[d,p]=Object(n.useState)(!1),m=Object(n.useCallback)((()=>{null==l||l(t),d||p(!0)}),[t,d,l]),g=Object(n.useMemo)((()=>{const t=e=>i.a.createElement(i.a.Fragment,null,lI[e],i.a.createElement(B.EuiText,{size:"xs",color:"subdued"},cI[e]));return[{dropdownDisplay:t(Jj.a.HASH),inputDisplay:lI[Jj.a.HASH],value:Jj.a.HASH},{dropdownDisplay:t(Jj.a.PATH),inputDisplay:lI[Jj.a.PATH],value:Jj.a.PATH},...e===Jj.c.WINDOWS?[{dropdownDisplay:t(Jj.a.SIGNER),inputDisplay:lI[Jj.a.SIGNER],value:Jj.a.SIGNER}]:[]]}),[e]),f=Object(n.useCallback)((e=>r({...t,value:e.target.value},t)),[t,r]),b=Object(n.useCallback)((e=>{r({...t,field:e},t),t.value&&m()}),[m,t,r]),h=Object(n.useCallback)((e=>r({...t,type:e},t)),[t,r]),y=Object(n.useCallback)((()=>s(t)),[t,s]),E=Object(n.useCallback)((()=>{m()}),[m]);return i.a.createElement(EI,{"data-test-subj":c},i.a.createElement(vI,{gridArea:"field"},i.a.createElement(yI,{showLabel:a,label:dI.field},i.a.createElement(B.EuiSuperSelect,{options:g,valueOfSelected:t.field,onChange:b,"data-test-subj":u("field")}))),i.a.createElement(vI,{gridArea:"operator"},i.a.createElement(yI,{showLabel:a,label:dI.operator},t.field===Jj.a.PATH?i.a.createElement(B.EuiSuperSelect,{options:kI,onChange:h,valueOfSelected:t.type,"data-test-subj":u("operator")}):i.a.createElement(B.EuiFieldText,{name:"operator",value:uI.is,"data-test-subj":u("operator"),readOnly:!0}))),i.a.createElement(vI,{gridArea:"value"},i.a.createElement(yI,{showLabel:a,label:dI.value},i.a.createElement(B.EuiFieldText,{name:"value",value:t.value,placeholder:hI({os:e,field:t.field,type:t.type}),fullWidth:!0,required:d,onChange:f,onBlur:E,"data-test-subj":u("value")}))),i.a.createElement(vI,{gridArea:"remove"},i.a.createElement(yI,{showLabel:a,label:" "},i.a.createElement(B.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:y,isDisabled:o,"aria-label":N.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.removeLabel",{defaultMessage:"Remove Entry"}),"data-test-subj":u("remove")}))))}));SI.displayName="ConditionEntryInput";const TI=H()(B.EuiFlexGroup).withConfig({displayName:"ConditionGroupFlexGroup",componentId:"sc-7xprc5-0"})([".and-badge{padding-top:20px;padding-bottom:",";}.group-entries{margin-bottom:",";& > *{margin-bottom:",";&:last-child{margin-bottom:0;}}}.and-button{min-width:95px;}"],(({theme:e})=>`calc(${e.eui.euiButtonHeightSmall} + (${e.eui.euiSizeS} * 2) + 3px);`),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS)),xI=Object(n.memo)((({os:e,entries:t,onEntryRemove:a,onEntryChange:n,onAndClicked:s,isAndDisabled:r,onVisited:o,"data-test-subj":l})=>{const c=Object(mj.a)(l);return i.a.createElement(TI,{gutterSize:"xs","data-test-subj":l},t.length>1&&i.a.createElement(B.EuiHideFor,{sizes:["xs","s"]},i.a.createElement(B.EuiFlexItem,{grow:!1,"data-test-subj":c("andConnector"),className:"and-badge"},i.a.createElement(fI.a,{type:"and",includeAntennas:!0}))),i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement("div",{"data-test-subj":c("entries"),className:"group-entries"},t.map(((s,r)=>i.a.createElement(SI,{key:r,os:e,entry:s,showLabels:0===r,isRemoveDisabled:0===r&&t.length<=1,onRemove:a,onChange:n,onVisited:o,"data-test-subj":c(`entry${r}`)})))),i.a.createElement("div",null,i.a.createElement(B.EuiSpacer,{size:"s"}),i.a.createElement(B.EuiButton,{size:"s",iconType:"plusInCircle",onClick:s,"data-test-subj":c("AndButton"),isDisabled:r,className:"and-button"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.trustedapps.logicalConditionBuilder.group.andOperator",defaultMessage:"AND"})))))}));xI.displayName="ConditionGroup";const wI=Object(n.memo)((({entries:e,os:t,className:a,isAndDisabled:n=!1,onAndClicked:s,onEntryRemove:r,onEntryChange:o,onVisited:l,"data-test-subj":c})=>{const u=Object(mj.a)(c);return i.a.createElement("div",{"data-test-subj":c,className:a},i.a.createElement("div",null,0===e.length?i.a.createElement(OI,null):i.a.createElement(xI,{os:t,entries:e,onEntryRemove:r,onEntryChange:o,onAndClicked:s,isAndDisabled:n,onVisited:l,"data-test-subj":u("group1")})))}));wI.displayName="LogicalConditionBuilder";const OI=Object(n.memo)((()=>i.a.createElement(B.EuiPanel,{paddingSize:"l"},i.a.createElement(B.EuiText,{textAlign:"center",size:"s",color:"subdued"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.trustedapps.logicalConditionBuilder.noEntries",defaultMessage:"No conditions defined"})))));OI.displayName="NoEntries";var jI=a(692);const II=Object(n.memo)((()=>{const{docLinks:{links:{securitySolution:e}}}=Object(u.k)().services;return i.a.createElement(i.a.Fragment,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.trustedApps.docsLinkInfoStart",defaultMessage:"Have too many alerts? Add an "}),i.a.createElement(B.EuiLink,{target:"_blank",href:`${e.endpointArtifacts}`},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.trustedApps.docsLinkText",defaultMessage:"endpoint alert exception"})),i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.trustedApps.docsLinkInfoEnd",defaultMessage:" instead."}))}));II.displayName="TrustedAppsArtifactsDocsLink";const CI=(e,t,a,n)=>{e.result[t]||(e.result[t]={isInvalid:!1,errors:[],warnings:[]});const s="warnings"===a?i.a.createElement("div",null,n):n;e.result[t][a].push(s),e.result[t].isInvalid=!0},MI=e=>{var t,a;let n=!0;const i={isValid:n,result:{}};e.name.trim()||(n=!1,CI(i,"name","errors",mI.name)),e.os_types||(n=!1,CI(i,"os","errors",mI.os));const s=null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:Jj.c.WINDOWS;if(e.entries.length){const t=(e=>{const t=new Map;return e.forEach((e=>{const a=e.field.startsWith("process.hash")?Jj.a.HASH:e.field;t.set(a,[...t.get(a)||[],e])})),[...t.entries()].filter((e=>e[1].length>1)).map((e=>e[0]))})(e.entries);t.length&&(n=!1,t.forEach((e=>{CI(i,"entries","errors",mI.noDuplicateField(e))}))),e.entries.forEach(((e,t)=>{const a=Object(Jj.f)({os:s,field:e.field,type:e.type,value:e.value});e.field&&e.value.trim()?e.field!==Jj.a.HASH||Zj(e.value)?a?a&&!Object(Jj.e)({os:s,value:e.value,type:e.type})&&CI(i,"entries","warnings",mI.wildcardPathWarning(t)):CI(i,"entries","warnings",mI.pathWarning(t)):(n=!1,CI(i,"entries","errors",mI.invalidHash(t))):(n=!1,CI(i,"entries","errors",mI.mustHaveValue(t)))}))}else n=!1,CI(i,"entries","errors",mI.field);return i.isValid=n,i},DI=()=>({field:Jj.a.HASH,operator:"included",type:"match",value:""}),AI=Object(n.memo)((({item:e,policies:t,policiesIsLoading:a,onChange:s,mode:r})=>{var o,l,c,u,d,p,m;const g=Object(mj.a)("trustedApps-form"),[f,b]=Object(n.useState)({}),[h,y]=Object(n.useState)([]),E=Object(Sc.b)().isPlatinumPlus(),v=Object(n.useMemo)((()=>Object(xj.e)(e)),[e]),[k,S]=Object(n.useState)(!Object(yj.d)(e.tags)),[T,x]=Object(n.useState)(!1);Object(n.useEffect)((()=>{!T&&e.tags&&S(!Object(yj.d)(e.tags))}),[e.tags,T]),Object(n.useEffect)((()=>{if(T)return;const a=e.tags?Object(xj.c)({tags:e.tags}):[];if(!a.length)return;const n=t.filter((e=>a.includes(e.id)));y(n)}),[T,e,t]);const w=Object(n.useMemo)((()=>E||"edit"===r&&(!v||k&&v&&T)),[r,v,T,E,k]),[O,j]=Object(n.useState)((()=>MI(e))),I=Object(n.useCallback)((e=>{const t=MI(e);j(t),s({item:e,isValid:t.isValid})}),[s]),C=Object(n.useCallback)((t=>{const a=t.isGlobal?[Ka.d]:t.selected.map((e=>`${Ka.b}${e.id}`)),n={...e,tags:a};t.isGlobal||y(t.selected),I(n),x(!0)}),[e,I]),M=Object(n.useCallback)((t=>{const a={...e,[t.target.name]:t.target.value};I(a),x(!0)}),[e,I]),D=Object(n.useCallback)((({target:{name:t}})=>{I(e),b((e=>({...e,[t]:!0})))}),[e,I]),A=Object(n.useMemo)((()=>[Jj.c.LINUX,Jj.c.MAC,Jj.c.WINDOWS].map((e=>({value:e,inputDisplay:gI.a[e]})))),[]),F=Object(n.useCallback)((t=>{b((e=>({...e,os:!0})));const a={...e,os_types:[t],entries:[]};if(t!==Jj.c.WINDOWS){const t=e.entries.filter((e=>eI(e)));a.entries.push(...t),0===e.entries.length&&a.entries.push(DI())}else a.entries.push(...e.entries);I(a),x(!0)}),[e,I]),R=Object(n.useCallback)((()=>{b((e=>({...e,entries:!0})))}),[]),P=Object(n.useCallback)(((t,a)=>{const n={...e,entries:e.entries.map((e=>e===a?t:e))};I(n),x(!0)}),[e,I]),_=Object(n.useCallback)((t=>{const a={...e,entries:e.entries.filter((e=>e!==t))};I(a),x(!0)}),[e,I]),q=Object(n.useCallback)((()=>{var t,a;const n={...e,entries:[]};(null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:Jj.c.WINDOWS)===Jj.c.WINDOWS?n.entries=[...e.entries,DI()].filter((e=>e.field===Jj.a.SIGNER||!0)):n.entries=[...e.entries.filter((e=>eI(e))),DI()],I(n),x(!0)}),[e,I]),N=Object(n.useMemo)((()=>{var t;return null!=e&&null!==(t=e.os_types)&&void 0!==t&&t.length?e.os_types[0]:Jj.c.WINDOWS}),[null==e?void 0:e.os_types]),L=Object(n.useMemo)((()=>{const t=e;return t.entries=e.entries.length?e.entries:[DI()],t}),[e]);return i.a.createElement(B.EuiForm,{component:"div","data-test-subj":g("")},i.a.createElement(B.EuiTitle,{size:"xs"},i.a.createElement("h3",null,aI)),i.a.createElement(B.EuiSpacer,{size:"xs"}),"create"===r&&i.a.createElement(B.EuiText,{size:"s","data-test-subj":g("about")},i.a.createElement("p",null,nI,i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(II,null)))),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiFormRow,{label:tI,fullWidth:!0,"data-test-subj":g("nameRow"),isInvalid:f.name&&(null===(o=O.result.name)||void 0===o?void 0:o.isInvalid),error:null===(l=O.result.name)||void 0===l?void 0:l.errors},i.a.createElement(B.EuiFieldText,{name:"name",value:e.name,onChange:M,onBlur:D,fullWidth:!0,required:f.name,maxLength:256,"data-test-subj":g("nameTextField")})),i.a.createElement(B.EuiFormRow,{label:iI,fullWidth:!0,"data-test-subj":g("descriptionRow")},i.a.createElement(B.EuiTextArea,{name:"description",value:e.description,onChange:M,fullWidth:!0,compressed:!0,maxLength:256,"data-test-subj":g("descriptionField")})),i.a.createElement(B.EuiHorizontalRule,null),i.a.createElement(B.EuiText,{size:"xs"},i.a.createElement("h3",null,sI)),i.a.createElement(B.EuiSpacer,{size:"xs"}),i.a.createElement(B.EuiText,{size:"s"},rI),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiFormRow,{label:oI,fullWidth:!0,"data-test-subj":g("OsRow"),isInvalid:(null==f?void 0:f.os)&&(null===(c=O.result.os)||void 0===c?void 0:c.isInvalid),error:null===(u=O.result.os)||void 0===u?void 0:u.errors},i.a.createElement(B.EuiSuperSelect,{name:"os",options:A,valueOfSelected:N,onChange:F,fullWidth:!0,"data-test-subj":g("osSelectField")})),i.a.createElement(B.EuiFormRow,{fullWidth:!0,"data-test-subj":g("conditionsRow"),isInvalid:f.entries&&(null===(d=O.result.entries)||void 0===d?void 0:d.isInvalid),error:null===(p=O.result.entries)||void 0===p?void 0:p.errors,helpText:null===(m=O.result.entries)||void 0===m?void 0:m.warnings},i.a.createElement(wI,{entries:L.entries,os:N,onAndClicked:q,onEntryRemove:_,onEntryChange:P,onVisited:R,"data-test-subj":g("conditionsBuilder")})),w?i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiHorizontalRule,null),i.a.createElement(B.EuiFormRow,{fullWidth:!0,"data-test-subj":g("policySelection")},i.a.createElement(jI.a,{isGlobal:v,isPlatinumPlus:E,selected:h,options:t,onChange:C,isLoading:a,description:pI,"data-test-subj":g("effectedPolicies")}))):null)}));AI.displayName="TrustedAppsForm";const FI={pageTitle:N.i18n.translate("xpack.securitySolution.trustedApps.pageTitle",{defaultMessage:"Trusted applications"}),pageAboutInfo:N.i18n.translate("xpack.securitySolution.trustedApps.pageAboutInfo",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts. Trusted applications may still generate alerts in some cases."}),pageAddButtonTitle:N.i18n.translate("xpack.securitySolution.trustedApps.pageAddButtonTitle",{defaultMessage:"Add trusted application"}),getShowingCountLabel:e=>N.i18n.translate("xpack.securitySolution.trustedApps.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {trusted application} other {trusted applications}}",values:{total:e}}),cardActionEditLabel:N.i18n.translate("xpack.securitySolution.trustedApps.cardActionEditLabel",{defaultMessage:"Edit trusted application"}),cardActionDeleteLabel:N.i18n.translate("xpack.securitySolution.trustedApps.cardActionDeleteLabel",{defaultMessage:"Delete trusted application"}),flyoutCreateTitle:N.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateTitle",{defaultMessage:"Add trusted application"}),flyoutEditTitle:N.i18n.translate("xpack.securitySolution.trustedApps.flyoutEditTitle",{defaultMessage:"Edit trusted application"}),flyoutCreateSubmitButtonLabel:N.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add trusted application"}),flyoutCreateSubmitSuccess:({name:e})=>N.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your trusted applications.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>N.i18n.translate("xpack.securitySolution.trustedApps.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.trustedApps.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),i.a.createElement(B.EuiLink,{target:"_blank",href:`${e.trustedApps}`},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.trustedApps.flyoutDowngradedLicenseDocsLink",defaultMessage:"Trusted applications documentation"}))),deleteActionSuccess:e=>N.i18n.translate("xpack.securitySolution.trustedApps.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from trusted applications.',values:{itemName:e}}),emptyStateTitle:N.i18n.translate("xpack.securitySolution.trustedApps.emptyStateTitle",{defaultMessage:"Add your first trusted application"}),emptyStateInfo:N.i18n.translate("xpack.securitySolution.trustedApps.emptyStateInfo",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts. Trusted applications may still generate alerts in some cases."}),emptyStatePrimaryButtonLabel:N.i18n.translate("xpack.securitySolution.trustedApps.emptyStatePrimaryButtonLabel",{defaultMessage:"Add trusted application"}),searchPlaceholderInfo:N.i18n.translate("xpack.securitySolution.trustedApps.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, value"})},RI=Object(n.memo)((()=>{const e=Object(u.j)(),t=Nj.a.getInstance(e);return i.a.createElement(Kj.a,{apiClient:t,ArtifactFormComponent:AI,labels:FI,"data-test-subj":"trustedAppsListPage",searchableFields:Hj.a,secondaryPageInfo:i.a.createElement(II,null)})}));RI.displayName="TrustedAppsList";const PI=Object(n.memo)((()=>i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:Jw.s,exact:!0,component:RI}),i.a.createElement(_.Route,{path:"*",component:q.a}))));PI.displayName="TrustedAppsContainer";var _I=a(984);const qI=()=>i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:Jw.i,exact:!0,component:_I.c}),i.a.createElement(_.Route,{path:"*",component:q.a}));var NI=a(119),LI=a(1197),BI=a.n(LI);const zI=N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.placeholder",{defaultMessage:"Host isolation exception name"}),HI=N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.label",{defaultMessage:"Name your host isolation exceptions"}),$I=N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.error",{defaultMessage:"The name can't be empty"}),VI=N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.description.placeholder",{defaultMessage:"Describe your host isolation exception"}),UI=N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.description.label",{defaultMessage:"Description"}),QI=N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.placeholder",{defaultMessage:"Ex 0.0.0.0/24"}),WI=N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.label",{defaultMessage:"Enter IP Address"}),GI=N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.error",{defaultMessage:"The IP is invalid. Only IPv4 with optional CIDR is supported"});var KI=a(1003);const JI=Object(n.memo)((({item:e,onChange:t,policies:a,disabled:s,mode:r,error:o})=>{var l;const c=Object(n.useMemo)((()=>e.entries[0]||{field:"destination.ip",operator:"included",type:"match",value:""}),[e.entries]),[u,d]=Object(n.useState)(!1),[p,m]=Object(n.useState)(!1),[g,f]=Object(n.useState)(!e.name),[b,h]=Object(n.useState)(!c.value),[y,E]=Object(n.useState)({isGlobal:Object(yj.d)(e.tags),selected:[]}),v=Object(n.useMemo)((()=>!g&&!b),[b,g]),k=Object(n.useCallback)((a=>{t({item:a?{...e,...a}:e,isValid:v})}),[e,v,t]),S=Object(n.useCallback)((e=>{const t=e.target.value;t.trim()?f(!1):f(!0),k({name:t})}),[k]),T=Object(n.useCallback)((e=>{const t=e.target.value;!function(e){if(/^([0-9]{1,3}\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))?$/.test(e))try{return BI.a.IPv4.parseCIDR(e),!0}catch(t){return BI.a.IPv4.isValid(e)}return!1}(t)?h(!0):h(!1),k({entries:[{...c,value:t}]})}),[c,k]),x=Object(n.useCallback)((t=>{t.isGlobal?E({isGlobal:!0,selected:t.selected}):E(t),k({tags:Object(yj.a)(t,Object(yj.b)(e.tags))})}),[e.tags,k]),w=Object(n.useCallback)((e=>{k({description:e.target.value})}),[k]),O=Object(n.useMemo)((()=>{var t;return i.a.createElement(B.EuiFormRow,{label:HI,fullWidth:!0,isInvalid:g&&u,error:$I,isDisabled:s,"data-test-subj":"hostIsolationExceptions-form-name-input-formRow"},i.a.createElement(B.EuiFieldText,{id:"eventFiltersFormInputName",placeholder:zI,defaultValue:null!==(t=e.name)&&void 0!==t?t:"",onChange:S,fullWidth:!0,"aria-label":zI,required:u,maxLength:256,"data-test-subj":"hostIsolationExceptions-form-name-input",onBlur:()=>!u&&d(!0),disabled:s}))}),[s,e.name,S,u,g]),j=Object(n.useMemo)((()=>{var t,a,n;return i.a.createElement(B.EuiFormRow,{label:WI,fullWidth:!0,isInvalid:b&&p,error:GI,isDisabled:s,"data-test-subj":"hostIsolationExceptions-form-ip-input-formRow"},i.a.createElement(B.EuiFieldText,{id:"eventFiltersFormInputName",placeholder:QI,defaultValue:null!==(t=null===(a=e.entries)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.value)&&void 0!==t?t:"",onChange:T,fullWidth:!0,"aria-label":QI,required:p,maxLength:256,"data-test-subj":"hostIsolationExceptions-form-ip-input",onBlur:()=>!p&&m(!0),disabled:s}))}),[s,e.entries,T,p,b]),I=Object(n.useMemo)((()=>{var t;return i.a.createElement(B.EuiFormRow,{label:UI,fullWidth:!0,isDisabled:s,"data-test-subj":"hostIsolationExceptions-form-description-input-formRow"},i.a.createElement(B.EuiTextArea,{id:"eventFiltersFormInputName",placeholder:VI,defaultValue:null!==(t=e.description)&&void 0!==t?t:"",onChange:w,fullWidth:!0,"data-test-subj":"hostIsolationExceptions-form-description-input","aria-label":VI,maxLength:256,disabled:s}))}),[s,e.description,w]);return Object(n.useEffect)((()=>{0===y.selected.length&&e.tags&&E(Object(yj.c)(e.tags,a))}),[e.tags,a,y.selected.length]),Object(n.useEffect)((()=>{k()}),[k]),Object(n.useEffect)((()=>{var t,a;"create"===r&&3!==(null!==(t=null===(a=e.os_types)||void 0===a?void 0:a.length)&&void 0!==t?t:0)&&k({os_types:["windows","linux","macos"]})}),[null===(l=e.os_types)||void 0===l?void 0:l.length,r,k]),i.a.createElement(B.EuiForm,{component:"div",error:o&&i.a.createElement(KI.a,{error:o}),isInvalid:!!o,"data-test-subj":"hostIsolationExceptions-form"},i.a.createElement(B.EuiTitle,{size:"xs"},i.a.createElement("h2",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.title",defaultMessage:"Details"}))),i.a.createElement(B.EuiText,{size:"s"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.description",defaultMessage:"Allows isolated hosts to connect to these IP addresses. Only accepts IPv4 with optional CIDR."})),i.a.createElement(B.EuiSpacer,{size:"m"}),O,I,i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiHorizontalRule,null),i.a.createElement(B.EuiTitle,{size:"xs"},i.a.createElement("h2",null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.conditions.title",defaultMessage:"Conditions"}))),i.a.createElement(B.EuiText,{size:"s"},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.conditions.subtitle",defaultMessage:"Host Isolation exceptions will apply to all operating systems."})),i.a.createElement(B.EuiSpacer,{size:"m"}),j,i.a.createElement(B.EuiHorizontalRule,null),i.a.createElement(B.EuiFormRow,{fullWidth:!0,"data-test-subj":"effectedPolicies-container",isDisabled:s},i.a.createElement(jI.a,{isGlobal:y.isGlobal,isPlatinumPlus:!0,selected:y.selected,options:a,onChange:x,"data-test-subj":"effectedPolicies-select",disabled:s})))}));JI.displayName="HostIsolationExceptionsForm";const YI=Object.freeze({pageTitle:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageTitle",{defaultMessage:"Host isolation exceptions"}),pageAboutInfo:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageAboutInfo",{defaultMessage:"Add a host isolation exception to allow isolated hosts to communicate with specific IPs."}),pageAddButtonTitle:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageAddButtonTitle",{defaultMessage:"Add host isolation exception"}),getShowingCountLabel:e=>N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {host isolation exception} other {host isolation exceptions}}",values:{total:e}}),cardActionEditLabel:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.cardActionEditLabel",{defaultMessage:"Edit exception"}),cardActionDeleteLabel:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.cardActionDeleteLabel",{defaultMessage:"Delete exception"}),flyoutCreateTitle:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateTitle",{defaultMessage:"Add host isolation exception"}),flyoutEditTitle:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutEditTitle",{defaultMessage:"Edit host isolation exception"}),flyoutCreateSubmitButtonLabel:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add host isolation exception"}),flyoutCreateSubmitSuccess:({name:e})=>N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your host isolation exception list.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:()=>null,deleteModalTitle:()=>N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.deleteModtalTitle",{defaultMessage:"Delete host isolation exception"}),deleteActionSuccess:e=>N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from host isolation exception list.',values:{itemName:e}}),emptyStateTitle:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStateTitle",{defaultMessage:"Add your first host isolation exception"}),emptyStateInfo:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStateInfo",{defaultMessage:"Add a host isolation exception to allow isolated hosts to communicate with specific IPs."}),emptyStatePrimaryButtonLabel:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStatePrimaryButtonLabel",{defaultMessage:"Add host isolation exception"}),searchPlaceholderInfo:N.i18n.translate("xpack.securitySolution.hostIsolationExceptions.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, IP"})}),XI=Object(n.memo)((()=>{const e=Object(u.j)(),t=zj.a.getInstance(e),a=Object(iy.a)().endpointPrivileges.canIsolateHost;return i.a.createElement(Kj.a,{apiClient:t,ArtifactFormComponent:JI,labels:YI,"data-test-subj":"hostIsolationExceptionsListPage",searchableFields:Vj.b,allowCardCreateAction:a,allowCardEditAction:a})}));XI.displayName="HostIsolationExceptionsList";const ZI=Object(n.memo)((()=>Object(NI.i)(r.uc.hostIsolationExceptions)?i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:Jw.j,exact:!0,component:XI}),i.a.createElement(_.Route,{path:"*",component:q.a})):i.a.createElement(P.Redirect,{to:r.zb})));ZI.displayName="HostIsolationExceptionsContainer";var eC=a(599),tC=a(451);const aC=N.i18n.translate("xpack.securitySolution.blocklist.details.header",{defaultMessage:"Details"}),nC=N.i18n.translate("xpack.securitySolution.blocklist.details.header.description",{defaultMessage:"The blocklist prevents selected applications from running on your hosts by extending the list of processes the Endpoint considers malicious."}),iC=N.i18n.translate("xpack.securitySolution.blocklist.name.label",{defaultMessage:"Name"}),sC=N.i18n.translate("xpack.securitySolution.blocklist.description.label",{defaultMessage:"Description"}),rC=N.i18n.translate("xpack.securitySolution.blocklist.conditions.header",{defaultMessage:"Conditions"}),oC=N.i18n.translate("xpack.securitySolution.blocklist.conditions.header.description",{defaultMessage:"Select an operating system and add conditions. Availability of conditions may depend on your chosen OS."}),lC=N.i18n.translate("xpack.securitySolution.blocklist.os.label",{defaultMessage:"Select operating system"}),cC=N.i18n.translate("xpack.securitySolution.blocklist.field.label",{defaultMessage:"Field"}),uC=N.i18n.translate("xpack.securitySolution.blocklist.operator.label",{defaultMessage:"Operator"}),dC=N.i18n.translate("xpack.securitySolution.blocklist.value.label",{defaultMessage:"Value"}),pC=N.i18n.translate("xpack.securitySolution.blocklist.value.label.helper",{defaultMessage:"Type or copy & paste one or multiple comma delimited values"}),mC={"file.hash.*":N.i18n.translate("xpack.securitySolution.blocklist.entry.field.hash",{defaultMessage:"Hash"}),"file.path":N.i18n.translate("xpack.securitySolution.blocklist.entry.field.path",{defaultMessage:"Path"}),"file.Ext.code_signature":N.i18n.translate("xpack.securitySolution.blocklist.entry.field.signature",{defaultMessage:"Signature"})},gC={"file.hash.*":N.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.hash",{defaultMessage:"md5, sha1, or sha256"}),"file.path":N.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.path",{defaultMessage:"The full path of the application"}),"file.Ext.code_signature":N.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.signature",{defaultMessage:"The signer of the application"})},fC=N.i18n.translate("xpack.securitySolution.blocklist.policyAssignmentSectionDescription",{defaultMessage:"Assign this blocklist globally across all policies, or assign it to specific policies."}),bC={NAME_REQUIRED:N.i18n.translate("xpack.securitySolution.blocklist.errors.name.required",{defaultMessage:"Name is required"}),VALUE_REQUIRED:N.i18n.translate("xpack.securitySolution.blocklist.errors.values.required",{defaultMessage:"Field entry must have a value"}),INVALID_HASH:N.i18n.translate("xpack.securitySolution.blocklist.errors.values.invalidHash",{defaultMessage:"Invalid hash value"}),INVALID_PATH:N.i18n.translate("xpack.securitySolution.blocklist.warnings.values.invalidPath",{defaultMessage:"Path may be formed incorrectly; verify value"}),WILDCARD_PRESENT:N.i18n.translate("xpack.securitySolution.blocklist.warnings.values.wildcardPresent",{defaultMessage:"A wildcard in the filename will affect the endpoint's performance"}),DUPLICATE_VALUE:N.i18n.translate("xpack.securitySolution.blocklist.warnings.values.duplicateValue",{defaultMessage:"This value already exists"}),DUPLICATE_VALUES:N.i18n.translate("xpack.securitySolution.blocklist.warnings.values.duplicateValues",{defaultMessage:"One or more duplicate values removed"})};function hC(e){return i.a.createElement("div",null,e)}function yC(e){return i.a.createElement(i.a.Fragment,null,mC[e],i.a.createElement(B.EuiText,{size:"xs",color:"subdued"},gC[e]))}function EC(e){return!Object.values(e).some((e=>Object.keys(e).length))}const vC=Object(n.memo)((({item:e,policies:t,policiesIsLoading:a,onChange:s,mode:r})=>{const[o,l]=Object(n.useState)({name:!1,value:!1}),c=Object(n.useRef)({name:{},value:{}}),u=Object(n.useRef)({name:{},value:{}}),[d,p]=Object(n.useState)([]),m=Object(Sc.b)().isPlatinumPlus(),g=Object(n.useMemo)((()=>Object(xj.e)(e)),[e]),[f,b]=Object(n.useState)(!Object(yj.d)(e.tags)),[h,y]=Object(n.useState)(!1),E=Object(n.useMemo)((()=>m||"edit"===r&&(!g||f&&g&&h)),[r,g,h,m,f]);Object(n.useEffect)((()=>{!h&&e.tags&&b(!Object(yj.d)(e.tags))}),[e.tags,h]),Object(n.useEffect)((()=>{var a,n;if(h)return;const i=null!==(a=null===(n=e.tags)||void 0===n?void 0:n.map((e=>e.split(":")[1])))&&void 0!==a?a:[];if(!i.length)return;const s=t.filter((e=>i.includes(e.id)));p(s)}),[h,e.tags,t]);const v=Object(mj.a)("blocklist-form"),k=Object(n.useMemo)((()=>e.entries.length?e.entries[0]:{field:"file.hash.*",operator:"included",type:"match_any",value:[]}),[e.entries]),S=Object(n.useMemo)((()=>{var t;return null!=e&&null!==(t=e.os_types)&&void 0!==t&&t.length?e.os_types[0]:Jj.c.WINDOWS}),[null==e?void 0:e.os_types]),T=Object(n.useMemo)((()=>k.value.map((e=>({label:e,"data-test-subj":v(`values-input-${e}`)})))),[k.value,v]),x=Object(n.useMemo)((()=>[Jj.c.LINUX,Jj.c.MAC,Jj.c.WINDOWS].map((e=>({value:e,inputDisplay:gI.a[e]})))),[]),w=Object(n.useMemo)((()=>{const e=["file.hash.*","file.path"].map((e=>({value:e,inputDisplay:mC[e],dropdownDisplay:yC(e),"data-test-subj":v(e)})));return S===Jj.c.WINDOWS&&e.push({value:"file.Ext.code_signature",inputDisplay:mC["file.Ext.code_signature"],dropdownDisplay:yC("file.Ext.code_signature"),"data-test-subj":v("file.Ext.code_signature")}),e}),[S,v]),O=Object(n.useMemo)((()=>i.a.createElement("div",null,i.a.createElement(B.EuiToolTip,{content:pC},i.a.createElement(i.a.Fragment,null,dC," ",i.a.createElement(B.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))))),[]),j=Object(n.useCallback)((e=>{var t,a,n;const i=null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:Jj.c.WINDOWS,{field:s="file.hash.*",type:r="match_any",value:o=[]}=null!==(n=e.entries[0])&&void 0!==n?n:{},l={},d={},p={};e.name.trim()||(d.NAME_REQUIRED=hC(bC.NAME_REQUIRED)),o.length||(p.VALUE_REQUIRED=hC(bC.VALUE_REQUIRED)),"file.hash.*"===s&&o.some((e=>!Zj(e)))&&(p.INVALID_HASH=hC(bC.INVALID_HASH));const m=o.some((e=>!Object(Jj.f)({os:i,field:s,type:r,value:e})));"file.hash.*"!==s&&m&&(l.INVALID_PATH=hC(bC.INVALID_PATH)),o.length!==Object($h.uniq)(o).length&&(l.DUPLICATE_VALUES=hC(bC.DUPLICATE_VALUES)),c.current={...c.current,value:l},u.current={name:d,value:p}}),[]),I=Object(n.useCallback)((()=>{j(e),l((e=>({...e,name:!0})))}),[e,j]),C=Object(n.useCallback)((()=>{j(e),l((e=>({...e,value:!0})))}),[e,j]),M=Object(n.useCallback)((t=>{const a={...e,name:t.target.value};j(a),s({isValid:EC(u.current),item:a}),y(!0)}),[j,s,e]),D=Object(n.useCallback)((t=>{const a={...e,description:t.target.value};j(a),s({isValid:EC(u.current),item:a}),y(!0)}),[s,e,j]),A=Object(n.useCallback)((t=>{const a={...e,os_types:[t],entries:[{...k,field:t!==Jj.c.WINDOWS&&"file.Ext.code_signature"===k.field?"file.hash.*":k.field}]};j(a),s({isValid:EC(u.current),item:a}),y(!0)}),[j,k,s,e]),F=Object(n.useCallback)((t=>{const a={...e,entries:[{...k,field:t}]};j(a),s({isValid:EC(u.current),item:a}),y(!0)}),[j,s,e,k]),R=Object(n.useCallback)((e=>{const t={...c.current.value};k.value.includes(e)?t.DUPLICATE_VALUE=hC(bC.DUPLICATE_VALUE):delete t.DUPLICATE_VALUE,c.current={...c.current,value:t},l((e=>({...e})))}),[k]),P=Object(n.useCallback)((t=>{const a=t.map((e=>e.label)),n={...e,entries:[{...k,value:a}]};j(n),s({isValid:EC(u.current),item:n}),y(!0)}),[j,s,e,k]),_=Object(n.useCallback)((t=>{const a=t.split(",").filter((e=>e.trim())),n=[...k.value,...a],i={...e,entries:[{...k,value:n}]};j(i),i.entries[0].value=Object($h.uniq)(i.entries[0].value),l((e=>({...e,value:!0}))),s({isValid:EC(u.current),item:i}),y(!0)}),[j,s,e,k]),q=Object(n.useCallback)((t=>{const a=t.isGlobal?[Ka.d]:t.selected.map((e=>`${Ka.b}${e.id}`)),n={...e,tags:a};t.isGlobal||p(t.selected),j(n),s({isValid:EC(u.current),item:n}),y(!0)}),[j,s,e]);return i.a.createElement(B.EuiForm,{component:"div"},i.a.createElement(B.EuiTitle,{size:"xs"},i.a.createElement("h3",null,aC)),i.a.createElement(B.EuiSpacer,{size:"xs"}),"create"===r&&i.a.createElement(B.EuiText,{size:"s","data-test-subj":v("header-description")},i.a.createElement("p",null,nC)),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiFormRow,{label:iC,isInvalid:o.name&&!!Object.keys(u.current.name).length,error:Object.values(u.current.name),fullWidth:!0},i.a.createElement(B.EuiFieldText,{name:"name",value:e.name,onChange:M,onBlur:I,required:o.name,maxLength:256,"data-test-subj":v("name-input"),fullWidth:!0})),i.a.createElement(B.EuiFormRow,{label:sC,fullWidth:!0},i.a.createElement(B.EuiTextArea,{name:"description",value:e.description,onChange:D,"data-test-subj":v("description-input"),fullWidth:!0,compressed:!0,maxLength:256})),i.a.createElement(B.EuiHorizontalRule,null),i.a.createElement(B.EuiTitle,{size:"xs"},i.a.createElement("h3",null,rC)),i.a.createElement(B.EuiSpacer,{size:"xs"}),i.a.createElement(B.EuiText,{size:"s"},i.a.createElement("p",null,oC)),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiFormRow,{label:lC,fullWidth:!0},i.a.createElement(B.EuiSuperSelect,{name:"os",options:x,valueOfSelected:S,onChange:A,"data-test-subj":v("os-select"),fullWidth:!0})),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(B.EuiFormRow,{fullWidth:!0},i.a.createElement(B.EuiFlexGroup,{gutterSize:"s"},i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(B.EuiFormRow,{label:cC,fullWidth:!0},i.a.createElement(B.EuiSuperSelect,{name:"field",options:w,valueOfSelected:k.field,onChange:F,"data-test-subj":v("field-select"),fullWidth:!0}))),i.a.createElement(B.EuiFlexItem,{grow:1},i.a.createElement(B.EuiFormRow,{label:uC,fullWidth:!0},i.a.createElement(B.EuiFieldText,{name:"operator",value:tC.l.message,readOnly:!0}))),i.a.createElement(B.EuiFlexItem,{grow:2}))),i.a.createElement(B.EuiFormRow,{label:O,isInvalid:o.value&&!!Object.keys(u.current.value).length,helpText:Object.values(c.current.value),error:Object.values(u.current.value),fullWidth:!0},i.a.createElement(B.EuiComboBox,{selectedOptions:T,onBlur:C,onSearchChange:R,onChange:P,onCreateOption:_,"data-test-subj":v("values-input"),fullWidth:!0,noSuggestions:!0})),E&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiHorizontalRule,null),i.a.createElement(B.EuiFormRow,{fullWidth:!0},i.a.createElement(jI.a,{isGlobal:g,isPlatinumPlus:m,selected:d,options:t,onChange:q,isLoading:a,description:fC}))))})),kC={pageTitle:N.i18n.translate("xpack.securitySolution.blocklist.pageTitle",{defaultMessage:"Blocklist"}),pageAboutInfo:N.i18n.translate("xpack.securitySolution.blocklist.pageAboutInfo",{defaultMessage:"The blocklist prevents selected applications from running on your hosts by extending the list of processes the Endpoint considers malicious."}),pageAddButtonTitle:N.i18n.translate("xpack.securitySolution.blocklist.pageAddButtonTitle",{defaultMessage:"Add blocklist entry"}),getShowingCountLabel:e=>N.i18n.translate("xpack.securitySolution.blocklist.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {blocklist entry} other {blocklist entries}}",values:{total:e}}),cardActionEditLabel:N.i18n.translate("xpack.securitySolution.blocklist.cardActionEditLabel",{defaultMessage:"Edit blocklist"}),cardActionDeleteLabel:N.i18n.translate("xpack.securitySolution.blocklist.cardActionDeleteLabel",{defaultMessage:"Delete blocklist"}),flyoutCreateTitle:N.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateTitle",{defaultMessage:"Add blocklist"}),flyoutEditTitle:N.i18n.translate("xpack.securitySolution.blocklist.flyoutEditTitle",{defaultMessage:"Edit blocklist"}),flyoutCreateSubmitButtonLabel:N.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add blocklist"}),flyoutCreateSubmitSuccess:({name:e})=>N.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your blocklist.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>N.i18n.translate("xpack.securitySolution.blocklist.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.blocklist.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),i.a.createElement(B.EuiLink,{target:"_blank",href:`${e.blocklist}`},i.a.createElement(Hs.FormattedMessage,{id:"xpack.securitySolution.blocklist.flyoutDowngradedLicenseDocsLink",defaultMessage:"blocklist documentation."}))),deleteActionSuccess:e=>N.i18n.translate("xpack.securitySolution.blocklist.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from blocklist.',values:{itemName:e}}),emptyStateTitle:N.i18n.translate("xpack.securitySolution.blocklist.emptyStateTitle",{defaultMessage:"Add your first blocklist entry"}),emptyStateInfo:N.i18n.translate("xpack.securitySolution.blocklist.emptyStateInfo",{defaultMessage:"The blocklist prevents specified applications from running on your hosts, extending the list of processes that Endpoint Security considers malicious."}),emptyStatePrimaryButtonLabel:N.i18n.translate("xpack.securitySolution.blocklist.emptyStatePrimaryButtonLabel",{defaultMessage:"Add blocklist entry"}),searchPlaceholderInfo:N.i18n.translate("xpack.securitySolution.blocklist.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, value"})},SC=Object(n.memo)((()=>{const e=Object(u.j)(),t=eC.a.getInstance(e);return i.a.createElement(Kj.a,{apiClient:t,ArtifactFormComponent:vC,labels:kC,"data-test-subj":"blocklistPage",flyoutSize:"l"})}));SC.displayName="Blocklist";const TC=Object(n.memo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:Jw.g,exact:!0,component:SC}),i.a.createElement(_.Route,{path:"*",component:q.a})),i.a.createElement(h.a,{pageName:v.a.blocklist}))));TC.displayName="BlocklistContainer";var xC=a(891),wC=a(395);const OC=()=>{const[e,t]=Object(n.useState)(!0),a=Object(n.useCallback)((e=>{t(!e)}),[]);return i.a.createElement(qO.a,{"data-test-subj":"responseActionsPage",title:hE.z,subtitle:wC.d.pageSubTitle,hideHeader:e},i.a.createElement(tO.a,{showHostNames:!0,isFlyout:!1,setIsDataInResponse:a}))};OC.displayName="ResponseActionsListPage";const jC=Object(n.memo)((()=>i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:Jw.r,exact:!0,component:OC}),i.a.createElement(_.Route,{path:"*",component:q.a}))));jC.displayName="ResponseActionsContainer";const IC=()=>i.a.createElement(s.TrackApplicationView,{viewId:r.uc.endpoints},i.a.createElement(WO,null),i.a.createElement(h.a,{pageName:r.uc.endpoints})),CC=()=>i.a.createElement(s.TrackApplicationView,{viewId:r.uc.policies},i.a.createElement(Gj,null),i.a.createElement(h.a,{pageName:r.uc.policies})),MC=()=>i.a.createElement(s.TrackApplicationView,{viewId:r.uc.trustedApps},i.a.createElement(PI,null),i.a.createElement(h.a,{pageName:r.uc.trustedApps})),DC=()=>i.a.createElement(s.TrackApplicationView,{viewId:r.uc.eventFilters},i.a.createElement(qI,null),i.a.createElement(h.a,{pageName:r.uc.eventFilters})),AC=()=>i.a.createElement(s.TrackApplicationView,{viewId:r.uc.hostIsolationExceptions},i.a.createElement(ZI,null),i.a.createElement(h.a,{pageName:r.uc.hostIsolationExceptions})),FC=()=>i.a.createElement(s.TrackApplicationView,{viewId:r.uc.responseActionsHistory},i.a.createElement(jC,null),i.a.createElement(h.a,{pageName:r.uc.responseActionsHistory})),RC=Object(n.memo)((()=>{const{loading:e,canAccessEndpointManagement:t,canAccessResponseActionsHistory:a}=Object(iy.a)().endpointPrivileges;return e?i.a.createElement(B.EuiLoadingSpinner,null):t?i.a.createElement(P.Switch,null,i.a.createElement(_.Route,{path:Jw.h,component:IC}),i.a.createElement(_.Route,{path:Jw.k,component:CC}),i.a.createElement(_.Route,{path:Jw.s,component:MC}),i.a.createElement(_.Route,{path:Jw.i,component:DC}),i.a.createElement(_.Route,{path:Jw.j,component:AC}),i.a.createElement(_.Route,{path:Jw.g,component:TC}),a&&i.a.createElement(_.Route,{path:Jw.r,component:FC}),i.a.createElement(_.Route,{path:r.Pb,exact:!0},i.a.createElement(P.Redirect,{to:Object(b.e)({name:"endpointList"})})),i.a.createElement(_.Route,{path:"*",component:q.a})):i.a.createElement(i.a.Fragment,null,i.a.createElement(_.Route,{path:"*",component:xC.a}),i.a.createElement(h.a,{pageName:r.uc.administration}))}));RC.displayName="ManagementContainer";var PC=a(867);const _C=[{path:r.Pb,component:()=>i.a.createElement(A,null,i.a.createElement(PC.a,null,i.a.createElement(RC,null)))}];var qC=a(884),NC=a(888),LC=a(541),BC=a(631);const zC=H()(B.EuiTitle).withConfig({displayName:"PrimaryEuiTitle",componentId:"sc-dlsynk-0"})(["color:",";"],(e=>e.theme.eui.euiColorPrimary)),HC=H()(B.EuiText).withConfig({displayName:"LandingLinksDescripton",componentId:"sc-dlsynk-1"})(["padding-top:",";max-width:550px;"],(({theme:e})=>e.eui.euiSizeXS)),$C=H.a.a.withConfig({displayName:"Link",componentId:"sc-dlsynk-2"})(["color:inherit;"]),VC=H()(B.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-dlsynk-3"})(["align-items:center;"]),UC=H()(B.EuiFlexItem).withConfig({displayName:"Content",componentId:"sc-dlsynk-4"})(["padding-left:",";"],(({theme:e})=>e.eui.euiSizeS)),QC=H.a.div.withConfig({displayName:"FlexTitle",componentId:"sc-dlsynk-5"})(["display:flex;align-items:center;"]),WC=H.a.h2.withConfig({displayName:"TitleText",componentId:"sc-dlsynk-6"})(["display:inline;"]),GC=Object(ue.p)($C),KC=({items:e})=>i.a.createElement(B.EuiFlexGroup,{direction:"column"},e.map((({title:e,description:t,image:a,id:n,isBeta:s,betaOptions:r})=>i.a.createElement(B.EuiFlexItem,{key:n,"data-test-subj":"LandingItem"},i.a.createElement(GC,{deepLinkId:n,tabIndex:-1},i.a.createElement(B.EuiPanel,{hasBorder:!0,hasShadow:!1,paddingSize:"m",onClick:()=>{}},i.a.createElement(B.EuiFlexGroup,null,i.a.createElement(VC,{grow:!1},a&&i.a.createElement(B.EuiImage,{"data-test-subj":"LandingLinksImage",size:"l",role:"presentation",alt:"",src:a})),i.a.createElement(UC,null,i.a.createElement(zC,{size:"s"},i.a.createElement(QC,null,i.a.createElement(WC,null,e),s&&i.a.createElement(BC.a,{text:null==r?void 0:r.text}))),i.a.createElement(HC,{size:"s",color:"text"},t))))))))),JC=H()(B.EuiFlexItem).withConfig({displayName:"LandingImageCardItem",componentId:"sc-dlsynk-7"})(["max-width:","px;"],320),YC=H.a.span.withConfig({displayName:"LandingCardDescription",componentId:"sc-dlsynk-8"})(["font-size:",";padding-top:",";"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeXS)),XC=H()(B.EuiCard).withConfig({displayName:"PrimaryTitleCard",componentId:"sc-dlsynk-9"})([".euiCard__title{color:",";}"],(e=>e.theme.eui.euiColorPrimary)),ZC=Object(ue.p)(XC),eM=i.a.memo((({items:e})=>i.a.createElement(B.EuiFlexGroup,{direction:"row",wrap:!0},e.map((({id:e,image:t,title:a,description:n,isBeta:s,betaOptions:r})=>i.a.createElement(JC,{key:e,"data-test-subj":"LandingImageCard-item",grow:!1},i.a.createElement(ZC,{deepLinkId:e,hasBorder:!0,textAlign:"left",paddingSize:"m",image:t&&i.a.createElement(B.EuiImage,{"data-test-subj":"LandingImageCard-image",role:"presentation",size:320,alt:a,src:t}),title:i.a.createElement(zC,{size:"xs"},i.a.createElement(QC,null,i.a.createElement(WC,null,a),s&&i.a.createElement(BC.a,{text:null==r?void 0:r.text}))),description:i.a.createElement(YC,null,n)})))))));eM.displayName="LandingImageCards";const tM=N.i18n.translate("xpack.securitySolution.landing.threatHunting.pageTitle",{defaultMessage:"Explore"}),aM=N.i18n.translate("xpack.securitySolution.landing.dashboards.pageTitle",{defaultMessage:"Dashboards"}),nM=N.i18n.translate("xpack.securitySolution.landing.dashboards.createButton",{defaultMessage:"Create Dashboard"}),iM=N.i18n.translate("xpack.securitySolution.landing.dashboards.section.default",{defaultMessage:"DEFAULT"}),sM=N.i18n.translate("xpack.securitySolution.landing.dashboards.section.custom",{defaultMessage:"CUSTOM"}),rM=N.i18n.translate("xpack.securitySolution.landing.manage.pageTitle",{defaultMessage:"Manage"}),oM=()=>{var e,t;const a=null!==(e=null===(t=Object(LC.b)(v.a.exploreLanding))||void 0===t?void 0:t.links)&&void 0!==e?e:[];return i.a.createElement(f.a,null,i.a.createElement(Yt.a,{title:tM}),i.a.createElement(KC,{items:a}),i.a.createElement(h.a,{pageName:v.a.exploreLanding}))};var lM=a(201);const cM="Security Solution",uM=async e=>{var t;return null===(t=(await e.find({type:"tag",searchFields:["name"],search:cM})).savedObjects.find((({attributes:e})=>e.name===cM)))||void 0===t?void 0:t.id},dM=async e=>{const t=await uM(e);return t?(await e.find({type:"dashboard",hasReference:{id:t,type:"tag"}})).savedObjects:[]},pM=N.i18n.translate("xpack.securitySolution.dashboards.title",{defaultMessage:"Title"}),mM=N.i18n.translate("xpack.securitySolution.dashboards.description",{defaultMessage:"Description"}),gM=N.i18n.translate("xpack.securitySolution.dashboards.queryError",{defaultMessage:"Error retrieving security dashboards"}),fM={sort:{field:"title",direction:"asc"}},bM=()=>{const{items:e,isLoading:t,error:a}=(()=>{const{savedObjects:{client:e}}=Object(u.k)().services,{fetch:t,data:a,isLoading:i,error:s}=Object(Xr.b)(Xr.a.SECURITY_DASHBOARDS,dM);return Object(n.useEffect)((()=>{e&&t(e)}),[t,e]),{items:Object(n.useMemo)((()=>a?a.map((e=>{var t,a,n,i;return{...e,title:null!==(t=null===(a=e.attributes.title)||void 0===a?void 0:a.toString())&&void 0!==t?t:void 0,description:null!==(n=null===(i=e.attributes.description)||void 0===i?void 0:i.toString())&&void 0!==n?n:void 0}})):[]),[a]),isLoading:i,error:s}})(),s=(()=>{const{savedObjectsTagging:e,dashboard:t}=Object(u.k)().services,{navigateTo:a}=Object(u.l)(),s=Object(n.useCallback)((e=>t=>{t.preventDefault(),a({url:e})}),[a]);return Object(n.useMemo)((()=>[{field:"title",name:pM,sortable:!0,render:(e,{id:a})=>{var n;const r=null==t||null===(n=t.locator)||void 0===n?void 0:n.getRedirectUrl({dashboardId:a});return r?i.a.createElement(ue.f,{href:r,onClick:s(r)},e):e},"data-test-subj":"dashboardTableTitleCell"},{field:"description",name:mM,sortable:!0,render:e=>e||"-","data-test-subj":"dashboardTableDescriptionCell"},...e?[e.ui.getTableColumnDefinition()]:[]]),[s,t,e])})(),{addError:r}=Object(ma.a)(),[o,l]=Object(n.useState)(e),[c,d]=Object(n.useState)(""),p=Object(n.useMemo)((()=>{const e=Object($h.debounce)(d,250);return{onChange:({queryText:t})=>{var a;e(null!==(a=t.toLowerCase())&&void 0!==a?a:"")},box:{incremental:!0}}}),[]);return Object(n.useEffect)((()=>{0===c.length?l(e):l(e.filter((({title:e,description:t})=>`${e} ${t}`.toLowerCase().includes(c.replace(/[^\w- ]/g,"")))))}),[e,c]),Object(n.useEffect)((()=>{a&&r(a,{title:gM})}),[a,r]),i.a.createElement(B.EuiInMemoryTable,{"data-test-subj":"dashboardsTable",items:o,columns:s,search:p,pagination:!0,sorting:fM,loading:t})};var hM=a(643);const yM=({canCreateDashboard:e})=>{const{isLoading:t,url:a}=(()=>{const{dashboard:{locator:e}={},savedObjects:{client:t},savedObjectsTagging:a}=Object(u.k)().services,[i,s]=Object(n.useState)(null);return Object(n.useEffect)((()=>{let e=!1;return(async()=>{if(t&&a){let n=await uM(t);n||(n=(await(async e=>await e.create({name:cM,description:"Security Solution auto-generated tag",color:`#${String(Math.floor(16777215*Math.random()).toString(16)).padStart(6,"0")}`}))(a.client)).id),e||s(n)}})(),()=>{e=!0}}),[t,a]),Object(n.useMemo)((()=>{var t;return{isLoading:null==i,url:i&&null!==(t=null==e?void 0:e.getRedirectUrl({tags:[i]}))&&void 0!==t?t:""}}),[i,e])})(),{navigateTo:s}=Object(u.l)();return i.a.createElement(B.EuiFlexGroup,{gutterSize:"none",direction:"row"},i.a.createElement(B.EuiFlexItem,null,i.a.createElement(hM.a,{title:aM})),e&&i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(B.EuiButton,{isDisabled:t,color:"primary",fill:!0,iconType:"plusInCircle",href:a,onClick:e=>{e.preventDefault(),s({url:a})},"data-test-subj":"createDashboardButton"},nM)))},EM=()=>{var e,t;const a=null!==(e=null===(t=Object(LC.b)(v.a.dashboardsLanding))||void 0===t?void 0:t.links)&&void 0!==e?e:[],{show:n,createNew:s}=Object(u.f)(lM.DashboardConstants.DASHBOARD_ID);return i.a.createElement(f.a,null,i.a.createElement(yM,{canCreateDashboard:s}),i.a.createElement(B.EuiSpacer,{size:"xl"}),i.a.createElement(B.EuiTitle,{size:"xxxs"},i.a.createElement("h2",null,iM)),i.a.createElement(B.EuiHorizontalRule,{margin:"s"}),i.a.createElement(eM,{items:a}),i.a.createElement(B.EuiSpacer,{size:"xxl"}),n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiTitle,{size:"xxxs"},i.a.createElement("h2",null,sM)),i.a.createElement(B.EuiHorizontalRule,{margin:"s"}),i.a.createElement(B.EuiSpacer,{size:"m"}),i.a.createElement(bM,null)),i.a.createElement(h.a,{pageName:v.a.dashboardsLanding}))},vM=H.a.a.withConfig({displayName:"Link",componentId:"sc-r94plg-0"})(["color:inherit;"]),kM=Object(ue.p)(vM),SM=H()(B.EuiFlexItem).withConfig({displayName:"Description",componentId:"sc-r94plg-1"})(["max-width:22em;"]),TM=H()(B.EuiTitle).withConfig({displayName:"StyledEuiTitle",componentId:"sc-r94plg-2"})(["margin-top:",";margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiSizeXS)),xM=({items:e})=>i.a.createElement(B.EuiFlexGrid,{columns:3,gutterSize:"xl"},e.map((({title:e,description:t,id:a,icon:n,isBeta:s,betaOptions:r})=>i.a.createElement(B.EuiFlexItem,{key:a,"data-test-subj":"LandingItem"},i.a.createElement(B.EuiFlexGroup,{direction:"column",alignItems:"flexStart",gutterSize:"none",responsive:!1},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(kM,{tabIndex:-1,deepLinkId:a},i.a.createElement(B.EuiIcon,{"aria-hidden":"true",size:"xl",type:null!=n?n:"",role:"presentation"}))),i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(TM,{size:"xxs"},i.a.createElement(B.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(ue.k,{deepLinkId:a},i.a.createElement("h2",null,e))),s&&i.a.createElement(B.EuiFlexItem,{grow:!1},i.a.createElement(BC.a,{text:null==r?void 0:r.text}))))),i.a.createElement(SM,null,i.a.createElement(B.EuiText,{size:"s",color:"text"},t))))))),wM=()=>i.a.createElement(f.a,null,i.a.createElement(Yt.a,{title:rM}),i.a.createElement(jM,null),i.a.createElement(h.a,{pageName:v.a.administration})),OM=H()(B.EuiHorizontalRule).withConfig({displayName:"StyledEuiHorizontalRule",componentId:"sc-1negbtf-0"})(["margin-top:",";margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiSizeL)),jM=()=>{const e=(()=>{var e;const{links:t=[],categories:a=[]}=null!==(e=Object(LC.b)(v.a.administration))&&void 0!==e?e:{},n=Object.fromEntries(t.map((e=>[e.id,e])));return a.reduce(((e,{label:t,linkIds:a})=>{const i=a.reduce(((e,t)=>(n[t]&&e.push(n[t]),e)),[]);return i.length>0&&e.push({label:t,links:i}),e}),[])})();return i.a.createElement(i.a.Fragment,null,e.map((({label:e,links:t},a)=>i.a.createElement("div",{key:e},a>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(B.EuiSpacer,{key:"first",size:"xl"}),i.a.createElement(B.EuiSpacer,{key:"second",size:"xl"})),i.a.createElement(B.EuiTitle,{size:"xxxs"},i.a.createElement("h2",null,e)),i.a.createElement(OM,null),i.a.createElement(xM,{items:t})))))};jM.displayName="ManagementCategories";const IM=[{path:r.Fb,component:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:v.a.exploreLanding},i.a.createElement(oM,null)))},{path:r.G,component:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:v.a.dashboardsLanding},i.a.createElement(EM,null)))},{path:r.Qb,component:()=>i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:v.a.administration},i.a.createElement(wM,null)))}];var CM=a(63),MM=a(380);const DM=({pageName:e})=>i.a.createElement(h.a,{pageName:e}),AM=Object(n.memo)((()=>{const{cloudSecurityPosture:e}=Object(u.k)().services,t=Object(MM.b)(),a=e.getCloudSecurityPostureRouter(),n={getFiltersGlobalComponent:()=>Q.a,getSpyRouteComponent:()=>DM,getManageBreadcrumbEntry:()=>t?{name:hE.t,path:r.Qb}:void 0};return i.a.createElement(A,null,i.a.createElement(s.TrackApplicationView,{viewId:"cloud_security_posture"},i.a.createElement(f.a,{noPadding:!0,noTimeline:!0},i.a.createElement(a,{securitySolutionContext:n}))))}));AM.displayName="CloudSecurityPosture";const FM=[{path:CM.CLOUD_SECURITY_POSTURE_BASE_PATH,render:()=>i.a.createElement(AM,null)}];var RM=a(110),PM=a(439);const _M=({dataProviders:e,from:t,to:a})=>{const{data:{query:i}}=Object(u.k)().services,s=Object(o.useDispatch)(),{startTransaction:l}=Object(bl.a)(),c=Object(n.useMemo)((()=>i.filterManager),[i.filterManager]),p=Object(n.useMemo)((()=>d.b.getManageTimelineById()),[]),{filterManager:m}=Object(E.a)((e=>{var t;return p(e,null!==(t=jc.c.active)&&void 0!==t?t:"")})),g=Object(n.useMemo)((()=>null!=m?m:c),[m,c]),f=Object(n.useCallback)((e=>s(d.a.updateIsLoading(e))),[s]),b=Object(PM.a)({timelineId:jc.c.active,timelineType:jc.f.default}),h=Object(n.useCallback)((({from:e,timeline:t,to:a,ruleNote:n})=>{var i;b(),f({id:jc.c.active,isLoading:!1}),Object(Nb.b)(s)({duplicate:!0,from:e,id:jc.c.active,notes:[],timeline:{...t,filterManager:g,indexNames:null!==(i=t.indexNames)&&void 0!==i?i:[],show:!0},to:a,ruleNote:n})()}),[s,g,f,b]);return Object(n.useCallback)((async()=>{l({name:`${r.A} threat indicator investigateInTimeline`}),await h({from:t,notes:null,timeline:{...ge.a,dataProviders:e,id:jc.c.active,indexNames:[],dateRange:{start:t,end:a},eventType:"all",filters:[],kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:a,ruleNote:""})}),[l,h,e,t,a])},qM=Object(n.memo)((()=>{const{threatIntelligence:e}=Object(u.k)().services,t=e.getComponent(),a=Object(p.d)(),n=Object(fn.e)(),r={getFiltersGlobalComponent:()=>Q.a,getPageWrapper:()=>f.a,licenseService:Sc.a,sourcererDataView:a,getSecuritySolutionStore:n,getUseInvestigateInTimeline:_M};return i.a.createElement(s.TrackApplicationView,{viewId:"threat_intelligence"},i.a.createElement(t,{securitySolutionContext:r}),i.a.createElement(h.a,{pageName:v.a.threatIntelligenceIndicators}))}));qM.displayName="ThreatIntelligence";const NM=[{path:RM.THREAT_INTELLIGENCE_BASE_PATH,render:()=>i.a.createElement(qM,null)}],LM={Detections:class detections_Detections{setup(){}start(e){return{storageTimelines:{timelineById:Object(R.b)(e,ca)},routes:la}}},Cases:class cases_Cases{setup(){}start(){return{routes:F}}},Exceptions:class exceptions_Exceptions{setup(){}start(e){return{storageTimelines:{timelineById:Object(R.b)(e,ca)},routes:tn}}},Hosts:class public_hosts_Hosts{setup(){}start(e){return{routes:dd,storageTimelines:{timelineById:Object(R.b)(e,pd)},store:{initialState:{hosts:Rn.e},reducer:{hosts:Rn.c}}}}},Users:class public_users_Users{setup(){}start(e){return{routes:pm,store:{initialState:{users:kd.a},reducer:{users:kd.d}}}}},Network:class public_network_Network{setup(){}start(e){return{routes:Cf,storageTimelines:{timelineById:Object(R.b)(e,[l.i.networkPageEvents])},store:{initialState:{network:hf.a},reducer:{network:hf.d}}}}},Kubernetes:class kubernetes_Kubernetes{setup(){}start(){return{routes:Bf}}},Overview:class overview_Overview{setup(){}start(){return{routes:Av}}},Rules:class rules_Rules{setup(){}start(e){return{storageTimelines:{timelineById:Object(R.b)(e,ca)},routes:Fw}}},Timelines:class timelines_Timelines{setup(){}start(){return{routes:Uw,store:{initialState:{timeline:Gw},reducer:{timeline:Kw}}}}},Management:class management_Management{setup(){}start(e,t){return{routes:_C,store:{initialState:{management:{}},reducer:{management:qC.a},middleware:Object(NC.a)(e,t)}}}},LandingPages:class landing_pages_LandingPages{setup(){}start(){return{routes:IM}}},CloudSecurityPosture:class cloud_security_posture_CloudSecurityPosture{setup(){}start(){return{routes:FM}}},ThreatIntelligence:class threat_intelligence_ThreatIntelligence{setup(){}start(){return{routes:NM}}}}}])]);