/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(t){function e(e){for(var n,r,o=e[0],s=e[1],u=0,c=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&c.push(i[r][0]),i[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);for(l&&l(e);c.length;)c.shift()()}var n={},i={0:0};function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(t){var e=[],n=i[t];if(0!==n)if(n)e.push(n[2]);else{var o=new Promise((function(e,r){n=i[t]=[e,r]}));e.push(n[2]=o);var s,u=document.createElement("script");u.charset="utf-8",u.timeout=120,r.nc&&u.setAttribute("nonce",r.nc),u.src=function(t){return r.p+"cloud.chunk."+t+".js"}(t);var l=new Error;s=function(e){u.onerror=u.onload=null,clearTimeout(c);var n=i[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",l.name="ChunkLoadError",l.type=r,l.request=o,n[1](l)}i[t]=void 0}};var c=setTimeout((function(){s({type:"timeout",target:u})}),12e4);u.onerror=u.onload=s,document.head.appendChild(u)}return Promise.all(e)},r.m=t,r.c=n,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r.oe=function(t){throw console.error(t),t};var o=window.cloud_bundle_jsonpfunction=window.cloud_bundle_jsonpfunction||[],s=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=s;r(r.s=12)}([function(t,e,n){t.exports=n(5)(2)},function(t,e){t.exports=__kbnSharedDeps__.React},function(t,e){t.exports=__kbnSharedDeps__.EmotionReact},function(t,e){t.exports=__kbnSharedDeps__.Rxjs},function(t,e){t.exports=__kbnSharedDeps__.KbnI18n},function(t,e){t.exports=__kbnSharedDeps_npm__},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return h}));var i=n(7),r=n.n(i),o=n(8),s=n.n(o),u=n(0),l=n.n(u),c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64),h=function(){function e(){r()(this,e),l()(this,"_a",void 0),l()(this,"_b",void 0),l()(this,"_c",void 0),l()(this,"_d",void 0),l()(this,"_e",void 0),l()(this,"_f",void 0),l()(this,"_g",void 0),l()(this,"_h",void 0),l()(this,"_block",void 0),l()(this,"_finalSize",void 0),l()(this,"_blockSize",void 0),l()(this,"_len",void 0),l()(this,"_s",void 0),l()(this,"_w",void 0),this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this._w=a,this._block=t.alloc(64),this._finalSize=56,this._blockSize=64,this._len=0,this._s=0}return s()(e,[{key:"update",value:function(e,n){"string"==typeof e&&(n=n||"utf8",e=t.from(e,n));for(var i=this._len+=e.length,r=this._s||0,o=0,s=this._block;r<i;){for(var u=Math.min(e.length,o+this._blockSize-r%this._blockSize)-o,l=0;l<u;l++)s[r%this._blockSize+l]=e[l+o];o+=u,(r+=u)%this._blockSize==0&&this._update(s)}return this._s=r,this}},{key:"digest",value:function(t){var e=8*this._len;return this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),e%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(e,this._blockSize-4),this._update(this._block),this._hash().toString(t)}},{key:"_update",value:function(t){var e,n,i=this._w,r=0|this._a,o=0|this._b,s=0|this._c,u=0|this._d,l=0|this._e,a=0|this._f,h=0|this._g,v=0|this._h;for(e=0;e<16;++e)i[e]=t.readInt32BE(4*e);for(;e<64;++e)i[e]=0|(((n=i[e-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10)+i[e-7]+b(i[e-15])+i[e-16];for(var y=0;y<64;++y){var g=v+p(l)+d(l,a,h)+c[y]+i[y]|0,m=_(r)+f(r,o,s)|0;v=h,h=a,a=l,l=u+g|0,u=s,s=o,o=r,r=g+m|0}this._a=r+this._a|0,this._b=o+this._b|0,this._c=s+this._c|0,this._d=u+this._d|0,this._e=l+this._e|0,this._f=a+this._f|0,this._g=h+this._g|0,this._h=v+this._h|0}},{key:"_hash",value:function(){var e=t.alloc(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e}}]),e}();function d(t,e,n){return n^t&(e^n)}function f(t,e,n){return t&e|n&(t|e)}function _(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function p(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function b(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}}).call(this,n(14).Buffer)},function(t,e,n){t.exports=n(5)(16)},function(t,e,n){t.exports=n(5)(17)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));var i=n(1),r=n(2);const o=Object(i.createContext)({chat:{enabled:!1}}),s=({children:t,...e})=>Object(r.jsx)(o.Provider,{value:e},t);function u(){const{chat:t}=Object(i.useContext)(o);return t}},function(t,e){t.exports=__kbnSharedDeps__.ElasticEui},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(15),r=n(1),o=i.__importDefault(n(16));e.default=function(t,e){var n=r.useState(e),i=n[0],s=n[1];return o.default((function(){var e=t.subscribe(s);return function(){return e.unsubscribe()}}),[t]),i}},function(t,e,n){n(13),__kbnBundles__.define("plugin/cloud/public",n,17)},function(t,e,n){n.p=window.__kbnPublicPath__.cloud},function(t,e,n){t.exports=n(5)(2667)},function(t,e){t.exports=__kbnSharedDeps__.TsLib},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r="undefined"!=typeof window?i.useLayoutEffect:i.useEffect;e.default=r},function(t,e,n){"use strict";n.r(e),n.d(e,"plugin",(function(){return g})),n.d(e,"Chat",(function(){return y}));var i=n(0),r=n.n(i),o=n(1),s=n.n(o),u=n(4),l=n(11),c=n.n(l),a=n(3),h=n(6);function d(t,e){return t&&e?`${t}${e}`:""}var f=n(9),_=n(2);class plugin_CloudPlugin{constructor(t){r()(this,"config",void 0),r()(this,"isCloudEnabled",void 0),r()(this,"chatConfig$",new a.BehaviorSubject({enabled:!1})),this.initializerContext=t,this.config=this.initializerContext.config.get(),this.isCloudEnabled="string"==typeof this.config.id}setup(t,{cloudExperiments:e,home:n,security:i}){this.setupTelemetryContext(t.analytics,i,this.config.id),this.setupFullStory({analytics:t.analytics,basePath:t.http.basePath}).catch((t=>console.debug(`Error setting up FullStory: ${t.toString()}`)));const{id:r,cname:o,profile_url:s,organization_url:u,deployment_url:l,base_url:c}=this.config;this.isCloudEnabled&&r&&(null==e||e.identifyUser(p(r),{kibanaVersion:this.initializerContext.env.packageInfo.version})),this.setupChat({http:t.http,security:i}).catch((t=>console.debug(`Error setting up Chat: ${t.toString()}`))),n&&(n.environment.update({cloud:this.isCloudEnabled}),this.isCloudEnabled&&n.tutorials.setVariable("cloud",{id:r,baseUrl:c,profileUrl:s,deploymentUrl:l}));const a=d(c,l);return{cloudId:r,cname:o,baseUrl:c,deploymentUrl:a,profileUrl:d(c,s),organizationUrl:d(c,u),snapshotsUrl:`${a}/elasticsearch/snapshots/`,isCloudEnabled:this.isCloudEnabled}}start(t,{security:e}){const{deployment_url:n,base_url:i}=this.config;t.chrome.setHelpSupportUrl("https://cloud.elastic.co/support");const r=r=>{if(r&&(i&&n&&t.chrome.setCustomNavLink({title:u.i18n.translate("xpack.cloud.deploymentLinkLabel",{defaultMessage:"Manage this deployment"}),euiIconType:"logoCloud",href:d(i,n)}),e&&this.isCloudEnabled)){const t=(t=>{const{profile_url:e,organization_url:n,base_url:i}=t,r=[];return i&&e&&r.push({label:u.i18n.translate("xpack.cloud.userMenuLinks.profileLinkText",{defaultMessage:"Edit profile"}),iconType:"user",href:d(i,e),order:100,setAsProfile:!0}),i&&n&&r.push({label:u.i18n.translate("xpack.cloud.userMenuLinks.accountLinkText",{defaultMessage:"Account & Billing"}),iconType:"gear",href:d(i,n),order:200}),r})(this.config);e.navControlService.addUserMenuLinks(t)}};return this.checkIfAuthorizedForLinks({http:t.http,security:e}).then(r).catch((()=>r(!0))),{CloudContextProvider:({children:t})=>{const e=c()(this.chatConfig$,{enabled:!1});return Object(_.jsx)(f.a,{chat:e},t)}}}stop(){}async checkIfAuthorizedForLinks({http:t,security:e}){var n;if(t.anonymousPaths.isAnonymous(window.location.pathname))return!1;if(!e)return!0;const i=await e.authc.getCurrentUser().catch((()=>null));return null===(n=null==i?void 0:i.elastic_cloud_user)||void 0===n||n}async setupFullStory({analytics:t,basePath:e}){const{enabled:i,org_id:r,eventTypesAllowlist:o}=this.config.full_story;if(!i||!r)return;const{FullStoryShipper:s}=await n.e(1).then(n.bind(null,25));t.registerShipper(s,{eventTypesAllowlist:o,fullStoryOrgId:r,scriptUrl:e.prepend(`/internal/cloud/${this.initializerContext.env.packageInfo.buildNum}/fullstory.js`),namespace:"FSKibana"})}setupTelemetryContext(t,e,n){!function(t,e){e&&t.registerContextProvider({name:"Cloud Deployment ID",context$:Object(a.of)({cloudId:e}),schema:{cloudId:{type:"keyword",_meta:{description:"The Cloud Deployment ID"}}}})}(t,n),e&&t.registerContextProvider({name:"cloud_user_id",context$:Object(a.from)(e.authc.getCurrentUser()).pipe(Object(a.map)((t=>t.elastic_cloud_user?{userId:t.username,isElasticCloudUser:!0}:{userId:n?`${n}:${t.username}`:t.username,isElasticCloudUser:!1})),Object(a.map)((({userId:t,isElasticCloudUser:e})=>({userId:p(t),isElasticCloudUser:e}))),Object(a.catchError)((()=>Object(a.of)({userId:void 0,isElasticCloudUser:!1})))),schema:{userId:{type:"keyword",_meta:{description:"The user id scoped as seen by Cloud (hashed)"}},isElasticCloudUser:{type:"boolean",_meta:{description:"`true` if the user is managed by ESS."}}}})}async setupChat({http:t,security:e}){if(!this.isCloudEnabled)return;const{enabled:n,chatURL:i}=this.config.chat;if(e&&n&&i)try{const{email:e,id:r,token:o}=await t.get("/internal/cloud/chat_user");if(!e||!r||!o)return;this.chatConfig$.next({enabled:n,chatURL:i,user:{email:e,id:r,jwt:o}})}catch(t){console.debug(`[cloud.chat] Could not retrieve chat config: ${t.res.status} ${t.message}`,t)}}}function p(t){return(new h.a).update(t,"utf8").digest("hex")}var b=n(10);const v=s.a.lazy((()=>n.e(2).then(n.bind(null,26)).then((({Chat:t})=>({default:t}))))),y=()=>Object(_.jsx)(b.EuiErrorBoundary,null,Object(_.jsx)(o.Suspense,{fallback:Object(_.jsx)("div",null)},Object(_.jsx)(v,null)));function g(t){return new plugin_CloudPlugin(t)}},function(t,e){t.exports=__kbnSharedDeps__.Moment},function(t,e){t.exports=__kbnSharedDeps__.KbnUiTheme}]);