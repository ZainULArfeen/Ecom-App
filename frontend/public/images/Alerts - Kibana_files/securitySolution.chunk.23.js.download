/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[23],{1217:function(e,t,a){"use strict";a.r(t),a.d(t,"QueryTabContentComponent",(function(){return ft})),a.d(t,"default",(function(){return Et}));var i=a(17),r=a(3),l=a(4),n=a.n(l),o=a(24),s=a.n(o),d=a(47),c=a(92),u=a.n(c),m=a(323),p=a(180),g=a(177),h=a(8),v=a(296),y=a(91),b=a(899),f=a(19),E=a(80),I=a(878),x=a(901),O=a(346),k=a(50),w=a.n(k),P=a(93),S=a(13),C=a(207),j=a(76),F=a(53),M=a.n(F),D=a(187);const N=s.a.div.withConfig({displayName:"ReactDndDropTarget",componentId:"sc-zu5fvf-0"})(["transition:background-color 0.7s ease;width:100%;height:",";.flyout-overlay{.euiPanel{background-color:",";}}"," > div.timeline-drop-area{.drop-and-provider-timeline{display:none;}& + div{display:none !important;}}"],(({height:e})=>e),(e=>e.theme.eui.euiFormBackgroundColor),(e=>e.isDraggingOver?`\n    .drop-and-provider-timeline {\n      &:hover {\n        background-color: ${Object(O.rgba)(e.theme.eui.euiColorSuccess,.3)};\n      }\n    }\n    .drop-and-provider-timeline:hover {\n        background-color: ${Object(O.rgba)(e.theme.eui.euiColorSuccess,.3)};\n    }\n  > div.timeline-drop-area-empty {\n     color: ${e.theme.eui.euiColorSuccess};\n     background-color: ${Object(O.rgba)(e.theme.eui.euiColorSuccess,.2)};\n\n     & .timeline-drop-area-empty__text {\n      color: ${e.theme.eui.euiColorSuccess};\n     }\n  }\n  > div.timeline-drop-area {\n    background-color: ${Object(O.rgba)(e.theme.eui.euiColorSuccess,.2)};\n    .provider-item-filter-container div:first-child{\n      /* Override dragNdrop beautiful so we do not have our droppable moving around for no good reason */\n      transform: none !important;\n    }\n    .drop-and-provider-timeline {\n      display: block !important;\n      + div {\n        display: none;\n      }\n    }\n\n    & .euiFormHelpText {\n      color: ${e.theme.eui.euiColorSuccess};\n    }\n  }\n  .flyout-overlay {\n    .euiPanel {\n      background-color: ${e.theme.eui.euiColorLightShade};\n    }\n    + div {\n      /* Override dragNdrop beautiful so we do not have our droppable moving around for no good reason */\n      display: none !important;\n    }\n  }\n  `:""));N.displayName="ReactDndDropTarget";const T=n.a.memo((({children:e=null,droppableId:t,height:a="100%",isDropDisabled:i=!1,type:r,render:o=null,renderClone:s})=>{const d=Object(l.useCallback)(((t,i)=>n.a.createElement(N,M()({height:a,ref:t.innerRef},t.droppableProps,{isDraggingOver:i.isDraggingOver}),null==o?e:o({isDraggingOver:i.isDraggingOver}),t.placeholder)),[e,a,o]);return n.a.createElement(D.Droppable,{isDropDisabled:i,droppableId:t,direction:"horizontal",type:r,renderClone:s},d)}));T.displayName="DroppableWrapper";var q=a(220),Q=a(426),z=a(15),_=a(1010),K=a(635),R=a(35),B=a(511);const $=s.a.div.withConfig({displayName:"AddFieldPopoverContainer",componentId:"sc-gueb-0"})(["min-width:350px;"]),A=({browserFields:e,timelineId:t})=>{const a=Object(d.useDispatch)(),[o,s]=Object(l.useState)(!1),c=Object(l.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),{dataProviders:u,timelineType:m}=Object(j.a)((e=>Object(r.pick)(["dataProviders","timelineType"],c(e,t)))),p=Object(l.useCallback)((()=>s(!o)),[s,o]),g=Object(l.useCallback)((()=>s(!1)),[s]),h=Object(l.useCallback)((({andProviderId:e,excluded:i,field:r,id:l,operator:n,providerId:o,value:s,type:d})=>{Object(K.b)({dataProviders:u,destination:{droppableId:`droppableId.timelineProviders.${t}.group.${u.length}`,index:0},dispatch:a,onAddedToTimeline:g,providerToAdd:{id:o,name:s,enabled:!0,excluded:i,kqlQuery:"",type:d,queryMatch:{displayField:void 0,displayValue:void 0,field:r,value:s,operator:n},and:[]},timelineId:t})}),[u,t,a,g]),v=Object(l.useMemo)((()=>[{id:0,width:400,items:[{name:B.a,icon:n.a.createElement(i.EuiIcon,{type:"plusInCircle",size:"m"}),panel:1},m===z.m.template?{disabled:m!==z.m.template,name:B.b,icon:n.a.createElement(i.EuiIcon,{type:"visText",size:"m"}),panel:2}:null].filter((e=>null!==e))},{id:1,title:B.a,width:400,content:n.a.createElement(_.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:h,operator:":",timelineId:t,value:"",type:R.a.default,providerId:`${t}-${w.a.v4()}`})},{id:2,title:B.b,width:400,content:n.a.createElement(_.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:h,operator:":",timelineId:t,value:"",type:R.a.template,providerId:`${t}-${w.a.v4()}`})}]),[e,h,t,m]),b=Object(l.useMemo)((()=>m===z.m.template?n.a.createElement(i.EuiButton,{size:"s",onClick:p,"data-test-subj":"addField",iconType:"arrowDown",fill:!0,iconSide:"right"},n.a.createElement(i.EuiText,{size:"s"},B.a)):n.a.createElement(i.EuiButtonEmpty,{size:"s",onClick:p,"data-test-subj":"addField",iconSide:"right"},n.a.createElement(i.EuiText,{size:"s"},`+ ${B.a}`))),[p,m]),f=Object(l.useMemo)((()=>m===z.m.template?n.a.createElement(i.EuiContextMenu,{initialPanelId:0,panels:v}):n.a.createElement(_.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:h,operator:":",timelineId:t,value:"",type:R.a.default,providerId:`${t}-${w.a.v4()}`})),[e,h,v,t,m]);return n.a.createElement(i.EuiPopover,{id:"addFieldsPopover",button:b,isOpen:o,closePopover:g,anchorPosition:"downLeft",panelPaddingSize:"none",repositionOnScroll:!0},n.a.createElement($,null,f))};A.displayName="AddDataProviderPopoverComponent";const L=n.a.memo(A);L.displayName="AddDataProviderPopover";const W=s()(i.EuiText).withConfig({displayName:"Text",componentId:"sc-1dcwhn2-0"})(["overflow:hidden;margin:5px 0 5px 0;padding:3px;white-space:nowrap;"]);W.displayName="Text";const H=s()(i.EuiBadge).withConfig({displayName:"BadgeHighlighted",componentId:"sc-1dcwhn2-1"})(["height:20px;margin:0 5px 0 5px;maxwidth:85px;minwidth:85px;"]);H.displayName="BadgeHighlighted";const U=s.a.span.withConfig({displayName:"HighlightedBackground",componentId:"sc-1dcwhn2-2"})(["background-color:",";"],(e=>e.theme.eui.euiColorLightShade));U.displayName="HighlightedBackground";const G=s.a.div.withConfig({displayName:"EmptyContainer",componentId:"sc-1dcwhn2-3"})(["width:",";align-items:center;display:flex;flex-direction:column;flex-wrap:wrap;justify-content:center;user-select:none;align-content:center;",""],(e=>e.showSmallMsg?"60px":"auto"),(e=>e.showSmallMsg?`\n      border-right: 1px solid ${e.theme.eui.euiColorMediumShade};\n      margin-right: 10px;\n    `:"\n  min-height: 100px;\n  + div {\n    display: none !important;\n   }\n  "));G.displayName="EmptyContainer";const V=s.a.div.withConfig({displayName:"NoWrap",componentId:"sc-1dcwhn2-4"})(["align-items:center;display:flex;flex-direction:row;flex-wrap:no-wrap;"]);V.displayName="NoWrap";const X=n.a.memo((({showSmallMsg:e=!1,browserFields:t,timelineId:a})=>n.a.createElement(G,{className:"timeline-drop-area-empty","data-test-subj":"empty",showSmallMsg:e},!e&&n.a.createElement(n.a.Fragment,null,n.a.createElement(V,null,n.a.createElement(W,{color:"subdued",size:"s",className:"timeline-drop-area-empty__text"},B.f),n.a.createElement(U,null,n.a.createElement(H,{className:"highlighted-drop-target"},B.n)),n.a.createElement(W,{color:"subdued",size:"s",className:"timeline-drop-area-empty__text"},B.m),n.a.createElement(Q.a,{type:"or"}),n.a.createElement(W,{color:"subdued",size:"s",className:"timeline-drop-area-empty__text"},B.q)),n.a.createElement(L,{browserFields:t,timelineId:a})),e&&n.a.createElement(Q.a,{type:"or"}))));X.displayName="Empty";var Y=a(1009);const J={alignItems:"center",display:"flex",height:"36px",minWidth:"125px"},Z=s.a.div.withConfig({displayName:"DroppableContainer",componentId:"sc-cfhrc0-0"})(["min-height:","px;height:auto !important;."," &:hover{background-color:"," !important;}"],36,P.d,(({theme:e})=>Object(O.rgba)(e.eui.euiColorSuccess,.2))),ee=s.a.span.withConfig({displayName:"Parens",componentId:"sc-cfhrc0-1"})(["color:",";font-size:32px;padding:2px;user-select:none;"],(({theme:e})=>e.eui.euiColorMediumShade)),te=s.a.div.withConfig({displayName:"AndOrBadgeContainer",componentId:"sc-cfhrc0-2"})(["span{visibility:",";}"],(({hideBadge:e})=>e?"hidden":"inherit")),ae=s.a.div.withConfig({displayName:"LastAndOrBadgeInGroup",componentId:"sc-cfhrc0-3"})(["display:none;."," &{display:initial;}"],P.d),ie=s()(i.EuiFlexItem).withConfig({displayName:"OrFlexItem",componentId:"sc-cfhrc0-4"})(["padding-left:9px;"]);s()(i.EuiFormHelpText).withConfig({displayName:"TimelineEuiFormHelpText",componentId:"sc-cfhrc0-5"})(["padding-top:0px;position:absolute;bottom:0px;left:4px;"]).displayName="TimelineEuiFormHelpText";const re=s()(i.EuiFlexItem).withConfig({displayName:"ParensContainer",componentId:"sc-cfhrc0-6"})(["align-self:center;"]),le=e=>{var t;return null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value},ne=n.a.memo((({browserFields:e,timelineId:t,dataProviders:a})=>{const i=Object(l.useMemo)((()=>[...Object(K.c)(a),...K.a]),[a]),r=Object(l.useMemo)((()=>i.map(((r,l)=>n.a.createElement(se,{key:`droppable-${l}`,group:r,groupIndex:l,isLastGroup:l===i.length-1,browserFields:e,timelineId:t,dataProviders:a})))),[e,i,a,t]);return n.a.createElement("div",null,r)}));ne.displayName="Providers";const oe=n.a.memo((({browserFields:e,group:t,groupIndex:a,dataProvider:r,index:o,timelineId:s})=>{const c=Object(l.useRef)(null),[u,m]=Object(l.useState)(!1),[,p]=Object(l.useState)(!1),g=Object(d.useDispatch)(),{timelines:h}=Object(f.k)().services,v=Object(l.useCallback)((()=>{p((e=>!e))}),[]),b=Object(l.useMemo)((()=>Object(q.m)({dataProviderId:r.id,groupIndex:a,timelineId:s})),[r.id,a,s]),E=Object(l.useCallback)((()=>{const e={id:s,providerId:o>0?t[0].id:r.id,andProviderId:o>0?r.id:void 0};g(y.a.removeProvider(e))}),[r.id,g,t,o,s]),I=Object(l.useCallback)((()=>{const e={id:s,providerId:o>0?t[0].id:r.id,enabled:!r.enabled,andProviderId:o>0?r.id:void 0};g(y.a.updateDataProviderEnabled(e))}),[r.enabled,r.id,g,t,o,s]),x=Object(l.useCallback)((()=>{const e={id:s,providerId:o>0?t[0].id:r.id,excluded:!r.excluded,andProviderId:o>0?r.id:void 0};g(y.a.updateDataProviderExcluded(e))}),[r.excluded,r.id,g,t,o,s]),O=Object(l.useCallback)((()=>{const e={id:s,providerId:o>0?t[0].id:r.id,type:r.type===R.a.template?R.a.default:R.a.template,andProviderId:o>0?r.id:void 0};g(y.a.updateDataProviderType(e))}),[r.id,r.type,g,t,o,s]),k=Object(l.useCallback)((({andProviderId:e,excluded:t,field:a,operator:i,providerId:r,value:l})=>g(y.a.dataProviderEdited({andProviderId:e,excluded:t,field:a,id:s,operator:i,providerId:r,value:l}))),[g,s]),w=Object(l.useCallback)((()=>{var e;null===(e=c.current)||void 0===e||e.focus()}),[]),S=Object(l.useCallback)((()=>{m(!0)}),[]),{onBlur:C,onKeyDown:j}=h.getUseDraggableKeyboardWrapper()({closePopover:v,draggableId:b,fieldName:r.queryMatch.field,keyboardHandlerRef:c,openPopover:S}),F=Object(l.useCallback)((e=>{c.current===document.activeElement&&j(e)}),[j]),N=Object(l.useCallback)(((a,l)=>{var d,p,g,h,v;return n.a.createElement("div",M()({ref:a.innerRef},a.draggableProps,a.dragHandleProps,{style:(v=a.draggableProps.style,{...v,userSelect:"none"}),"data-test-subj":"providerContainer",tabIndex:-1}),n.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(Y.a,{andProviderId:o>0?r.id:void 0,browserFields:e,deleteProvider:E,field:o>0?null!==(d=r.queryMatch.displayField)&&void 0!==d?d:r.queryMatch.field:null!==(p=t[0].queryMatch.displayField)&&void 0!==p?p:t[0].queryMatch.field,kqlQuery:o>0?r.kqlQuery:t[0].kqlQuery,isEnabled:o>0?r.enabled:t[0].enabled,isExcluded:o>0?r.excluded:t[0].excluded,isPopoverOpen:u,onDataProviderEdited:k,operator:o>0?null!==(g=r.queryMatch.operator)&&void 0!==g?g:R.c:null!==(h=t[0].queryMatch.operator)&&void 0!==h?h:R.c,register:r,providerId:o>0?t[0].id:r.id,timelineId:s,setIsPopoverOpen:m,toggleEnabledProvider:I,toggleExcludedProvider:x,toggleTypeProvider:O,val:le(r),type:r.type,wrapperRef:c})),n.a.createElement(i.EuiFlexItem,{grow:!1},!l.isDragging&&(o<t.length-1?n.a.createElement(Q.a,{type:"and"}):n.a.createElement(ae,null,n.a.createElement(Q.a,{type:"and"}))))))}),[e,r,t,k,E,I,x,O,o,u,c,m,s]);return n.a.createElement("div",{className:P.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:w,onBlur:C,onKeyDown:F,ref:c,role:"button",tabIndex:0},n.a.createElement(D.Draggable,{disableInteractiveElementBlocking:!0,draggableId:b,index:o,key:r.id},N))}));oe.displayName="DataProvidersGroupItem";const se=n.a.memo((({browserFields:e,timelineId:t,group:a,groupIndex:r,isLastGroup:o})=>{const s=Object(l.useMemo)((()=>Object(q.n)({groupIndex:r,timelineId:t})),[r,t]),d=Object(l.useMemo)((()=>a.map(((i,l)=>n.a.createElement(oe,{key:i.id,browserFields:e,dataProvider:i,index:l,timelineId:t,group:a,groupIndex:r})))),[e,a,r,t]),c=Object(l.useCallback)((e=>n.a.createElement(Z,M()({className:o?"empty-providers-group":"",ref:e.innerRef,style:J},e.droppableProps),d,e.placeholder)),[d,o]);return n.a.createElement(n.a.Fragment,null,0!==r&&n.a.createElement(i.EuiSpacer,{size:"xs"}),n.a.createElement(i.EuiFlexGroup,{"aria-label":B.l(r),alignItems:"center",gutterSize:"none"},n.a.createElement(ie,{grow:!1},n.a.createElement(te,{hideBadge:0===r},n.a.createElement(Q.a,{type:"or"}))),n.a.createElement(re,{grow:!1},n.a.createElement(ee,null,"(")),n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(D.Droppable,{droppableId:s,direction:"horizontal"},c)),n.a.createElement(re,{grow:!1},n.a.createElement(ee,null,")")),o&&n.a.createElement(L,{browserFields:e,timelineId:t})))}));se.displayName="DataProvidersGroup";var de=a(94);const ce=s.a.div.withConfig({displayName:"DropTargetDataProvidersContainer",componentId:"sc-rnh8sd-0"})(["padding:2px 0 4px 0;."," & .drop-target-data-providers{background:",";border:0.2rem dashed ",";& .timeline-drop-area-empty__text{color:",";}& .euiFormHelpText{color:",";}}"],P.d,(({theme:e})=>Object(O.rgba)(e.eui.euiColorSuccess,.1)),(({theme:e})=>e.eui.euiColorSuccess),(({theme:e})=>e.eui.euiColorSuccess),(({theme:e})=>e.eui.euiColorSuccess)),ue=s.a.div.withConfig({displayName:"DropTargetDataProviders",componentId:"sc-rnh8sd-1"})(["display:flex;flex-direction:column;justify-content:flex-start;padding-bottom:2px;position:relative;border:0.2rem dashed ",";border-radius:5px;padding:"," 0;margin:2px 0 2px 0;max-height:33vh;min-height:100px;overflow:auto;resize:vertical;background-color:",";"],(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiFormBackgroundColor));ue.displayName="DropTargetDataProviders";const me=n.a.memo((({timelineId:e})=>{const{browserFields:t}=Object(C.d)(S.SourcererScopeName.timeline),a=Object(l.useMemo)((()=>y.b.getManageTimelineById()),[]),{isLoading:i}=Object(j.a)((t=>a(t,e))),r=Object(l.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),o=Object(j.a)((t=>{var a;return(null!==(a=r(t,e))&&void 0!==a?a:de.a).dataProviders})),s=Object(l.useMemo)((()=>{return t=e,`${q.g}${t}${w.a.v4()}`;var t}),[e]);return n.a.createElement(ce,{"aria-label":B.r,className:"drop-target-data-providers-container"},n.a.createElement(ue,{className:"drop-target-data-providers","data-test-subj":"dataProviders"},null!=o&&o.length?n.a.createElement(ne,{browserFields:t,timelineId:e,dataProviders:o}):n.a.createElement(T,{isDropDisabled:i,droppableId:s},n.a.createElement(X,{browserFields:t,timelineId:e}))))}));me.displayName="DataProviders";var pe,ge=a(78),he=a(433),ve=a(662),ye=a(11),be=a.n(ye),fe=a(97),Ee=a.n(fe);!function(e){e.BACK="back",e.FORWARD="forward"}(pe||(pe={}));class super_select_EuiSuperSelect extends l.Component{constructor(...e){super(...e),be()(this,"itemNodes",[]),be()(this,"_isMounted",!1),be()(this,"state",{isPopoverOpen:this.props.isOpen||!1}),be()(this,"setItemNode",((e,t)=>{this.itemNodes[t]=e})),be()(this,"openPopover",(()=>{this.setState({isPopoverOpen:!0});const e=()=>{const t=this.props.options.reduce(((e,t,a)=>null!=e?e:null==t?null:t.value===this.props.valueOfSelected?a:null),null);requestAnimationFrame((()=>{this._isMounted&&null!=this.props.valueOfSelected&&(null!=t?this.focusItemAt(t):e())}))};requestAnimationFrame(e)})),be()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),be()(this,"itemClicked",(e=>{this.setState({isPopoverOpen:!1}),this.props.onChange&&this.props.onChange(e)})),be()(this,"onSelectKeyDown",(e=>{e.key!==i.keys.ARROW_UP&&e.key!==i.keys.ARROW_DOWN||(e.preventDefault(),e.stopPropagation(),this.openPopover())})),be()(this,"onItemKeyDown",(e=>{switch(e.key){case i.keys.ESCAPE:e.preventDefault(),e.stopPropagation(),this.closePopover();break;case i.keys.TAB:e.preventDefault(),e.stopPropagation();break;case i.keys.ARROW_UP:e.preventDefault(),e.stopPropagation(),this.shiftFocus(pe.BACK);break;case i.keys.ARROW_DOWN:e.preventDefault(),e.stopPropagation(),this.shiftFocus(pe.FORWARD)}}))}componentDidMount(){this._isMounted=!0,this.props.isOpen&&this.openPopover()}componentWillUnmount(){this._isMounted=!1}focusItemAt(e){const t=this.itemNodes[e];null!=t&&t.focus()}shiftFocus(e){const t=this.itemNodes.indexOf(document.activeElement);let a;a=-1===t?0:e===pe.BACK?0===t?this.itemNodes.length-1:t-1:t===this.itemNodes.length-1?0:t+1,this.focusItemAt(a)}render(){const{className:e,options:t,valueOfSelected:a,onChange:r,isOpen:l,isInvalid:o,hasDividers:s,itemClassName:d,itemLayoutAlign:c,fullWidth:u,popoverProps:m,compressed:p,...g}=this.props,h=Ee()("euiSuperSelect",null==m?void 0:m.className),v=Ee()({"euiSuperSelect--isOpen__button":this.state.isPopoverOpen},e),y=Ee()("euiSuperSelect__item",{"euiSuperSelect__item--hasDividers":s},d),b=n.a.createElement(i.EuiSuperSelectControl,M()({options:t,value:a,onClick:this.state.isPopoverOpen?this.closePopover:this.openPopover,onKeyDown:this.onSelectKeyDown,className:v,fullWidth:u,isInvalid:o,compressed:p},g)),f=t.map(((e,t)=>{const{value:r,dropdownDisplay:l,inputDisplay:o,...s}=e;return n.a.createElement(i.EuiContextMenuItem,M()({key:t,className:y,icon:a===r?"check":"empty",onClick:()=>this.itemClicked(r),onKeyDown:this.onItemKeyDown,layoutAlign:c,buttonRef:e=>this.setItemNode(e,t),role:"option",id:r,"aria-selected":a===r},s),l||o)}));return n.a.createElement(i.EuiInputPopover,M()({},m,{className:h,input:b,isOpen:l||this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",panelClassName:h,fullWidth:u,repositionOnScroll:!0,anchorPosition:"downCenter"}),n.a.createElement(i.EuiScreenReaderOnly,null,n.a.createElement("p",{role:"alert"},n.a.createElement(i.EuiI18n,{token:"euiSuperSelect.screenReaderAnnouncement",default:"You are in a form selector of {optionsCount} items and must select a single option. Use the up and down keys to navigate or escape to close.",values:{optionsCount:t.length}}))),n.a.createElement("div",{className:"euiSuperSelect__listbox",role:"listbox","aria-activedescendant":a,tabIndex:0},f))}}be()(super_select_EuiSuperSelect,"defaultProps",{compressed:!1,fullWidth:!1,hasDividers:!1,isInvalid:!1,isLoading:!1});var Ie=a(6);const xe=Ie.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterDescription",{defaultMessage:"Events from the data providers above are filtered by the adjacent KQL"}),Oe=Ie.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlTooltip",{defaultMessage:"Events from the data providers above are filtered by this KQL"}),ke=Ie.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlPlaceholder",{defaultMessage:"Filter events"}),we=Ie.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlSelectedText",{defaultMessage:"Filter"}),Pe=Ie.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchDescription",{defaultMessage:"Events from the data providers above are combined with results from the adjacent KQL"}),Se=Ie.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlTooltip",{defaultMessage:"Events from the data providers above are combined with results from this KQL"}),Ce=Ie.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlPlaceholder",{defaultMessage:"Search events"}),je=Ie.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlSelectedText",{defaultMessage:"Search"}),Fe=Ie.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"}),Me=s.a.div.withConfig({displayName:"AndOrContainer",componentId:"sc-1mndpti-0"})(["position:relative;top:-1px;"]);Me.displayName="AndOrContainer";const De={filter:{mode:"filter",description:xe,kqlBarTooltip:Oe,placeholder:ke,selectText:we},search:{mode:"search",description:Pe,kqlBarTooltip:Se,placeholder:Ce,selectText:je}},Ne=[{value:De.filter.mode,inputDisplay:n.a.createElement(Me,null,n.a.createElement(Q.a,{type:"and"}),De.filter.selectText),dropdownDisplay:n.a.createElement(n.a.Fragment,null,n.a.createElement(Q.a,{type:"and"}),n.a.createElement("strong",null,De.filter.selectText),n.a.createElement(i.EuiSpacer,{size:"xs"}),n.a.createElement(i.EuiText,{size:"s",color:"subdued"},n.a.createElement("p",null,De.filter.description))),"data-test-subj":"kqlModePopoverFilter"},{value:De.search.mode,inputDisplay:n.a.createElement(Me,null,n.a.createElement(Q.a,{type:"or"}),De.search.selectText),dropdownDisplay:n.a.createElement(n.a.Fragment,null,n.a.createElement(Q.a,{type:"or"}),n.a.createElement("strong",null,De.search.selectText),n.a.createElement(i.EuiSpacer,{size:"xs"}),n.a.createElement(i.EuiText,{size:"s",color:"subdued"},n.a.createElement("p",null,De.search.description))),"data-test-subj":"kqlModePopoverSearch"}],Te="timelineSelectModeItemsClassName",qe="searchOrFilterPopover",Qe="352px",ze=Object(o.createGlobalStyle)([".","{width:350px !important;}.",".euiPopover__panel{width:"," !important;.euiSuperSelect__listbox{width:"," !important;}}"],Te,qe,Qe,Qe),_e=s.a.div.withConfig({displayName:"SearchOrFilterContainer",componentId:"sc-izkbfu-0"})([""," user-select:none;"],(({theme:e})=>`margin-top: ${e.eui.euiSizeXS};`));_e.displayName="SearchOrFilterContainer";const Ke=s()(i.EuiFlexItem).withConfig({displayName:"ModeFlexItem",componentId:"sc-izkbfu-1"})(["user-select:none;"]);Ke.displayName="ModeFlexItem";const Re=n.a.memo((({dataProviders:e,isRefreshPaused:t,filters:a,filterManager:r,filterQuery:o,from:s,fromStr:d,kqlMode:c,timelineId:u,refreshInterval:m,savedQueryId:p,setFilters:g,setSavedQueryId:h,to:v,toStr:y,updateKqlMode:b,updateReduxTime:f})=>{const E=Object(l.useCallback)((e=>b({id:u,kqlMode:e})),[u,b]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(_e,null,n.a.createElement(i.EuiFlexGroup,{"data-test-subj":"timeline-search-or-filter",gutterSize:"xs"},n.a.createElement(Ke,{grow:!1},n.a.createElement(i.EuiToolTip,{content:Fe},n.a.createElement(super_select_EuiSuperSelect,{"data-test-subj":"timeline-select-search-or-filter",hasDividers:!0,itemLayoutAlign:"top",itemClassName:Te,onChange:E,options:Ne,popoverProps:{className:qe},valueOfSelected:c}))),n.a.createElement(i.EuiFlexItem,{"data-test-subj":"timeline-search-or-filter-search-container"},n.a.createElement(ve.a,{dataProviders:e,filters:a,filterManager:r,filterQuery:o,from:s,fromStr:d,kqlMode:c,isRefreshPaused:t,refreshInterval:m,savedQueryId:p,setFilters:g,setSavedQueryId:h,timelineId:u,to:v,toStr:y,updateReduxTime:f})))),n.a.createElement(ze,null))}));Re.displayName="SearchOrFilter";const Be=n.a.memo((({dataProviders:e,filters:t,filterManager:a,filterQuery:i,from:r,fromStr:o,isRefreshPaused:s,kqlMode:d,refreshInterval:c,savedQueryId:u,setFilters:m,setSavedQueryId:p,timelineId:g,to:h,toStr:v,updateKqlMode:y,updateReduxTime:b})=>{const f=Object(l.useCallback)((e=>m({id:g,filters:e})),[g,m]),E=Object(l.useCallback)((e=>p({id:g,savedQueryId:e})),[g,p]);return n.a.createElement(Re,{dataProviders:e,filters:t,filterManager:a,filterQuery:i,from:r,fromStr:o,isRefreshPaused:s,kqlMode:d,refreshInterval:c,savedQueryId:u,setFilters:f,setSavedQueryId:E,timelineId:g,to:h,toStr:v,updateKqlMode:y,updateReduxTime:b})}),((e,t)=>e.filterManager===t.filterManager&&e.from===t.from&&e.fromStr===t.fromStr&&e.to===t.to&&e.toStr===t.toStr&&e.isRefreshPaused===t.isRefreshPaused&&e.refreshInterval===t.refreshInterval&&e.timelineId===t.timelineId&&u()(e.dataProviders,t.dataProviders)&&u()(e.filters,t.filters)&&u()(e.filterQuery,t.filterQuery)&&u()(e.kqlMode,t.kqlMode)&&u()(e.savedQueryId,t.savedQueryId)&&u()(e.timelineId,t.timelineId)));Be.displayName="StatefulSearchOrFilterComponent";const $e=Object(d.connect)((()=>{const e=y.b.getTimelineByIdSelector(),t=y.b.getKqlFilterKuerySelector(),a=ge.f.getTimelineSelector(),i=ge.f.getTimelinePolicySelector();return(l,{timelineId:n})=>{var o;const s=null!==(o=e(l,n))&&void 0!==o?o:de.a,d=a(l),c=i(l);return{dataProviders:s.dataProviders,filterQuery:t(l,n),filters:s.filters,from:d.timerange.from,fromStr:d.timerange.fromStr,isRefreshPaused:"manual"===c.kind,kqlMode:Object(r.getOr)("filter","kqlMode",s),refreshInterval:c.duration,savedQueryId:Object(r.getOr)(null,"savedQueryId",s),to:d.timerange.to,toStr:d.timerange.toStr}}}),(e=>({applyKqlFilterQuery:({id:t,filterQuery:a})=>e(y.a.applyKqlFilterQuery({id:t,filterQuery:a})),updateKqlMode:({id:t,kqlMode:a})=>e(y.a.updateKqlMode({id:t,kqlMode:a})),setSavedQueryId:({id:t,savedQueryId:a})=>e(y.a.setSavedQueryId({id:t,savedQueryId:a})),setFilters:({id:t,filters:a})=>e(y.a.setFilters({id:t,filters:a})),updateReduxTime:Object(he.b)(e)})))(Be);var Ae=a(746);const Le=({filterManager:e,show:t,showCallOutUnauthorizedMsg:a,status:r,timelineId:l})=>n.a.createElement(n.a.Fragment,null,a&&n.a.createElement(i.EuiCallOut,{"data-test-subj":"timelineCallOutUnauthorized",title:Ae.b,color:"warning",iconType:"alert",size:"s"}),r===z.k.immutable&&n.a.createElement(i.EuiCallOut,{"data-test-subj":"timelineImmutableCallOut",title:Ae.a,color:"primary",iconType:"alert",size:"s"}),t&&n.a.createElement(me,{timelineId:l}),n.a.createElement($e,{filterManager:e,timelineId:l})),We=n.a.memo(Le);var He=a(241),Ue=a(253),Ge=a(871),Ve=a(349),Xe=a(600),Ye=a(672),Je=a(902),Ze=a(96),et=a(84),tt=a(418),at=a(673),it=a(873),rt=a(423),lt=a(876),nt=a(79);const ot=s.a.div.withConfig({displayName:"TimelineHeaderContainer",componentId:"sc-fm1ksw-0"})(["margin-top:6px;width:100%;"]);ot.displayName="TimelineHeaderContainer";const st=s()(i.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-fm1ksw-1"})(["align-items:stretch;box-shadow:none;display:flex;flex-direction:column;&.euiFlyoutHeader{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeM} ${e.eui.euiSizeS} 0 ${e.eui.euiSizeS};`)),dt=s()(i.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-fm1ksw-2"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{overflow:hidden;mask-image:none;}.euiFlyoutBody__overflowContent{padding:0;height:100%;display:flex;}"]),ct=s()(i.EuiFlyoutFooter).withConfig({displayName:"StyledEuiFlyoutFooter",componentId:"sc-fm1ksw-3"})(["background:none;&.euiFlyoutFooter{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeS} 0;`)),ut=s()(i.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-fm1ksw-4"})(["margin:0;width:100%;overflow:hidden;"]),mt=s()(i.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-fm1ksw-5"})([""," overflow:hidden;"],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`)),pt=s()(i.EuiFlexItem).withConfig({displayName:"DatePicker",componentId:"sc-fm1ksw-6"})([".euiSuperDatePicker__flexWrapper{max-width:none;width:auto;}"]);pt.displayName="DatePicker";const gt=s()(i.EuiFlexItem).withConfig({displayName:"SourcererFlex",componentId:"sc-fm1ksw-7"})(["align-items:flex-end;"]);gt.displayName="SourcererFlex";const ht=s.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-fm1ksw-8"})(["width:2px;height:100%;background:",";"],(({theme:e})=>e.eui.euiColorLightShade));ht.displayName="VerticalRule";const vt=s()(i.EuiBadge).withConfig({displayName:"EventsCountBadge",componentId:"sc-fm1ksw-9"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),yt=[],bt=[],ft=({activeTab:e,columns:t,dataProviders:a,end:o,expandedDetail:s,filters:c,timelineId:u,isLive:O,itemsPerPage:k,itemsPerPageOptions:w,kqlMode:P,kqlQueryExpression:F,kqlQueryLanguage:M,onEventClosed:D,renderCellValue:N,rowRenderers:T,show:q,showCallOutUnauthorizedMsg:Q,showExpandedDetails:_,start:K,status:R,sort:B,timerangeKind:$})=>{var A;const L=Object(d.useDispatch)(),{portalNode:W}=Object(Ye.d)(),{setTimelineFullScreen:H,timelineFullScreen:U}=Object(Ze.c)(),{browserFields:G,dataViewId:V,loading:X,indexPattern:Y,runtimeMappings:J,selectedPatterns:Z}=Object(C.d)(S.SourcererScopeName.timeline),{uiSettings:ee}=Object(f.k)().services,te=Object(nt.b)().isEnterprise()?6:5,ae=Object(l.useMemo)((()=>y.b.getManageTimelineById()),[]),{filterManager:ie}=Object(j.a)((e=>ae(e,null!=u?u:""))),re=Object(l.useMemo)((()=>null!=ie?ie:new p.FilterManager(ee)),[ie,ee]),le=Object(l.useMemo)((()=>Object(g.getEsQueryConfig)(ee)),[ee]),ne=Object(l.useMemo)((()=>({query:F.trim(),language:M})),[F,M]),oe=Object(Ue.a)({config:le,dataProviders:a,indexPattern:Y,browserFields:G,filters:c,kqlQuery:ne,kqlMode:P});Object(v.a)({id:u,filterQuery:null==oe?void 0:oe.filterQuery,kqlError:null==oe?void 0:oe.kqlError,query:ne,startDate:K,endDate:o});const se=Object(r.isEmpty)(a)&&Object(r.isEmpty)(c)&&Object(r.isEmpty)(ne.query)&&void 0===(null==oe?void 0:oe.filterQuery),de=Object(l.useMemo)((()=>null!=oe&&null!=X&&!X&&!Object(r.isEmpty)(K)&&!Object(r.isEmpty)(o)&&void 0!==(null==oe?void 0:oe.filterQuery)),[oe,o,X,K]),ce=B.map((({columnId:e,columnType:t,esTypes:a,sortDirection:i})=>({field:e,direction:i,esTypes:null!=a?a:[],type:t})));Object(l.useEffect)((()=>{L(y.a.initializeTGridSettings({filterManager:re,id:u}))}),[ie,L,re,u,ee]);const[ue,{events:me,inspect:pe,totalCount:ge,pageInfo:ve,loadPage:ye,updatedAt:be,refetch:fe}]=Object(b.a)({dataViewId:V,endDate:o,fields:[...(Object(r.isEmpty)(t)?E.b:t).map((e=>e.id)),...Ve.h],filterQuery:null==oe?void 0:oe.filterQuery,id:u,indexNames:Z,language:ne.language,limit:k,runtimeMappings:J,skip:!de,sort:ce,startDate:K,timerangeKind:$}),Ee=Object(l.useCallback)((()=>{var e;D({tabType:z.l.query,timelineId:u}),null!==(e=s[z.l.query])&&void 0!==e&&e.panelView&&u===z.i.active&&_&&et.a.toggleExpandedDetail({})}),[D,u,s,_]);Object(l.useEffect)((()=>{L(y.a.updateIsLoading({id:u,isLoading:ue||X}))}),[X,u,ue,L]);const Ie=Object(l.useMemo)((()=>oe&&null!=oe.kqlError||!1),[oe]),xe=Object(l.useMemo)((()=>Object(rt.a)(te).map((e=>({...e,headerCellRender:it.a})))),[te]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(m.a,{node:W},ge>=0?n.a.createElement(vt,null,ge):null),n.a.createElement(Ge.a,{id:`${u}-${z.l.query}`,inputId:h.a.timeline,inspect:pe,loading:ue,refetch:fe,skip:!de}),n.a.createElement(ut,{gutterSize:"none"},n.a.createElement(mt,{grow:2},n.a.createElement(st,{"data-test-subj":`${e}-tab-flyout-header`,hasBorder:!1},n.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"timeline-date-picker-container"},U&&null!=H&&n.a.createElement(at.b,{fullScreen:U,setFullScreen:H}),n.a.createElement(pt,{grow:10},n.a.createElement(he.a,{id:h.a.timeline,timelineId:u,disabled:Ie})),n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(Je.a,null)),n.a.createElement(gt,{grow:1},e===z.l.query&&n.a.createElement(lt.a,{scope:S.SourcererScopeName.timeline}))),n.a.createElement(ot,{"data-test-subj":"timelineHeader"},n.a.createElement(We,{filterManager:re,show:q&&e===z.l.query,showCallOutUnauthorizedMsg:Q,status:R,timelineId:u}))),n.a.createElement(Xe.a,null,n.a.createElement(dt,{"data-test-subj":`${z.l.query}-tab-flyout-body`,className:"timeline-flyout-body"},n.a.createElement(I.a,{activePage:ve.activePage,browserFields:G,data:se?yt:me,id:u,refetch:fe,renderCellValue:N,rowRenderers:T,sort:B,tabType:z.l.query,totalPages:Object(He.h)({itemsCount:ge,itemsPerPage:k}),leadingControlColumns:xe,trailingControlColumns:bt})),n.a.createElement(ct,{"data-test-subj":`${z.l.query}-tab-flyout-footer`,className:"timeline-flyout-footer"},!se&&n.a.createElement(x.a,{activePage:null!==(A=null==ve?void 0:ve.activePage)&&void 0!==A?A:0,"data-test-subj":"timeline-footer",updatedAt:be,height:x.b,id:u,isLive:O,isLoading:ue||X,itemsCount:se?0:me.length,itemsPerPage:k,itemsPerPageOptions:w,onChangePage:ye,totalCount:se?0:ge})))),_&&n.a.createElement(n.a.Fragment,null,n.a.createElement(ht,null),n.a.createElement(mt,{grow:1},n.a.createElement(tt.a,{browserFields:G,handleOnPanelClosed:Ee,runtimeMappings:J,tabType:z.l.query,timelineId:u})))))},Et=Object(d.connect)((()=>{const e=y.b.getShowCallOutUnauthorizedMsg(),t=y.b.getTimelineByIdSelector(),a=y.b.getKqlFilterKuerySelector(),i=ge.f.getTimelineSelector();return(l,{timelineId:n})=>{var o,s,d,c,u;const m=null!==(o=t(l,n))&&void 0!==o?o:de.a,p=i(l),{activeTab:g,columns:h,dataProviders:v,expandedDetail:y,filters:b,itemsPerPage:f,itemsPerPageOptions:E,kqlMode:I,show:x,sort:O,status:k,timelineType:w}=m,P=a(l,n),S="filter"===I&&b||[],C=Object(r.isEmpty)(v)&&Object(r.isEmpty)(null!==(s=null==P?void 0:P.expression)&&void 0!==s?s:"")&&"template"===w?" ":null!==(d=null==P?void 0:P.expression)&&void 0!==d?d:"",j=Object(r.isEmpty)(v)&&"template"===w?"kuery":null!==(c=null==P?void 0:P.kind)&&void 0!==c?c:"kuery";return{activeTab:g,columns:h,dataProviders:v,end:p.timerange.to,expandedDetail:y,filters:S,timelineId:n,isLive:"interval"===p.policy.kind,itemsPerPage:f,itemsPerPageOptions:E,kqlMode:I,kqlQueryExpression:C,kqlQueryLanguage:j,showCallOutUnauthorizedMsg:e(l),show:x,showExpandedDetails:!!y[z.l.query]&&!(null===(u=y[z.l.query])||void 0===u||!u.panelView),sort:O,start:p.timerange.from,status:k,timerangeKind:p.timerange.kind}}}),((e,{timelineId:t})=>({onEventClosed:t=>{e(y.a.toggleDetailPanel(t))}})))(n.a.memo(ft,((e,t)=>((e,t)=>e.kqlMode===t.kqlMode&&e.kqlQueryExpression===t.kqlQueryExpression&&u()(e.filters,t.filters))(e,t)&&e.activeTab===t.activeTab&&((e,t)=>e.end===t.end&&e.start===t.start&&e.timerangeKind===t.timerangeKind)(e,t)&&e.isLive===t.isLive&&e.itemsPerPage===t.itemsPerPage&&e.onEventClosed===t.onEventClosed&&e.show===t.show&&e.showCallOutUnauthorizedMsg===t.showCallOutUnauthorizedMsg&&e.showExpandedDetails===t.showExpandedDetails&&e.status===t.status&&e.timelineId===t.timelineId&&u()(e.columns,t.columns)&&u()(e.dataProviders,t.dataProviders)&&u()(e.itemsPerPageOptions,t.itemsPerPageOptions)&&u()(e.sort,t.sort))))},871:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a(4),r=a.n(i),l=a(47),n=a(82);const o=({id:e,inputId:t,inspect:a,loading:r,refetch:o,skip:s})=>{const d=Object(l.useDispatch)();return Object(i.useEffect)((()=>{s||d(n.b.setQuery({id:e,inputId:t,inspect:a,loading:r,refetch:o}))}),[d,e,t,r,o,a,s]),null},s=r.a.memo(o)},902:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var i=a(17),r=a(4),l=a.n(r),n=a(47),o=a(8),s=a(29),d=a(76),c=a(6);const u=c.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerTooltip",{defaultMessage:"Disable syncing of date/time range between the currently viewed page and your timeline"}),m=c.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerTooltip",{defaultMessage:"Enable syncing of date/time range between the currently viewed page and your timeline"}),p=c.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerDescription",{defaultMessage:"Lock global date picker to timeline date picker"}),g=c.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerDescription",{defaultMessage:"Unlock global date picker from timeline date picker"}),h=()=>{const e=Object(n.useDispatch)(),t=Object(r.useMemo)((()=>s.d.globalSelector()),[]),a=Object(d.b)((e=>t(e).linkTo.includes(o.a.timeline))),c=Object(r.useCallback)((()=>e(s.b.toggleTimelineLinkTo())),[e]);return l.a.createElement(i.EuiToolTip,{"data-test-subj":"timeline-date-picker-lock-tooltip",position:"top",content:a?u:m},l.a.createElement(i.EuiButtonIcon,{"data-test-subj":`timeline-date-picker-${a?"lock":"unlock"}-button`,color:"primary",onClick:c,iconType:a?"lock":"lockOpen","aria-label":a?g:p}))};h.displayName="TimelineDatePickerLockComponent";const v=l.a.memo(h)}}]);